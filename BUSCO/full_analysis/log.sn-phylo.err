Building DAG of jobs...
Using shell: /usr/bin/bash
Provided cores: 32
Rules claiming more threads will be scaled down.
Job counts:
	count	jobs
	411	MSA
	1	all
	1	concat
	411	find_best_model
	411	get_outgroups
	411	get_seqs
	411	infer_single_ML
	1	infer_supermatrix_ML
	411	join_groups
	1	post_filter
	411	remove_empty
	411	score_and_cut
	3292

[Sun Jul  5 21:26:36 2020]
rule get_seqs:
    input: /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ingroup.txt, /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/outgroup.txt
    output: per_gene/EOG091G0PAG/EOG091G0PAG.ingroup.fasta
    log: per_gene/EOG091G0PAG/get_seqs.stdout.txt, per_gene/EOG091G0PAG/get_seqs.stderr.txt
    jobid: 2800
    wildcards: BUSCO=EOG091G0PAG
    threads: 2


	basedir=$(pwd)
        cd per_gene/EOG091G0PAG
        
        bash $basedir/../scripts/fetch_seqs.sh EOG091G0PAG /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ingroup.txt /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/outgroup.txt 1> ../../per_gene/EOG091G0PAG/get_seqs.stdout.txt 2> ../../per_gene/EOG091G0PAG/get_seqs.stderr.txt
	mv EOG091G0PAG.fasta $basedir/per_gene/EOG091G0PAG/EOG091G0PAG.ingroup.fasta
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/72476f9d9a5bd0627b4d721143a21354.simg

[Sun Jul  5 21:26:36 2020]
rule get_seqs:
    input: /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ingroup.txt, /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/outgroup.txt
    output: per_gene/EOG091G0C8H/EOG091G0C8H.ingroup.fasta
    log: per_gene/EOG091G0C8H/get_seqs.stdout.txt, per_gene/EOG091G0C8H/get_seqs.stderr.txt
    jobid: 2642
    wildcards: BUSCO=EOG091G0C8H
    threads: 2


	basedir=$(pwd)
        cd per_gene/EOG091G0C8H
        
        bash $basedir/../scripts/fetch_seqs.sh EOG091G0C8H /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ingroup.txt /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/outgroup.txt 1> ../../per_gene/EOG091G0C8H/get_seqs.stdout.txt 2> ../../per_gene/EOG091G0C8H/get_seqs.stderr.txt
	mv EOG091G0C8H.fasta $basedir/per_gene/EOG091G0C8H/EOG091G0C8H.ingroup.fasta
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/72476f9d9a5bd0627b4d721143a21354.simg

[Sun Jul  5 21:26:36 2020]
rule get_seqs:
    input: /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ingroup.txt, /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/outgroup.txt
    output: per_gene/EOG091G1285/EOG091G1285.ingroup.fasta
    log: per_gene/EOG091G1285/get_seqs.stdout.txt, per_gene/EOG091G1285/get_seqs.stderr.txt
    jobid: 2924
    wildcards: BUSCO=EOG091G1285
    threads: 2


	basedir=$(pwd)
        cd per_gene/EOG091G1285
        
        bash $basedir/../scripts/fetch_seqs.sh EOG091G1285 /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ingroup.txt /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/outgroup.txt 1> ../../per_gene/EOG091G1285/get_seqs.stdout.txt 2> ../../per_gene/EOG091G1285/get_seqs.stderr.txt
	mv EOG091G1285.fasta $basedir/per_gene/EOG091G1285/EOG091G1285.ingroup.fasta
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/72476f9d9a5bd0627b4d721143a21354.simg

[Sun Jul  5 21:26:36 2020]
rule get_seqs:
    input: /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ingroup.txt, /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/outgroup.txt
    output: per_gene/EOG091G0L5D/EOG091G0L5D.ingroup.fasta
    log: per_gene/EOG091G0L5D/get_seqs.stdout.txt, per_gene/EOG091G0L5D/get_seqs.stderr.txt
    jobid: 3276
    wildcards: BUSCO=EOG091G0L5D
    threads: 2


	basedir=$(pwd)
        cd per_gene/EOG091G0L5D
        
        bash $basedir/../scripts/fetch_seqs.sh EOG091G0L5D /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ingroup.txt /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/outgroup.txt 1> ../../per_gene/EOG091G0L5D/get_seqs.stdout.txt 2> ../../per_gene/EOG091G0L5D/get_seqs.stderr.txt
	mv EOG091G0L5D.fasta $basedir/per_gene/EOG091G0L5D/EOG091G0L5D.ingroup.fasta
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/72476f9d9a5bd0627b4d721143a21354.simg

[Sun Jul  5 21:26:36 2020]
rule get_seqs:
    input: /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ingroup.txt, /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/outgroup.txt
    output: per_gene/EOG091G0IVB/EOG091G0IVB.ingroup.fasta
    log: per_gene/EOG091G0IVB/get_seqs.stdout.txt, per_gene/EOG091G0IVB/get_seqs.stderr.txt
    jobid: 2988
    wildcards: BUSCO=EOG091G0IVB
    threads: 2


	basedir=$(pwd)
        cd per_gene/EOG091G0IVB
        
        bash $basedir/../scripts/fetch_seqs.sh EOG091G0IVB /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ingroup.txt /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/outgroup.txt 1> ../../per_gene/EOG091G0IVB/get_seqs.stdout.txt 2> ../../per_gene/EOG091G0IVB/get_seqs.stderr.txt
	mv EOG091G0IVB.fasta $basedir/per_gene/EOG091G0IVB/EOG091G0IVB.ingroup.fasta
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/72476f9d9a5bd0627b4d721143a21354.simg

[Sun Jul  5 21:26:36 2020]
rule get_seqs:
    input: /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ingroup.txt, /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/outgroup.txt
    output: per_gene/EOG091G0A5N/EOG091G0A5N.ingroup.fasta
    log: per_gene/EOG091G0A5N/get_seqs.stdout.txt, per_gene/EOG091G0A5N/get_seqs.stderr.txt
    jobid: 3170
    wildcards: BUSCO=EOG091G0A5N
    threads: 2


	basedir=$(pwd)
        cd per_gene/EOG091G0A5N
        
        bash $basedir/../scripts/fetch_seqs.sh EOG091G0A5N /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ingroup.txt /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/outgroup.txt 1> ../../per_gene/EOG091G0A5N/get_seqs.stdout.txt 2> ../../per_gene/EOG091G0A5N/get_seqs.stderr.txt
	mv EOG091G0A5N.fasta $basedir/per_gene/EOG091G0A5N/EOG091G0A5N.ingroup.fasta
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/72476f9d9a5bd0627b4d721143a21354.simg

[Sun Jul  5 21:26:37 2020]
rule get_seqs:
    input: /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ingroup.txt, /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/outgroup.txt
    output: per_gene/EOG091G0ZDR/EOG091G0ZDR.ingroup.fasta
    log: per_gene/EOG091G0ZDR/get_seqs.stdout.txt, per_gene/EOG091G0ZDR/get_seqs.stderr.txt
    jobid: 3256
    wildcards: BUSCO=EOG091G0ZDR
    threads: 2


	basedir=$(pwd)
        cd per_gene/EOG091G0ZDR
        
        bash $basedir/../scripts/fetch_seqs.sh EOG091G0ZDR /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ingroup.txt /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/outgroup.txt 1> ../../per_gene/EOG091G0ZDR/get_seqs.stdout.txt 2> ../../per_gene/EOG091G0ZDR/get_seqs.stderr.txt
	mv EOG091G0ZDR.fasta $basedir/per_gene/EOG091G0ZDR/EOG091G0ZDR.ingroup.fasta
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/72476f9d9a5bd0627b4d721143a21354.simg

[Sun Jul  5 21:26:37 2020]
rule get_seqs:
    input: /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ingroup.txt, /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/outgroup.txt
    output: per_gene/EOG091G01XI/EOG091G01XI.ingroup.fasta
    log: per_gene/EOG091G01XI/get_seqs.stdout.txt, per_gene/EOG091G01XI/get_seqs.stderr.txt
    jobid: 2488
    wildcards: BUSCO=EOG091G01XI
    threads: 2


	basedir=$(pwd)
        cd per_gene/EOG091G01XI
        
        bash $basedir/../scripts/fetch_seqs.sh EOG091G01XI /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ingroup.txt /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/outgroup.txt 1> ../../per_gene/EOG091G01XI/get_seqs.stdout.txt 2> ../../per_gene/EOG091G01XI/get_seqs.stderr.txt
	mv EOG091G01XI.fasta $basedir/per_gene/EOG091G01XI/EOG091G01XI.ingroup.fasta
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/72476f9d9a5bd0627b4d721143a21354.simg

[Sun Jul  5 21:26:37 2020]
rule get_seqs:
    input: /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ingroup.txt, /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/outgroup.txt
    output: per_gene/EOG091G0SU6/EOG091G0SU6.ingroup.fasta
    log: per_gene/EOG091G0SU6/get_seqs.stdout.txt, per_gene/EOG091G0SU6/get_seqs.stderr.txt
    jobid: 2848
    wildcards: BUSCO=EOG091G0SU6
    threads: 2


	basedir=$(pwd)
        cd per_gene/EOG091G0SU6
        
        bash $basedir/../scripts/fetch_seqs.sh EOG091G0SU6 /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ingroup.txt /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/outgroup.txt 1> ../../per_gene/EOG091G0SU6/get_seqs.stdout.txt 2> ../../per_gene/EOG091G0SU6/get_seqs.stderr.txt
	mv EOG091G0SU6.fasta $basedir/per_gene/EOG091G0SU6/EOG091G0SU6.ingroup.fasta
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/72476f9d9a5bd0627b4d721143a21354.simg

[Sun Jul  5 21:26:37 2020]
rule get_seqs:
    input: /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ingroup.txt, /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/outgroup.txt
    output: per_gene/EOG091G0FJB/EOG091G0FJB.ingroup.fasta
    log: per_gene/EOG091G0FJB/get_seqs.stdout.txt, per_gene/EOG091G0FJB/get_seqs.stderr.txt
    jobid: 2978
    wildcards: BUSCO=EOG091G0FJB
    threads: 2


	basedir=$(pwd)
        cd per_gene/EOG091G0FJB
        
        bash $basedir/../scripts/fetch_seqs.sh EOG091G0FJB /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ingroup.txt /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/outgroup.txt 1> ../../per_gene/EOG091G0FJB/get_seqs.stdout.txt 2> ../../per_gene/EOG091G0FJB/get_seqs.stderr.txt
	mv EOG091G0FJB.fasta $basedir/per_gene/EOG091G0FJB/EOG091G0FJB.ingroup.fasta
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/72476f9d9a5bd0627b4d721143a21354.simg

[Sun Jul  5 21:26:37 2020]
rule get_seqs:
    input: /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ingroup.txt, /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/outgroup.txt
    output: per_gene/EOG091G07IK/EOG091G07IK.ingroup.fasta
    log: per_gene/EOG091G07IK/get_seqs.stdout.txt, per_gene/EOG091G07IK/get_seqs.stderr.txt
    jobid: 2576
    wildcards: BUSCO=EOG091G07IK
    threads: 2


	basedir=$(pwd)
        cd per_gene/EOG091G07IK
        
        bash $basedir/../scripts/fetch_seqs.sh EOG091G07IK /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ingroup.txt /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/outgroup.txt 1> ../../per_gene/EOG091G07IK/get_seqs.stdout.txt 2> ../../per_gene/EOG091G07IK/get_seqs.stderr.txt
	mv EOG091G07IK.fasta $basedir/per_gene/EOG091G07IK/EOG091G07IK.ingroup.fasta
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/72476f9d9a5bd0627b4d721143a21354.simg

[Sun Jul  5 21:26:37 2020]
rule get_seqs:
    input: /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ingroup.txt, /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/outgroup.txt
    output: per_gene/EOG091G0YZ0/EOG091G0YZ0.ingroup.fasta
    log: per_gene/EOG091G0YZ0/get_seqs.stdout.txt, per_gene/EOG091G0YZ0/get_seqs.stderr.txt
    jobid: 2902
    wildcards: BUSCO=EOG091G0YZ0
    threads: 2


	basedir=$(pwd)
        cd per_gene/EOG091G0YZ0
        
        bash $basedir/../scripts/fetch_seqs.sh EOG091G0YZ0 /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ingroup.txt /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/outgroup.txt 1> ../../per_gene/EOG091G0YZ0/get_seqs.stdout.txt 2> ../../per_gene/EOG091G0YZ0/get_seqs.stderr.txt
	mv EOG091G0YZ0.fasta $basedir/per_gene/EOG091G0YZ0/EOG091G0YZ0.ingroup.fasta
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/72476f9d9a5bd0627b4d721143a21354.simg

[Sun Jul  5 21:26:38 2020]
rule get_seqs:
    input: /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ingroup.txt, /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/outgroup.txt
    output: per_gene/EOG091G0AKW/EOG091G0AKW.ingroup.fasta
    log: per_gene/EOG091G0AKW/get_seqs.stdout.txt, per_gene/EOG091G0AKW/get_seqs.stderr.txt
    jobid: 2624
    wildcards: BUSCO=EOG091G0AKW
    threads: 2


	basedir=$(pwd)
        cd per_gene/EOG091G0AKW
        
        bash $basedir/../scripts/fetch_seqs.sh EOG091G0AKW /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ingroup.txt /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/outgroup.txt 1> ../../per_gene/EOG091G0AKW/get_seqs.stdout.txt 2> ../../per_gene/EOG091G0AKW/get_seqs.stderr.txt
	mv EOG091G0AKW.fasta $basedir/per_gene/EOG091G0AKW/EOG091G0AKW.ingroup.fasta
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/72476f9d9a5bd0627b4d721143a21354.simg

[Sun Jul  5 21:26:38 2020]
rule get_seqs:
    input: /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ingroup.txt, /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/outgroup.txt
    output: per_gene/EOG091G05TG/EOG091G05TG.ingroup.fasta
    log: per_gene/EOG091G05TG/get_seqs.stdout.txt, per_gene/EOG091G05TG/get_seqs.stderr.txt
    jobid: 2956
    wildcards: BUSCO=EOG091G05TG
    threads: 2


	basedir=$(pwd)
        cd per_gene/EOG091G05TG
        
        bash $basedir/../scripts/fetch_seqs.sh EOG091G05TG /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ingroup.txt /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/outgroup.txt 1> ../../per_gene/EOG091G05TG/get_seqs.stdout.txt 2> ../../per_gene/EOG091G05TG/get_seqs.stderr.txt
	mv EOG091G05TG.fasta $basedir/per_gene/EOG091G05TG/EOG091G05TG.ingroup.fasta
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/72476f9d9a5bd0627b4d721143a21354.simg

[Sun Jul  5 21:26:38 2020]
rule get_seqs:
    input: /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ingroup.txt, /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/outgroup.txt
    output: per_gene/EOG091G0ITS/EOG091G0ITS.ingroup.fasta
    log: per_gene/EOG091G0ITS/get_seqs.stdout.txt, per_gene/EOG091G0ITS/get_seqs.stderr.txt
    jobid: 2718
    wildcards: BUSCO=EOG091G0ITS
    threads: 2


	basedir=$(pwd)
        cd per_gene/EOG091G0ITS
        
        bash $basedir/../scripts/fetch_seqs.sh EOG091G0ITS /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ingroup.txt /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/outgroup.txt 1> ../../per_gene/EOG091G0ITS/get_seqs.stdout.txt 2> ../../per_gene/EOG091G0ITS/get_seqs.stderr.txt
	mv EOG091G0ITS.fasta $basedir/per_gene/EOG091G0ITS/EOG091G0ITS.ingroup.fasta
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/72476f9d9a5bd0627b4d721143a21354.simg

[Sun Jul  5 21:26:38 2020]
rule get_seqs:
    input: /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ingroup.txt, /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/outgroup.txt
    output: per_gene/EOG091G09QO/EOG091G09QO.ingroup.fasta
    log: per_gene/EOG091G09QO/get_seqs.stdout.txt, per_gene/EOG091G09QO/get_seqs.stderr.txt
    jobid: 2964
    wildcards: BUSCO=EOG091G09QO
    threads: 2


	basedir=$(pwd)
        cd per_gene/EOG091G09QO
        
        bash $basedir/../scripts/fetch_seqs.sh EOG091G09QO /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ingroup.txt /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/outgroup.txt 1> ../../per_gene/EOG091G09QO/get_seqs.stdout.txt 2> ../../per_gene/EOG091G09QO/get_seqs.stderr.txt
	mv EOG091G09QO.fasta $basedir/per_gene/EOG091G09QO/EOG091G09QO.ingroup.fasta
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/72476f9d9a5bd0627b4d721143a21354.simg
[Sun Jul  5 21:28:06 2020]
Finished job 2718.
1 of 3292 steps (0.03%) done
[Sun Jul  5 21:28:06 2020]
Finished job 2800.
2 of 3292 steps (0.06%) done
[Sun Jul  5 21:28:06 2020]
Finished job 3256.
3 of 3292 steps (0.09%) done
[Sun Jul  5 21:28:06 2020]
Finished job 2956.
4 of 3292 steps (0.12%) done
[Sun Jul  5 21:28:06 2020]
Finished job 2488.
5 of 3292 steps (0.15%) done
[Sun Jul  5 21:28:06 2020]
Finished job 3276.
6 of 3292 steps (0.18%) done
[Sun Jul  5 21:28:06 2020]
Finished job 2964.
7 of 3292 steps (0.21%) done

[Sun Jul  5 21:28:06 2020]
rule get_seqs:
    input: /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ingroup.txt, /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/outgroup.txt
    output: per_gene/EOG091G0IDG/EOG091G0IDG.ingroup.fasta
    log: per_gene/EOG091G0IDG/get_seqs.stdout.txt, per_gene/EOG091G0IDG/get_seqs.stderr.txt
    jobid: 3208
    wildcards: BUSCO=EOG091G0IDG
    threads: 2


	basedir=$(pwd)
        cd per_gene/EOG091G0IDG
        
        bash $basedir/../scripts/fetch_seqs.sh EOG091G0IDG /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ingroup.txt /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/outgroup.txt 1> ../../per_gene/EOG091G0IDG/get_seqs.stdout.txt 2> ../../per_gene/EOG091G0IDG/get_seqs.stderr.txt
	mv EOG091G0IDG.fasta $basedir/per_gene/EOG091G0IDG/EOG091G0IDG.ingroup.fasta
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/72476f9d9a5bd0627b4d721143a21354.simg

[Sun Jul  5 21:28:06 2020]
rule get_seqs:
    input: /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ingroup.txt, /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/outgroup.txt
    output: per_gene/EOG091G0NMJ/EOG091G0NMJ.ingroup.fasta
    log: per_gene/EOG091G0NMJ/get_seqs.stdout.txt, per_gene/EOG091G0NMJ/get_seqs.stderr.txt
    jobid: 2788
    wildcards: BUSCO=EOG091G0NMJ
    threads: 2


	basedir=$(pwd)
        cd per_gene/EOG091G0NMJ
        
        bash $basedir/../scripts/fetch_seqs.sh EOG091G0NMJ /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ingroup.txt /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/outgroup.txt 1> ../../per_gene/EOG091G0NMJ/get_seqs.stdout.txt 2> ../../per_gene/EOG091G0NMJ/get_seqs.stderr.txt
	mv EOG091G0NMJ.fasta $basedir/per_gene/EOG091G0NMJ/EOG091G0NMJ.ingroup.fasta
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/72476f9d9a5bd0627b4d721143a21354.simg

[Sun Jul  5 21:28:06 2020]
rule get_seqs:
    input: /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ingroup.txt, /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/outgroup.txt
    output: per_gene/EOG091G074U/EOG091G074U.ingroup.fasta
    log: per_gene/EOG091G074U/get_seqs.stdout.txt, per_gene/EOG091G074U/get_seqs.stderr.txt
    jobid: 2572
    wildcards: BUSCO=EOG091G074U
    threads: 2


	basedir=$(pwd)
        cd per_gene/EOG091G074U
        
        bash $basedir/../scripts/fetch_seqs.sh EOG091G074U /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ingroup.txt /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/outgroup.txt 1> ../../per_gene/EOG091G074U/get_seqs.stdout.txt 2> ../../per_gene/EOG091G074U/get_seqs.stderr.txt
	mv EOG091G074U.fasta $basedir/per_gene/EOG091G074U/EOG091G074U.ingroup.fasta
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/72476f9d9a5bd0627b4d721143a21354.simg

[Sun Jul  5 21:28:06 2020]
rule get_outgroups:
    input: per_gene/EOG091G09QO/EOG091G09QO.ingroup.fasta
    output: per_gene/EOG091G09QO/EOG091G09QO.orthodb.fasta, per_gene/EOG091G09QO/EOG091G09QO.outgroup.fasta
    log: per_gene/EOG091G09QO/get_outgroups.stdout.txt, per_gene/EOG091G09QO/get_outgroups.stderr.txt
    jobid: 2965
    wildcards: BUSCO=EOG091G09QO


        #download fastas from Orhtodb for BUSCO id
        for i in {1..5}
        do
             wget "http://www.orthodb.org/fasta?query=EOG091G09QO&level=33208" -O per_gene/EOG091G09QO/EOG091G09QO.orthodb.fasta 1> per_gene/EOG091G09QO/get_outgroups.stdout.txt 2> per_gene/EOG091G09QO/get_outgroups.stderr.txt && break || echo -e "try again ($i)" && sleep 15
        done

	#This is quick an dirty for now and just takes the first protein if there is more than one for an outgroup taxon
        bash ../scripts/download_outgroups.sh taxids.txt per_gene/EOG091G09QO/EOG091G09QO.orthodb.fasta > per_gene/EOG091G09QO/EOG091G09QO.outgroup.fasta
        

[Sun Jul  5 21:28:06 2020]
rule get_outgroups:
    input: per_gene/EOG091G0ITS/EOG091G0ITS.ingroup.fasta
    output: per_gene/EOG091G0ITS/EOG091G0ITS.orthodb.fasta, per_gene/EOG091G0ITS/EOG091G0ITS.outgroup.fasta
    log: per_gene/EOG091G0ITS/get_outgroups.stdout.txt, per_gene/EOG091G0ITS/get_outgroups.stderr.txt
    jobid: 2719
    wildcards: BUSCO=EOG091G0ITS


        #download fastas from Orhtodb for BUSCO id
        for i in {1..5}
        do
             wget "http://www.orthodb.org/fasta?query=EOG091G0ITS&level=33208" -O per_gene/EOG091G0ITS/EOG091G0ITS.orthodb.fasta 1> per_gene/EOG091G0ITS/get_outgroups.stdout.txt 2> per_gene/EOG091G0ITS/get_outgroups.stderr.txt && break || echo -e "try again ($i)" && sleep 15
        done

	#This is quick an dirty for now and just takes the first protein if there is more than one for an outgroup taxon
        bash ../scripts/download_outgroups.sh taxids.txt per_gene/EOG091G0ITS/EOG091G0ITS.orthodb.fasta > per_gene/EOG091G0ITS/EOG091G0ITS.outgroup.fasta
        

[Sun Jul  5 21:28:06 2020]
rule get_outgroups:
    input: per_gene/EOG091G05TG/EOG091G05TG.ingroup.fasta
    output: per_gene/EOG091G05TG/EOG091G05TG.orthodb.fasta, per_gene/EOG091G05TG/EOG091G05TG.outgroup.fasta
    log: per_gene/EOG091G05TG/get_outgroups.stdout.txt, per_gene/EOG091G05TG/get_outgroups.stderr.txt
    jobid: 2957
    wildcards: BUSCO=EOG091G05TG


        #download fastas from Orhtodb for BUSCO id
        for i in {1..5}
        do
             wget "http://www.orthodb.org/fasta?query=EOG091G05TG&level=33208" -O per_gene/EOG091G05TG/EOG091G05TG.orthodb.fasta 1> per_gene/EOG091G05TG/get_outgroups.stdout.txt 2> per_gene/EOG091G05TG/get_outgroups.stderr.txt && break || echo -e "try again ($i)" && sleep 15
        done

	#This is quick an dirty for now and just takes the first protein if there is more than one for an outgroup taxon
        bash ../scripts/download_outgroups.sh taxids.txt per_gene/EOG091G05TG/EOG091G05TG.orthodb.fasta > per_gene/EOG091G05TG/EOG091G05TG.outgroup.fasta
        

[Sun Jul  5 21:28:06 2020]
rule get_outgroups:
    input: per_gene/EOG091G01XI/EOG091G01XI.ingroup.fasta
    output: per_gene/EOG091G01XI/EOG091G01XI.orthodb.fasta, per_gene/EOG091G01XI/EOG091G01XI.outgroup.fasta
    log: per_gene/EOG091G01XI/get_outgroups.stdout.txt, per_gene/EOG091G01XI/get_outgroups.stderr.txt
    jobid: 2489
    wildcards: BUSCO=EOG091G01XI


        #download fastas from Orhtodb for BUSCO id
        for i in {1..5}
        do
             wget "http://www.orthodb.org/fasta?query=EOG091G01XI&level=33208" -O per_gene/EOG091G01XI/EOG091G01XI.orthodb.fasta 1> per_gene/EOG091G01XI/get_outgroups.stdout.txt 2> per_gene/EOG091G01XI/get_outgroups.stderr.txt && break || echo -e "try again ($i)" && sleep 15
        done

	#This is quick an dirty for now and just takes the first protein if there is more than one for an outgroup taxon
        bash ../scripts/download_outgroups.sh taxids.txt per_gene/EOG091G01XI/EOG091G01XI.orthodb.fasta > per_gene/EOG091G01XI/EOG091G01XI.outgroup.fasta
        

[Sun Jul  5 21:28:06 2020]
rule get_outgroups:
    input: per_gene/EOG091G0ZDR/EOG091G0ZDR.ingroup.fasta
    output: per_gene/EOG091G0ZDR/EOG091G0ZDR.orthodb.fasta, per_gene/EOG091G0ZDR/EOG091G0ZDR.outgroup.fasta
    log: per_gene/EOG091G0ZDR/get_outgroups.stdout.txt, per_gene/EOG091G0ZDR/get_outgroups.stderr.txt
    jobid: 3257
    wildcards: BUSCO=EOG091G0ZDR


        #download fastas from Orhtodb for BUSCO id
        for i in {1..5}
        do
             wget "http://www.orthodb.org/fasta?query=EOG091G0ZDR&level=33208" -O per_gene/EOG091G0ZDR/EOG091G0ZDR.orthodb.fasta 1> per_gene/EOG091G0ZDR/get_outgroups.stdout.txt 2> per_gene/EOG091G0ZDR/get_outgroups.stderr.txt && break || echo -e "try again ($i)" && sleep 15
        done

	#This is quick an dirty for now and just takes the first protein if there is more than one for an outgroup taxon
        bash ../scripts/download_outgroups.sh taxids.txt per_gene/EOG091G0ZDR/EOG091G0ZDR.orthodb.fasta > per_gene/EOG091G0ZDR/EOG091G0ZDR.outgroup.fasta
        

[Sun Jul  5 21:28:06 2020]
rule get_outgroups:
    input: per_gene/EOG091G0L5D/EOG091G0L5D.ingroup.fasta
    output: per_gene/EOG091G0L5D/EOG091G0L5D.orthodb.fasta, per_gene/EOG091G0L5D/EOG091G0L5D.outgroup.fasta
    log: per_gene/EOG091G0L5D/get_outgroups.stdout.txt, per_gene/EOG091G0L5D/get_outgroups.stderr.txt
    jobid: 3277
    wildcards: BUSCO=EOG091G0L5D


        #download fastas from Orhtodb for BUSCO id
        for i in {1..5}
        do
             wget "http://www.orthodb.org/fasta?query=EOG091G0L5D&level=33208" -O per_gene/EOG091G0L5D/EOG091G0L5D.orthodb.fasta 1> per_gene/EOG091G0L5D/get_outgroups.stdout.txt 2> per_gene/EOG091G0L5D/get_outgroups.stderr.txt && break || echo -e "try again ($i)" && sleep 15
        done

	#This is quick an dirty for now and just takes the first protein if there is more than one for an outgroup taxon
        bash ../scripts/download_outgroups.sh taxids.txt per_gene/EOG091G0L5D/EOG091G0L5D.orthodb.fasta > per_gene/EOG091G0L5D/EOG091G0L5D.outgroup.fasta
        

[Sun Jul  5 21:28:06 2020]
rule get_outgroups:
    input: per_gene/EOG091G0PAG/EOG091G0PAG.ingroup.fasta
    output: per_gene/EOG091G0PAG/EOG091G0PAG.orthodb.fasta, per_gene/EOG091G0PAG/EOG091G0PAG.outgroup.fasta
    log: per_gene/EOG091G0PAG/get_outgroups.stdout.txt, per_gene/EOG091G0PAG/get_outgroups.stderr.txt
    jobid: 2801
    wildcards: BUSCO=EOG091G0PAG


        #download fastas from Orhtodb for BUSCO id
        for i in {1..5}
        do
             wget "http://www.orthodb.org/fasta?query=EOG091G0PAG&level=33208" -O per_gene/EOG091G0PAG/EOG091G0PAG.orthodb.fasta 1> per_gene/EOG091G0PAG/get_outgroups.stdout.txt 2> per_gene/EOG091G0PAG/get_outgroups.stderr.txt && break || echo -e "try again ($i)" && sleep 15
        done

	#This is quick an dirty for now and just takes the first protein if there is more than one for an outgroup taxon
        bash ../scripts/download_outgroups.sh taxids.txt per_gene/EOG091G0PAG/EOG091G0PAG.orthodb.fasta > per_gene/EOG091G0PAG/EOG091G0PAG.outgroup.fasta
        
[Sun Jul  5 21:28:07 2020]
Finished job 2957.
8 of 3292 steps (0.24%) done
[Sun Jul  5 21:28:08 2020]
Finished job 2576.
9 of 3292 steps (0.27%) done
[Sun Jul  5 21:28:08 2020]
Finished job 3170.
10 of 3292 steps (0.30%) done
[Sun Jul  5 21:28:08 2020]
Finished job 2902.
11 of 3292 steps (0.33%) done
[Sun Jul  5 21:28:08 2020]
Finished job 2978.
12 of 3292 steps (0.36%) done
[Sun Jul  5 21:28:08 2020]
Finished job 2924.
13 of 3292 steps (0.39%) done
[Sun Jul  5 21:28:08 2020]
Finished job 2988.
14 of 3292 steps (0.43%) done

[Sun Jul  5 21:28:08 2020]
rule get_seqs:
    input: /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ingroup.txt, /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/outgroup.txt
    output: per_gene/EOG091G0SNM/EOG091G0SNM.ingroup.fasta
    log: per_gene/EOG091G0SNM/get_seqs.stdout.txt, per_gene/EOG091G0SNM/get_seqs.stderr.txt
    jobid: 3022
    wildcards: BUSCO=EOG091G0SNM
    threads: 2


	basedir=$(pwd)
        cd per_gene/EOG091G0SNM
        
        bash $basedir/../scripts/fetch_seqs.sh EOG091G0SNM /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ingroup.txt /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/outgroup.txt 1> ../../per_gene/EOG091G0SNM/get_seqs.stdout.txt 2> ../../per_gene/EOG091G0SNM/get_seqs.stderr.txt
	mv EOG091G0SNM.fasta $basedir/per_gene/EOG091G0SNM/EOG091G0SNM.ingroup.fasta
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/72476f9d9a5bd0627b4d721143a21354.simg

[Sun Jul  5 21:28:09 2020]
rule get_seqs:
    input: /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ingroup.txt, /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/outgroup.txt
    output: per_gene/EOG091G09MD/EOG091G09MD.ingroup.fasta
    log: per_gene/EOG091G09MD/get_seqs.stdout.txt, per_gene/EOG091G09MD/get_seqs.stderr.txt
    jobid: 3080
    wildcards: BUSCO=EOG091G09MD
    threads: 2


	basedir=$(pwd)
        cd per_gene/EOG091G09MD
        
        bash $basedir/../scripts/fetch_seqs.sh EOG091G09MD /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ingroup.txt /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/outgroup.txt 1> ../../per_gene/EOG091G09MD/get_seqs.stdout.txt 2> ../../per_gene/EOG091G09MD/get_seqs.stderr.txt
	mv EOG091G09MD.fasta $basedir/per_gene/EOG091G09MD/EOG091G09MD.ingroup.fasta
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/72476f9d9a5bd0627b4d721143a21354.simg

[Sun Jul  5 21:28:09 2020]
rule get_seqs:
    input: /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ingroup.txt, /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/outgroup.txt
    output: per_gene/EOG091G0N9D/EOG091G0N9D.ingroup.fasta
    log: per_gene/EOG091G0N9D/get_seqs.stdout.txt, per_gene/EOG091G0N9D/get_seqs.stderr.txt
    jobid: 3004
    wildcards: BUSCO=EOG091G0N9D
    threads: 2


	basedir=$(pwd)
        cd per_gene/EOG091G0N9D
        
        bash $basedir/../scripts/fetch_seqs.sh EOG091G0N9D /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ingroup.txt /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/outgroup.txt 1> ../../per_gene/EOG091G0N9D/get_seqs.stdout.txt 2> ../../per_gene/EOG091G0N9D/get_seqs.stderr.txt
	mv EOG091G0N9D.fasta $basedir/per_gene/EOG091G0N9D/EOG091G0N9D.ingroup.fasta
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/72476f9d9a5bd0627b4d721143a21354.simg

[Sun Jul  5 21:28:09 2020]
rule get_outgroups:
    input: per_gene/EOG091G0YZ0/EOG091G0YZ0.ingroup.fasta
    output: per_gene/EOG091G0YZ0/EOG091G0YZ0.orthodb.fasta, per_gene/EOG091G0YZ0/EOG091G0YZ0.outgroup.fasta
    log: per_gene/EOG091G0YZ0/get_outgroups.stdout.txt, per_gene/EOG091G0YZ0/get_outgroups.stderr.txt
    jobid: 2903
    wildcards: BUSCO=EOG091G0YZ0


        #download fastas from Orhtodb for BUSCO id
        for i in {1..5}
        do
             wget "http://www.orthodb.org/fasta?query=EOG091G0YZ0&level=33208" -O per_gene/EOG091G0YZ0/EOG091G0YZ0.orthodb.fasta 1> per_gene/EOG091G0YZ0/get_outgroups.stdout.txt 2> per_gene/EOG091G0YZ0/get_outgroups.stderr.txt && break || echo -e "try again ($i)" && sleep 15
        done

	#This is quick an dirty for now and just takes the first protein if there is more than one for an outgroup taxon
        bash ../scripts/download_outgroups.sh taxids.txt per_gene/EOG091G0YZ0/EOG091G0YZ0.orthodb.fasta > per_gene/EOG091G0YZ0/EOG091G0YZ0.outgroup.fasta
        

[Sun Jul  5 21:28:09 2020]
rule get_outgroups:
    input: per_gene/EOG091G07IK/EOG091G07IK.ingroup.fasta
    output: per_gene/EOG091G07IK/EOG091G07IK.orthodb.fasta, per_gene/EOG091G07IK/EOG091G07IK.outgroup.fasta
    log: per_gene/EOG091G07IK/get_outgroups.stdout.txt, per_gene/EOG091G07IK/get_outgroups.stderr.txt
    jobid: 2577
    wildcards: BUSCO=EOG091G07IK


        #download fastas from Orhtodb for BUSCO id
        for i in {1..5}
        do
             wget "http://www.orthodb.org/fasta?query=EOG091G07IK&level=33208" -O per_gene/EOG091G07IK/EOG091G07IK.orthodb.fasta 1> per_gene/EOG091G07IK/get_outgroups.stdout.txt 2> per_gene/EOG091G07IK/get_outgroups.stderr.txt && break || echo -e "try again ($i)" && sleep 15
        done

	#This is quick an dirty for now and just takes the first protein if there is more than one for an outgroup taxon
        bash ../scripts/download_outgroups.sh taxids.txt per_gene/EOG091G07IK/EOG091G07IK.orthodb.fasta > per_gene/EOG091G07IK/EOG091G07IK.outgroup.fasta
        

[Sun Jul  5 21:28:09 2020]
rule get_outgroups:
    input: per_gene/EOG091G0FJB/EOG091G0FJB.ingroup.fasta
    output: per_gene/EOG091G0FJB/EOG091G0FJB.orthodb.fasta, per_gene/EOG091G0FJB/EOG091G0FJB.outgroup.fasta
    log: per_gene/EOG091G0FJB/get_outgroups.stdout.txt, per_gene/EOG091G0FJB/get_outgroups.stderr.txt
    jobid: 2979
    wildcards: BUSCO=EOG091G0FJB


        #download fastas from Orhtodb for BUSCO id
        for i in {1..5}
        do
             wget "http://www.orthodb.org/fasta?query=EOG091G0FJB&level=33208" -O per_gene/EOG091G0FJB/EOG091G0FJB.orthodb.fasta 1> per_gene/EOG091G0FJB/get_outgroups.stdout.txt 2> per_gene/EOG091G0FJB/get_outgroups.stderr.txt && break || echo -e "try again ($i)" && sleep 15
        done

	#This is quick an dirty for now and just takes the first protein if there is more than one for an outgroup taxon
        bash ../scripts/download_outgroups.sh taxids.txt per_gene/EOG091G0FJB/EOG091G0FJB.orthodb.fasta > per_gene/EOG091G0FJB/EOG091G0FJB.outgroup.fasta
        

[Sun Jul  5 21:28:09 2020]
rule get_outgroups:
    input: per_gene/EOG091G0A5N/EOG091G0A5N.ingroup.fasta
    output: per_gene/EOG091G0A5N/EOG091G0A5N.orthodb.fasta, per_gene/EOG091G0A5N/EOG091G0A5N.outgroup.fasta
    log: per_gene/EOG091G0A5N/get_outgroups.stdout.txt, per_gene/EOG091G0A5N/get_outgroups.stderr.txt
    jobid: 3171
    wildcards: BUSCO=EOG091G0A5N


        #download fastas from Orhtodb for BUSCO id
        for i in {1..5}
        do
             wget "http://www.orthodb.org/fasta?query=EOG091G0A5N&level=33208" -O per_gene/EOG091G0A5N/EOG091G0A5N.orthodb.fasta 1> per_gene/EOG091G0A5N/get_outgroups.stdout.txt 2> per_gene/EOG091G0A5N/get_outgroups.stderr.txt && break || echo -e "try again ($i)" && sleep 15
        done

	#This is quick an dirty for now and just takes the first protein if there is more than one for an outgroup taxon
        bash ../scripts/download_outgroups.sh taxids.txt per_gene/EOG091G0A5N/EOG091G0A5N.orthodb.fasta > per_gene/EOG091G0A5N/EOG091G0A5N.outgroup.fasta
        

[Sun Jul  5 21:28:09 2020]
rule get_outgroups:
    input: per_gene/EOG091G0IVB/EOG091G0IVB.ingroup.fasta
    output: per_gene/EOG091G0IVB/EOG091G0IVB.orthodb.fasta, per_gene/EOG091G0IVB/EOG091G0IVB.outgroup.fasta
    log: per_gene/EOG091G0IVB/get_outgroups.stdout.txt, per_gene/EOG091G0IVB/get_outgroups.stderr.txt
    jobid: 2989
    wildcards: BUSCO=EOG091G0IVB


        #download fastas from Orhtodb for BUSCO id
        for i in {1..5}
        do
             wget "http://www.orthodb.org/fasta?query=EOG091G0IVB&level=33208" -O per_gene/EOG091G0IVB/EOG091G0IVB.orthodb.fasta 1> per_gene/EOG091G0IVB/get_outgroups.stdout.txt 2> per_gene/EOG091G0IVB/get_outgroups.stderr.txt && break || echo -e "try again ($i)" && sleep 15
        done

	#This is quick an dirty for now and just takes the first protein if there is more than one for an outgroup taxon
        bash ../scripts/download_outgroups.sh taxids.txt per_gene/EOG091G0IVB/EOG091G0IVB.orthodb.fasta > per_gene/EOG091G0IVB/EOG091G0IVB.outgroup.fasta
        

[Sun Jul  5 21:28:09 2020]
rule get_outgroups:
    input: per_gene/EOG091G1285/EOG091G1285.ingroup.fasta
    output: per_gene/EOG091G1285/EOG091G1285.orthodb.fasta, per_gene/EOG091G1285/EOG091G1285.outgroup.fasta
    log: per_gene/EOG091G1285/get_outgroups.stdout.txt, per_gene/EOG091G1285/get_outgroups.stderr.txt
    jobid: 2925
    wildcards: BUSCO=EOG091G1285


        #download fastas from Orhtodb for BUSCO id
        for i in {1..5}
        do
             wget "http://www.orthodb.org/fasta?query=EOG091G1285&level=33208" -O per_gene/EOG091G1285/EOG091G1285.orthodb.fasta 1> per_gene/EOG091G1285/get_outgroups.stdout.txt 2> per_gene/EOG091G1285/get_outgroups.stderr.txt && break || echo -e "try again ($i)" && sleep 15
        done

	#This is quick an dirty for now and just takes the first protein if there is more than one for an outgroup taxon
        bash ../scripts/download_outgroups.sh taxids.txt per_gene/EOG091G1285/EOG091G1285.orthodb.fasta > per_gene/EOG091G1285/EOG091G1285.outgroup.fasta
        

[Sun Jul  5 21:28:09 2020]
rule join_groups:
    input: per_gene/EOG091G05TG/EOG091G05TG.ingroup.fasta, per_gene/EOG091G05TG/EOG091G05TG.outgroup.fasta
    output: per_gene/EOG091G05TG/EOG091G05TG.fasta
    jobid: 2302
    wildcards: BUSCO=EOG091G05TG


        cat per_gene/EOG091G05TG/EOG091G05TG.ingroup.fasta per_gene/EOG091G05TG/EOG091G05TG.outgroup.fasta > per_gene/EOG091G05TG/EOG091G05TG.fasta
        
[Sun Jul  5 21:28:09 2020]
Finished job 2719.
15 of 3292 steps (0.46%) done
[Sun Jul  5 21:28:09 2020]
Finished job 2642.
16 of 3292 steps (0.49%) done
[Sun Jul  5 21:28:09 2020]
Finished job 2848.
17 of 3292 steps (0.52%) done
[Sun Jul  5 21:28:09 2020]
Finished job 2302.
18 of 3292 steps (0.55%) done
[Sun Jul  5 21:28:09 2020]
Finished job 2801.
19 of 3292 steps (0.58%) done
[Sun Jul  5 21:28:10 2020]
Finished job 2624.
20 of 3292 steps (0.61%) done

[Sun Jul  5 21:28:10 2020]
rule get_seqs:
    input: /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ingroup.txt, /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/outgroup.txt
    output: per_gene/EOG091G0XN1/EOG091G0XN1.ingroup.fasta
    log: per_gene/EOG091G0XN1/get_seqs.stdout.txt, per_gene/EOG091G0XN1/get_seqs.stderr.txt
    jobid: 2890
    wildcards: BUSCO=EOG091G0XN1
    threads: 2


	basedir=$(pwd)
        cd per_gene/EOG091G0XN1
        
        bash $basedir/../scripts/fetch_seqs.sh EOG091G0XN1 /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ingroup.txt /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/outgroup.txt 1> ../../per_gene/EOG091G0XN1/get_seqs.stdout.txt 2> ../../per_gene/EOG091G0XN1/get_seqs.stderr.txt
	mv EOG091G0XN1.fasta $basedir/per_gene/EOG091G0XN1/EOG091G0XN1.ingroup.fasta
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/72476f9d9a5bd0627b4d721143a21354.simg

[Sun Jul  5 21:28:10 2020]
rule get_seqs:
    input: /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ingroup.txt, /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/outgroup.txt
    output: per_gene/EOG091G146E/EOG091G146E.ingroup.fasta
    log: per_gene/EOG091G146E/get_seqs.stdout.txt, per_gene/EOG091G146E/get_seqs.stderr.txt
    jobid: 2930
    wildcards: BUSCO=EOG091G146E
    threads: 2


	basedir=$(pwd)
        cd per_gene/EOG091G146E
        
        bash $basedir/../scripts/fetch_seqs.sh EOG091G146E /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ingroup.txt /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/outgroup.txt 1> ../../per_gene/EOG091G146E/get_seqs.stdout.txt 2> ../../per_gene/EOG091G146E/get_seqs.stderr.txt
	mv EOG091G146E.fasta $basedir/per_gene/EOG091G146E/EOG091G146E.ingroup.fasta
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/72476f9d9a5bd0627b4d721143a21354.simg

[Sun Jul  5 21:28:10 2020]
rule get_outgroups:
    input: per_gene/EOG091G0SU6/EOG091G0SU6.ingroup.fasta
    output: per_gene/EOG091G0SU6/EOG091G0SU6.orthodb.fasta, per_gene/EOG091G0SU6/EOG091G0SU6.outgroup.fasta
    log: per_gene/EOG091G0SU6/get_outgroups.stdout.txt, per_gene/EOG091G0SU6/get_outgroups.stderr.txt
    jobid: 2849
    wildcards: BUSCO=EOG091G0SU6


        #download fastas from Orhtodb for BUSCO id
        for i in {1..5}
        do
             wget "http://www.orthodb.org/fasta?query=EOG091G0SU6&level=33208" -O per_gene/EOG091G0SU6/EOG091G0SU6.orthodb.fasta 1> per_gene/EOG091G0SU6/get_outgroups.stdout.txt 2> per_gene/EOG091G0SU6/get_outgroups.stderr.txt && break || echo -e "try again ($i)" && sleep 15
        done

	#This is quick an dirty for now and just takes the first protein if there is more than one for an outgroup taxon
        bash ../scripts/download_outgroups.sh taxids.txt per_gene/EOG091G0SU6/EOG091G0SU6.orthodb.fasta > per_gene/EOG091G0SU6/EOG091G0SU6.outgroup.fasta
        

[Sun Jul  5 21:28:10 2020]
rule get_outgroups:
    input: per_gene/EOG091G0C8H/EOG091G0C8H.ingroup.fasta
    output: per_gene/EOG091G0C8H/EOG091G0C8H.orthodb.fasta, per_gene/EOG091G0C8H/EOG091G0C8H.outgroup.fasta
    log: per_gene/EOG091G0C8H/get_outgroups.stdout.txt, per_gene/EOG091G0C8H/get_outgroups.stderr.txt
    jobid: 2643
    wildcards: BUSCO=EOG091G0C8H


        #download fastas from Orhtodb for BUSCO id
        for i in {1..5}
        do
             wget "http://www.orthodb.org/fasta?query=EOG091G0C8H&level=33208" -O per_gene/EOG091G0C8H/EOG091G0C8H.orthodb.fasta 1> per_gene/EOG091G0C8H/get_outgroups.stdout.txt 2> per_gene/EOG091G0C8H/get_outgroups.stderr.txt && break || echo -e "try again ($i)" && sleep 15
        done

	#This is quick an dirty for now and just takes the first protein if there is more than one for an outgroup taxon
        bash ../scripts/download_outgroups.sh taxids.txt per_gene/EOG091G0C8H/EOG091G0C8H.orthodb.fasta > per_gene/EOG091G0C8H/EOG091G0C8H.outgroup.fasta
        

[Sun Jul  5 21:28:10 2020]
rule join_groups:
    input: per_gene/EOG091G0ITS/EOG091G0ITS.ingroup.fasta, per_gene/EOG091G0ITS/EOG091G0ITS.outgroup.fasta
    output: per_gene/EOG091G0ITS/EOG091G0ITS.fasta
    jobid: 2183
    wildcards: BUSCO=EOG091G0ITS


        cat per_gene/EOG091G0ITS/EOG091G0ITS.ingroup.fasta per_gene/EOG091G0ITS/EOG091G0ITS.outgroup.fasta > per_gene/EOG091G0ITS/EOG091G0ITS.fasta
        

[Sun Jul  5 21:28:10 2020]
rule MSA:
    input: per_gene/EOG091G05TG/EOG091G05TG.fasta
    output: per_gene/EOG091G05TG/EOG091G05TG.clustalo.fasta
    log: per_gene/EOG091G05TG/MSA.stdout.txt, per_gene/EOG091G05TG/MSA.stderr.txt
    jobid: 1724
    wildcards: BUSCO=EOG091G05TG
    threads: 2


        clustalo -i per_gene/EOG091G05TG/EOG091G05TG.fasta -o per_gene/EOG091G05TG/EOG091G05TG.clustalo.fasta --threads=2 1> per_gene/EOG091G05TG/MSA.stdout.txt 2> per_gene/EOG091G05TG/MSA.stderr.txt
        
[Sun Jul  5 21:28:10 2020]
Finished job 2183.
21 of 3292 steps (0.64%) done
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/d68c9691725a7401923680874285c430.simg

[Sun Jul  5 21:28:10 2020]
rule get_outgroups:
    input: per_gene/EOG091G0AKW/EOG091G0AKW.ingroup.fasta
    output: per_gene/EOG091G0AKW/EOG091G0AKW.orthodb.fasta, per_gene/EOG091G0AKW/EOG091G0AKW.outgroup.fasta
    log: per_gene/EOG091G0AKW/get_outgroups.stdout.txt, per_gene/EOG091G0AKW/get_outgroups.stderr.txt
    jobid: 2625
    wildcards: BUSCO=EOG091G0AKW


        #download fastas from Orhtodb for BUSCO id
        for i in {1..5}
        do
             wget "http://www.orthodb.org/fasta?query=EOG091G0AKW&level=33208" -O per_gene/EOG091G0AKW/EOG091G0AKW.orthodb.fasta 1> per_gene/EOG091G0AKW/get_outgroups.stdout.txt 2> per_gene/EOG091G0AKW/get_outgroups.stderr.txt && break || echo -e "try again ($i)" && sleep 15
        done

	#This is quick an dirty for now and just takes the first protein if there is more than one for an outgroup taxon
        bash ../scripts/download_outgroups.sh taxids.txt per_gene/EOG091G0AKW/EOG091G0AKW.orthodb.fasta > per_gene/EOG091G0AKW/EOG091G0AKW.outgroup.fasta
        

[Sun Jul  5 21:28:10 2020]
rule join_groups:
    input: per_gene/EOG091G0PAG/EOG091G0PAG.ingroup.fasta, per_gene/EOG091G0PAG/EOG091G0PAG.outgroup.fasta
    output: per_gene/EOG091G0PAG/EOG091G0PAG.fasta
    jobid: 2224
    wildcards: BUSCO=EOG091G0PAG


        cat per_gene/EOG091G0PAG/EOG091G0PAG.ingroup.fasta per_gene/EOG091G0PAG/EOG091G0PAG.outgroup.fasta > per_gene/EOG091G0PAG/EOG091G0PAG.fasta
        
[Sun Jul  5 21:28:10 2020]
Finished job 2224.
22 of 3292 steps (0.67%) done
[Sun Jul  5 21:28:11 2020]
Finished job 2903.
23 of 3292 steps (0.70%) done

[Sun Jul  5 21:28:11 2020]
rule MSA:
    input: per_gene/EOG091G0ITS/EOG091G0ITS.fasta
    output: per_gene/EOG091G0ITS/EOG091G0ITS.clustalo.fasta
    log: per_gene/EOG091G0ITS/MSA.stdout.txt, per_gene/EOG091G0ITS/MSA.stderr.txt
    jobid: 1486
    wildcards: BUSCO=EOG091G0ITS
    threads: 2


        clustalo -i per_gene/EOG091G0ITS/EOG091G0ITS.fasta -o per_gene/EOG091G0ITS/EOG091G0ITS.clustalo.fasta --threads=2 1> per_gene/EOG091G0ITS/MSA.stdout.txt 2> per_gene/EOG091G0ITS/MSA.stderr.txt
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/d68c9691725a7401923680874285c430.simg
[Sun Jul  5 21:28:11 2020]
Finished job 2577.
24 of 3292 steps (0.73%) done

[Sun Jul  5 21:28:12 2020]
rule join_groups:
    input: per_gene/EOG091G07IK/EOG091G07IK.ingroup.fasta, per_gene/EOG091G07IK/EOG091G07IK.outgroup.fasta
    output: per_gene/EOG091G07IK/EOG091G07IK.fasta
    jobid: 2112
    wildcards: BUSCO=EOG091G07IK


        cat per_gene/EOG091G07IK/EOG091G07IK.ingroup.fasta per_gene/EOG091G07IK/EOG091G07IK.outgroup.fasta > per_gene/EOG091G07IK/EOG091G07IK.fasta
        
[Sun Jul  5 21:28:12 2020]
Finished job 2112.
25 of 3292 steps (0.76%) done
[Sun Jul  5 21:28:12 2020]
Finished job 1486.
26 of 3292 steps (0.79%) done

[Sun Jul  5 21:28:12 2020]
rule MSA:
    input: per_gene/EOG091G07IK/EOG091G07IK.fasta
    output: per_gene/EOG091G07IK/EOG091G07IK.clustalo.fasta
    log: per_gene/EOG091G07IK/MSA.stdout.txt, per_gene/EOG091G07IK/MSA.stderr.txt
    jobid: 1344
    wildcards: BUSCO=EOG091G07IK
    threads: 2


        clustalo -i per_gene/EOG091G07IK/EOG091G07IK.fasta -o per_gene/EOG091G07IK/EOG091G07IK.clustalo.fasta --threads=2 1> per_gene/EOG091G07IK/MSA.stdout.txt 2> per_gene/EOG091G07IK/MSA.stderr.txt
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/d68c9691725a7401923680874285c430.simg

[Sun Jul  5 21:28:12 2020]
rule join_groups:
    input: per_gene/EOG091G0YZ0/EOG091G0YZ0.ingroup.fasta, per_gene/EOG091G0YZ0/EOG091G0YZ0.outgroup.fasta
    output: per_gene/EOG091G0YZ0/EOG091G0YZ0.fasta
    jobid: 2275
    wildcards: BUSCO=EOG091G0YZ0


        cat per_gene/EOG091G0YZ0/EOG091G0YZ0.ingroup.fasta per_gene/EOG091G0YZ0/EOG091G0YZ0.outgroup.fasta > per_gene/EOG091G0YZ0/EOG091G0YZ0.fasta
        
[Sun Jul  5 21:28:12 2020]
Finished job 2275.
27 of 3292 steps (0.82%) done
[Sun Jul  5 21:28:12 2020]
Finished job 2625.
28 of 3292 steps (0.85%) done

[Sun Jul  5 21:28:12 2020]
rule score_and_cut:
    input: per_gene/EOG091G0ITS/EOG091G0ITS.clustalo.fasta
    output: per_gene/EOG091G0ITS/ALICUT_EOG091G0ITS.clustalo.fasta
    jobid: 663
    wildcards: BUSCO=EOG091G0ITS
    threads: 2


        cd per_gene/EOG091G0ITS
        Aliscore.pl -N -r 200000000000000000 -i ../../per_gene/EOG091G0ITS/EOG091G0ITS.clustalo.fasta &> aliscore.log
        ALICUT.pl -s &> alicut.log
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/63c88c27a0fa300f57066b0ef65fefcb.simg
[Sun Jul  5 21:28:13 2020]
Finished job 1724.
29 of 3292 steps (0.88%) done

[Sun Jul  5 21:28:13 2020]
rule score_and_cut:
    input: per_gene/EOG091G05TG/EOG091G05TG.clustalo.fasta
    output: per_gene/EOG091G05TG/ALICUT_EOG091G05TG.clustalo.fasta
    jobid: 901
    wildcards: BUSCO=EOG091G05TG
    threads: 2


        cd per_gene/EOG091G05TG
        Aliscore.pl -N -r 200000000000000000 -i ../../per_gene/EOG091G05TG/EOG091G05TG.clustalo.fasta &> aliscore.log
        ALICUT.pl -s &> alicut.log
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/63c88c27a0fa300f57066b0ef65fefcb.simg
[Sun Jul  5 21:28:14 2020]
Finished job 1344.
30 of 3292 steps (0.91%) done

[Sun Jul  5 21:28:14 2020]
rule score_and_cut:
    input: per_gene/EOG091G07IK/EOG091G07IK.clustalo.fasta
    output: per_gene/EOG091G07IK/ALICUT_EOG091G07IK.clustalo.fasta
    jobid: 521
    wildcards: BUSCO=EOG091G07IK
    threads: 2


        cd per_gene/EOG091G07IK
        Aliscore.pl -N -r 200000000000000000 -i ../../per_gene/EOG091G07IK/EOG091G07IK.clustalo.fasta &> aliscore.log
        ALICUT.pl -s &> alicut.log
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/63c88c27a0fa300f57066b0ef65fefcb.simg
[Sun Jul  5 21:28:23 2020]
Finished job 663.
31 of 3292 steps (0.94%) done

[Sun Jul  5 21:28:23 2020]
rule join_groups:
    input: per_gene/EOG091G0AKW/EOG091G0AKW.ingroup.fasta, per_gene/EOG091G0AKW/EOG091G0AKW.outgroup.fasta
    output: per_gene/EOG091G0AKW/EOG091G0AKW.fasta
    jobid: 2136
    wildcards: BUSCO=EOG091G0AKW


        cat per_gene/EOG091G0AKW/EOG091G0AKW.ingroup.fasta per_gene/EOG091G0AKW/EOG091G0AKW.outgroup.fasta > per_gene/EOG091G0AKW/EOG091G0AKW.fasta
        

[Sun Jul  5 21:28:23 2020]
rule remove_empty:
    input: per_gene/EOG091G0ITS/ALICUT_EOG091G0ITS.clustalo.fasta
    output: per_gene/EOG091G0ITS/empty_check.done
    jobid: 1485
    wildcards: BUSCO=EOG091G0ITS


         if [ "$(cat per_gene/EOG091G0ITS/ALICUT_EOG091G0ITS.clustalo.fasta | grep -v ">" | sed 's/-//g' | grep "^$" | wc -l)" -gt 0 ]
         then
              cp per_gene/EOG091G0ITS/ALICUT_EOG091G0ITS.clustalo.fasta per_gene/EOG091G0ITS/ALICUT_EOG091G0ITS.clustalo.fasta.backup
              bash ../scripts/remove_empty.sh per_gene/EOG091G0ITS/ALICUT_EOG091G0ITS.clustalo.fasta.backup > per_gene/EOG091G0ITS/ALICUT_EOG091G0ITS.clustalo.fasta
         fi
         touch per_gene/EOG091G0ITS/empty_check.done
         
[Sun Jul  5 21:28:23 2020]
Finished job 2136.
32 of 3292 steps (0.97%) done
[Sun Jul  5 21:28:23 2020]
Finished job 1485.
33 of 3292 steps (1%) done

[Sun Jul  5 21:28:23 2020]
rule MSA:
    input: per_gene/EOG091G0AKW/EOG091G0AKW.fasta
    output: per_gene/EOG091G0AKW/EOG091G0AKW.clustalo.fasta
    log: per_gene/EOG091G0AKW/MSA.stdout.txt, per_gene/EOG091G0AKW/MSA.stderr.txt
    jobid: 1392
    wildcards: BUSCO=EOG091G0AKW
    threads: 2


        clustalo -i per_gene/EOG091G0AKW/EOG091G0AKW.fasta -o per_gene/EOG091G0AKW/EOG091G0AKW.clustalo.fasta --threads=2 1> per_gene/EOG091G0AKW/MSA.stdout.txt 2> per_gene/EOG091G0AKW/MSA.stderr.txt
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/d68c9691725a7401923680874285c430.simg
[Sun Jul  5 21:28:23 2020]
Finished job 901.
34 of 3292 steps (1%) done

[Sun Jul  5 21:28:23 2020]
rule remove_empty:
    input: per_gene/EOG091G05TG/ALICUT_EOG091G05TG.clustalo.fasta
    output: per_gene/EOG091G05TG/empty_check.done
    jobid: 1723
    wildcards: BUSCO=EOG091G05TG


         if [ "$(cat per_gene/EOG091G05TG/ALICUT_EOG091G05TG.clustalo.fasta | grep -v ">" | sed 's/-//g' | grep "^$" | wc -l)" -gt 0 ]
         then
              cp per_gene/EOG091G05TG/ALICUT_EOG091G05TG.clustalo.fasta per_gene/EOG091G05TG/ALICUT_EOG091G05TG.clustalo.fasta.backup
              bash ../scripts/remove_empty.sh per_gene/EOG091G05TG/ALICUT_EOG091G05TG.clustalo.fasta.backup > per_gene/EOG091G05TG/ALICUT_EOG091G05TG.clustalo.fasta
         fi
         touch per_gene/EOG091G05TG/empty_check.done
         
[Sun Jul  5 21:28:24 2020]
Finished job 2489.
35 of 3292 steps (1%) done
[Sun Jul  5 21:28:24 2020]
Finished job 1723.
36 of 3292 steps (1%) done
[Sun Jul  5 21:28:24 2020]
Finished job 521.
37 of 3292 steps (1%) done

[Sun Jul  5 21:28:24 2020]
rule find_best_model:
    input: per_gene/EOG091G05TG/ALICUT_EOG091G05TG.clustalo.fasta, per_gene/EOG091G05TG/empty_check.done
    output: per_gene/EOG091G05TG/EOG091G05TG.best_model
    log: per_gene/EOG091G05TG/find_best_model.stderr.txt
    jobid: 900
    wildcards: BUSCO=EOG091G05TG
    threads: 2


        cd per_gene/EOG091G05TG
        if [ ! -d find_best_model ]
        then
            mkdir find_best_model
        fi
        cd find_best_model
        ln -s ../../../per_gene/EOG091G05TG/ALICUT_EOG091G05TG.clustalo.fasta EOG091G05TG.fasta
        ProteinModelSelection.pl EOG091G05TG.fasta 1> ../../../per_gene/EOG091G05TG/EOG091G05TG.best_model 2> ../../../per_gene/EOG091G05TG/find_best_model.stderr.txt
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/c0c09ee657b1e27f2c5687e0e9aa8d70.simg

[Sun Jul  5 21:28:24 2020]
rule join_groups:
    input: per_gene/EOG091G01XI/EOG091G01XI.ingroup.fasta, per_gene/EOG091G01XI/EOG091G01XI.outgroup.fasta
    output: per_gene/EOG091G01XI/EOG091G01XI.fasta
    jobid: 2068
    wildcards: BUSCO=EOG091G01XI


        cat per_gene/EOG091G01XI/EOG091G01XI.ingroup.fasta per_gene/EOG091G01XI/EOG091G01XI.outgroup.fasta > per_gene/EOG091G01XI/EOG091G01XI.fasta
        

[Sun Jul  5 21:28:24 2020]
rule remove_empty:
    input: per_gene/EOG091G07IK/ALICUT_EOG091G07IK.clustalo.fasta
    output: per_gene/EOG091G07IK/empty_check.done
    jobid: 1343
    wildcards: BUSCO=EOG091G07IK


         if [ "$(cat per_gene/EOG091G07IK/ALICUT_EOG091G07IK.clustalo.fasta | grep -v ">" | sed 's/-//g' | grep "^$" | wc -l)" -gt 0 ]
         then
              cp per_gene/EOG091G07IK/ALICUT_EOG091G07IK.clustalo.fasta per_gene/EOG091G07IK/ALICUT_EOG091G07IK.clustalo.fasta.backup
              bash ../scripts/remove_empty.sh per_gene/EOG091G07IK/ALICUT_EOG091G07IK.clustalo.fasta.backup > per_gene/EOG091G07IK/ALICUT_EOG091G07IK.clustalo.fasta
         fi
         touch per_gene/EOG091G07IK/empty_check.done
         
[Sun Jul  5 21:28:24 2020]
Finished job 2068.
38 of 3292 steps (1%) done
[Sun Jul  5 21:28:24 2020]
Finished job 1343.
39 of 3292 steps (1%) done

[Sun Jul  5 21:28:24 2020]
rule find_best_model:
    input: per_gene/EOG091G0ITS/ALICUT_EOG091G0ITS.clustalo.fasta, per_gene/EOG091G0ITS/empty_check.done
    output: per_gene/EOG091G0ITS/EOG091G0ITS.best_model
    log: per_gene/EOG091G0ITS/find_best_model.stderr.txt
    jobid: 662
    wildcards: BUSCO=EOG091G0ITS
    threads: 2


        cd per_gene/EOG091G0ITS
        if [ ! -d find_best_model ]
        then
            mkdir find_best_model
        fi
        cd find_best_model
        ln -s ../../../per_gene/EOG091G0ITS/ALICUT_EOG091G0ITS.clustalo.fasta EOG091G0ITS.fasta
        ProteinModelSelection.pl EOG091G0ITS.fasta 1> ../../../per_gene/EOG091G0ITS/EOG091G0ITS.best_model 2> ../../../per_gene/EOG091G0ITS/find_best_model.stderr.txt
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/c0c09ee657b1e27f2c5687e0e9aa8d70.simg
[Sun Jul  5 21:28:25 2020]
Finished job 1392.
40 of 3292 steps (1%) done
[Sun Jul  5 21:28:25 2020]
Finished job 2965.
41 of 3292 steps (1%) done

[Sun Jul  5 21:28:25 2020]
rule score_and_cut:
    input: per_gene/EOG091G0AKW/EOG091G0AKW.clustalo.fasta
    output: per_gene/EOG091G0AKW/ALICUT_EOG091G0AKW.clustalo.fasta
    jobid: 569
    wildcards: BUSCO=EOG091G0AKW
    threads: 2


        cd per_gene/EOG091G0AKW
        Aliscore.pl -N -r 200000000000000000 -i ../../per_gene/EOG091G0AKW/EOG091G0AKW.clustalo.fasta &> aliscore.log
        ALICUT.pl -s &> alicut.log
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/63c88c27a0fa300f57066b0ef65fefcb.simg

[Sun Jul  5 21:28:25 2020]
rule MSA:
    input: per_gene/EOG091G01XI/EOG091G01XI.fasta
    output: per_gene/EOG091G01XI/EOG091G01XI.clustalo.fasta
    log: per_gene/EOG091G01XI/MSA.stdout.txt, per_gene/EOG091G01XI/MSA.stderr.txt
    jobid: 1256
    wildcards: BUSCO=EOG091G01XI
    threads: 2


        clustalo -i per_gene/EOG091G01XI/EOG091G01XI.fasta -o per_gene/EOG091G01XI/EOG091G01XI.clustalo.fasta --threads=2 1> per_gene/EOG091G01XI/MSA.stdout.txt 2> per_gene/EOG091G01XI/MSA.stderr.txt
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/d68c9691725a7401923680874285c430.simg
[Sun Jul  5 21:28:25 2020]
Finished job 3208.
42 of 3292 steps (1%) done
[Sun Jul  5 21:28:25 2020]
Finished job 2572.
43 of 3292 steps (1%) done

[Sun Jul  5 21:28:25 2020]
rule find_best_model:
    input: per_gene/EOG091G07IK/ALICUT_EOG091G07IK.clustalo.fasta, per_gene/EOG091G07IK/empty_check.done
    output: per_gene/EOG091G07IK/EOG091G07IK.best_model
    log: per_gene/EOG091G07IK/find_best_model.stderr.txt
    jobid: 520
    wildcards: BUSCO=EOG091G07IK
    threads: 2


        cd per_gene/EOG091G07IK
        if [ ! -d find_best_model ]
        then
            mkdir find_best_model
        fi
        cd find_best_model
        ln -s ../../../per_gene/EOG091G07IK/ALICUT_EOG091G07IK.clustalo.fasta EOG091G07IK.fasta
        ProteinModelSelection.pl EOG091G07IK.fasta 1> ../../../per_gene/EOG091G07IK/EOG091G07IK.best_model 2> ../../../per_gene/EOG091G07IK/find_best_model.stderr.txt
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/c0c09ee657b1e27f2c5687e0e9aa8d70.simg

[Sun Jul  5 21:28:25 2020]
rule get_outgroups:
    input: per_gene/EOG091G074U/EOG091G074U.ingroup.fasta
    output: per_gene/EOG091G074U/EOG091G074U.orthodb.fasta, per_gene/EOG091G074U/EOG091G074U.outgroup.fasta
    log: per_gene/EOG091G074U/get_outgroups.stdout.txt, per_gene/EOG091G074U/get_outgroups.stderr.txt
    jobid: 2573
    wildcards: BUSCO=EOG091G074U


        #download fastas from Orhtodb for BUSCO id
        for i in {1..5}
        do
             wget "http://www.orthodb.org/fasta?query=EOG091G074U&level=33208" -O per_gene/EOG091G074U/EOG091G074U.orthodb.fasta 1> per_gene/EOG091G074U/get_outgroups.stdout.txt 2> per_gene/EOG091G074U/get_outgroups.stderr.txt && break || echo -e "try again ($i)" && sleep 15
        done

	#This is quick an dirty for now and just takes the first protein if there is more than one for an outgroup taxon
        bash ../scripts/download_outgroups.sh taxids.txt per_gene/EOG091G074U/EOG091G074U.orthodb.fasta > per_gene/EOG091G074U/EOG091G074U.outgroup.fasta
        

[Sun Jul  5 21:28:25 2020]
rule join_groups:
    input: per_gene/EOG091G09QO/EOG091G09QO.ingroup.fasta, per_gene/EOG091G09QO/EOG091G09QO.outgroup.fasta
    output: per_gene/EOG091G09QO/EOG091G09QO.fasta
    jobid: 2306
    wildcards: BUSCO=EOG091G09QO


        cat per_gene/EOG091G09QO/EOG091G09QO.ingroup.fasta per_gene/EOG091G09QO/EOG091G09QO.outgroup.fasta > per_gene/EOG091G09QO/EOG091G09QO.fasta
        
[Sun Jul  5 21:28:25 2020]
Finished job 2306.
44 of 3292 steps (1%) done

[Sun Jul  5 21:28:25 2020]
rule get_outgroups:
    input: per_gene/EOG091G0IDG/EOG091G0IDG.ingroup.fasta
    output: per_gene/EOG091G0IDG/EOG091G0IDG.orthodb.fasta, per_gene/EOG091G0IDG/EOG091G0IDG.outgroup.fasta
    log: per_gene/EOG091G0IDG/get_outgroups.stdout.txt, per_gene/EOG091G0IDG/get_outgroups.stderr.txt
    jobid: 3209
    wildcards: BUSCO=EOG091G0IDG


        #download fastas from Orhtodb for BUSCO id
        for i in {1..5}
        do
             wget "http://www.orthodb.org/fasta?query=EOG091G0IDG&level=33208" -O per_gene/EOG091G0IDG/EOG091G0IDG.orthodb.fasta 1> per_gene/EOG091G0IDG/get_outgroups.stdout.txt 2> per_gene/EOG091G0IDG/get_outgroups.stderr.txt && break || echo -e "try again ($i)" && sleep 15
        done

	#This is quick an dirty for now and just takes the first protein if there is more than one for an outgroup taxon
        bash ../scripts/download_outgroups.sh taxids.txt per_gene/EOG091G0IDG/EOG091G0IDG.orthodb.fasta > per_gene/EOG091G0IDG/EOG091G0IDG.outgroup.fasta
        
[Sun Jul  5 21:28:26 2020]
Finished job 3080.
45 of 3292 steps (1%) done

[Sun Jul  5 21:28:26 2020]
rule MSA:
    input: per_gene/EOG091G09QO/EOG091G09QO.fasta
    output: per_gene/EOG091G09QO/EOG091G09QO.clustalo.fasta
    log: per_gene/EOG091G09QO/MSA.stdout.txt, per_gene/EOG091G09QO/MSA.stderr.txt
    jobid: 1732
    wildcards: BUSCO=EOG091G09QO
    threads: 2


        clustalo -i per_gene/EOG091G09QO/EOG091G09QO.fasta -o per_gene/EOG091G09QO/EOG091G09QO.clustalo.fasta --threads=2 1> per_gene/EOG091G09QO/MSA.stdout.txt 2> per_gene/EOG091G09QO/MSA.stderr.txt
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/d68c9691725a7401923680874285c430.simg
[Sun Jul  5 21:28:26 2020]
Finished job 3257.
46 of 3292 steps (1%) done
[Sun Jul  5 21:28:26 2020]
Finished job 3022.
47 of 3292 steps (1%) done

[Sun Jul  5 21:28:26 2020]
rule get_outgroups:
    input: per_gene/EOG091G09MD/EOG091G09MD.ingroup.fasta
    output: per_gene/EOG091G09MD/EOG091G09MD.orthodb.fasta, per_gene/EOG091G09MD/EOG091G09MD.outgroup.fasta
    log: per_gene/EOG091G09MD/get_outgroups.stdout.txt, per_gene/EOG091G09MD/get_outgroups.stderr.txt
    jobid: 3081
    wildcards: BUSCO=EOG091G09MD


        #download fastas from Orhtodb for BUSCO id
        for i in {1..5}
        do
             wget "http://www.orthodb.org/fasta?query=EOG091G09MD&level=33208" -O per_gene/EOG091G09MD/EOG091G09MD.orthodb.fasta 1> per_gene/EOG091G09MD/get_outgroups.stdout.txt 2> per_gene/EOG091G09MD/get_outgroups.stderr.txt && break || echo -e "try again ($i)" && sleep 15
        done

	#This is quick an dirty for now and just takes the first protein if there is more than one for an outgroup taxon
        bash ../scripts/download_outgroups.sh taxids.txt per_gene/EOG091G09MD/EOG091G09MD.orthodb.fasta > per_gene/EOG091G09MD/EOG091G09MD.outgroup.fasta
        

[Sun Jul  5 21:28:26 2020]
rule get_outgroups:
    input: per_gene/EOG091G0SNM/EOG091G0SNM.ingroup.fasta
    output: per_gene/EOG091G0SNM/EOG091G0SNM.orthodb.fasta, per_gene/EOG091G0SNM/EOG091G0SNM.outgroup.fasta
    log: per_gene/EOG091G0SNM/get_outgroups.stdout.txt, per_gene/EOG091G0SNM/get_outgroups.stderr.txt
    jobid: 3023
    wildcards: BUSCO=EOG091G0SNM


        #download fastas from Orhtodb for BUSCO id
        for i in {1..5}
        do
             wget "http://www.orthodb.org/fasta?query=EOG091G0SNM&level=33208" -O per_gene/EOG091G0SNM/EOG091G0SNM.orthodb.fasta 1> per_gene/EOG091G0SNM/get_outgroups.stdout.txt 2> per_gene/EOG091G0SNM/get_outgroups.stderr.txt && break || echo -e "try again ($i)" && sleep 15
        done

	#This is quick an dirty for now and just takes the first protein if there is more than one for an outgroup taxon
        bash ../scripts/download_outgroups.sh taxids.txt per_gene/EOG091G0SNM/EOG091G0SNM.orthodb.fasta > per_gene/EOG091G0SNM/EOG091G0SNM.outgroup.fasta
        

[Sun Jul  5 21:28:26 2020]
rule join_groups:
    input: per_gene/EOG091G0ZDR/EOG091G0ZDR.ingroup.fasta, per_gene/EOG091G0ZDR/EOG091G0ZDR.outgroup.fasta
    output: per_gene/EOG091G0ZDR/EOG091G0ZDR.fasta
    jobid: 2452
    wildcards: BUSCO=EOG091G0ZDR


        cat per_gene/EOG091G0ZDR/EOG091G0ZDR.ingroup.fasta per_gene/EOG091G0ZDR/EOG091G0ZDR.outgroup.fasta > per_gene/EOG091G0ZDR/EOG091G0ZDR.fasta
        
[Sun Jul  5 21:28:26 2020]
Finished job 2452.
48 of 3292 steps (1%) done
[Sun Jul  5 21:28:26 2020]
Finished job 2930.
49 of 3292 steps (1%) done

[Sun Jul  5 21:28:26 2020]
rule MSA:
    input: per_gene/EOG091G0ZDR/EOG091G0ZDR.fasta
    output: per_gene/EOG091G0ZDR/EOG091G0ZDR.clustalo.fasta
    log: per_gene/EOG091G0ZDR/MSA.stdout.txt, per_gene/EOG091G0ZDR/MSA.stderr.txt
    jobid: 2024
    wildcards: BUSCO=EOG091G0ZDR
    threads: 2


        clustalo -i per_gene/EOG091G0ZDR/EOG091G0ZDR.fasta -o per_gene/EOG091G0ZDR/EOG091G0ZDR.clustalo.fasta --threads=2 1> per_gene/EOG091G0ZDR/MSA.stdout.txt 2> per_gene/EOG091G0ZDR/MSA.stderr.txt
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/d68c9691725a7401923680874285c430.simg

[Sun Jul  5 21:28:26 2020]
rule get_outgroups:
    input: per_gene/EOG091G146E/EOG091G146E.ingroup.fasta
    output: per_gene/EOG091G146E/EOG091G146E.orthodb.fasta, per_gene/EOG091G146E/EOG091G146E.outgroup.fasta
    log: per_gene/EOG091G146E/get_outgroups.stdout.txt, per_gene/EOG091G146E/get_outgroups.stderr.txt
    jobid: 2931
    wildcards: BUSCO=EOG091G146E


        #download fastas from Orhtodb for BUSCO id
        for i in {1..5}
        do
             wget "http://www.orthodb.org/fasta?query=EOG091G146E&level=33208" -O per_gene/EOG091G146E/EOG091G146E.orthodb.fasta 1> per_gene/EOG091G146E/get_outgroups.stdout.txt 2> per_gene/EOG091G146E/get_outgroups.stderr.txt && break || echo -e "try again ($i)" && sleep 15
        done

	#This is quick an dirty for now and just takes the first protein if there is more than one for an outgroup taxon
        bash ../scripts/download_outgroups.sh taxids.txt per_gene/EOG091G146E/EOG091G146E.orthodb.fasta > per_gene/EOG091G146E/EOG091G146E.outgroup.fasta
        
[Sun Jul  5 21:28:26 2020]
Finished job 2788.
50 of 3292 steps (2%) done

[Sun Jul  5 21:28:26 2020]
rule MSA:
    input: per_gene/EOG091G0PAG/EOG091G0PAG.fasta
    output: per_gene/EOG091G0PAG/EOG091G0PAG.clustalo.fasta
    log: per_gene/EOG091G0PAG/MSA.stdout.txt, per_gene/EOG091G0PAG/MSA.stderr.txt
    jobid: 1568
    wildcards: BUSCO=EOG091G0PAG
    threads: 2


        clustalo -i per_gene/EOG091G0PAG/EOG091G0PAG.fasta -o per_gene/EOG091G0PAG/EOG091G0PAG.clustalo.fasta --threads=2 1> per_gene/EOG091G0PAG/MSA.stdout.txt 2> per_gene/EOG091G0PAG/MSA.stderr.txt
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/d68c9691725a7401923680874285c430.simg
[Sun Jul  5 21:28:27 2020]
Finished job 3209.
51 of 3292 steps (2%) done
[Sun Jul  5 21:28:27 2020]
Finished job 3004.
52 of 3292 steps (2%) done

[Sun Jul  5 21:28:27 2020]
rule join_groups:
    input: per_gene/EOG091G0IDG/EOG091G0IDG.ingroup.fasta, per_gene/EOG091G0IDG/EOG091G0IDG.outgroup.fasta
    output: per_gene/EOG091G0IDG/EOG091G0IDG.fasta
    jobid: 2428
    wildcards: BUSCO=EOG091G0IDG


        cat per_gene/EOG091G0IDG/EOG091G0IDG.ingroup.fasta per_gene/EOG091G0IDG/EOG091G0IDG.outgroup.fasta > per_gene/EOG091G0IDG/EOG091G0IDG.fasta
        

[Sun Jul  5 21:28:27 2020]
rule get_outgroups:
    input: per_gene/EOG091G0N9D/EOG091G0N9D.ingroup.fasta
    output: per_gene/EOG091G0N9D/EOG091G0N9D.orthodb.fasta, per_gene/EOG091G0N9D/EOG091G0N9D.outgroup.fasta
    log: per_gene/EOG091G0N9D/get_outgroups.stdout.txt, per_gene/EOG091G0N9D/get_outgroups.stderr.txt
    jobid: 3005
    wildcards: BUSCO=EOG091G0N9D


        #download fastas from Orhtodb for BUSCO id
        for i in {1..5}
        do
             wget "http://www.orthodb.org/fasta?query=EOG091G0N9D&level=33208" -O per_gene/EOG091G0N9D/EOG091G0N9D.orthodb.fasta 1> per_gene/EOG091G0N9D/get_outgroups.stdout.txt 2> per_gene/EOG091G0N9D/get_outgroups.stderr.txt && break || echo -e "try again ($i)" && sleep 15
        done

	#This is quick an dirty for now and just takes the first protein if there is more than one for an outgroup taxon
        bash ../scripts/download_outgroups.sh taxids.txt per_gene/EOG091G0N9D/EOG091G0N9D.orthodb.fasta > per_gene/EOG091G0N9D/EOG091G0N9D.outgroup.fasta
        

[Sun Jul  5 21:28:27 2020]
rule get_outgroups:
    input: per_gene/EOG091G0NMJ/EOG091G0NMJ.ingroup.fasta
    output: per_gene/EOG091G0NMJ/EOG091G0NMJ.orthodb.fasta, per_gene/EOG091G0NMJ/EOG091G0NMJ.outgroup.fasta
    log: per_gene/EOG091G0NMJ/get_outgroups.stdout.txt, per_gene/EOG091G0NMJ/get_outgroups.stderr.txt
    jobid: 2789
    wildcards: BUSCO=EOG091G0NMJ


        #download fastas from Orhtodb for BUSCO id
        for i in {1..5}
        do
             wget "http://www.orthodb.org/fasta?query=EOG091G0NMJ&level=33208" -O per_gene/EOG091G0NMJ/EOG091G0NMJ.orthodb.fasta 1> per_gene/EOG091G0NMJ/get_outgroups.stdout.txt 2> per_gene/EOG091G0NMJ/get_outgroups.stderr.txt && break || echo -e "try again ($i)" && sleep 15
        done

	#This is quick an dirty for now and just takes the first protein if there is more than one for an outgroup taxon
        bash ../scripts/download_outgroups.sh taxids.txt per_gene/EOG091G0NMJ/EOG091G0NMJ.orthodb.fasta > per_gene/EOG091G0NMJ/EOG091G0NMJ.outgroup.fasta
        
[Sun Jul  5 21:28:27 2020]
Finished job 2428.
53 of 3292 steps (2%) done
[Sun Jul  5 21:28:27 2020]
Finished job 1568.
54 of 3292 steps (2%) done
[Sun Jul  5 21:28:27 2020]
Finished job 2024.
55 of 3292 steps (2%) done

[Sun Jul  5 21:28:27 2020]
rule score_and_cut:
    input: per_gene/EOG091G0ZDR/EOG091G0ZDR.clustalo.fasta
    output: per_gene/EOG091G0ZDR/ALICUT_EOG091G0ZDR.clustalo.fasta
    jobid: 1201
    wildcards: BUSCO=EOG091G0ZDR
    threads: 2


        cd per_gene/EOG091G0ZDR
        Aliscore.pl -N -r 200000000000000000 -i ../../per_gene/EOG091G0ZDR/EOG091G0ZDR.clustalo.fasta &> aliscore.log
        ALICUT.pl -s &> alicut.log
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/63c88c27a0fa300f57066b0ef65fefcb.simg

[Sun Jul  5 21:28:27 2020]
rule score_and_cut:
    input: per_gene/EOG091G0PAG/EOG091G0PAG.clustalo.fasta
    output: per_gene/EOG091G0PAG/ALICUT_EOG091G0PAG.clustalo.fasta
    jobid: 745
    wildcards: BUSCO=EOG091G0PAG
    threads: 2


        cd per_gene/EOG091G0PAG
        Aliscore.pl -N -r 200000000000000000 -i ../../per_gene/EOG091G0PAG/EOG091G0PAG.clustalo.fasta &> aliscore.log
        ALICUT.pl -s &> alicut.log
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/63c88c27a0fa300f57066b0ef65fefcb.simg
[Sun Jul  5 21:28:28 2020]
Finished job 3171.
56 of 3292 steps (2%) done
[Sun Jul  5 21:28:28 2020]
Finished job 2890.
57 of 3292 steps (2%) done
[Sun Jul  5 21:28:28 2020]
Finished job 3005.
58 of 3292 steps (2%) done

[Sun Jul  5 21:28:28 2020]
rule MSA:
    input: per_gene/EOG091G0IDG/EOG091G0IDG.fasta
    output: per_gene/EOG091G0IDG/EOG091G0IDG.clustalo.fasta
    log: per_gene/EOG091G0IDG/MSA.stdout.txt, per_gene/EOG091G0IDG/MSA.stderr.txt
    jobid: 1976
    wildcards: BUSCO=EOG091G0IDG
    threads: 2


        clustalo -i per_gene/EOG091G0IDG/EOG091G0IDG.fasta -o per_gene/EOG091G0IDG/EOG091G0IDG.clustalo.fasta --threads=2 1> per_gene/EOG091G0IDG/MSA.stdout.txt 2> per_gene/EOG091G0IDG/MSA.stderr.txt
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/d68c9691725a7401923680874285c430.simg

[Sun Jul  5 21:28:28 2020]
rule get_outgroups:
    input: per_gene/EOG091G0XN1/EOG091G0XN1.ingroup.fasta
    output: per_gene/EOG091G0XN1/EOG091G0XN1.orthodb.fasta, per_gene/EOG091G0XN1/EOG091G0XN1.outgroup.fasta
    log: per_gene/EOG091G0XN1/get_outgroups.stdout.txt, per_gene/EOG091G0XN1/get_outgroups.stderr.txt
    jobid: 2891
    wildcards: BUSCO=EOG091G0XN1


        #download fastas from Orhtodb for BUSCO id
        for i in {1..5}
        do
             wget "http://www.orthodb.org/fasta?query=EOG091G0XN1&level=33208" -O per_gene/EOG091G0XN1/EOG091G0XN1.orthodb.fasta 1> per_gene/EOG091G0XN1/get_outgroups.stdout.txt 2> per_gene/EOG091G0XN1/get_outgroups.stderr.txt && break || echo -e "try again ($i)" && sleep 15
        done

	#This is quick an dirty for now and just takes the first protein if there is more than one for an outgroup taxon
        bash ../scripts/download_outgroups.sh taxids.txt per_gene/EOG091G0XN1/EOG091G0XN1.orthodb.fasta > per_gene/EOG091G0XN1/EOG091G0XN1.outgroup.fasta
        

[Sun Jul  5 21:28:28 2020]
rule join_groups:
    input: per_gene/EOG091G0A5N/EOG091G0A5N.ingroup.fasta, per_gene/EOG091G0A5N/EOG091G0A5N.outgroup.fasta
    output: per_gene/EOG091G0A5N/EOG091G0A5N.fasta
    jobid: 2409
    wildcards: BUSCO=EOG091G0A5N


        cat per_gene/EOG091G0A5N/EOG091G0A5N.ingroup.fasta per_gene/EOG091G0A5N/EOG091G0A5N.outgroup.fasta > per_gene/EOG091G0A5N/EOG091G0A5N.fasta
        

[Sun Jul  5 21:28:28 2020]
rule join_groups:
    input: per_gene/EOG091G0N9D/EOG091G0N9D.ingroup.fasta, per_gene/EOG091G0N9D/EOG091G0N9D.outgroup.fasta
    output: per_gene/EOG091G0N9D/EOG091G0N9D.fasta
    jobid: 2326
    wildcards: BUSCO=EOG091G0N9D


        cat per_gene/EOG091G0N9D/EOG091G0N9D.ingroup.fasta per_gene/EOG091G0N9D/EOG091G0N9D.outgroup.fasta > per_gene/EOG091G0N9D/EOG091G0N9D.fasta
        
[Sun Jul  5 21:28:28 2020]
Finished job 2409.
59 of 3292 steps (2%) done
[Sun Jul  5 21:28:28 2020]
Finished job 2326.
60 of 3292 steps (2%) done

[Sun Jul  5 21:28:28 2020]
rule MSA:
    input: per_gene/EOG091G0A5N/EOG091G0A5N.fasta
    output: per_gene/EOG091G0A5N/EOG091G0A5N.clustalo.fasta
    log: per_gene/EOG091G0A5N/MSA.stdout.txt, per_gene/EOG091G0A5N/MSA.stderr.txt
    jobid: 1938
    wildcards: BUSCO=EOG091G0A5N
    threads: 2


        clustalo -i per_gene/EOG091G0A5N/EOG091G0A5N.fasta -o per_gene/EOG091G0A5N/EOG091G0A5N.clustalo.fasta --threads=2 1> per_gene/EOG091G0A5N/MSA.stdout.txt 2> per_gene/EOG091G0A5N/MSA.stderr.txt
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/d68c9691725a7401923680874285c430.simg
[Sun Jul  5 21:28:28 2020]
Finished job 1732.
61 of 3292 steps (2%) done
[Sun Jul  5 21:28:28 2020]
Finished job 1256.
62 of 3292 steps (2%) done

[Sun Jul  5 21:28:28 2020]
rule score_and_cut:
    input: per_gene/EOG091G01XI/EOG091G01XI.clustalo.fasta
    output: per_gene/EOG091G01XI/ALICUT_EOG091G01XI.clustalo.fasta
    jobid: 433
    wildcards: BUSCO=EOG091G01XI
    threads: 2


        cd per_gene/EOG091G01XI
        Aliscore.pl -N -r 200000000000000000 -i ../../per_gene/EOG091G01XI/EOG091G01XI.clustalo.fasta &> aliscore.log
        ALICUT.pl -s &> alicut.log
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/63c88c27a0fa300f57066b0ef65fefcb.simg

[Sun Jul  5 21:28:28 2020]
rule score_and_cut:
    input: per_gene/EOG091G09QO/EOG091G09QO.clustalo.fasta
    output: per_gene/EOG091G09QO/ALICUT_EOG091G09QO.clustalo.fasta
    jobid: 909
    wildcards: BUSCO=EOG091G09QO
    threads: 2


        cd per_gene/EOG091G09QO
        Aliscore.pl -N -r 200000000000000000 -i ../../per_gene/EOG091G09QO/EOG091G09QO.clustalo.fasta &> aliscore.log
        ALICUT.pl -s &> alicut.log
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/63c88c27a0fa300f57066b0ef65fefcb.simg
[Sun Jul  5 21:28:29 2020]
Finished job 1976.
63 of 3292 steps (2%) done
[Sun Jul  5 21:28:29 2020]
Finished job 3081.
64 of 3292 steps (2%) done
[Sun Jul  5 21:28:29 2020]
Finished job 2789.
65 of 3292 steps (2%) done

[Sun Jul  5 21:28:29 2020]
rule score_and_cut:
    input: per_gene/EOG091G0IDG/EOG091G0IDG.clustalo.fasta
    output: per_gene/EOG091G0IDG/ALICUT_EOG091G0IDG.clustalo.fasta
    jobid: 1153
    wildcards: BUSCO=EOG091G0IDG
    threads: 2


        cd per_gene/EOG091G0IDG
        Aliscore.pl -N -r 200000000000000000 -i ../../per_gene/EOG091G0IDG/EOG091G0IDG.clustalo.fasta &> aliscore.log
        ALICUT.pl -s &> alicut.log
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/63c88c27a0fa300f57066b0ef65fefcb.simg

[Sun Jul  5 21:28:29 2020]
rule join_groups:
    input: per_gene/EOG091G09MD/EOG091G09MD.ingroup.fasta, per_gene/EOG091G09MD/EOG091G09MD.outgroup.fasta
    output: per_gene/EOG091G09MD/EOG091G09MD.fasta
    jobid: 2364
    wildcards: BUSCO=EOG091G09MD


        cat per_gene/EOG091G09MD/EOG091G09MD.ingroup.fasta per_gene/EOG091G09MD/EOG091G09MD.outgroup.fasta > per_gene/EOG091G09MD/EOG091G09MD.fasta
        

[Sun Jul  5 21:28:29 2020]
rule join_groups:
    input: per_gene/EOG091G0NMJ/EOG091G0NMJ.ingroup.fasta, per_gene/EOG091G0NMJ/EOG091G0NMJ.outgroup.fasta
    output: per_gene/EOG091G0NMJ/EOG091G0NMJ.fasta
    jobid: 2218
    wildcards: BUSCO=EOG091G0NMJ


        cat per_gene/EOG091G0NMJ/EOG091G0NMJ.ingroup.fasta per_gene/EOG091G0NMJ/EOG091G0NMJ.outgroup.fasta > per_gene/EOG091G0NMJ/EOG091G0NMJ.fasta
        
[Sun Jul  5 21:28:29 2020]
Finished job 2364.
66 of 3292 steps (2%) done
[Sun Jul  5 21:28:29 2020]
Finished job 2218.
67 of 3292 steps (2%) done

[Sun Jul  5 21:28:29 2020]
rule MSA:
    input: per_gene/EOG091G09MD/EOG091G09MD.fasta
    output: per_gene/EOG091G09MD/EOG091G09MD.clustalo.fasta
    log: per_gene/EOG091G09MD/MSA.stdout.txt, per_gene/EOG091G09MD/MSA.stderr.txt
    jobid: 1848
    wildcards: BUSCO=EOG091G09MD
    threads: 2


        clustalo -i per_gene/EOG091G09MD/EOG091G09MD.fasta -o per_gene/EOG091G09MD/EOG091G09MD.clustalo.fasta --threads=2 1> per_gene/EOG091G09MD/MSA.stdout.txt 2> per_gene/EOG091G09MD/MSA.stderr.txt
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/d68c9691725a7401923680874285c430.simg
[Sun Jul  5 21:28:30 2020]
Finished job 2891.
68 of 3292 steps (2%) done
[Sun Jul  5 21:28:30 2020]
Finished job 2643.
69 of 3292 steps (2%) done

[Sun Jul  5 21:28:30 2020]
rule join_groups:
    input: per_gene/EOG091G0C8H/EOG091G0C8H.ingroup.fasta, per_gene/EOG091G0C8H/EOG091G0C8H.outgroup.fasta
    output: per_gene/EOG091G0C8H/EOG091G0C8H.fasta
    jobid: 2145
    wildcards: BUSCO=EOG091G0C8H


        cat per_gene/EOG091G0C8H/EOG091G0C8H.ingroup.fasta per_gene/EOG091G0C8H/EOG091G0C8H.outgroup.fasta > per_gene/EOG091G0C8H/EOG091G0C8H.fasta
        

[Sun Jul  5 21:28:30 2020]
rule join_groups:
    input: per_gene/EOG091G0XN1/EOG091G0XN1.ingroup.fasta, per_gene/EOG091G0XN1/EOG091G0XN1.outgroup.fasta
    output: per_gene/EOG091G0XN1/EOG091G0XN1.fasta
    jobid: 2269
    wildcards: BUSCO=EOG091G0XN1


        cat per_gene/EOG091G0XN1/EOG091G0XN1.ingroup.fasta per_gene/EOG091G0XN1/EOG091G0XN1.outgroup.fasta > per_gene/EOG091G0XN1/EOG091G0XN1.fasta
        
[Sun Jul  5 21:28:30 2020]
Finished job 2145.
70 of 3292 steps (2%) done
[Sun Jul  5 21:28:30 2020]
Finished job 1848.
71 of 3292 steps (2%) done
[Sun Jul  5 21:28:30 2020]
Finished job 1938.
72 of 3292 steps (2%) done
[Sun Jul  5 21:28:30 2020]
Finished job 2269.
73 of 3292 steps (2%) done

[Sun Jul  5 21:28:30 2020]
rule score_and_cut:
    input: per_gene/EOG091G0A5N/EOG091G0A5N.clustalo.fasta
    output: per_gene/EOG091G0A5N/ALICUT_EOG091G0A5N.clustalo.fasta
    jobid: 1115
    wildcards: BUSCO=EOG091G0A5N
    threads: 2


        cd per_gene/EOG091G0A5N
        Aliscore.pl -N -r 200000000000000000 -i ../../per_gene/EOG091G0A5N/EOG091G0A5N.clustalo.fasta &> aliscore.log
        ALICUT.pl -s &> alicut.log
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/63c88c27a0fa300f57066b0ef65fefcb.simg

[Sun Jul  5 21:28:30 2020]
rule score_and_cut:
    input: per_gene/EOG091G09MD/EOG091G09MD.clustalo.fasta
    output: per_gene/EOG091G09MD/ALICUT_EOG091G09MD.clustalo.fasta
    jobid: 1025
    wildcards: BUSCO=EOG091G09MD
    threads: 2


        cd per_gene/EOG091G09MD
        Aliscore.pl -N -r 200000000000000000 -i ../../per_gene/EOG091G09MD/EOG091G09MD.clustalo.fasta &> aliscore.log
        ALICUT.pl -s &> alicut.log
        

Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/63c88c27a0fa300f57066b0ef65fefcb.simg
[Sun Jul  5 21:28:30 2020]
rule MSA:
    input: per_gene/EOG091G0C8H/EOG091G0C8H.fasta
    output: per_gene/EOG091G0C8H/EOG091G0C8H.clustalo.fasta
    log: per_gene/EOG091G0C8H/MSA.stdout.txt, per_gene/EOG091G0C8H/MSA.stderr.txt
    jobid: 1410
    wildcards: BUSCO=EOG091G0C8H
    threads: 2


        clustalo -i per_gene/EOG091G0C8H/EOG091G0C8H.fasta -o per_gene/EOG091G0C8H/EOG091G0C8H.clustalo.fasta --threads=2 1> per_gene/EOG091G0C8H/MSA.stdout.txt 2> per_gene/EOG091G0C8H/MSA.stderr.txt
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/d68c9691725a7401923680874285c430.simg
[Sun Jul  5 21:28:31 2020]
Finished job 2925.
74 of 3292 steps (2%) done

[Sun Jul  5 21:28:31 2020]
rule join_groups:
    input: per_gene/EOG091G1285/EOG091G1285.ingroup.fasta, per_gene/EOG091G1285/EOG091G1285.outgroup.fasta
    output: per_gene/EOG091G1285/EOG091G1285.fasta
    jobid: 2286
    wildcards: BUSCO=EOG091G1285


        cat per_gene/EOG091G1285/EOG091G1285.ingroup.fasta per_gene/EOG091G1285/EOG091G1285.outgroup.fasta > per_gene/EOG091G1285/EOG091G1285.fasta
        
[Sun Jul  5 21:28:31 2020]
Finished job 2286.
75 of 3292 steps (2%) done
[Sun Jul  5 21:28:31 2020]
Finished job 1410.
76 of 3292 steps (2%) done

[Sun Jul  5 21:28:31 2020]
rule score_and_cut:
    input: per_gene/EOG091G0C8H/EOG091G0C8H.clustalo.fasta
    output: per_gene/EOG091G0C8H/ALICUT_EOG091G0C8H.clustalo.fasta
    jobid: 587
    wildcards: BUSCO=EOG091G0C8H
    threads: 2


        cd per_gene/EOG091G0C8H
        Aliscore.pl -N -r 200000000000000000 -i ../../per_gene/EOG091G0C8H/EOG091G0C8H.clustalo.fasta &> aliscore.log
        ALICUT.pl -s &> alicut.log
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/63c88c27a0fa300f57066b0ef65fefcb.simg
[Sun Jul  5 21:28:33 2020]
Finished job 569.
77 of 3292 steps (2%) done

[Sun Jul  5 21:28:33 2020]
rule MSA:
    input: per_gene/EOG091G0N9D/EOG091G0N9D.fasta
    output: per_gene/EOG091G0N9D/EOG091G0N9D.clustalo.fasta
    log: per_gene/EOG091G0N9D/MSA.stdout.txt, per_gene/EOG091G0N9D/MSA.stderr.txt
    jobid: 1772
    wildcards: BUSCO=EOG091G0N9D
    threads: 2


        clustalo -i per_gene/EOG091G0N9D/EOG091G0N9D.fasta -o per_gene/EOG091G0N9D/EOG091G0N9D.clustalo.fasta --threads=2 1> per_gene/EOG091G0N9D/MSA.stdout.txt 2> per_gene/EOG091G0N9D/MSA.stderr.txt
        

Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/d68c9691725a7401923680874285c430.simg
[Sun Jul  5 21:28:33 2020]
rule remove_empty:
    input: per_gene/EOG091G0AKW/ALICUT_EOG091G0AKW.clustalo.fasta
    output: per_gene/EOG091G0AKW/empty_check.done
    jobid: 1391
    wildcards: BUSCO=EOG091G0AKW


         if [ "$(cat per_gene/EOG091G0AKW/ALICUT_EOG091G0AKW.clustalo.fasta | grep -v ">" | sed 's/-//g' | grep "^$" | wc -l)" -gt 0 ]
         then
              cp per_gene/EOG091G0AKW/ALICUT_EOG091G0AKW.clustalo.fasta per_gene/EOG091G0AKW/ALICUT_EOG091G0AKW.clustalo.fasta.backup
              bash ../scripts/remove_empty.sh per_gene/EOG091G0AKW/ALICUT_EOG091G0AKW.clustalo.fasta.backup > per_gene/EOG091G0AKW/ALICUT_EOG091G0AKW.clustalo.fasta
         fi
         touch per_gene/EOG091G0AKW/empty_check.done
         
[Sun Jul  5 21:28:33 2020]
Finished job 1391.
78 of 3292 steps (2%) done
[Sun Jul  5 21:28:33 2020]
Finished job 1772.
79 of 3292 steps (2%) done

[Sun Jul  5 21:28:33 2020]
rule score_and_cut:
    input: per_gene/EOG091G0N9D/EOG091G0N9D.clustalo.fasta
    output: per_gene/EOG091G0N9D/ALICUT_EOG091G0N9D.clustalo.fasta
    jobid: 949
    wildcards: BUSCO=EOG091G0N9D
    threads: 2


        cd per_gene/EOG091G0N9D
        Aliscore.pl -N -r 200000000000000000 -i ../../per_gene/EOG091G0N9D/EOG091G0N9D.clustalo.fasta &> aliscore.log
        ALICUT.pl -s &> alicut.log
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/63c88c27a0fa300f57066b0ef65fefcb.simg
[Sun Jul  5 21:28:34 2020]
Finished job 745.
80 of 3292 steps (2%) done

[Sun Jul  5 21:28:34 2020]
rule find_best_model:
    input: per_gene/EOG091G0AKW/ALICUT_EOG091G0AKW.clustalo.fasta, per_gene/EOG091G0AKW/empty_check.done
    output: per_gene/EOG091G0AKW/EOG091G0AKW.best_model
    log: per_gene/EOG091G0AKW/find_best_model.stderr.txt
    jobid: 568
    wildcards: BUSCO=EOG091G0AKW
    threads: 2


        cd per_gene/EOG091G0AKW
        if [ ! -d find_best_model ]
        then
            mkdir find_best_model
        fi
        cd find_best_model
        ln -s ../../../per_gene/EOG091G0AKW/ALICUT_EOG091G0AKW.clustalo.fasta EOG091G0AKW.fasta
        ProteinModelSelection.pl EOG091G0AKW.fasta 1> ../../../per_gene/EOG091G0AKW/EOG091G0AKW.best_model 2> ../../../per_gene/EOG091G0AKW/find_best_model.stderr.txt
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/c0c09ee657b1e27f2c5687e0e9aa8d70.simg

[Sun Jul  5 21:28:34 2020]
rule remove_empty:
    input: per_gene/EOG091G0PAG/ALICUT_EOG091G0PAG.clustalo.fasta
    output: per_gene/EOG091G0PAG/empty_check.done
    jobid: 1567
    wildcards: BUSCO=EOG091G0PAG


         if [ "$(cat per_gene/EOG091G0PAG/ALICUT_EOG091G0PAG.clustalo.fasta | grep -v ">" | sed 's/-//g' | grep "^$" | wc -l)" -gt 0 ]
         then
              cp per_gene/EOG091G0PAG/ALICUT_EOG091G0PAG.clustalo.fasta per_gene/EOG091G0PAG/ALICUT_EOG091G0PAG.clustalo.fasta.backup
              bash ../scripts/remove_empty.sh per_gene/EOG091G0PAG/ALICUT_EOG091G0PAG.clustalo.fasta.backup > per_gene/EOG091G0PAG/ALICUT_EOG091G0PAG.clustalo.fasta
         fi
         touch per_gene/EOG091G0PAG/empty_check.done
         
[Sun Jul  5 21:28:34 2020]
Finished job 1567.
81 of 3292 steps (2%) done
[Sun Jul  5 21:28:35 2020]
Finished job 1201.
82 of 3292 steps (2%) done

[Sun Jul  5 21:28:35 2020]
rule MSA:
    input: per_gene/EOG091G0NMJ/EOG091G0NMJ.fasta
    output: per_gene/EOG091G0NMJ/EOG091G0NMJ.clustalo.fasta
    log: per_gene/EOG091G0NMJ/MSA.stdout.txt, per_gene/EOG091G0NMJ/MSA.stderr.txt
    jobid: 1556
    wildcards: BUSCO=EOG091G0NMJ
    threads: 2


        clustalo -i per_gene/EOG091G0NMJ/EOG091G0NMJ.fasta -o per_gene/EOG091G0NMJ/EOG091G0NMJ.clustalo.fasta --threads=2 1> per_gene/EOG091G0NMJ/MSA.stdout.txt 2> per_gene/EOG091G0NMJ/MSA.stderr.txt
        

Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/d68c9691725a7401923680874285c430.simg
[Sun Jul  5 21:28:35 2020]
rule remove_empty:
    input: per_gene/EOG091G0ZDR/ALICUT_EOG091G0ZDR.clustalo.fasta
    output: per_gene/EOG091G0ZDR/empty_check.done
    jobid: 2023
    wildcards: BUSCO=EOG091G0ZDR


         if [ "$(cat per_gene/EOG091G0ZDR/ALICUT_EOG091G0ZDR.clustalo.fasta | grep -v ">" | sed 's/-//g' | grep "^$" | wc -l)" -gt 0 ]
         then
              cp per_gene/EOG091G0ZDR/ALICUT_EOG091G0ZDR.clustalo.fasta per_gene/EOG091G0ZDR/ALICUT_EOG091G0ZDR.clustalo.fasta.backup
              bash ../scripts/remove_empty.sh per_gene/EOG091G0ZDR/ALICUT_EOG091G0ZDR.clustalo.fasta.backup > per_gene/EOG091G0ZDR/ALICUT_EOG091G0ZDR.clustalo.fasta
         fi
         touch per_gene/EOG091G0ZDR/empty_check.done
         
[Sun Jul  5 21:28:35 2020]
Finished job 2023.
83 of 3292 steps (3%) done
[Sun Jul  5 21:28:35 2020]
Finished job 1556.
84 of 3292 steps (3%) done

[Sun Jul  5 21:28:35 2020]
rule score_and_cut:
    input: per_gene/EOG091G0NMJ/EOG091G0NMJ.clustalo.fasta
    output: per_gene/EOG091G0NMJ/ALICUT_EOG091G0NMJ.clustalo.fasta
    jobid: 733
    wildcards: BUSCO=EOG091G0NMJ
    threads: 2


        cd per_gene/EOG091G0NMJ
        Aliscore.pl -N -r 200000000000000000 -i ../../per_gene/EOG091G0NMJ/EOG091G0NMJ.clustalo.fasta &> aliscore.log
        ALICUT.pl -s &> alicut.log
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/63c88c27a0fa300f57066b0ef65fefcb.simg
[Sun Jul  5 21:28:37 2020]
Finished job 433.
85 of 3292 steps (3%) done
[Sun Jul  5 21:28:37 2020]
Finished job 1153.
86 of 3292 steps (3%) done

[Sun Jul  5 21:28:37 2020]
rule MSA:
    input: per_gene/EOG091G0YZ0/EOG091G0YZ0.fasta
    output: per_gene/EOG091G0YZ0/EOG091G0YZ0.clustalo.fasta
    log: per_gene/EOG091G0YZ0/MSA.stdout.txt, per_gene/EOG091G0YZ0/MSA.stderr.txt
    jobid: 1670
    wildcards: BUSCO=EOG091G0YZ0
    threads: 2


        clustalo -i per_gene/EOG091G0YZ0/EOG091G0YZ0.fasta -o per_gene/EOG091G0YZ0/EOG091G0YZ0.clustalo.fasta --threads=2 1> per_gene/EOG091G0YZ0/MSA.stdout.txt 2> per_gene/EOG091G0YZ0/MSA.stderr.txt
        

[Sun Jul  5 21:28:37 2020]
rule remove_empty:
    input: per_gene/EOG091G01XI/ALICUT_EOG091G01XI.clustalo.fasta
    output: per_gene/EOG091G01XI/empty_check.done
    jobid: 1255
    wildcards: BUSCO=EOG091G01XI


         if [ "$(cat per_gene/EOG091G01XI/ALICUT_EOG091G01XI.clustalo.fasta | grep -v ">" | sed 's/-//g' | grep "^$" | wc -l)" -gt 0 ]
         then
              cp per_gene/EOG091G01XI/ALICUT_EOG091G01XI.clustalo.fasta per_gene/EOG091G01XI/ALICUT_EOG091G01XI.clustalo.fasta.backup
              bash ../scripts/remove_empty.sh per_gene/EOG091G01XI/ALICUT_EOG091G01XI.clustalo.fasta.backup > per_gene/EOG091G01XI/ALICUT_EOG091G01XI.clustalo.fasta
         fi
         touch per_gene/EOG091G01XI/empty_check.done
         
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/d68c9691725a7401923680874285c430.simg

[Sun Jul  5 21:28:37 2020]
rule remove_empty:
    input: per_gene/EOG091G0IDG/ALICUT_EOG091G0IDG.clustalo.fasta
    output: per_gene/EOG091G0IDG/empty_check.done
    jobid: 1975
    wildcards: BUSCO=EOG091G0IDG


         if [ "$(cat per_gene/EOG091G0IDG/ALICUT_EOG091G0IDG.clustalo.fasta | grep -v ">" | sed 's/-//g' | grep "^$" | wc -l)" -gt 0 ]
         then
              cp per_gene/EOG091G0IDG/ALICUT_EOG091G0IDG.clustalo.fasta per_gene/EOG091G0IDG/ALICUT_EOG091G0IDG.clustalo.fasta.backup
              bash ../scripts/remove_empty.sh per_gene/EOG091G0IDG/ALICUT_EOG091G0IDG.clustalo.fasta.backup > per_gene/EOG091G0IDG/ALICUT_EOG091G0IDG.clustalo.fasta
         fi
         touch per_gene/EOG091G0IDG/empty_check.done
         
[Sun Jul  5 21:28:37 2020]
Finished job 1255.
87 of 3292 steps (3%) done
[Sun Jul  5 21:28:37 2020]
Finished job 1975.
88 of 3292 steps (3%) done

[Sun Jul  5 21:28:37 2020]
rule find_best_model:
    input: per_gene/EOG091G0IDG/ALICUT_EOG091G0IDG.clustalo.fasta, per_gene/EOG091G0IDG/empty_check.done
    output: per_gene/EOG091G0IDG/EOG091G0IDG.best_model
    log: per_gene/EOG091G0IDG/find_best_model.stderr.txt
    jobid: 1152
    wildcards: BUSCO=EOG091G0IDG
    threads: 2


        cd per_gene/EOG091G0IDG
        if [ ! -d find_best_model ]
        then
            mkdir find_best_model
        fi
        cd find_best_model
        ln -s ../../../per_gene/EOG091G0IDG/ALICUT_EOG091G0IDG.clustalo.fasta EOG091G0IDG.fasta
        ProteinModelSelection.pl EOG091G0IDG.fasta 1> ../../../per_gene/EOG091G0IDG/EOG091G0IDG.best_model 2> ../../../per_gene/EOG091G0IDG/find_best_model.stderr.txt
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/c0c09ee657b1e27f2c5687e0e9aa8d70.simg
[Sun Jul  5 21:28:38 2020]
Finished job 1670.
89 of 3292 steps (3%) done
[Sun Jul  5 21:28:38 2020]
Finished job 1025.
90 of 3292 steps (3%) done

[Sun Jul  5 21:28:38 2020]
rule score_and_cut:
    input: per_gene/EOG091G0YZ0/EOG091G0YZ0.clustalo.fasta
    output: per_gene/EOG091G0YZ0/ALICUT_EOG091G0YZ0.clustalo.fasta
    jobid: 847
    wildcards: BUSCO=EOG091G0YZ0
    threads: 2


        cd per_gene/EOG091G0YZ0
        Aliscore.pl -N -r 200000000000000000 -i ../../per_gene/EOG091G0YZ0/EOG091G0YZ0.clustalo.fasta &> aliscore.log
        ALICUT.pl -s &> alicut.log
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/63c88c27a0fa300f57066b0ef65fefcb.simg

[Sun Jul  5 21:28:38 2020]
rule find_best_model:
    input: per_gene/EOG091G01XI/ALICUT_EOG091G01XI.clustalo.fasta, per_gene/EOG091G01XI/empty_check.done
    output: per_gene/EOG091G01XI/EOG091G01XI.best_model
    log: per_gene/EOG091G01XI/find_best_model.stderr.txt
    jobid: 432
    wildcards: BUSCO=EOG091G01XI
    threads: 2


        cd per_gene/EOG091G01XI
        if [ ! -d find_best_model ]
        then
            mkdir find_best_model
        fi
        cd find_best_model
        ln -s ../../../per_gene/EOG091G01XI/ALICUT_EOG091G01XI.clustalo.fasta EOG091G01XI.fasta
        ProteinModelSelection.pl EOG091G01XI.fasta 1> ../../../per_gene/EOG091G01XI/EOG091G01XI.best_model 2> ../../../per_gene/EOG091G01XI/find_best_model.stderr.txt
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/c0c09ee657b1e27f2c5687e0e9aa8d70.simg

[Sun Jul  5 21:28:38 2020]
rule remove_empty:
    input: per_gene/EOG091G09MD/ALICUT_EOG091G09MD.clustalo.fasta
    output: per_gene/EOG091G09MD/empty_check.done
    jobid: 1847
    wildcards: BUSCO=EOG091G09MD


         if [ "$(cat per_gene/EOG091G09MD/ALICUT_EOG091G09MD.clustalo.fasta | grep -v ">" | sed 's/-//g' | grep "^$" | wc -l)" -gt 0 ]
         then
              cp per_gene/EOG091G09MD/ALICUT_EOG091G09MD.clustalo.fasta per_gene/EOG091G09MD/ALICUT_EOG091G09MD.clustalo.fasta.backup
              bash ../scripts/remove_empty.sh per_gene/EOG091G09MD/ALICUT_EOG091G09MD.clustalo.fasta.backup > per_gene/EOG091G09MD/ALICUT_EOG091G09MD.clustalo.fasta
         fi
         touch per_gene/EOG091G09MD/empty_check.done
         
[Sun Jul  5 21:28:38 2020]
Finished job 1847.
91 of 3292 steps (3%) done
[Sun Jul  5 21:28:38 2020]
Finished job 1115.
92 of 3292 steps (3%) done

[Sun Jul  5 21:28:38 2020]
rule find_best_model:
    input: per_gene/EOG091G09MD/ALICUT_EOG091G09MD.clustalo.fasta, per_gene/EOG091G09MD/empty_check.done
    output: per_gene/EOG091G09MD/EOG091G09MD.best_model
    log: per_gene/EOG091G09MD/find_best_model.stderr.txt
    jobid: 1024
    wildcards: BUSCO=EOG091G09MD
    threads: 2


        cd per_gene/EOG091G09MD
        if [ ! -d find_best_model ]
        then
            mkdir find_best_model
        fi
        cd find_best_model
        ln -s ../../../per_gene/EOG091G09MD/ALICUT_EOG091G09MD.clustalo.fasta EOG091G09MD.fasta
        ProteinModelSelection.pl EOG091G09MD.fasta 1> ../../../per_gene/EOG091G09MD/EOG091G09MD.best_model 2> ../../../per_gene/EOG091G09MD/find_best_model.stderr.txt
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/c0c09ee657b1e27f2c5687e0e9aa8d70.simg

[Sun Jul  5 21:28:38 2020]
rule remove_empty:
    input: per_gene/EOG091G0A5N/ALICUT_EOG091G0A5N.clustalo.fasta
    output: per_gene/EOG091G0A5N/empty_check.done
    jobid: 1937
    wildcards: BUSCO=EOG091G0A5N


         if [ "$(cat per_gene/EOG091G0A5N/ALICUT_EOG091G0A5N.clustalo.fasta | grep -v ">" | sed 's/-//g' | grep "^$" | wc -l)" -gt 0 ]
         then
              cp per_gene/EOG091G0A5N/ALICUT_EOG091G0A5N.clustalo.fasta per_gene/EOG091G0A5N/ALICUT_EOG091G0A5N.clustalo.fasta.backup
              bash ../scripts/remove_empty.sh per_gene/EOG091G0A5N/ALICUT_EOG091G0A5N.clustalo.fasta.backup > per_gene/EOG091G0A5N/ALICUT_EOG091G0A5N.clustalo.fasta
         fi
         touch per_gene/EOG091G0A5N/empty_check.done
         
[Sun Jul  5 21:28:38 2020]
Finished job 1937.
93 of 3292 steps (3%) done
[Sun Jul  5 21:28:40 2020]
Finished job 587.
94 of 3292 steps (3%) done

[Sun Jul  5 21:28:40 2020]
rule find_best_model:
    input: per_gene/EOG091G0A5N/ALICUT_EOG091G0A5N.clustalo.fasta, per_gene/EOG091G0A5N/empty_check.done
    output: per_gene/EOG091G0A5N/EOG091G0A5N.best_model
    log: per_gene/EOG091G0A5N/find_best_model.stderr.txt
    jobid: 1114
    wildcards: BUSCO=EOG091G0A5N
    threads: 2


        cd per_gene/EOG091G0A5N
        if [ ! -d find_best_model ]
        then
            mkdir find_best_model
        fi
        cd find_best_model
        ln -s ../../../per_gene/EOG091G0A5N/ALICUT_EOG091G0A5N.clustalo.fasta EOG091G0A5N.fasta
        ProteinModelSelection.pl EOG091G0A5N.fasta 1> ../../../per_gene/EOG091G0A5N/EOG091G0A5N.best_model 2> ../../../per_gene/EOG091G0A5N/find_best_model.stderr.txt
        

[Sun Jul  5 21:28:40 2020]
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/c0c09ee657b1e27f2c5687e0e9aa8d70.simg
rule remove_empty:
    input: per_gene/EOG091G0C8H/ALICUT_EOG091G0C8H.clustalo.fasta
    output: per_gene/EOG091G0C8H/empty_check.done
    jobid: 1409
    wildcards: BUSCO=EOG091G0C8H


         if [ "$(cat per_gene/EOG091G0C8H/ALICUT_EOG091G0C8H.clustalo.fasta | grep -v ">" | sed 's/-//g' | grep "^$" | wc -l)" -gt 0 ]
         then
              cp per_gene/EOG091G0C8H/ALICUT_EOG091G0C8H.clustalo.fasta per_gene/EOG091G0C8H/ALICUT_EOG091G0C8H.clustalo.fasta.backup
              bash ../scripts/remove_empty.sh per_gene/EOG091G0C8H/ALICUT_EOG091G0C8H.clustalo.fasta.backup > per_gene/EOG091G0C8H/ALICUT_EOG091G0C8H.clustalo.fasta
         fi
         touch per_gene/EOG091G0C8H/empty_check.done
         
[Sun Jul  5 21:28:40 2020]
Finished job 1409.
95 of 3292 steps (3%) done
[Sun Jul  5 21:28:40 2020]
Finished job 909.
96 of 3292 steps (3%) done

[Sun Jul  5 21:28:40 2020]
rule MSA:
    input: per_gene/EOG091G1285/EOG091G1285.fasta
    output: per_gene/EOG091G1285/EOG091G1285.clustalo.fasta
    log: per_gene/EOG091G1285/MSA.stdout.txt, per_gene/EOG091G1285/MSA.stderr.txt
    jobid: 1692
    wildcards: BUSCO=EOG091G1285
    threads: 2


        clustalo -i per_gene/EOG091G1285/EOG091G1285.fasta -o per_gene/EOG091G1285/EOG091G1285.clustalo.fasta --threads=2 1> per_gene/EOG091G1285/MSA.stdout.txt 2> per_gene/EOG091G1285/MSA.stderr.txt
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/d68c9691725a7401923680874285c430.simg

[Sun Jul  5 21:28:40 2020]
rule remove_empty:
    input: per_gene/EOG091G09QO/ALICUT_EOG091G09QO.clustalo.fasta
    output: per_gene/EOG091G09QO/empty_check.done
    jobid: 1731
    wildcards: BUSCO=EOG091G09QO


         if [ "$(cat per_gene/EOG091G09QO/ALICUT_EOG091G09QO.clustalo.fasta | grep -v ">" | sed 's/-//g' | grep "^$" | wc -l)" -gt 0 ]
         then
              cp per_gene/EOG091G09QO/ALICUT_EOG091G09QO.clustalo.fasta per_gene/EOG091G09QO/ALICUT_EOG091G09QO.clustalo.fasta.backup
              bash ../scripts/remove_empty.sh per_gene/EOG091G09QO/ALICUT_EOG091G09QO.clustalo.fasta.backup > per_gene/EOG091G09QO/ALICUT_EOG091G09QO.clustalo.fasta
         fi
         touch per_gene/EOG091G09QO/empty_check.done
         
[Sun Jul  5 21:28:40 2020]
Finished job 1731.
97 of 3292 steps (3%) done
[Sun Jul  5 21:28:40 2020]
Finished job 3277.
98 of 3292 steps (3%) done

[Sun Jul  5 21:28:40 2020]
rule find_best_model:
    input: per_gene/EOG091G09QO/ALICUT_EOG091G09QO.clustalo.fasta, per_gene/EOG091G09QO/empty_check.done
    output: per_gene/EOG091G09QO/EOG091G09QO.best_model
    log: per_gene/EOG091G09QO/find_best_model.stderr.txt
    jobid: 908
    wildcards: BUSCO=EOG091G09QO
    threads: 2


        cd per_gene/EOG091G09QO
        if [ ! -d find_best_model ]
        then
            mkdir find_best_model
        fi
        cd find_best_model
        ln -s ../../../per_gene/EOG091G09QO/ALICUT_EOG091G09QO.clustalo.fasta EOG091G09QO.fasta
        ProteinModelSelection.pl EOG091G09QO.fasta 1> ../../../per_gene/EOG091G09QO/EOG091G09QO.best_model 2> ../../../per_gene/EOG091G09QO/find_best_model.stderr.txt
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/c0c09ee657b1e27f2c5687e0e9aa8d70.simg
[Sun Jul  5 21:28:41 2020]
Finished job 1692.
99 of 3292 steps (3%) done

[Sun Jul  5 21:28:41 2020]
rule score_and_cut:
    input: per_gene/EOG091G1285/EOG091G1285.clustalo.fasta
    output: per_gene/EOG091G1285/ALICUT_EOG091G1285.clustalo.fasta
    jobid: 869
    wildcards: BUSCO=EOG091G1285
    threads: 2


        cd per_gene/EOG091G1285
        Aliscore.pl -N -r 200000000000000000 -i ../../per_gene/EOG091G1285/EOG091G1285.clustalo.fasta &> aliscore.log
        ALICUT.pl -s &> alicut.log
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/63c88c27a0fa300f57066b0ef65fefcb.simg
[Sun Jul  5 21:28:42 2020]
Finished job 2573.
100 of 3292 steps (3%) done

[Sun Jul  5 21:28:42 2020]
rule join_groups:
    input: per_gene/EOG091G074U/EOG091G074U.ingroup.fasta, per_gene/EOG091G074U/EOG091G074U.outgroup.fasta
    output: per_gene/EOG091G074U/EOG091G074U.fasta
    jobid: 2110
    wildcards: BUSCO=EOG091G074U


        cat per_gene/EOG091G074U/EOG091G074U.ingroup.fasta per_gene/EOG091G074U/EOG091G074U.outgroup.fasta > per_gene/EOG091G074U/EOG091G074U.fasta
        
[Sun Jul  5 21:28:42 2020]
Finished job 2110.
101 of 3292 steps (3%) done

[Sun Jul  5 21:28:42 2020]
rule join_groups:
    input: per_gene/EOG091G0L5D/EOG091G0L5D.ingroup.fasta, per_gene/EOG091G0L5D/EOG091G0L5D.outgroup.fasta
    output: per_gene/EOG091G0L5D/EOG091G0L5D.fasta
    jobid: 2462
    wildcards: BUSCO=EOG091G0L5D


        cat per_gene/EOG091G0L5D/EOG091G0L5D.ingroup.fasta per_gene/EOG091G0L5D/EOG091G0L5D.outgroup.fasta > per_gene/EOG091G0L5D/EOG091G0L5D.fasta
        
[Sun Jul  5 21:28:42 2020]
Finished job 2462.
102 of 3292 steps (3%) done
[Sun Jul  5 21:28:42 2020]
Finished job 949.
103 of 3292 steps (3%) done

[Sun Jul  5 21:28:42 2020]
rule MSA:
    input: per_gene/EOG091G074U/EOG091G074U.fasta
    output: per_gene/EOG091G074U/EOG091G074U.clustalo.fasta
    log: per_gene/EOG091G074U/MSA.stdout.txt, per_gene/EOG091G074U/MSA.stderr.txt
    jobid: 1340
    wildcards: BUSCO=EOG091G074U
    threads: 2


        clustalo -i per_gene/EOG091G074U/EOG091G074U.fasta -o per_gene/EOG091G074U/EOG091G074U.clustalo.fasta --threads=2 1> per_gene/EOG091G074U/MSA.stdout.txt 2> per_gene/EOG091G074U/MSA.stderr.txt
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/d68c9691725a7401923680874285c430.simg

[Sun Jul  5 21:28:42 2020]
rule remove_empty:
    input: per_gene/EOG091G0N9D/ALICUT_EOG091G0N9D.clustalo.fasta
    output: per_gene/EOG091G0N9D/empty_check.done
    jobid: 1771
    wildcards: BUSCO=EOG091G0N9D


         if [ "$(cat per_gene/EOG091G0N9D/ALICUT_EOG091G0N9D.clustalo.fasta | grep -v ">" | sed 's/-//g' | grep "^$" | wc -l)" -gt 0 ]
         then
              cp per_gene/EOG091G0N9D/ALICUT_EOG091G0N9D.clustalo.fasta per_gene/EOG091G0N9D/ALICUT_EOG091G0N9D.clustalo.fasta.backup
              bash ../scripts/remove_empty.sh per_gene/EOG091G0N9D/ALICUT_EOG091G0N9D.clustalo.fasta.backup > per_gene/EOG091G0N9D/ALICUT_EOG091G0N9D.clustalo.fasta
         fi
         touch per_gene/EOG091G0N9D/empty_check.done
         
[Sun Jul  5 21:28:43 2020]
Finished job 1771.
104 of 3292 steps (3%) done
[Sun Jul  5 21:28:43 2020]
Finished job 2989.
105 of 3292 steps (3%) done

[Sun Jul  5 21:28:43 2020]
rule join_groups:
    input: per_gene/EOG091G0IVB/EOG091G0IVB.ingroup.fasta, per_gene/EOG091G0IVB/EOG091G0IVB.outgroup.fasta
    output: per_gene/EOG091G0IVB/EOG091G0IVB.fasta
    jobid: 2318
    wildcards: BUSCO=EOG091G0IVB


        cat per_gene/EOG091G0IVB/EOG091G0IVB.ingroup.fasta per_gene/EOG091G0IVB/EOG091G0IVB.outgroup.fasta > per_gene/EOG091G0IVB/EOG091G0IVB.fasta
        
[Sun Jul  5 21:28:43 2020]
Finished job 2318.
106 of 3292 steps (3%) done

[Sun Jul  5 21:28:43 2020]
rule MSA:
    input: per_gene/EOG091G0IVB/EOG091G0IVB.fasta
    output: per_gene/EOG091G0IVB/EOG091G0IVB.clustalo.fasta
    log: per_gene/EOG091G0IVB/MSA.stdout.txt, per_gene/EOG091G0IVB/MSA.stderr.txt
    jobid: 1756
    wildcards: BUSCO=EOG091G0IVB
    threads: 2


        clustalo -i per_gene/EOG091G0IVB/EOG091G0IVB.fasta -o per_gene/EOG091G0IVB/EOG091G0IVB.clustalo.fasta --threads=2 1> per_gene/EOG091G0IVB/MSA.stdout.txt 2> per_gene/EOG091G0IVB/MSA.stderr.txt
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/d68c9691725a7401923680874285c430.simg
[Sun Jul  5 21:28:44 2020]
Finished job 733.
107 of 3292 steps (3%) done
[Sun Jul  5 21:28:44 2020]
Finished job 2979.
108 of 3292 steps (3%) done

[Sun Jul  5 21:28:44 2020]
rule remove_empty:
    input: per_gene/EOG091G0NMJ/ALICUT_EOG091G0NMJ.clustalo.fasta
    output: per_gene/EOG091G0NMJ/empty_check.done
    jobid: 1555
    wildcards: BUSCO=EOG091G0NMJ


         if [ "$(cat per_gene/EOG091G0NMJ/ALICUT_EOG091G0NMJ.clustalo.fasta | grep -v ">" | sed 's/-//g' | grep "^$" | wc -l)" -gt 0 ]
         then
              cp per_gene/EOG091G0NMJ/ALICUT_EOG091G0NMJ.clustalo.fasta per_gene/EOG091G0NMJ/ALICUT_EOG091G0NMJ.clustalo.fasta.backup
              bash ../scripts/remove_empty.sh per_gene/EOG091G0NMJ/ALICUT_EOG091G0NMJ.clustalo.fasta.backup > per_gene/EOG091G0NMJ/ALICUT_EOG091G0NMJ.clustalo.fasta
         fi
         touch per_gene/EOG091G0NMJ/empty_check.done
         

[Sun Jul  5 21:28:44 2020]
rule join_groups:
    input: per_gene/EOG091G0FJB/EOG091G0FJB.ingroup.fasta, per_gene/EOG091G0FJB/EOG091G0FJB.outgroup.fasta
    output: per_gene/EOG091G0FJB/EOG091G0FJB.fasta
    jobid: 2313
    wildcards: BUSCO=EOG091G0FJB


        cat per_gene/EOG091G0FJB/EOG091G0FJB.ingroup.fasta per_gene/EOG091G0FJB/EOG091G0FJB.outgroup.fasta > per_gene/EOG091G0FJB/EOG091G0FJB.fasta
        
[Sun Jul  5 21:28:44 2020]
Finished job 1555.
109 of 3292 steps (3%) done
[Sun Jul  5 21:28:44 2020]
Finished job 2313.
110 of 3292 steps (3%) done
[Sun Jul  5 21:28:44 2020]
Finished job 1340.
111 of 3292 steps (3%) done

[Sun Jul  5 21:28:44 2020]
rule find_best_model:
    input: per_gene/EOG091G0NMJ/ALICUT_EOG091G0NMJ.clustalo.fasta, per_gene/EOG091G0NMJ/empty_check.done
    output: per_gene/EOG091G0NMJ/EOG091G0NMJ.best_model
    log: per_gene/EOG091G0NMJ/find_best_model.stderr.txt
    jobid: 732
    wildcards: BUSCO=EOG091G0NMJ
    threads: 2


        cd per_gene/EOG091G0NMJ
        if [ ! -d find_best_model ]
        then
            mkdir find_best_model
        fi
        cd find_best_model
        ln -s ../../../per_gene/EOG091G0NMJ/ALICUT_EOG091G0NMJ.clustalo.fasta EOG091G0NMJ.fasta
        ProteinModelSelection.pl EOG091G0NMJ.fasta 1> ../../../per_gene/EOG091G0NMJ/EOG091G0NMJ.best_model 2> ../../../per_gene/EOG091G0NMJ/find_best_model.stderr.txt
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/c0c09ee657b1e27f2c5687e0e9aa8d70.simg

[Sun Jul  5 21:28:44 2020]
rule MSA:
    input: per_gene/EOG091G0FJB/EOG091G0FJB.fasta
    output: per_gene/EOG091G0FJB/EOG091G0FJB.clustalo.fasta
    log: per_gene/EOG091G0FJB/MSA.stdout.txt, per_gene/EOG091G0FJB/MSA.stderr.txt
    jobid: 1746
    wildcards: BUSCO=EOG091G0FJB
    threads: 2


        clustalo -i per_gene/EOG091G0FJB/EOG091G0FJB.fasta -o per_gene/EOG091G0FJB/EOG091G0FJB.clustalo.fasta --threads=2 1> per_gene/EOG091G0FJB/MSA.stdout.txt 2> per_gene/EOG091G0FJB/MSA.stderr.txt
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/d68c9691725a7401923680874285c430.simg
[Sun Jul  5 21:28:45 2020]
Finished job 1756.
112 of 3292 steps (3%) done

[Sun Jul  5 21:28:45 2020]
rule score_and_cut:
    input: per_gene/EOG091G074U/EOG091G074U.clustalo.fasta
    output: per_gene/EOG091G074U/ALICUT_EOG091G074U.clustalo.fasta
    jobid: 517
    wildcards: BUSCO=EOG091G074U
    threads: 2


        cd per_gene/EOG091G074U
        Aliscore.pl -N -r 200000000000000000 -i ../../per_gene/EOG091G074U/EOG091G074U.clustalo.fasta &> aliscore.log
        ALICUT.pl -s &> alicut.log
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/63c88c27a0fa300f57066b0ef65fefcb.simg
[Sun Jul  5 21:28:45 2020]
Finished job 2849.
113 of 3292 steps (3%) done

[Sun Jul  5 21:28:45 2020]
rule score_and_cut:
    input: per_gene/EOG091G0IVB/EOG091G0IVB.clustalo.fasta
    output: per_gene/EOG091G0IVB/ALICUT_EOG091G0IVB.clustalo.fasta
    jobid: 933
    wildcards: BUSCO=EOG091G0IVB
    threads: 2


        cd per_gene/EOG091G0IVB
        Aliscore.pl -N -r 200000000000000000 -i ../../per_gene/EOG091G0IVB/EOG091G0IVB.clustalo.fasta &> aliscore.log
        ALICUT.pl -s &> alicut.log
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/63c88c27a0fa300f57066b0ef65fefcb.simg
[Sun Jul  5 21:28:46 2020]
Finished job 1746.
114 of 3292 steps (3%) done

[Sun Jul  5 21:28:46 2020]
rule score_and_cut:
    input: per_gene/EOG091G0FJB/EOG091G0FJB.clustalo.fasta
    output: per_gene/EOG091G0FJB/ALICUT_EOG091G0FJB.clustalo.fasta
    jobid: 923
    wildcards: BUSCO=EOG091G0FJB
    threads: 2


        cd per_gene/EOG091G0FJB
        Aliscore.pl -N -r 200000000000000000 -i ../../per_gene/EOG091G0FJB/EOG091G0FJB.clustalo.fasta &> aliscore.log
        ALICUT.pl -s &> alicut.log
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/63c88c27a0fa300f57066b0ef65fefcb.simg
[Sun Jul  5 21:28:47 2020]
Finished job 847.
115 of 3292 steps (3%) done

[Sun Jul  5 21:28:47 2020]
rule join_groups:
    input: per_gene/EOG091G0SU6/EOG091G0SU6.ingroup.fasta, per_gene/EOG091G0SU6/EOG091G0SU6.outgroup.fasta
    output: per_gene/EOG091G0SU6/EOG091G0SU6.fasta
    jobid: 2248
    wildcards: BUSCO=EOG091G0SU6


        cat per_gene/EOG091G0SU6/EOG091G0SU6.ingroup.fasta per_gene/EOG091G0SU6/EOG091G0SU6.outgroup.fasta > per_gene/EOG091G0SU6/EOG091G0SU6.fasta
        

[Sun Jul  5 21:28:47 2020]
rule remove_empty:
    input: per_gene/EOG091G0YZ0/ALICUT_EOG091G0YZ0.clustalo.fasta
    output: per_gene/EOG091G0YZ0/empty_check.done
    jobid: 1669
    wildcards: BUSCO=EOG091G0YZ0


         if [ "$(cat per_gene/EOG091G0YZ0/ALICUT_EOG091G0YZ0.clustalo.fasta | grep -v ">" | sed 's/-//g' | grep "^$" | wc -l)" -gt 0 ]
         then
              cp per_gene/EOG091G0YZ0/ALICUT_EOG091G0YZ0.clustalo.fasta per_gene/EOG091G0YZ0/ALICUT_EOG091G0YZ0.clustalo.fasta.backup
              bash ../scripts/remove_empty.sh per_gene/EOG091G0YZ0/ALICUT_EOG091G0YZ0.clustalo.fasta.backup > per_gene/EOG091G0YZ0/ALICUT_EOG091G0YZ0.clustalo.fasta
         fi
         touch per_gene/EOG091G0YZ0/empty_check.done
         
[Sun Jul  5 21:28:47 2020]
Finished job 2248.
116 of 3292 steps (4%) done
[Sun Jul  5 21:28:47 2020]
Finished job 1669.
117 of 3292 steps (4%) done

[Sun Jul  5 21:28:47 2020]
rule MSA:
    input: per_gene/EOG091G0SU6/EOG091G0SU6.fasta
    output: per_gene/EOG091G0SU6/EOG091G0SU6.clustalo.fasta
    log: per_gene/EOG091G0SU6/MSA.stdout.txt, per_gene/EOG091G0SU6/MSA.stderr.txt
    jobid: 1616
    wildcards: BUSCO=EOG091G0SU6
    threads: 2


        clustalo -i per_gene/EOG091G0SU6/EOG091G0SU6.fasta -o per_gene/EOG091G0SU6/EOG091G0SU6.clustalo.fasta --threads=2 1> per_gene/EOG091G0SU6/MSA.stdout.txt 2> per_gene/EOG091G0SU6/MSA.stderr.txt
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/d68c9691725a7401923680874285c430.simg
[Sun Jul  5 21:28:47 2020]
Finished job 1616.
118 of 3292 steps (4%) done

[Sun Jul  5 21:28:47 2020]
rule score_and_cut:
    input: per_gene/EOG091G0SU6/EOG091G0SU6.clustalo.fasta
    output: per_gene/EOG091G0SU6/ALICUT_EOG091G0SU6.clustalo.fasta
    jobid: 793
    wildcards: BUSCO=EOG091G0SU6
    threads: 2


        cd per_gene/EOG091G0SU6
        Aliscore.pl -N -r 200000000000000000 -i ../../per_gene/EOG091G0SU6/EOG091G0SU6.clustalo.fasta &> aliscore.log
        ALICUT.pl -s &> alicut.log
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/63c88c27a0fa300f57066b0ef65fefcb.simg
[Sun Jul  5 21:28:50 2020]
Finished job 869.
119 of 3292 steps (4%) done

[Sun Jul  5 21:28:50 2020]
rule MSA:
    input: per_gene/EOG091G0L5D/EOG091G0L5D.fasta
    output: per_gene/EOG091G0L5D/EOG091G0L5D.clustalo.fasta
    log: per_gene/EOG091G0L5D/MSA.stdout.txt, per_gene/EOG091G0L5D/MSA.stderr.txt
    jobid: 2044
    wildcards: BUSCO=EOG091G0L5D
    threads: 2


        clustalo -i per_gene/EOG091G0L5D/EOG091G0L5D.fasta -o per_gene/EOG091G0L5D/EOG091G0L5D.clustalo.fasta --threads=2 1> per_gene/EOG091G0L5D/MSA.stdout.txt 2> per_gene/EOG091G0L5D/MSA.stderr.txt
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/d68c9691725a7401923680874285c430.simg
[Sun Jul  5 21:28:51 2020]
Finished job 2044.
120 of 3292 steps (4%) done

[Sun Jul  5 21:28:51 2020]
rule score_and_cut:
    input: per_gene/EOG091G0L5D/EOG091G0L5D.clustalo.fasta
    output: per_gene/EOG091G0L5D/ALICUT_EOG091G0L5D.clustalo.fasta
    jobid: 1221
    wildcards: BUSCO=EOG091G0L5D
    threads: 2


        cd per_gene/EOG091G0L5D
        Aliscore.pl -N -r 200000000000000000 -i ../../per_gene/EOG091G0L5D/EOG091G0L5D.clustalo.fasta &> aliscore.log
        ALICUT.pl -s &> alicut.log
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/63c88c27a0fa300f57066b0ef65fefcb.simg
[Sun Jul  5 21:28:53 2020]
Finished job 517.
121 of 3292 steps (4%) done

[Sun Jul  5 21:28:53 2020]
rule remove_empty:
    input: per_gene/EOG091G074U/ALICUT_EOG091G074U.clustalo.fasta
    output: per_gene/EOG091G074U/empty_check.done
    jobid: 1339
    wildcards: BUSCO=EOG091G074U


         if [ "$(cat per_gene/EOG091G074U/ALICUT_EOG091G074U.clustalo.fasta | grep -v ">" | sed 's/-//g' | grep "^$" | wc -l)" -gt 0 ]
         then
              cp per_gene/EOG091G074U/ALICUT_EOG091G074U.clustalo.fasta per_gene/EOG091G074U/ALICUT_EOG091G074U.clustalo.fasta.backup
              bash ../scripts/remove_empty.sh per_gene/EOG091G074U/ALICUT_EOG091G074U.clustalo.fasta.backup > per_gene/EOG091G074U/ALICUT_EOG091G074U.clustalo.fasta
         fi
         touch per_gene/EOG091G074U/empty_check.done
         

[Sun Jul  5 21:28:53 2020]
rule remove_empty:
    input: per_gene/EOG091G1285/ALICUT_EOG091G1285.clustalo.fasta
    output: per_gene/EOG091G1285/empty_check.done
    jobid: 1691
    wildcards: BUSCO=EOG091G1285


         if [ "$(cat per_gene/EOG091G1285/ALICUT_EOG091G1285.clustalo.fasta | grep -v ">" | sed 's/-//g' | grep "^$" | wc -l)" -gt 0 ]
         then
              cp per_gene/EOG091G1285/ALICUT_EOG091G1285.clustalo.fasta per_gene/EOG091G1285/ALICUT_EOG091G1285.clustalo.fasta.backup
              bash ../scripts/remove_empty.sh per_gene/EOG091G1285/ALICUT_EOG091G1285.clustalo.fasta.backup > per_gene/EOG091G1285/ALICUT_EOG091G1285.clustalo.fasta
         fi
         touch per_gene/EOG091G1285/empty_check.done
         
[Sun Jul  5 21:28:53 2020]
Finished job 1339.
122 of 3292 steps (4%) done
[Sun Jul  5 21:28:53 2020]
Finished job 1691.
123 of 3292 steps (4%) done

[Sun Jul  5 21:28:53 2020]
rule find_best_model:
    input: per_gene/EOG091G074U/ALICUT_EOG091G074U.clustalo.fasta, per_gene/EOG091G074U/empty_check.done
    output: per_gene/EOG091G074U/EOG091G074U.best_model
    log: per_gene/EOG091G074U/find_best_model.stderr.txt
    jobid: 516
    wildcards: BUSCO=EOG091G074U
    threads: 2


        cd per_gene/EOG091G074U
        if [ ! -d find_best_model ]
        then
            mkdir find_best_model
        fi
        cd find_best_model
        ln -s ../../../per_gene/EOG091G074U/ALICUT_EOG091G074U.clustalo.fasta EOG091G074U.fasta
        ProteinModelSelection.pl EOG091G074U.fasta 1> ../../../per_gene/EOG091G074U/EOG091G074U.best_model 2> ../../../per_gene/EOG091G074U/find_best_model.stderr.txt
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/c0c09ee657b1e27f2c5687e0e9aa8d70.simg
[Sun Jul  5 21:28:54 2020]
Finished job 933.
124 of 3292 steps (4%) done

[Sun Jul  5 21:28:54 2020]
rule remove_empty:
    input: per_gene/EOG091G0IVB/ALICUT_EOG091G0IVB.clustalo.fasta
    output: per_gene/EOG091G0IVB/empty_check.done
    jobid: 1755
    wildcards: BUSCO=EOG091G0IVB


         if [ "$(cat per_gene/EOG091G0IVB/ALICUT_EOG091G0IVB.clustalo.fasta | grep -v ">" | sed 's/-//g' | grep "^$" | wc -l)" -gt 0 ]
         then
              cp per_gene/EOG091G0IVB/ALICUT_EOG091G0IVB.clustalo.fasta per_gene/EOG091G0IVB/ALICUT_EOG091G0IVB.clustalo.fasta.backup
              bash ../scripts/remove_empty.sh per_gene/EOG091G0IVB/ALICUT_EOG091G0IVB.clustalo.fasta.backup > per_gene/EOG091G0IVB/ALICUT_EOG091G0IVB.clustalo.fasta
         fi
         touch per_gene/EOG091G0IVB/empty_check.done
         
[Sun Jul  5 21:28:54 2020]
Finished job 1755.
125 of 3292 steps (4%) done

[Sun Jul  5 21:28:54 2020]
rule find_best_model:
    input: per_gene/EOG091G0IVB/ALICUT_EOG091G0IVB.clustalo.fasta, per_gene/EOG091G0IVB/empty_check.done
    output: per_gene/EOG091G0IVB/EOG091G0IVB.best_model
    log: per_gene/EOG091G0IVB/find_best_model.stderr.txt
    jobid: 932
    wildcards: BUSCO=EOG091G0IVB
    threads: 2


        cd per_gene/EOG091G0IVB
        if [ ! -d find_best_model ]
        then
            mkdir find_best_model
        fi
        cd find_best_model
        ln -s ../../../per_gene/EOG091G0IVB/ALICUT_EOG091G0IVB.clustalo.fasta EOG091G0IVB.fasta
        ProteinModelSelection.pl EOG091G0IVB.fasta 1> ../../../per_gene/EOG091G0IVB/EOG091G0IVB.best_model 2> ../../../per_gene/EOG091G0IVB/find_best_model.stderr.txt
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/c0c09ee657b1e27f2c5687e0e9aa8d70.simg
[Sun Jul  5 21:28:55 2020]
Finished job 923.
126 of 3292 steps (4%) done

[Sun Jul  5 21:28:55 2020]
rule remove_empty:
    input: per_gene/EOG091G0FJB/ALICUT_EOG091G0FJB.clustalo.fasta
    output: per_gene/EOG091G0FJB/empty_check.done
    jobid: 1745
    wildcards: BUSCO=EOG091G0FJB


         if [ "$(cat per_gene/EOG091G0FJB/ALICUT_EOG091G0FJB.clustalo.fasta | grep -v ">" | sed 's/-//g' | grep "^$" | wc -l)" -gt 0 ]
         then
              cp per_gene/EOG091G0FJB/ALICUT_EOG091G0FJB.clustalo.fasta per_gene/EOG091G0FJB/ALICUT_EOG091G0FJB.clustalo.fasta.backup
              bash ../scripts/remove_empty.sh per_gene/EOG091G0FJB/ALICUT_EOG091G0FJB.clustalo.fasta.backup > per_gene/EOG091G0FJB/ALICUT_EOG091G0FJB.clustalo.fasta
         fi
         touch per_gene/EOG091G0FJB/empty_check.done
         
[Sun Jul  5 21:28:55 2020]
Finished job 1745.
127 of 3292 steps (4%) done

[Sun Jul  5 21:28:55 2020]
rule find_best_model:
    input: per_gene/EOG091G0FJB/ALICUT_EOG091G0FJB.clustalo.fasta, per_gene/EOG091G0FJB/empty_check.done
    output: per_gene/EOG091G0FJB/EOG091G0FJB.best_model
    log: per_gene/EOG091G0FJB/find_best_model.stderr.txt
    jobid: 922
    wildcards: BUSCO=EOG091G0FJB
    threads: 2


        cd per_gene/EOG091G0FJB
        if [ ! -d find_best_model ]
        then
            mkdir find_best_model
        fi
        cd find_best_model
        ln -s ../../../per_gene/EOG091G0FJB/ALICUT_EOG091G0FJB.clustalo.fasta EOG091G0FJB.fasta
        ProteinModelSelection.pl EOG091G0FJB.fasta 1> ../../../per_gene/EOG091G0FJB/EOG091G0FJB.best_model 2> ../../../per_gene/EOG091G0FJB/find_best_model.stderr.txt
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/c0c09ee657b1e27f2c5687e0e9aa8d70.simg
[Sun Jul  5 21:28:56 2020]
Finished job 793.
128 of 3292 steps (4%) done

[Sun Jul  5 21:28:56 2020]
rule remove_empty:
    input: per_gene/EOG091G0SU6/ALICUT_EOG091G0SU6.clustalo.fasta
    output: per_gene/EOG091G0SU6/empty_check.done
    jobid: 1615
    wildcards: BUSCO=EOG091G0SU6


         if [ "$(cat per_gene/EOG091G0SU6/ALICUT_EOG091G0SU6.clustalo.fasta | grep -v ">" | sed 's/-//g' | grep "^$" | wc -l)" -gt 0 ]
         then
              cp per_gene/EOG091G0SU6/ALICUT_EOG091G0SU6.clustalo.fasta per_gene/EOG091G0SU6/ALICUT_EOG091G0SU6.clustalo.fasta.backup
              bash ../scripts/remove_empty.sh per_gene/EOG091G0SU6/ALICUT_EOG091G0SU6.clustalo.fasta.backup > per_gene/EOG091G0SU6/ALICUT_EOG091G0SU6.clustalo.fasta
         fi
         touch per_gene/EOG091G0SU6/empty_check.done
         
[Sun Jul  5 21:28:56 2020]
Finished job 1615.
129 of 3292 steps (4%) done

[Sun Jul  5 21:28:56 2020]
rule find_best_model:
    input: per_gene/EOG091G0SU6/ALICUT_EOG091G0SU6.clustalo.fasta, per_gene/EOG091G0SU6/empty_check.done
    output: per_gene/EOG091G0SU6/EOG091G0SU6.best_model
    log: per_gene/EOG091G0SU6/find_best_model.stderr.txt
    jobid: 792
    wildcards: BUSCO=EOG091G0SU6
    threads: 2


        cd per_gene/EOG091G0SU6
        if [ ! -d find_best_model ]
        then
            mkdir find_best_model
        fi
        cd find_best_model
        ln -s ../../../per_gene/EOG091G0SU6/ALICUT_EOG091G0SU6.clustalo.fasta EOG091G0SU6.fasta
        ProteinModelSelection.pl EOG091G0SU6.fasta 1> ../../../per_gene/EOG091G0SU6/EOG091G0SU6.best_model 2> ../../../per_gene/EOG091G0SU6/find_best_model.stderr.txt
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/c0c09ee657b1e27f2c5687e0e9aa8d70.simg
[Sun Jul  5 21:28:59 2020]
Finished job 1221.
130 of 3292 steps (4%) done

[Sun Jul  5 21:28:59 2020]
rule remove_empty:
    input: per_gene/EOG091G0L5D/ALICUT_EOG091G0L5D.clustalo.fasta
    output: per_gene/EOG091G0L5D/empty_check.done
    jobid: 2043
    wildcards: BUSCO=EOG091G0L5D


         if [ "$(cat per_gene/EOG091G0L5D/ALICUT_EOG091G0L5D.clustalo.fasta | grep -v ">" | sed 's/-//g' | grep "^$" | wc -l)" -gt 0 ]
         then
              cp per_gene/EOG091G0L5D/ALICUT_EOG091G0L5D.clustalo.fasta per_gene/EOG091G0L5D/ALICUT_EOG091G0L5D.clustalo.fasta.backup
              bash ../scripts/remove_empty.sh per_gene/EOG091G0L5D/ALICUT_EOG091G0L5D.clustalo.fasta.backup > per_gene/EOG091G0L5D/ALICUT_EOG091G0L5D.clustalo.fasta
         fi
         touch per_gene/EOG091G0L5D/empty_check.done
         
[Sun Jul  5 21:28:59 2020]
Finished job 2043.
131 of 3292 steps (4%) done

[Sun Jul  5 21:28:59 2020]
rule find_best_model:
    input: per_gene/EOG091G0L5D/ALICUT_EOG091G0L5D.clustalo.fasta, per_gene/EOG091G0L5D/empty_check.done
    output: per_gene/EOG091G0L5D/EOG091G0L5D.best_model
    log: per_gene/EOG091G0L5D/find_best_model.stderr.txt
    jobid: 1220
    wildcards: BUSCO=EOG091G0L5D
    threads: 2


        cd per_gene/EOG091G0L5D
        if [ ! -d find_best_model ]
        then
            mkdir find_best_model
        fi
        cd find_best_model
        ln -s ../../../per_gene/EOG091G0L5D/ALICUT_EOG091G0L5D.clustalo.fasta EOG091G0L5D.fasta
        ProteinModelSelection.pl EOG091G0L5D.fasta 1> ../../../per_gene/EOG091G0L5D/EOG091G0L5D.best_model 2> ../../../per_gene/EOG091G0L5D/find_best_model.stderr.txt
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/c0c09ee657b1e27f2c5687e0e9aa8d70.simg
[Sun Jul  5 21:29:00 2020]
Finished job 2931.
132 of 3292 steps (4%) done

[Sun Jul  5 21:29:00 2020]
rule join_groups:
    input: per_gene/EOG091G146E/EOG091G146E.ingroup.fasta, per_gene/EOG091G146E/EOG091G146E.outgroup.fasta
    output: per_gene/EOG091G146E/EOG091G146E.fasta
    jobid: 2289
    wildcards: BUSCO=EOG091G146E


        cat per_gene/EOG091G146E/EOG091G146E.ingroup.fasta per_gene/EOG091G146E/EOG091G146E.outgroup.fasta > per_gene/EOG091G146E/EOG091G146E.fasta
        
[Sun Jul  5 21:29:00 2020]
Finished job 2289.
133 of 3292 steps (4%) done
[Sun Jul  5 21:29:02 2020]
Finished job 3023.
134 of 3292 steps (4%) done

[Sun Jul  5 21:29:02 2020]
rule find_best_model:
    input: per_gene/EOG091G0N9D/ALICUT_EOG091G0N9D.clustalo.fasta, per_gene/EOG091G0N9D/empty_check.done
    output: per_gene/EOG091G0N9D/EOG091G0N9D.best_model
    log: per_gene/EOG091G0N9D/find_best_model.stderr.txt
    jobid: 948
    wildcards: BUSCO=EOG091G0N9D
    threads: 2


        cd per_gene/EOG091G0N9D
        if [ ! -d find_best_model ]
        then
            mkdir find_best_model
        fi
        cd find_best_model
        ln -s ../../../per_gene/EOG091G0N9D/ALICUT_EOG091G0N9D.clustalo.fasta EOG091G0N9D.fasta
        ProteinModelSelection.pl EOG091G0N9D.fasta 1> ../../../per_gene/EOG091G0N9D/EOG091G0N9D.best_model 2> ../../../per_gene/EOG091G0N9D/find_best_model.stderr.txt
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/c0c09ee657b1e27f2c5687e0e9aa8d70.simg
[Sun Jul  5 21:29:03 2020]
Finished job 662.
135 of 3292 steps (4%) done

[Sun Jul  5 21:29:03 2020]
rule infer_single_ML:
    input: per_gene/EOG091G0ITS/EOG091G0ITS.best_model, per_gene/EOG091G0ITS/ALICUT_EOG091G0ITS.clustalo.fasta
    output: per_gene/EOG091G0ITS/EOG091G0ITS.raxml.done
    log: per_gene/EOG091G0ITS/infer_single_ML.stdout.txt, per_gene/EOG091G0ITS/infer_single_ML.stderr.txt
    jobid: 125
    wildcards: BUSCO=EOG091G0ITS
    threads: 2


        cd per_gene/EOG091G0ITS
	count=$(cat ../../per_gene/EOG091G0ITS/ALICUT_EOG091G0ITS.clustalo.fasta | grep ">" | wc -l)
	if [ "$count" -gt 5 ]
        then
		RAxMLmodel=$(cat ../../per_gene/EOG091G0ITS/EOG091G0ITS.best_model | grep "Best" | cut -d ":" -f 2 | tr -d '[:space:]')
                if [ "$(ls -1 | grep "^RAxML" | wc -l)" -ne 0 ]
		then
			rm RAxML*
		fi
        	raxml -f a -T 2 -m PROTGAMMA$RAxMLmodel         	-p 12345 -x 12345 -# 100         	-s ../../per_gene/EOG091G0ITS/ALICUT_EOG091G0ITS.clustalo.fasta -n EOG091G0ITS.clustalo.aln.ALICUT.$RAxMLmodel 		1> ../../per_gene/EOG091G0ITS/infer_single_ML.stdout.txt 2> ../../per_gene/EOG091G0ITS/infer_single_ML.stderr.txt
	else
		echo "fasta file per_gene/EOG091G0ITS/ALICUT_EOG091G0ITS.clustalo.fasta contains fewer than 5 sequences - skipped" > ../../per_gene/EOG091G0ITS/infer_single_ML.stdout.txt
		touch raxml.skipped
	fi
        touch ../../per_gene/EOG091G0ITS/EOG091G0ITS.raxml.done
        
[33mJob counts:
	count	jobs
	1	infer_single_ML
	1[0m
[33m
        cd per_gene/EOG091G0ITS
	count=$(cat ../../per_gene/EOG091G0ITS/ALICUT_EOG091G0ITS.clustalo.fasta | grep ">" | wc -l)
	if [ "$count" -gt 5 ]
        then
		RAxMLmodel=$(cat ../../per_gene/EOG091G0ITS/EOG091G0ITS.best_model | grep "Best" | cut -d ":" -f 2 | tr -d '[:space:]')
                if [ "$(ls -1 | grep "^RAxML" | wc -l)" -ne 0 ]
		then
			rm RAxML*
		fi
        	raxml -f a -T 2 -m PROTGAMMA$RAxMLmodel         	-p 12345 -x 12345 -# 100         	-s ../../per_gene/EOG091G0ITS/ALICUT_EOG091G0ITS.clustalo.fasta -n EOG091G0ITS.clustalo.aln.ALICUT.$RAxMLmodel 		1> ../../per_gene/EOG091G0ITS/infer_single_ML.stdout.txt 2> ../../per_gene/EOG091G0ITS/infer_single_ML.stderr.txt
	else
		echo "fasta file per_gene/EOG091G0ITS/ALICUT_EOG091G0ITS.clustalo.fasta contains fewer than 5 sequences - skipped" > ../../per_gene/EOG091G0ITS/infer_single_ML.stdout.txt
		touch raxml.skipped
	fi
        touch ../../per_gene/EOG091G0ITS/EOG091G0ITS.raxml.done
        [0m
[Sun Jul  5 21:29:18 2020]
Finished job 1152.
136 of 3292 steps (4%) done

[Sun Jul  5 21:29:18 2020]
rule infer_single_ML:
    input: per_gene/EOG091G0IDG/EOG091G0IDG.best_model, per_gene/EOG091G0IDG/ALICUT_EOG091G0IDG.clustalo.fasta
    output: per_gene/EOG091G0IDG/EOG091G0IDG.raxml.done
    log: per_gene/EOG091G0IDG/infer_single_ML.stdout.txt, per_gene/EOG091G0IDG/infer_single_ML.stderr.txt
    jobid: 370
    wildcards: BUSCO=EOG091G0IDG
    threads: 2


        cd per_gene/EOG091G0IDG
	count=$(cat ../../per_gene/EOG091G0IDG/ALICUT_EOG091G0IDG.clustalo.fasta | grep ">" | wc -l)
	if [ "$count" -gt 5 ]
        then
		RAxMLmodel=$(cat ../../per_gene/EOG091G0IDG/EOG091G0IDG.best_model | grep "Best" | cut -d ":" -f 2 | tr -d '[:space:]')
                if [ "$(ls -1 | grep "^RAxML" | wc -l)" -ne 0 ]
		then
			rm RAxML*
		fi
        	raxml -f a -T 2 -m PROTGAMMA$RAxMLmodel         	-p 12345 -x 12345 -# 100         	-s ../../per_gene/EOG091G0IDG/ALICUT_EOG091G0IDG.clustalo.fasta -n EOG091G0IDG.clustalo.aln.ALICUT.$RAxMLmodel 		1> ../../per_gene/EOG091G0IDG/infer_single_ML.stdout.txt 2> ../../per_gene/EOG091G0IDG/infer_single_ML.stderr.txt
	else
		echo "fasta file per_gene/EOG091G0IDG/ALICUT_EOG091G0IDG.clustalo.fasta contains fewer than 5 sequences - skipped" > ../../per_gene/EOG091G0IDG/infer_single_ML.stdout.txt
		touch raxml.skipped
	fi
        touch ../../per_gene/EOG091G0IDG/EOG091G0IDG.raxml.done
        
[33mJob counts:
	count	jobs
	1	infer_single_ML
	1[0m
[33m
        cd per_gene/EOG091G0IDG
	count=$(cat ../../per_gene/EOG091G0IDG/ALICUT_EOG091G0IDG.clustalo.fasta | grep ">" | wc -l)
	if [ "$count" -gt 5 ]
        then
		RAxMLmodel=$(cat ../../per_gene/EOG091G0IDG/EOG091G0IDG.best_model | grep "Best" | cut -d ":" -f 2 | tr -d '[:space:]')
                if [ "$(ls -1 | grep "^RAxML" | wc -l)" -ne 0 ]
		then
			rm RAxML*
		fi
        	raxml -f a -T 2 -m PROTGAMMA$RAxMLmodel         	-p 12345 -x 12345 -# 100         	-s ../../per_gene/EOG091G0IDG/ALICUT_EOG091G0IDG.clustalo.fasta -n EOG091G0IDG.clustalo.aln.ALICUT.$RAxMLmodel 		1> ../../per_gene/EOG091G0IDG/infer_single_ML.stdout.txt 2> ../../per_gene/EOG091G0IDG/infer_single_ML.stderr.txt
	else
		echo "fasta file per_gene/EOG091G0IDG/ALICUT_EOG091G0IDG.clustalo.fasta contains fewer than 5 sequences - skipped" > ../../per_gene/EOG091G0IDG/infer_single_ML.stdout.txt
		touch raxml.skipped
	fi
        touch ../../per_gene/EOG091G0IDG/EOG091G0IDG.raxml.done
        [0m
[Sun Jul  5 21:29:20 2020]
Finished job 900.
137 of 3292 steps (4%) done

[Sun Jul  5 21:29:20 2020]
rule infer_single_ML:
    input: per_gene/EOG091G05TG/EOG091G05TG.best_model, per_gene/EOG091G05TG/ALICUT_EOG091G05TG.clustalo.fasta
    output: per_gene/EOG091G05TG/EOG091G05TG.raxml.done
    log: per_gene/EOG091G05TG/infer_single_ML.stdout.txt, per_gene/EOG091G05TG/infer_single_ML.stderr.txt
    jobid: 244
    wildcards: BUSCO=EOG091G05TG
    threads: 2


        cd per_gene/EOG091G05TG
	count=$(cat ../../per_gene/EOG091G05TG/ALICUT_EOG091G05TG.clustalo.fasta | grep ">" | wc -l)
	if [ "$count" -gt 5 ]
        then
		RAxMLmodel=$(cat ../../per_gene/EOG091G05TG/EOG091G05TG.best_model | grep "Best" | cut -d ":" -f 2 | tr -d '[:space:]')
                if [ "$(ls -1 | grep "^RAxML" | wc -l)" -ne 0 ]
		then
			rm RAxML*
		fi
        	raxml -f a -T 2 -m PROTGAMMA$RAxMLmodel         	-p 12345 -x 12345 -# 100         	-s ../../per_gene/EOG091G05TG/ALICUT_EOG091G05TG.clustalo.fasta -n EOG091G05TG.clustalo.aln.ALICUT.$RAxMLmodel 		1> ../../per_gene/EOG091G05TG/infer_single_ML.stdout.txt 2> ../../per_gene/EOG091G05TG/infer_single_ML.stderr.txt
	else
		echo "fasta file per_gene/EOG091G05TG/ALICUT_EOG091G05TG.clustalo.fasta contains fewer than 5 sequences - skipped" > ../../per_gene/EOG091G05TG/infer_single_ML.stdout.txt
		touch raxml.skipped
	fi
        touch ../../per_gene/EOG091G05TG/EOG091G05TG.raxml.done
        
[33mJob counts:
	count	jobs
	1	infer_single_ML
	1[0m
[33m
        cd per_gene/EOG091G05TG
	count=$(cat ../../per_gene/EOG091G05TG/ALICUT_EOG091G05TG.clustalo.fasta | grep ">" | wc -l)
	if [ "$count" -gt 5 ]
        then
		RAxMLmodel=$(cat ../../per_gene/EOG091G05TG/EOG091G05TG.best_model | grep "Best" | cut -d ":" -f 2 | tr -d '[:space:]')
                if [ "$(ls -1 | grep "^RAxML" | wc -l)" -ne 0 ]
		then
			rm RAxML*
		fi
        	raxml -f a -T 2 -m PROTGAMMA$RAxMLmodel         	-p 12345 -x 12345 -# 100         	-s ../../per_gene/EOG091G05TG/ALICUT_EOG091G05TG.clustalo.fasta -n EOG091G05TG.clustalo.aln.ALICUT.$RAxMLmodel 		1> ../../per_gene/EOG091G05TG/infer_single_ML.stdout.txt 2> ../../per_gene/EOG091G05TG/infer_single_ML.stderr.txt
	else
		echo "fasta file per_gene/EOG091G05TG/ALICUT_EOG091G05TG.clustalo.fasta contains fewer than 5 sequences - skipped" > ../../per_gene/EOG091G05TG/infer_single_ML.stdout.txt
		touch raxml.skipped
	fi
        touch ../../per_gene/EOG091G05TG/EOG091G05TG.raxml.done
        [0m
[Sun Jul  5 21:29:23 2020]
Finished job 1024.
138 of 3292 steps (4%) done

[Sun Jul  5 21:29:23 2020]
rule infer_single_ML:
    input: per_gene/EOG091G09MD/EOG091G09MD.best_model, per_gene/EOG091G09MD/ALICUT_EOG091G09MD.clustalo.fasta
    output: per_gene/EOG091G09MD/EOG091G09MD.raxml.done
    log: per_gene/EOG091G09MD/infer_single_ML.stdout.txt, per_gene/EOG091G09MD/infer_single_ML.stderr.txt
    jobid: 306
    wildcards: BUSCO=EOG091G09MD
    threads: 2


        cd per_gene/EOG091G09MD
	count=$(cat ../../per_gene/EOG091G09MD/ALICUT_EOG091G09MD.clustalo.fasta | grep ">" | wc -l)
	if [ "$count" -gt 5 ]
        then
		RAxMLmodel=$(cat ../../per_gene/EOG091G09MD/EOG091G09MD.best_model | grep "Best" | cut -d ":" -f 2 | tr -d '[:space:]')
                if [ "$(ls -1 | grep "^RAxML" | wc -l)" -ne 0 ]
		then
			rm RAxML*
		fi
        	raxml -f a -T 2 -m PROTGAMMA$RAxMLmodel         	-p 12345 -x 12345 -# 100         	-s ../../per_gene/EOG091G09MD/ALICUT_EOG091G09MD.clustalo.fasta -n EOG091G09MD.clustalo.aln.ALICUT.$RAxMLmodel 		1> ../../per_gene/EOG091G09MD/infer_single_ML.stdout.txt 2> ../../per_gene/EOG091G09MD/infer_single_ML.stderr.txt
	else
		echo "fasta file per_gene/EOG091G09MD/ALICUT_EOG091G09MD.clustalo.fasta contains fewer than 5 sequences - skipped" > ../../per_gene/EOG091G09MD/infer_single_ML.stdout.txt
		touch raxml.skipped
	fi
        touch ../../per_gene/EOG091G09MD/EOG091G09MD.raxml.done
        
[33mJob counts:
	count	jobs
	1	infer_single_ML
	1[0m
[33m
        cd per_gene/EOG091G09MD
	count=$(cat ../../per_gene/EOG091G09MD/ALICUT_EOG091G09MD.clustalo.fasta | grep ">" | wc -l)
	if [ "$count" -gt 5 ]
        then
		RAxMLmodel=$(cat ../../per_gene/EOG091G09MD/EOG091G09MD.best_model | grep "Best" | cut -d ":" -f 2 | tr -d '[:space:]')
                if [ "$(ls -1 | grep "^RAxML" | wc -l)" -ne 0 ]
		then
			rm RAxML*
		fi
        	raxml -f a -T 2 -m PROTGAMMA$RAxMLmodel         	-p 12345 -x 12345 -# 100         	-s ../../per_gene/EOG091G09MD/ALICUT_EOG091G09MD.clustalo.fasta -n EOG091G09MD.clustalo.aln.ALICUT.$RAxMLmodel 		1> ../../per_gene/EOG091G09MD/infer_single_ML.stdout.txt 2> ../../per_gene/EOG091G09MD/infer_single_ML.stderr.txt
	else
		echo "fasta file per_gene/EOG091G09MD/ALICUT_EOG091G09MD.clustalo.fasta contains fewer than 5 sequences - skipped" > ../../per_gene/EOG091G09MD/infer_single_ML.stdout.txt
		touch raxml.skipped
	fi
        touch ../../per_gene/EOG091G09MD/EOG091G09MD.raxml.done
        [0m
[Sun Jul  5 21:29:24 2020]
Finished job 520.
139 of 3292 steps (4%) done

[Sun Jul  5 21:29:24 2020]
rule infer_single_ML:
    input: per_gene/EOG091G07IK/EOG091G07IK.best_model, per_gene/EOG091G07IK/ALICUT_EOG091G07IK.clustalo.fasta
    output: per_gene/EOG091G07IK/EOG091G07IK.raxml.done
    log: per_gene/EOG091G07IK/infer_single_ML.stdout.txt, per_gene/EOG091G07IK/infer_single_ML.stderr.txt
    jobid: 54
    wildcards: BUSCO=EOG091G07IK
    threads: 2


        cd per_gene/EOG091G07IK
	count=$(cat ../../per_gene/EOG091G07IK/ALICUT_EOG091G07IK.clustalo.fasta | grep ">" | wc -l)
	if [ "$count" -gt 5 ]
        then
		RAxMLmodel=$(cat ../../per_gene/EOG091G07IK/EOG091G07IK.best_model | grep "Best" | cut -d ":" -f 2 | tr -d '[:space:]')
                if [ "$(ls -1 | grep "^RAxML" | wc -l)" -ne 0 ]
		then
			rm RAxML*
		fi
        	raxml -f a -T 2 -m PROTGAMMA$RAxMLmodel         	-p 12345 -x 12345 -# 100         	-s ../../per_gene/EOG091G07IK/ALICUT_EOG091G07IK.clustalo.fasta -n EOG091G07IK.clustalo.aln.ALICUT.$RAxMLmodel 		1> ../../per_gene/EOG091G07IK/infer_single_ML.stdout.txt 2> ../../per_gene/EOG091G07IK/infer_single_ML.stderr.txt
	else
		echo "fasta file per_gene/EOG091G07IK/ALICUT_EOG091G07IK.clustalo.fasta contains fewer than 5 sequences - skipped" > ../../per_gene/EOG091G07IK/infer_single_ML.stdout.txt
		touch raxml.skipped
	fi
        touch ../../per_gene/EOG091G07IK/EOG091G07IK.raxml.done
        
[33mJob counts:
	count	jobs
	1	infer_single_ML
	1[0m
[33m
        cd per_gene/EOG091G07IK
	count=$(cat ../../per_gene/EOG091G07IK/ALICUT_EOG091G07IK.clustalo.fasta | grep ">" | wc -l)
	if [ "$count" -gt 5 ]
        then
		RAxMLmodel=$(cat ../../per_gene/EOG091G07IK/EOG091G07IK.best_model | grep "Best" | cut -d ":" -f 2 | tr -d '[:space:]')
                if [ "$(ls -1 | grep "^RAxML" | wc -l)" -ne 0 ]
		then
			rm RAxML*
		fi
        	raxml -f a -T 2 -m PROTGAMMA$RAxMLmodel         	-p 12345 -x 12345 -# 100         	-s ../../per_gene/EOG091G07IK/ALICUT_EOG091G07IK.clustalo.fasta -n EOG091G07IK.clustalo.aln.ALICUT.$RAxMLmodel 		1> ../../per_gene/EOG091G07IK/infer_single_ML.stdout.txt 2> ../../per_gene/EOG091G07IK/infer_single_ML.stderr.txt
	else
		echo "fasta file per_gene/EOG091G07IK/ALICUT_EOG091G07IK.clustalo.fasta contains fewer than 5 sequences - skipped" > ../../per_gene/EOG091G07IK/infer_single_ML.stdout.txt
		touch raxml.skipped
	fi
        touch ../../per_gene/EOG091G07IK/EOG091G07IK.raxml.done
        [0m
[Sun Jul  5 21:29:26 2020]
Finished job 1114.
140 of 3292 steps (4%) done

[Sun Jul  5 21:29:26 2020]
rule infer_single_ML:
    input: per_gene/EOG091G0A5N/EOG091G0A5N.best_model, per_gene/EOG091G0A5N/ALICUT_EOG091G0A5N.clustalo.fasta
    output: per_gene/EOG091G0A5N/EOG091G0A5N.raxml.done
    log: per_gene/EOG091G0A5N/infer_single_ML.stdout.txt, per_gene/EOG091G0A5N/infer_single_ML.stderr.txt
    jobid: 351
    wildcards: BUSCO=EOG091G0A5N
    threads: 2


        cd per_gene/EOG091G0A5N
	count=$(cat ../../per_gene/EOG091G0A5N/ALICUT_EOG091G0A5N.clustalo.fasta | grep ">" | wc -l)
	if [ "$count" -gt 5 ]
        then
		RAxMLmodel=$(cat ../../per_gene/EOG091G0A5N/EOG091G0A5N.best_model | grep "Best" | cut -d ":" -f 2 | tr -d '[:space:]')
                if [ "$(ls -1 | grep "^RAxML" | wc -l)" -ne 0 ]
		then
			rm RAxML*
		fi
        	raxml -f a -T 2 -m PROTGAMMA$RAxMLmodel         	-p 12345 -x 12345 -# 100         	-s ../../per_gene/EOG091G0A5N/ALICUT_EOG091G0A5N.clustalo.fasta -n EOG091G0A5N.clustalo.aln.ALICUT.$RAxMLmodel 		1> ../../per_gene/EOG091G0A5N/infer_single_ML.stdout.txt 2> ../../per_gene/EOG091G0A5N/infer_single_ML.stderr.txt
	else
		echo "fasta file per_gene/EOG091G0A5N/ALICUT_EOG091G0A5N.clustalo.fasta contains fewer than 5 sequences - skipped" > ../../per_gene/EOG091G0A5N/infer_single_ML.stdout.txt
		touch raxml.skipped
	fi
        touch ../../per_gene/EOG091G0A5N/EOG091G0A5N.raxml.done
        
[33mJob counts:
	count	jobs
	1	infer_single_ML
	1[0m
[33m
        cd per_gene/EOG091G0A5N
	count=$(cat ../../per_gene/EOG091G0A5N/ALICUT_EOG091G0A5N.clustalo.fasta | grep ">" | wc -l)
	if [ "$count" -gt 5 ]
        then
		RAxMLmodel=$(cat ../../per_gene/EOG091G0A5N/EOG091G0A5N.best_model | grep "Best" | cut -d ":" -f 2 | tr -d '[:space:]')
                if [ "$(ls -1 | grep "^RAxML" | wc -l)" -ne 0 ]
		then
			rm RAxML*
		fi
        	raxml -f a -T 2 -m PROTGAMMA$RAxMLmodel         	-p 12345 -x 12345 -# 100         	-s ../../per_gene/EOG091G0A5N/ALICUT_EOG091G0A5N.clustalo.fasta -n EOG091G0A5N.clustalo.aln.ALICUT.$RAxMLmodel 		1> ../../per_gene/EOG091G0A5N/infer_single_ML.stdout.txt 2> ../../per_gene/EOG091G0A5N/infer_single_ML.stderr.txt
	else
		echo "fasta file per_gene/EOG091G0A5N/ALICUT_EOG091G0A5N.clustalo.fasta contains fewer than 5 sequences - skipped" > ../../per_gene/EOG091G0A5N/infer_single_ML.stdout.txt
		touch raxml.skipped
	fi
        touch ../../per_gene/EOG091G0A5N/EOG091G0A5N.raxml.done
        [0m
[Sun Jul  5 21:29:30 2020]
Finished job 432.
141 of 3292 steps (4%) done

[Sun Jul  5 21:29:30 2020]
rule infer_single_ML:
    input: per_gene/EOG091G01XI/EOG091G01XI.best_model, per_gene/EOG091G01XI/ALICUT_EOG091G01XI.clustalo.fasta
    output: per_gene/EOG091G01XI/EOG091G01XI.raxml.done
    log: per_gene/EOG091G01XI/infer_single_ML.stdout.txt, per_gene/EOG091G01XI/infer_single_ML.stderr.txt
    jobid: 10
    wildcards: BUSCO=EOG091G01XI
    threads: 2


        cd per_gene/EOG091G01XI
	count=$(cat ../../per_gene/EOG091G01XI/ALICUT_EOG091G01XI.clustalo.fasta | grep ">" | wc -l)
	if [ "$count" -gt 5 ]
        then
		RAxMLmodel=$(cat ../../per_gene/EOG091G01XI/EOG091G01XI.best_model | grep "Best" | cut -d ":" -f 2 | tr -d '[:space:]')
                if [ "$(ls -1 | grep "^RAxML" | wc -l)" -ne 0 ]
		then
			rm RAxML*
		fi
        	raxml -f a -T 2 -m PROTGAMMA$RAxMLmodel         	-p 12345 -x 12345 -# 100         	-s ../../per_gene/EOG091G01XI/ALICUT_EOG091G01XI.clustalo.fasta -n EOG091G01XI.clustalo.aln.ALICUT.$RAxMLmodel 		1> ../../per_gene/EOG091G01XI/infer_single_ML.stdout.txt 2> ../../per_gene/EOG091G01XI/infer_single_ML.stderr.txt
	else
		echo "fasta file per_gene/EOG091G01XI/ALICUT_EOG091G01XI.clustalo.fasta contains fewer than 5 sequences - skipped" > ../../per_gene/EOG091G01XI/infer_single_ML.stdout.txt
		touch raxml.skipped
	fi
        touch ../../per_gene/EOG091G01XI/EOG091G01XI.raxml.done
        
[33mJob counts:
	count	jobs
	1	infer_single_ML
	1[0m
[33m
        cd per_gene/EOG091G01XI
	count=$(cat ../../per_gene/EOG091G01XI/ALICUT_EOG091G01XI.clustalo.fasta | grep ">" | wc -l)
	if [ "$count" -gt 5 ]
        then
		RAxMLmodel=$(cat ../../per_gene/EOG091G01XI/EOG091G01XI.best_model | grep "Best" | cut -d ":" -f 2 | tr -d '[:space:]')
                if [ "$(ls -1 | grep "^RAxML" | wc -l)" -ne 0 ]
		then
			rm RAxML*
		fi
        	raxml -f a -T 2 -m PROTGAMMA$RAxMLmodel         	-p 12345 -x 12345 -# 100         	-s ../../per_gene/EOG091G01XI/ALICUT_EOG091G01XI.clustalo.fasta -n EOG091G01XI.clustalo.aln.ALICUT.$RAxMLmodel 		1> ../../per_gene/EOG091G01XI/infer_single_ML.stdout.txt 2> ../../per_gene/EOG091G01XI/infer_single_ML.stderr.txt
	else
		echo "fasta file per_gene/EOG091G01XI/ALICUT_EOG091G01XI.clustalo.fasta contains fewer than 5 sequences - skipped" > ../../per_gene/EOG091G01XI/infer_single_ML.stdout.txt
		touch raxml.skipped
	fi
        touch ../../per_gene/EOG091G01XI/EOG091G01XI.raxml.done
        [0m
[Sun Jul  5 21:29:31 2020]
Finished job 568.
142 of 3292 steps (4%) done

[Sun Jul  5 21:29:31 2020]
rule infer_single_ML:
    input: per_gene/EOG091G0AKW/EOG091G0AKW.best_model, per_gene/EOG091G0AKW/ALICUT_EOG091G0AKW.clustalo.fasta
    output: per_gene/EOG091G0AKW/EOG091G0AKW.raxml.done
    log: per_gene/EOG091G0AKW/infer_single_ML.stdout.txt, per_gene/EOG091G0AKW/infer_single_ML.stderr.txt
    jobid: 78
    wildcards: BUSCO=EOG091G0AKW
    threads: 2


        cd per_gene/EOG091G0AKW
	count=$(cat ../../per_gene/EOG091G0AKW/ALICUT_EOG091G0AKW.clustalo.fasta | grep ">" | wc -l)
	if [ "$count" -gt 5 ]
        then
		RAxMLmodel=$(cat ../../per_gene/EOG091G0AKW/EOG091G0AKW.best_model | grep "Best" | cut -d ":" -f 2 | tr -d '[:space:]')
                if [ "$(ls -1 | grep "^RAxML" | wc -l)" -ne 0 ]
		then
			rm RAxML*
		fi
        	raxml -f a -T 2 -m PROTGAMMA$RAxMLmodel         	-p 12345 -x 12345 -# 100         	-s ../../per_gene/EOG091G0AKW/ALICUT_EOG091G0AKW.clustalo.fasta -n EOG091G0AKW.clustalo.aln.ALICUT.$RAxMLmodel 		1> ../../per_gene/EOG091G0AKW/infer_single_ML.stdout.txt 2> ../../per_gene/EOG091G0AKW/infer_single_ML.stderr.txt
	else
		echo "fasta file per_gene/EOG091G0AKW/ALICUT_EOG091G0AKW.clustalo.fasta contains fewer than 5 sequences - skipped" > ../../per_gene/EOG091G0AKW/infer_single_ML.stdout.txt
		touch raxml.skipped
	fi
        touch ../../per_gene/EOG091G0AKW/EOG091G0AKW.raxml.done
        
[33mJob counts:
	count	jobs
	1	infer_single_ML
	1[0m
[33m
        cd per_gene/EOG091G0AKW
	count=$(cat ../../per_gene/EOG091G0AKW/ALICUT_EOG091G0AKW.clustalo.fasta | grep ">" | wc -l)
	if [ "$count" -gt 5 ]
        then
		RAxMLmodel=$(cat ../../per_gene/EOG091G0AKW/EOG091G0AKW.best_model | grep "Best" | cut -d ":" -f 2 | tr -d '[:space:]')
                if [ "$(ls -1 | grep "^RAxML" | wc -l)" -ne 0 ]
		then
			rm RAxML*
		fi
        	raxml -f a -T 2 -m PROTGAMMA$RAxMLmodel         	-p 12345 -x 12345 -# 100         	-s ../../per_gene/EOG091G0AKW/ALICUT_EOG091G0AKW.clustalo.fasta -n EOG091G0AKW.clustalo.aln.ALICUT.$RAxMLmodel 		1> ../../per_gene/EOG091G0AKW/infer_single_ML.stdout.txt 2> ../../per_gene/EOG091G0AKW/infer_single_ML.stderr.txt
	else
		echo "fasta file per_gene/EOG091G0AKW/ALICUT_EOG091G0AKW.clustalo.fasta contains fewer than 5 sequences - skipped" > ../../per_gene/EOG091G0AKW/infer_single_ML.stdout.txt
		touch raxml.skipped
	fi
        touch ../../per_gene/EOG091G0AKW/EOG091G0AKW.raxml.done
        [0m
[Sun Jul  5 21:29:33 2020]
Finished job 732.
143 of 3292 steps (4%) done

[Sun Jul  5 21:29:33 2020]
rule infer_single_ML:
    input: per_gene/EOG091G0NMJ/EOG091G0NMJ.best_model, per_gene/EOG091G0NMJ/ALICUT_EOG091G0NMJ.clustalo.fasta
    output: per_gene/EOG091G0NMJ/EOG091G0NMJ.raxml.done
    log: per_gene/EOG091G0NMJ/infer_single_ML.stdout.txt, per_gene/EOG091G0NMJ/infer_single_ML.stderr.txt
    jobid: 160
    wildcards: BUSCO=EOG091G0NMJ
    threads: 2


        cd per_gene/EOG091G0NMJ
	count=$(cat ../../per_gene/EOG091G0NMJ/ALICUT_EOG091G0NMJ.clustalo.fasta | grep ">" | wc -l)
	if [ "$count" -gt 5 ]
        then
		RAxMLmodel=$(cat ../../per_gene/EOG091G0NMJ/EOG091G0NMJ.best_model | grep "Best" | cut -d ":" -f 2 | tr -d '[:space:]')
                if [ "$(ls -1 | grep "^RAxML" | wc -l)" -ne 0 ]
		then
			rm RAxML*
		fi
        	raxml -f a -T 2 -m PROTGAMMA$RAxMLmodel         	-p 12345 -x 12345 -# 100         	-s ../../per_gene/EOG091G0NMJ/ALICUT_EOG091G0NMJ.clustalo.fasta -n EOG091G0NMJ.clustalo.aln.ALICUT.$RAxMLmodel 		1> ../../per_gene/EOG091G0NMJ/infer_single_ML.stdout.txt 2> ../../per_gene/EOG091G0NMJ/infer_single_ML.stderr.txt
	else
		echo "fasta file per_gene/EOG091G0NMJ/ALICUT_EOG091G0NMJ.clustalo.fasta contains fewer than 5 sequences - skipped" > ../../per_gene/EOG091G0NMJ/infer_single_ML.stdout.txt
		touch raxml.skipped
	fi
        touch ../../per_gene/EOG091G0NMJ/EOG091G0NMJ.raxml.done
        
[33mJob counts:
	count	jobs
	1	infer_single_ML
	1[0m
[33m
        cd per_gene/EOG091G0NMJ
	count=$(cat ../../per_gene/EOG091G0NMJ/ALICUT_EOG091G0NMJ.clustalo.fasta | grep ">" | wc -l)
	if [ "$count" -gt 5 ]
        then
		RAxMLmodel=$(cat ../../per_gene/EOG091G0NMJ/EOG091G0NMJ.best_model | grep "Best" | cut -d ":" -f 2 | tr -d '[:space:]')
                if [ "$(ls -1 | grep "^RAxML" | wc -l)" -ne 0 ]
		then
			rm RAxML*
		fi
        	raxml -f a -T 2 -m PROTGAMMA$RAxMLmodel         	-p 12345 -x 12345 -# 100         	-s ../../per_gene/EOG091G0NMJ/ALICUT_EOG091G0NMJ.clustalo.fasta -n EOG091G0NMJ.clustalo.aln.ALICUT.$RAxMLmodel 		1> ../../per_gene/EOG091G0NMJ/infer_single_ML.stdout.txt 2> ../../per_gene/EOG091G0NMJ/infer_single_ML.stderr.txt
	else
		echo "fasta file per_gene/EOG091G0NMJ/ALICUT_EOG091G0NMJ.clustalo.fasta contains fewer than 5 sequences - skipped" > ../../per_gene/EOG091G0NMJ/infer_single_ML.stdout.txt
		touch raxml.skipped
	fi
        touch ../../per_gene/EOG091G0NMJ/EOG091G0NMJ.raxml.done
        [0m
[Sun Jul  5 21:29:37 2020]
Finished job 908.
144 of 3292 steps (4%) done

[Sun Jul  5 21:29:38 2020]
rule infer_single_ML:
    input: per_gene/EOG091G09QO/EOG091G09QO.best_model, per_gene/EOG091G09QO/ALICUT_EOG091G09QO.clustalo.fasta
    output: per_gene/EOG091G09QO/EOG091G09QO.raxml.done
    log: per_gene/EOG091G09QO/infer_single_ML.stdout.txt, per_gene/EOG091G09QO/infer_single_ML.stderr.txt
    jobid: 248
    wildcards: BUSCO=EOG091G09QO
    threads: 2


        cd per_gene/EOG091G09QO
	count=$(cat ../../per_gene/EOG091G09QO/ALICUT_EOG091G09QO.clustalo.fasta | grep ">" | wc -l)
	if [ "$count" -gt 5 ]
        then
		RAxMLmodel=$(cat ../../per_gene/EOG091G09QO/EOG091G09QO.best_model | grep "Best" | cut -d ":" -f 2 | tr -d '[:space:]')
                if [ "$(ls -1 | grep "^RAxML" | wc -l)" -ne 0 ]
		then
			rm RAxML*
		fi
        	raxml -f a -T 2 -m PROTGAMMA$RAxMLmodel         	-p 12345 -x 12345 -# 100         	-s ../../per_gene/EOG091G09QO/ALICUT_EOG091G09QO.clustalo.fasta -n EOG091G09QO.clustalo.aln.ALICUT.$RAxMLmodel 		1> ../../per_gene/EOG091G09QO/infer_single_ML.stdout.txt 2> ../../per_gene/EOG091G09QO/infer_single_ML.stderr.txt
	else
		echo "fasta file per_gene/EOG091G09QO/ALICUT_EOG091G09QO.clustalo.fasta contains fewer than 5 sequences - skipped" > ../../per_gene/EOG091G09QO/infer_single_ML.stdout.txt
		touch raxml.skipped
	fi
        touch ../../per_gene/EOG091G09QO/EOG091G09QO.raxml.done
        
[33mJob counts:
	count	jobs
	1	infer_single_ML
	1[0m
[33m
        cd per_gene/EOG091G09QO
	count=$(cat ../../per_gene/EOG091G09QO/ALICUT_EOG091G09QO.clustalo.fasta | grep ">" | wc -l)
	if [ "$count" -gt 5 ]
        then
		RAxMLmodel=$(cat ../../per_gene/EOG091G09QO/EOG091G09QO.best_model | grep "Best" | cut -d ":" -f 2 | tr -d '[:space:]')
                if [ "$(ls -1 | grep "^RAxML" | wc -l)" -ne 0 ]
		then
			rm RAxML*
		fi
        	raxml -f a -T 2 -m PROTGAMMA$RAxMLmodel         	-p 12345 -x 12345 -# 100         	-s ../../per_gene/EOG091G09QO/ALICUT_EOG091G09QO.clustalo.fasta -n EOG091G09QO.clustalo.aln.ALICUT.$RAxMLmodel 		1> ../../per_gene/EOG091G09QO/infer_single_ML.stdout.txt 2> ../../per_gene/EOG091G09QO/infer_single_ML.stderr.txt
	else
		echo "fasta file per_gene/EOG091G09QO/ALICUT_EOG091G09QO.clustalo.fasta contains fewer than 5 sequences - skipped" > ../../per_gene/EOG091G09QO/infer_single_ML.stdout.txt
		touch raxml.skipped
	fi
        touch ../../per_gene/EOG091G09QO/EOG091G09QO.raxml.done
        [0m
[Sun Jul  5 21:29:38 2020]
Finished job 932.
145 of 3292 steps (4%) done

[Sun Jul  5 21:29:38 2020]
rule infer_single_ML:
    input: per_gene/EOG091G0IVB/EOG091G0IVB.best_model, per_gene/EOG091G0IVB/ALICUT_EOG091G0IVB.clustalo.fasta
    output: per_gene/EOG091G0IVB/EOG091G0IVB.raxml.done
    log: per_gene/EOG091G0IVB/infer_single_ML.stdout.txt, per_gene/EOG091G0IVB/infer_single_ML.stderr.txt
    jobid: 260
    wildcards: BUSCO=EOG091G0IVB
    threads: 2


        cd per_gene/EOG091G0IVB
	count=$(cat ../../per_gene/EOG091G0IVB/ALICUT_EOG091G0IVB.clustalo.fasta | grep ">" | wc -l)
	if [ "$count" -gt 5 ]
        then
		RAxMLmodel=$(cat ../../per_gene/EOG091G0IVB/EOG091G0IVB.best_model | grep "Best" | cut -d ":" -f 2 | tr -d '[:space:]')
                if [ "$(ls -1 | grep "^RAxML" | wc -l)" -ne 0 ]
		then
			rm RAxML*
		fi
        	raxml -f a -T 2 -m PROTGAMMA$RAxMLmodel         	-p 12345 -x 12345 -# 100         	-s ../../per_gene/EOG091G0IVB/ALICUT_EOG091G0IVB.clustalo.fasta -n EOG091G0IVB.clustalo.aln.ALICUT.$RAxMLmodel 		1> ../../per_gene/EOG091G0IVB/infer_single_ML.stdout.txt 2> ../../per_gene/EOG091G0IVB/infer_single_ML.stderr.txt
	else
		echo "fasta file per_gene/EOG091G0IVB/ALICUT_EOG091G0IVB.clustalo.fasta contains fewer than 5 sequences - skipped" > ../../per_gene/EOG091G0IVB/infer_single_ML.stdout.txt
		touch raxml.skipped
	fi
        touch ../../per_gene/EOG091G0IVB/EOG091G0IVB.raxml.done
        
[33mJob counts:
	count	jobs
	1	infer_single_ML
	1[0m
[33m
        cd per_gene/EOG091G0IVB
	count=$(cat ../../per_gene/EOG091G0IVB/ALICUT_EOG091G0IVB.clustalo.fasta | grep ">" | wc -l)
	if [ "$count" -gt 5 ]
        then
		RAxMLmodel=$(cat ../../per_gene/EOG091G0IVB/EOG091G0IVB.best_model | grep "Best" | cut -d ":" -f 2 | tr -d '[:space:]')
                if [ "$(ls -1 | grep "^RAxML" | wc -l)" -ne 0 ]
		then
			rm RAxML*
		fi
        	raxml -f a -T 2 -m PROTGAMMA$RAxMLmodel         	-p 12345 -x 12345 -# 100         	-s ../../per_gene/EOG091G0IVB/ALICUT_EOG091G0IVB.clustalo.fasta -n EOG091G0IVB.clustalo.aln.ALICUT.$RAxMLmodel 		1> ../../per_gene/EOG091G0IVB/infer_single_ML.stdout.txt 2> ../../per_gene/EOG091G0IVB/infer_single_ML.stderr.txt
	else
		echo "fasta file per_gene/EOG091G0IVB/ALICUT_EOG091G0IVB.clustalo.fasta contains fewer than 5 sequences - skipped" > ../../per_gene/EOG091G0IVB/infer_single_ML.stdout.txt
		touch raxml.skipped
	fi
        touch ../../per_gene/EOG091G0IVB/EOG091G0IVB.raxml.done
        [0m
[Sun Jul  5 21:29:40 2020]
Finished job 792.
146 of 3292 steps (4%) done

[Sun Jul  5 21:29:40 2020]
rule infer_single_ML:
    input: per_gene/EOG091G0SU6/EOG091G0SU6.best_model, per_gene/EOG091G0SU6/ALICUT_EOG091G0SU6.clustalo.fasta
    output: per_gene/EOG091G0SU6/EOG091G0SU6.raxml.done
    log: per_gene/EOG091G0SU6/infer_single_ML.stdout.txt, per_gene/EOG091G0SU6/infer_single_ML.stderr.txt
    jobid: 190
    wildcards: BUSCO=EOG091G0SU6
    threads: 2


        cd per_gene/EOG091G0SU6
	count=$(cat ../../per_gene/EOG091G0SU6/ALICUT_EOG091G0SU6.clustalo.fasta | grep ">" | wc -l)
	if [ "$count" -gt 5 ]
        then
		RAxMLmodel=$(cat ../../per_gene/EOG091G0SU6/EOG091G0SU6.best_model | grep "Best" | cut -d ":" -f 2 | tr -d '[:space:]')
                if [ "$(ls -1 | grep "^RAxML" | wc -l)" -ne 0 ]
		then
			rm RAxML*
		fi
        	raxml -f a -T 2 -m PROTGAMMA$RAxMLmodel         	-p 12345 -x 12345 -# 100         	-s ../../per_gene/EOG091G0SU6/ALICUT_EOG091G0SU6.clustalo.fasta -n EOG091G0SU6.clustalo.aln.ALICUT.$RAxMLmodel 		1> ../../per_gene/EOG091G0SU6/infer_single_ML.stdout.txt 2> ../../per_gene/EOG091G0SU6/infer_single_ML.stderr.txt
	else
		echo "fasta file per_gene/EOG091G0SU6/ALICUT_EOG091G0SU6.clustalo.fasta contains fewer than 5 sequences - skipped" > ../../per_gene/EOG091G0SU6/infer_single_ML.stdout.txt
		touch raxml.skipped
	fi
        touch ../../per_gene/EOG091G0SU6/EOG091G0SU6.raxml.done
        
[33mJob counts:
	count	jobs
	1	infer_single_ML
	1[0m
[33m
        cd per_gene/EOG091G0SU6
	count=$(cat ../../per_gene/EOG091G0SU6/ALICUT_EOG091G0SU6.clustalo.fasta | grep ">" | wc -l)
	if [ "$count" -gt 5 ]
        then
		RAxMLmodel=$(cat ../../per_gene/EOG091G0SU6/EOG091G0SU6.best_model | grep "Best" | cut -d ":" -f 2 | tr -d '[:space:]')
                if [ "$(ls -1 | grep "^RAxML" | wc -l)" -ne 0 ]
		then
			rm RAxML*
		fi
        	raxml -f a -T 2 -m PROTGAMMA$RAxMLmodel         	-p 12345 -x 12345 -# 100         	-s ../../per_gene/EOG091G0SU6/ALICUT_EOG091G0SU6.clustalo.fasta -n EOG091G0SU6.clustalo.aln.ALICUT.$RAxMLmodel 		1> ../../per_gene/EOG091G0SU6/infer_single_ML.stdout.txt 2> ../../per_gene/EOG091G0SU6/infer_single_ML.stderr.txt
	else
		echo "fasta file per_gene/EOG091G0SU6/ALICUT_EOG091G0SU6.clustalo.fasta contains fewer than 5 sequences - skipped" > ../../per_gene/EOG091G0SU6/infer_single_ML.stdout.txt
		touch raxml.skipped
	fi
        touch ../../per_gene/EOG091G0SU6/EOG091G0SU6.raxml.done
        [0m
[Sun Jul  5 21:29:40 2020]
Finished job 948.
147 of 3292 steps (4%) done

[Sun Jul  5 21:29:40 2020]
rule infer_single_ML:
    input: per_gene/EOG091G0N9D/EOG091G0N9D.best_model, per_gene/EOG091G0N9D/ALICUT_EOG091G0N9D.clustalo.fasta
    output: per_gene/EOG091G0N9D/EOG091G0N9D.raxml.done
    log: per_gene/EOG091G0N9D/infer_single_ML.stdout.txt, per_gene/EOG091G0N9D/infer_single_ML.stderr.txt
    jobid: 268
    wildcards: BUSCO=EOG091G0N9D
    threads: 2


        cd per_gene/EOG091G0N9D
	count=$(cat ../../per_gene/EOG091G0N9D/ALICUT_EOG091G0N9D.clustalo.fasta | grep ">" | wc -l)
	if [ "$count" -gt 5 ]
        then
		RAxMLmodel=$(cat ../../per_gene/EOG091G0N9D/EOG091G0N9D.best_model | grep "Best" | cut -d ":" -f 2 | tr -d '[:space:]')
                if [ "$(ls -1 | grep "^RAxML" | wc -l)" -ne 0 ]
		then
			rm RAxML*
		fi
        	raxml -f a -T 2 -m PROTGAMMA$RAxMLmodel         	-p 12345 -x 12345 -# 100         	-s ../../per_gene/EOG091G0N9D/ALICUT_EOG091G0N9D.clustalo.fasta -n EOG091G0N9D.clustalo.aln.ALICUT.$RAxMLmodel 		1> ../../per_gene/EOG091G0N9D/infer_single_ML.stdout.txt 2> ../../per_gene/EOG091G0N9D/infer_single_ML.stderr.txt
	else
		echo "fasta file per_gene/EOG091G0N9D/ALICUT_EOG091G0N9D.clustalo.fasta contains fewer than 5 sequences - skipped" > ../../per_gene/EOG091G0N9D/infer_single_ML.stdout.txt
		touch raxml.skipped
	fi
        touch ../../per_gene/EOG091G0N9D/EOG091G0N9D.raxml.done
        
[33mJob counts:
	count	jobs
	1	infer_single_ML
	1[0m
[33m
        cd per_gene/EOG091G0N9D
	count=$(cat ../../per_gene/EOG091G0N9D/ALICUT_EOG091G0N9D.clustalo.fasta | grep ">" | wc -l)
	if [ "$count" -gt 5 ]
        then
		RAxMLmodel=$(cat ../../per_gene/EOG091G0N9D/EOG091G0N9D.best_model | grep "Best" | cut -d ":" -f 2 | tr -d '[:space:]')
                if [ "$(ls -1 | grep "^RAxML" | wc -l)" -ne 0 ]
		then
			rm RAxML*
		fi
        	raxml -f a -T 2 -m PROTGAMMA$RAxMLmodel         	-p 12345 -x 12345 -# 100         	-s ../../per_gene/EOG091G0N9D/ALICUT_EOG091G0N9D.clustalo.fasta -n EOG091G0N9D.clustalo.aln.ALICUT.$RAxMLmodel 		1> ../../per_gene/EOG091G0N9D/infer_single_ML.stdout.txt 2> ../../per_gene/EOG091G0N9D/infer_single_ML.stderr.txt
	else
		echo "fasta file per_gene/EOG091G0N9D/ALICUT_EOG091G0N9D.clustalo.fasta contains fewer than 5 sequences - skipped" > ../../per_gene/EOG091G0N9D/infer_single_ML.stdout.txt
		touch raxml.skipped
	fi
        touch ../../per_gene/EOG091G0N9D/EOG091G0N9D.raxml.done
        [0m
[Sun Jul  5 21:29:44 2020]
Finished job 1220.
148 of 3292 steps (4%) done

[Sun Jul  5 21:29:44 2020]
rule infer_single_ML:
    input: per_gene/EOG091G0L5D/EOG091G0L5D.best_model, per_gene/EOG091G0L5D/ALICUT_EOG091G0L5D.clustalo.fasta
    output: per_gene/EOG091G0L5D/EOG091G0L5D.raxml.done
    log: per_gene/EOG091G0L5D/infer_single_ML.stdout.txt, per_gene/EOG091G0L5D/infer_single_ML.stderr.txt
    jobid: 404
    wildcards: BUSCO=EOG091G0L5D
    threads: 2


        cd per_gene/EOG091G0L5D
	count=$(cat ../../per_gene/EOG091G0L5D/ALICUT_EOG091G0L5D.clustalo.fasta | grep ">" | wc -l)
	if [ "$count" -gt 5 ]
        then
		RAxMLmodel=$(cat ../../per_gene/EOG091G0L5D/EOG091G0L5D.best_model | grep "Best" | cut -d ":" -f 2 | tr -d '[:space:]')
                if [ "$(ls -1 | grep "^RAxML" | wc -l)" -ne 0 ]
		then
			rm RAxML*
		fi
        	raxml -f a -T 2 -m PROTGAMMA$RAxMLmodel         	-p 12345 -x 12345 -# 100         	-s ../../per_gene/EOG091G0L5D/ALICUT_EOG091G0L5D.clustalo.fasta -n EOG091G0L5D.clustalo.aln.ALICUT.$RAxMLmodel 		1> ../../per_gene/EOG091G0L5D/infer_single_ML.stdout.txt 2> ../../per_gene/EOG091G0L5D/infer_single_ML.stderr.txt
	else
		echo "fasta file per_gene/EOG091G0L5D/ALICUT_EOG091G0L5D.clustalo.fasta contains fewer than 5 sequences - skipped" > ../../per_gene/EOG091G0L5D/infer_single_ML.stdout.txt
		touch raxml.skipped
	fi
        touch ../../per_gene/EOG091G0L5D/EOG091G0L5D.raxml.done
        
[33mJob counts:
	count	jobs
	1	infer_single_ML
	1[0m
[33m
        cd per_gene/EOG091G0L5D
	count=$(cat ../../per_gene/EOG091G0L5D/ALICUT_EOG091G0L5D.clustalo.fasta | grep ">" | wc -l)
	if [ "$count" -gt 5 ]
        then
		RAxMLmodel=$(cat ../../per_gene/EOG091G0L5D/EOG091G0L5D.best_model | grep "Best" | cut -d ":" -f 2 | tr -d '[:space:]')
                if [ "$(ls -1 | grep "^RAxML" | wc -l)" -ne 0 ]
		then
			rm RAxML*
		fi
        	raxml -f a -T 2 -m PROTGAMMA$RAxMLmodel         	-p 12345 -x 12345 -# 100         	-s ../../per_gene/EOG091G0L5D/ALICUT_EOG091G0L5D.clustalo.fasta -n EOG091G0L5D.clustalo.aln.ALICUT.$RAxMLmodel 		1> ../../per_gene/EOG091G0L5D/infer_single_ML.stdout.txt 2> ../../per_gene/EOG091G0L5D/infer_single_ML.stderr.txt
	else
		echo "fasta file per_gene/EOG091G0L5D/ALICUT_EOG091G0L5D.clustalo.fasta contains fewer than 5 sequences - skipped" > ../../per_gene/EOG091G0L5D/infer_single_ML.stdout.txt
		touch raxml.skipped
	fi
        touch ../../per_gene/EOG091G0L5D/EOG091G0L5D.raxml.done
        [0m
[Sun Jul  5 21:29:49 2020]
Finished job 922.
149 of 3292 steps (5%) done

[Sun Jul  5 21:29:49 2020]
rule infer_single_ML:
    input: per_gene/EOG091G0FJB/EOG091G0FJB.best_model, per_gene/EOG091G0FJB/ALICUT_EOG091G0FJB.clustalo.fasta
    output: per_gene/EOG091G0FJB/EOG091G0FJB.raxml.done
    log: per_gene/EOG091G0FJB/infer_single_ML.stdout.txt, per_gene/EOG091G0FJB/infer_single_ML.stderr.txt
    jobid: 255
    wildcards: BUSCO=EOG091G0FJB
    threads: 2


        cd per_gene/EOG091G0FJB
	count=$(cat ../../per_gene/EOG091G0FJB/ALICUT_EOG091G0FJB.clustalo.fasta | grep ">" | wc -l)
	if [ "$count" -gt 5 ]
        then
		RAxMLmodel=$(cat ../../per_gene/EOG091G0FJB/EOG091G0FJB.best_model | grep "Best" | cut -d ":" -f 2 | tr -d '[:space:]')
                if [ "$(ls -1 | grep "^RAxML" | wc -l)" -ne 0 ]
		then
			rm RAxML*
		fi
        	raxml -f a -T 2 -m PROTGAMMA$RAxMLmodel         	-p 12345 -x 12345 -# 100         	-s ../../per_gene/EOG091G0FJB/ALICUT_EOG091G0FJB.clustalo.fasta -n EOG091G0FJB.clustalo.aln.ALICUT.$RAxMLmodel 		1> ../../per_gene/EOG091G0FJB/infer_single_ML.stdout.txt 2> ../../per_gene/EOG091G0FJB/infer_single_ML.stderr.txt
	else
		echo "fasta file per_gene/EOG091G0FJB/ALICUT_EOG091G0FJB.clustalo.fasta contains fewer than 5 sequences - skipped" > ../../per_gene/EOG091G0FJB/infer_single_ML.stdout.txt
		touch raxml.skipped
	fi
        touch ../../per_gene/EOG091G0FJB/EOG091G0FJB.raxml.done
        
[33mJob counts:
	count	jobs
	1	infer_single_ML
	1[0m
[33m
        cd per_gene/EOG091G0FJB
	count=$(cat ../../per_gene/EOG091G0FJB/ALICUT_EOG091G0FJB.clustalo.fasta | grep ">" | wc -l)
	if [ "$count" -gt 5 ]
        then
		RAxMLmodel=$(cat ../../per_gene/EOG091G0FJB/EOG091G0FJB.best_model | grep "Best" | cut -d ":" -f 2 | tr -d '[:space:]')
                if [ "$(ls -1 | grep "^RAxML" | wc -l)" -ne 0 ]
		then
			rm RAxML*
		fi
        	raxml -f a -T 2 -m PROTGAMMA$RAxMLmodel         	-p 12345 -x 12345 -# 100         	-s ../../per_gene/EOG091G0FJB/ALICUT_EOG091G0FJB.clustalo.fasta -n EOG091G0FJB.clustalo.aln.ALICUT.$RAxMLmodel 		1> ../../per_gene/EOG091G0FJB/infer_single_ML.stdout.txt 2> ../../per_gene/EOG091G0FJB/infer_single_ML.stderr.txt
	else
		echo "fasta file per_gene/EOG091G0FJB/ALICUT_EOG091G0FJB.clustalo.fasta contains fewer than 5 sequences - skipped" > ../../per_gene/EOG091G0FJB/infer_single_ML.stdout.txt
		touch raxml.skipped
	fi
        touch ../../per_gene/EOG091G0FJB/EOG091G0FJB.raxml.done
        [0m
[Sun Jul  5 21:29:51 2020]
Finished job 516.
150 of 3292 steps (5%) done

[Sun Jul  5 21:29:51 2020]
rule infer_single_ML:
    input: per_gene/EOG091G074U/EOG091G074U.best_model, per_gene/EOG091G074U/ALICUT_EOG091G074U.clustalo.fasta
    output: per_gene/EOG091G074U/EOG091G074U.raxml.done
    log: per_gene/EOG091G074U/infer_single_ML.stdout.txt, per_gene/EOG091G074U/infer_single_ML.stderr.txt
    jobid: 52
    wildcards: BUSCO=EOG091G074U
    threads: 2


        cd per_gene/EOG091G074U
	count=$(cat ../../per_gene/EOG091G074U/ALICUT_EOG091G074U.clustalo.fasta | grep ">" | wc -l)
	if [ "$count" -gt 5 ]
        then
		RAxMLmodel=$(cat ../../per_gene/EOG091G074U/EOG091G074U.best_model | grep "Best" | cut -d ":" -f 2 | tr -d '[:space:]')
                if [ "$(ls -1 | grep "^RAxML" | wc -l)" -ne 0 ]
		then
			rm RAxML*
		fi
        	raxml -f a -T 2 -m PROTGAMMA$RAxMLmodel         	-p 12345 -x 12345 -# 100         	-s ../../per_gene/EOG091G074U/ALICUT_EOG091G074U.clustalo.fasta -n EOG091G074U.clustalo.aln.ALICUT.$RAxMLmodel 		1> ../../per_gene/EOG091G074U/infer_single_ML.stdout.txt 2> ../../per_gene/EOG091G074U/infer_single_ML.stderr.txt
	else
		echo "fasta file per_gene/EOG091G074U/ALICUT_EOG091G074U.clustalo.fasta contains fewer than 5 sequences - skipped" > ../../per_gene/EOG091G074U/infer_single_ML.stdout.txt
		touch raxml.skipped
	fi
        touch ../../per_gene/EOG091G074U/EOG091G074U.raxml.done
        
[33mJob counts:
	count	jobs
	1	infer_single_ML
	1[0m
[33m
        cd per_gene/EOG091G074U
	count=$(cat ../../per_gene/EOG091G074U/ALICUT_EOG091G074U.clustalo.fasta | grep ">" | wc -l)
	if [ "$count" -gt 5 ]
        then
		RAxMLmodel=$(cat ../../per_gene/EOG091G074U/EOG091G074U.best_model | grep "Best" | cut -d ":" -f 2 | tr -d '[:space:]')
                if [ "$(ls -1 | grep "^RAxML" | wc -l)" -ne 0 ]
		then
			rm RAxML*
		fi
        	raxml -f a -T 2 -m PROTGAMMA$RAxMLmodel         	-p 12345 -x 12345 -# 100         	-s ../../per_gene/EOG091G074U/ALICUT_EOG091G074U.clustalo.fasta -n EOG091G074U.clustalo.aln.ALICUT.$RAxMLmodel 		1> ../../per_gene/EOG091G074U/infer_single_ML.stdout.txt 2> ../../per_gene/EOG091G074U/infer_single_ML.stderr.txt
	else
		echo "fasta file per_gene/EOG091G074U/ALICUT_EOG091G074U.clustalo.fasta contains fewer than 5 sequences - skipped" > ../../per_gene/EOG091G074U/infer_single_ML.stdout.txt
		touch raxml.skipped
	fi
        touch ../../per_gene/EOG091G074U/EOG091G074U.raxml.done
        [0m
[Sun Jul  5 21:33:29 2020]
Finished job 268.
151 of 3292 steps (5%) done

[Sun Jul  5 21:33:29 2020]
rule MSA:
    input: per_gene/EOG091G0XN1/EOG091G0XN1.fasta
    output: per_gene/EOG091G0XN1/EOG091G0XN1.clustalo.fasta
    log: per_gene/EOG091G0XN1/MSA.stdout.txt, per_gene/EOG091G0XN1/MSA.stderr.txt
    jobid: 1658
    wildcards: BUSCO=EOG091G0XN1
    threads: 2


        clustalo -i per_gene/EOG091G0XN1/EOG091G0XN1.fasta -o per_gene/EOG091G0XN1/EOG091G0XN1.clustalo.fasta --threads=2 1> per_gene/EOG091G0XN1/MSA.stdout.txt 2> per_gene/EOG091G0XN1/MSA.stderr.txt
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/d68c9691725a7401923680874285c430.simg
[Sun Jul  5 21:33:30 2020]
Finished job 1658.
152 of 3292 steps (5%) done

[Sun Jul  5 21:33:30 2020]
rule score_and_cut:
    input: per_gene/EOG091G0XN1/EOG091G0XN1.clustalo.fasta
    output: per_gene/EOG091G0XN1/ALICUT_EOG091G0XN1.clustalo.fasta
    jobid: 835
    wildcards: BUSCO=EOG091G0XN1
    threads: 2


        cd per_gene/EOG091G0XN1
        Aliscore.pl -N -r 200000000000000000 -i ../../per_gene/EOG091G0XN1/EOG091G0XN1.clustalo.fasta &> aliscore.log
        ALICUT.pl -s &> alicut.log
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/63c88c27a0fa300f57066b0ef65fefcb.simg
[Sun Jul  5 21:33:40 2020]
Finished job 835.
153 of 3292 steps (5%) done

[Sun Jul  5 21:33:40 2020]
rule find_best_model:
    input: per_gene/EOG091G0PAG/ALICUT_EOG091G0PAG.clustalo.fasta, per_gene/EOG091G0PAG/empty_check.done
    output: per_gene/EOG091G0PAG/EOG091G0PAG.best_model
    log: per_gene/EOG091G0PAG/find_best_model.stderr.txt
    jobid: 744
    wildcards: BUSCO=EOG091G0PAG
    threads: 2


        cd per_gene/EOG091G0PAG
        if [ ! -d find_best_model ]
        then
            mkdir find_best_model
        fi
        cd find_best_model
        ln -s ../../../per_gene/EOG091G0PAG/ALICUT_EOG091G0PAG.clustalo.fasta EOG091G0PAG.fasta
        ProteinModelSelection.pl EOG091G0PAG.fasta 1> ../../../per_gene/EOG091G0PAG/EOG091G0PAG.best_model 2> ../../../per_gene/EOG091G0PAG/find_best_model.stderr.txt
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/c0c09ee657b1e27f2c5687e0e9aa8d70.simg
[Sun Jul  5 21:33:52 2020]
Finished job 190.
154 of 3292 steps (5%) done

[Sun Jul  5 21:33:52 2020]
rule join_groups:
    input: per_gene/EOG091G0SNM/EOG091G0SNM.ingroup.fasta, per_gene/EOG091G0SNM/EOG091G0SNM.outgroup.fasta
    output: per_gene/EOG091G0SNM/EOG091G0SNM.fasta
    jobid: 2335
    wildcards: BUSCO=EOG091G0SNM


        cat per_gene/EOG091G0SNM/EOG091G0SNM.ingroup.fasta per_gene/EOG091G0SNM/EOG091G0SNM.outgroup.fasta > per_gene/EOG091G0SNM/EOG091G0SNM.fasta
        

[Sun Jul  5 21:33:52 2020]
rule remove_empty:
    input: per_gene/EOG091G0XN1/ALICUT_EOG091G0XN1.clustalo.fasta
    output: per_gene/EOG091G0XN1/empty_check.done
    jobid: 1657
    wildcards: BUSCO=EOG091G0XN1


         if [ "$(cat per_gene/EOG091G0XN1/ALICUT_EOG091G0XN1.clustalo.fasta | grep -v ">" | sed 's/-//g' | grep "^$" | wc -l)" -gt 0 ]
         then
              cp per_gene/EOG091G0XN1/ALICUT_EOG091G0XN1.clustalo.fasta per_gene/EOG091G0XN1/ALICUT_EOG091G0XN1.clustalo.fasta.backup
              bash ../scripts/remove_empty.sh per_gene/EOG091G0XN1/ALICUT_EOG091G0XN1.clustalo.fasta.backup > per_gene/EOG091G0XN1/ALICUT_EOG091G0XN1.clustalo.fasta
         fi
         touch per_gene/EOG091G0XN1/empty_check.done
         
[Sun Jul  5 21:33:52 2020]
Finished job 2335.
155 of 3292 steps (5%) done
[Sun Jul  5 21:33:52 2020]
Finished job 1657.
156 of 3292 steps (5%) done

[Sun Jul  5 21:33:52 2020]
rule MSA:
    input: per_gene/EOG091G0SNM/EOG091G0SNM.fasta
    output: per_gene/EOG091G0SNM/EOG091G0SNM.clustalo.fasta
    log: per_gene/EOG091G0SNM/MSA.stdout.txt, per_gene/EOG091G0SNM/MSA.stderr.txt
    jobid: 1790
    wildcards: BUSCO=EOG091G0SNM
    threads: 2


        clustalo -i per_gene/EOG091G0SNM/EOG091G0SNM.fasta -o per_gene/EOG091G0SNM/EOG091G0SNM.clustalo.fasta --threads=2 1> per_gene/EOG091G0SNM/MSA.stdout.txt 2> per_gene/EOG091G0SNM/MSA.stderr.txt
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/d68c9691725a7401923680874285c430.simg
[Sun Jul  5 21:33:52 2020]
Finished job 1790.
157 of 3292 steps (5%) done

[Sun Jul  5 21:33:52 2020]
rule score_and_cut:
    input: per_gene/EOG091G0SNM/EOG091G0SNM.clustalo.fasta
    output: per_gene/EOG091G0SNM/ALICUT_EOG091G0SNM.clustalo.fasta
    jobid: 967
    wildcards: BUSCO=EOG091G0SNM
    threads: 2


        cd per_gene/EOG091G0SNM
        Aliscore.pl -N -r 200000000000000000 -i ../../per_gene/EOG091G0SNM/EOG091G0SNM.clustalo.fasta &> aliscore.log
        ALICUT.pl -s &> alicut.log
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/63c88c27a0fa300f57066b0ef65fefcb.simg
[Sun Jul  5 21:34:02 2020]
Finished job 967.
158 of 3292 steps (5%) done

[Sun Jul  5 21:34:02 2020]
rule remove_empty:
    input: per_gene/EOG091G0SNM/ALICUT_EOG091G0SNM.clustalo.fasta
    output: per_gene/EOG091G0SNM/empty_check.done
    jobid: 1789
    wildcards: BUSCO=EOG091G0SNM


         if [ "$(cat per_gene/EOG091G0SNM/ALICUT_EOG091G0SNM.clustalo.fasta | grep -v ">" | sed 's/-//g' | grep "^$" | wc -l)" -gt 0 ]
         then
              cp per_gene/EOG091G0SNM/ALICUT_EOG091G0SNM.clustalo.fasta per_gene/EOG091G0SNM/ALICUT_EOG091G0SNM.clustalo.fasta.backup
              bash ../scripts/remove_empty.sh per_gene/EOG091G0SNM/ALICUT_EOG091G0SNM.clustalo.fasta.backup > per_gene/EOG091G0SNM/ALICUT_EOG091G0SNM.clustalo.fasta
         fi
         touch per_gene/EOG091G0SNM/empty_check.done
         
[Sun Jul  5 21:34:02 2020]
Finished job 1789.
159 of 3292 steps (5%) done

[Sun Jul  5 21:34:02 2020]
rule find_best_model:
    input: per_gene/EOG091G0SNM/ALICUT_EOG091G0SNM.clustalo.fasta, per_gene/EOG091G0SNM/empty_check.done
    output: per_gene/EOG091G0SNM/EOG091G0SNM.best_model
    log: per_gene/EOG091G0SNM/find_best_model.stderr.txt
    jobid: 966
    wildcards: BUSCO=EOG091G0SNM
    threads: 2


        cd per_gene/EOG091G0SNM
        if [ ! -d find_best_model ]
        then
            mkdir find_best_model
        fi
        cd find_best_model
        ln -s ../../../per_gene/EOG091G0SNM/ALICUT_EOG091G0SNM.clustalo.fasta EOG091G0SNM.fasta
        ProteinModelSelection.pl EOG091G0SNM.fasta 1> ../../../per_gene/EOG091G0SNM/EOG091G0SNM.best_model 2> ../../../per_gene/EOG091G0SNM/find_best_model.stderr.txt
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/c0c09ee657b1e27f2c5687e0e9aa8d70.simg
[Sun Jul  5 21:34:08 2020]
Finished job 744.
160 of 3292 steps (5%) done

[Sun Jul  5 21:34:08 2020]
rule infer_single_ML:
    input: per_gene/EOG091G0PAG/EOG091G0PAG.best_model, per_gene/EOG091G0PAG/ALICUT_EOG091G0PAG.clustalo.fasta
    output: per_gene/EOG091G0PAG/EOG091G0PAG.raxml.done
    log: per_gene/EOG091G0PAG/infer_single_ML.stdout.txt, per_gene/EOG091G0PAG/infer_single_ML.stderr.txt
    jobid: 166
    wildcards: BUSCO=EOG091G0PAG
    threads: 2


        cd per_gene/EOG091G0PAG
	count=$(cat ../../per_gene/EOG091G0PAG/ALICUT_EOG091G0PAG.clustalo.fasta | grep ">" | wc -l)
	if [ "$count" -gt 5 ]
        then
		RAxMLmodel=$(cat ../../per_gene/EOG091G0PAG/EOG091G0PAG.best_model | grep "Best" | cut -d ":" -f 2 | tr -d '[:space:]')
                if [ "$(ls -1 | grep "^RAxML" | wc -l)" -ne 0 ]
		then
			rm RAxML*
		fi
        	raxml -f a -T 2 -m PROTGAMMA$RAxMLmodel         	-p 12345 -x 12345 -# 100         	-s ../../per_gene/EOG091G0PAG/ALICUT_EOG091G0PAG.clustalo.fasta -n EOG091G0PAG.clustalo.aln.ALICUT.$RAxMLmodel 		1> ../../per_gene/EOG091G0PAG/infer_single_ML.stdout.txt 2> ../../per_gene/EOG091G0PAG/infer_single_ML.stderr.txt
	else
		echo "fasta file per_gene/EOG091G0PAG/ALICUT_EOG091G0PAG.clustalo.fasta contains fewer than 5 sequences - skipped" > ../../per_gene/EOG091G0PAG/infer_single_ML.stdout.txt
		touch raxml.skipped
	fi
        touch ../../per_gene/EOG091G0PAG/EOG091G0PAG.raxml.done
        
[33mJob counts:
	count	jobs
	1	infer_single_ML
	1[0m
[33m
        cd per_gene/EOG091G0PAG
	count=$(cat ../../per_gene/EOG091G0PAG/ALICUT_EOG091G0PAG.clustalo.fasta | grep ">" | wc -l)
	if [ "$count" -gt 5 ]
        then
		RAxMLmodel=$(cat ../../per_gene/EOG091G0PAG/EOG091G0PAG.best_model | grep "Best" | cut -d ":" -f 2 | tr -d '[:space:]')
                if [ "$(ls -1 | grep "^RAxML" | wc -l)" -ne 0 ]
		then
			rm RAxML*
		fi
        	raxml -f a -T 2 -m PROTGAMMA$RAxMLmodel         	-p 12345 -x 12345 -# 100         	-s ../../per_gene/EOG091G0PAG/ALICUT_EOG091G0PAG.clustalo.fasta -n EOG091G0PAG.clustalo.aln.ALICUT.$RAxMLmodel 		1> ../../per_gene/EOG091G0PAG/infer_single_ML.stdout.txt 2> ../../per_gene/EOG091G0PAG/infer_single_ML.stderr.txt
	else
		echo "fasta file per_gene/EOG091G0PAG/ALICUT_EOG091G0PAG.clustalo.fasta contains fewer than 5 sequences - skipped" > ../../per_gene/EOG091G0PAG/infer_single_ML.stdout.txt
		touch raxml.skipped
	fi
        touch ../../per_gene/EOG091G0PAG/EOG091G0PAG.raxml.done
        [0m
[Sun Jul  5 21:34:32 2020]
Finished job 370.
161 of 3292 steps (5%) done

[Sun Jul  5 21:34:32 2020]
rule find_best_model:
    input: per_gene/EOG091G0C8H/ALICUT_EOG091G0C8H.clustalo.fasta, per_gene/EOG091G0C8H/empty_check.done
    output: per_gene/EOG091G0C8H/EOG091G0C8H.best_model
    log: per_gene/EOG091G0C8H/find_best_model.stderr.txt
    jobid: 586
    wildcards: BUSCO=EOG091G0C8H
    threads: 2


        cd per_gene/EOG091G0C8H
        if [ ! -d find_best_model ]
        then
            mkdir find_best_model
        fi
        cd find_best_model
        ln -s ../../../per_gene/EOG091G0C8H/ALICUT_EOG091G0C8H.clustalo.fasta EOG091G0C8H.fasta
        ProteinModelSelection.pl EOG091G0C8H.fasta 1> ../../../per_gene/EOG091G0C8H/EOG091G0C8H.best_model 2> ../../../per_gene/EOG091G0C8H/find_best_model.stderr.txt
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/c0c09ee657b1e27f2c5687e0e9aa8d70.simg
[Sun Jul  5 21:34:32 2020]
Finished job 966.
162 of 3292 steps (5%) done

[Sun Jul  5 21:34:32 2020]
rule infer_single_ML:
    input: per_gene/EOG091G0SNM/EOG091G0SNM.best_model, per_gene/EOG091G0SNM/ALICUT_EOG091G0SNM.clustalo.fasta
    output: per_gene/EOG091G0SNM/EOG091G0SNM.raxml.done
    log: per_gene/EOG091G0SNM/infer_single_ML.stdout.txt, per_gene/EOG091G0SNM/infer_single_ML.stderr.txt
    jobid: 277
    wildcards: BUSCO=EOG091G0SNM
    threads: 2


        cd per_gene/EOG091G0SNM
	count=$(cat ../../per_gene/EOG091G0SNM/ALICUT_EOG091G0SNM.clustalo.fasta | grep ">" | wc -l)
	if [ "$count" -gt 5 ]
        then
		RAxMLmodel=$(cat ../../per_gene/EOG091G0SNM/EOG091G0SNM.best_model | grep "Best" | cut -d ":" -f 2 | tr -d '[:space:]')
                if [ "$(ls -1 | grep "^RAxML" | wc -l)" -ne 0 ]
		then
			rm RAxML*
		fi
        	raxml -f a -T 2 -m PROTGAMMA$RAxMLmodel         	-p 12345 -x 12345 -# 100         	-s ../../per_gene/EOG091G0SNM/ALICUT_EOG091G0SNM.clustalo.fasta -n EOG091G0SNM.clustalo.aln.ALICUT.$RAxMLmodel 		1> ../../per_gene/EOG091G0SNM/infer_single_ML.stdout.txt 2> ../../per_gene/EOG091G0SNM/infer_single_ML.stderr.txt
	else
		echo "fasta file per_gene/EOG091G0SNM/ALICUT_EOG091G0SNM.clustalo.fasta contains fewer than 5 sequences - skipped" > ../../per_gene/EOG091G0SNM/infer_single_ML.stdout.txt
		touch raxml.skipped
	fi
        touch ../../per_gene/EOG091G0SNM/EOG091G0SNM.raxml.done
        
[33mJob counts:
	count	jobs
	1	infer_single_ML
	1[0m
[33m
        cd per_gene/EOG091G0SNM
	count=$(cat ../../per_gene/EOG091G0SNM/ALICUT_EOG091G0SNM.clustalo.fasta | grep ">" | wc -l)
	if [ "$count" -gt 5 ]
        then
		RAxMLmodel=$(cat ../../per_gene/EOG091G0SNM/EOG091G0SNM.best_model | grep "Best" | cut -d ":" -f 2 | tr -d '[:space:]')
                if [ "$(ls -1 | grep "^RAxML" | wc -l)" -ne 0 ]
		then
			rm RAxML*
		fi
        	raxml -f a -T 2 -m PROTGAMMA$RAxMLmodel         	-p 12345 -x 12345 -# 100         	-s ../../per_gene/EOG091G0SNM/ALICUT_EOG091G0SNM.clustalo.fasta -n EOG091G0SNM.clustalo.aln.ALICUT.$RAxMLmodel 		1> ../../per_gene/EOG091G0SNM/infer_single_ML.stdout.txt 2> ../../per_gene/EOG091G0SNM/infer_single_ML.stderr.txt
	else
		echo "fasta file per_gene/EOG091G0SNM/ALICUT_EOG091G0SNM.clustalo.fasta contains fewer than 5 sequences - skipped" > ../../per_gene/EOG091G0SNM/infer_single_ML.stdout.txt
		touch raxml.skipped
	fi
        touch ../../per_gene/EOG091G0SNM/EOG091G0SNM.raxml.done
        [0m
[Sun Jul  5 21:34:41 2020]
Finished job 10.
163 of 3292 steps (5%) done

[Sun Jul  5 21:34:41 2020]
rule find_best_model:
    input: per_gene/EOG091G0ZDR/ALICUT_EOG091G0ZDR.clustalo.fasta, per_gene/EOG091G0ZDR/empty_check.done
    output: per_gene/EOG091G0ZDR/EOG091G0ZDR.best_model
    log: per_gene/EOG091G0ZDR/find_best_model.stderr.txt
    jobid: 1200
    wildcards: BUSCO=EOG091G0ZDR
    threads: 2


        cd per_gene/EOG091G0ZDR
        if [ ! -d find_best_model ]
        then
            mkdir find_best_model
        fi
        cd find_best_model
        ln -s ../../../per_gene/EOG091G0ZDR/ALICUT_EOG091G0ZDR.clustalo.fasta EOG091G0ZDR.fasta
        ProteinModelSelection.pl EOG091G0ZDR.fasta 1> ../../../per_gene/EOG091G0ZDR/EOG091G0ZDR.best_model 2> ../../../per_gene/EOG091G0ZDR/find_best_model.stderr.txt
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/c0c09ee657b1e27f2c5687e0e9aa8d70.simg
[Sun Jul  5 21:35:02 2020]
Finished job 125.
164 of 3292 steps (5%) done

[Sun Jul  5 21:35:02 2020]
rule MSA:
    input: per_gene/EOG091G146E/EOG091G146E.fasta
    output: per_gene/EOG091G146E/EOG091G146E.clustalo.fasta
    log: per_gene/EOG091G146E/MSA.stdout.txt, per_gene/EOG091G146E/MSA.stderr.txt
    jobid: 1698
    wildcards: BUSCO=EOG091G146E
    threads: 2


        clustalo -i per_gene/EOG091G146E/EOG091G146E.fasta -o per_gene/EOG091G146E/EOG091G146E.clustalo.fasta --threads=2 1> per_gene/EOG091G146E/MSA.stdout.txt 2> per_gene/EOG091G146E/MSA.stderr.txt
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/d68c9691725a7401923680874285c430.simg
[Sun Jul  5 21:35:02 2020]
Finished job 1698.
165 of 3292 steps (5%) done

[Sun Jul  5 21:35:02 2020]
rule score_and_cut:
    input: per_gene/EOG091G146E/EOG091G146E.clustalo.fasta
    output: per_gene/EOG091G146E/ALICUT_EOG091G146E.clustalo.fasta
    jobid: 875
    wildcards: BUSCO=EOG091G146E
    threads: 2


        cd per_gene/EOG091G146E
        Aliscore.pl -N -r 200000000000000000 -i ../../per_gene/EOG091G146E/EOG091G146E.clustalo.fasta &> aliscore.log
        ALICUT.pl -s &> alicut.log
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/63c88c27a0fa300f57066b0ef65fefcb.simg
[Sun Jul  5 21:35:07 2020]
Finished job 586.
166 of 3292 steps (5%) done

[Sun Jul  5 21:35:07 2020]
rule infer_single_ML:
    input: per_gene/EOG091G0C8H/EOG091G0C8H.best_model, per_gene/EOG091G0C8H/ALICUT_EOG091G0C8H.clustalo.fasta
    output: per_gene/EOG091G0C8H/EOG091G0C8H.raxml.done
    log: per_gene/EOG091G0C8H/infer_single_ML.stdout.txt, per_gene/EOG091G0C8H/infer_single_ML.stderr.txt
    jobid: 87
    wildcards: BUSCO=EOG091G0C8H
    threads: 2


        cd per_gene/EOG091G0C8H
	count=$(cat ../../per_gene/EOG091G0C8H/ALICUT_EOG091G0C8H.clustalo.fasta | grep ">" | wc -l)
	if [ "$count" -gt 5 ]
        then
		RAxMLmodel=$(cat ../../per_gene/EOG091G0C8H/EOG091G0C8H.best_model | grep "Best" | cut -d ":" -f 2 | tr -d '[:space:]')
                if [ "$(ls -1 | grep "^RAxML" | wc -l)" -ne 0 ]
		then
			rm RAxML*
		fi
        	raxml -f a -T 2 -m PROTGAMMA$RAxMLmodel         	-p 12345 -x 12345 -# 100         	-s ../../per_gene/EOG091G0C8H/ALICUT_EOG091G0C8H.clustalo.fasta -n EOG091G0C8H.clustalo.aln.ALICUT.$RAxMLmodel 		1> ../../per_gene/EOG091G0C8H/infer_single_ML.stdout.txt 2> ../../per_gene/EOG091G0C8H/infer_single_ML.stderr.txt
	else
		echo "fasta file per_gene/EOG091G0C8H/ALICUT_EOG091G0C8H.clustalo.fasta contains fewer than 5 sequences - skipped" > ../../per_gene/EOG091G0C8H/infer_single_ML.stdout.txt
		touch raxml.skipped
	fi
        touch ../../per_gene/EOG091G0C8H/EOG091G0C8H.raxml.done
        
[33mJob counts:
	count	jobs
	1	infer_single_ML
	1[0m
[33m
        cd per_gene/EOG091G0C8H
	count=$(cat ../../per_gene/EOG091G0C8H/ALICUT_EOG091G0C8H.clustalo.fasta | grep ">" | wc -l)
	if [ "$count" -gt 5 ]
        then
		RAxMLmodel=$(cat ../../per_gene/EOG091G0C8H/EOG091G0C8H.best_model | grep "Best" | cut -d ":" -f 2 | tr -d '[:space:]')
                if [ "$(ls -1 | grep "^RAxML" | wc -l)" -ne 0 ]
		then
			rm RAxML*
		fi
        	raxml -f a -T 2 -m PROTGAMMA$RAxMLmodel         	-p 12345 -x 12345 -# 100         	-s ../../per_gene/EOG091G0C8H/ALICUT_EOG091G0C8H.clustalo.fasta -n EOG091G0C8H.clustalo.aln.ALICUT.$RAxMLmodel 		1> ../../per_gene/EOG091G0C8H/infer_single_ML.stdout.txt 2> ../../per_gene/EOG091G0C8H/infer_single_ML.stderr.txt
	else
		echo "fasta file per_gene/EOG091G0C8H/ALICUT_EOG091G0C8H.clustalo.fasta contains fewer than 5 sequences - skipped" > ../../per_gene/EOG091G0C8H/infer_single_ML.stdout.txt
		touch raxml.skipped
	fi
        touch ../../per_gene/EOG091G0C8H/EOG091G0C8H.raxml.done
        [0m
[Sun Jul  5 21:35:12 2020]
Finished job 875.
167 of 3292 steps (5%) done

[Sun Jul  5 21:35:12 2020]
rule find_best_model:
    input: per_gene/EOG091G0YZ0/ALICUT_EOG091G0YZ0.clustalo.fasta, per_gene/EOG091G0YZ0/empty_check.done
    output: per_gene/EOG091G0YZ0/EOG091G0YZ0.best_model
    log: per_gene/EOG091G0YZ0/find_best_model.stderr.txt
    jobid: 846
    wildcards: BUSCO=EOG091G0YZ0
    threads: 2


        cd per_gene/EOG091G0YZ0
        if [ ! -d find_best_model ]
        then
            mkdir find_best_model
        fi
        cd find_best_model
        ln -s ../../../per_gene/EOG091G0YZ0/ALICUT_EOG091G0YZ0.clustalo.fasta EOG091G0YZ0.fasta
        ProteinModelSelection.pl EOG091G0YZ0.fasta 1> ../../../per_gene/EOG091G0YZ0/EOG091G0YZ0.best_model 2> ../../../per_gene/EOG091G0YZ0/find_best_model.stderr.txt
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/c0c09ee657b1e27f2c5687e0e9aa8d70.simg
[Sun Jul  5 21:35:16 2020]
Finished job 1200.
168 of 3292 steps (5%) done

[Sun Jul  5 21:35:16 2020]
rule infer_single_ML:
    input: per_gene/EOG091G0ZDR/EOG091G0ZDR.best_model, per_gene/EOG091G0ZDR/ALICUT_EOG091G0ZDR.clustalo.fasta
    output: per_gene/EOG091G0ZDR/EOG091G0ZDR.raxml.done
    log: per_gene/EOG091G0ZDR/infer_single_ML.stdout.txt, per_gene/EOG091G0ZDR/infer_single_ML.stderr.txt
    jobid: 394
    wildcards: BUSCO=EOG091G0ZDR
    threads: 2


        cd per_gene/EOG091G0ZDR
	count=$(cat ../../per_gene/EOG091G0ZDR/ALICUT_EOG091G0ZDR.clustalo.fasta | grep ">" | wc -l)
	if [ "$count" -gt 5 ]
        then
		RAxMLmodel=$(cat ../../per_gene/EOG091G0ZDR/EOG091G0ZDR.best_model | grep "Best" | cut -d ":" -f 2 | tr -d '[:space:]')
                if [ "$(ls -1 | grep "^RAxML" | wc -l)" -ne 0 ]
		then
			rm RAxML*
		fi
        	raxml -f a -T 2 -m PROTGAMMA$RAxMLmodel         	-p 12345 -x 12345 -# 100         	-s ../../per_gene/EOG091G0ZDR/ALICUT_EOG091G0ZDR.clustalo.fasta -n EOG091G0ZDR.clustalo.aln.ALICUT.$RAxMLmodel 		1> ../../per_gene/EOG091G0ZDR/infer_single_ML.stdout.txt 2> ../../per_gene/EOG091G0ZDR/infer_single_ML.stderr.txt
	else
		echo "fasta file per_gene/EOG091G0ZDR/ALICUT_EOG091G0ZDR.clustalo.fasta contains fewer than 5 sequences - skipped" > ../../per_gene/EOG091G0ZDR/infer_single_ML.stdout.txt
		touch raxml.skipped
	fi
        touch ../../per_gene/EOG091G0ZDR/EOG091G0ZDR.raxml.done
        
[33mJob counts:
	count	jobs
	1	infer_single_ML
	1[0m
[33m
        cd per_gene/EOG091G0ZDR
	count=$(cat ../../per_gene/EOG091G0ZDR/ALICUT_EOG091G0ZDR.clustalo.fasta | grep ">" | wc -l)
	if [ "$count" -gt 5 ]
        then
		RAxMLmodel=$(cat ../../per_gene/EOG091G0ZDR/EOG091G0ZDR.best_model | grep "Best" | cut -d ":" -f 2 | tr -d '[:space:]')
                if [ "$(ls -1 | grep "^RAxML" | wc -l)" -ne 0 ]
		then
			rm RAxML*
		fi
        	raxml -f a -T 2 -m PROTGAMMA$RAxMLmodel         	-p 12345 -x 12345 -# 100         	-s ../../per_gene/EOG091G0ZDR/ALICUT_EOG091G0ZDR.clustalo.fasta -n EOG091G0ZDR.clustalo.aln.ALICUT.$RAxMLmodel 		1> ../../per_gene/EOG091G0ZDR/infer_single_ML.stdout.txt 2> ../../per_gene/EOG091G0ZDR/infer_single_ML.stderr.txt
	else
		echo "fasta file per_gene/EOG091G0ZDR/ALICUT_EOG091G0ZDR.clustalo.fasta contains fewer than 5 sequences - skipped" > ../../per_gene/EOG091G0ZDR/infer_single_ML.stdout.txt
		touch raxml.skipped
	fi
        touch ../../per_gene/EOG091G0ZDR/EOG091G0ZDR.raxml.done
        [0m
[Sun Jul  5 21:35:39 2020]
Finished job 260.
169 of 3292 steps (5%) done

[Sun Jul  5 21:35:39 2020]
rule find_best_model:
    input: per_gene/EOG091G0XN1/ALICUT_EOG091G0XN1.clustalo.fasta, per_gene/EOG091G0XN1/empty_check.done
    output: per_gene/EOG091G0XN1/EOG091G0XN1.best_model
    log: per_gene/EOG091G0XN1/find_best_model.stderr.txt
    jobid: 834
    wildcards: BUSCO=EOG091G0XN1
    threads: 2


        cd per_gene/EOG091G0XN1
        if [ ! -d find_best_model ]
        then
            mkdir find_best_model
        fi
        cd find_best_model
        ln -s ../../../per_gene/EOG091G0XN1/ALICUT_EOG091G0XN1.clustalo.fasta EOG091G0XN1.fasta
        ProteinModelSelection.pl EOG091G0XN1.fasta 1> ../../../per_gene/EOG091G0XN1/EOG091G0XN1.best_model 2> ../../../per_gene/EOG091G0XN1/find_best_model.stderr.txt
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/c0c09ee657b1e27f2c5687e0e9aa8d70.simg
[Sun Jul  5 21:35:39 2020]
Finished job 306.
170 of 3292 steps (5%) done

[Sun Jul  5 21:35:39 2020]
rule find_best_model:
    input: per_gene/EOG091G1285/ALICUT_EOG091G1285.clustalo.fasta, per_gene/EOG091G1285/empty_check.done
    output: per_gene/EOG091G1285/EOG091G1285.best_model
    log: per_gene/EOG091G1285/find_best_model.stderr.txt
    jobid: 868
    wildcards: BUSCO=EOG091G1285
    threads: 2


        cd per_gene/EOG091G1285
        if [ ! -d find_best_model ]
        then
            mkdir find_best_model
        fi
        cd find_best_model
        ln -s ../../../per_gene/EOG091G1285/ALICUT_EOG091G1285.clustalo.fasta EOG091G1285.fasta
        ProteinModelSelection.pl EOG091G1285.fasta 1> ../../../per_gene/EOG091G1285/EOG091G1285.best_model 2> ../../../per_gene/EOG091G1285/find_best_model.stderr.txt
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/c0c09ee657b1e27f2c5687e0e9aa8d70.simg
[Sun Jul  5 21:35:45 2020]
Finished job 351.
171 of 3292 steps (5%) done

[Sun Jul  5 21:35:45 2020]
rule remove_empty:
    input: per_gene/EOG091G146E/ALICUT_EOG091G146E.clustalo.fasta
    output: per_gene/EOG091G146E/empty_check.done
    jobid: 1697
    wildcards: BUSCO=EOG091G146E


         if [ "$(cat per_gene/EOG091G146E/ALICUT_EOG091G146E.clustalo.fasta | grep -v ">" | sed 's/-//g' | grep "^$" | wc -l)" -gt 0 ]
         then
              cp per_gene/EOG091G146E/ALICUT_EOG091G146E.clustalo.fasta per_gene/EOG091G146E/ALICUT_EOG091G146E.clustalo.fasta.backup
              bash ../scripts/remove_empty.sh per_gene/EOG091G146E/ALICUT_EOG091G146E.clustalo.fasta.backup > per_gene/EOG091G146E/ALICUT_EOG091G146E.clustalo.fasta
         fi
         touch per_gene/EOG091G146E/empty_check.done
         
[Sun Jul  5 21:35:45 2020]
Finished job 1697.
172 of 3292 steps (5%) done

[Sun Jul  5 21:35:45 2020]
rule find_best_model:
    input: per_gene/EOG091G146E/ALICUT_EOG091G146E.clustalo.fasta, per_gene/EOG091G146E/empty_check.done
    output: per_gene/EOG091G146E/EOG091G146E.best_model
    log: per_gene/EOG091G146E/find_best_model.stderr.txt
    jobid: 874
    wildcards: BUSCO=EOG091G146E
    threads: 2


        cd per_gene/EOG091G146E
        if [ ! -d find_best_model ]
        then
            mkdir find_best_model
        fi
        cd find_best_model
        ln -s ../../../per_gene/EOG091G146E/ALICUT_EOG091G146E.clustalo.fasta EOG091G146E.fasta
        ProteinModelSelection.pl EOG091G146E.fasta 1> ../../../per_gene/EOG091G146E/EOG091G146E.best_model 2> ../../../per_gene/EOG091G146E/find_best_model.stderr.txt
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/c0c09ee657b1e27f2c5687e0e9aa8d70.simg
[Sun Jul  5 21:35:46 2020]
Finished job 846.
173 of 3292 steps (5%) done

[Sun Jul  5 21:35:46 2020]
rule infer_single_ML:
    input: per_gene/EOG091G0YZ0/EOG091G0YZ0.best_model, per_gene/EOG091G0YZ0/ALICUT_EOG091G0YZ0.clustalo.fasta
    output: per_gene/EOG091G0YZ0/EOG091G0YZ0.raxml.done
    log: per_gene/EOG091G0YZ0/infer_single_ML.stdout.txt, per_gene/EOG091G0YZ0/infer_single_ML.stderr.txt
    jobid: 217
    wildcards: BUSCO=EOG091G0YZ0
    threads: 2


        cd per_gene/EOG091G0YZ0
	count=$(cat ../../per_gene/EOG091G0YZ0/ALICUT_EOG091G0YZ0.clustalo.fasta | grep ">" | wc -l)
	if [ "$count" -gt 5 ]
        then
		RAxMLmodel=$(cat ../../per_gene/EOG091G0YZ0/EOG091G0YZ0.best_model | grep "Best" | cut -d ":" -f 2 | tr -d '[:space:]')
                if [ "$(ls -1 | grep "^RAxML" | wc -l)" -ne 0 ]
		then
			rm RAxML*
		fi
        	raxml -f a -T 2 -m PROTGAMMA$RAxMLmodel         	-p 12345 -x 12345 -# 100         	-s ../../per_gene/EOG091G0YZ0/ALICUT_EOG091G0YZ0.clustalo.fasta -n EOG091G0YZ0.clustalo.aln.ALICUT.$RAxMLmodel 		1> ../../per_gene/EOG091G0YZ0/infer_single_ML.stdout.txt 2> ../../per_gene/EOG091G0YZ0/infer_single_ML.stderr.txt
	else
		echo "fasta file per_gene/EOG091G0YZ0/ALICUT_EOG091G0YZ0.clustalo.fasta contains fewer than 5 sequences - skipped" > ../../per_gene/EOG091G0YZ0/infer_single_ML.stdout.txt
		touch raxml.skipped
	fi
        touch ../../per_gene/EOG091G0YZ0/EOG091G0YZ0.raxml.done
        
[33mJob counts:
	count	jobs
	1	infer_single_ML
	1[0m
[33m
        cd per_gene/EOG091G0YZ0
	count=$(cat ../../per_gene/EOG091G0YZ0/ALICUT_EOG091G0YZ0.clustalo.fasta | grep ">" | wc -l)
	if [ "$count" -gt 5 ]
        then
		RAxMLmodel=$(cat ../../per_gene/EOG091G0YZ0/EOG091G0YZ0.best_model | grep "Best" | cut -d ":" -f 2 | tr -d '[:space:]')
                if [ "$(ls -1 | grep "^RAxML" | wc -l)" -ne 0 ]
		then
			rm RAxML*
		fi
        	raxml -f a -T 2 -m PROTGAMMA$RAxMLmodel         	-p 12345 -x 12345 -# 100         	-s ../../per_gene/EOG091G0YZ0/ALICUT_EOG091G0YZ0.clustalo.fasta -n EOG091G0YZ0.clustalo.aln.ALICUT.$RAxMLmodel 		1> ../../per_gene/EOG091G0YZ0/infer_single_ML.stdout.txt 2> ../../per_gene/EOG091G0YZ0/infer_single_ML.stderr.txt
	else
		echo "fasta file per_gene/EOG091G0YZ0/ALICUT_EOG091G0YZ0.clustalo.fasta contains fewer than 5 sequences - skipped" > ../../per_gene/EOG091G0YZ0/infer_single_ML.stdout.txt
		touch raxml.skipped
	fi
        touch ../../per_gene/EOG091G0YZ0/EOG091G0YZ0.raxml.done
        [0m
[Sun Jul  5 21:35:55 2020]
Finished job 160.
174 of 3292 steps (5%) done

[Sun Jul  5 21:35:55 2020]
rule get_seqs:
    input: /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ingroup.txt, /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/outgroup.txt
    output: per_gene/EOG091G0AEL/EOG091G0AEL.ingroup.fasta
    log: per_gene/EOG091G0AEL/get_seqs.stdout.txt, per_gene/EOG091G0AEL/get_seqs.stderr.txt
    jobid: 3172
    wildcards: BUSCO=EOG091G0AEL
    threads: 2


	basedir=$(pwd)
        cd per_gene/EOG091G0AEL
        
        bash $basedir/../scripts/fetch_seqs.sh EOG091G0AEL /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ingroup.txt /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/outgroup.txt 1> ../../per_gene/EOG091G0AEL/get_seqs.stdout.txt 2> ../../per_gene/EOG091G0AEL/get_seqs.stderr.txt
	mv EOG091G0AEL.fasta $basedir/per_gene/EOG091G0AEL/EOG091G0AEL.ingroup.fasta
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/72476f9d9a5bd0627b4d721143a21354.simg
[Sun Jul  5 21:36:09 2020]
Finished job 3172.
175 of 3292 steps (5%) done

[Sun Jul  5 21:36:09 2020]
rule get_outgroups:
    input: per_gene/EOG091G0AEL/EOG091G0AEL.ingroup.fasta
    output: per_gene/EOG091G0AEL/EOG091G0AEL.orthodb.fasta, per_gene/EOG091G0AEL/EOG091G0AEL.outgroup.fasta
    log: per_gene/EOG091G0AEL/get_outgroups.stdout.txt, per_gene/EOG091G0AEL/get_outgroups.stderr.txt
    jobid: 3173
    wildcards: BUSCO=EOG091G0AEL


        #download fastas from Orhtodb for BUSCO id
        for i in {1..5}
        do
             wget "http://www.orthodb.org/fasta?query=EOG091G0AEL&level=33208" -O per_gene/EOG091G0AEL/EOG091G0AEL.orthodb.fasta 1> per_gene/EOG091G0AEL/get_outgroups.stdout.txt 2> per_gene/EOG091G0AEL/get_outgroups.stderr.txt && break || echo -e "try again ($i)" && sleep 15
        done

	#This is quick an dirty for now and just takes the first protein if there is more than one for an outgroup taxon
        bash ../scripts/download_outgroups.sh taxids.txt per_gene/EOG091G0AEL/EOG091G0AEL.orthodb.fasta > per_gene/EOG091G0AEL/EOG091G0AEL.outgroup.fasta
        
[Sun Jul  5 21:36:10 2020]
Finished job 3173.
176 of 3292 steps (5%) done

[Sun Jul  5 21:36:10 2020]
rule join_groups:
    input: per_gene/EOG091G0AEL/EOG091G0AEL.ingroup.fasta, per_gene/EOG091G0AEL/EOG091G0AEL.outgroup.fasta
    output: per_gene/EOG091G0AEL/EOG091G0AEL.fasta
    jobid: 2410
    wildcards: BUSCO=EOG091G0AEL


        cat per_gene/EOG091G0AEL/EOG091G0AEL.ingroup.fasta per_gene/EOG091G0AEL/EOG091G0AEL.outgroup.fasta > per_gene/EOG091G0AEL/EOG091G0AEL.fasta
        
[Sun Jul  5 21:36:10 2020]
Finished job 2410.
177 of 3292 steps (5%) done

[Sun Jul  5 21:36:10 2020]
rule MSA:
    input: per_gene/EOG091G0AEL/EOG091G0AEL.fasta
    output: per_gene/EOG091G0AEL/EOG091G0AEL.clustalo.fasta
    log: per_gene/EOG091G0AEL/MSA.stdout.txt, per_gene/EOG091G0AEL/MSA.stderr.txt
    jobid: 1940
    wildcards: BUSCO=EOG091G0AEL
    threads: 2


        clustalo -i per_gene/EOG091G0AEL/EOG091G0AEL.fasta -o per_gene/EOG091G0AEL/EOG091G0AEL.clustalo.fasta --threads=2 1> per_gene/EOG091G0AEL/MSA.stdout.txt 2> per_gene/EOG091G0AEL/MSA.stderr.txt
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/d68c9691725a7401923680874285c430.simg
[Sun Jul  5 21:36:11 2020]
Finished job 868.
178 of 3292 steps (5%) done

[Sun Jul  5 21:36:11 2020]
rule infer_single_ML:
    input: per_gene/EOG091G1285/EOG091G1285.best_model, per_gene/EOG091G1285/ALICUT_EOG091G1285.clustalo.fasta
    output: per_gene/EOG091G1285/EOG091G1285.raxml.done
    log: per_gene/EOG091G1285/infer_single_ML.stdout.txt, per_gene/EOG091G1285/infer_single_ML.stderr.txt
    jobid: 228
    wildcards: BUSCO=EOG091G1285
    threads: 2


        cd per_gene/EOG091G1285
	count=$(cat ../../per_gene/EOG091G1285/ALICUT_EOG091G1285.clustalo.fasta | grep ">" | wc -l)
	if [ "$count" -gt 5 ]
        then
		RAxMLmodel=$(cat ../../per_gene/EOG091G1285/EOG091G1285.best_model | grep "Best" | cut -d ":" -f 2 | tr -d '[:space:]')
                if [ "$(ls -1 | grep "^RAxML" | wc -l)" -ne 0 ]
		then
			rm RAxML*
		fi
        	raxml -f a -T 2 -m PROTGAMMA$RAxMLmodel         	-p 12345 -x 12345 -# 100         	-s ../../per_gene/EOG091G1285/ALICUT_EOG091G1285.clustalo.fasta -n EOG091G1285.clustalo.aln.ALICUT.$RAxMLmodel 		1> ../../per_gene/EOG091G1285/infer_single_ML.stdout.txt 2> ../../per_gene/EOG091G1285/infer_single_ML.stderr.txt
	else
		echo "fasta file per_gene/EOG091G1285/ALICUT_EOG091G1285.clustalo.fasta contains fewer than 5 sequences - skipped" > ../../per_gene/EOG091G1285/infer_single_ML.stdout.txt
		touch raxml.skipped
	fi
        touch ../../per_gene/EOG091G1285/EOG091G1285.raxml.done
        
[33mJob counts:
	count	jobs
	1	infer_single_ML
	1[0m
[33m
        cd per_gene/EOG091G1285
	count=$(cat ../../per_gene/EOG091G1285/ALICUT_EOG091G1285.clustalo.fasta | grep ">" | wc -l)
	if [ "$count" -gt 5 ]
        then
		RAxMLmodel=$(cat ../../per_gene/EOG091G1285/EOG091G1285.best_model | grep "Best" | cut -d ":" -f 2 | tr -d '[:space:]')
                if [ "$(ls -1 | grep "^RAxML" | wc -l)" -ne 0 ]
		then
			rm RAxML*
		fi
        	raxml -f a -T 2 -m PROTGAMMA$RAxMLmodel         	-p 12345 -x 12345 -# 100         	-s ../../per_gene/EOG091G1285/ALICUT_EOG091G1285.clustalo.fasta -n EOG091G1285.clustalo.aln.ALICUT.$RAxMLmodel 		1> ../../per_gene/EOG091G1285/infer_single_ML.stdout.txt 2> ../../per_gene/EOG091G1285/infer_single_ML.stderr.txt
	else
		echo "fasta file per_gene/EOG091G1285/ALICUT_EOG091G1285.clustalo.fasta contains fewer than 5 sequences - skipped" > ../../per_gene/EOG091G1285/infer_single_ML.stdout.txt
		touch raxml.skipped
	fi
        touch ../../per_gene/EOG091G1285/EOG091G1285.raxml.done
        [0m
[Sun Jul  5 21:36:12 2020]
Finished job 834.
179 of 3292 steps (5%) done

[Sun Jul  5 21:36:12 2020]
rule infer_single_ML:
    input: per_gene/EOG091G0XN1/EOG091G0XN1.best_model, per_gene/EOG091G0XN1/ALICUT_EOG091G0XN1.clustalo.fasta
    output: per_gene/EOG091G0XN1/EOG091G0XN1.raxml.done
    log: per_gene/EOG091G0XN1/infer_single_ML.stdout.txt, per_gene/EOG091G0XN1/infer_single_ML.stderr.txt
    jobid: 211
    wildcards: BUSCO=EOG091G0XN1
    threads: 2


        cd per_gene/EOG091G0XN1
	count=$(cat ../../per_gene/EOG091G0XN1/ALICUT_EOG091G0XN1.clustalo.fasta | grep ">" | wc -l)
	if [ "$count" -gt 5 ]
        then
		RAxMLmodel=$(cat ../../per_gene/EOG091G0XN1/EOG091G0XN1.best_model | grep "Best" | cut -d ":" -f 2 | tr -d '[:space:]')
                if [ "$(ls -1 | grep "^RAxML" | wc -l)" -ne 0 ]
		then
			rm RAxML*
		fi
        	raxml -f a -T 2 -m PROTGAMMA$RAxMLmodel         	-p 12345 -x 12345 -# 100         	-s ../../per_gene/EOG091G0XN1/ALICUT_EOG091G0XN1.clustalo.fasta -n EOG091G0XN1.clustalo.aln.ALICUT.$RAxMLmodel 		1> ../../per_gene/EOG091G0XN1/infer_single_ML.stdout.txt 2> ../../per_gene/EOG091G0XN1/infer_single_ML.stderr.txt
	else
		echo "fasta file per_gene/EOG091G0XN1/ALICUT_EOG091G0XN1.clustalo.fasta contains fewer than 5 sequences - skipped" > ../../per_gene/EOG091G0XN1/infer_single_ML.stdout.txt
		touch raxml.skipped
	fi
        touch ../../per_gene/EOG091G0XN1/EOG091G0XN1.raxml.done
        
[Sun Jul  5 21:36:12 2020]
Finished job 1940.
180 of 3292 steps (5%) done

[Sun Jul  5 21:36:12 2020]
rule score_and_cut:
    input: per_gene/EOG091G0AEL/EOG091G0AEL.clustalo.fasta
    output: per_gene/EOG091G0AEL/ALICUT_EOG091G0AEL.clustalo.fasta
    jobid: 1117
    wildcards: BUSCO=EOG091G0AEL
    threads: 2


        cd per_gene/EOG091G0AEL
        Aliscore.pl -N -r 200000000000000000 -i ../../per_gene/EOG091G0AEL/EOG091G0AEL.clustalo.fasta &> aliscore.log
        ALICUT.pl -s &> alicut.log
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/63c88c27a0fa300f57066b0ef65fefcb.simg
[33mJob counts:
	count	jobs
	1	infer_single_ML
	1[0m
[33m
        cd per_gene/EOG091G0XN1
	count=$(cat ../../per_gene/EOG091G0XN1/ALICUT_EOG091G0XN1.clustalo.fasta | grep ">" | wc -l)
	if [ "$count" -gt 5 ]
        then
		RAxMLmodel=$(cat ../../per_gene/EOG091G0XN1/EOG091G0XN1.best_model | grep "Best" | cut -d ":" -f 2 | tr -d '[:space:]')
                if [ "$(ls -1 | grep "^RAxML" | wc -l)" -ne 0 ]
		then
			rm RAxML*
		fi
        	raxml -f a -T 2 -m PROTGAMMA$RAxMLmodel         	-p 12345 -x 12345 -# 100         	-s ../../per_gene/EOG091G0XN1/ALICUT_EOG091G0XN1.clustalo.fasta -n EOG091G0XN1.clustalo.aln.ALICUT.$RAxMLmodel 		1> ../../per_gene/EOG091G0XN1/infer_single_ML.stdout.txt 2> ../../per_gene/EOG091G0XN1/infer_single_ML.stderr.txt
	else
		echo "fasta file per_gene/EOG091G0XN1/ALICUT_EOG091G0XN1.clustalo.fasta contains fewer than 5 sequences - skipped" > ../../per_gene/EOG091G0XN1/infer_single_ML.stdout.txt
		touch raxml.skipped
	fi
        touch ../../per_gene/EOG091G0XN1/EOG091G0XN1.raxml.done
        [0m
[Sun Jul  5 21:36:13 2020]
Finished job 874.
181 of 3292 steps (5%) done

[Sun Jul  5 21:36:13 2020]
rule infer_single_ML:
    input: per_gene/EOG091G146E/EOG091G146E.best_model, per_gene/EOG091G146E/ALICUT_EOG091G146E.clustalo.fasta
    output: per_gene/EOG091G146E/EOG091G146E.raxml.done
    log: per_gene/EOG091G146E/infer_single_ML.stdout.txt, per_gene/EOG091G146E/infer_single_ML.stderr.txt
    jobid: 231
    wildcards: BUSCO=EOG091G146E
    threads: 2


        cd per_gene/EOG091G146E
	count=$(cat ../../per_gene/EOG091G146E/ALICUT_EOG091G146E.clustalo.fasta | grep ">" | wc -l)
	if [ "$count" -gt 5 ]
        then
		RAxMLmodel=$(cat ../../per_gene/EOG091G146E/EOG091G146E.best_model | grep "Best" | cut -d ":" -f 2 | tr -d '[:space:]')
                if [ "$(ls -1 | grep "^RAxML" | wc -l)" -ne 0 ]
		then
			rm RAxML*
		fi
        	raxml -f a -T 2 -m PROTGAMMA$RAxMLmodel         	-p 12345 -x 12345 -# 100         	-s ../../per_gene/EOG091G146E/ALICUT_EOG091G146E.clustalo.fasta -n EOG091G146E.clustalo.aln.ALICUT.$RAxMLmodel 		1> ../../per_gene/EOG091G146E/infer_single_ML.stdout.txt 2> ../../per_gene/EOG091G146E/infer_single_ML.stderr.txt
	else
		echo "fasta file per_gene/EOG091G146E/ALICUT_EOG091G146E.clustalo.fasta contains fewer than 5 sequences - skipped" > ../../per_gene/EOG091G146E/infer_single_ML.stdout.txt
		touch raxml.skipped
	fi
        touch ../../per_gene/EOG091G146E/EOG091G146E.raxml.done
        
[33mJob counts:
	count	jobs
	1	infer_single_ML
	1[0m
[33m
        cd per_gene/EOG091G146E
	count=$(cat ../../per_gene/EOG091G146E/ALICUT_EOG091G146E.clustalo.fasta | grep ">" | wc -l)
	if [ "$count" -gt 5 ]
        then
		RAxMLmodel=$(cat ../../per_gene/EOG091G146E/EOG091G146E.best_model | grep "Best" | cut -d ":" -f 2 | tr -d '[:space:]')
                if [ "$(ls -1 | grep "^RAxML" | wc -l)" -ne 0 ]
		then
			rm RAxML*
		fi
        	raxml -f a -T 2 -m PROTGAMMA$RAxMLmodel         	-p 12345 -x 12345 -# 100         	-s ../../per_gene/EOG091G146E/ALICUT_EOG091G146E.clustalo.fasta -n EOG091G146E.clustalo.aln.ALICUT.$RAxMLmodel 		1> ../../per_gene/EOG091G146E/infer_single_ML.stdout.txt 2> ../../per_gene/EOG091G146E/infer_single_ML.stderr.txt
	else
		echo "fasta file per_gene/EOG091G146E/ALICUT_EOG091G146E.clustalo.fasta contains fewer than 5 sequences - skipped" > ../../per_gene/EOG091G146E/infer_single_ML.stdout.txt
		touch raxml.skipped
	fi
        touch ../../per_gene/EOG091G146E/EOG091G146E.raxml.done
        [0m
[Sun Jul  5 21:36:22 2020]
Finished job 404.
182 of 3292 steps (6%) done

[Sun Jul  5 21:36:22 2020]
rule get_seqs:
    input: /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ingroup.txt, /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/outgroup.txt
    output: per_gene/EOG091G02ZI/EOG091G02ZI.ingroup.fasta
    log: per_gene/EOG091G02ZI/get_seqs.stdout.txt, per_gene/EOG091G02ZI/get_seqs.stderr.txt
    jobid: 2498
    wildcards: BUSCO=EOG091G02ZI
    threads: 2


	basedir=$(pwd)
        cd per_gene/EOG091G02ZI
        
        bash $basedir/../scripts/fetch_seqs.sh EOG091G02ZI /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ingroup.txt /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/outgroup.txt 1> ../../per_gene/EOG091G02ZI/get_seqs.stdout.txt 2> ../../per_gene/EOG091G02ZI/get_seqs.stderr.txt
	mv EOG091G02ZI.fasta $basedir/per_gene/EOG091G02ZI/EOG091G02ZI.ingroup.fasta
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/72476f9d9a5bd0627b4d721143a21354.simg
[Sun Jul  5 21:36:22 2020]
Finished job 1117.
183 of 3292 steps (6%) done

[Sun Jul  5 21:36:22 2020]
rule remove_empty:
    input: per_gene/EOG091G0AEL/ALICUT_EOG091G0AEL.clustalo.fasta
    output: per_gene/EOG091G0AEL/empty_check.done
    jobid: 1939
    wildcards: BUSCO=EOG091G0AEL


         if [ "$(cat per_gene/EOG091G0AEL/ALICUT_EOG091G0AEL.clustalo.fasta | grep -v ">" | sed 's/-//g' | grep "^$" | wc -l)" -gt 0 ]
         then
              cp per_gene/EOG091G0AEL/ALICUT_EOG091G0AEL.clustalo.fasta per_gene/EOG091G0AEL/ALICUT_EOG091G0AEL.clustalo.fasta.backup
              bash ../scripts/remove_empty.sh per_gene/EOG091G0AEL/ALICUT_EOG091G0AEL.clustalo.fasta.backup > per_gene/EOG091G0AEL/ALICUT_EOG091G0AEL.clustalo.fasta
         fi
         touch per_gene/EOG091G0AEL/empty_check.done
         
[Sun Jul  5 21:36:23 2020]
Finished job 1939.
184 of 3292 steps (6%) done

[Sun Jul  5 21:36:23 2020]
rule find_best_model:
    input: per_gene/EOG091G0AEL/ALICUT_EOG091G0AEL.clustalo.fasta, per_gene/EOG091G0AEL/empty_check.done
    output: per_gene/EOG091G0AEL/EOG091G0AEL.best_model
    log: per_gene/EOG091G0AEL/find_best_model.stderr.txt
    jobid: 1116
    wildcards: BUSCO=EOG091G0AEL
    threads: 2


        cd per_gene/EOG091G0AEL
        if [ ! -d find_best_model ]
        then
            mkdir find_best_model
        fi
        cd find_best_model
        ln -s ../../../per_gene/EOG091G0AEL/ALICUT_EOG091G0AEL.clustalo.fasta EOG091G0AEL.fasta
        ProteinModelSelection.pl EOG091G0AEL.fasta 1> ../../../per_gene/EOG091G0AEL/EOG091G0AEL.best_model 2> ../../../per_gene/EOG091G0AEL/find_best_model.stderr.txt
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/c0c09ee657b1e27f2c5687e0e9aa8d70.simg
[Sun Jul  5 21:36:26 2020]
Finished job 255.
185 of 3292 steps (6%) done

[Sun Jul  5 21:36:26 2020]
rule get_seqs:
    input: /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ingroup.txt, /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/outgroup.txt
    output: per_gene/EOG091G0MKY/EOG091G0MKY.ingroup.fasta
    log: per_gene/EOG091G0MKY/get_seqs.stdout.txt, per_gene/EOG091G0MKY/get_seqs.stderr.txt
    jobid: 2766
    wildcards: BUSCO=EOG091G0MKY
    threads: 2


	basedir=$(pwd)
        cd per_gene/EOG091G0MKY
        
        bash $basedir/../scripts/fetch_seqs.sh EOG091G0MKY /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ingroup.txt /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/outgroup.txt 1> ../../per_gene/EOG091G0MKY/get_seqs.stdout.txt 2> ../../per_gene/EOG091G0MKY/get_seqs.stderr.txt
	mv EOG091G0MKY.fasta $basedir/per_gene/EOG091G0MKY/EOG091G0MKY.ingroup.fasta
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/72476f9d9a5bd0627b4d721143a21354.simg
[Sun Jul  5 21:36:35 2020]
Finished job 2498.
186 of 3292 steps (6%) done

[Sun Jul  5 21:36:35 2020]
rule get_outgroups:
    input: per_gene/EOG091G02ZI/EOG091G02ZI.ingroup.fasta
    output: per_gene/EOG091G02ZI/EOG091G02ZI.orthodb.fasta, per_gene/EOG091G02ZI/EOG091G02ZI.outgroup.fasta
    log: per_gene/EOG091G02ZI/get_outgroups.stdout.txt, per_gene/EOG091G02ZI/get_outgroups.stderr.txt
    jobid: 2499
    wildcards: BUSCO=EOG091G02ZI


        #download fastas from Orhtodb for BUSCO id
        for i in {1..5}
        do
             wget "http://www.orthodb.org/fasta?query=EOG091G02ZI&level=33208" -O per_gene/EOG091G02ZI/EOG091G02ZI.orthodb.fasta 1> per_gene/EOG091G02ZI/get_outgroups.stdout.txt 2> per_gene/EOG091G02ZI/get_outgroups.stderr.txt && break || echo -e "try again ($i)" && sleep 15
        done

	#This is quick an dirty for now and just takes the first protein if there is more than one for an outgroup taxon
        bash ../scripts/download_outgroups.sh taxids.txt per_gene/EOG091G02ZI/EOG091G02ZI.orthodb.fasta > per_gene/EOG091G02ZI/EOG091G02ZI.outgroup.fasta
        
[Sun Jul  5 21:36:37 2020]
Finished job 2499.
187 of 3292 steps (6%) done

[Sun Jul  5 21:36:37 2020]
rule join_groups:
    input: per_gene/EOG091G02ZI/EOG091G02ZI.ingroup.fasta, per_gene/EOG091G02ZI/EOG091G02ZI.outgroup.fasta
    output: per_gene/EOG091G02ZI/EOG091G02ZI.fasta
    jobid: 2073
    wildcards: BUSCO=EOG091G02ZI


        cat per_gene/EOG091G02ZI/EOG091G02ZI.ingroup.fasta per_gene/EOG091G02ZI/EOG091G02ZI.outgroup.fasta > per_gene/EOG091G02ZI/EOG091G02ZI.fasta
        
[Sun Jul  5 21:36:37 2020]
Finished job 2073.
188 of 3292 steps (6%) done

[Sun Jul  5 21:36:37 2020]
rule MSA:
    input: per_gene/EOG091G02ZI/EOG091G02ZI.fasta
    output: per_gene/EOG091G02ZI/EOG091G02ZI.clustalo.fasta
    log: per_gene/EOG091G02ZI/MSA.stdout.txt, per_gene/EOG091G02ZI/MSA.stderr.txt
    jobid: 1266
    wildcards: BUSCO=EOG091G02ZI
    threads: 2


        clustalo -i per_gene/EOG091G02ZI/EOG091G02ZI.fasta -o per_gene/EOG091G02ZI/EOG091G02ZI.clustalo.fasta --threads=2 1> per_gene/EOG091G02ZI/MSA.stdout.txt 2> per_gene/EOG091G02ZI/MSA.stderr.txt
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/d68c9691725a7401923680874285c430.simg
[Sun Jul  5 21:36:39 2020]
Finished job 1266.
189 of 3292 steps (6%) done

[Sun Jul  5 21:36:39 2020]
rule score_and_cut:
    input: per_gene/EOG091G02ZI/EOG091G02ZI.clustalo.fasta
    output: per_gene/EOG091G02ZI/ALICUT_EOG091G02ZI.clustalo.fasta
    jobid: 443
    wildcards: BUSCO=EOG091G02ZI
    threads: 2


        cd per_gene/EOG091G02ZI
        Aliscore.pl -N -r 200000000000000000 -i ../../per_gene/EOG091G02ZI/EOG091G02ZI.clustalo.fasta &> aliscore.log
        ALICUT.pl -s &> alicut.log
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/63c88c27a0fa300f57066b0ef65fefcb.simg
[Sun Jul  5 21:36:39 2020]
Finished job 2766.
190 of 3292 steps (6%) done

[Sun Jul  5 21:36:39 2020]
rule get_outgroups:
    input: per_gene/EOG091G0MKY/EOG091G0MKY.ingroup.fasta
    output: per_gene/EOG091G0MKY/EOG091G0MKY.orthodb.fasta, per_gene/EOG091G0MKY/EOG091G0MKY.outgroup.fasta
    log: per_gene/EOG091G0MKY/get_outgroups.stdout.txt, per_gene/EOG091G0MKY/get_outgroups.stderr.txt
    jobid: 2767
    wildcards: BUSCO=EOG091G0MKY


        #download fastas from Orhtodb for BUSCO id
        for i in {1..5}
        do
             wget "http://www.orthodb.org/fasta?query=EOG091G0MKY&level=33208" -O per_gene/EOG091G0MKY/EOG091G0MKY.orthodb.fasta 1> per_gene/EOG091G0MKY/get_outgroups.stdout.txt 2> per_gene/EOG091G0MKY/get_outgroups.stderr.txt && break || echo -e "try again ($i)" && sleep 15
        done

	#This is quick an dirty for now and just takes the first protein if there is more than one for an outgroup taxon
        bash ../scripts/download_outgroups.sh taxids.txt per_gene/EOG091G0MKY/EOG091G0MKY.orthodb.fasta > per_gene/EOG091G0MKY/EOG091G0MKY.outgroup.fasta
        
[Sun Jul  5 21:36:40 2020]
Finished job 2767.
191 of 3292 steps (6%) done

[Sun Jul  5 21:36:40 2020]
rule join_groups:
    input: per_gene/EOG091G0MKY/EOG091G0MKY.ingroup.fasta, per_gene/EOG091G0MKY/EOG091G0MKY.outgroup.fasta
    output: per_gene/EOG091G0MKY/EOG091G0MKY.fasta
    jobid: 2207
    wildcards: BUSCO=EOG091G0MKY


        cat per_gene/EOG091G0MKY/EOG091G0MKY.ingroup.fasta per_gene/EOG091G0MKY/EOG091G0MKY.outgroup.fasta > per_gene/EOG091G0MKY/EOG091G0MKY.fasta
        
[Sun Jul  5 21:36:40 2020]
Finished job 2207.
192 of 3292 steps (6%) done

[Sun Jul  5 21:36:40 2020]
rule MSA:
    input: per_gene/EOG091G0MKY/EOG091G0MKY.fasta
    output: per_gene/EOG091G0MKY/EOG091G0MKY.clustalo.fasta
    log: per_gene/EOG091G0MKY/MSA.stdout.txt, per_gene/EOG091G0MKY/MSA.stderr.txt
    jobid: 1534
    wildcards: BUSCO=EOG091G0MKY
    threads: 2


        clustalo -i per_gene/EOG091G0MKY/EOG091G0MKY.fasta -o per_gene/EOG091G0MKY/EOG091G0MKY.clustalo.fasta --threads=2 1> per_gene/EOG091G0MKY/MSA.stdout.txt 2> per_gene/EOG091G0MKY/MSA.stderr.txt
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/d68c9691725a7401923680874285c430.simg
[Sun Jul  5 21:36:41 2020]
Finished job 1534.
193 of 3292 steps (6%) done

[Sun Jul  5 21:36:41 2020]
rule score_and_cut:
    input: per_gene/EOG091G0MKY/EOG091G0MKY.clustalo.fasta
    output: per_gene/EOG091G0MKY/ALICUT_EOG091G0MKY.clustalo.fasta
    jobid: 711
    wildcards: BUSCO=EOG091G0MKY
    threads: 2


        cd per_gene/EOG091G0MKY
        Aliscore.pl -N -r 200000000000000000 -i ../../per_gene/EOG091G0MKY/EOG091G0MKY.clustalo.fasta &> aliscore.log
        ALICUT.pl -s &> alicut.log
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/63c88c27a0fa300f57066b0ef65fefcb.simg
[Sun Jul  5 21:36:49 2020]
Finished job 443.
194 of 3292 steps (6%) done

[Sun Jul  5 21:36:49 2020]
rule remove_empty:
    input: per_gene/EOG091G02ZI/ALICUT_EOG091G02ZI.clustalo.fasta
    output: per_gene/EOG091G02ZI/empty_check.done
    jobid: 1265
    wildcards: BUSCO=EOG091G02ZI


         if [ "$(cat per_gene/EOG091G02ZI/ALICUT_EOG091G02ZI.clustalo.fasta | grep -v ">" | sed 's/-//g' | grep "^$" | wc -l)" -gt 0 ]
         then
              cp per_gene/EOG091G02ZI/ALICUT_EOG091G02ZI.clustalo.fasta per_gene/EOG091G02ZI/ALICUT_EOG091G02ZI.clustalo.fasta.backup
              bash ../scripts/remove_empty.sh per_gene/EOG091G02ZI/ALICUT_EOG091G02ZI.clustalo.fasta.backup > per_gene/EOG091G02ZI/ALICUT_EOG091G02ZI.clustalo.fasta
         fi
         touch per_gene/EOG091G02ZI/empty_check.done
         
[Sun Jul  5 21:36:49 2020]
Finished job 1265.
195 of 3292 steps (6%) done

[Sun Jul  5 21:36:49 2020]
rule find_best_model:
    input: per_gene/EOG091G02ZI/ALICUT_EOG091G02ZI.clustalo.fasta, per_gene/EOG091G02ZI/empty_check.done
    output: per_gene/EOG091G02ZI/EOG091G02ZI.best_model
    log: per_gene/EOG091G02ZI/find_best_model.stderr.txt
    jobid: 442
    wildcards: BUSCO=EOG091G02ZI
    threads: 2


        cd per_gene/EOG091G02ZI
        if [ ! -d find_best_model ]
        then
            mkdir find_best_model
        fi
        cd find_best_model
        ln -s ../../../per_gene/EOG091G02ZI/ALICUT_EOG091G02ZI.clustalo.fasta EOG091G02ZI.fasta
        ProteinModelSelection.pl EOG091G02ZI.fasta 1> ../../../per_gene/EOG091G02ZI/EOG091G02ZI.best_model 2> ../../../per_gene/EOG091G02ZI/find_best_model.stderr.txt
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/c0c09ee657b1e27f2c5687e0e9aa8d70.simg
[Sun Jul  5 21:36:51 2020]
Finished job 711.
196 of 3292 steps (6%) done

[Sun Jul  5 21:36:51 2020]
rule remove_empty:
    input: per_gene/EOG091G0MKY/ALICUT_EOG091G0MKY.clustalo.fasta
    output: per_gene/EOG091G0MKY/empty_check.done
    jobid: 1533
    wildcards: BUSCO=EOG091G0MKY


         if [ "$(cat per_gene/EOG091G0MKY/ALICUT_EOG091G0MKY.clustalo.fasta | grep -v ">" | sed 's/-//g' | grep "^$" | wc -l)" -gt 0 ]
         then
              cp per_gene/EOG091G0MKY/ALICUT_EOG091G0MKY.clustalo.fasta per_gene/EOG091G0MKY/ALICUT_EOG091G0MKY.clustalo.fasta.backup
              bash ../scripts/remove_empty.sh per_gene/EOG091G0MKY/ALICUT_EOG091G0MKY.clustalo.fasta.backup > per_gene/EOG091G0MKY/ALICUT_EOG091G0MKY.clustalo.fasta
         fi
         touch per_gene/EOG091G0MKY/empty_check.done
         
[Sun Jul  5 21:36:51 2020]
Finished job 1533.
197 of 3292 steps (6%) done

[Sun Jul  5 21:36:51 2020]
rule find_best_model:
    input: per_gene/EOG091G0MKY/ALICUT_EOG091G0MKY.clustalo.fasta, per_gene/EOG091G0MKY/empty_check.done
    output: per_gene/EOG091G0MKY/EOG091G0MKY.best_model
    log: per_gene/EOG091G0MKY/find_best_model.stderr.txt
    jobid: 710
    wildcards: BUSCO=EOG091G0MKY
    threads: 2


        cd per_gene/EOG091G0MKY
        if [ ! -d find_best_model ]
        then
            mkdir find_best_model
        fi
        cd find_best_model
        ln -s ../../../per_gene/EOG091G0MKY/ALICUT_EOG091G0MKY.clustalo.fasta EOG091G0MKY.fasta
        ProteinModelSelection.pl EOG091G0MKY.fasta 1> ../../../per_gene/EOG091G0MKY/EOG091G0MKY.best_model 2> ../../../per_gene/EOG091G0MKY/find_best_model.stderr.txt
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/c0c09ee657b1e27f2c5687e0e9aa8d70.simg
[Sun Jul  5 21:36:58 2020]
Finished job 1116.
198 of 3292 steps (6%) done

[Sun Jul  5 21:36:58 2020]
rule infer_single_ML:
    input: per_gene/EOG091G0AEL/EOG091G0AEL.best_model, per_gene/EOG091G0AEL/ALICUT_EOG091G0AEL.clustalo.fasta
    output: per_gene/EOG091G0AEL/EOG091G0AEL.raxml.done
    log: per_gene/EOG091G0AEL/infer_single_ML.stdout.txt, per_gene/EOG091G0AEL/infer_single_ML.stderr.txt
    jobid: 352
    wildcards: BUSCO=EOG091G0AEL
    threads: 2


        cd per_gene/EOG091G0AEL
	count=$(cat ../../per_gene/EOG091G0AEL/ALICUT_EOG091G0AEL.clustalo.fasta | grep ">" | wc -l)
	if [ "$count" -gt 5 ]
        then
		RAxMLmodel=$(cat ../../per_gene/EOG091G0AEL/EOG091G0AEL.best_model | grep "Best" | cut -d ":" -f 2 | tr -d '[:space:]')
                if [ "$(ls -1 | grep "^RAxML" | wc -l)" -ne 0 ]
		then
			rm RAxML*
		fi
        	raxml -f a -T 2 -m PROTGAMMA$RAxMLmodel         	-p 12345 -x 12345 -# 100         	-s ../../per_gene/EOG091G0AEL/ALICUT_EOG091G0AEL.clustalo.fasta -n EOG091G0AEL.clustalo.aln.ALICUT.$RAxMLmodel 		1> ../../per_gene/EOG091G0AEL/infer_single_ML.stdout.txt 2> ../../per_gene/EOG091G0AEL/infer_single_ML.stderr.txt
	else
		echo "fasta file per_gene/EOG091G0AEL/ALICUT_EOG091G0AEL.clustalo.fasta contains fewer than 5 sequences - skipped" > ../../per_gene/EOG091G0AEL/infer_single_ML.stdout.txt
		touch raxml.skipped
	fi
        touch ../../per_gene/EOG091G0AEL/EOG091G0AEL.raxml.done
        
[33mJob counts:
	count	jobs
	1	infer_single_ML
	1[0m
[33m
        cd per_gene/EOG091G0AEL
	count=$(cat ../../per_gene/EOG091G0AEL/ALICUT_EOG091G0AEL.clustalo.fasta | grep ">" | wc -l)
	if [ "$count" -gt 5 ]
        then
		RAxMLmodel=$(cat ../../per_gene/EOG091G0AEL/EOG091G0AEL.best_model | grep "Best" | cut -d ":" -f 2 | tr -d '[:space:]')
                if [ "$(ls -1 | grep "^RAxML" | wc -l)" -ne 0 ]
		then
			rm RAxML*
		fi
        	raxml -f a -T 2 -m PROTGAMMA$RAxMLmodel         	-p 12345 -x 12345 -# 100         	-s ../../per_gene/EOG091G0AEL/ALICUT_EOG091G0AEL.clustalo.fasta -n EOG091G0AEL.clustalo.aln.ALICUT.$RAxMLmodel 		1> ../../per_gene/EOG091G0AEL/infer_single_ML.stdout.txt 2> ../../per_gene/EOG091G0AEL/infer_single_ML.stderr.txt
	else
		echo "fasta file per_gene/EOG091G0AEL/ALICUT_EOG091G0AEL.clustalo.fasta contains fewer than 5 sequences - skipped" > ../../per_gene/EOG091G0AEL/infer_single_ML.stdout.txt
		touch raxml.skipped
	fi
        touch ../../per_gene/EOG091G0AEL/EOG091G0AEL.raxml.done
        [0m
[Sun Jul  5 21:37:23 2020]
Finished job 442.
199 of 3292 steps (6%) done

[Sun Jul  5 21:37:23 2020]
rule infer_single_ML:
    input: per_gene/EOG091G02ZI/EOG091G02ZI.best_model, per_gene/EOG091G02ZI/ALICUT_EOG091G02ZI.clustalo.fasta
    output: per_gene/EOG091G02ZI/EOG091G02ZI.raxml.done
    log: per_gene/EOG091G02ZI/infer_single_ML.stdout.txt, per_gene/EOG091G02ZI/infer_single_ML.stderr.txt
    jobid: 15
    wildcards: BUSCO=EOG091G02ZI
    threads: 2


        cd per_gene/EOG091G02ZI
	count=$(cat ../../per_gene/EOG091G02ZI/ALICUT_EOG091G02ZI.clustalo.fasta | grep ">" | wc -l)
	if [ "$count" -gt 5 ]
        then
		RAxMLmodel=$(cat ../../per_gene/EOG091G02ZI/EOG091G02ZI.best_model | grep "Best" | cut -d ":" -f 2 | tr -d '[:space:]')
                if [ "$(ls -1 | grep "^RAxML" | wc -l)" -ne 0 ]
		then
			rm RAxML*
		fi
        	raxml -f a -T 2 -m PROTGAMMA$RAxMLmodel         	-p 12345 -x 12345 -# 100         	-s ../../per_gene/EOG091G02ZI/ALICUT_EOG091G02ZI.clustalo.fasta -n EOG091G02ZI.clustalo.aln.ALICUT.$RAxMLmodel 		1> ../../per_gene/EOG091G02ZI/infer_single_ML.stdout.txt 2> ../../per_gene/EOG091G02ZI/infer_single_ML.stderr.txt
	else
		echo "fasta file per_gene/EOG091G02ZI/ALICUT_EOG091G02ZI.clustalo.fasta contains fewer than 5 sequences - skipped" > ../../per_gene/EOG091G02ZI/infer_single_ML.stdout.txt
		touch raxml.skipped
	fi
        touch ../../per_gene/EOG091G02ZI/EOG091G02ZI.raxml.done
        
[33mJob counts:
	count	jobs
	1	infer_single_ML
	1[0m
[33m
        cd per_gene/EOG091G02ZI
	count=$(cat ../../per_gene/EOG091G02ZI/ALICUT_EOG091G02ZI.clustalo.fasta | grep ">" | wc -l)
	if [ "$count" -gt 5 ]
        then
		RAxMLmodel=$(cat ../../per_gene/EOG091G02ZI/EOG091G02ZI.best_model | grep "Best" | cut -d ":" -f 2 | tr -d '[:space:]')
                if [ "$(ls -1 | grep "^RAxML" | wc -l)" -ne 0 ]
		then
			rm RAxML*
		fi
        	raxml -f a -T 2 -m PROTGAMMA$RAxMLmodel         	-p 12345 -x 12345 -# 100         	-s ../../per_gene/EOG091G02ZI/ALICUT_EOG091G02ZI.clustalo.fasta -n EOG091G02ZI.clustalo.aln.ALICUT.$RAxMLmodel 		1> ../../per_gene/EOG091G02ZI/infer_single_ML.stdout.txt 2> ../../per_gene/EOG091G02ZI/infer_single_ML.stderr.txt
	else
		echo "fasta file per_gene/EOG091G02ZI/ALICUT_EOG091G02ZI.clustalo.fasta contains fewer than 5 sequences - skipped" > ../../per_gene/EOG091G02ZI/infer_single_ML.stdout.txt
		touch raxml.skipped
	fi
        touch ../../per_gene/EOG091G02ZI/EOG091G02ZI.raxml.done
        [0m
[Sun Jul  5 21:37:28 2020]
Finished job 710.
200 of 3292 steps (6%) done

[Sun Jul  5 21:37:28 2020]
rule infer_single_ML:
    input: per_gene/EOG091G0MKY/EOG091G0MKY.best_model, per_gene/EOG091G0MKY/ALICUT_EOG091G0MKY.clustalo.fasta
    output: per_gene/EOG091G0MKY/EOG091G0MKY.raxml.done
    log: per_gene/EOG091G0MKY/infer_single_ML.stdout.txt, per_gene/EOG091G0MKY/infer_single_ML.stderr.txt
    jobid: 149
    wildcards: BUSCO=EOG091G0MKY
    threads: 2


        cd per_gene/EOG091G0MKY
	count=$(cat ../../per_gene/EOG091G0MKY/ALICUT_EOG091G0MKY.clustalo.fasta | grep ">" | wc -l)
	if [ "$count" -gt 5 ]
        then
		RAxMLmodel=$(cat ../../per_gene/EOG091G0MKY/EOG091G0MKY.best_model | grep "Best" | cut -d ":" -f 2 | tr -d '[:space:]')
                if [ "$(ls -1 | grep "^RAxML" | wc -l)" -ne 0 ]
		then
			rm RAxML*
		fi
        	raxml -f a -T 2 -m PROTGAMMA$RAxMLmodel         	-p 12345 -x 12345 -# 100         	-s ../../per_gene/EOG091G0MKY/ALICUT_EOG091G0MKY.clustalo.fasta -n EOG091G0MKY.clustalo.aln.ALICUT.$RAxMLmodel 		1> ../../per_gene/EOG091G0MKY/infer_single_ML.stdout.txt 2> ../../per_gene/EOG091G0MKY/infer_single_ML.stderr.txt
	else
		echo "fasta file per_gene/EOG091G0MKY/ALICUT_EOG091G0MKY.clustalo.fasta contains fewer than 5 sequences - skipped" > ../../per_gene/EOG091G0MKY/infer_single_ML.stdout.txt
		touch raxml.skipped
	fi
        touch ../../per_gene/EOG091G0MKY/EOG091G0MKY.raxml.done
        
[33mJob counts:
	count	jobs
	1	infer_single_ML
	1[0m
[33m
        cd per_gene/EOG091G0MKY
	count=$(cat ../../per_gene/EOG091G0MKY/ALICUT_EOG091G0MKY.clustalo.fasta | grep ">" | wc -l)
	if [ "$count" -gt 5 ]
        then
		RAxMLmodel=$(cat ../../per_gene/EOG091G0MKY/EOG091G0MKY.best_model | grep "Best" | cut -d ":" -f 2 | tr -d '[:space:]')
                if [ "$(ls -1 | grep "^RAxML" | wc -l)" -ne 0 ]
		then
			rm RAxML*
		fi
        	raxml -f a -T 2 -m PROTGAMMA$RAxMLmodel         	-p 12345 -x 12345 -# 100         	-s ../../per_gene/EOG091G0MKY/ALICUT_EOG091G0MKY.clustalo.fasta -n EOG091G0MKY.clustalo.aln.ALICUT.$RAxMLmodel 		1> ../../per_gene/EOG091G0MKY/infer_single_ML.stdout.txt 2> ../../per_gene/EOG091G0MKY/infer_single_ML.stderr.txt
	else
		echo "fasta file per_gene/EOG091G0MKY/ALICUT_EOG091G0MKY.clustalo.fasta contains fewer than 5 sequences - skipped" > ../../per_gene/EOG091G0MKY/infer_single_ML.stdout.txt
		touch raxml.skipped
	fi
        touch ../../per_gene/EOG091G0MKY/EOG091G0MKY.raxml.done
        [0m
[Sun Jul  5 21:37:58 2020]
Finished job 231.
201 of 3292 steps (6%) done

[Sun Jul  5 21:37:58 2020]
rule get_seqs:
    input: /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ingroup.txt, /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/outgroup.txt
    output: per_gene/EOG091G0UQZ/EOG091G0UQZ.ingroup.fasta
    log: per_gene/EOG091G0UQZ/get_seqs.stdout.txt, per_gene/EOG091G0UQZ/get_seqs.stderr.txt
    jobid: 2868
    wildcards: BUSCO=EOG091G0UQZ
    threads: 2


	basedir=$(pwd)
        cd per_gene/EOG091G0UQZ
        
        bash $basedir/../scripts/fetch_seqs.sh EOG091G0UQZ /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ingroup.txt /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/outgroup.txt 1> ../../per_gene/EOG091G0UQZ/get_seqs.stdout.txt 2> ../../per_gene/EOG091G0UQZ/get_seqs.stderr.txt
	mv EOG091G0UQZ.fasta $basedir/per_gene/EOG091G0UQZ/EOG091G0UQZ.ingroup.fasta
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/72476f9d9a5bd0627b4d721143a21354.simg
[Sun Jul  5 21:37:58 2020]
Finished job 52.
202 of 3292 steps (6%) done

[Sun Jul  5 21:37:58 2020]
rule get_seqs:
    input: /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ingroup.txt, /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/outgroup.txt
    output: per_gene/EOG091G0LT1/EOG091G0LT1.ingroup.fasta
    log: per_gene/EOG091G0LT1/get_seqs.stdout.txt, per_gene/EOG091G0LT1/get_seqs.stderr.txt
    jobid: 2752
    wildcards: BUSCO=EOG091G0LT1
    threads: 2


	basedir=$(pwd)
        cd per_gene/EOG091G0LT1
        
        bash $basedir/../scripts/fetch_seqs.sh EOG091G0LT1 /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ingroup.txt /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/outgroup.txt 1> ../../per_gene/EOG091G0LT1/get_seqs.stdout.txt 2> ../../per_gene/EOG091G0LT1/get_seqs.stderr.txt
	mv EOG091G0LT1.fasta $basedir/per_gene/EOG091G0LT1/EOG091G0LT1.ingroup.fasta
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/72476f9d9a5bd0627b4d721143a21354.simg
[Sun Jul  5 21:38:06 2020]
Finished job 277.
203 of 3292 steps (6%) done

[Sun Jul  5 21:38:06 2020]
rule get_seqs:
    input: /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ingroup.txt, /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/outgroup.txt
    output: per_gene/EOG091G0S8Y/EOG091G0S8Y.ingroup.fasta
    log: per_gene/EOG091G0S8Y/get_seqs.stdout.txt, per_gene/EOG091G0S8Y/get_seqs.stderr.txt
    jobid: 2842
    wildcards: BUSCO=EOG091G0S8Y
    threads: 2


	basedir=$(pwd)
        cd per_gene/EOG091G0S8Y
        
        bash $basedir/../scripts/fetch_seqs.sh EOG091G0S8Y /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ingroup.txt /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/outgroup.txt 1> ../../per_gene/EOG091G0S8Y/get_seqs.stdout.txt 2> ../../per_gene/EOG091G0S8Y/get_seqs.stderr.txt
	mv EOG091G0S8Y.fasta $basedir/per_gene/EOG091G0S8Y/EOG091G0S8Y.ingroup.fasta
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/72476f9d9a5bd0627b4d721143a21354.simg
[Sun Jul  5 21:38:11 2020]
Finished job 2868.
204 of 3292 steps (6%) done

[Sun Jul  5 21:38:11 2020]
rule get_outgroups:
    input: per_gene/EOG091G0UQZ/EOG091G0UQZ.ingroup.fasta
    output: per_gene/EOG091G0UQZ/EOG091G0UQZ.orthodb.fasta, per_gene/EOG091G0UQZ/EOG091G0UQZ.outgroup.fasta
    log: per_gene/EOG091G0UQZ/get_outgroups.stdout.txt, per_gene/EOG091G0UQZ/get_outgroups.stderr.txt
    jobid: 2869
    wildcards: BUSCO=EOG091G0UQZ


        #download fastas from Orhtodb for BUSCO id
        for i in {1..5}
        do
             wget "http://www.orthodb.org/fasta?query=EOG091G0UQZ&level=33208" -O per_gene/EOG091G0UQZ/EOG091G0UQZ.orthodb.fasta 1> per_gene/EOG091G0UQZ/get_outgroups.stdout.txt 2> per_gene/EOG091G0UQZ/get_outgroups.stderr.txt && break || echo -e "try again ($i)" && sleep 15
        done

	#This is quick an dirty for now and just takes the first protein if there is more than one for an outgroup taxon
        bash ../scripts/download_outgroups.sh taxids.txt per_gene/EOG091G0UQZ/EOG091G0UQZ.orthodb.fasta > per_gene/EOG091G0UQZ/EOG091G0UQZ.outgroup.fasta
        
[Sun Jul  5 21:38:12 2020]
Finished job 2752.
205 of 3292 steps (6%) done

[Sun Jul  5 21:38:12 2020]
rule get_seqs:
    input: /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ingroup.txt, /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/outgroup.txt
    output: per_gene/EOG091G0K1G/EOG091G0K1G.ingroup.fasta
    log: per_gene/EOG091G0K1G/get_seqs.stdout.txt, per_gene/EOG091G0K1G/get_seqs.stderr.txt
    jobid: 2990
    wildcards: BUSCO=EOG091G0K1G
    threads: 2


	basedir=$(pwd)
        cd per_gene/EOG091G0K1G
        
        bash $basedir/../scripts/fetch_seqs.sh EOG091G0K1G /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ingroup.txt /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/outgroup.txt 1> ../../per_gene/EOG091G0K1G/get_seqs.stdout.txt 2> ../../per_gene/EOG091G0K1G/get_seqs.stderr.txt
	mv EOG091G0K1G.fasta $basedir/per_gene/EOG091G0K1G/EOG091G0K1G.ingroup.fasta
        

[Sun Jul  5 21:38:12 2020]
rule get_outgroups:
    input: per_gene/EOG091G0LT1/EOG091G0LT1.ingroup.fasta
    output: per_gene/EOG091G0LT1/EOG091G0LT1.orthodb.fasta, per_gene/EOG091G0LT1/EOG091G0LT1.outgroup.fasta
    log: per_gene/EOG091G0LT1/get_outgroups.stdout.txt, per_gene/EOG091G0LT1/get_outgroups.stderr.txt
    jobid: 2753
    wildcards: BUSCO=EOG091G0LT1
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/72476f9d9a5bd0627b4d721143a21354.simg


        #download fastas from Orhtodb for BUSCO id
        for i in {1..5}
        do
             wget "http://www.orthodb.org/fasta?query=EOG091G0LT1&level=33208" -O per_gene/EOG091G0LT1/EOG091G0LT1.orthodb.fasta 1> per_gene/EOG091G0LT1/get_outgroups.stdout.txt 2> per_gene/EOG091G0LT1/get_outgroups.stderr.txt && break || echo -e "try again ($i)" && sleep 15
        done

	#This is quick an dirty for now and just takes the first protein if there is more than one for an outgroup taxon
        bash ../scripts/download_outgroups.sh taxids.txt per_gene/EOG091G0LT1/EOG091G0LT1.orthodb.fasta > per_gene/EOG091G0LT1/EOG091G0LT1.outgroup.fasta
        
[Sun Jul  5 21:38:12 2020]
Finished job 2869.
206 of 3292 steps (6%) done

[Sun Jul  5 21:38:13 2020]
rule join_groups:
    input: per_gene/EOG091G0UQZ/EOG091G0UQZ.ingroup.fasta, per_gene/EOG091G0UQZ/EOG091G0UQZ.outgroup.fasta
    output: per_gene/EOG091G0UQZ/EOG091G0UQZ.fasta
    jobid: 2258
    wildcards: BUSCO=EOG091G0UQZ


        cat per_gene/EOG091G0UQZ/EOG091G0UQZ.ingroup.fasta per_gene/EOG091G0UQZ/EOG091G0UQZ.outgroup.fasta > per_gene/EOG091G0UQZ/EOG091G0UQZ.fasta
        
[Sun Jul  5 21:38:13 2020]
Finished job 2258.
207 of 3292 steps (6%) done
[Sun Jul  5 21:38:13 2020]
Finished job 2753.
208 of 3292 steps (6%) done

[Sun Jul  5 21:38:13 2020]
rule join_groups:
    input: per_gene/EOG091G0LT1/EOG091G0LT1.ingroup.fasta, per_gene/EOG091G0LT1/EOG091G0LT1.outgroup.fasta
    output: per_gene/EOG091G0LT1/EOG091G0LT1.fasta
    jobid: 2200
    wildcards: BUSCO=EOG091G0LT1


        cat per_gene/EOG091G0LT1/EOG091G0LT1.ingroup.fasta per_gene/EOG091G0LT1/EOG091G0LT1.outgroup.fasta > per_gene/EOG091G0LT1/EOG091G0LT1.fasta
        
[Sun Jul  5 21:38:13 2020]
Finished job 2200.
209 of 3292 steps (6%) done

[Sun Jul  5 21:38:13 2020]
rule MSA:
    input: per_gene/EOG091G0LT1/EOG091G0LT1.fasta
    output: per_gene/EOG091G0LT1/EOG091G0LT1.clustalo.fasta
    log: per_gene/EOG091G0LT1/MSA.stdout.txt, per_gene/EOG091G0LT1/MSA.stderr.txt
    jobid: 1520
    wildcards: BUSCO=EOG091G0LT1
    threads: 2


        clustalo -i per_gene/EOG091G0LT1/EOG091G0LT1.fasta -o per_gene/EOG091G0LT1/EOG091G0LT1.clustalo.fasta --threads=2 1> per_gene/EOG091G0LT1/MSA.stdout.txt 2> per_gene/EOG091G0LT1/MSA.stderr.txt
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/d68c9691725a7401923680874285c430.simg
[Sun Jul  5 21:38:14 2020]
Finished job 1520.
210 of 3292 steps (6%) done

[Sun Jul  5 21:38:14 2020]
rule score_and_cut:
    input: per_gene/EOG091G0LT1/EOG091G0LT1.clustalo.fasta
    output: per_gene/EOG091G0LT1/ALICUT_EOG091G0LT1.clustalo.fasta
    jobid: 697
    wildcards: BUSCO=EOG091G0LT1
    threads: 2


        cd per_gene/EOG091G0LT1
        Aliscore.pl -N -r 200000000000000000 -i ../../per_gene/EOG091G0LT1/EOG091G0LT1.clustalo.fasta &> aliscore.log
        ALICUT.pl -s &> alicut.log
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/63c88c27a0fa300f57066b0ef65fefcb.simg
[Sun Jul  5 21:38:19 2020]
Finished job 2842.
211 of 3292 steps (6%) done

[Sun Jul  5 21:38:19 2020]
rule MSA:
    input: per_gene/EOG091G0UQZ/EOG091G0UQZ.fasta
    output: per_gene/EOG091G0UQZ/EOG091G0UQZ.clustalo.fasta
    log: per_gene/EOG091G0UQZ/MSA.stdout.txt, per_gene/EOG091G0UQZ/MSA.stderr.txt
    jobid: 1636
    wildcards: BUSCO=EOG091G0UQZ
    threads: 2


        clustalo -i per_gene/EOG091G0UQZ/EOG091G0UQZ.fasta -o per_gene/EOG091G0UQZ/EOG091G0UQZ.clustalo.fasta --threads=2 1> per_gene/EOG091G0UQZ/MSA.stdout.txt 2> per_gene/EOG091G0UQZ/MSA.stderr.txt
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/d68c9691725a7401923680874285c430.simg
[Sun Jul  5 21:38:21 2020]
Finished job 1636.
212 of 3292 steps (6%) done

[Sun Jul  5 21:38:21 2020]
rule score_and_cut:
    input: per_gene/EOG091G0UQZ/EOG091G0UQZ.clustalo.fasta
    output: per_gene/EOG091G0UQZ/ALICUT_EOG091G0UQZ.clustalo.fasta
    jobid: 813
    wildcards: BUSCO=EOG091G0UQZ
    threads: 2


        cd per_gene/EOG091G0UQZ
        Aliscore.pl -N -r 200000000000000000 -i ../../per_gene/EOG091G0UQZ/EOG091G0UQZ.clustalo.fasta &> aliscore.log
        ALICUT.pl -s &> alicut.log
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/63c88c27a0fa300f57066b0ef65fefcb.simg
[Sun Jul  5 21:38:22 2020]
Finished job 78.
213 of 3292 steps (6%) done

[Sun Jul  5 21:38:22 2020]
rule get_outgroups:
    input: per_gene/EOG091G0S8Y/EOG091G0S8Y.ingroup.fasta
    output: per_gene/EOG091G0S8Y/EOG091G0S8Y.orthodb.fasta, per_gene/EOG091G0S8Y/EOG091G0S8Y.outgroup.fasta
    log: per_gene/EOG091G0S8Y/get_outgroups.stdout.txt, per_gene/EOG091G0S8Y/get_outgroups.stderr.txt
    jobid: 2843
    wildcards: BUSCO=EOG091G0S8Y


        #download fastas from Orhtodb for BUSCO id
        for i in {1..5}
        do
             wget "http://www.orthodb.org/fasta?query=EOG091G0S8Y&level=33208" -O per_gene/EOG091G0S8Y/EOG091G0S8Y.orthodb.fasta 1> per_gene/EOG091G0S8Y/get_outgroups.stdout.txt 2> per_gene/EOG091G0S8Y/get_outgroups.stderr.txt && break || echo -e "try again ($i)" && sleep 15
        done

	#This is quick an dirty for now and just takes the first protein if there is more than one for an outgroup taxon
        bash ../scripts/download_outgroups.sh taxids.txt per_gene/EOG091G0S8Y/EOG091G0S8Y.orthodb.fasta > per_gene/EOG091G0S8Y/EOG091G0S8Y.outgroup.fasta
        
[Sun Jul  5 21:38:22 2020]
Finished job 248.
214 of 3292 steps (7%) done

[Sun Jul  5 21:38:22 2020]
rule get_seqs:
    input: /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ingroup.txt, /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/outgroup.txt
    output: per_gene/EOG091G0VIF/EOG091G0VIF.ingroup.fasta
    log: per_gene/EOG091G0VIF/get_seqs.stdout.txt, per_gene/EOG091G0VIF/get_seqs.stderr.txt
    jobid: 2874
    wildcards: BUSCO=EOG091G0VIF
    threads: 2


	basedir=$(pwd)
        cd per_gene/EOG091G0VIF
        
        bash $basedir/../scripts/fetch_seqs.sh EOG091G0VIF /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ingroup.txt /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/outgroup.txt 1> ../../per_gene/EOG091G0VIF/get_seqs.stdout.txt 2> ../../per_gene/EOG091G0VIF/get_seqs.stderr.txt
	mv EOG091G0VIF.fasta $basedir/per_gene/EOG091G0VIF/EOG091G0VIF.ingroup.fasta
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/72476f9d9a5bd0627b4d721143a21354.simg
[Sun Jul  5 21:38:23 2020]
Finished job 2843.
215 of 3292 steps (7%) done

[Sun Jul  5 21:38:23 2020]
rule join_groups:
    input: per_gene/EOG091G0S8Y/EOG091G0S8Y.ingroup.fasta, per_gene/EOG091G0S8Y/EOG091G0S8Y.outgroup.fasta
    output: per_gene/EOG091G0S8Y/EOG091G0S8Y.fasta
    jobid: 2245
    wildcards: BUSCO=EOG091G0S8Y


        cat per_gene/EOG091G0S8Y/EOG091G0S8Y.ingroup.fasta per_gene/EOG091G0S8Y/EOG091G0S8Y.outgroup.fasta > per_gene/EOG091G0S8Y/EOG091G0S8Y.fasta
        
[Sun Jul  5 21:38:23 2020]
Finished job 2245.
216 of 3292 steps (7%) done

[Sun Jul  5 21:38:23 2020]
rule MSA:
    input: per_gene/EOG091G0S8Y/EOG091G0S8Y.fasta
    output: per_gene/EOG091G0S8Y/EOG091G0S8Y.clustalo.fasta
    log: per_gene/EOG091G0S8Y/MSA.stdout.txt, per_gene/EOG091G0S8Y/MSA.stderr.txt
    jobid: 1610
    wildcards: BUSCO=EOG091G0S8Y
    threads: 2


        clustalo -i per_gene/EOG091G0S8Y/EOG091G0S8Y.fasta -o per_gene/EOG091G0S8Y/EOG091G0S8Y.clustalo.fasta --threads=2 1> per_gene/EOG091G0S8Y/MSA.stdout.txt 2> per_gene/EOG091G0S8Y/MSA.stderr.txt
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/d68c9691725a7401923680874285c430.simg
[Sun Jul  5 21:38:24 2020]
Finished job 697.
217 of 3292 steps (7%) done

[Sun Jul  5 21:38:24 2020]
rule remove_empty:
    input: per_gene/EOG091G0LT1/ALICUT_EOG091G0LT1.clustalo.fasta
    output: per_gene/EOG091G0LT1/empty_check.done
    jobid: 1519
    wildcards: BUSCO=EOG091G0LT1


         if [ "$(cat per_gene/EOG091G0LT1/ALICUT_EOG091G0LT1.clustalo.fasta | grep -v ">" | sed 's/-//g' | grep "^$" | wc -l)" -gt 0 ]
         then
              cp per_gene/EOG091G0LT1/ALICUT_EOG091G0LT1.clustalo.fasta per_gene/EOG091G0LT1/ALICUT_EOG091G0LT1.clustalo.fasta.backup
              bash ../scripts/remove_empty.sh per_gene/EOG091G0LT1/ALICUT_EOG091G0LT1.clustalo.fasta.backup > per_gene/EOG091G0LT1/ALICUT_EOG091G0LT1.clustalo.fasta
         fi
         touch per_gene/EOG091G0LT1/empty_check.done
         
[Sun Jul  5 21:38:24 2020]
Finished job 1519.
218 of 3292 steps (7%) done

[Sun Jul  5 21:38:24 2020]
rule find_best_model:
    input: per_gene/EOG091G0LT1/ALICUT_EOG091G0LT1.clustalo.fasta, per_gene/EOG091G0LT1/empty_check.done
    output: per_gene/EOG091G0LT1/EOG091G0LT1.best_model
    log: per_gene/EOG091G0LT1/find_best_model.stderr.txt
    jobid: 696
    wildcards: BUSCO=EOG091G0LT1
    threads: 2


        cd per_gene/EOG091G0LT1
        if [ ! -d find_best_model ]
        then
            mkdir find_best_model
        fi
        cd find_best_model
        ln -s ../../../per_gene/EOG091G0LT1/ALICUT_EOG091G0LT1.clustalo.fasta EOG091G0LT1.fasta
        ProteinModelSelection.pl EOG091G0LT1.fasta 1> ../../../per_gene/EOG091G0LT1/EOG091G0LT1.best_model 2> ../../../per_gene/EOG091G0LT1/find_best_model.stderr.txt
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/c0c09ee657b1e27f2c5687e0e9aa8d70.simg
[Sun Jul  5 21:38:24 2020]
Finished job 1610.
219 of 3292 steps (7%) done

[Sun Jul  5 21:38:24 2020]
rule score_and_cut:
    input: per_gene/EOG091G0S8Y/EOG091G0S8Y.clustalo.fasta
    output: per_gene/EOG091G0S8Y/ALICUT_EOG091G0S8Y.clustalo.fasta
    jobid: 787
    wildcards: BUSCO=EOG091G0S8Y
    threads: 2


        cd per_gene/EOG091G0S8Y
        Aliscore.pl -N -r 200000000000000000 -i ../../per_gene/EOG091G0S8Y/EOG091G0S8Y.clustalo.fasta &> aliscore.log
        ALICUT.pl -s &> alicut.log
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/63c88c27a0fa300f57066b0ef65fefcb.simg
[Sun Jul  5 21:38:25 2020]
Finished job 2990.
220 of 3292 steps (7%) done

[Sun Jul  5 21:38:25 2020]
rule get_outgroups:
    input: per_gene/EOG091G0K1G/EOG091G0K1G.ingroup.fasta
    output: per_gene/EOG091G0K1G/EOG091G0K1G.orthodb.fasta, per_gene/EOG091G0K1G/EOG091G0K1G.outgroup.fasta
    log: per_gene/EOG091G0K1G/get_outgroups.stdout.txt, per_gene/EOG091G0K1G/get_outgroups.stderr.txt
    jobid: 2991
    wildcards: BUSCO=EOG091G0K1G


        #download fastas from Orhtodb for BUSCO id
        for i in {1..5}
        do
             wget "http://www.orthodb.org/fasta?query=EOG091G0K1G&level=33208" -O per_gene/EOG091G0K1G/EOG091G0K1G.orthodb.fasta 1> per_gene/EOG091G0K1G/get_outgroups.stdout.txt 2> per_gene/EOG091G0K1G/get_outgroups.stderr.txt && break || echo -e "try again ($i)" && sleep 15
        done

	#This is quick an dirty for now and just takes the first protein if there is more than one for an outgroup taxon
        bash ../scripts/download_outgroups.sh taxids.txt per_gene/EOG091G0K1G/EOG091G0K1G.orthodb.fasta > per_gene/EOG091G0K1G/EOG091G0K1G.outgroup.fasta
        
[Sun Jul  5 21:38:26 2020]
Finished job 2991.
221 of 3292 steps (7%) done

[Sun Jul  5 21:38:26 2020]
rule join_groups:
    input: per_gene/EOG091G0K1G/EOG091G0K1G.ingroup.fasta, per_gene/EOG091G0K1G/EOG091G0K1G.outgroup.fasta
    output: per_gene/EOG091G0K1G/EOG091G0K1G.fasta
    jobid: 2319
    wildcards: BUSCO=EOG091G0K1G


        cat per_gene/EOG091G0K1G/EOG091G0K1G.ingroup.fasta per_gene/EOG091G0K1G/EOG091G0K1G.outgroup.fasta > per_gene/EOG091G0K1G/EOG091G0K1G.fasta
        
[Sun Jul  5 21:38:26 2020]
Finished job 2319.
222 of 3292 steps (7%) done

[Sun Jul  5 21:38:26 2020]
rule MSA:
    input: per_gene/EOG091G0K1G/EOG091G0K1G.fasta
    output: per_gene/EOG091G0K1G/EOG091G0K1G.clustalo.fasta
    log: per_gene/EOG091G0K1G/MSA.stdout.txt, per_gene/EOG091G0K1G/MSA.stderr.txt
    jobid: 1758
    wildcards: BUSCO=EOG091G0K1G
    threads: 2


        clustalo -i per_gene/EOG091G0K1G/EOG091G0K1G.fasta -o per_gene/EOG091G0K1G/EOG091G0K1G.clustalo.fasta --threads=2 1> per_gene/EOG091G0K1G/MSA.stdout.txt 2> per_gene/EOG091G0K1G/MSA.stderr.txt
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/d68c9691725a7401923680874285c430.simg
[Sun Jul  5 21:38:27 2020]
Finished job 1758.
223 of 3292 steps (7%) done

[Sun Jul  5 21:38:27 2020]
rule score_and_cut:
    input: per_gene/EOG091G0K1G/EOG091G0K1G.clustalo.fasta
    output: per_gene/EOG091G0K1G/ALICUT_EOG091G0K1G.clustalo.fasta
    jobid: 935
    wildcards: BUSCO=EOG091G0K1G
    threads: 2


        cd per_gene/EOG091G0K1G
        Aliscore.pl -N -r 200000000000000000 -i ../../per_gene/EOG091G0K1G/EOG091G0K1G.clustalo.fasta &> aliscore.log
        ALICUT.pl -s &> alicut.log
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/63c88c27a0fa300f57066b0ef65fefcb.simg
[Sun Jul  5 21:38:31 2020]
Finished job 166.
224 of 3292 steps (7%) done

[Sun Jul  5 21:38:31 2020]
rule get_seqs:
    input: /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ingroup.txt, /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/outgroup.txt
    output: per_gene/EOG091G0GWO/EOG091G0GWO.ingroup.fasta
    log: per_gene/EOG091G0GWO/get_seqs.stdout.txt, per_gene/EOG091G0GWO/get_seqs.stderr.txt
    jobid: 2698
    wildcards: BUSCO=EOG091G0GWO
    threads: 2


	basedir=$(pwd)
        cd per_gene/EOG091G0GWO
        
        bash $basedir/../scripts/fetch_seqs.sh EOG091G0GWO /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ingroup.txt /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/outgroup.txt 1> ../../per_gene/EOG091G0GWO/get_seqs.stdout.txt 2> ../../per_gene/EOG091G0GWO/get_seqs.stderr.txt
	mv EOG091G0GWO.fasta $basedir/per_gene/EOG091G0GWO/EOG091G0GWO.ingroup.fasta
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/72476f9d9a5bd0627b4d721143a21354.simg
[Sun Jul  5 21:38:31 2020]
Finished job 813.
225 of 3292 steps (7%) done

[Sun Jul  5 21:38:31 2020]
rule remove_empty:
    input: per_gene/EOG091G0UQZ/ALICUT_EOG091G0UQZ.clustalo.fasta
    output: per_gene/EOG091G0UQZ/empty_check.done
    jobid: 1635
    wildcards: BUSCO=EOG091G0UQZ


         if [ "$(cat per_gene/EOG091G0UQZ/ALICUT_EOG091G0UQZ.clustalo.fasta | grep -v ">" | sed 's/-//g' | grep "^$" | wc -l)" -gt 0 ]
         then
              cp per_gene/EOG091G0UQZ/ALICUT_EOG091G0UQZ.clustalo.fasta per_gene/EOG091G0UQZ/ALICUT_EOG091G0UQZ.clustalo.fasta.backup
              bash ../scripts/remove_empty.sh per_gene/EOG091G0UQZ/ALICUT_EOG091G0UQZ.clustalo.fasta.backup > per_gene/EOG091G0UQZ/ALICUT_EOG091G0UQZ.clustalo.fasta
         fi
         touch per_gene/EOG091G0UQZ/empty_check.done
         
[Sun Jul  5 21:38:31 2020]
Finished job 1635.
226 of 3292 steps (7%) done

[Sun Jul  5 21:38:31 2020]
rule find_best_model:
    input: per_gene/EOG091G0UQZ/ALICUT_EOG091G0UQZ.clustalo.fasta, per_gene/EOG091G0UQZ/empty_check.done
    output: per_gene/EOG091G0UQZ/EOG091G0UQZ.best_model
    log: per_gene/EOG091G0UQZ/find_best_model.stderr.txt
    jobid: 812
    wildcards: BUSCO=EOG091G0UQZ
    threads: 2


        cd per_gene/EOG091G0UQZ
        if [ ! -d find_best_model ]
        then
            mkdir find_best_model
        fi
        cd find_best_model
        ln -s ../../../per_gene/EOG091G0UQZ/ALICUT_EOG091G0UQZ.clustalo.fasta EOG091G0UQZ.fasta
        ProteinModelSelection.pl EOG091G0UQZ.fasta 1> ../../../per_gene/EOG091G0UQZ/EOG091G0UQZ.best_model 2> ../../../per_gene/EOG091G0UQZ/find_best_model.stderr.txt
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/c0c09ee657b1e27f2c5687e0e9aa8d70.simg
[Sun Jul  5 21:38:32 2020]
Finished job 244.
227 of 3292 steps (7%) done

[Sun Jul  5 21:38:32 2020]
rule get_seqs:
    input: /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ingroup.txt, /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/outgroup.txt
    output: per_gene/EOG091G0R6Z/EOG091G0R6Z.ingroup.fasta
    log: per_gene/EOG091G0R6Z/get_seqs.stdout.txt, per_gene/EOG091G0R6Z/get_seqs.stderr.txt
    jobid: 3248
    wildcards: BUSCO=EOG091G0R6Z
    threads: 2


	basedir=$(pwd)
        cd per_gene/EOG091G0R6Z
        
        bash $basedir/../scripts/fetch_seqs.sh EOG091G0R6Z /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ingroup.txt /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/outgroup.txt 1> ../../per_gene/EOG091G0R6Z/get_seqs.stdout.txt 2> ../../per_gene/EOG091G0R6Z/get_seqs.stderr.txt
	mv EOG091G0R6Z.fasta $basedir/per_gene/EOG091G0R6Z/EOG091G0R6Z.ingroup.fasta
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/72476f9d9a5bd0627b4d721143a21354.simg
[Sun Jul  5 21:38:34 2020]
Finished job 787.
228 of 3292 steps (7%) done

[Sun Jul  5 21:38:34 2020]
rule remove_empty:
    input: per_gene/EOG091G0S8Y/ALICUT_EOG091G0S8Y.clustalo.fasta
    output: per_gene/EOG091G0S8Y/empty_check.done
    jobid: 1609
    wildcards: BUSCO=EOG091G0S8Y


         if [ "$(cat per_gene/EOG091G0S8Y/ALICUT_EOG091G0S8Y.clustalo.fasta | grep -v ">" | sed 's/-//g' | grep "^$" | wc -l)" -gt 0 ]
         then
              cp per_gene/EOG091G0S8Y/ALICUT_EOG091G0S8Y.clustalo.fasta per_gene/EOG091G0S8Y/ALICUT_EOG091G0S8Y.clustalo.fasta.backup
              bash ../scripts/remove_empty.sh per_gene/EOG091G0S8Y/ALICUT_EOG091G0S8Y.clustalo.fasta.backup > per_gene/EOG091G0S8Y/ALICUT_EOG091G0S8Y.clustalo.fasta
         fi
         touch per_gene/EOG091G0S8Y/empty_check.done
         
[Sun Jul  5 21:38:34 2020]
Finished job 1609.
229 of 3292 steps (7%) done

[Sun Jul  5 21:38:34 2020]
rule find_best_model:
    input: per_gene/EOG091G0S8Y/ALICUT_EOG091G0S8Y.clustalo.fasta, per_gene/EOG091G0S8Y/empty_check.done
    output: per_gene/EOG091G0S8Y/EOG091G0S8Y.best_model
    log: per_gene/EOG091G0S8Y/find_best_model.stderr.txt
    jobid: 786
    wildcards: BUSCO=EOG091G0S8Y
    threads: 2


        cd per_gene/EOG091G0S8Y
        if [ ! -d find_best_model ]
        then
            mkdir find_best_model
        fi
        cd find_best_model
        ln -s ../../../per_gene/EOG091G0S8Y/ALICUT_EOG091G0S8Y.clustalo.fasta EOG091G0S8Y.fasta
        ProteinModelSelection.pl EOG091G0S8Y.fasta 1> ../../../per_gene/EOG091G0S8Y/EOG091G0S8Y.best_model 2> ../../../per_gene/EOG091G0S8Y/find_best_model.stderr.txt
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/c0c09ee657b1e27f2c5687e0e9aa8d70.simg
[Sun Jul  5 21:38:36 2020]
Finished job 935.
230 of 3292 steps (7%) done
[Sun Jul  5 21:38:36 2020]
Finished job 2874.
231 of 3292 steps (7%) done

[Sun Jul  5 21:38:36 2020]
rule get_seqs:
    input: /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ingroup.txt, /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/outgroup.txt
    output: per_gene/EOG091G00Z3/EOG091G00Z3.ingroup.fasta
    log: per_gene/EOG091G00Z3/get_seqs.stdout.txt, per_gene/EOG091G00Z3/get_seqs.stderr.txt
    jobid: 2474
    wildcards: BUSCO=EOG091G00Z3
    threads: 2


	basedir=$(pwd)
        cd per_gene/EOG091G00Z3
        
        bash $basedir/../scripts/fetch_seqs.sh EOG091G00Z3 /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ingroup.txt /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/outgroup.txt 1> ../../per_gene/EOG091G00Z3/get_seqs.stdout.txt 2> ../../per_gene/EOG091G00Z3/get_seqs.stderr.txt
	mv EOG091G00Z3.fasta $basedir/per_gene/EOG091G00Z3/EOG091G00Z3.ingroup.fasta
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/72476f9d9a5bd0627b4d721143a21354.simg

[Sun Jul  5 21:38:36 2020]
rule get_outgroups:
    input: per_gene/EOG091G0VIF/EOG091G0VIF.ingroup.fasta
    output: per_gene/EOG091G0VIF/EOG091G0VIF.orthodb.fasta, per_gene/EOG091G0VIF/EOG091G0VIF.outgroup.fasta
    log: per_gene/EOG091G0VIF/get_outgroups.stdout.txt, per_gene/EOG091G0VIF/get_outgroups.stderr.txt
    jobid: 2875
    wildcards: BUSCO=EOG091G0VIF


        #download fastas from Orhtodb for BUSCO id
        for i in {1..5}
        do
             wget "http://www.orthodb.org/fasta?query=EOG091G0VIF&level=33208" -O per_gene/EOG091G0VIF/EOG091G0VIF.orthodb.fasta 1> per_gene/EOG091G0VIF/get_outgroups.stdout.txt 2> per_gene/EOG091G0VIF/get_outgroups.stderr.txt && break || echo -e "try again ($i)" && sleep 15
        done

	#This is quick an dirty for now and just takes the first protein if there is more than one for an outgroup taxon
        bash ../scripts/download_outgroups.sh taxids.txt per_gene/EOG091G0VIF/EOG091G0VIF.orthodb.fasta > per_gene/EOG091G0VIF/EOG091G0VIF.outgroup.fasta
        

[Sun Jul  5 21:38:36 2020]
rule remove_empty:
    input: per_gene/EOG091G0K1G/ALICUT_EOG091G0K1G.clustalo.fasta
    output: per_gene/EOG091G0K1G/empty_check.done
    jobid: 1757
    wildcards: BUSCO=EOG091G0K1G


         if [ "$(cat per_gene/EOG091G0K1G/ALICUT_EOG091G0K1G.clustalo.fasta | grep -v ">" | sed 's/-//g' | grep "^$" | wc -l)" -gt 0 ]
         then
              cp per_gene/EOG091G0K1G/ALICUT_EOG091G0K1G.clustalo.fasta per_gene/EOG091G0K1G/ALICUT_EOG091G0K1G.clustalo.fasta.backup
              bash ../scripts/remove_empty.sh per_gene/EOG091G0K1G/ALICUT_EOG091G0K1G.clustalo.fasta.backup > per_gene/EOG091G0K1G/ALICUT_EOG091G0K1G.clustalo.fasta
         fi
         touch per_gene/EOG091G0K1G/empty_check.done
         
[Sun Jul  5 21:38:36 2020]
Finished job 1757.
232 of 3292 steps (7%) done
[Sun Jul  5 21:38:37 2020]
Finished job 2875.
233 of 3292 steps (7%) done

[Sun Jul  5 21:38:37 2020]
rule join_groups:
    input: per_gene/EOG091G0VIF/EOG091G0VIF.ingroup.fasta, per_gene/EOG091G0VIF/EOG091G0VIF.outgroup.fasta
    output: per_gene/EOG091G0VIF/EOG091G0VIF.fasta
    jobid: 2261
    wildcards: BUSCO=EOG091G0VIF


        cat per_gene/EOG091G0VIF/EOG091G0VIF.ingroup.fasta per_gene/EOG091G0VIF/EOG091G0VIF.outgroup.fasta > per_gene/EOG091G0VIF/EOG091G0VIF.fasta
        
[Sun Jul  5 21:38:37 2020]
Finished job 2261.
234 of 3292 steps (7%) done

[Sun Jul  5 21:38:37 2020]
rule MSA:
    input: per_gene/EOG091G0VIF/EOG091G0VIF.fasta
    output: per_gene/EOG091G0VIF/EOG091G0VIF.clustalo.fasta
    log: per_gene/EOG091G0VIF/MSA.stdout.txt, per_gene/EOG091G0VIF/MSA.stderr.txt
    jobid: 1642
    wildcards: BUSCO=EOG091G0VIF
    threads: 2


        clustalo -i per_gene/EOG091G0VIF/EOG091G0VIF.fasta -o per_gene/EOG091G0VIF/EOG091G0VIF.clustalo.fasta --threads=2 1> per_gene/EOG091G0VIF/MSA.stdout.txt 2> per_gene/EOG091G0VIF/MSA.stderr.txt
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/d68c9691725a7401923680874285c430.simg
[Sun Jul  5 21:38:38 2020]
Finished job 1642.
235 of 3292 steps (7%) done

[Sun Jul  5 21:38:39 2020]
rule score_and_cut:
    input: per_gene/EOG091G0VIF/EOG091G0VIF.clustalo.fasta
    output: per_gene/EOG091G0VIF/ALICUT_EOG091G0VIF.clustalo.fasta
    jobid: 819
    wildcards: BUSCO=EOG091G0VIF
    threads: 2


        cd per_gene/EOG091G0VIF
        Aliscore.pl -N -r 200000000000000000 -i ../../per_gene/EOG091G0VIF/EOG091G0VIF.clustalo.fasta &> aliscore.log
        ALICUT.pl -s &> alicut.log
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/63c88c27a0fa300f57066b0ef65fefcb.simg
[Sun Jul  5 21:38:45 2020]
Finished job 3248.
236 of 3292 steps (7%) done
[Sun Jul  5 21:38:45 2020]
Finished job 2698.
237 of 3292 steps (7%) done

[Sun Jul  5 21:38:45 2020]
rule find_best_model:
    input: per_gene/EOG091G0K1G/ALICUT_EOG091G0K1G.clustalo.fasta, per_gene/EOG091G0K1G/empty_check.done
    output: per_gene/EOG091G0K1G/EOG091G0K1G.best_model
    log: per_gene/EOG091G0K1G/find_best_model.stderr.txt
    jobid: 934
    wildcards: BUSCO=EOG091G0K1G
    threads: 2


        cd per_gene/EOG091G0K1G
        if [ ! -d find_best_model ]
        then
            mkdir find_best_model
        fi
        cd find_best_model
        ln -s ../../../per_gene/EOG091G0K1G/ALICUT_EOG091G0K1G.clustalo.fasta EOG091G0K1G.fasta
        ProteinModelSelection.pl EOG091G0K1G.fasta 1> ../../../per_gene/EOG091G0K1G/EOG091G0K1G.best_model 2> ../../../per_gene/EOG091G0K1G/find_best_model.stderr.txt
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/c0c09ee657b1e27f2c5687e0e9aa8d70.simg

[Sun Jul  5 21:38:45 2020]
rule get_outgroups:
    input: per_gene/EOG091G0R6Z/EOG091G0R6Z.ingroup.fasta
    output: per_gene/EOG091G0R6Z/EOG091G0R6Z.orthodb.fasta, per_gene/EOG091G0R6Z/EOG091G0R6Z.outgroup.fasta
    log: per_gene/EOG091G0R6Z/get_outgroups.stdout.txt, per_gene/EOG091G0R6Z/get_outgroups.stderr.txt
    jobid: 3249
    wildcards: BUSCO=EOG091G0R6Z


        #download fastas from Orhtodb for BUSCO id
        for i in {1..5}
        do
             wget "http://www.orthodb.org/fasta?query=EOG091G0R6Z&level=33208" -O per_gene/EOG091G0R6Z/EOG091G0R6Z.orthodb.fasta 1> per_gene/EOG091G0R6Z/get_outgroups.stdout.txt 2> per_gene/EOG091G0R6Z/get_outgroups.stderr.txt && break || echo -e "try again ($i)" && sleep 15
        done

	#This is quick an dirty for now and just takes the first protein if there is more than one for an outgroup taxon
        bash ../scripts/download_outgroups.sh taxids.txt per_gene/EOG091G0R6Z/EOG091G0R6Z.orthodb.fasta > per_gene/EOG091G0R6Z/EOG091G0R6Z.outgroup.fasta
        

[Sun Jul  5 21:38:45 2020]
rule get_outgroups:
    input: per_gene/EOG091G0GWO/EOG091G0GWO.ingroup.fasta
    output: per_gene/EOG091G0GWO/EOG091G0GWO.orthodb.fasta, per_gene/EOG091G0GWO/EOG091G0GWO.outgroup.fasta
    log: per_gene/EOG091G0GWO/get_outgroups.stdout.txt, per_gene/EOG091G0GWO/get_outgroups.stderr.txt
    jobid: 2699
    wildcards: BUSCO=EOG091G0GWO


        #download fastas from Orhtodb for BUSCO id
        for i in {1..5}
        do
             wget "http://www.orthodb.org/fasta?query=EOG091G0GWO&level=33208" -O per_gene/EOG091G0GWO/EOG091G0GWO.orthodb.fasta 1> per_gene/EOG091G0GWO/get_outgroups.stdout.txt 2> per_gene/EOG091G0GWO/get_outgroups.stderr.txt && break || echo -e "try again ($i)" && sleep 15
        done

	#This is quick an dirty for now and just takes the first protein if there is more than one for an outgroup taxon
        bash ../scripts/download_outgroups.sh taxids.txt per_gene/EOG091G0GWO/EOG091G0GWO.orthodb.fasta > per_gene/EOG091G0GWO/EOG091G0GWO.outgroup.fasta
        
[Sun Jul  5 21:38:46 2020]
Finished job 3249.
238 of 3292 steps (7%) done

[Sun Jul  5 21:38:46 2020]
rule join_groups:
    input: per_gene/EOG091G0R6Z/EOG091G0R6Z.ingroup.fasta, per_gene/EOG091G0R6Z/EOG091G0R6Z.outgroup.fasta
    output: per_gene/EOG091G0R6Z/EOG091G0R6Z.fasta
    jobid: 2448
    wildcards: BUSCO=EOG091G0R6Z


        cat per_gene/EOG091G0R6Z/EOG091G0R6Z.ingroup.fasta per_gene/EOG091G0R6Z/EOG091G0R6Z.outgroup.fasta > per_gene/EOG091G0R6Z/EOG091G0R6Z.fasta
        
[Sun Jul  5 21:38:46 2020]
Finished job 2448.
239 of 3292 steps (7%) done
[Sun Jul  5 21:38:47 2020]
Finished job 2699.
240 of 3292 steps (7%) done

[Sun Jul  5 21:38:47 2020]
rule join_groups:
    input: per_gene/EOG091G0GWO/EOG091G0GWO.ingroup.fasta, per_gene/EOG091G0GWO/EOG091G0GWO.outgroup.fasta
    output: per_gene/EOG091G0GWO/EOG091G0GWO.fasta
    jobid: 2173
    wildcards: BUSCO=EOG091G0GWO


        cat per_gene/EOG091G0GWO/EOG091G0GWO.ingroup.fasta per_gene/EOG091G0GWO/EOG091G0GWO.outgroup.fasta > per_gene/EOG091G0GWO/EOG091G0GWO.fasta
        
[Sun Jul  5 21:38:47 2020]
Finished job 2173.
241 of 3292 steps (7%) done

[Sun Jul  5 21:38:47 2020]
rule MSA:
    input: per_gene/EOG091G0GWO/EOG091G0GWO.fasta
    output: per_gene/EOG091G0GWO/EOG091G0GWO.clustalo.fasta
    log: per_gene/EOG091G0GWO/MSA.stdout.txt, per_gene/EOG091G0GWO/MSA.stderr.txt
    jobid: 1466
    wildcards: BUSCO=EOG091G0GWO
    threads: 2


        clustalo -i per_gene/EOG091G0GWO/EOG091G0GWO.fasta -o per_gene/EOG091G0GWO/EOG091G0GWO.clustalo.fasta --threads=2 1> per_gene/EOG091G0GWO/MSA.stdout.txt 2> per_gene/EOG091G0GWO/MSA.stderr.txt
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/d68c9691725a7401923680874285c430.simg
[Sun Jul  5 21:38:48 2020]
Finished job 1466.
242 of 3292 steps (7%) done

[Sun Jul  5 21:38:48 2020]
rule score_and_cut:
    input: per_gene/EOG091G0GWO/EOG091G0GWO.clustalo.fasta
    output: per_gene/EOG091G0GWO/ALICUT_EOG091G0GWO.clustalo.fasta
    jobid: 643
    wildcards: BUSCO=EOG091G0GWO
    threads: 2


        cd per_gene/EOG091G0GWO
        Aliscore.pl -N -r 200000000000000000 -i ../../per_gene/EOG091G0GWO/EOG091G0GWO.clustalo.fasta &> aliscore.log
        ALICUT.pl -s &> alicut.log
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/63c88c27a0fa300f57066b0ef65fefcb.simg
[Sun Jul  5 21:38:48 2020]
Finished job 819.
243 of 3292 steps (7%) done

[Sun Jul  5 21:38:48 2020]
rule MSA:
    input: per_gene/EOG091G0R6Z/EOG091G0R6Z.fasta
    output: per_gene/EOG091G0R6Z/EOG091G0R6Z.clustalo.fasta
    log: per_gene/EOG091G0R6Z/MSA.stdout.txt, per_gene/EOG091G0R6Z/MSA.stderr.txt
    jobid: 2016
    wildcards: BUSCO=EOG091G0R6Z
    threads: 2


        clustalo -i per_gene/EOG091G0R6Z/EOG091G0R6Z.fasta -o per_gene/EOG091G0R6Z/EOG091G0R6Z.clustalo.fasta --threads=2 1> per_gene/EOG091G0R6Z/MSA.stdout.txt 2> per_gene/EOG091G0R6Z/MSA.stderr.txt
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/d68c9691725a7401923680874285c430.simg
[Sun Jul  5 21:38:48 2020]
Finished job 2016.
244 of 3292 steps (7%) done

[Sun Jul  5 21:38:48 2020]
rule score_and_cut:
    input: per_gene/EOG091G0R6Z/EOG091G0R6Z.clustalo.fasta
    output: per_gene/EOG091G0R6Z/ALICUT_EOG091G0R6Z.clustalo.fasta
    jobid: 1193
    wildcards: BUSCO=EOG091G0R6Z
    threads: 2


        cd per_gene/EOG091G0R6Z
        Aliscore.pl -N -r 200000000000000000 -i ../../per_gene/EOG091G0R6Z/EOG091G0R6Z.clustalo.fasta &> aliscore.log
        ALICUT.pl -s &> alicut.log
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/63c88c27a0fa300f57066b0ef65fefcb.simg
[Sun Jul  5 21:38:50 2020]
Finished job 2474.
245 of 3292 steps (7%) done

[Sun Jul  5 21:38:50 2020]
rule remove_empty:
    input: per_gene/EOG091G0VIF/ALICUT_EOG091G0VIF.clustalo.fasta
    output: per_gene/EOG091G0VIF/empty_check.done
    jobid: 1641
    wildcards: BUSCO=EOG091G0VIF


         if [ "$(cat per_gene/EOG091G0VIF/ALICUT_EOG091G0VIF.clustalo.fasta | grep -v ">" | sed 's/-//g' | grep "^$" | wc -l)" -gt 0 ]
         then
              cp per_gene/EOG091G0VIF/ALICUT_EOG091G0VIF.clustalo.fasta per_gene/EOG091G0VIF/ALICUT_EOG091G0VIF.clustalo.fasta.backup
              bash ../scripts/remove_empty.sh per_gene/EOG091G0VIF/ALICUT_EOG091G0VIF.clustalo.fasta.backup > per_gene/EOG091G0VIF/ALICUT_EOG091G0VIF.clustalo.fasta
         fi
         touch per_gene/EOG091G0VIF/empty_check.done
         

[Sun Jul  5 21:38:50 2020]
rule get_outgroups:
    input: per_gene/EOG091G00Z3/EOG091G00Z3.ingroup.fasta
    output: per_gene/EOG091G00Z3/EOG091G00Z3.orthodb.fasta, per_gene/EOG091G00Z3/EOG091G00Z3.outgroup.fasta
    log: per_gene/EOG091G00Z3/get_outgroups.stdout.txt, per_gene/EOG091G00Z3/get_outgroups.stderr.txt
    jobid: 2475
    wildcards: BUSCO=EOG091G00Z3


        #download fastas from Orhtodb for BUSCO id
        for i in {1..5}
        do
             wget "http://www.orthodb.org/fasta?query=EOG091G00Z3&level=33208" -O per_gene/EOG091G00Z3/EOG091G00Z3.orthodb.fasta 1> per_gene/EOG091G00Z3/get_outgroups.stdout.txt 2> per_gene/EOG091G00Z3/get_outgroups.stderr.txt && break || echo -e "try again ($i)" && sleep 15
        done

	#This is quick an dirty for now and just takes the first protein if there is more than one for an outgroup taxon
        bash ../scripts/download_outgroups.sh taxids.txt per_gene/EOG091G00Z3/EOG091G00Z3.orthodb.fasta > per_gene/EOG091G00Z3/EOG091G00Z3.outgroup.fasta
        
[Sun Jul  5 21:38:50 2020]
Finished job 1641.
246 of 3292 steps (7%) done
[Sun Jul  5 21:38:51 2020]
Finished job 2475.
247 of 3292 steps (8%) done

[Sun Jul  5 21:38:51 2020]
rule join_groups:
    input: per_gene/EOG091G00Z3/EOG091G00Z3.ingroup.fasta, per_gene/EOG091G00Z3/EOG091G00Z3.outgroup.fasta
    output: per_gene/EOG091G00Z3/EOG091G00Z3.fasta
    jobid: 2061
    wildcards: BUSCO=EOG091G00Z3


        cat per_gene/EOG091G00Z3/EOG091G00Z3.ingroup.fasta per_gene/EOG091G00Z3/EOG091G00Z3.outgroup.fasta > per_gene/EOG091G00Z3/EOG091G00Z3.fasta
        
[Sun Jul  5 21:38:51 2020]
Finished job 2061.
248 of 3292 steps (8%) done

[Sun Jul  5 21:38:51 2020]
rule MSA:
    input: per_gene/EOG091G00Z3/EOG091G00Z3.fasta
    output: per_gene/EOG091G00Z3/EOG091G00Z3.clustalo.fasta
    log: per_gene/EOG091G00Z3/MSA.stdout.txt, per_gene/EOG091G00Z3/MSA.stderr.txt
    jobid: 1242
    wildcards: BUSCO=EOG091G00Z3
    threads: 2


        clustalo -i per_gene/EOG091G00Z3/EOG091G00Z3.fasta -o per_gene/EOG091G00Z3/EOG091G00Z3.clustalo.fasta --threads=2 1> per_gene/EOG091G00Z3/MSA.stdout.txt 2> per_gene/EOG091G00Z3/MSA.stderr.txt
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/d68c9691725a7401923680874285c430.simg
[Sun Jul  5 21:38:56 2020]
Finished job 1242.
249 of 3292 steps (8%) done

[Sun Jul  5 21:38:56 2020]
rule score_and_cut:
    input: per_gene/EOG091G00Z3/EOG091G00Z3.clustalo.fasta
    output: per_gene/EOG091G00Z3/ALICUT_EOG091G00Z3.clustalo.fasta
    jobid: 419
    wildcards: BUSCO=EOG091G00Z3
    threads: 2


        cd per_gene/EOG091G00Z3
        Aliscore.pl -N -r 200000000000000000 -i ../../per_gene/EOG091G00Z3/EOG091G00Z3.clustalo.fasta &> aliscore.log
        ALICUT.pl -s &> alicut.log
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/63c88c27a0fa300f57066b0ef65fefcb.simg
[Sun Jul  5 21:38:56 2020]
Finished job 1193.
250 of 3292 steps (8%) done

[Sun Jul  5 21:38:56 2020]
rule remove_empty:
    input: per_gene/EOG091G0R6Z/ALICUT_EOG091G0R6Z.clustalo.fasta
    output: per_gene/EOG091G0R6Z/empty_check.done
    jobid: 2015
    wildcards: BUSCO=EOG091G0R6Z


         if [ "$(cat per_gene/EOG091G0R6Z/ALICUT_EOG091G0R6Z.clustalo.fasta | grep -v ">" | sed 's/-//g' | grep "^$" | wc -l)" -gt 0 ]
         then
              cp per_gene/EOG091G0R6Z/ALICUT_EOG091G0R6Z.clustalo.fasta per_gene/EOG091G0R6Z/ALICUT_EOG091G0R6Z.clustalo.fasta.backup
              bash ../scripts/remove_empty.sh per_gene/EOG091G0R6Z/ALICUT_EOG091G0R6Z.clustalo.fasta.backup > per_gene/EOG091G0R6Z/ALICUT_EOG091G0R6Z.clustalo.fasta
         fi
         touch per_gene/EOG091G0R6Z/empty_check.done
         
[Sun Jul  5 21:38:56 2020]
Finished job 2015.
251 of 3292 steps (8%) done

[Sun Jul  5 21:38:56 2020]
rule find_best_model:
    input: per_gene/EOG091G0R6Z/ALICUT_EOG091G0R6Z.clustalo.fasta, per_gene/EOG091G0R6Z/empty_check.done
    output: per_gene/EOG091G0R6Z/EOG091G0R6Z.best_model
    log: per_gene/EOG091G0R6Z/find_best_model.stderr.txt
    jobid: 1192
    wildcards: BUSCO=EOG091G0R6Z
    threads: 2


        cd per_gene/EOG091G0R6Z
        if [ ! -d find_best_model ]
        then
            mkdir find_best_model
        fi
        cd find_best_model
        ln -s ../../../per_gene/EOG091G0R6Z/ALICUT_EOG091G0R6Z.clustalo.fasta EOG091G0R6Z.fasta
        ProteinModelSelection.pl EOG091G0R6Z.fasta 1> ../../../per_gene/EOG091G0R6Z/EOG091G0R6Z.best_model 2> ../../../per_gene/EOG091G0R6Z/find_best_model.stderr.txt
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/c0c09ee657b1e27f2c5687e0e9aa8d70.simg
[Sun Jul  5 21:38:57 2020]
Finished job 643.
252 of 3292 steps (8%) done

[Sun Jul  5 21:38:57 2020]
rule remove_empty:
    input: per_gene/EOG091G0GWO/ALICUT_EOG091G0GWO.clustalo.fasta
    output: per_gene/EOG091G0GWO/empty_check.done
    jobid: 1465
    wildcards: BUSCO=EOG091G0GWO


         if [ "$(cat per_gene/EOG091G0GWO/ALICUT_EOG091G0GWO.clustalo.fasta | grep -v ">" | sed 's/-//g' | grep "^$" | wc -l)" -gt 0 ]
         then
              cp per_gene/EOG091G0GWO/ALICUT_EOG091G0GWO.clustalo.fasta per_gene/EOG091G0GWO/ALICUT_EOG091G0GWO.clustalo.fasta.backup
              bash ../scripts/remove_empty.sh per_gene/EOG091G0GWO/ALICUT_EOG091G0GWO.clustalo.fasta.backup > per_gene/EOG091G0GWO/ALICUT_EOG091G0GWO.clustalo.fasta
         fi
         touch per_gene/EOG091G0GWO/empty_check.done
         
[Sun Jul  5 21:38:57 2020]
Finished job 1465.
253 of 3292 steps (8%) done

[Sun Jul  5 21:38:57 2020]
rule find_best_model:
    input: per_gene/EOG091G0GWO/ALICUT_EOG091G0GWO.clustalo.fasta, per_gene/EOG091G0GWO/empty_check.done
    output: per_gene/EOG091G0GWO/EOG091G0GWO.best_model
    log: per_gene/EOG091G0GWO/find_best_model.stderr.txt
    jobid: 642
    wildcards: BUSCO=EOG091G0GWO
    threads: 2


        cd per_gene/EOG091G0GWO
        if [ ! -d find_best_model ]
        then
            mkdir find_best_model
        fi
        cd find_best_model
        ln -s ../../../per_gene/EOG091G0GWO/ALICUT_EOG091G0GWO.clustalo.fasta EOG091G0GWO.fasta
        ProteinModelSelection.pl EOG091G0GWO.fasta 1> ../../../per_gene/EOG091G0GWO/EOG091G0GWO.best_model 2> ../../../per_gene/EOG091G0GWO/find_best_model.stderr.txt
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/c0c09ee657b1e27f2c5687e0e9aa8d70.simg
[Sun Jul  5 21:38:59 2020]
Finished job 696.
254 of 3292 steps (8%) done

[Sun Jul  5 21:38:59 2020]
rule infer_single_ML:
    input: per_gene/EOG091G0LT1/EOG091G0LT1.best_model, per_gene/EOG091G0LT1/ALICUT_EOG091G0LT1.clustalo.fasta
    output: per_gene/EOG091G0LT1/EOG091G0LT1.raxml.done
    log: per_gene/EOG091G0LT1/infer_single_ML.stdout.txt, per_gene/EOG091G0LT1/infer_single_ML.stderr.txt
    jobid: 142
    wildcards: BUSCO=EOG091G0LT1
    threads: 2


        cd per_gene/EOG091G0LT1
	count=$(cat ../../per_gene/EOG091G0LT1/ALICUT_EOG091G0LT1.clustalo.fasta | grep ">" | wc -l)
	if [ "$count" -gt 5 ]
        then
		RAxMLmodel=$(cat ../../per_gene/EOG091G0LT1/EOG091G0LT1.best_model | grep "Best" | cut -d ":" -f 2 | tr -d '[:space:]')
                if [ "$(ls -1 | grep "^RAxML" | wc -l)" -ne 0 ]
		then
			rm RAxML*
		fi
        	raxml -f a -T 2 -m PROTGAMMA$RAxMLmodel         	-p 12345 -x 12345 -# 100         	-s ../../per_gene/EOG091G0LT1/ALICUT_EOG091G0LT1.clustalo.fasta -n EOG091G0LT1.clustalo.aln.ALICUT.$RAxMLmodel 		1> ../../per_gene/EOG091G0LT1/infer_single_ML.stdout.txt 2> ../../per_gene/EOG091G0LT1/infer_single_ML.stderr.txt
	else
		echo "fasta file per_gene/EOG091G0LT1/ALICUT_EOG091G0LT1.clustalo.fasta contains fewer than 5 sequences - skipped" > ../../per_gene/EOG091G0LT1/infer_single_ML.stdout.txt
		touch raxml.skipped
	fi
        touch ../../per_gene/EOG091G0LT1/EOG091G0LT1.raxml.done
        
[33mJob counts:
	count	jobs
	1	infer_single_ML
	1[0m
[33m
        cd per_gene/EOG091G0LT1
	count=$(cat ../../per_gene/EOG091G0LT1/ALICUT_EOG091G0LT1.clustalo.fasta | grep ">" | wc -l)
	if [ "$count" -gt 5 ]
        then
		RAxMLmodel=$(cat ../../per_gene/EOG091G0LT1/EOG091G0LT1.best_model | grep "Best" | cut -d ":" -f 2 | tr -d '[:space:]')
                if [ "$(ls -1 | grep "^RAxML" | wc -l)" -ne 0 ]
		then
			rm RAxML*
		fi
        	raxml -f a -T 2 -m PROTGAMMA$RAxMLmodel         	-p 12345 -x 12345 -# 100         	-s ../../per_gene/EOG091G0LT1/ALICUT_EOG091G0LT1.clustalo.fasta -n EOG091G0LT1.clustalo.aln.ALICUT.$RAxMLmodel 		1> ../../per_gene/EOG091G0LT1/infer_single_ML.stdout.txt 2> ../../per_gene/EOG091G0LT1/infer_single_ML.stderr.txt
	else
		echo "fasta file per_gene/EOG091G0LT1/ALICUT_EOG091G0LT1.clustalo.fasta contains fewer than 5 sequences - skipped" > ../../per_gene/EOG091G0LT1/infer_single_ML.stdout.txt
		touch raxml.skipped
	fi
        touch ../../per_gene/EOG091G0LT1/EOG091G0LT1.raxml.done
        [0m
[Sun Jul  5 21:39:03 2020]
Finished job 812.
255 of 3292 steps (8%) done

[Sun Jul  5 21:39:03 2020]
rule infer_single_ML:
    input: per_gene/EOG091G0UQZ/EOG091G0UQZ.best_model, per_gene/EOG091G0UQZ/ALICUT_EOG091G0UQZ.clustalo.fasta
    output: per_gene/EOG091G0UQZ/EOG091G0UQZ.raxml.done
    log: per_gene/EOG091G0UQZ/infer_single_ML.stdout.txt, per_gene/EOG091G0UQZ/infer_single_ML.stderr.txt
    jobid: 200
    wildcards: BUSCO=EOG091G0UQZ
    threads: 2


        cd per_gene/EOG091G0UQZ
	count=$(cat ../../per_gene/EOG091G0UQZ/ALICUT_EOG091G0UQZ.clustalo.fasta | grep ">" | wc -l)
	if [ "$count" -gt 5 ]
        then
		RAxMLmodel=$(cat ../../per_gene/EOG091G0UQZ/EOG091G0UQZ.best_model | grep "Best" | cut -d ":" -f 2 | tr -d '[:space:]')
                if [ "$(ls -1 | grep "^RAxML" | wc -l)" -ne 0 ]
		then
			rm RAxML*
		fi
        	raxml -f a -T 2 -m PROTGAMMA$RAxMLmodel         	-p 12345 -x 12345 -# 100         	-s ../../per_gene/EOG091G0UQZ/ALICUT_EOG091G0UQZ.clustalo.fasta -n EOG091G0UQZ.clustalo.aln.ALICUT.$RAxMLmodel 		1> ../../per_gene/EOG091G0UQZ/infer_single_ML.stdout.txt 2> ../../per_gene/EOG091G0UQZ/infer_single_ML.stderr.txt
	else
		echo "fasta file per_gene/EOG091G0UQZ/ALICUT_EOG091G0UQZ.clustalo.fasta contains fewer than 5 sequences - skipped" > ../../per_gene/EOG091G0UQZ/infer_single_ML.stdout.txt
		touch raxml.skipped
	fi
        touch ../../per_gene/EOG091G0UQZ/EOG091G0UQZ.raxml.done
        
[33mJob counts:
	count	jobs
	1	infer_single_ML
	1[0m
[33m
        cd per_gene/EOG091G0UQZ
	count=$(cat ../../per_gene/EOG091G0UQZ/ALICUT_EOG091G0UQZ.clustalo.fasta | grep ">" | wc -l)
	if [ "$count" -gt 5 ]
        then
		RAxMLmodel=$(cat ../../per_gene/EOG091G0UQZ/EOG091G0UQZ.best_model | grep "Best" | cut -d ":" -f 2 | tr -d '[:space:]')
                if [ "$(ls -1 | grep "^RAxML" | wc -l)" -ne 0 ]
		then
			rm RAxML*
		fi
        	raxml -f a -T 2 -m PROTGAMMA$RAxMLmodel         	-p 12345 -x 12345 -# 100         	-s ../../per_gene/EOG091G0UQZ/ALICUT_EOG091G0UQZ.clustalo.fasta -n EOG091G0UQZ.clustalo.aln.ALICUT.$RAxMLmodel 		1> ../../per_gene/EOG091G0UQZ/infer_single_ML.stdout.txt 2> ../../per_gene/EOG091G0UQZ/infer_single_ML.stderr.txt
	else
		echo "fasta file per_gene/EOG091G0UQZ/ALICUT_EOG091G0UQZ.clustalo.fasta contains fewer than 5 sequences - skipped" > ../../per_gene/EOG091G0UQZ/infer_single_ML.stdout.txt
		touch raxml.skipped
	fi
        touch ../../per_gene/EOG091G0UQZ/EOG091G0UQZ.raxml.done
        [0m
[Sun Jul  5 21:39:06 2020]
Finished job 786.
256 of 3292 steps (8%) done

[Sun Jul  5 21:39:06 2020]
rule infer_single_ML:
    input: per_gene/EOG091G0S8Y/EOG091G0S8Y.best_model, per_gene/EOG091G0S8Y/ALICUT_EOG091G0S8Y.clustalo.fasta
    output: per_gene/EOG091G0S8Y/EOG091G0S8Y.raxml.done
    log: per_gene/EOG091G0S8Y/infer_single_ML.stdout.txt, per_gene/EOG091G0S8Y/infer_single_ML.stderr.txt
    jobid: 187
    wildcards: BUSCO=EOG091G0S8Y
    threads: 2


        cd per_gene/EOG091G0S8Y
	count=$(cat ../../per_gene/EOG091G0S8Y/ALICUT_EOG091G0S8Y.clustalo.fasta | grep ">" | wc -l)
	if [ "$count" -gt 5 ]
        then
		RAxMLmodel=$(cat ../../per_gene/EOG091G0S8Y/EOG091G0S8Y.best_model | grep "Best" | cut -d ":" -f 2 | tr -d '[:space:]')
                if [ "$(ls -1 | grep "^RAxML" | wc -l)" -ne 0 ]
		then
			rm RAxML*
		fi
        	raxml -f a -T 2 -m PROTGAMMA$RAxMLmodel         	-p 12345 -x 12345 -# 100         	-s ../../per_gene/EOG091G0S8Y/ALICUT_EOG091G0S8Y.clustalo.fasta -n EOG091G0S8Y.clustalo.aln.ALICUT.$RAxMLmodel 		1> ../../per_gene/EOG091G0S8Y/infer_single_ML.stdout.txt 2> ../../per_gene/EOG091G0S8Y/infer_single_ML.stderr.txt
	else
		echo "fasta file per_gene/EOG091G0S8Y/ALICUT_EOG091G0S8Y.clustalo.fasta contains fewer than 5 sequences - skipped" > ../../per_gene/EOG091G0S8Y/infer_single_ML.stdout.txt
		touch raxml.skipped
	fi
        touch ../../per_gene/EOG091G0S8Y/EOG091G0S8Y.raxml.done
        
[33mJob counts:
	count	jobs
	1	infer_single_ML
	1[0m
[33m
        cd per_gene/EOG091G0S8Y
	count=$(cat ../../per_gene/EOG091G0S8Y/ALICUT_EOG091G0S8Y.clustalo.fasta | grep ">" | wc -l)
	if [ "$count" -gt 5 ]
        then
		RAxMLmodel=$(cat ../../per_gene/EOG091G0S8Y/EOG091G0S8Y.best_model | grep "Best" | cut -d ":" -f 2 | tr -d '[:space:]')
                if [ "$(ls -1 | grep "^RAxML" | wc -l)" -ne 0 ]
		then
			rm RAxML*
		fi
        	raxml -f a -T 2 -m PROTGAMMA$RAxMLmodel         	-p 12345 -x 12345 -# 100         	-s ../../per_gene/EOG091G0S8Y/ALICUT_EOG091G0S8Y.clustalo.fasta -n EOG091G0S8Y.clustalo.aln.ALICUT.$RAxMLmodel 		1> ../../per_gene/EOG091G0S8Y/infer_single_ML.stdout.txt 2> ../../per_gene/EOG091G0S8Y/infer_single_ML.stderr.txt
	else
		echo "fasta file per_gene/EOG091G0S8Y/ALICUT_EOG091G0S8Y.clustalo.fasta contains fewer than 5 sequences - skipped" > ../../per_gene/EOG091G0S8Y/infer_single_ML.stdout.txt
		touch raxml.skipped
	fi
        touch ../../per_gene/EOG091G0S8Y/EOG091G0S8Y.raxml.done
        [0m
[Sun Jul  5 21:39:07 2020]
Finished job 419.
257 of 3292 steps (8%) done

[Sun Jul  5 21:39:07 2020]
rule remove_empty:
    input: per_gene/EOG091G00Z3/ALICUT_EOG091G00Z3.clustalo.fasta
    output: per_gene/EOG091G00Z3/empty_check.done
    jobid: 1241
    wildcards: BUSCO=EOG091G00Z3


         if [ "$(cat per_gene/EOG091G00Z3/ALICUT_EOG091G00Z3.clustalo.fasta | grep -v ">" | sed 's/-//g' | grep "^$" | wc -l)" -gt 0 ]
         then
              cp per_gene/EOG091G00Z3/ALICUT_EOG091G00Z3.clustalo.fasta per_gene/EOG091G00Z3/ALICUT_EOG091G00Z3.clustalo.fasta.backup
              bash ../scripts/remove_empty.sh per_gene/EOG091G00Z3/ALICUT_EOG091G00Z3.clustalo.fasta.backup > per_gene/EOG091G00Z3/ALICUT_EOG091G00Z3.clustalo.fasta
         fi
         touch per_gene/EOG091G00Z3/empty_check.done
         
[Sun Jul  5 21:39:07 2020]
Finished job 1241.
258 of 3292 steps (8%) done

[Sun Jul  5 21:39:07 2020]
rule find_best_model:
    input: per_gene/EOG091G00Z3/ALICUT_EOG091G00Z3.clustalo.fasta, per_gene/EOG091G00Z3/empty_check.done
    output: per_gene/EOG091G00Z3/EOG091G00Z3.best_model
    log: per_gene/EOG091G00Z3/find_best_model.stderr.txt
    jobid: 418
    wildcards: BUSCO=EOG091G00Z3
    threads: 2


        cd per_gene/EOG091G00Z3
        if [ ! -d find_best_model ]
        then
            mkdir find_best_model
        fi
        cd find_best_model
        ln -s ../../../per_gene/EOG091G00Z3/ALICUT_EOG091G00Z3.clustalo.fasta EOG091G00Z3.fasta
        ProteinModelSelection.pl EOG091G00Z3.fasta 1> ../../../per_gene/EOG091G00Z3/EOG091G00Z3.best_model 2> ../../../per_gene/EOG091G00Z3/find_best_model.stderr.txt
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/c0c09ee657b1e27f2c5687e0e9aa8d70.simg
[Sun Jul  5 21:39:15 2020]
Finished job 394.
259 of 3292 steps (8%) done

[Sun Jul  5 21:39:15 2020]
rule find_best_model:
    input: per_gene/EOG091G0VIF/ALICUT_EOG091G0VIF.clustalo.fasta, per_gene/EOG091G0VIF/empty_check.done
    output: per_gene/EOG091G0VIF/EOG091G0VIF.best_model
    log: per_gene/EOG091G0VIF/find_best_model.stderr.txt
    jobid: 818
    wildcards: BUSCO=EOG091G0VIF
    threads: 2


        cd per_gene/EOG091G0VIF
        if [ ! -d find_best_model ]
        then
            mkdir find_best_model
        fi
        cd find_best_model
        ln -s ../../../per_gene/EOG091G0VIF/ALICUT_EOG091G0VIF.clustalo.fasta EOG091G0VIF.fasta
        ProteinModelSelection.pl EOG091G0VIF.fasta 1> ../../../per_gene/EOG091G0VIF/EOG091G0VIF.best_model 2> ../../../per_gene/EOG091G0VIF/find_best_model.stderr.txt
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/c0c09ee657b1e27f2c5687e0e9aa8d70.simg
[Sun Jul  5 21:39:20 2020]
Finished job 217.
260 of 3292 steps (8%) done

[Sun Jul  5 21:39:20 2020]
rule get_seqs:
    input: /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ingroup.txt, /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/outgroup.txt
    output: per_gene/EOG091G0MSB/EOG091G0MSB.ingroup.fasta
    log: per_gene/EOG091G0MSB/get_seqs.stdout.txt, per_gene/EOG091G0MSB/get_seqs.stderr.txt
    jobid: 2770
    wildcards: BUSCO=EOG091G0MSB
    threads: 2


	basedir=$(pwd)
        cd per_gene/EOG091G0MSB
        
        bash $basedir/../scripts/fetch_seqs.sh EOG091G0MSB /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ingroup.txt /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/outgroup.txt 1> ../../per_gene/EOG091G0MSB/get_seqs.stdout.txt 2> ../../per_gene/EOG091G0MSB/get_seqs.stderr.txt
	mv EOG091G0MSB.fasta $basedir/per_gene/EOG091G0MSB/EOG091G0MSB.ingroup.fasta
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/72476f9d9a5bd0627b4d721143a21354.simg
[Sun Jul  5 21:39:26 2020]
Finished job 934.
261 of 3292 steps (8%) done

[Sun Jul  5 21:39:26 2020]
rule infer_single_ML:
    input: per_gene/EOG091G0K1G/EOG091G0K1G.best_model, per_gene/EOG091G0K1G/ALICUT_EOG091G0K1G.clustalo.fasta
    output: per_gene/EOG091G0K1G/EOG091G0K1G.raxml.done
    log: per_gene/EOG091G0K1G/infer_single_ML.stdout.txt, per_gene/EOG091G0K1G/infer_single_ML.stderr.txt
    jobid: 261
    wildcards: BUSCO=EOG091G0K1G
    threads: 2


        cd per_gene/EOG091G0K1G
	count=$(cat ../../per_gene/EOG091G0K1G/ALICUT_EOG091G0K1G.clustalo.fasta | grep ">" | wc -l)
	if [ "$count" -gt 5 ]
        then
		RAxMLmodel=$(cat ../../per_gene/EOG091G0K1G/EOG091G0K1G.best_model | grep "Best" | cut -d ":" -f 2 | tr -d '[:space:]')
                if [ "$(ls -1 | grep "^RAxML" | wc -l)" -ne 0 ]
		then
			rm RAxML*
		fi
        	raxml -f a -T 2 -m PROTGAMMA$RAxMLmodel         	-p 12345 -x 12345 -# 100         	-s ../../per_gene/EOG091G0K1G/ALICUT_EOG091G0K1G.clustalo.fasta -n EOG091G0K1G.clustalo.aln.ALICUT.$RAxMLmodel 		1> ../../per_gene/EOG091G0K1G/infer_single_ML.stdout.txt 2> ../../per_gene/EOG091G0K1G/infer_single_ML.stderr.txt
	else
		echo "fasta file per_gene/EOG091G0K1G/ALICUT_EOG091G0K1G.clustalo.fasta contains fewer than 5 sequences - skipped" > ../../per_gene/EOG091G0K1G/infer_single_ML.stdout.txt
		touch raxml.skipped
	fi
        touch ../../per_gene/EOG091G0K1G/EOG091G0K1G.raxml.done
        
[33mJob counts:
	count	jobs
	1	infer_single_ML
	1[0m
[33m
        cd per_gene/EOG091G0K1G
	count=$(cat ../../per_gene/EOG091G0K1G/ALICUT_EOG091G0K1G.clustalo.fasta | grep ">" | wc -l)
	if [ "$count" -gt 5 ]
        then
		RAxMLmodel=$(cat ../../per_gene/EOG091G0K1G/EOG091G0K1G.best_model | grep "Best" | cut -d ":" -f 2 | tr -d '[:space:]')
                if [ "$(ls -1 | grep "^RAxML" | wc -l)" -ne 0 ]
		then
			rm RAxML*
		fi
        	raxml -f a -T 2 -m PROTGAMMA$RAxMLmodel         	-p 12345 -x 12345 -# 100         	-s ../../per_gene/EOG091G0K1G/ALICUT_EOG091G0K1G.clustalo.fasta -n EOG091G0K1G.clustalo.aln.ALICUT.$RAxMLmodel 		1> ../../per_gene/EOG091G0K1G/infer_single_ML.stdout.txt 2> ../../per_gene/EOG091G0K1G/infer_single_ML.stderr.txt
	else
		echo "fasta file per_gene/EOG091G0K1G/ALICUT_EOG091G0K1G.clustalo.fasta contains fewer than 5 sequences - skipped" > ../../per_gene/EOG091G0K1G/infer_single_ML.stdout.txt
		touch raxml.skipped
	fi
        touch ../../per_gene/EOG091G0K1G/EOG091G0K1G.raxml.done
        [0m
[Sun Jul  5 21:39:33 2020]
Finished job 1192.
262 of 3292 steps (8%) done

[Sun Jul  5 21:39:33 2020]
rule infer_single_ML:
    input: per_gene/EOG091G0R6Z/EOG091G0R6Z.best_model, per_gene/EOG091G0R6Z/ALICUT_EOG091G0R6Z.clustalo.fasta
    output: per_gene/EOG091G0R6Z/EOG091G0R6Z.raxml.done
    log: per_gene/EOG091G0R6Z/infer_single_ML.stdout.txt, per_gene/EOG091G0R6Z/infer_single_ML.stderr.txt
    jobid: 390
    wildcards: BUSCO=EOG091G0R6Z
    threads: 2


        cd per_gene/EOG091G0R6Z
	count=$(cat ../../per_gene/EOG091G0R6Z/ALICUT_EOG091G0R6Z.clustalo.fasta | grep ">" | wc -l)
	if [ "$count" -gt 5 ]
        then
		RAxMLmodel=$(cat ../../per_gene/EOG091G0R6Z/EOG091G0R6Z.best_model | grep "Best" | cut -d ":" -f 2 | tr -d '[:space:]')
                if [ "$(ls -1 | grep "^RAxML" | wc -l)" -ne 0 ]
		then
			rm RAxML*
		fi
        	raxml -f a -T 2 -m PROTGAMMA$RAxMLmodel         	-p 12345 -x 12345 -# 100         	-s ../../per_gene/EOG091G0R6Z/ALICUT_EOG091G0R6Z.clustalo.fasta -n EOG091G0R6Z.clustalo.aln.ALICUT.$RAxMLmodel 		1> ../../per_gene/EOG091G0R6Z/infer_single_ML.stdout.txt 2> ../../per_gene/EOG091G0R6Z/infer_single_ML.stderr.txt
	else
		echo "fasta file per_gene/EOG091G0R6Z/ALICUT_EOG091G0R6Z.clustalo.fasta contains fewer than 5 sequences - skipped" > ../../per_gene/EOG091G0R6Z/infer_single_ML.stdout.txt
		touch raxml.skipped
	fi
        touch ../../per_gene/EOG091G0R6Z/EOG091G0R6Z.raxml.done
        
[33mJob counts:
	count	jobs
	1	infer_single_ML
	1[0m
[33m
        cd per_gene/EOG091G0R6Z
	count=$(cat ../../per_gene/EOG091G0R6Z/ALICUT_EOG091G0R6Z.clustalo.fasta | grep ">" | wc -l)
	if [ "$count" -gt 5 ]
        then
		RAxMLmodel=$(cat ../../per_gene/EOG091G0R6Z/EOG091G0R6Z.best_model | grep "Best" | cut -d ":" -f 2 | tr -d '[:space:]')
                if [ "$(ls -1 | grep "^RAxML" | wc -l)" -ne 0 ]
		then
			rm RAxML*
		fi
        	raxml -f a -T 2 -m PROTGAMMA$RAxMLmodel         	-p 12345 -x 12345 -# 100         	-s ../../per_gene/EOG091G0R6Z/ALICUT_EOG091G0R6Z.clustalo.fasta -n EOG091G0R6Z.clustalo.aln.ALICUT.$RAxMLmodel 		1> ../../per_gene/EOG091G0R6Z/infer_single_ML.stdout.txt 2> ../../per_gene/EOG091G0R6Z/infer_single_ML.stderr.txt
	else
		echo "fasta file per_gene/EOG091G0R6Z/ALICUT_EOG091G0R6Z.clustalo.fasta contains fewer than 5 sequences - skipped" > ../../per_gene/EOG091G0R6Z/infer_single_ML.stdout.txt
		touch raxml.skipped
	fi
        touch ../../per_gene/EOG091G0R6Z/EOG091G0R6Z.raxml.done
        [0m
[Sun Jul  5 21:39:35 2020]
Finished job 2770.
263 of 3292 steps (8%) done

[Sun Jul  5 21:39:35 2020]
rule get_outgroups:
    input: per_gene/EOG091G0MSB/EOG091G0MSB.ingroup.fasta
    output: per_gene/EOG091G0MSB/EOG091G0MSB.orthodb.fasta, per_gene/EOG091G0MSB/EOG091G0MSB.outgroup.fasta
    log: per_gene/EOG091G0MSB/get_outgroups.stdout.txt, per_gene/EOG091G0MSB/get_outgroups.stderr.txt
    jobid: 2771
    wildcards: BUSCO=EOG091G0MSB


        #download fastas from Orhtodb for BUSCO id
        for i in {1..5}
        do
             wget "http://www.orthodb.org/fasta?query=EOG091G0MSB&level=33208" -O per_gene/EOG091G0MSB/EOG091G0MSB.orthodb.fasta 1> per_gene/EOG091G0MSB/get_outgroups.stdout.txt 2> per_gene/EOG091G0MSB/get_outgroups.stderr.txt && break || echo -e "try again ($i)" && sleep 15
        done

	#This is quick an dirty for now and just takes the first protein if there is more than one for an outgroup taxon
        bash ../scripts/download_outgroups.sh taxids.txt per_gene/EOG091G0MSB/EOG091G0MSB.orthodb.fasta > per_gene/EOG091G0MSB/EOG091G0MSB.outgroup.fasta
        
[Sun Jul  5 21:39:36 2020]
Finished job 2771.
264 of 3292 steps (8%) done

[Sun Jul  5 21:39:36 2020]
rule join_groups:
    input: per_gene/EOG091G0MSB/EOG091G0MSB.ingroup.fasta, per_gene/EOG091G0MSB/EOG091G0MSB.outgroup.fasta
    output: per_gene/EOG091G0MSB/EOG091G0MSB.fasta
    jobid: 2209
    wildcards: BUSCO=EOG091G0MSB


        cat per_gene/EOG091G0MSB/EOG091G0MSB.ingroup.fasta per_gene/EOG091G0MSB/EOG091G0MSB.outgroup.fasta > per_gene/EOG091G0MSB/EOG091G0MSB.fasta
        
[Sun Jul  5 21:39:36 2020]
Finished job 2209.
265 of 3292 steps (8%) done

[Sun Jul  5 21:39:36 2020]
rule MSA:
    input: per_gene/EOG091G0MSB/EOG091G0MSB.fasta
    output: per_gene/EOG091G0MSB/EOG091G0MSB.clustalo.fasta
    log: per_gene/EOG091G0MSB/MSA.stdout.txt, per_gene/EOG091G0MSB/MSA.stderr.txt
    jobid: 1538
    wildcards: BUSCO=EOG091G0MSB
    threads: 2


        clustalo -i per_gene/EOG091G0MSB/EOG091G0MSB.fasta -o per_gene/EOG091G0MSB/EOG091G0MSB.clustalo.fasta --threads=2 1> per_gene/EOG091G0MSB/MSA.stdout.txt 2> per_gene/EOG091G0MSB/MSA.stderr.txt
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/d68c9691725a7401923680874285c430.simg
[Sun Jul  5 21:39:37 2020]
Finished job 1538.
266 of 3292 steps (8%) done

[Sun Jul  5 21:39:37 2020]
rule score_and_cut:
    input: per_gene/EOG091G0MSB/EOG091G0MSB.clustalo.fasta
    output: per_gene/EOG091G0MSB/ALICUT_EOG091G0MSB.clustalo.fasta
    jobid: 715
    wildcards: BUSCO=EOG091G0MSB
    threads: 2


        cd per_gene/EOG091G0MSB
        Aliscore.pl -N -r 200000000000000000 -i ../../per_gene/EOG091G0MSB/EOG091G0MSB.clustalo.fasta &> aliscore.log
        ALICUT.pl -s &> alicut.log
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/63c88c27a0fa300f57066b0ef65fefcb.simg
[Sun Jul  5 21:39:41 2020]
Finished job 642.
267 of 3292 steps (8%) done

[Sun Jul  5 21:39:41 2020]
rule infer_single_ML:
    input: per_gene/EOG091G0GWO/EOG091G0GWO.best_model, per_gene/EOG091G0GWO/ALICUT_EOG091G0GWO.clustalo.fasta
    output: per_gene/EOG091G0GWO/EOG091G0GWO.raxml.done
    log: per_gene/EOG091G0GWO/infer_single_ML.stdout.txt, per_gene/EOG091G0GWO/infer_single_ML.stderr.txt
    jobid: 115
    wildcards: BUSCO=EOG091G0GWO
    threads: 2


        cd per_gene/EOG091G0GWO
	count=$(cat ../../per_gene/EOG091G0GWO/ALICUT_EOG091G0GWO.clustalo.fasta | grep ">" | wc -l)
	if [ "$count" -gt 5 ]
        then
		RAxMLmodel=$(cat ../../per_gene/EOG091G0GWO/EOG091G0GWO.best_model | grep "Best" | cut -d ":" -f 2 | tr -d '[:space:]')
                if [ "$(ls -1 | grep "^RAxML" | wc -l)" -ne 0 ]
		then
			rm RAxML*
		fi
        	raxml -f a -T 2 -m PROTGAMMA$RAxMLmodel         	-p 12345 -x 12345 -# 100         	-s ../../per_gene/EOG091G0GWO/ALICUT_EOG091G0GWO.clustalo.fasta -n EOG091G0GWO.clustalo.aln.ALICUT.$RAxMLmodel 		1> ../../per_gene/EOG091G0GWO/infer_single_ML.stdout.txt 2> ../../per_gene/EOG091G0GWO/infer_single_ML.stderr.txt
	else
		echo "fasta file per_gene/EOG091G0GWO/ALICUT_EOG091G0GWO.clustalo.fasta contains fewer than 5 sequences - skipped" > ../../per_gene/EOG091G0GWO/infer_single_ML.stdout.txt
		touch raxml.skipped
	fi
        touch ../../per_gene/EOG091G0GWO/EOG091G0GWO.raxml.done
        
[33mJob counts:
	count	jobs
	1	infer_single_ML
	1[0m
[33m
        cd per_gene/EOG091G0GWO
	count=$(cat ../../per_gene/EOG091G0GWO/ALICUT_EOG091G0GWO.clustalo.fasta | grep ">" | wc -l)
	if [ "$count" -gt 5 ]
        then
		RAxMLmodel=$(cat ../../per_gene/EOG091G0GWO/EOG091G0GWO.best_model | grep "Best" | cut -d ":" -f 2 | tr -d '[:space:]')
                if [ "$(ls -1 | grep "^RAxML" | wc -l)" -ne 0 ]
		then
			rm RAxML*
		fi
        	raxml -f a -T 2 -m PROTGAMMA$RAxMLmodel         	-p 12345 -x 12345 -# 100         	-s ../../per_gene/EOG091G0GWO/ALICUT_EOG091G0GWO.clustalo.fasta -n EOG091G0GWO.clustalo.aln.ALICUT.$RAxMLmodel 		1> ../../per_gene/EOG091G0GWO/infer_single_ML.stdout.txt 2> ../../per_gene/EOG091G0GWO/infer_single_ML.stderr.txt
	else
		echo "fasta file per_gene/EOG091G0GWO/ALICUT_EOG091G0GWO.clustalo.fasta contains fewer than 5 sequences - skipped" > ../../per_gene/EOG091G0GWO/infer_single_ML.stdout.txt
		touch raxml.skipped
	fi
        touch ../../per_gene/EOG091G0GWO/EOG091G0GWO.raxml.done
        [0m
[Sun Jul  5 21:39:47 2020]
Finished job 715.
268 of 3292 steps (8%) done

[Sun Jul  5 21:39:47 2020]
rule remove_empty:
    input: per_gene/EOG091G0MSB/ALICUT_EOG091G0MSB.clustalo.fasta
    output: per_gene/EOG091G0MSB/empty_check.done
    jobid: 1537
    wildcards: BUSCO=EOG091G0MSB


         if [ "$(cat per_gene/EOG091G0MSB/ALICUT_EOG091G0MSB.clustalo.fasta | grep -v ">" | sed 's/-//g' | grep "^$" | wc -l)" -gt 0 ]
         then
              cp per_gene/EOG091G0MSB/ALICUT_EOG091G0MSB.clustalo.fasta per_gene/EOG091G0MSB/ALICUT_EOG091G0MSB.clustalo.fasta.backup
              bash ../scripts/remove_empty.sh per_gene/EOG091G0MSB/ALICUT_EOG091G0MSB.clustalo.fasta.backup > per_gene/EOG091G0MSB/ALICUT_EOG091G0MSB.clustalo.fasta
         fi
         touch per_gene/EOG091G0MSB/empty_check.done
         
[Sun Jul  5 21:39:47 2020]
Finished job 1537.
269 of 3292 steps (8%) done

[Sun Jul  5 21:39:48 2020]
rule find_best_model:
    input: per_gene/EOG091G0MSB/ALICUT_EOG091G0MSB.clustalo.fasta, per_gene/EOG091G0MSB/empty_check.done
    output: per_gene/EOG091G0MSB/EOG091G0MSB.best_model
    log: per_gene/EOG091G0MSB/find_best_model.stderr.txt
    jobid: 714
    wildcards: BUSCO=EOG091G0MSB
    threads: 2


        cd per_gene/EOG091G0MSB
        if [ ! -d find_best_model ]
        then
            mkdir find_best_model
        fi
        cd find_best_model
        ln -s ../../../per_gene/EOG091G0MSB/ALICUT_EOG091G0MSB.clustalo.fasta EOG091G0MSB.fasta
        ProteinModelSelection.pl EOG091G0MSB.fasta 1> ../../../per_gene/EOG091G0MSB/EOG091G0MSB.best_model 2> ../../../per_gene/EOG091G0MSB/find_best_model.stderr.txt
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/c0c09ee657b1e27f2c5687e0e9aa8d70.simg
[Sun Jul  5 21:39:49 2020]
Finished job 818.
270 of 3292 steps (8%) done

[Sun Jul  5 21:39:49 2020]
rule infer_single_ML:
    input: per_gene/EOG091G0VIF/EOG091G0VIF.best_model, per_gene/EOG091G0VIF/ALICUT_EOG091G0VIF.clustalo.fasta
    output: per_gene/EOG091G0VIF/EOG091G0VIF.raxml.done
    log: per_gene/EOG091G0VIF/infer_single_ML.stdout.txt, per_gene/EOG091G0VIF/infer_single_ML.stderr.txt
    jobid: 203
    wildcards: BUSCO=EOG091G0VIF
    threads: 2


        cd per_gene/EOG091G0VIF
	count=$(cat ../../per_gene/EOG091G0VIF/ALICUT_EOG091G0VIF.clustalo.fasta | grep ">" | wc -l)
	if [ "$count" -gt 5 ]
        then
		RAxMLmodel=$(cat ../../per_gene/EOG091G0VIF/EOG091G0VIF.best_model | grep "Best" | cut -d ":" -f 2 | tr -d '[:space:]')
                if [ "$(ls -1 | grep "^RAxML" | wc -l)" -ne 0 ]
		then
			rm RAxML*
		fi
        	raxml -f a -T 2 -m PROTGAMMA$RAxMLmodel         	-p 12345 -x 12345 -# 100         	-s ../../per_gene/EOG091G0VIF/ALICUT_EOG091G0VIF.clustalo.fasta -n EOG091G0VIF.clustalo.aln.ALICUT.$RAxMLmodel 		1> ../../per_gene/EOG091G0VIF/infer_single_ML.stdout.txt 2> ../../per_gene/EOG091G0VIF/infer_single_ML.stderr.txt
	else
		echo "fasta file per_gene/EOG091G0VIF/ALICUT_EOG091G0VIF.clustalo.fasta contains fewer than 5 sequences - skipped" > ../../per_gene/EOG091G0VIF/infer_single_ML.stdout.txt
		touch raxml.skipped
	fi
        touch ../../per_gene/EOG091G0VIF/EOG091G0VIF.raxml.done
        
[33mJob counts:
	count	jobs
	1	infer_single_ML
	1[0m
[33m
        cd per_gene/EOG091G0VIF
	count=$(cat ../../per_gene/EOG091G0VIF/ALICUT_EOG091G0VIF.clustalo.fasta | grep ">" | wc -l)
	if [ "$count" -gt 5 ]
        then
		RAxMLmodel=$(cat ../../per_gene/EOG091G0VIF/EOG091G0VIF.best_model | grep "Best" | cut -d ":" -f 2 | tr -d '[:space:]')
                if [ "$(ls -1 | grep "^RAxML" | wc -l)" -ne 0 ]
		then
			rm RAxML*
		fi
        	raxml -f a -T 2 -m PROTGAMMA$RAxMLmodel         	-p 12345 -x 12345 -# 100         	-s ../../per_gene/EOG091G0VIF/ALICUT_EOG091G0VIF.clustalo.fasta -n EOG091G0VIF.clustalo.aln.ALICUT.$RAxMLmodel 		1> ../../per_gene/EOG091G0VIF/infer_single_ML.stdout.txt 2> ../../per_gene/EOG091G0VIF/infer_single_ML.stderr.txt
	else
		echo "fasta file per_gene/EOG091G0VIF/ALICUT_EOG091G0VIF.clustalo.fasta contains fewer than 5 sequences - skipped" > ../../per_gene/EOG091G0VIF/infer_single_ML.stdout.txt
		touch raxml.skipped
	fi
        touch ../../per_gene/EOG091G0VIF/EOG091G0VIF.raxml.done
        [0m
[Sun Jul  5 21:39:50 2020]
Finished job 228.
271 of 3292 steps (8%) done

[Sun Jul  5 21:39:50 2020]
rule get_seqs:
    input: /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ingroup.txt, /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/outgroup.txt
    output: per_gene/EOG091G0AVP/EOG091G0AVP.ingroup.fasta
    log: per_gene/EOG091G0AVP/get_seqs.stdout.txt, per_gene/EOG091G0AVP/get_seqs.stderr.txt
    jobid: 3176
    wildcards: BUSCO=EOG091G0AVP
    threads: 2


	basedir=$(pwd)
        cd per_gene/EOG091G0AVP
        
        bash $basedir/../scripts/fetch_seqs.sh EOG091G0AVP /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ingroup.txt /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/outgroup.txt 1> ../../per_gene/EOG091G0AVP/get_seqs.stdout.txt 2> ../../per_gene/EOG091G0AVP/get_seqs.stderr.txt
	mv EOG091G0AVP.fasta $basedir/per_gene/EOG091G0AVP/EOG091G0AVP.ingroup.fasta
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/72476f9d9a5bd0627b4d721143a21354.simg
[Sun Jul  5 21:40:03 2020]
Finished job 3176.
272 of 3292 steps (8%) done

[Sun Jul  5 21:40:03 2020]
rule get_outgroups:
    input: per_gene/EOG091G0AVP/EOG091G0AVP.ingroup.fasta
    output: per_gene/EOG091G0AVP/EOG091G0AVP.orthodb.fasta, per_gene/EOG091G0AVP/EOG091G0AVP.outgroup.fasta
    log: per_gene/EOG091G0AVP/get_outgroups.stdout.txt, per_gene/EOG091G0AVP/get_outgroups.stderr.txt
    jobid: 3177
    wildcards: BUSCO=EOG091G0AVP


        #download fastas from Orhtodb for BUSCO id
        for i in {1..5}
        do
             wget "http://www.orthodb.org/fasta?query=EOG091G0AVP&level=33208" -O per_gene/EOG091G0AVP/EOG091G0AVP.orthodb.fasta 1> per_gene/EOG091G0AVP/get_outgroups.stdout.txt 2> per_gene/EOG091G0AVP/get_outgroups.stderr.txt && break || echo -e "try again ($i)" && sleep 15
        done

	#This is quick an dirty for now and just takes the first protein if there is more than one for an outgroup taxon
        bash ../scripts/download_outgroups.sh taxids.txt per_gene/EOG091G0AVP/EOG091G0AVP.orthodb.fasta > per_gene/EOG091G0AVP/EOG091G0AVP.outgroup.fasta
        
[Sun Jul  5 21:40:04 2020]
Finished job 3177.
273 of 3292 steps (8%) done

[Sun Jul  5 21:40:04 2020]
rule join_groups:
    input: per_gene/EOG091G0AVP/EOG091G0AVP.ingroup.fasta, per_gene/EOG091G0AVP/EOG091G0AVP.outgroup.fasta
    output: per_gene/EOG091G0AVP/EOG091G0AVP.fasta
    jobid: 2412
    wildcards: BUSCO=EOG091G0AVP


        cat per_gene/EOG091G0AVP/EOG091G0AVP.ingroup.fasta per_gene/EOG091G0AVP/EOG091G0AVP.outgroup.fasta > per_gene/EOG091G0AVP/EOG091G0AVP.fasta
        
[Sun Jul  5 21:40:04 2020]
Finished job 2412.
274 of 3292 steps (8%) done

[Sun Jul  5 21:40:04 2020]
rule MSA:
    input: per_gene/EOG091G0AVP/EOG091G0AVP.fasta
    output: per_gene/EOG091G0AVP/EOG091G0AVP.clustalo.fasta
    log: per_gene/EOG091G0AVP/MSA.stdout.txt, per_gene/EOG091G0AVP/MSA.stderr.txt
    jobid: 1944
    wildcards: BUSCO=EOG091G0AVP
    threads: 2


        clustalo -i per_gene/EOG091G0AVP/EOG091G0AVP.fasta -o per_gene/EOG091G0AVP/EOG091G0AVP.clustalo.fasta --threads=2 1> per_gene/EOG091G0AVP/MSA.stdout.txt 2> per_gene/EOG091G0AVP/MSA.stderr.txt
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/d68c9691725a7401923680874285c430.simg
[Sun Jul  5 21:40:05 2020]
Finished job 54.
275 of 3292 steps (8%) done

[Sun Jul  5 21:40:05 2020]
rule get_seqs:
    input: /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ingroup.txt, /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/outgroup.txt
    output: per_gene/EOG091G1AP6/EOG091G1AP6.ingroup.fasta
    log: per_gene/EOG091G1AP6/get_seqs.stdout.txt, per_gene/EOG091G1AP6/get_seqs.stderr.txt
    jobid: 2944
    wildcards: BUSCO=EOG091G1AP6
    threads: 2


	basedir=$(pwd)
        cd per_gene/EOG091G1AP6
        
        bash $basedir/../scripts/fetch_seqs.sh EOG091G1AP6 /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ingroup.txt /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/outgroup.txt 1> ../../per_gene/EOG091G1AP6/get_seqs.stdout.txt 2> ../../per_gene/EOG091G1AP6/get_seqs.stderr.txt
	mv EOG091G1AP6.fasta $basedir/per_gene/EOG091G1AP6/EOG091G1AP6.ingroup.fasta
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/72476f9d9a5bd0627b4d721143a21354.simg
[Sun Jul  5 21:40:05 2020]
Finished job 1944.
276 of 3292 steps (8%) done

[Sun Jul  5 21:40:05 2020]
rule score_and_cut:
    input: per_gene/EOG091G0AVP/EOG091G0AVP.clustalo.fasta
    output: per_gene/EOG091G0AVP/ALICUT_EOG091G0AVP.clustalo.fasta
    jobid: 1121
    wildcards: BUSCO=EOG091G0AVP
    threads: 2


        cd per_gene/EOG091G0AVP
        Aliscore.pl -N -r 200000000000000000 -i ../../per_gene/EOG091G0AVP/EOG091G0AVP.clustalo.fasta &> aliscore.log
        ALICUT.pl -s &> alicut.log
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/63c88c27a0fa300f57066b0ef65fefcb.simg
[Sun Jul  5 21:40:15 2020]
Finished job 1121.
277 of 3292 steps (8%) done

[Sun Jul  5 21:40:15 2020]
rule remove_empty:
    input: per_gene/EOG091G0AVP/ALICUT_EOG091G0AVP.clustalo.fasta
    output: per_gene/EOG091G0AVP/empty_check.done
    jobid: 1943
    wildcards: BUSCO=EOG091G0AVP


         if [ "$(cat per_gene/EOG091G0AVP/ALICUT_EOG091G0AVP.clustalo.fasta | grep -v ">" | sed 's/-//g' | grep "^$" | wc -l)" -gt 0 ]
         then
              cp per_gene/EOG091G0AVP/ALICUT_EOG091G0AVP.clustalo.fasta per_gene/EOG091G0AVP/ALICUT_EOG091G0AVP.clustalo.fasta.backup
              bash ../scripts/remove_empty.sh per_gene/EOG091G0AVP/ALICUT_EOG091G0AVP.clustalo.fasta.backup > per_gene/EOG091G0AVP/ALICUT_EOG091G0AVP.clustalo.fasta
         fi
         touch per_gene/EOG091G0AVP/empty_check.done
         
[Sun Jul  5 21:40:15 2020]
Finished job 1943.
278 of 3292 steps (8%) done

[Sun Jul  5 21:40:15 2020]
rule find_best_model:
    input: per_gene/EOG091G0AVP/ALICUT_EOG091G0AVP.clustalo.fasta, per_gene/EOG091G0AVP/empty_check.done
    output: per_gene/EOG091G0AVP/EOG091G0AVP.best_model
    log: per_gene/EOG091G0AVP/find_best_model.stderr.txt
    jobid: 1120
    wildcards: BUSCO=EOG091G0AVP
    threads: 2


        cd per_gene/EOG091G0AVP
        if [ ! -d find_best_model ]
        then
            mkdir find_best_model
        fi
        cd find_best_model
        ln -s ../../../per_gene/EOG091G0AVP/ALICUT_EOG091G0AVP.clustalo.fasta EOG091G0AVP.fasta
        ProteinModelSelection.pl EOG091G0AVP.fasta 1> ../../../per_gene/EOG091G0AVP/EOG091G0AVP.best_model 2> ../../../per_gene/EOG091G0AVP/find_best_model.stderr.txt
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/c0c09ee657b1e27f2c5687e0e9aa8d70.simg
[Sun Jul  5 21:40:17 2020]
Finished job 418.
279 of 3292 steps (8%) done

[Sun Jul  5 21:40:17 2020]
rule infer_single_ML:
    input: per_gene/EOG091G00Z3/EOG091G00Z3.best_model, per_gene/EOG091G00Z3/ALICUT_EOG091G00Z3.clustalo.fasta
    output: per_gene/EOG091G00Z3/EOG091G00Z3.raxml.done
    log: per_gene/EOG091G00Z3/infer_single_ML.stdout.txt, per_gene/EOG091G00Z3/infer_single_ML.stderr.txt
    jobid: 3
    wildcards: BUSCO=EOG091G00Z3
    threads: 2


        cd per_gene/EOG091G00Z3
	count=$(cat ../../per_gene/EOG091G00Z3/ALICUT_EOG091G00Z3.clustalo.fasta | grep ">" | wc -l)
	if [ "$count" -gt 5 ]
        then
		RAxMLmodel=$(cat ../../per_gene/EOG091G00Z3/EOG091G00Z3.best_model | grep "Best" | cut -d ":" -f 2 | tr -d '[:space:]')
                if [ "$(ls -1 | grep "^RAxML" | wc -l)" -ne 0 ]
		then
			rm RAxML*
		fi
        	raxml -f a -T 2 -m PROTGAMMA$RAxMLmodel         	-p 12345 -x 12345 -# 100         	-s ../../per_gene/EOG091G00Z3/ALICUT_EOG091G00Z3.clustalo.fasta -n EOG091G00Z3.clustalo.aln.ALICUT.$RAxMLmodel 		1> ../../per_gene/EOG091G00Z3/infer_single_ML.stdout.txt 2> ../../per_gene/EOG091G00Z3/infer_single_ML.stderr.txt
	else
		echo "fasta file per_gene/EOG091G00Z3/ALICUT_EOG091G00Z3.clustalo.fasta contains fewer than 5 sequences - skipped" > ../../per_gene/EOG091G00Z3/infer_single_ML.stdout.txt
		touch raxml.skipped
	fi
        touch ../../per_gene/EOG091G00Z3/EOG091G00Z3.raxml.done
        
[33mJob counts:
	count	jobs
	1	infer_single_ML
	1[0m
[33m
        cd per_gene/EOG091G00Z3
	count=$(cat ../../per_gene/EOG091G00Z3/ALICUT_EOG091G00Z3.clustalo.fasta | grep ">" | wc -l)
	if [ "$count" -gt 5 ]
        then
		RAxMLmodel=$(cat ../../per_gene/EOG091G00Z3/EOG091G00Z3.best_model | grep "Best" | cut -d ":" -f 2 | tr -d '[:space:]')
                if [ "$(ls -1 | grep "^RAxML" | wc -l)" -ne 0 ]
		then
			rm RAxML*
		fi
        	raxml -f a -T 2 -m PROTGAMMA$RAxMLmodel         	-p 12345 -x 12345 -# 100         	-s ../../per_gene/EOG091G00Z3/ALICUT_EOG091G00Z3.clustalo.fasta -n EOG091G00Z3.clustalo.aln.ALICUT.$RAxMLmodel 		1> ../../per_gene/EOG091G00Z3/infer_single_ML.stdout.txt 2> ../../per_gene/EOG091G00Z3/infer_single_ML.stderr.txt
	else
		echo "fasta file per_gene/EOG091G00Z3/ALICUT_EOG091G00Z3.clustalo.fasta contains fewer than 5 sequences - skipped" > ../../per_gene/EOG091G00Z3/infer_single_ML.stdout.txt
		touch raxml.skipped
	fi
        touch ../../per_gene/EOG091G00Z3/EOG091G00Z3.raxml.done
        [0m
[Sun Jul  5 21:40:18 2020]
Finished job 2944.
280 of 3292 steps (9%) done

[Sun Jul  5 21:40:18 2020]
rule get_outgroups:
    input: per_gene/EOG091G1AP6/EOG091G1AP6.ingroup.fasta
    output: per_gene/EOG091G1AP6/EOG091G1AP6.orthodb.fasta, per_gene/EOG091G1AP6/EOG091G1AP6.outgroup.fasta
    log: per_gene/EOG091G1AP6/get_outgroups.stdout.txt, per_gene/EOG091G1AP6/get_outgroups.stderr.txt
    jobid: 2945
    wildcards: BUSCO=EOG091G1AP6


        #download fastas from Orhtodb for BUSCO id
        for i in {1..5}
        do
             wget "http://www.orthodb.org/fasta?query=EOG091G1AP6&level=33208" -O per_gene/EOG091G1AP6/EOG091G1AP6.orthodb.fasta 1> per_gene/EOG091G1AP6/get_outgroups.stdout.txt 2> per_gene/EOG091G1AP6/get_outgroups.stderr.txt && break || echo -e "try again ($i)" && sleep 15
        done

	#This is quick an dirty for now and just takes the first protein if there is more than one for an outgroup taxon
        bash ../scripts/download_outgroups.sh taxids.txt per_gene/EOG091G1AP6/EOG091G1AP6.orthodb.fasta > per_gene/EOG091G1AP6/EOG091G1AP6.outgroup.fasta
        
[Sun Jul  5 21:40:19 2020]
Finished job 2945.
281 of 3292 steps (9%) done

[Sun Jul  5 21:40:19 2020]
rule join_groups:
    input: per_gene/EOG091G1AP6/EOG091G1AP6.ingroup.fasta, per_gene/EOG091G1AP6/EOG091G1AP6.outgroup.fasta
    output: per_gene/EOG091G1AP6/EOG091G1AP6.fasta
    jobid: 2296
    wildcards: BUSCO=EOG091G1AP6


        cat per_gene/EOG091G1AP6/EOG091G1AP6.ingroup.fasta per_gene/EOG091G1AP6/EOG091G1AP6.outgroup.fasta > per_gene/EOG091G1AP6/EOG091G1AP6.fasta
        
[Sun Jul  5 21:40:19 2020]
Finished job 2296.
282 of 3292 steps (9%) done

[Sun Jul  5 21:40:19 2020]
rule MSA:
    input: per_gene/EOG091G1AP6/EOG091G1AP6.fasta
    output: per_gene/EOG091G1AP6/EOG091G1AP6.clustalo.fasta
    log: per_gene/EOG091G1AP6/MSA.stdout.txt, per_gene/EOG091G1AP6/MSA.stderr.txt
    jobid: 1712
    wildcards: BUSCO=EOG091G1AP6
    threads: 2


        clustalo -i per_gene/EOG091G1AP6/EOG091G1AP6.fasta -o per_gene/EOG091G1AP6/EOG091G1AP6.clustalo.fasta --threads=2 1> per_gene/EOG091G1AP6/MSA.stdout.txt 2> per_gene/EOG091G1AP6/MSA.stderr.txt
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/d68c9691725a7401923680874285c430.simg
[Sun Jul  5 21:40:20 2020]
Finished job 1712.
283 of 3292 steps (9%) done

[Sun Jul  5 21:40:20 2020]
rule score_and_cut:
    input: per_gene/EOG091G1AP6/EOG091G1AP6.clustalo.fasta
    output: per_gene/EOG091G1AP6/ALICUT_EOG091G1AP6.clustalo.fasta
    jobid: 889
    wildcards: BUSCO=EOG091G1AP6
    threads: 2


        cd per_gene/EOG091G1AP6
        Aliscore.pl -N -r 200000000000000000 -i ../../per_gene/EOG091G1AP6/EOG091G1AP6.clustalo.fasta &> aliscore.log
        ALICUT.pl -s &> alicut.log
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/63c88c27a0fa300f57066b0ef65fefcb.simg
[Sun Jul  5 21:40:26 2020]
Finished job 211.
284 of 3292 steps (9%) done

[Sun Jul  5 21:40:26 2020]
rule get_seqs:
    input: /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ingroup.txt, /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/outgroup.txt
    output: per_gene/EOG091G0DYW/EOG091G0DYW.ingroup.fasta
    log: per_gene/EOG091G0DYW/get_seqs.stdout.txt, per_gene/EOG091G0DYW/get_seqs.stderr.txt
    jobid: 2664
    wildcards: BUSCO=EOG091G0DYW
    threads: 2


	basedir=$(pwd)
        cd per_gene/EOG091G0DYW
        
        bash $basedir/../scripts/fetch_seqs.sh EOG091G0DYW /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ingroup.txt /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/outgroup.txt 1> ../../per_gene/EOG091G0DYW/get_seqs.stdout.txt 2> ../../per_gene/EOG091G0DYW/get_seqs.stderr.txt
	mv EOG091G0DYW.fasta $basedir/per_gene/EOG091G0DYW/EOG091G0DYW.ingroup.fasta
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/72476f9d9a5bd0627b4d721143a21354.simg
[Sun Jul  5 21:40:29 2020]
Finished job 889.
285 of 3292 steps (9%) done

[Sun Jul  5 21:40:29 2020]
rule remove_empty:
    input: per_gene/EOG091G1AP6/ALICUT_EOG091G1AP6.clustalo.fasta
    output: per_gene/EOG091G1AP6/empty_check.done
    jobid: 1711
    wildcards: BUSCO=EOG091G1AP6


         if [ "$(cat per_gene/EOG091G1AP6/ALICUT_EOG091G1AP6.clustalo.fasta | grep -v ">" | sed 's/-//g' | grep "^$" | wc -l)" -gt 0 ]
         then
              cp per_gene/EOG091G1AP6/ALICUT_EOG091G1AP6.clustalo.fasta per_gene/EOG091G1AP6/ALICUT_EOG091G1AP6.clustalo.fasta.backup
              bash ../scripts/remove_empty.sh per_gene/EOG091G1AP6/ALICUT_EOG091G1AP6.clustalo.fasta.backup > per_gene/EOG091G1AP6/ALICUT_EOG091G1AP6.clustalo.fasta
         fi
         touch per_gene/EOG091G1AP6/empty_check.done
         
[Sun Jul  5 21:40:29 2020]
Finished job 1711.
286 of 3292 steps (9%) done

[Sun Jul  5 21:40:29 2020]
rule find_best_model:
    input: per_gene/EOG091G1AP6/ALICUT_EOG091G1AP6.clustalo.fasta, per_gene/EOG091G1AP6/empty_check.done
    output: per_gene/EOG091G1AP6/EOG091G1AP6.best_model
    log: per_gene/EOG091G1AP6/find_best_model.stderr.txt
    jobid: 888
    wildcards: BUSCO=EOG091G1AP6
    threads: 2


        cd per_gene/EOG091G1AP6
        if [ ! -d find_best_model ]
        then
            mkdir find_best_model
        fi
        cd find_best_model
        ln -s ../../../per_gene/EOG091G1AP6/ALICUT_EOG091G1AP6.clustalo.fasta EOG091G1AP6.fasta
        ProteinModelSelection.pl EOG091G1AP6.fasta 1> ../../../per_gene/EOG091G1AP6/EOG091G1AP6.best_model 2> ../../../per_gene/EOG091G1AP6/find_best_model.stderr.txt
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/c0c09ee657b1e27f2c5687e0e9aa8d70.simg
[Sun Jul  5 21:40:32 2020]
Finished job 87.
287 of 3292 steps (9%) done

[Sun Jul  5 21:40:32 2020]
rule get_seqs:
    input: /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ingroup.txt, /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/outgroup.txt
    output: per_gene/EOG091G088L/EOG091G088L.ingroup.fasta
    log: per_gene/EOG091G088L/get_seqs.stdout.txt, per_gene/EOG091G088L/get_seqs.stderr.txt
    jobid: 3074
    wildcards: BUSCO=EOG091G088L
    threads: 2


	basedir=$(pwd)
        cd per_gene/EOG091G088L
        
        bash $basedir/../scripts/fetch_seqs.sh EOG091G088L /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ingroup.txt /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/outgroup.txt 1> ../../per_gene/EOG091G088L/get_seqs.stdout.txt 2> ../../per_gene/EOG091G088L/get_seqs.stderr.txt
	mv EOG091G088L.fasta $basedir/per_gene/EOG091G088L/EOG091G088L.ingroup.fasta
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/72476f9d9a5bd0627b4d721143a21354.simg
[Sun Jul  5 21:40:39 2020]
Finished job 714.
288 of 3292 steps (9%) done

[Sun Jul  5 21:40:39 2020]
rule infer_single_ML:
    input: per_gene/EOG091G0MSB/EOG091G0MSB.best_model, per_gene/EOG091G0MSB/ALICUT_EOG091G0MSB.clustalo.fasta
    output: per_gene/EOG091G0MSB/EOG091G0MSB.raxml.done
    log: per_gene/EOG091G0MSB/infer_single_ML.stdout.txt, per_gene/EOG091G0MSB/infer_single_ML.stderr.txt
    jobid: 151
    wildcards: BUSCO=EOG091G0MSB
    threads: 2


        cd per_gene/EOG091G0MSB
	count=$(cat ../../per_gene/EOG091G0MSB/ALICUT_EOG091G0MSB.clustalo.fasta | grep ">" | wc -l)
	if [ "$count" -gt 5 ]
        then
		RAxMLmodel=$(cat ../../per_gene/EOG091G0MSB/EOG091G0MSB.best_model | grep "Best" | cut -d ":" -f 2 | tr -d '[:space:]')
                if [ "$(ls -1 | grep "^RAxML" | wc -l)" -ne 0 ]
		then
			rm RAxML*
		fi
        	raxml -f a -T 2 -m PROTGAMMA$RAxMLmodel         	-p 12345 -x 12345 -# 100         	-s ../../per_gene/EOG091G0MSB/ALICUT_EOG091G0MSB.clustalo.fasta -n EOG091G0MSB.clustalo.aln.ALICUT.$RAxMLmodel 		1> ../../per_gene/EOG091G0MSB/infer_single_ML.stdout.txt 2> ../../per_gene/EOG091G0MSB/infer_single_ML.stderr.txt
	else
		echo "fasta file per_gene/EOG091G0MSB/ALICUT_EOG091G0MSB.clustalo.fasta contains fewer than 5 sequences - skipped" > ../../per_gene/EOG091G0MSB/infer_single_ML.stdout.txt
		touch raxml.skipped
	fi
        touch ../../per_gene/EOG091G0MSB/EOG091G0MSB.raxml.done
        
[33mJob counts:
	count	jobs
	1	infer_single_ML
	1[0m
[33m
        cd per_gene/EOG091G0MSB
	count=$(cat ../../per_gene/EOG091G0MSB/ALICUT_EOG091G0MSB.clustalo.fasta | grep ">" | wc -l)
	if [ "$count" -gt 5 ]
        then
		RAxMLmodel=$(cat ../../per_gene/EOG091G0MSB/EOG091G0MSB.best_model | grep "Best" | cut -d ":" -f 2 | tr -d '[:space:]')
                if [ "$(ls -1 | grep "^RAxML" | wc -l)" -ne 0 ]
		then
			rm RAxML*
		fi
        	raxml -f a -T 2 -m PROTGAMMA$RAxMLmodel         	-p 12345 -x 12345 -# 100         	-s ../../per_gene/EOG091G0MSB/ALICUT_EOG091G0MSB.clustalo.fasta -n EOG091G0MSB.clustalo.aln.ALICUT.$RAxMLmodel 		1> ../../per_gene/EOG091G0MSB/infer_single_ML.stdout.txt 2> ../../per_gene/EOG091G0MSB/infer_single_ML.stderr.txt
	else
		echo "fasta file per_gene/EOG091G0MSB/ALICUT_EOG091G0MSB.clustalo.fasta contains fewer than 5 sequences - skipped" > ../../per_gene/EOG091G0MSB/infer_single_ML.stdout.txt
		touch raxml.skipped
	fi
        touch ../../per_gene/EOG091G0MSB/EOG091G0MSB.raxml.done
        [0m
[Sun Jul  5 21:40:41 2020]
Finished job 2664.
289 of 3292 steps (9%) done

[Sun Jul  5 21:40:41 2020]
rule get_outgroups:
    input: per_gene/EOG091G0DYW/EOG091G0DYW.ingroup.fasta
    output: per_gene/EOG091G0DYW/EOG091G0DYW.orthodb.fasta, per_gene/EOG091G0DYW/EOG091G0DYW.outgroup.fasta
    log: per_gene/EOG091G0DYW/get_outgroups.stdout.txt, per_gene/EOG091G0DYW/get_outgroups.stderr.txt
    jobid: 2665
    wildcards: BUSCO=EOG091G0DYW


        #download fastas from Orhtodb for BUSCO id
        for i in {1..5}
        do
             wget "http://www.orthodb.org/fasta?query=EOG091G0DYW&level=33208" -O per_gene/EOG091G0DYW/EOG091G0DYW.orthodb.fasta 1> per_gene/EOG091G0DYW/get_outgroups.stdout.txt 2> per_gene/EOG091G0DYW/get_outgroups.stderr.txt && break || echo -e "try again ($i)" && sleep 15
        done

	#This is quick an dirty for now and just takes the first protein if there is more than one for an outgroup taxon
        bash ../scripts/download_outgroups.sh taxids.txt per_gene/EOG091G0DYW/EOG091G0DYW.orthodb.fasta > per_gene/EOG091G0DYW/EOG091G0DYW.outgroup.fasta
        
[Sun Jul  5 21:40:42 2020]
Finished job 2665.
290 of 3292 steps (9%) done

[Sun Jul  5 21:40:42 2020]
rule join_groups:
    input: per_gene/EOG091G0DYW/EOG091G0DYW.ingroup.fasta, per_gene/EOG091G0DYW/EOG091G0DYW.outgroup.fasta
    output: per_gene/EOG091G0DYW/EOG091G0DYW.fasta
    jobid: 2156
    wildcards: BUSCO=EOG091G0DYW


        cat per_gene/EOG091G0DYW/EOG091G0DYW.ingroup.fasta per_gene/EOG091G0DYW/EOG091G0DYW.outgroup.fasta > per_gene/EOG091G0DYW/EOG091G0DYW.fasta
        
[Sun Jul  5 21:40:42 2020]
Finished job 2156.
291 of 3292 steps (9%) done

[Sun Jul  5 21:40:42 2020]
rule MSA:
    input: per_gene/EOG091G0DYW/EOG091G0DYW.fasta
    output: per_gene/EOG091G0DYW/EOG091G0DYW.clustalo.fasta
    log: per_gene/EOG091G0DYW/MSA.stdout.txt, per_gene/EOG091G0DYW/MSA.stderr.txt
    jobid: 1432
    wildcards: BUSCO=EOG091G0DYW
    threads: 2


        clustalo -i per_gene/EOG091G0DYW/EOG091G0DYW.fasta -o per_gene/EOG091G0DYW/EOG091G0DYW.clustalo.fasta --threads=2 1> per_gene/EOG091G0DYW/MSA.stdout.txt 2> per_gene/EOG091G0DYW/MSA.stderr.txt
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/d68c9691725a7401923680874285c430.simg
[Sun Jul  5 21:40:44 2020]
Finished job 1432.
292 of 3292 steps (9%) done

[Sun Jul  5 21:40:44 2020]
rule score_and_cut:
    input: per_gene/EOG091G0DYW/EOG091G0DYW.clustalo.fasta
    output: per_gene/EOG091G0DYW/ALICUT_EOG091G0DYW.clustalo.fasta
    jobid: 609
    wildcards: BUSCO=EOG091G0DYW
    threads: 2


        cd per_gene/EOG091G0DYW
        Aliscore.pl -N -r 200000000000000000 -i ../../per_gene/EOG091G0DYW/EOG091G0DYW.clustalo.fasta &> aliscore.log
        ALICUT.pl -s &> alicut.log
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/63c88c27a0fa300f57066b0ef65fefcb.simg
[Sun Jul  5 21:40:46 2020]
Finished job 3074.
293 of 3292 steps (9%) done

[Sun Jul  5 21:40:46 2020]
rule get_outgroups:
    input: per_gene/EOG091G088L/EOG091G088L.ingroup.fasta
    output: per_gene/EOG091G088L/EOG091G088L.orthodb.fasta, per_gene/EOG091G088L/EOG091G088L.outgroup.fasta
    log: per_gene/EOG091G088L/get_outgroups.stdout.txt, per_gene/EOG091G088L/get_outgroups.stderr.txt
    jobid: 3075
    wildcards: BUSCO=EOG091G088L


        #download fastas from Orhtodb for BUSCO id
        for i in {1..5}
        do
             wget "http://www.orthodb.org/fasta?query=EOG091G088L&level=33208" -O per_gene/EOG091G088L/EOG091G088L.orthodb.fasta 1> per_gene/EOG091G088L/get_outgroups.stdout.txt 2> per_gene/EOG091G088L/get_outgroups.stderr.txt && break || echo -e "try again ($i)" && sleep 15
        done

	#This is quick an dirty for now and just takes the first protein if there is more than one for an outgroup taxon
        bash ../scripts/download_outgroups.sh taxids.txt per_gene/EOG091G088L/EOG091G088L.orthodb.fasta > per_gene/EOG091G088L/EOG091G088L.outgroup.fasta
        
[Sun Jul  5 21:40:47 2020]
Finished job 3075.
294 of 3292 steps (9%) done

[Sun Jul  5 21:40:47 2020]
rule join_groups:
    input: per_gene/EOG091G088L/EOG091G088L.ingroup.fasta, per_gene/EOG091G088L/EOG091G088L.outgroup.fasta
    output: per_gene/EOG091G088L/EOG091G088L.fasta
    jobid: 2361
    wildcards: BUSCO=EOG091G088L


        cat per_gene/EOG091G088L/EOG091G088L.ingroup.fasta per_gene/EOG091G088L/EOG091G088L.outgroup.fasta > per_gene/EOG091G088L/EOG091G088L.fasta
        
[Sun Jul  5 21:40:47 2020]
Finished job 2361.
295 of 3292 steps (9%) done

[Sun Jul  5 21:40:47 2020]
rule MSA:
    input: per_gene/EOG091G088L/EOG091G088L.fasta
    output: per_gene/EOG091G088L/EOG091G088L.clustalo.fasta
    log: per_gene/EOG091G088L/MSA.stdout.txt, per_gene/EOG091G088L/MSA.stderr.txt
    jobid: 1842
    wildcards: BUSCO=EOG091G088L
    threads: 2


        clustalo -i per_gene/EOG091G088L/EOG091G088L.fasta -o per_gene/EOG091G088L/EOG091G088L.clustalo.fasta --threads=2 1> per_gene/EOG091G088L/MSA.stdout.txt 2> per_gene/EOG091G088L/MSA.stderr.txt
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/d68c9691725a7401923680874285c430.simg
[Sun Jul  5 21:40:48 2020]
Finished job 1842.
296 of 3292 steps (9%) done

[Sun Jul  5 21:40:48 2020]
rule score_and_cut:
    input: per_gene/EOG091G088L/EOG091G088L.clustalo.fasta
    output: per_gene/EOG091G088L/ALICUT_EOG091G088L.clustalo.fasta
    jobid: 1019
    wildcards: BUSCO=EOG091G088L
    threads: 2


        cd per_gene/EOG091G088L
        Aliscore.pl -N -r 200000000000000000 -i ../../per_gene/EOG091G088L/EOG091G088L.clustalo.fasta &> aliscore.log
        ALICUT.pl -s &> alicut.log
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/63c88c27a0fa300f57066b0ef65fefcb.simg
[Sun Jul  5 21:40:53 2020]
Finished job 609.
297 of 3292 steps (9%) done

[Sun Jul  5 21:40:53 2020]
rule remove_empty:
    input: per_gene/EOG091G0DYW/ALICUT_EOG091G0DYW.clustalo.fasta
    output: per_gene/EOG091G0DYW/empty_check.done
    jobid: 1431
    wildcards: BUSCO=EOG091G0DYW


         if [ "$(cat per_gene/EOG091G0DYW/ALICUT_EOG091G0DYW.clustalo.fasta | grep -v ">" | sed 's/-//g' | grep "^$" | wc -l)" -gt 0 ]
         then
              cp per_gene/EOG091G0DYW/ALICUT_EOG091G0DYW.clustalo.fasta per_gene/EOG091G0DYW/ALICUT_EOG091G0DYW.clustalo.fasta.backup
              bash ../scripts/remove_empty.sh per_gene/EOG091G0DYW/ALICUT_EOG091G0DYW.clustalo.fasta.backup > per_gene/EOG091G0DYW/ALICUT_EOG091G0DYW.clustalo.fasta
         fi
         touch per_gene/EOG091G0DYW/empty_check.done
         
[Sun Jul  5 21:40:53 2020]
Finished job 1431.
298 of 3292 steps (9%) done

[Sun Jul  5 21:40:53 2020]
rule find_best_model:
    input: per_gene/EOG091G0DYW/ALICUT_EOG091G0DYW.clustalo.fasta, per_gene/EOG091G0DYW/empty_check.done
    output: per_gene/EOG091G0DYW/EOG091G0DYW.best_model
    log: per_gene/EOG091G0DYW/find_best_model.stderr.txt
    jobid: 608
    wildcards: BUSCO=EOG091G0DYW
    threads: 2


        cd per_gene/EOG091G0DYW
        if [ ! -d find_best_model ]
        then
            mkdir find_best_model
        fi
        cd find_best_model
        ln -s ../../../per_gene/EOG091G0DYW/ALICUT_EOG091G0DYW.clustalo.fasta EOG091G0DYW.fasta
        ProteinModelSelection.pl EOG091G0DYW.fasta 1> ../../../per_gene/EOG091G0DYW/EOG091G0DYW.best_model 2> ../../../per_gene/EOG091G0DYW/find_best_model.stderr.txt
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/c0c09ee657b1e27f2c5687e0e9aa8d70.simg
[Sun Jul  5 21:40:59 2020]
Finished job 1019.
299 of 3292 steps (9%) done

[Sun Jul  5 21:40:59 2020]
rule remove_empty:
    input: per_gene/EOG091G088L/ALICUT_EOG091G088L.clustalo.fasta
    output: per_gene/EOG091G088L/empty_check.done
    jobid: 1841
    wildcards: BUSCO=EOG091G088L


         if [ "$(cat per_gene/EOG091G088L/ALICUT_EOG091G088L.clustalo.fasta | grep -v ">" | sed 's/-//g' | grep "^$" | wc -l)" -gt 0 ]
         then
              cp per_gene/EOG091G088L/ALICUT_EOG091G088L.clustalo.fasta per_gene/EOG091G088L/ALICUT_EOG091G088L.clustalo.fasta.backup
              bash ../scripts/remove_empty.sh per_gene/EOG091G088L/ALICUT_EOG091G088L.clustalo.fasta.backup > per_gene/EOG091G088L/ALICUT_EOG091G088L.clustalo.fasta
         fi
         touch per_gene/EOG091G088L/empty_check.done
         
[Sun Jul  5 21:40:59 2020]
Finished job 1841.
300 of 3292 steps (9%) done

[Sun Jul  5 21:40:59 2020]
rule find_best_model:
    input: per_gene/EOG091G088L/ALICUT_EOG091G088L.clustalo.fasta, per_gene/EOG091G088L/empty_check.done
    output: per_gene/EOG091G088L/EOG091G088L.best_model
    log: per_gene/EOG091G088L/find_best_model.stderr.txt
    jobid: 1018
    wildcards: BUSCO=EOG091G088L
    threads: 2


        cd per_gene/EOG091G088L
        if [ ! -d find_best_model ]
        then
            mkdir find_best_model
        fi
        cd find_best_model
        ln -s ../../../per_gene/EOG091G088L/ALICUT_EOG091G088L.clustalo.fasta EOG091G088L.fasta
        ProteinModelSelection.pl EOG091G088L.fasta 1> ../../../per_gene/EOG091G088L/EOG091G088L.best_model 2> ../../../per_gene/EOG091G088L/find_best_model.stderr.txt
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/c0c09ee657b1e27f2c5687e0e9aa8d70.simg
[Sun Jul  5 21:41:00 2020]
Finished job 888.
301 of 3292 steps (9%) done

[Sun Jul  5 21:41:00 2020]
rule infer_single_ML:
    input: per_gene/EOG091G1AP6/EOG091G1AP6.best_model, per_gene/EOG091G1AP6/ALICUT_EOG091G1AP6.clustalo.fasta
    output: per_gene/EOG091G1AP6/EOG091G1AP6.raxml.done
    log: per_gene/EOG091G1AP6/infer_single_ML.stdout.txt, per_gene/EOG091G1AP6/infer_single_ML.stderr.txt
    jobid: 238
    wildcards: BUSCO=EOG091G1AP6
    threads: 2


        cd per_gene/EOG091G1AP6
	count=$(cat ../../per_gene/EOG091G1AP6/ALICUT_EOG091G1AP6.clustalo.fasta | grep ">" | wc -l)
	if [ "$count" -gt 5 ]
        then
		RAxMLmodel=$(cat ../../per_gene/EOG091G1AP6/EOG091G1AP6.best_model | grep "Best" | cut -d ":" -f 2 | tr -d '[:space:]')
                if [ "$(ls -1 | grep "^RAxML" | wc -l)" -ne 0 ]
		then
			rm RAxML*
		fi
        	raxml -f a -T 2 -m PROTGAMMA$RAxMLmodel         	-p 12345 -x 12345 -# 100         	-s ../../per_gene/EOG091G1AP6/ALICUT_EOG091G1AP6.clustalo.fasta -n EOG091G1AP6.clustalo.aln.ALICUT.$RAxMLmodel 		1> ../../per_gene/EOG091G1AP6/infer_single_ML.stdout.txt 2> ../../per_gene/EOG091G1AP6/infer_single_ML.stderr.txt
	else
		echo "fasta file per_gene/EOG091G1AP6/ALICUT_EOG091G1AP6.clustalo.fasta contains fewer than 5 sequences - skipped" > ../../per_gene/EOG091G1AP6/infer_single_ML.stdout.txt
		touch raxml.skipped
	fi
        touch ../../per_gene/EOG091G1AP6/EOG091G1AP6.raxml.done
        
[33mJob counts:
	count	jobs
	1	infer_single_ML
	1[0m
[33m
        cd per_gene/EOG091G1AP6
	count=$(cat ../../per_gene/EOG091G1AP6/ALICUT_EOG091G1AP6.clustalo.fasta | grep ">" | wc -l)
	if [ "$count" -gt 5 ]
        then
		RAxMLmodel=$(cat ../../per_gene/EOG091G1AP6/EOG091G1AP6.best_model | grep "Best" | cut -d ":" -f 2 | tr -d '[:space:]')
                if [ "$(ls -1 | grep "^RAxML" | wc -l)" -ne 0 ]
		then
			rm RAxML*
		fi
        	raxml -f a -T 2 -m PROTGAMMA$RAxMLmodel         	-p 12345 -x 12345 -# 100         	-s ../../per_gene/EOG091G1AP6/ALICUT_EOG091G1AP6.clustalo.fasta -n EOG091G1AP6.clustalo.aln.ALICUT.$RAxMLmodel 		1> ../../per_gene/EOG091G1AP6/infer_single_ML.stdout.txt 2> ../../per_gene/EOG091G1AP6/infer_single_ML.stderr.txt
	else
		echo "fasta file per_gene/EOG091G1AP6/ALICUT_EOG091G1AP6.clustalo.fasta contains fewer than 5 sequences - skipped" > ../../per_gene/EOG091G1AP6/infer_single_ML.stdout.txt
		touch raxml.skipped
	fi
        touch ../../per_gene/EOG091G1AP6/EOG091G1AP6.raxml.done
        [0m
[Sun Jul  5 21:41:04 2020]
Finished job 1120.
302 of 3292 steps (9%) done

[Sun Jul  5 21:41:04 2020]
rule infer_single_ML:
    input: per_gene/EOG091G0AVP/EOG091G0AVP.best_model, per_gene/EOG091G0AVP/ALICUT_EOG091G0AVP.clustalo.fasta
    output: per_gene/EOG091G0AVP/EOG091G0AVP.raxml.done
    log: per_gene/EOG091G0AVP/infer_single_ML.stdout.txt, per_gene/EOG091G0AVP/infer_single_ML.stderr.txt
    jobid: 354
    wildcards: BUSCO=EOG091G0AVP
    threads: 2


        cd per_gene/EOG091G0AVP
	count=$(cat ../../per_gene/EOG091G0AVP/ALICUT_EOG091G0AVP.clustalo.fasta | grep ">" | wc -l)
	if [ "$count" -gt 5 ]
        then
		RAxMLmodel=$(cat ../../per_gene/EOG091G0AVP/EOG091G0AVP.best_model | grep "Best" | cut -d ":" -f 2 | tr -d '[:space:]')
                if [ "$(ls -1 | grep "^RAxML" | wc -l)" -ne 0 ]
		then
			rm RAxML*
		fi
        	raxml -f a -T 2 -m PROTGAMMA$RAxMLmodel         	-p 12345 -x 12345 -# 100         	-s ../../per_gene/EOG091G0AVP/ALICUT_EOG091G0AVP.clustalo.fasta -n EOG091G0AVP.clustalo.aln.ALICUT.$RAxMLmodel 		1> ../../per_gene/EOG091G0AVP/infer_single_ML.stdout.txt 2> ../../per_gene/EOG091G0AVP/infer_single_ML.stderr.txt
	else
		echo "fasta file per_gene/EOG091G0AVP/ALICUT_EOG091G0AVP.clustalo.fasta contains fewer than 5 sequences - skipped" > ../../per_gene/EOG091G0AVP/infer_single_ML.stdout.txt
		touch raxml.skipped
	fi
        touch ../../per_gene/EOG091G0AVP/EOG091G0AVP.raxml.done
        
[33mJob counts:
	count	jobs
	1	infer_single_ML
	1[0m
[33m
        cd per_gene/EOG091G0AVP
	count=$(cat ../../per_gene/EOG091G0AVP/ALICUT_EOG091G0AVP.clustalo.fasta | grep ">" | wc -l)
	if [ "$count" -gt 5 ]
        then
		RAxMLmodel=$(cat ../../per_gene/EOG091G0AVP/EOG091G0AVP.best_model | grep "Best" | cut -d ":" -f 2 | tr -d '[:space:]')
                if [ "$(ls -1 | grep "^RAxML" | wc -l)" -ne 0 ]
		then
			rm RAxML*
		fi
        	raxml -f a -T 2 -m PROTGAMMA$RAxMLmodel         	-p 12345 -x 12345 -# 100         	-s ../../per_gene/EOG091G0AVP/ALICUT_EOG091G0AVP.clustalo.fasta -n EOG091G0AVP.clustalo.aln.ALICUT.$RAxMLmodel 		1> ../../per_gene/EOG091G0AVP/infer_single_ML.stdout.txt 2> ../../per_gene/EOG091G0AVP/infer_single_ML.stderr.txt
	else
		echo "fasta file per_gene/EOG091G0AVP/ALICUT_EOG091G0AVP.clustalo.fasta contains fewer than 5 sequences - skipped" > ../../per_gene/EOG091G0AVP/infer_single_ML.stdout.txt
		touch raxml.skipped
	fi
        touch ../../per_gene/EOG091G0AVP/EOG091G0AVP.raxml.done
        [0m
[Sun Jul  5 21:41:09 2020]
Finished job 352.
303 of 3292 steps (9%) done

[Sun Jul  5 21:41:09 2020]
rule get_seqs:
    input: /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ingroup.txt, /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/outgroup.txt
    output: per_gene/EOG091G02FR/EOG091G02FR.ingroup.fasta
    log: per_gene/EOG091G02FR/get_seqs.stdout.txt, per_gene/EOG091G02FR/get_seqs.stderr.txt
    jobid: 3116
    wildcards: BUSCO=EOG091G02FR
    threads: 2


	basedir=$(pwd)
        cd per_gene/EOG091G02FR
        
        bash $basedir/../scripts/fetch_seqs.sh EOG091G02FR /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ingroup.txt /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/outgroup.txt 1> ../../per_gene/EOG091G02FR/get_seqs.stdout.txt 2> ../../per_gene/EOG091G02FR/get_seqs.stderr.txt
	mv EOG091G02FR.fasta $basedir/per_gene/EOG091G02FR/EOG091G02FR.ingroup.fasta
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/72476f9d9a5bd0627b4d721143a21354.simg
[Sun Jul  5 21:41:22 2020]
Finished job 3116.
304 of 3292 steps (9%) done

[Sun Jul  5 21:41:22 2020]
rule get_outgroups:
    input: per_gene/EOG091G02FR/EOG091G02FR.ingroup.fasta
    output: per_gene/EOG091G02FR/EOG091G02FR.orthodb.fasta, per_gene/EOG091G02FR/EOG091G02FR.outgroup.fasta
    log: per_gene/EOG091G02FR/get_outgroups.stdout.txt, per_gene/EOG091G02FR/get_outgroups.stderr.txt
    jobid: 3117
    wildcards: BUSCO=EOG091G02FR


        #download fastas from Orhtodb for BUSCO id
        for i in {1..5}
        do
             wget "http://www.orthodb.org/fasta?query=EOG091G02FR&level=33208" -O per_gene/EOG091G02FR/EOG091G02FR.orthodb.fasta 1> per_gene/EOG091G02FR/get_outgroups.stdout.txt 2> per_gene/EOG091G02FR/get_outgroups.stderr.txt && break || echo -e "try again ($i)" && sleep 15
        done

	#This is quick an dirty for now and just takes the first protein if there is more than one for an outgroup taxon
        bash ../scripts/download_outgroups.sh taxids.txt per_gene/EOG091G02FR/EOG091G02FR.orthodb.fasta > per_gene/EOG091G02FR/EOG091G02FR.outgroup.fasta
        
[Sun Jul  5 21:41:24 2020]
Finished job 3117.
305 of 3292 steps (9%) done

[Sun Jul  5 21:41:24 2020]
rule join_groups:
    input: per_gene/EOG091G02FR/EOG091G02FR.ingroup.fasta, per_gene/EOG091G02FR/EOG091G02FR.outgroup.fasta
    output: per_gene/EOG091G02FR/EOG091G02FR.fasta
    jobid: 2382
    wildcards: BUSCO=EOG091G02FR


        cat per_gene/EOG091G02FR/EOG091G02FR.ingroup.fasta per_gene/EOG091G02FR/EOG091G02FR.outgroup.fasta > per_gene/EOG091G02FR/EOG091G02FR.fasta
        
[Sun Jul  5 21:41:24 2020]
Finished job 2382.
306 of 3292 steps (9%) done

[Sun Jul  5 21:41:24 2020]
rule MSA:
    input: per_gene/EOG091G02FR/EOG091G02FR.fasta
    output: per_gene/EOG091G02FR/EOG091G02FR.clustalo.fasta
    log: per_gene/EOG091G02FR/MSA.stdout.txt, per_gene/EOG091G02FR/MSA.stderr.txt
    jobid: 1884
    wildcards: BUSCO=EOG091G02FR
    threads: 2


        clustalo -i per_gene/EOG091G02FR/EOG091G02FR.fasta -o per_gene/EOG091G02FR/EOG091G02FR.clustalo.fasta --threads=2 1> per_gene/EOG091G02FR/MSA.stdout.txt 2> per_gene/EOG091G02FR/MSA.stderr.txt
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/d68c9691725a7401923680874285c430.simg
[Sun Jul  5 21:41:29 2020]
Finished job 1884.
307 of 3292 steps (9%) done

[Sun Jul  5 21:41:29 2020]
rule score_and_cut:
    input: per_gene/EOG091G02FR/EOG091G02FR.clustalo.fasta
    output: per_gene/EOG091G02FR/ALICUT_EOG091G02FR.clustalo.fasta
    jobid: 1061
    wildcards: BUSCO=EOG091G02FR
    threads: 2


        cd per_gene/EOG091G02FR
        Aliscore.pl -N -r 200000000000000000 -i ../../per_gene/EOG091G02FR/EOG091G02FR.clustalo.fasta &> aliscore.log
        ALICUT.pl -s &> alicut.log
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/63c88c27a0fa300f57066b0ef65fefcb.simg
[Sun Jul  5 21:41:34 2020]
Finished job 15.
308 of 3292 steps (9%) done

[Sun Jul  5 21:41:34 2020]
rule get_seqs:
    input: /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ingroup.txt, /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/outgroup.txt
    output: per_gene/EOG091G03AN/EOG091G03AN.ingroup.fasta
    log: per_gene/EOG091G03AN/get_seqs.stdout.txt, per_gene/EOG091G03AN/get_seqs.stderr.txt
    jobid: 2504
    wildcards: BUSCO=EOG091G03AN
    threads: 2


	basedir=$(pwd)
        cd per_gene/EOG091G03AN
        
        bash $basedir/../scripts/fetch_seqs.sh EOG091G03AN /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ingroup.txt /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/outgroup.txt 1> ../../per_gene/EOG091G03AN/get_seqs.stdout.txt 2> ../../per_gene/EOG091G03AN/get_seqs.stderr.txt
	mv EOG091G03AN.fasta $basedir/per_gene/EOG091G03AN/EOG091G03AN.ingroup.fasta
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/72476f9d9a5bd0627b4d721143a21354.simg
[Sun Jul  5 21:41:36 2020]
Finished job 608.
309 of 3292 steps (9%) done

[Sun Jul  5 21:41:36 2020]
rule infer_single_ML:
    input: per_gene/EOG091G0DYW/EOG091G0DYW.best_model, per_gene/EOG091G0DYW/ALICUT_EOG091G0DYW.clustalo.fasta
    output: per_gene/EOG091G0DYW/EOG091G0DYW.raxml.done
    log: per_gene/EOG091G0DYW/infer_single_ML.stdout.txt, per_gene/EOG091G0DYW/infer_single_ML.stderr.txt
    jobid: 98
    wildcards: BUSCO=EOG091G0DYW
    threads: 2


        cd per_gene/EOG091G0DYW
	count=$(cat ../../per_gene/EOG091G0DYW/ALICUT_EOG091G0DYW.clustalo.fasta | grep ">" | wc -l)
	if [ "$count" -gt 5 ]
        then
		RAxMLmodel=$(cat ../../per_gene/EOG091G0DYW/EOG091G0DYW.best_model | grep "Best" | cut -d ":" -f 2 | tr -d '[:space:]')
                if [ "$(ls -1 | grep "^RAxML" | wc -l)" -ne 0 ]
		then
			rm RAxML*
		fi
        	raxml -f a -T 2 -m PROTGAMMA$RAxMLmodel         	-p 12345 -x 12345 -# 100         	-s ../../per_gene/EOG091G0DYW/ALICUT_EOG091G0DYW.clustalo.fasta -n EOG091G0DYW.clustalo.aln.ALICUT.$RAxMLmodel 		1> ../../per_gene/EOG091G0DYW/infer_single_ML.stdout.txt 2> ../../per_gene/EOG091G0DYW/infer_single_ML.stderr.txt
	else
		echo "fasta file per_gene/EOG091G0DYW/ALICUT_EOG091G0DYW.clustalo.fasta contains fewer than 5 sequences - skipped" > ../../per_gene/EOG091G0DYW/infer_single_ML.stdout.txt
		touch raxml.skipped
	fi
        touch ../../per_gene/EOG091G0DYW/EOG091G0DYW.raxml.done
        
[33mJob counts:
	count	jobs
	1	infer_single_ML
	1[0m
[33m
        cd per_gene/EOG091G0DYW
	count=$(cat ../../per_gene/EOG091G0DYW/ALICUT_EOG091G0DYW.clustalo.fasta | grep ">" | wc -l)
	if [ "$count" -gt 5 ]
        then
		RAxMLmodel=$(cat ../../per_gene/EOG091G0DYW/EOG091G0DYW.best_model | grep "Best" | cut -d ":" -f 2 | tr -d '[:space:]')
                if [ "$(ls -1 | grep "^RAxML" | wc -l)" -ne 0 ]
		then
			rm RAxML*
		fi
        	raxml -f a -T 2 -m PROTGAMMA$RAxMLmodel         	-p 12345 -x 12345 -# 100         	-s ../../per_gene/EOG091G0DYW/ALICUT_EOG091G0DYW.clustalo.fasta -n EOG091G0DYW.clustalo.aln.ALICUT.$RAxMLmodel 		1> ../../per_gene/EOG091G0DYW/infer_single_ML.stdout.txt 2> ../../per_gene/EOG091G0DYW/infer_single_ML.stderr.txt
	else
		echo "fasta file per_gene/EOG091G0DYW/ALICUT_EOG091G0DYW.clustalo.fasta contains fewer than 5 sequences - skipped" > ../../per_gene/EOG091G0DYW/infer_single_ML.stdout.txt
		touch raxml.skipped
	fi
        touch ../../per_gene/EOG091G0DYW/EOG091G0DYW.raxml.done
        [0m
[Sun Jul  5 21:41:41 2020]
Finished job 1061.
310 of 3292 steps (9%) done

[Sun Jul  5 21:41:41 2020]
rule remove_empty:
    input: per_gene/EOG091G02FR/ALICUT_EOG091G02FR.clustalo.fasta
    output: per_gene/EOG091G02FR/empty_check.done
    jobid: 1883
    wildcards: BUSCO=EOG091G02FR


         if [ "$(cat per_gene/EOG091G02FR/ALICUT_EOG091G02FR.clustalo.fasta | grep -v ">" | sed 's/-//g' | grep "^$" | wc -l)" -gt 0 ]
         then
              cp per_gene/EOG091G02FR/ALICUT_EOG091G02FR.clustalo.fasta per_gene/EOG091G02FR/ALICUT_EOG091G02FR.clustalo.fasta.backup
              bash ../scripts/remove_empty.sh per_gene/EOG091G02FR/ALICUT_EOG091G02FR.clustalo.fasta.backup > per_gene/EOG091G02FR/ALICUT_EOG091G02FR.clustalo.fasta
         fi
         touch per_gene/EOG091G02FR/empty_check.done
         
[Sun Jul  5 21:41:41 2020]
Finished job 1883.
311 of 3292 steps (9%) done

[Sun Jul  5 21:41:41 2020]
rule find_best_model:
    input: per_gene/EOG091G02FR/ALICUT_EOG091G02FR.clustalo.fasta, per_gene/EOG091G02FR/empty_check.done
    output: per_gene/EOG091G02FR/EOG091G02FR.best_model
    log: per_gene/EOG091G02FR/find_best_model.stderr.txt
    jobid: 1060
    wildcards: BUSCO=EOG091G02FR
    threads: 2


        cd per_gene/EOG091G02FR
        if [ ! -d find_best_model ]
        then
            mkdir find_best_model
        fi
        cd find_best_model
        ln -s ../../../per_gene/EOG091G02FR/ALICUT_EOG091G02FR.clustalo.fasta EOG091G02FR.fasta
        ProteinModelSelection.pl EOG091G02FR.fasta 1> ../../../per_gene/EOG091G02FR/EOG091G02FR.best_model 2> ../../../per_gene/EOG091G02FR/find_best_model.stderr.txt
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/c0c09ee657b1e27f2c5687e0e9aa8d70.simg
[Sun Jul  5 21:41:52 2020]
Finished job 2504.
312 of 3292 steps (9%) done

[Sun Jul  5 21:41:52 2020]
rule get_outgroups:
    input: per_gene/EOG091G03AN/EOG091G03AN.ingroup.fasta
    output: per_gene/EOG091G03AN/EOG091G03AN.orthodb.fasta, per_gene/EOG091G03AN/EOG091G03AN.outgroup.fasta
    log: per_gene/EOG091G03AN/get_outgroups.stdout.txt, per_gene/EOG091G03AN/get_outgroups.stderr.txt
    jobid: 2505
    wildcards: BUSCO=EOG091G03AN


        #download fastas from Orhtodb for BUSCO id
        for i in {1..5}
        do
             wget "http://www.orthodb.org/fasta?query=EOG091G03AN&level=33208" -O per_gene/EOG091G03AN/EOG091G03AN.orthodb.fasta 1> per_gene/EOG091G03AN/get_outgroups.stdout.txt 2> per_gene/EOG091G03AN/get_outgroups.stderr.txt && break || echo -e "try again ($i)" && sleep 15
        done

	#This is quick an dirty for now and just takes the first protein if there is more than one for an outgroup taxon
        bash ../scripts/download_outgroups.sh taxids.txt per_gene/EOG091G03AN/EOG091G03AN.orthodb.fasta > per_gene/EOG091G03AN/EOG091G03AN.outgroup.fasta
        
[Sun Jul  5 21:41:54 2020]
Finished job 2505.
313 of 3292 steps (10%) done

[Sun Jul  5 21:41:54 2020]
rule join_groups:
    input: per_gene/EOG091G03AN/EOG091G03AN.ingroup.fasta, per_gene/EOG091G03AN/EOG091G03AN.outgroup.fasta
    output: per_gene/EOG091G03AN/EOG091G03AN.fasta
    jobid: 2076
    wildcards: BUSCO=EOG091G03AN


        cat per_gene/EOG091G03AN/EOG091G03AN.ingroup.fasta per_gene/EOG091G03AN/EOG091G03AN.outgroup.fasta > per_gene/EOG091G03AN/EOG091G03AN.fasta
        
[Sun Jul  5 21:41:54 2020]
Finished job 2076.
314 of 3292 steps (10%) done

[Sun Jul  5 21:41:54 2020]
rule MSA:
    input: per_gene/EOG091G03AN/EOG091G03AN.fasta
    output: per_gene/EOG091G03AN/EOG091G03AN.clustalo.fasta
    log: per_gene/EOG091G03AN/MSA.stdout.txt, per_gene/EOG091G03AN/MSA.stderr.txt
    jobid: 1272
    wildcards: BUSCO=EOG091G03AN
    threads: 2


        clustalo -i per_gene/EOG091G03AN/EOG091G03AN.fasta -o per_gene/EOG091G03AN/EOG091G03AN.clustalo.fasta --threads=2 1> per_gene/EOG091G03AN/MSA.stdout.txt 2> per_gene/EOG091G03AN/MSA.stderr.txt
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/d68c9691725a7401923680874285c430.simg
[Sun Jul  5 21:41:54 2020]
Finished job 1018.
315 of 3292 steps (10%) done

[Sun Jul  5 21:41:54 2020]
rule infer_single_ML:
    input: per_gene/EOG091G088L/EOG091G088L.best_model, per_gene/EOG091G088L/ALICUT_EOG091G088L.clustalo.fasta
    output: per_gene/EOG091G088L/EOG091G088L.raxml.done
    log: per_gene/EOG091G088L/infer_single_ML.stdout.txt, per_gene/EOG091G088L/infer_single_ML.stderr.txt
    jobid: 303
    wildcards: BUSCO=EOG091G088L
    threads: 2


        cd per_gene/EOG091G088L
	count=$(cat ../../per_gene/EOG091G088L/ALICUT_EOG091G088L.clustalo.fasta | grep ">" | wc -l)
	if [ "$count" -gt 5 ]
        then
		RAxMLmodel=$(cat ../../per_gene/EOG091G088L/EOG091G088L.best_model | grep "Best" | cut -d ":" -f 2 | tr -d '[:space:]')
                if [ "$(ls -1 | grep "^RAxML" | wc -l)" -ne 0 ]
		then
			rm RAxML*
		fi
        	raxml -f a -T 2 -m PROTGAMMA$RAxMLmodel         	-p 12345 -x 12345 -# 100         	-s ../../per_gene/EOG091G088L/ALICUT_EOG091G088L.clustalo.fasta -n EOG091G088L.clustalo.aln.ALICUT.$RAxMLmodel 		1> ../../per_gene/EOG091G088L/infer_single_ML.stdout.txt 2> ../../per_gene/EOG091G088L/infer_single_ML.stderr.txt
	else
		echo "fasta file per_gene/EOG091G088L/ALICUT_EOG091G088L.clustalo.fasta contains fewer than 5 sequences - skipped" > ../../per_gene/EOG091G088L/infer_single_ML.stdout.txt
		touch raxml.skipped
	fi
        touch ../../per_gene/EOG091G088L/EOG091G088L.raxml.done
        
[33mJob counts:
	count	jobs
	1	infer_single_ML
	1[0m
[33m
        cd per_gene/EOG091G088L
	count=$(cat ../../per_gene/EOG091G088L/ALICUT_EOG091G088L.clustalo.fasta | grep ">" | wc -l)
	if [ "$count" -gt 5 ]
        then
		RAxMLmodel=$(cat ../../per_gene/EOG091G088L/EOG091G088L.best_model | grep "Best" | cut -d ":" -f 2 | tr -d '[:space:]')
                if [ "$(ls -1 | grep "^RAxML" | wc -l)" -ne 0 ]
		then
			rm RAxML*
		fi
        	raxml -f a -T 2 -m PROTGAMMA$RAxMLmodel         	-p 12345 -x 12345 -# 100         	-s ../../per_gene/EOG091G088L/ALICUT_EOG091G088L.clustalo.fasta -n EOG091G088L.clustalo.aln.ALICUT.$RAxMLmodel 		1> ../../per_gene/EOG091G088L/infer_single_ML.stdout.txt 2> ../../per_gene/EOG091G088L/infer_single_ML.stderr.txt
	else
		echo "fasta file per_gene/EOG091G088L/ALICUT_EOG091G088L.clustalo.fasta contains fewer than 5 sequences - skipped" > ../../per_gene/EOG091G088L/infer_single_ML.stdout.txt
		touch raxml.skipped
	fi
        touch ../../per_gene/EOG091G088L/EOG091G088L.raxml.done
        [0m
[Sun Jul  5 21:41:58 2020]
Finished job 1272.
316 of 3292 steps (10%) done

[Sun Jul  5 21:41:58 2020]
rule score_and_cut:
    input: per_gene/EOG091G03AN/EOG091G03AN.clustalo.fasta
    output: per_gene/EOG091G03AN/ALICUT_EOG091G03AN.clustalo.fasta
    jobid: 449
    wildcards: BUSCO=EOG091G03AN
    threads: 2


        cd per_gene/EOG091G03AN
        Aliscore.pl -N -r 200000000000000000 -i ../../per_gene/EOG091G03AN/EOG091G03AN.clustalo.fasta &> aliscore.log
        ALICUT.pl -s &> alicut.log
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/63c88c27a0fa300f57066b0ef65fefcb.simg
[Sun Jul  5 21:41:59 2020]
Finished job 149.
317 of 3292 steps (10%) done

[Sun Jul  5 21:41:59 2020]
rule get_seqs:
    input: /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ingroup.txt, /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/outgroup.txt
    output: per_gene/EOG091G0O6E/EOG091G0O6E.ingroup.fasta
    log: per_gene/EOG091G0O6E/get_seqs.stdout.txt, per_gene/EOG091G0O6E/get_seqs.stderr.txt
    jobid: 2794
    wildcards: BUSCO=EOG091G0O6E
    threads: 2


	basedir=$(pwd)
        cd per_gene/EOG091G0O6E
        
        bash $basedir/../scripts/fetch_seqs.sh EOG091G0O6E /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ingroup.txt /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/outgroup.txt 1> ../../per_gene/EOG091G0O6E/get_seqs.stdout.txt 2> ../../per_gene/EOG091G0O6E/get_seqs.stderr.txt
	mv EOG091G0O6E.fasta $basedir/per_gene/EOG091G0O6E/EOG091G0O6E.ingroup.fasta
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/72476f9d9a5bd0627b4d721143a21354.simg
[Sun Jul  5 21:42:10 2020]
Finished job 449.
318 of 3292 steps (10%) done

[Sun Jul  5 21:42:10 2020]
rule remove_empty:
    input: per_gene/EOG091G03AN/ALICUT_EOG091G03AN.clustalo.fasta
    output: per_gene/EOG091G03AN/empty_check.done
    jobid: 1271
    wildcards: BUSCO=EOG091G03AN


         if [ "$(cat per_gene/EOG091G03AN/ALICUT_EOG091G03AN.clustalo.fasta | grep -v ">" | sed 's/-//g' | grep "^$" | wc -l)" -gt 0 ]
         then
              cp per_gene/EOG091G03AN/ALICUT_EOG091G03AN.clustalo.fasta per_gene/EOG091G03AN/ALICUT_EOG091G03AN.clustalo.fasta.backup
              bash ../scripts/remove_empty.sh per_gene/EOG091G03AN/ALICUT_EOG091G03AN.clustalo.fasta.backup > per_gene/EOG091G03AN/ALICUT_EOG091G03AN.clustalo.fasta
         fi
         touch per_gene/EOG091G03AN/empty_check.done
         
[Sun Jul  5 21:42:10 2020]
Finished job 1271.
319 of 3292 steps (10%) done

[Sun Jul  5 21:42:10 2020]
rule find_best_model:
    input: per_gene/EOG091G03AN/ALICUT_EOG091G03AN.clustalo.fasta, per_gene/EOG091G03AN/empty_check.done
    output: per_gene/EOG091G03AN/EOG091G03AN.best_model
    log: per_gene/EOG091G03AN/find_best_model.stderr.txt
    jobid: 448
    wildcards: BUSCO=EOG091G03AN
    threads: 2


        cd per_gene/EOG091G03AN
        if [ ! -d find_best_model ]
        then
            mkdir find_best_model
        fi
        cd find_best_model
        ln -s ../../../per_gene/EOG091G03AN/ALICUT_EOG091G03AN.clustalo.fasta EOG091G03AN.fasta
        ProteinModelSelection.pl EOG091G03AN.fasta 1> ../../../per_gene/EOG091G03AN/EOG091G03AN.best_model 2> ../../../per_gene/EOG091G03AN/find_best_model.stderr.txt
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/c0c09ee657b1e27f2c5687e0e9aa8d70.simg
[Sun Jul  5 21:42:12 2020]
Finished job 2794.
320 of 3292 steps (10%) done

[Sun Jul  5 21:42:12 2020]
rule get_outgroups:
    input: per_gene/EOG091G0O6E/EOG091G0O6E.ingroup.fasta
    output: per_gene/EOG091G0O6E/EOG091G0O6E.orthodb.fasta, per_gene/EOG091G0O6E/EOG091G0O6E.outgroup.fasta
    log: per_gene/EOG091G0O6E/get_outgroups.stdout.txt, per_gene/EOG091G0O6E/get_outgroups.stderr.txt
    jobid: 2795
    wildcards: BUSCO=EOG091G0O6E


        #download fastas from Orhtodb for BUSCO id
        for i in {1..5}
        do
             wget "http://www.orthodb.org/fasta?query=EOG091G0O6E&level=33208" -O per_gene/EOG091G0O6E/EOG091G0O6E.orthodb.fasta 1> per_gene/EOG091G0O6E/get_outgroups.stdout.txt 2> per_gene/EOG091G0O6E/get_outgroups.stderr.txt && break || echo -e "try again ($i)" && sleep 15
        done

	#This is quick an dirty for now and just takes the first protein if there is more than one for an outgroup taxon
        bash ../scripts/download_outgroups.sh taxids.txt per_gene/EOG091G0O6E/EOG091G0O6E.orthodb.fasta > per_gene/EOG091G0O6E/EOG091G0O6E.outgroup.fasta
        
[Sun Jul  5 21:42:13 2020]
Finished job 2795.
321 of 3292 steps (10%) done

[Sun Jul  5 21:42:13 2020]
rule join_groups:
    input: per_gene/EOG091G0O6E/EOG091G0O6E.ingroup.fasta, per_gene/EOG091G0O6E/EOG091G0O6E.outgroup.fasta
    output: per_gene/EOG091G0O6E/EOG091G0O6E.fasta
    jobid: 2221
    wildcards: BUSCO=EOG091G0O6E


        cat per_gene/EOG091G0O6E/EOG091G0O6E.ingroup.fasta per_gene/EOG091G0O6E/EOG091G0O6E.outgroup.fasta > per_gene/EOG091G0O6E/EOG091G0O6E.fasta
        
[Sun Jul  5 21:42:13 2020]
Finished job 2221.
322 of 3292 steps (10%) done

[Sun Jul  5 21:42:14 2020]
rule MSA:
    input: per_gene/EOG091G0O6E/EOG091G0O6E.fasta
    output: per_gene/EOG091G0O6E/EOG091G0O6E.clustalo.fasta
    log: per_gene/EOG091G0O6E/MSA.stdout.txt, per_gene/EOG091G0O6E/MSA.stderr.txt
    jobid: 1562
    wildcards: BUSCO=EOG091G0O6E
    threads: 2


        clustalo -i per_gene/EOG091G0O6E/EOG091G0O6E.fasta -o per_gene/EOG091G0O6E/EOG091G0O6E.clustalo.fasta --threads=2 1> per_gene/EOG091G0O6E/MSA.stdout.txt 2> per_gene/EOG091G0O6E/MSA.stderr.txt
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/d68c9691725a7401923680874285c430.simg
[Sun Jul  5 21:42:14 2020]
Finished job 1562.
323 of 3292 steps (10%) done

[Sun Jul  5 21:42:14 2020]
rule score_and_cut:
    input: per_gene/EOG091G0O6E/EOG091G0O6E.clustalo.fasta
    output: per_gene/EOG091G0O6E/ALICUT_EOG091G0O6E.clustalo.fasta
    jobid: 739
    wildcards: BUSCO=EOG091G0O6E
    threads: 2


        cd per_gene/EOG091G0O6E
        Aliscore.pl -N -r 200000000000000000 -i ../../per_gene/EOG091G0O6E/EOG091G0O6E.clustalo.fasta &> aliscore.log
        ALICUT.pl -s &> alicut.log
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/63c88c27a0fa300f57066b0ef65fefcb.simg
[Sun Jul  5 21:42:25 2020]
Finished job 739.
324 of 3292 steps (10%) done

[Sun Jul  5 21:42:25 2020]
rule remove_empty:
    input: per_gene/EOG091G0O6E/ALICUT_EOG091G0O6E.clustalo.fasta
    output: per_gene/EOG091G0O6E/empty_check.done
    jobid: 1561
    wildcards: BUSCO=EOG091G0O6E


         if [ "$(cat per_gene/EOG091G0O6E/ALICUT_EOG091G0O6E.clustalo.fasta | grep -v ">" | sed 's/-//g' | grep "^$" | wc -l)" -gt 0 ]
         then
              cp per_gene/EOG091G0O6E/ALICUT_EOG091G0O6E.clustalo.fasta per_gene/EOG091G0O6E/ALICUT_EOG091G0O6E.clustalo.fasta.backup
              bash ../scripts/remove_empty.sh per_gene/EOG091G0O6E/ALICUT_EOG091G0O6E.clustalo.fasta.backup > per_gene/EOG091G0O6E/ALICUT_EOG091G0O6E.clustalo.fasta
         fi
         touch per_gene/EOG091G0O6E/empty_check.done
         
[Sun Jul  5 21:42:25 2020]
Finished job 1561.
325 of 3292 steps (10%) done

[Sun Jul  5 21:42:25 2020]
rule find_best_model:
    input: per_gene/EOG091G0O6E/ALICUT_EOG091G0O6E.clustalo.fasta, per_gene/EOG091G0O6E/empty_check.done
    output: per_gene/EOG091G0O6E/EOG091G0O6E.best_model
    log: per_gene/EOG091G0O6E/find_best_model.stderr.txt
    jobid: 738
    wildcards: BUSCO=EOG091G0O6E
    threads: 2


        cd per_gene/EOG091G0O6E
        if [ ! -d find_best_model ]
        then
            mkdir find_best_model
        fi
        cd find_best_model
        ln -s ../../../per_gene/EOG091G0O6E/ALICUT_EOG091G0O6E.clustalo.fasta EOG091G0O6E.fasta
        ProteinModelSelection.pl EOG091G0O6E.fasta 1> ../../../per_gene/EOG091G0O6E/EOG091G0O6E.best_model 2> ../../../per_gene/EOG091G0O6E/find_best_model.stderr.txt
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/c0c09ee657b1e27f2c5687e0e9aa8d70.simg
[Sun Jul  5 21:42:25 2020]
Finished job 1060.
326 of 3292 steps (10%) done

[Sun Jul  5 21:42:25 2020]
rule infer_single_ML:
    input: per_gene/EOG091G02FR/EOG091G02FR.best_model, per_gene/EOG091G02FR/ALICUT_EOG091G02FR.clustalo.fasta
    output: per_gene/EOG091G02FR/EOG091G02FR.raxml.done
    log: per_gene/EOG091G02FR/infer_single_ML.stdout.txt, per_gene/EOG091G02FR/infer_single_ML.stderr.txt
    jobid: 324
    wildcards: BUSCO=EOG091G02FR
    threads: 2


        cd per_gene/EOG091G02FR
	count=$(cat ../../per_gene/EOG091G02FR/ALICUT_EOG091G02FR.clustalo.fasta | grep ">" | wc -l)
	if [ "$count" -gt 5 ]
        then
		RAxMLmodel=$(cat ../../per_gene/EOG091G02FR/EOG091G02FR.best_model | grep "Best" | cut -d ":" -f 2 | tr -d '[:space:]')
                if [ "$(ls -1 | grep "^RAxML" | wc -l)" -ne 0 ]
		then
			rm RAxML*
		fi
        	raxml -f a -T 2 -m PROTGAMMA$RAxMLmodel         	-p 12345 -x 12345 -# 100         	-s ../../per_gene/EOG091G02FR/ALICUT_EOG091G02FR.clustalo.fasta -n EOG091G02FR.clustalo.aln.ALICUT.$RAxMLmodel 		1> ../../per_gene/EOG091G02FR/infer_single_ML.stdout.txt 2> ../../per_gene/EOG091G02FR/infer_single_ML.stderr.txt
	else
		echo "fasta file per_gene/EOG091G02FR/ALICUT_EOG091G02FR.clustalo.fasta contains fewer than 5 sequences - skipped" > ../../per_gene/EOG091G02FR/infer_single_ML.stdout.txt
		touch raxml.skipped
	fi
        touch ../../per_gene/EOG091G02FR/EOG091G02FR.raxml.done
        
[33mJob counts:
	count	jobs
	1	infer_single_ML
	1[0m
[33m
        cd per_gene/EOG091G02FR
	count=$(cat ../../per_gene/EOG091G02FR/ALICUT_EOG091G02FR.clustalo.fasta | grep ">" | wc -l)
	if [ "$count" -gt 5 ]
        then
		RAxMLmodel=$(cat ../../per_gene/EOG091G02FR/EOG091G02FR.best_model | grep "Best" | cut -d ":" -f 2 | tr -d '[:space:]')
                if [ "$(ls -1 | grep "^RAxML" | wc -l)" -ne 0 ]
		then
			rm RAxML*
		fi
        	raxml -f a -T 2 -m PROTGAMMA$RAxMLmodel         	-p 12345 -x 12345 -# 100         	-s ../../per_gene/EOG091G02FR/ALICUT_EOG091G02FR.clustalo.fasta -n EOG091G02FR.clustalo.aln.ALICUT.$RAxMLmodel 		1> ../../per_gene/EOG091G02FR/infer_single_ML.stdout.txt 2> ../../per_gene/EOG091G02FR/infer_single_ML.stderr.txt
	else
		echo "fasta file per_gene/EOG091G02FR/ALICUT_EOG091G02FR.clustalo.fasta contains fewer than 5 sequences - skipped" > ../../per_gene/EOG091G02FR/infer_single_ML.stdout.txt
		touch raxml.skipped
	fi
        touch ../../per_gene/EOG091G02FR/EOG091G02FR.raxml.done
        [0m
[Sun Jul  5 21:42:56 2020]
Finished job 738.
327 of 3292 steps (10%) done

[Sun Jul  5 21:42:56 2020]
rule infer_single_ML:
    input: per_gene/EOG091G0O6E/EOG091G0O6E.best_model, per_gene/EOG091G0O6E/ALICUT_EOG091G0O6E.clustalo.fasta
    output: per_gene/EOG091G0O6E/EOG091G0O6E.raxml.done
    log: per_gene/EOG091G0O6E/infer_single_ML.stdout.txt, per_gene/EOG091G0O6E/infer_single_ML.stderr.txt
    jobid: 163
    wildcards: BUSCO=EOG091G0O6E
    threads: 2


        cd per_gene/EOG091G0O6E
	count=$(cat ../../per_gene/EOG091G0O6E/ALICUT_EOG091G0O6E.clustalo.fasta | grep ">" | wc -l)
	if [ "$count" -gt 5 ]
        then
		RAxMLmodel=$(cat ../../per_gene/EOG091G0O6E/EOG091G0O6E.best_model | grep "Best" | cut -d ":" -f 2 | tr -d '[:space:]')
                if [ "$(ls -1 | grep "^RAxML" | wc -l)" -ne 0 ]
		then
			rm RAxML*
		fi
        	raxml -f a -T 2 -m PROTGAMMA$RAxMLmodel         	-p 12345 -x 12345 -# 100         	-s ../../per_gene/EOG091G0O6E/ALICUT_EOG091G0O6E.clustalo.fasta -n EOG091G0O6E.clustalo.aln.ALICUT.$RAxMLmodel 		1> ../../per_gene/EOG091G0O6E/infer_single_ML.stdout.txt 2> ../../per_gene/EOG091G0O6E/infer_single_ML.stderr.txt
	else
		echo "fasta file per_gene/EOG091G0O6E/ALICUT_EOG091G0O6E.clustalo.fasta contains fewer than 5 sequences - skipped" > ../../per_gene/EOG091G0O6E/infer_single_ML.stdout.txt
		touch raxml.skipped
	fi
        touch ../../per_gene/EOG091G0O6E/EOG091G0O6E.raxml.done
        
[33mJob counts:
	count	jobs
	1	infer_single_ML
	1[0m
[33m
        cd per_gene/EOG091G0O6E
	count=$(cat ../../per_gene/EOG091G0O6E/ALICUT_EOG091G0O6E.clustalo.fasta | grep ">" | wc -l)
	if [ "$count" -gt 5 ]
        then
		RAxMLmodel=$(cat ../../per_gene/EOG091G0O6E/EOG091G0O6E.best_model | grep "Best" | cut -d ":" -f 2 | tr -d '[:space:]')
                if [ "$(ls -1 | grep "^RAxML" | wc -l)" -ne 0 ]
		then
			rm RAxML*
		fi
        	raxml -f a -T 2 -m PROTGAMMA$RAxMLmodel         	-p 12345 -x 12345 -# 100         	-s ../../per_gene/EOG091G0O6E/ALICUT_EOG091G0O6E.clustalo.fasta -n EOG091G0O6E.clustalo.aln.ALICUT.$RAxMLmodel 		1> ../../per_gene/EOG091G0O6E/infer_single_ML.stdout.txt 2> ../../per_gene/EOG091G0O6E/infer_single_ML.stderr.txt
	else
		echo "fasta file per_gene/EOG091G0O6E/ALICUT_EOG091G0O6E.clustalo.fasta contains fewer than 5 sequences - skipped" > ../../per_gene/EOG091G0O6E/infer_single_ML.stdout.txt
		touch raxml.skipped
	fi
        touch ../../per_gene/EOG091G0O6E/EOG091G0O6E.raxml.done
        [0m
[Sun Jul  5 21:43:09 2020]
Finished job 448.
328 of 3292 steps (10%) done

[Sun Jul  5 21:43:09 2020]
rule infer_single_ML:
    input: per_gene/EOG091G03AN/EOG091G03AN.best_model, per_gene/EOG091G03AN/ALICUT_EOG091G03AN.clustalo.fasta
    output: per_gene/EOG091G03AN/EOG091G03AN.raxml.done
    log: per_gene/EOG091G03AN/infer_single_ML.stdout.txt, per_gene/EOG091G03AN/infer_single_ML.stderr.txt
    jobid: 18
    wildcards: BUSCO=EOG091G03AN
    threads: 2


        cd per_gene/EOG091G03AN
	count=$(cat ../../per_gene/EOG091G03AN/ALICUT_EOG091G03AN.clustalo.fasta | grep ">" | wc -l)
	if [ "$count" -gt 5 ]
        then
		RAxMLmodel=$(cat ../../per_gene/EOG091G03AN/EOG091G03AN.best_model | grep "Best" | cut -d ":" -f 2 | tr -d '[:space:]')
                if [ "$(ls -1 | grep "^RAxML" | wc -l)" -ne 0 ]
		then
			rm RAxML*
		fi
        	raxml -f a -T 2 -m PROTGAMMA$RAxMLmodel         	-p 12345 -x 12345 -# 100         	-s ../../per_gene/EOG091G03AN/ALICUT_EOG091G03AN.clustalo.fasta -n EOG091G03AN.clustalo.aln.ALICUT.$RAxMLmodel 		1> ../../per_gene/EOG091G03AN/infer_single_ML.stdout.txt 2> ../../per_gene/EOG091G03AN/infer_single_ML.stderr.txt
	else
		echo "fasta file per_gene/EOG091G03AN/ALICUT_EOG091G03AN.clustalo.fasta contains fewer than 5 sequences - skipped" > ../../per_gene/EOG091G03AN/infer_single_ML.stdout.txt
		touch raxml.skipped
	fi
        touch ../../per_gene/EOG091G03AN/EOG091G03AN.raxml.done
        
[33mJob counts:
	count	jobs
	1	infer_single_ML
	1[0m
[33m
        cd per_gene/EOG091G03AN
	count=$(cat ../../per_gene/EOG091G03AN/ALICUT_EOG091G03AN.clustalo.fasta | grep ">" | wc -l)
	if [ "$count" -gt 5 ]
        then
		RAxMLmodel=$(cat ../../per_gene/EOG091G03AN/EOG091G03AN.best_model | grep "Best" | cut -d ":" -f 2 | tr -d '[:space:]')
                if [ "$(ls -1 | grep "^RAxML" | wc -l)" -ne 0 ]
		then
			rm RAxML*
		fi
        	raxml -f a -T 2 -m PROTGAMMA$RAxMLmodel         	-p 12345 -x 12345 -# 100         	-s ../../per_gene/EOG091G03AN/ALICUT_EOG091G03AN.clustalo.fasta -n EOG091G03AN.clustalo.aln.ALICUT.$RAxMLmodel 		1> ../../per_gene/EOG091G03AN/infer_single_ML.stdout.txt 2> ../../per_gene/EOG091G03AN/infer_single_ML.stderr.txt
	else
		echo "fasta file per_gene/EOG091G03AN/ALICUT_EOG091G03AN.clustalo.fasta contains fewer than 5 sequences - skipped" > ../../per_gene/EOG091G03AN/infer_single_ML.stdout.txt
		touch raxml.skipped
	fi
        touch ../../per_gene/EOG091G03AN/EOG091G03AN.raxml.done
        [0m
[Sun Jul  5 21:43:31 2020]
Finished job 142.
329 of 3292 steps (10%) done

[Sun Jul  5 21:43:31 2020]
rule get_seqs:
    input: /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ingroup.txt, /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/outgroup.txt
    output: per_gene/EOG091G05Q6/EOG091G05Q6.ingroup.fasta
    log: per_gene/EOG091G05Q6/get_seqs.stdout.txt, per_gene/EOG091G05Q6/get_seqs.stderr.txt
    jobid: 2552
    wildcards: BUSCO=EOG091G05Q6
    threads: 2


	basedir=$(pwd)
        cd per_gene/EOG091G05Q6
        
        bash $basedir/../scripts/fetch_seqs.sh EOG091G05Q6 /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ingroup.txt /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/outgroup.txt 1> ../../per_gene/EOG091G05Q6/get_seqs.stdout.txt 2> ../../per_gene/EOG091G05Q6/get_seqs.stderr.txt
	mv EOG091G05Q6.fasta $basedir/per_gene/EOG091G05Q6/EOG091G05Q6.ingroup.fasta
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/72476f9d9a5bd0627b4d721143a21354.simg
[Sun Jul  5 21:43:47 2020]
Finished job 2552.
330 of 3292 steps (10%) done

[Sun Jul  5 21:43:47 2020]
rule get_outgroups:
    input: per_gene/EOG091G05Q6/EOG091G05Q6.ingroup.fasta
    output: per_gene/EOG091G05Q6/EOG091G05Q6.orthodb.fasta, per_gene/EOG091G05Q6/EOG091G05Q6.outgroup.fasta
    log: per_gene/EOG091G05Q6/get_outgroups.stdout.txt, per_gene/EOG091G05Q6/get_outgroups.stderr.txt
    jobid: 2553
    wildcards: BUSCO=EOG091G05Q6


        #download fastas from Orhtodb for BUSCO id
        for i in {1..5}
        do
             wget "http://www.orthodb.org/fasta?query=EOG091G05Q6&level=33208" -O per_gene/EOG091G05Q6/EOG091G05Q6.orthodb.fasta 1> per_gene/EOG091G05Q6/get_outgroups.stdout.txt 2> per_gene/EOG091G05Q6/get_outgroups.stderr.txt && break || echo -e "try again ($i)" && sleep 15
        done

	#This is quick an dirty for now and just takes the first protein if there is more than one for an outgroup taxon
        bash ../scripts/download_outgroups.sh taxids.txt per_gene/EOG091G05Q6/EOG091G05Q6.orthodb.fasta > per_gene/EOG091G05Q6/EOG091G05Q6.outgroup.fasta
        
[Sun Jul  5 21:43:48 2020]
Finished job 2553.
331 of 3292 steps (10%) done

[Sun Jul  5 21:43:48 2020]
rule join_groups:
    input: per_gene/EOG091G05Q6/EOG091G05Q6.ingroup.fasta, per_gene/EOG091G05Q6/EOG091G05Q6.outgroup.fasta
    output: per_gene/EOG091G05Q6/EOG091G05Q6.fasta
    jobid: 2100
    wildcards: BUSCO=EOG091G05Q6


        cat per_gene/EOG091G05Q6/EOG091G05Q6.ingroup.fasta per_gene/EOG091G05Q6/EOG091G05Q6.outgroup.fasta > per_gene/EOG091G05Q6/EOG091G05Q6.fasta
        
[Sun Jul  5 21:43:48 2020]
Finished job 2100.
332 of 3292 steps (10%) done

[Sun Jul  5 21:43:48 2020]
rule MSA:
    input: per_gene/EOG091G05Q6/EOG091G05Q6.fasta
    output: per_gene/EOG091G05Q6/EOG091G05Q6.clustalo.fasta
    log: per_gene/EOG091G05Q6/MSA.stdout.txt, per_gene/EOG091G05Q6/MSA.stderr.txt
    jobid: 1320
    wildcards: BUSCO=EOG091G05Q6
    threads: 2


        clustalo -i per_gene/EOG091G05Q6/EOG091G05Q6.fasta -o per_gene/EOG091G05Q6/EOG091G05Q6.clustalo.fasta --threads=2 1> per_gene/EOG091G05Q6/MSA.stdout.txt 2> per_gene/EOG091G05Q6/MSA.stderr.txt
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/d68c9691725a7401923680874285c430.simg
[Sun Jul  5 21:43:49 2020]
Finished job 1320.
333 of 3292 steps (10%) done

[Sun Jul  5 21:43:49 2020]
rule score_and_cut:
    input: per_gene/EOG091G05Q6/EOG091G05Q6.clustalo.fasta
    output: per_gene/EOG091G05Q6/ALICUT_EOG091G05Q6.clustalo.fasta
    jobid: 497
    wildcards: BUSCO=EOG091G05Q6
    threads: 2


        cd per_gene/EOG091G05Q6
        Aliscore.pl -N -r 200000000000000000 -i ../../per_gene/EOG091G05Q6/EOG091G05Q6.clustalo.fasta &> aliscore.log
        ALICUT.pl -s &> alicut.log
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/63c88c27a0fa300f57066b0ef65fefcb.simg
[Sun Jul  5 21:43:51 2020]
Finished job 187.
334 of 3292 steps (10%) done

[Sun Jul  5 21:43:51 2020]
rule get_seqs:
    input: /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ingroup.txt, /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/outgroup.txt
    output: per_gene/EOG091G0GOU/EOG091G0GOU.ingroup.fasta
    log: per_gene/EOG091G0GOU/get_seqs.stdout.txt, per_gene/EOG091G0GOU/get_seqs.stderr.txt
    jobid: 2692
    wildcards: BUSCO=EOG091G0GOU
    threads: 2


	basedir=$(pwd)
        cd per_gene/EOG091G0GOU
        
        bash $basedir/../scripts/fetch_seqs.sh EOG091G0GOU /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ingroup.txt /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/outgroup.txt 1> ../../per_gene/EOG091G0GOU/get_seqs.stdout.txt 2> ../../per_gene/EOG091G0GOU/get_seqs.stderr.txt
	mv EOG091G0GOU.fasta $basedir/per_gene/EOG091G0GOU/EOG091G0GOU.ingroup.fasta
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/72476f9d9a5bd0627b4d721143a21354.simg
[Sun Jul  5 21:43:51 2020]
Finished job 390.
335 of 3292 steps (10%) done

[Sun Jul  5 21:43:51 2020]
rule get_seqs:
    input: /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ingroup.txt, /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/outgroup.txt
    output: per_gene/EOG091G03B9/EOG091G03B9.ingroup.fasta
    log: per_gene/EOG091G03B9/get_seqs.stdout.txt, per_gene/EOG091G03B9/get_seqs.stderr.txt
    jobid: 2506
    wildcards: BUSCO=EOG091G03B9
    threads: 2


	basedir=$(pwd)
        cd per_gene/EOG091G03B9
        
        bash $basedir/../scripts/fetch_seqs.sh EOG091G03B9 /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ingroup.txt /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/outgroup.txt 1> ../../per_gene/EOG091G03B9/get_seqs.stdout.txt 2> ../../per_gene/EOG091G03B9/get_seqs.stderr.txt
	mv EOG091G03B9.fasta $basedir/per_gene/EOG091G03B9/EOG091G03B9.ingroup.fasta
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/72476f9d9a5bd0627b4d721143a21354.simg
[Sun Jul  5 21:44:00 2020]
Finished job 497.
336 of 3292 steps (10%) done

[Sun Jul  5 21:44:00 2020]
rule remove_empty:
    input: per_gene/EOG091G05Q6/ALICUT_EOG091G05Q6.clustalo.fasta
    output: per_gene/EOG091G05Q6/empty_check.done
    jobid: 1319
    wildcards: BUSCO=EOG091G05Q6


         if [ "$(cat per_gene/EOG091G05Q6/ALICUT_EOG091G05Q6.clustalo.fasta | grep -v ">" | sed 's/-//g' | grep "^$" | wc -l)" -gt 0 ]
         then
              cp per_gene/EOG091G05Q6/ALICUT_EOG091G05Q6.clustalo.fasta per_gene/EOG091G05Q6/ALICUT_EOG091G05Q6.clustalo.fasta.backup
              bash ../scripts/remove_empty.sh per_gene/EOG091G05Q6/ALICUT_EOG091G05Q6.clustalo.fasta.backup > per_gene/EOG091G05Q6/ALICUT_EOG091G05Q6.clustalo.fasta
         fi
         touch per_gene/EOG091G05Q6/empty_check.done
         
[Sun Jul  5 21:44:00 2020]
Finished job 1319.
337 of 3292 steps (10%) done

[Sun Jul  5 21:44:00 2020]
rule find_best_model:
    input: per_gene/EOG091G05Q6/ALICUT_EOG091G05Q6.clustalo.fasta, per_gene/EOG091G05Q6/empty_check.done
    output: per_gene/EOG091G05Q6/EOG091G05Q6.best_model
    log: per_gene/EOG091G05Q6/find_best_model.stderr.txt
    jobid: 496
    wildcards: BUSCO=EOG091G05Q6
    threads: 2


        cd per_gene/EOG091G05Q6
        if [ ! -d find_best_model ]
        then
            mkdir find_best_model
        fi
        cd find_best_model
        ln -s ../../../per_gene/EOG091G05Q6/ALICUT_EOG091G05Q6.clustalo.fasta EOG091G05Q6.fasta
        ProteinModelSelection.pl EOG091G05Q6.fasta 1> ../../../per_gene/EOG091G05Q6/EOG091G05Q6.best_model 2> ../../../per_gene/EOG091G05Q6/find_best_model.stderr.txt
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/c0c09ee657b1e27f2c5687e0e9aa8d70.simg
[Sun Jul  5 21:44:05 2020]
Finished job 2506.
338 of 3292 steps (10%) done

[Sun Jul  5 21:44:05 2020]
rule get_outgroups:
    input: per_gene/EOG091G03B9/EOG091G03B9.ingroup.fasta
    output: per_gene/EOG091G03B9/EOG091G03B9.orthodb.fasta, per_gene/EOG091G03B9/EOG091G03B9.outgroup.fasta
    log: per_gene/EOG091G03B9/get_outgroups.stdout.txt, per_gene/EOG091G03B9/get_outgroups.stderr.txt
    jobid: 2507
    wildcards: BUSCO=EOG091G03B9


        #download fastas from Orhtodb for BUSCO id
        for i in {1..5}
        do
             wget "http://www.orthodb.org/fasta?query=EOG091G03B9&level=33208" -O per_gene/EOG091G03B9/EOG091G03B9.orthodb.fasta 1> per_gene/EOG091G03B9/get_outgroups.stdout.txt 2> per_gene/EOG091G03B9/get_outgroups.stderr.txt && break || echo -e "try again ($i)" && sleep 15
        done

	#This is quick an dirty for now and just takes the first protein if there is more than one for an outgroup taxon
        bash ../scripts/download_outgroups.sh taxids.txt per_gene/EOG091G03B9/EOG091G03B9.orthodb.fasta > per_gene/EOG091G03B9/EOG091G03B9.outgroup.fasta
        
[Sun Jul  5 21:44:05 2020]
Finished job 2692.
339 of 3292 steps (10%) done

[Sun Jul  5 21:44:05 2020]
rule get_seqs:
    input: /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ingroup.txt, /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/outgroup.txt
    output: per_gene/EOG091G15HV/EOG091G15HV.ingroup.fasta
    log: per_gene/EOG091G15HV/get_seqs.stdout.txt, per_gene/EOG091G15HV/get_seqs.stderr.txt
    jobid: 2932
    wildcards: BUSCO=EOG091G15HV
    threads: 2


	basedir=$(pwd)
        cd per_gene/EOG091G15HV
        
        bash $basedir/../scripts/fetch_seqs.sh EOG091G15HV /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ingroup.txt /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/outgroup.txt 1> ../../per_gene/EOG091G15HV/get_seqs.stdout.txt 2> ../../per_gene/EOG091G15HV/get_seqs.stderr.txt
	mv EOG091G15HV.fasta $basedir/per_gene/EOG091G15HV/EOG091G15HV.ingroup.fasta
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/72476f9d9a5bd0627b4d721143a21354.simg

[Sun Jul  5 21:44:05 2020]
rule get_outgroups:
    input: per_gene/EOG091G0GOU/EOG091G0GOU.ingroup.fasta
    output: per_gene/EOG091G0GOU/EOG091G0GOU.orthodb.fasta, per_gene/EOG091G0GOU/EOG091G0GOU.outgroup.fasta
    log: per_gene/EOG091G0GOU/get_outgroups.stdout.txt, per_gene/EOG091G0GOU/get_outgroups.stderr.txt
    jobid: 2693
    wildcards: BUSCO=EOG091G0GOU


        #download fastas from Orhtodb for BUSCO id
        for i in {1..5}
        do
             wget "http://www.orthodb.org/fasta?query=EOG091G0GOU&level=33208" -O per_gene/EOG091G0GOU/EOG091G0GOU.orthodb.fasta 1> per_gene/EOG091G0GOU/get_outgroups.stdout.txt 2> per_gene/EOG091G0GOU/get_outgroups.stderr.txt && break || echo -e "try again ($i)" && sleep 15
        done

	#This is quick an dirty for now and just takes the first protein if there is more than one for an outgroup taxon
        bash ../scripts/download_outgroups.sh taxids.txt per_gene/EOG091G0GOU/EOG091G0GOU.orthodb.fasta > per_gene/EOG091G0GOU/EOG091G0GOU.outgroup.fasta
        
[Sun Jul  5 21:44:06 2020]
Finished job 2507.
340 of 3292 steps (10%) done

[Sun Jul  5 21:44:06 2020]
rule join_groups:
    input: per_gene/EOG091G03B9/EOG091G03B9.ingroup.fasta, per_gene/EOG091G03B9/EOG091G03B9.outgroup.fasta
    output: per_gene/EOG091G03B9/EOG091G03B9.fasta
    jobid: 2077
    wildcards: BUSCO=EOG091G03B9


        cat per_gene/EOG091G03B9/EOG091G03B9.ingroup.fasta per_gene/EOG091G03B9/EOG091G03B9.outgroup.fasta > per_gene/EOG091G03B9/EOG091G03B9.fasta
        
[Sun Jul  5 21:44:06 2020]
Finished job 2077.
341 of 3292 steps (10%) done
[Sun Jul  5 21:44:06 2020]
Finished job 203.
342 of 3292 steps (10%) done

[Sun Jul  5 21:44:06 2020]
rule MSA:
    input: per_gene/EOG091G03B9/EOG091G03B9.fasta
    output: per_gene/EOG091G03B9/EOG091G03B9.clustalo.fasta
    log: per_gene/EOG091G03B9/MSA.stdout.txt, per_gene/EOG091G03B9/MSA.stderr.txt
    jobid: 1274
    wildcards: BUSCO=EOG091G03B9
    threads: 2


        clustalo -i per_gene/EOG091G03B9/EOG091G03B9.fasta -o per_gene/EOG091G03B9/EOG091G03B9.clustalo.fasta --threads=2 1> per_gene/EOG091G03B9/MSA.stdout.txt 2> per_gene/EOG091G03B9/MSA.stderr.txt
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/d68c9691725a7401923680874285c430.simg
[Sun Jul  5 21:44:07 2020]
Finished job 2693.
343 of 3292 steps (10%) done

[Sun Jul  5 21:44:07 2020]
rule join_groups:
    input: per_gene/EOG091G0GOU/EOG091G0GOU.ingroup.fasta, per_gene/EOG091G0GOU/EOG091G0GOU.outgroup.fasta
    output: per_gene/EOG091G0GOU/EOG091G0GOU.fasta
    jobid: 2170
    wildcards: BUSCO=EOG091G0GOU


        cat per_gene/EOG091G0GOU/EOG091G0GOU.ingroup.fasta per_gene/EOG091G0GOU/EOG091G0GOU.outgroup.fasta > per_gene/EOG091G0GOU/EOG091G0GOU.fasta
        
[Sun Jul  5 21:44:07 2020]
Finished job 2170.
344 of 3292 steps (10%) done

[Sun Jul  5 21:44:07 2020]
rule MSA:
    input: per_gene/EOG091G0GOU/EOG091G0GOU.fasta
    output: per_gene/EOG091G0GOU/EOG091G0GOU.clustalo.fasta
    log: per_gene/EOG091G0GOU/MSA.stdout.txt, per_gene/EOG091G0GOU/MSA.stderr.txt
    jobid: 1460
    wildcards: BUSCO=EOG091G0GOU
    threads: 2


        clustalo -i per_gene/EOG091G0GOU/EOG091G0GOU.fasta -o per_gene/EOG091G0GOU/EOG091G0GOU.clustalo.fasta --threads=2 1> per_gene/EOG091G0GOU/MSA.stdout.txt 2> per_gene/EOG091G0GOU/MSA.stderr.txt
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/d68c9691725a7401923680874285c430.simg
[Sun Jul  5 21:44:08 2020]
Finished job 1460.
345 of 3292 steps (10%) done

[Sun Jul  5 21:44:08 2020]
rule score_and_cut:
    input: per_gene/EOG091G0GOU/EOG091G0GOU.clustalo.fasta
    output: per_gene/EOG091G0GOU/ALICUT_EOG091G0GOU.clustalo.fasta
    jobid: 637
    wildcards: BUSCO=EOG091G0GOU
    threads: 2


        cd per_gene/EOG091G0GOU
        Aliscore.pl -N -r 200000000000000000 -i ../../per_gene/EOG091G0GOU/EOG091G0GOU.clustalo.fasta &> aliscore.log
        ALICUT.pl -s &> alicut.log
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/63c88c27a0fa300f57066b0ef65fefcb.simg
[Sun Jul  5 21:44:09 2020]
Finished job 1274.
346 of 3292 steps (11%) done

[Sun Jul  5 21:44:09 2020]
rule score_and_cut:
    input: per_gene/EOG091G03B9/EOG091G03B9.clustalo.fasta
    output: per_gene/EOG091G03B9/ALICUT_EOG091G03B9.clustalo.fasta
    jobid: 451
    wildcards: BUSCO=EOG091G03B9
    threads: 2


        cd per_gene/EOG091G03B9
        Aliscore.pl -N -r 200000000000000000 -i ../../per_gene/EOG091G03B9/EOG091G03B9.clustalo.fasta &> aliscore.log
        ALICUT.pl -s &> alicut.log
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/63c88c27a0fa300f57066b0ef65fefcb.simg
[Sun Jul  5 21:44:18 2020]
Finished job 200.
347 of 3292 steps (11%) done

[Sun Jul  5 21:44:18 2020]
rule get_seqs:
    input: /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ingroup.txt, /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/outgroup.txt
    output: per_gene/EOG091G0FIJ/EOG091G0FIJ.ingroup.fasta
    log: per_gene/EOG091G0FIJ/get_seqs.stdout.txt, per_gene/EOG091G0FIJ/get_seqs.stderr.txt
    jobid: 2678
    wildcards: BUSCO=EOG091G0FIJ
    threads: 2


	basedir=$(pwd)
        cd per_gene/EOG091G0FIJ
        
        bash $basedir/../scripts/fetch_seqs.sh EOG091G0FIJ /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ingroup.txt /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/outgroup.txt 1> ../../per_gene/EOG091G0FIJ/get_seqs.stdout.txt 2> ../../per_gene/EOG091G0FIJ/get_seqs.stderr.txt
	mv EOG091G0FIJ.fasta $basedir/per_gene/EOG091G0FIJ/EOG091G0FIJ.ingroup.fasta
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/72476f9d9a5bd0627b4d721143a21354.simg
[Sun Jul  5 21:44:18 2020]
Finished job 637.
348 of 3292 steps (11%) done

[Sun Jul  5 21:44:18 2020]
rule remove_empty:
    input: per_gene/EOG091G0GOU/ALICUT_EOG091G0GOU.clustalo.fasta
    output: per_gene/EOG091G0GOU/empty_check.done
    jobid: 1459
    wildcards: BUSCO=EOG091G0GOU


         if [ "$(cat per_gene/EOG091G0GOU/ALICUT_EOG091G0GOU.clustalo.fasta | grep -v ">" | sed 's/-//g' | grep "^$" | wc -l)" -gt 0 ]
         then
              cp per_gene/EOG091G0GOU/ALICUT_EOG091G0GOU.clustalo.fasta per_gene/EOG091G0GOU/ALICUT_EOG091G0GOU.clustalo.fasta.backup
              bash ../scripts/remove_empty.sh per_gene/EOG091G0GOU/ALICUT_EOG091G0GOU.clustalo.fasta.backup > per_gene/EOG091G0GOU/ALICUT_EOG091G0GOU.clustalo.fasta
         fi
         touch per_gene/EOG091G0GOU/empty_check.done
         
[Sun Jul  5 21:44:18 2020]
Finished job 1459.
349 of 3292 steps (11%) done

[Sun Jul  5 21:44:18 2020]
rule find_best_model:
    input: per_gene/EOG091G0GOU/ALICUT_EOG091G0GOU.clustalo.fasta, per_gene/EOG091G0GOU/empty_check.done
    output: per_gene/EOG091G0GOU/EOG091G0GOU.best_model
    log: per_gene/EOG091G0GOU/find_best_model.stderr.txt
    jobid: 636
    wildcards: BUSCO=EOG091G0GOU
    threads: 2


        cd per_gene/EOG091G0GOU
        if [ ! -d find_best_model ]
        then
            mkdir find_best_model
        fi
        cd find_best_model
        ln -s ../../../per_gene/EOG091G0GOU/ALICUT_EOG091G0GOU.clustalo.fasta EOG091G0GOU.fasta
        ProteinModelSelection.pl EOG091G0GOU.fasta 1> ../../../per_gene/EOG091G0GOU/EOG091G0GOU.best_model 2> ../../../per_gene/EOG091G0GOU/find_best_model.stderr.txt
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/c0c09ee657b1e27f2c5687e0e9aa8d70.simg
[Sun Jul  5 21:44:20 2020]
Finished job 2932.
350 of 3292 steps (11%) done

[Sun Jul  5 21:44:20 2020]
rule get_outgroups:
    input: per_gene/EOG091G15HV/EOG091G15HV.ingroup.fasta
    output: per_gene/EOG091G15HV/EOG091G15HV.orthodb.fasta, per_gene/EOG091G15HV/EOG091G15HV.outgroup.fasta
    log: per_gene/EOG091G15HV/get_outgroups.stdout.txt, per_gene/EOG091G15HV/get_outgroups.stderr.txt
    jobid: 2933
    wildcards: BUSCO=EOG091G15HV


        #download fastas from Orhtodb for BUSCO id
        for i in {1..5}
        do
             wget "http://www.orthodb.org/fasta?query=EOG091G15HV&level=33208" -O per_gene/EOG091G15HV/EOG091G15HV.orthodb.fasta 1> per_gene/EOG091G15HV/get_outgroups.stdout.txt 2> per_gene/EOG091G15HV/get_outgroups.stderr.txt && break || echo -e "try again ($i)" && sleep 15
        done

	#This is quick an dirty for now and just takes the first protein if there is more than one for an outgroup taxon
        bash ../scripts/download_outgroups.sh taxids.txt per_gene/EOG091G15HV/EOG091G15HV.orthodb.fasta > per_gene/EOG091G15HV/EOG091G15HV.outgroup.fasta
        
[Sun Jul  5 21:44:20 2020]
Finished job 451.
351 of 3292 steps (11%) done

[Sun Jul  5 21:44:21 2020]
rule get_seqs:
    input: /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ingroup.txt, /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/outgroup.txt
    output: per_gene/EOG091G00Q0/EOG091G00Q0.ingroup.fasta
    log: per_gene/EOG091G00Q0/get_seqs.stdout.txt, per_gene/EOG091G00Q0/get_seqs.stderr.txt
    jobid: 2470
    wildcards: BUSCO=EOG091G00Q0
    threads: 2


	basedir=$(pwd)
        cd per_gene/EOG091G00Q0
        
        bash $basedir/../scripts/fetch_seqs.sh EOG091G00Q0 /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ingroup.txt /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/outgroup.txt 1> ../../per_gene/EOG091G00Q0/get_seqs.stdout.txt 2> ../../per_gene/EOG091G00Q0/get_seqs.stderr.txt
	mv EOG091G00Q0.fasta $basedir/per_gene/EOG091G00Q0/EOG091G00Q0.ingroup.fasta
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/72476f9d9a5bd0627b4d721143a21354.simg

[Sun Jul  5 21:44:21 2020]
rule remove_empty:
    input: per_gene/EOG091G03B9/ALICUT_EOG091G03B9.clustalo.fasta
    output: per_gene/EOG091G03B9/empty_check.done
    jobid: 1273
    wildcards: BUSCO=EOG091G03B9


         if [ "$(cat per_gene/EOG091G03B9/ALICUT_EOG091G03B9.clustalo.fasta | grep -v ">" | sed 's/-//g' | grep "^$" | wc -l)" -gt 0 ]
         then
              cp per_gene/EOG091G03B9/ALICUT_EOG091G03B9.clustalo.fasta per_gene/EOG091G03B9/ALICUT_EOG091G03B9.clustalo.fasta.backup
              bash ../scripts/remove_empty.sh per_gene/EOG091G03B9/ALICUT_EOG091G03B9.clustalo.fasta.backup > per_gene/EOG091G03B9/ALICUT_EOG091G03B9.clustalo.fasta
         fi
         touch per_gene/EOG091G03B9/empty_check.done
         
[Sun Jul  5 21:44:21 2020]
Finished job 1273.
352 of 3292 steps (11%) done
[Sun Jul  5 21:44:21 2020]
Finished job 2933.
353 of 3292 steps (11%) done

[Sun Jul  5 21:44:21 2020]
rule find_best_model:
    input: per_gene/EOG091G03B9/ALICUT_EOG091G03B9.clustalo.fasta, per_gene/EOG091G03B9/empty_check.done
    output: per_gene/EOG091G03B9/EOG091G03B9.best_model
    log: per_gene/EOG091G03B9/find_best_model.stderr.txt
    jobid: 450
    wildcards: BUSCO=EOG091G03B9
    threads: 2


        cd per_gene/EOG091G03B9
        if [ ! -d find_best_model ]
        then
            mkdir find_best_model
        fi
        cd find_best_model
        ln -s ../../../per_gene/EOG091G03B9/ALICUT_EOG091G03B9.clustalo.fasta EOG091G03B9.fasta
        ProteinModelSelection.pl EOG091G03B9.fasta 1> ../../../per_gene/EOG091G03B9/EOG091G03B9.best_model 2> ../../../per_gene/EOG091G03B9/find_best_model.stderr.txt
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/c0c09ee657b1e27f2c5687e0e9aa8d70.simg
[Sun Jul  5 21:44:32 2020]
Finished job 2678.
354 of 3292 steps (11%) done

[Sun Jul  5 21:44:32 2020]
rule get_outgroups:
    input: per_gene/EOG091G0FIJ/EOG091G0FIJ.ingroup.fasta
    output: per_gene/EOG091G0FIJ/EOG091G0FIJ.orthodb.fasta, per_gene/EOG091G0FIJ/EOG091G0FIJ.outgroup.fasta
    log: per_gene/EOG091G0FIJ/get_outgroups.stdout.txt, per_gene/EOG091G0FIJ/get_outgroups.stderr.txt
    jobid: 2679
    wildcards: BUSCO=EOG091G0FIJ


        #download fastas from Orhtodb for BUSCO id
        for i in {1..5}
        do
             wget "http://www.orthodb.org/fasta?query=EOG091G0FIJ&level=33208" -O per_gene/EOG091G0FIJ/EOG091G0FIJ.orthodb.fasta 1> per_gene/EOG091G0FIJ/get_outgroups.stdout.txt 2> per_gene/EOG091G0FIJ/get_outgroups.stderr.txt && break || echo -e "try again ($i)" && sleep 15
        done

	#This is quick an dirty for now and just takes the first protein if there is more than one for an outgroup taxon
        bash ../scripts/download_outgroups.sh taxids.txt per_gene/EOG091G0FIJ/EOG091G0FIJ.orthodb.fasta > per_gene/EOG091G0FIJ/EOG091G0FIJ.outgroup.fasta
        

[Sun Jul  5 21:44:32 2020]
rule join_groups:
    input: per_gene/EOG091G15HV/EOG091G15HV.ingroup.fasta, per_gene/EOG091G15HV/EOG091G15HV.outgroup.fasta
    output: per_gene/EOG091G15HV/EOG091G15HV.fasta
    jobid: 2290
    wildcards: BUSCO=EOG091G15HV


        cat per_gene/EOG091G15HV/EOG091G15HV.ingroup.fasta per_gene/EOG091G15HV/EOG091G15HV.outgroup.fasta > per_gene/EOG091G15HV/EOG091G15HV.fasta
        
[Sun Jul  5 21:44:32 2020]
Finished job 2290.
355 of 3292 steps (11%) done
[Sun Jul  5 21:44:33 2020]
Finished job 2679.
356 of 3292 steps (11%) done

[Sun Jul  5 21:44:33 2020]
rule join_groups:
    input: per_gene/EOG091G0FIJ/EOG091G0FIJ.ingroup.fasta, per_gene/EOG091G0FIJ/EOG091G0FIJ.outgroup.fasta
    output: per_gene/EOG091G0FIJ/EOG091G0FIJ.fasta
    jobid: 2163
    wildcards: BUSCO=EOG091G0FIJ


        cat per_gene/EOG091G0FIJ/EOG091G0FIJ.ingroup.fasta per_gene/EOG091G0FIJ/EOG091G0FIJ.outgroup.fasta > per_gene/EOG091G0FIJ/EOG091G0FIJ.fasta
        
[Sun Jul  5 21:44:34 2020]
Finished job 2163.
357 of 3292 steps (11%) done

[Sun Jul  5 21:44:34 2020]
rule MSA:
    input: per_gene/EOG091G0FIJ/EOG091G0FIJ.fasta
    output: per_gene/EOG091G0FIJ/EOG091G0FIJ.clustalo.fasta
    log: per_gene/EOG091G0FIJ/MSA.stdout.txt, per_gene/EOG091G0FIJ/MSA.stderr.txt
    jobid: 1446
    wildcards: BUSCO=EOG091G0FIJ
    threads: 2


        clustalo -i per_gene/EOG091G0FIJ/EOG091G0FIJ.fasta -o per_gene/EOG091G0FIJ/EOG091G0FIJ.clustalo.fasta --threads=2 1> per_gene/EOG091G0FIJ/MSA.stdout.txt 2> per_gene/EOG091G0FIJ/MSA.stderr.txt
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/d68c9691725a7401923680874285c430.simg
[Sun Jul  5 21:44:35 2020]
Finished job 1446.
358 of 3292 steps (11%) done

[Sun Jul  5 21:44:35 2020]
rule score_and_cut:
    input: per_gene/EOG091G0FIJ/EOG091G0FIJ.clustalo.fasta
    output: per_gene/EOG091G0FIJ/ALICUT_EOG091G0FIJ.clustalo.fasta
    jobid: 623
    wildcards: BUSCO=EOG091G0FIJ
    threads: 2


        cd per_gene/EOG091G0FIJ
        Aliscore.pl -N -r 200000000000000000 -i ../../per_gene/EOG091G0FIJ/EOG091G0FIJ.clustalo.fasta &> aliscore.log
        ALICUT.pl -s &> alicut.log
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/63c88c27a0fa300f57066b0ef65fefcb.simg
[Sun Jul  5 21:44:35 2020]
Finished job 2470.
359 of 3292 steps (11%) done

[Sun Jul  5 21:44:35 2020]
rule get_outgroups:
    input: per_gene/EOG091G00Q0/EOG091G00Q0.ingroup.fasta
    output: per_gene/EOG091G00Q0/EOG091G00Q0.orthodb.fasta, per_gene/EOG091G00Q0/EOG091G00Q0.outgroup.fasta
    log: per_gene/EOG091G00Q0/get_outgroups.stdout.txt, per_gene/EOG091G00Q0/get_outgroups.stderr.txt
    jobid: 2471
    wildcards: BUSCO=EOG091G00Q0


        #download fastas from Orhtodb for BUSCO id
        for i in {1..5}
        do
             wget "http://www.orthodb.org/fasta?query=EOG091G00Q0&level=33208" -O per_gene/EOG091G00Q0/EOG091G00Q0.orthodb.fasta 1> per_gene/EOG091G00Q0/get_outgroups.stdout.txt 2> per_gene/EOG091G00Q0/get_outgroups.stderr.txt && break || echo -e "try again ($i)" && sleep 15
        done

	#This is quick an dirty for now and just takes the first protein if there is more than one for an outgroup taxon
        bash ../scripts/download_outgroups.sh taxids.txt per_gene/EOG091G00Q0/EOG091G00Q0.orthodb.fasta > per_gene/EOG091G00Q0/EOG091G00Q0.outgroup.fasta
        
[Sun Jul  5 21:44:36 2020]
Finished job 2471.
360 of 3292 steps (11%) done

[Sun Jul  5 21:44:36 2020]
rule join_groups:
    input: per_gene/EOG091G00Q0/EOG091G00Q0.ingroup.fasta, per_gene/EOG091G00Q0/EOG091G00Q0.outgroup.fasta
    output: per_gene/EOG091G00Q0/EOG091G00Q0.fasta
    jobid: 2059
    wildcards: BUSCO=EOG091G00Q0


        cat per_gene/EOG091G00Q0/EOG091G00Q0.ingroup.fasta per_gene/EOG091G00Q0/EOG091G00Q0.outgroup.fasta > per_gene/EOG091G00Q0/EOG091G00Q0.fasta
        
[Sun Jul  5 21:44:36 2020]
Finished job 2059.
361 of 3292 steps (11%) done

[Sun Jul  5 21:44:36 2020]
rule MSA:
    input: per_gene/EOG091G00Q0/EOG091G00Q0.fasta
    output: per_gene/EOG091G00Q0/EOG091G00Q0.clustalo.fasta
    log: per_gene/EOG091G00Q0/MSA.stdout.txt, per_gene/EOG091G00Q0/MSA.stderr.txt
    jobid: 1238
    wildcards: BUSCO=EOG091G00Q0
    threads: 2


        clustalo -i per_gene/EOG091G00Q0/EOG091G00Q0.fasta -o per_gene/EOG091G00Q0/EOG091G00Q0.clustalo.fasta --threads=2 1> per_gene/EOG091G00Q0/MSA.stdout.txt 2> per_gene/EOG091G00Q0/MSA.stderr.txt
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/d68c9691725a7401923680874285c430.simg
[Sun Jul  5 21:44:43 2020]
Finished job 1238.
362 of 3292 steps (11%) done

[Sun Jul  5 21:44:43 2020]
rule score_and_cut:
    input: per_gene/EOG091G00Q0/EOG091G00Q0.clustalo.fasta
    output: per_gene/EOG091G00Q0/ALICUT_EOG091G00Q0.clustalo.fasta
    jobid: 415
    wildcards: BUSCO=EOG091G00Q0
    threads: 2


        cd per_gene/EOG091G00Q0
        Aliscore.pl -N -r 200000000000000000 -i ../../per_gene/EOG091G00Q0/EOG091G00Q0.clustalo.fasta &> aliscore.log
        ALICUT.pl -s &> alicut.log
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/63c88c27a0fa300f57066b0ef65fefcb.simg
[Sun Jul  5 21:44:44 2020]
Finished job 623.
363 of 3292 steps (11%) done

[Sun Jul  5 21:44:44 2020]
rule remove_empty:
    input: per_gene/EOG091G0FIJ/ALICUT_EOG091G0FIJ.clustalo.fasta
    output: per_gene/EOG091G0FIJ/empty_check.done
    jobid: 1445
    wildcards: BUSCO=EOG091G0FIJ


         if [ "$(cat per_gene/EOG091G0FIJ/ALICUT_EOG091G0FIJ.clustalo.fasta | grep -v ">" | sed 's/-//g' | grep "^$" | wc -l)" -gt 0 ]
         then
              cp per_gene/EOG091G0FIJ/ALICUT_EOG091G0FIJ.clustalo.fasta per_gene/EOG091G0FIJ/ALICUT_EOG091G0FIJ.clustalo.fasta.backup
              bash ../scripts/remove_empty.sh per_gene/EOG091G0FIJ/ALICUT_EOG091G0FIJ.clustalo.fasta.backup > per_gene/EOG091G0FIJ/ALICUT_EOG091G0FIJ.clustalo.fasta
         fi
         touch per_gene/EOG091G0FIJ/empty_check.done
         
[Sun Jul  5 21:44:44 2020]
Finished job 1445.
364 of 3292 steps (11%) done

[Sun Jul  5 21:44:44 2020]
rule find_best_model:
    input: per_gene/EOG091G0FIJ/ALICUT_EOG091G0FIJ.clustalo.fasta, per_gene/EOG091G0FIJ/empty_check.done
    output: per_gene/EOG091G0FIJ/EOG091G0FIJ.best_model
    log: per_gene/EOG091G0FIJ/find_best_model.stderr.txt
    jobid: 622
    wildcards: BUSCO=EOG091G0FIJ
    threads: 2


        cd per_gene/EOG091G0FIJ
        if [ ! -d find_best_model ]
        then
            mkdir find_best_model
        fi
        cd find_best_model
        ln -s ../../../per_gene/EOG091G0FIJ/ALICUT_EOG091G0FIJ.clustalo.fasta EOG091G0FIJ.fasta
        ProteinModelSelection.pl EOG091G0FIJ.fasta 1> ../../../per_gene/EOG091G0FIJ/EOG091G0FIJ.best_model 2> ../../../per_gene/EOG091G0FIJ/find_best_model.stderr.txt
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/c0c09ee657b1e27f2c5687e0e9aa8d70.simg
[Sun Jul  5 21:44:55 2020]
Finished job 415.
365 of 3292 steps (11%) done

[Sun Jul  5 21:44:55 2020]
rule remove_empty:
    input: per_gene/EOG091G00Q0/ALICUT_EOG091G00Q0.clustalo.fasta
    output: per_gene/EOG091G00Q0/empty_check.done
    jobid: 1237
    wildcards: BUSCO=EOG091G00Q0


         if [ "$(cat per_gene/EOG091G00Q0/ALICUT_EOG091G00Q0.clustalo.fasta | grep -v ">" | sed 's/-//g' | grep "^$" | wc -l)" -gt 0 ]
         then
              cp per_gene/EOG091G00Q0/ALICUT_EOG091G00Q0.clustalo.fasta per_gene/EOG091G00Q0/ALICUT_EOG091G00Q0.clustalo.fasta.backup
              bash ../scripts/remove_empty.sh per_gene/EOG091G00Q0/ALICUT_EOG091G00Q0.clustalo.fasta.backup > per_gene/EOG091G00Q0/ALICUT_EOG091G00Q0.clustalo.fasta
         fi
         touch per_gene/EOG091G00Q0/empty_check.done
         
[Sun Jul  5 21:44:55 2020]
Finished job 1237.
366 of 3292 steps (11%) done

[Sun Jul  5 21:44:55 2020]
rule find_best_model:
    input: per_gene/EOG091G00Q0/ALICUT_EOG091G00Q0.clustalo.fasta, per_gene/EOG091G00Q0/empty_check.done
    output: per_gene/EOG091G00Q0/EOG091G00Q0.best_model
    log: per_gene/EOG091G00Q0/find_best_model.stderr.txt
    jobid: 414
    wildcards: BUSCO=EOG091G00Q0
    threads: 2


        cd per_gene/EOG091G00Q0
        if [ ! -d find_best_model ]
        then
            mkdir find_best_model
        fi
        cd find_best_model
        ln -s ../../../per_gene/EOG091G00Q0/ALICUT_EOG091G00Q0.clustalo.fasta EOG091G00Q0.fasta
        ProteinModelSelection.pl EOG091G00Q0.fasta 1> ../../../per_gene/EOG091G00Q0/EOG091G00Q0.best_model 2> ../../../per_gene/EOG091G00Q0/find_best_model.stderr.txt
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/c0c09ee657b1e27f2c5687e0e9aa8d70.simg
[Sun Jul  5 21:44:59 2020]
Finished job 636.
367 of 3292 steps (11%) done

[Sun Jul  5 21:45:00 2020]
rule infer_single_ML:
    input: per_gene/EOG091G0GOU/EOG091G0GOU.best_model, per_gene/EOG091G0GOU/ALICUT_EOG091G0GOU.clustalo.fasta
    output: per_gene/EOG091G0GOU/EOG091G0GOU.raxml.done
    log: per_gene/EOG091G0GOU/infer_single_ML.stdout.txt, per_gene/EOG091G0GOU/infer_single_ML.stderr.txt
    jobid: 112
    wildcards: BUSCO=EOG091G0GOU
    threads: 2


        cd per_gene/EOG091G0GOU
	count=$(cat ../../per_gene/EOG091G0GOU/ALICUT_EOG091G0GOU.clustalo.fasta | grep ">" | wc -l)
	if [ "$count" -gt 5 ]
        then
		RAxMLmodel=$(cat ../../per_gene/EOG091G0GOU/EOG091G0GOU.best_model | grep "Best" | cut -d ":" -f 2 | tr -d '[:space:]')
                if [ "$(ls -1 | grep "^RAxML" | wc -l)" -ne 0 ]
		then
			rm RAxML*
		fi
        	raxml -f a -T 2 -m PROTGAMMA$RAxMLmodel         	-p 12345 -x 12345 -# 100         	-s ../../per_gene/EOG091G0GOU/ALICUT_EOG091G0GOU.clustalo.fasta -n EOG091G0GOU.clustalo.aln.ALICUT.$RAxMLmodel 		1> ../../per_gene/EOG091G0GOU/infer_single_ML.stdout.txt 2> ../../per_gene/EOG091G0GOU/infer_single_ML.stderr.txt
	else
		echo "fasta file per_gene/EOG091G0GOU/ALICUT_EOG091G0GOU.clustalo.fasta contains fewer than 5 sequences - skipped" > ../../per_gene/EOG091G0GOU/infer_single_ML.stdout.txt
		touch raxml.skipped
	fi
        touch ../../per_gene/EOG091G0GOU/EOG091G0GOU.raxml.done
        
[33mJob counts:
	count	jobs
	1	infer_single_ML
	1[0m
[33m
        cd per_gene/EOG091G0GOU
	count=$(cat ../../per_gene/EOG091G0GOU/ALICUT_EOG091G0GOU.clustalo.fasta | grep ">" | wc -l)
	if [ "$count" -gt 5 ]
        then
		RAxMLmodel=$(cat ../../per_gene/EOG091G0GOU/EOG091G0GOU.best_model | grep "Best" | cut -d ":" -f 2 | tr -d '[:space:]')
                if [ "$(ls -1 | grep "^RAxML" | wc -l)" -ne 0 ]
		then
			rm RAxML*
		fi
        	raxml -f a -T 2 -m PROTGAMMA$RAxMLmodel         	-p 12345 -x 12345 -# 100         	-s ../../per_gene/EOG091G0GOU/ALICUT_EOG091G0GOU.clustalo.fasta -n EOG091G0GOU.clustalo.aln.ALICUT.$RAxMLmodel 		1> ../../per_gene/EOG091G0GOU/infer_single_ML.stdout.txt 2> ../../per_gene/EOG091G0GOU/infer_single_ML.stderr.txt
	else
		echo "fasta file per_gene/EOG091G0GOU/ALICUT_EOG091G0GOU.clustalo.fasta contains fewer than 5 sequences - skipped" > ../../per_gene/EOG091G0GOU/infer_single_ML.stdout.txt
		touch raxml.skipped
	fi
        touch ../../per_gene/EOG091G0GOU/EOG091G0GOU.raxml.done
        [0m
[Sun Jul  5 21:45:04 2020]
Finished job 496.
368 of 3292 steps (11%) done

[Sun Jul  5 21:45:04 2020]
rule infer_single_ML:
    input: per_gene/EOG091G05Q6/EOG091G05Q6.best_model, per_gene/EOG091G05Q6/ALICUT_EOG091G05Q6.clustalo.fasta
    output: per_gene/EOG091G05Q6/EOG091G05Q6.raxml.done
    log: per_gene/EOG091G05Q6/infer_single_ML.stdout.txt, per_gene/EOG091G05Q6/infer_single_ML.stderr.txt
    jobid: 42
    wildcards: BUSCO=EOG091G05Q6
    threads: 2


        cd per_gene/EOG091G05Q6
	count=$(cat ../../per_gene/EOG091G05Q6/ALICUT_EOG091G05Q6.clustalo.fasta | grep ">" | wc -l)
	if [ "$count" -gt 5 ]
        then
		RAxMLmodel=$(cat ../../per_gene/EOG091G05Q6/EOG091G05Q6.best_model | grep "Best" | cut -d ":" -f 2 | tr -d '[:space:]')
                if [ "$(ls -1 | grep "^RAxML" | wc -l)" -ne 0 ]
		then
			rm RAxML*
		fi
        	raxml -f a -T 2 -m PROTGAMMA$RAxMLmodel         	-p 12345 -x 12345 -# 100         	-s ../../per_gene/EOG091G05Q6/ALICUT_EOG091G05Q6.clustalo.fasta -n EOG091G05Q6.clustalo.aln.ALICUT.$RAxMLmodel 		1> ../../per_gene/EOG091G05Q6/infer_single_ML.stdout.txt 2> ../../per_gene/EOG091G05Q6/infer_single_ML.stderr.txt
	else
		echo "fasta file per_gene/EOG091G05Q6/ALICUT_EOG091G05Q6.clustalo.fasta contains fewer than 5 sequences - skipped" > ../../per_gene/EOG091G05Q6/infer_single_ML.stdout.txt
		touch raxml.skipped
	fi
        touch ../../per_gene/EOG091G05Q6/EOG091G05Q6.raxml.done
        
[33mJob counts:
	count	jobs
	1	infer_single_ML
	1[0m
[33m
        cd per_gene/EOG091G05Q6
	count=$(cat ../../per_gene/EOG091G05Q6/ALICUT_EOG091G05Q6.clustalo.fasta | grep ">" | wc -l)
	if [ "$count" -gt 5 ]
        then
		RAxMLmodel=$(cat ../../per_gene/EOG091G05Q6/EOG091G05Q6.best_model | grep "Best" | cut -d ":" -f 2 | tr -d '[:space:]')
                if [ "$(ls -1 | grep "^RAxML" | wc -l)" -ne 0 ]
		then
			rm RAxML*
		fi
        	raxml -f a -T 2 -m PROTGAMMA$RAxMLmodel         	-p 12345 -x 12345 -# 100         	-s ../../per_gene/EOG091G05Q6/ALICUT_EOG091G05Q6.clustalo.fasta -n EOG091G05Q6.clustalo.aln.ALICUT.$RAxMLmodel 		1> ../../per_gene/EOG091G05Q6/infer_single_ML.stdout.txt 2> ../../per_gene/EOG091G05Q6/infer_single_ML.stderr.txt
	else
		echo "fasta file per_gene/EOG091G05Q6/ALICUT_EOG091G05Q6.clustalo.fasta contains fewer than 5 sequences - skipped" > ../../per_gene/EOG091G05Q6/infer_single_ML.stdout.txt
		touch raxml.skipped
	fi
        touch ../../per_gene/EOG091G05Q6/EOG091G05Q6.raxml.done
        [0m
[Sun Jul  5 21:45:12 2020]
Finished job 450.
369 of 3292 steps (11%) done

[Sun Jul  5 21:45:12 2020]
rule infer_single_ML:
    input: per_gene/EOG091G03B9/EOG091G03B9.best_model, per_gene/EOG091G03B9/ALICUT_EOG091G03B9.clustalo.fasta
    output: per_gene/EOG091G03B9/EOG091G03B9.raxml.done
    log: per_gene/EOG091G03B9/infer_single_ML.stdout.txt, per_gene/EOG091G03B9/infer_single_ML.stderr.txt
    jobid: 19
    wildcards: BUSCO=EOG091G03B9
    threads: 2


        cd per_gene/EOG091G03B9
	count=$(cat ../../per_gene/EOG091G03B9/ALICUT_EOG091G03B9.clustalo.fasta | grep ">" | wc -l)
	if [ "$count" -gt 5 ]
        then
		RAxMLmodel=$(cat ../../per_gene/EOG091G03B9/EOG091G03B9.best_model | grep "Best" | cut -d ":" -f 2 | tr -d '[:space:]')
                if [ "$(ls -1 | grep "^RAxML" | wc -l)" -ne 0 ]
		then
			rm RAxML*
		fi
        	raxml -f a -T 2 -m PROTGAMMA$RAxMLmodel         	-p 12345 -x 12345 -# 100         	-s ../../per_gene/EOG091G03B9/ALICUT_EOG091G03B9.clustalo.fasta -n EOG091G03B9.clustalo.aln.ALICUT.$RAxMLmodel 		1> ../../per_gene/EOG091G03B9/infer_single_ML.stdout.txt 2> ../../per_gene/EOG091G03B9/infer_single_ML.stderr.txt
	else
		echo "fasta file per_gene/EOG091G03B9/ALICUT_EOG091G03B9.clustalo.fasta contains fewer than 5 sequences - skipped" > ../../per_gene/EOG091G03B9/infer_single_ML.stdout.txt
		touch raxml.skipped
	fi
        touch ../../per_gene/EOG091G03B9/EOG091G03B9.raxml.done
        
[33mJob counts:
	count	jobs
	1	infer_single_ML
	1[0m
[33m
        cd per_gene/EOG091G03B9
	count=$(cat ../../per_gene/EOG091G03B9/ALICUT_EOG091G03B9.clustalo.fasta | grep ">" | wc -l)
	if [ "$count" -gt 5 ]
        then
		RAxMLmodel=$(cat ../../per_gene/EOG091G03B9/EOG091G03B9.best_model | grep "Best" | cut -d ":" -f 2 | tr -d '[:space:]')
                if [ "$(ls -1 | grep "^RAxML" | wc -l)" -ne 0 ]
		then
			rm RAxML*
		fi
        	raxml -f a -T 2 -m PROTGAMMA$RAxMLmodel         	-p 12345 -x 12345 -# 100         	-s ../../per_gene/EOG091G03B9/ALICUT_EOG091G03B9.clustalo.fasta -n EOG091G03B9.clustalo.aln.ALICUT.$RAxMLmodel 		1> ../../per_gene/EOG091G03B9/infer_single_ML.stdout.txt 2> ../../per_gene/EOG091G03B9/infer_single_ML.stderr.txt
	else
		echo "fasta file per_gene/EOG091G03B9/ALICUT_EOG091G03B9.clustalo.fasta contains fewer than 5 sequences - skipped" > ../../per_gene/EOG091G03B9/infer_single_ML.stdout.txt
		touch raxml.skipped
	fi
        touch ../../per_gene/EOG091G03B9/EOG091G03B9.raxml.done
        [0m
[Sun Jul  5 21:45:32 2020]
Finished job 622.
370 of 3292 steps (11%) done

[Sun Jul  5 21:45:32 2020]
rule infer_single_ML:
    input: per_gene/EOG091G0FIJ/EOG091G0FIJ.best_model, per_gene/EOG091G0FIJ/ALICUT_EOG091G0FIJ.clustalo.fasta
    output: per_gene/EOG091G0FIJ/EOG091G0FIJ.raxml.done
    log: per_gene/EOG091G0FIJ/infer_single_ML.stdout.txt, per_gene/EOG091G0FIJ/infer_single_ML.stderr.txt
    jobid: 105
    wildcards: BUSCO=EOG091G0FIJ
    threads: 2


        cd per_gene/EOG091G0FIJ
	count=$(cat ../../per_gene/EOG091G0FIJ/ALICUT_EOG091G0FIJ.clustalo.fasta | grep ">" | wc -l)
	if [ "$count" -gt 5 ]
        then
		RAxMLmodel=$(cat ../../per_gene/EOG091G0FIJ/EOG091G0FIJ.best_model | grep "Best" | cut -d ":" -f 2 | tr -d '[:space:]')
                if [ "$(ls -1 | grep "^RAxML" | wc -l)" -ne 0 ]
		then
			rm RAxML*
		fi
        	raxml -f a -T 2 -m PROTGAMMA$RAxMLmodel         	-p 12345 -x 12345 -# 100         	-s ../../per_gene/EOG091G0FIJ/ALICUT_EOG091G0FIJ.clustalo.fasta -n EOG091G0FIJ.clustalo.aln.ALICUT.$RAxMLmodel 		1> ../../per_gene/EOG091G0FIJ/infer_single_ML.stdout.txt 2> ../../per_gene/EOG091G0FIJ/infer_single_ML.stderr.txt
	else
		echo "fasta file per_gene/EOG091G0FIJ/ALICUT_EOG091G0FIJ.clustalo.fasta contains fewer than 5 sequences - skipped" > ../../per_gene/EOG091G0FIJ/infer_single_ML.stdout.txt
		touch raxml.skipped
	fi
        touch ../../per_gene/EOG091G0FIJ/EOG091G0FIJ.raxml.done
        
[33mJob counts:
	count	jobs
	1	infer_single_ML
	1[0m
[33m
        cd per_gene/EOG091G0FIJ
	count=$(cat ../../per_gene/EOG091G0FIJ/ALICUT_EOG091G0FIJ.clustalo.fasta | grep ">" | wc -l)
	if [ "$count" -gt 5 ]
        then
		RAxMLmodel=$(cat ../../per_gene/EOG091G0FIJ/EOG091G0FIJ.best_model | grep "Best" | cut -d ":" -f 2 | tr -d '[:space:]')
                if [ "$(ls -1 | grep "^RAxML" | wc -l)" -ne 0 ]
		then
			rm RAxML*
		fi
        	raxml -f a -T 2 -m PROTGAMMA$RAxMLmodel         	-p 12345 -x 12345 -# 100         	-s ../../per_gene/EOG091G0FIJ/ALICUT_EOG091G0FIJ.clustalo.fasta -n EOG091G0FIJ.clustalo.aln.ALICUT.$RAxMLmodel 		1> ../../per_gene/EOG091G0FIJ/infer_single_ML.stdout.txt 2> ../../per_gene/EOG091G0FIJ/infer_single_ML.stderr.txt
	else
		echo "fasta file per_gene/EOG091G0FIJ/ALICUT_EOG091G0FIJ.clustalo.fasta contains fewer than 5 sequences - skipped" > ../../per_gene/EOG091G0FIJ/infer_single_ML.stdout.txt
		touch raxml.skipped
	fi
        touch ../../per_gene/EOG091G0FIJ/EOG091G0FIJ.raxml.done
        [0m
[Sun Jul  5 21:45:38 2020]
Finished job 115.
371 of 3292 steps (11%) done

[Sun Jul  5 21:45:38 2020]
rule MSA:
    input: per_gene/EOG091G15HV/EOG091G15HV.fasta
    output: per_gene/EOG091G15HV/EOG091G15HV.clustalo.fasta
    log: per_gene/EOG091G15HV/MSA.stdout.txt, per_gene/EOG091G15HV/MSA.stderr.txt
    jobid: 1700
    wildcards: BUSCO=EOG091G15HV
    threads: 2


        clustalo -i per_gene/EOG091G15HV/EOG091G15HV.fasta -o per_gene/EOG091G15HV/EOG091G15HV.clustalo.fasta --threads=2 1> per_gene/EOG091G15HV/MSA.stdout.txt 2> per_gene/EOG091G15HV/MSA.stderr.txt
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/d68c9691725a7401923680874285c430.simg
[Sun Jul  5 21:45:39 2020]
Finished job 1700.
372 of 3292 steps (11%) done

[Sun Jul  5 21:45:39 2020]
rule score_and_cut:
    input: per_gene/EOG091G15HV/EOG091G15HV.clustalo.fasta
    output: per_gene/EOG091G15HV/ALICUT_EOG091G15HV.clustalo.fasta
    jobid: 877
    wildcards: BUSCO=EOG091G15HV
    threads: 2


        cd per_gene/EOG091G15HV
        Aliscore.pl -N -r 200000000000000000 -i ../../per_gene/EOG091G15HV/EOG091G15HV.clustalo.fasta &> aliscore.log
        ALICUT.pl -s &> alicut.log
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/63c88c27a0fa300f57066b0ef65fefcb.simg
[Sun Jul  5 21:45:48 2020]
Finished job 877.
373 of 3292 steps (11%) done

[Sun Jul  5 21:45:48 2020]
rule remove_empty:
    input: per_gene/EOG091G15HV/ALICUT_EOG091G15HV.clustalo.fasta
    output: per_gene/EOG091G15HV/empty_check.done
    jobid: 1699
    wildcards: BUSCO=EOG091G15HV


         if [ "$(cat per_gene/EOG091G15HV/ALICUT_EOG091G15HV.clustalo.fasta | grep -v ">" | sed 's/-//g' | grep "^$" | wc -l)" -gt 0 ]
         then
              cp per_gene/EOG091G15HV/ALICUT_EOG091G15HV.clustalo.fasta per_gene/EOG091G15HV/ALICUT_EOG091G15HV.clustalo.fasta.backup
              bash ../scripts/remove_empty.sh per_gene/EOG091G15HV/ALICUT_EOG091G15HV.clustalo.fasta.backup > per_gene/EOG091G15HV/ALICUT_EOG091G15HV.clustalo.fasta
         fi
         touch per_gene/EOG091G15HV/empty_check.done
         
[Sun Jul  5 21:45:48 2020]
Finished job 1699.
374 of 3292 steps (11%) done

[Sun Jul  5 21:45:48 2020]
rule find_best_model:
    input: per_gene/EOG091G15HV/ALICUT_EOG091G15HV.clustalo.fasta, per_gene/EOG091G15HV/empty_check.done
    output: per_gene/EOG091G15HV/EOG091G15HV.best_model
    log: per_gene/EOG091G15HV/find_best_model.stderr.txt
    jobid: 876
    wildcards: BUSCO=EOG091G15HV
    threads: 2


        cd per_gene/EOG091G15HV
        if [ ! -d find_best_model ]
        then
            mkdir find_best_model
        fi
        cd find_best_model
        ln -s ../../../per_gene/EOG091G15HV/ALICUT_EOG091G15HV.clustalo.fasta EOG091G15HV.fasta
        ProteinModelSelection.pl EOG091G15HV.fasta 1> ../../../per_gene/EOG091G15HV/EOG091G15HV.best_model 2> ../../../per_gene/EOG091G15HV/find_best_model.stderr.txt
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/c0c09ee657b1e27f2c5687e0e9aa8d70.simg
[Sun Jul  5 21:45:48 2020]
Finished job 261.
375 of 3292 steps (11%) done

[Sun Jul  5 21:45:49 2020]
rule get_seqs:
    input: /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ingroup.txt, /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/outgroup.txt
    output: per_gene/EOG091G09HR/EOG091G09HR.ingroup.fasta
    log: per_gene/EOG091G09HR/get_seqs.stdout.txt, per_gene/EOG091G09HR/get_seqs.stderr.txt
    jobid: 2606
    wildcards: BUSCO=EOG091G09HR
    threads: 2


	basedir=$(pwd)
        cd per_gene/EOG091G09HR
        
        bash $basedir/../scripts/fetch_seqs.sh EOG091G09HR /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ingroup.txt /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/outgroup.txt 1> ../../per_gene/EOG091G09HR/get_seqs.stdout.txt 2> ../../per_gene/EOG091G09HR/get_seqs.stderr.txt
	mv EOG091G09HR.fasta $basedir/per_gene/EOG091G09HR/EOG091G09HR.ingroup.fasta
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/72476f9d9a5bd0627b4d721143a21354.simg
[Sun Jul  5 21:45:59 2020]
Finished job 238.
376 of 3292 steps (11%) done

[Sun Jul  5 21:45:59 2020]
rule get_seqs:
    input: /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ingroup.txt, /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/outgroup.txt
    output: per_gene/EOG091G0OI8/EOG091G0OI8.ingroup.fasta
    log: per_gene/EOG091G0OI8/get_seqs.stdout.txt, per_gene/EOG091G0OI8/get_seqs.stderr.txt
    jobid: 3008
    wildcards: BUSCO=EOG091G0OI8
    threads: 2


	basedir=$(pwd)
        cd per_gene/EOG091G0OI8
        
        bash $basedir/../scripts/fetch_seqs.sh EOG091G0OI8 /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ingroup.txt /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/outgroup.txt 1> ../../per_gene/EOG091G0OI8/get_seqs.stdout.txt 2> ../../per_gene/EOG091G0OI8/get_seqs.stderr.txt
	mv EOG091G0OI8.fasta $basedir/per_gene/EOG091G0OI8/EOG091G0OI8.ingroup.fasta
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/72476f9d9a5bd0627b4d721143a21354.simg
[Sun Jul  5 21:46:02 2020]
Finished job 414.
377 of 3292 steps (11%) done

[Sun Jul  5 21:46:02 2020]
rule infer_single_ML:
    input: per_gene/EOG091G00Q0/EOG091G00Q0.best_model, per_gene/EOG091G00Q0/ALICUT_EOG091G00Q0.clustalo.fasta
    output: per_gene/EOG091G00Q0/EOG091G00Q0.raxml.done
    log: per_gene/EOG091G00Q0/infer_single_ML.stdout.txt, per_gene/EOG091G00Q0/infer_single_ML.stderr.txt
    jobid: 1
    wildcards: BUSCO=EOG091G00Q0
    threads: 2


        cd per_gene/EOG091G00Q0
	count=$(cat ../../per_gene/EOG091G00Q0/ALICUT_EOG091G00Q0.clustalo.fasta | grep ">" | wc -l)
	if [ "$count" -gt 5 ]
        then
		RAxMLmodel=$(cat ../../per_gene/EOG091G00Q0/EOG091G00Q0.best_model | grep "Best" | cut -d ":" -f 2 | tr -d '[:space:]')
                if [ "$(ls -1 | grep "^RAxML" | wc -l)" -ne 0 ]
		then
			rm RAxML*
		fi
        	raxml -f a -T 2 -m PROTGAMMA$RAxMLmodel         	-p 12345 -x 12345 -# 100         	-s ../../per_gene/EOG091G00Q0/ALICUT_EOG091G00Q0.clustalo.fasta -n EOG091G00Q0.clustalo.aln.ALICUT.$RAxMLmodel 		1> ../../per_gene/EOG091G00Q0/infer_single_ML.stdout.txt 2> ../../per_gene/EOG091G00Q0/infer_single_ML.stderr.txt
	else
		echo "fasta file per_gene/EOG091G00Q0/ALICUT_EOG091G00Q0.clustalo.fasta contains fewer than 5 sequences - skipped" > ../../per_gene/EOG091G00Q0/infer_single_ML.stdout.txt
		touch raxml.skipped
	fi
        touch ../../per_gene/EOG091G00Q0/EOG091G00Q0.raxml.done
        
[33mJob counts:
	count	jobs
	1	infer_single_ML
	1[0m
[33m
        cd per_gene/EOG091G00Q0
	count=$(cat ../../per_gene/EOG091G00Q0/ALICUT_EOG091G00Q0.clustalo.fasta | grep ">" | wc -l)
	if [ "$count" -gt 5 ]
        then
		RAxMLmodel=$(cat ../../per_gene/EOG091G00Q0/EOG091G00Q0.best_model | grep "Best" | cut -d ":" -f 2 | tr -d '[:space:]')
                if [ "$(ls -1 | grep "^RAxML" | wc -l)" -ne 0 ]
		then
			rm RAxML*
		fi
        	raxml -f a -T 2 -m PROTGAMMA$RAxMLmodel         	-p 12345 -x 12345 -# 100         	-s ../../per_gene/EOG091G00Q0/ALICUT_EOG091G00Q0.clustalo.fasta -n EOG091G00Q0.clustalo.aln.ALICUT.$RAxMLmodel 		1> ../../per_gene/EOG091G00Q0/infer_single_ML.stdout.txt 2> ../../per_gene/EOG091G00Q0/infer_single_ML.stderr.txt
	else
		echo "fasta file per_gene/EOG091G00Q0/ALICUT_EOG091G00Q0.clustalo.fasta contains fewer than 5 sequences - skipped" > ../../per_gene/EOG091G00Q0/infer_single_ML.stdout.txt
		touch raxml.skipped
	fi
        touch ../../per_gene/EOG091G00Q0/EOG091G00Q0.raxml.done
        [0m
[Sun Jul  5 21:46:05 2020]
Finished job 2606.
378 of 3292 steps (11%) done

[Sun Jul  5 21:46:05 2020]
rule get_outgroups:
    input: per_gene/EOG091G09HR/EOG091G09HR.ingroup.fasta
    output: per_gene/EOG091G09HR/EOG091G09HR.orthodb.fasta, per_gene/EOG091G09HR/EOG091G09HR.outgroup.fasta
    log: per_gene/EOG091G09HR/get_outgroups.stdout.txt, per_gene/EOG091G09HR/get_outgroups.stderr.txt
    jobid: 2607
    wildcards: BUSCO=EOG091G09HR


        #download fastas from Orhtodb for BUSCO id
        for i in {1..5}
        do
             wget "http://www.orthodb.org/fasta?query=EOG091G09HR&level=33208" -O per_gene/EOG091G09HR/EOG091G09HR.orthodb.fasta 1> per_gene/EOG091G09HR/get_outgroups.stdout.txt 2> per_gene/EOG091G09HR/get_outgroups.stderr.txt && break || echo -e "try again ($i)" && sleep 15
        done

	#This is quick an dirty for now and just takes the first protein if there is more than one for an outgroup taxon
        bash ../scripts/download_outgroups.sh taxids.txt per_gene/EOG091G09HR/EOG091G09HR.orthodb.fasta > per_gene/EOG091G09HR/EOG091G09HR.outgroup.fasta
        
[Sun Jul  5 21:46:07 2020]
Finished job 2607.
379 of 3292 steps (12%) done

[Sun Jul  5 21:46:07 2020]
rule join_groups:
    input: per_gene/EOG091G09HR/EOG091G09HR.ingroup.fasta, per_gene/EOG091G09HR/EOG091G09HR.outgroup.fasta
    output: per_gene/EOG091G09HR/EOG091G09HR.fasta
    jobid: 2127
    wildcards: BUSCO=EOG091G09HR


        cat per_gene/EOG091G09HR/EOG091G09HR.ingroup.fasta per_gene/EOG091G09HR/EOG091G09HR.outgroup.fasta > per_gene/EOG091G09HR/EOG091G09HR.fasta
        
[Sun Jul  5 21:46:07 2020]
Finished job 2127.
380 of 3292 steps (12%) done

[Sun Jul  5 21:46:07 2020]
rule MSA:
    input: per_gene/EOG091G09HR/EOG091G09HR.fasta
    output: per_gene/EOG091G09HR/EOG091G09HR.clustalo.fasta
    log: per_gene/EOG091G09HR/MSA.stdout.txt, per_gene/EOG091G09HR/MSA.stderr.txt
    jobid: 1374
    wildcards: BUSCO=EOG091G09HR
    threads: 2


        clustalo -i per_gene/EOG091G09HR/EOG091G09HR.fasta -o per_gene/EOG091G09HR/EOG091G09HR.clustalo.fasta --threads=2 1> per_gene/EOG091G09HR/MSA.stdout.txt 2> per_gene/EOG091G09HR/MSA.stderr.txt
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/d68c9691725a7401923680874285c430.simg
[Sun Jul  5 21:46:09 2020]
Finished job 1374.
381 of 3292 steps (12%) done

[Sun Jul  5 21:46:09 2020]
rule score_and_cut:
    input: per_gene/EOG091G09HR/EOG091G09HR.clustalo.fasta
    output: per_gene/EOG091G09HR/ALICUT_EOG091G09HR.clustalo.fasta
    jobid: 551
    wildcards: BUSCO=EOG091G09HR
    threads: 2


        cd per_gene/EOG091G09HR
        Aliscore.pl -N -r 200000000000000000 -i ../../per_gene/EOG091G09HR/EOG091G09HR.clustalo.fasta &> aliscore.log
        ALICUT.pl -s &> alicut.log
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/63c88c27a0fa300f57066b0ef65fefcb.simg
[Sun Jul  5 21:46:14 2020]
Finished job 3008.
382 of 3292 steps (12%) done

[Sun Jul  5 21:46:14 2020]
rule get_outgroups:
    input: per_gene/EOG091G0OI8/EOG091G0OI8.ingroup.fasta
    output: per_gene/EOG091G0OI8/EOG091G0OI8.orthodb.fasta, per_gene/EOG091G0OI8/EOG091G0OI8.outgroup.fasta
    log: per_gene/EOG091G0OI8/get_outgroups.stdout.txt, per_gene/EOG091G0OI8/get_outgroups.stderr.txt
    jobid: 3009
    wildcards: BUSCO=EOG091G0OI8


        #download fastas from Orhtodb for BUSCO id
        for i in {1..5}
        do
             wget "http://www.orthodb.org/fasta?query=EOG091G0OI8&level=33208" -O per_gene/EOG091G0OI8/EOG091G0OI8.orthodb.fasta 1> per_gene/EOG091G0OI8/get_outgroups.stdout.txt 2> per_gene/EOG091G0OI8/get_outgroups.stderr.txt && break || echo -e "try again ($i)" && sleep 15
        done

	#This is quick an dirty for now and just takes the first protein if there is more than one for an outgroup taxon
        bash ../scripts/download_outgroups.sh taxids.txt per_gene/EOG091G0OI8/EOG091G0OI8.orthodb.fasta > per_gene/EOG091G0OI8/EOG091G0OI8.outgroup.fasta
        
[Sun Jul  5 21:46:15 2020]
Finished job 3009.
383 of 3292 steps (12%) done

[Sun Jul  5 21:46:15 2020]
rule join_groups:
    input: per_gene/EOG091G0OI8/EOG091G0OI8.ingroup.fasta, per_gene/EOG091G0OI8/EOG091G0OI8.outgroup.fasta
    output: per_gene/EOG091G0OI8/EOG091G0OI8.fasta
    jobid: 2328
    wildcards: BUSCO=EOG091G0OI8


        cat per_gene/EOG091G0OI8/EOG091G0OI8.ingroup.fasta per_gene/EOG091G0OI8/EOG091G0OI8.outgroup.fasta > per_gene/EOG091G0OI8/EOG091G0OI8.fasta
        
[Sun Jul  5 21:46:15 2020]
Finished job 2328.
384 of 3292 steps (12%) done

[Sun Jul  5 21:46:15 2020]
rule MSA:
    input: per_gene/EOG091G0OI8/EOG091G0OI8.fasta
    output: per_gene/EOG091G0OI8/EOG091G0OI8.clustalo.fasta
    log: per_gene/EOG091G0OI8/MSA.stdout.txt, per_gene/EOG091G0OI8/MSA.stderr.txt
    jobid: 1776
    wildcards: BUSCO=EOG091G0OI8
    threads: 2


        clustalo -i per_gene/EOG091G0OI8/EOG091G0OI8.fasta -o per_gene/EOG091G0OI8/EOG091G0OI8.clustalo.fasta --threads=2 1> per_gene/EOG091G0OI8/MSA.stdout.txt 2> per_gene/EOG091G0OI8/MSA.stderr.txt
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/d68c9691725a7401923680874285c430.simg
[Sun Jul  5 21:46:16 2020]
Finished job 1776.
385 of 3292 steps (12%) done

[Sun Jul  5 21:46:16 2020]
rule score_and_cut:
    input: per_gene/EOG091G0OI8/EOG091G0OI8.clustalo.fasta
    output: per_gene/EOG091G0OI8/ALICUT_EOG091G0OI8.clustalo.fasta
    jobid: 953
    wildcards: BUSCO=EOG091G0OI8
    threads: 2


        cd per_gene/EOG091G0OI8
        Aliscore.pl -N -r 200000000000000000 -i ../../per_gene/EOG091G0OI8/EOG091G0OI8.clustalo.fasta &> aliscore.log
        ALICUT.pl -s &> alicut.log
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/63c88c27a0fa300f57066b0ef65fefcb.simg
[Sun Jul  5 21:46:20 2020]
Finished job 551.
386 of 3292 steps (12%) done

[Sun Jul  5 21:46:20 2020]
rule remove_empty:
    input: per_gene/EOG091G09HR/ALICUT_EOG091G09HR.clustalo.fasta
    output: per_gene/EOG091G09HR/empty_check.done
    jobid: 1373
    wildcards: BUSCO=EOG091G09HR


         if [ "$(cat per_gene/EOG091G09HR/ALICUT_EOG091G09HR.clustalo.fasta | grep -v ">" | sed 's/-//g' | grep "^$" | wc -l)" -gt 0 ]
         then
              cp per_gene/EOG091G09HR/ALICUT_EOG091G09HR.clustalo.fasta per_gene/EOG091G09HR/ALICUT_EOG091G09HR.clustalo.fasta.backup
              bash ../scripts/remove_empty.sh per_gene/EOG091G09HR/ALICUT_EOG091G09HR.clustalo.fasta.backup > per_gene/EOG091G09HR/ALICUT_EOG091G09HR.clustalo.fasta
         fi
         touch per_gene/EOG091G09HR/empty_check.done
         
[Sun Jul  5 21:46:20 2020]
Finished job 1373.
387 of 3292 steps (12%) done

[Sun Jul  5 21:46:20 2020]
rule find_best_model:
    input: per_gene/EOG091G09HR/ALICUT_EOG091G09HR.clustalo.fasta, per_gene/EOG091G09HR/empty_check.done
    output: per_gene/EOG091G09HR/EOG091G09HR.best_model
    log: per_gene/EOG091G09HR/find_best_model.stderr.txt
    jobid: 550
    wildcards: BUSCO=EOG091G09HR
    threads: 2


        cd per_gene/EOG091G09HR
        if [ ! -d find_best_model ]
        then
            mkdir find_best_model
        fi
        cd find_best_model
        ln -s ../../../per_gene/EOG091G09HR/ALICUT_EOG091G09HR.clustalo.fasta EOG091G09HR.fasta
        ProteinModelSelection.pl EOG091G09HR.fasta 1> ../../../per_gene/EOG091G09HR/EOG091G09HR.best_model 2> ../../../per_gene/EOG091G09HR/find_best_model.stderr.txt
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/c0c09ee657b1e27f2c5687e0e9aa8d70.simg
[Sun Jul  5 21:46:21 2020]
Finished job 876.
388 of 3292 steps (12%) done

[Sun Jul  5 21:46:21 2020]
rule infer_single_ML:
    input: per_gene/EOG091G15HV/EOG091G15HV.best_model, per_gene/EOG091G15HV/ALICUT_EOG091G15HV.clustalo.fasta
    output: per_gene/EOG091G15HV/EOG091G15HV.raxml.done
    log: per_gene/EOG091G15HV/infer_single_ML.stdout.txt, per_gene/EOG091G15HV/infer_single_ML.stderr.txt
    jobid: 232
    wildcards: BUSCO=EOG091G15HV
    threads: 2


        cd per_gene/EOG091G15HV
	count=$(cat ../../per_gene/EOG091G15HV/ALICUT_EOG091G15HV.clustalo.fasta | grep ">" | wc -l)
	if [ "$count" -gt 5 ]
        then
		RAxMLmodel=$(cat ../../per_gene/EOG091G15HV/EOG091G15HV.best_model | grep "Best" | cut -d ":" -f 2 | tr -d '[:space:]')
                if [ "$(ls -1 | grep "^RAxML" | wc -l)" -ne 0 ]
		then
			rm RAxML*
		fi
        	raxml -f a -T 2 -m PROTGAMMA$RAxMLmodel         	-p 12345 -x 12345 -# 100         	-s ../../per_gene/EOG091G15HV/ALICUT_EOG091G15HV.clustalo.fasta -n EOG091G15HV.clustalo.aln.ALICUT.$RAxMLmodel 		1> ../../per_gene/EOG091G15HV/infer_single_ML.stdout.txt 2> ../../per_gene/EOG091G15HV/infer_single_ML.stderr.txt
	else
		echo "fasta file per_gene/EOG091G15HV/ALICUT_EOG091G15HV.clustalo.fasta contains fewer than 5 sequences - skipped" > ../../per_gene/EOG091G15HV/infer_single_ML.stdout.txt
		touch raxml.skipped
	fi
        touch ../../per_gene/EOG091G15HV/EOG091G15HV.raxml.done
        
[33mJob counts:
	count	jobs
	1	infer_single_ML
	1[0m
[33m
        cd per_gene/EOG091G15HV
	count=$(cat ../../per_gene/EOG091G15HV/ALICUT_EOG091G15HV.clustalo.fasta | grep ">" | wc -l)
	if [ "$count" -gt 5 ]
        then
		RAxMLmodel=$(cat ../../per_gene/EOG091G15HV/EOG091G15HV.best_model | grep "Best" | cut -d ":" -f 2 | tr -d '[:space:]')
                if [ "$(ls -1 | grep "^RAxML" | wc -l)" -ne 0 ]
		then
			rm RAxML*
		fi
        	raxml -f a -T 2 -m PROTGAMMA$RAxMLmodel         	-p 12345 -x 12345 -# 100         	-s ../../per_gene/EOG091G15HV/ALICUT_EOG091G15HV.clustalo.fasta -n EOG091G15HV.clustalo.aln.ALICUT.$RAxMLmodel 		1> ../../per_gene/EOG091G15HV/infer_single_ML.stdout.txt 2> ../../per_gene/EOG091G15HV/infer_single_ML.stderr.txt
	else
		echo "fasta file per_gene/EOG091G15HV/ALICUT_EOG091G15HV.clustalo.fasta contains fewer than 5 sequences - skipped" > ../../per_gene/EOG091G15HV/infer_single_ML.stdout.txt
		touch raxml.skipped
	fi
        touch ../../per_gene/EOG091G15HV/EOG091G15HV.raxml.done
        [0m
[Sun Jul  5 21:46:26 2020]
Finished job 953.
389 of 3292 steps (12%) done

[Sun Jul  5 21:46:26 2020]
rule remove_empty:
    input: per_gene/EOG091G0OI8/ALICUT_EOG091G0OI8.clustalo.fasta
    output: per_gene/EOG091G0OI8/empty_check.done
    jobid: 1775
    wildcards: BUSCO=EOG091G0OI8


         if [ "$(cat per_gene/EOG091G0OI8/ALICUT_EOG091G0OI8.clustalo.fasta | grep -v ">" | sed 's/-//g' | grep "^$" | wc -l)" -gt 0 ]
         then
              cp per_gene/EOG091G0OI8/ALICUT_EOG091G0OI8.clustalo.fasta per_gene/EOG091G0OI8/ALICUT_EOG091G0OI8.clustalo.fasta.backup
              bash ../scripts/remove_empty.sh per_gene/EOG091G0OI8/ALICUT_EOG091G0OI8.clustalo.fasta.backup > per_gene/EOG091G0OI8/ALICUT_EOG091G0OI8.clustalo.fasta
         fi
         touch per_gene/EOG091G0OI8/empty_check.done
         
[Sun Jul  5 21:46:26 2020]
Finished job 1775.
390 of 3292 steps (12%) done

[Sun Jul  5 21:46:26 2020]
rule find_best_model:
    input: per_gene/EOG091G0OI8/ALICUT_EOG091G0OI8.clustalo.fasta, per_gene/EOG091G0OI8/empty_check.done
    output: per_gene/EOG091G0OI8/EOG091G0OI8.best_model
    log: per_gene/EOG091G0OI8/find_best_model.stderr.txt
    jobid: 952
    wildcards: BUSCO=EOG091G0OI8
    threads: 2


        cd per_gene/EOG091G0OI8
        if [ ! -d find_best_model ]
        then
            mkdir find_best_model
        fi
        cd find_best_model
        ln -s ../../../per_gene/EOG091G0OI8/ALICUT_EOG091G0OI8.clustalo.fasta EOG091G0OI8.fasta
        ProteinModelSelection.pl EOG091G0OI8.fasta 1> ../../../per_gene/EOG091G0OI8/EOG091G0OI8.best_model 2> ../../../per_gene/EOG091G0OI8/find_best_model.stderr.txt
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/c0c09ee657b1e27f2c5687e0e9aa8d70.simg
[Sun Jul  5 21:46:44 2020]
Finished job 163.
391 of 3292 steps (12%) done

[Sun Jul  5 21:46:44 2020]
rule get_seqs:
    input: /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ingroup.txt, /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/outgroup.txt
    output: per_gene/EOG091G0I85/EOG091G0I85.ingroup.fasta
    log: per_gene/EOG091G0I85/get_seqs.stdout.txt, per_gene/EOG091G0I85/get_seqs.stderr.txt
    jobid: 3204
    wildcards: BUSCO=EOG091G0I85
    threads: 2


	basedir=$(pwd)
        cd per_gene/EOG091G0I85
        
        bash $basedir/../scripts/fetch_seqs.sh EOG091G0I85 /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ingroup.txt /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/outgroup.txt 1> ../../per_gene/EOG091G0I85/get_seqs.stdout.txt 2> ../../per_gene/EOG091G0I85/get_seqs.stderr.txt
	mv EOG091G0I85.fasta $basedir/per_gene/EOG091G0I85/EOG091G0I85.ingroup.fasta
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/72476f9d9a5bd0627b4d721143a21354.simg
[Sun Jul  5 21:47:01 2020]
Finished job 952.
392 of 3292 steps (12%) done

[Sun Jul  5 21:47:01 2020]
rule infer_single_ML:
    input: per_gene/EOG091G0OI8/EOG091G0OI8.best_model, per_gene/EOG091G0OI8/ALICUT_EOG091G0OI8.clustalo.fasta
    output: per_gene/EOG091G0OI8/EOG091G0OI8.raxml.done
    log: per_gene/EOG091G0OI8/infer_single_ML.stdout.txt, per_gene/EOG091G0OI8/infer_single_ML.stderr.txt
    jobid: 270
    wildcards: BUSCO=EOG091G0OI8
    threads: 2


        cd per_gene/EOG091G0OI8
	count=$(cat ../../per_gene/EOG091G0OI8/ALICUT_EOG091G0OI8.clustalo.fasta | grep ">" | wc -l)
	if [ "$count" -gt 5 ]
        then
		RAxMLmodel=$(cat ../../per_gene/EOG091G0OI8/EOG091G0OI8.best_model | grep "Best" | cut -d ":" -f 2 | tr -d '[:space:]')
                if [ "$(ls -1 | grep "^RAxML" | wc -l)" -ne 0 ]
		then
			rm RAxML*
		fi
        	raxml -f a -T 2 -m PROTGAMMA$RAxMLmodel         	-p 12345 -x 12345 -# 100         	-s ../../per_gene/EOG091G0OI8/ALICUT_EOG091G0OI8.clustalo.fasta -n EOG091G0OI8.clustalo.aln.ALICUT.$RAxMLmodel 		1> ../../per_gene/EOG091G0OI8/infer_single_ML.stdout.txt 2> ../../per_gene/EOG091G0OI8/infer_single_ML.stderr.txt
	else
		echo "fasta file per_gene/EOG091G0OI8/ALICUT_EOG091G0OI8.clustalo.fasta contains fewer than 5 sequences - skipped" > ../../per_gene/EOG091G0OI8/infer_single_ML.stdout.txt
		touch raxml.skipped
	fi
        touch ../../per_gene/EOG091G0OI8/EOG091G0OI8.raxml.done
        
[Sun Jul  5 21:47:01 2020]
Finished job 3204.
393 of 3292 steps (12%) done

[Sun Jul  5 21:47:01 2020]
rule get_outgroups:
    input: per_gene/EOG091G0I85/EOG091G0I85.ingroup.fasta
    output: per_gene/EOG091G0I85/EOG091G0I85.orthodb.fasta, per_gene/EOG091G0I85/EOG091G0I85.outgroup.fasta
    log: per_gene/EOG091G0I85/get_outgroups.stdout.txt, per_gene/EOG091G0I85/get_outgroups.stderr.txt
    jobid: 3205
    wildcards: BUSCO=EOG091G0I85


        #download fastas from Orhtodb for BUSCO id
        for i in {1..5}
        do
             wget "http://www.orthodb.org/fasta?query=EOG091G0I85&level=33208" -O per_gene/EOG091G0I85/EOG091G0I85.orthodb.fasta 1> per_gene/EOG091G0I85/get_outgroups.stdout.txt 2> per_gene/EOG091G0I85/get_outgroups.stderr.txt && break || echo -e "try again ($i)" && sleep 15
        done

	#This is quick an dirty for now and just takes the first protein if there is more than one for an outgroup taxon
        bash ../scripts/download_outgroups.sh taxids.txt per_gene/EOG091G0I85/EOG091G0I85.orthodb.fasta > per_gene/EOG091G0I85/EOG091G0I85.outgroup.fasta
        
[33mJob counts:
	count	jobs
	1	infer_single_ML
	1[0m
[33m
        cd per_gene/EOG091G0OI8
	count=$(cat ../../per_gene/EOG091G0OI8/ALICUT_EOG091G0OI8.clustalo.fasta | grep ">" | wc -l)
	if [ "$count" -gt 5 ]
        then
		RAxMLmodel=$(cat ../../per_gene/EOG091G0OI8/EOG091G0OI8.best_model | grep "Best" | cut -d ":" -f 2 | tr -d '[:space:]')
                if [ "$(ls -1 | grep "^RAxML" | wc -l)" -ne 0 ]
		then
			rm RAxML*
		fi
        	raxml -f a -T 2 -m PROTGAMMA$RAxMLmodel         	-p 12345 -x 12345 -# 100         	-s ../../per_gene/EOG091G0OI8/ALICUT_EOG091G0OI8.clustalo.fasta -n EOG091G0OI8.clustalo.aln.ALICUT.$RAxMLmodel 		1> ../../per_gene/EOG091G0OI8/infer_single_ML.stdout.txt 2> ../../per_gene/EOG091G0OI8/infer_single_ML.stderr.txt
	else
		echo "fasta file per_gene/EOG091G0OI8/ALICUT_EOG091G0OI8.clustalo.fasta contains fewer than 5 sequences - skipped" > ../../per_gene/EOG091G0OI8/infer_single_ML.stdout.txt
		touch raxml.skipped
	fi
        touch ../../per_gene/EOG091G0OI8/EOG091G0OI8.raxml.done
        [0m
[Sun Jul  5 21:47:02 2020]
Finished job 3205.
394 of 3292 steps (12%) done

[Sun Jul  5 21:47:02 2020]
rule join_groups:
    input: per_gene/EOG091G0I85/EOG091G0I85.ingroup.fasta, per_gene/EOG091G0I85/EOG091G0I85.outgroup.fasta
    output: per_gene/EOG091G0I85/EOG091G0I85.fasta
    jobid: 2426
    wildcards: BUSCO=EOG091G0I85


        cat per_gene/EOG091G0I85/EOG091G0I85.ingroup.fasta per_gene/EOG091G0I85/EOG091G0I85.outgroup.fasta > per_gene/EOG091G0I85/EOG091G0I85.fasta
        
[Sun Jul  5 21:47:02 2020]
Finished job 2426.
395 of 3292 steps (12%) done

[Sun Jul  5 21:47:02 2020]
rule MSA:
    input: per_gene/EOG091G0I85/EOG091G0I85.fasta
    output: per_gene/EOG091G0I85/EOG091G0I85.clustalo.fasta
    log: per_gene/EOG091G0I85/MSA.stdout.txt, per_gene/EOG091G0I85/MSA.stderr.txt
    jobid: 1972
    wildcards: BUSCO=EOG091G0I85
    threads: 2


        clustalo -i per_gene/EOG091G0I85/EOG091G0I85.fasta -o per_gene/EOG091G0I85/EOG091G0I85.clustalo.fasta --threads=2 1> per_gene/EOG091G0I85/MSA.stdout.txt 2> per_gene/EOG091G0I85/MSA.stderr.txt
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/d68c9691725a7401923680874285c430.simg
[Sun Jul  5 21:47:03 2020]
Finished job 550.
396 of 3292 steps (12%) done

[Sun Jul  5 21:47:03 2020]
rule infer_single_ML:
    input: per_gene/EOG091G09HR/EOG091G09HR.best_model, per_gene/EOG091G09HR/ALICUT_EOG091G09HR.clustalo.fasta
    output: per_gene/EOG091G09HR/EOG091G09HR.raxml.done
    log: per_gene/EOG091G09HR/infer_single_ML.stdout.txt, per_gene/EOG091G09HR/infer_single_ML.stderr.txt
    jobid: 69
    wildcards: BUSCO=EOG091G09HR
    threads: 2


        cd per_gene/EOG091G09HR
	count=$(cat ../../per_gene/EOG091G09HR/ALICUT_EOG091G09HR.clustalo.fasta | grep ">" | wc -l)
	if [ "$count" -gt 5 ]
        then
		RAxMLmodel=$(cat ../../per_gene/EOG091G09HR/EOG091G09HR.best_model | grep "Best" | cut -d ":" -f 2 | tr -d '[:space:]')
                if [ "$(ls -1 | grep "^RAxML" | wc -l)" -ne 0 ]
		then
			rm RAxML*
		fi
        	raxml -f a -T 2 -m PROTGAMMA$RAxMLmodel         	-p 12345 -x 12345 -# 100         	-s ../../per_gene/EOG091G09HR/ALICUT_EOG091G09HR.clustalo.fasta -n EOG091G09HR.clustalo.aln.ALICUT.$RAxMLmodel 		1> ../../per_gene/EOG091G09HR/infer_single_ML.stdout.txt 2> ../../per_gene/EOG091G09HR/infer_single_ML.stderr.txt
	else
		echo "fasta file per_gene/EOG091G09HR/ALICUT_EOG091G09HR.clustalo.fasta contains fewer than 5 sequences - skipped" > ../../per_gene/EOG091G09HR/infer_single_ML.stdout.txt
		touch raxml.skipped
	fi
        touch ../../per_gene/EOG091G09HR/EOG091G09HR.raxml.done
        
[33mJob counts:
	count	jobs
	1	infer_single_ML
	1[0m
[33m
        cd per_gene/EOG091G09HR
	count=$(cat ../../per_gene/EOG091G09HR/ALICUT_EOG091G09HR.clustalo.fasta | grep ">" | wc -l)
	if [ "$count" -gt 5 ]
        then
		RAxMLmodel=$(cat ../../per_gene/EOG091G09HR/EOG091G09HR.best_model | grep "Best" | cut -d ":" -f 2 | tr -d '[:space:]')
                if [ "$(ls -1 | grep "^RAxML" | wc -l)" -ne 0 ]
		then
			rm RAxML*
		fi
        	raxml -f a -T 2 -m PROTGAMMA$RAxMLmodel         	-p 12345 -x 12345 -# 100         	-s ../../per_gene/EOG091G09HR/ALICUT_EOG091G09HR.clustalo.fasta -n EOG091G09HR.clustalo.aln.ALICUT.$RAxMLmodel 		1> ../../per_gene/EOG091G09HR/infer_single_ML.stdout.txt 2> ../../per_gene/EOG091G09HR/infer_single_ML.stderr.txt
	else
		echo "fasta file per_gene/EOG091G09HR/ALICUT_EOG091G09HR.clustalo.fasta contains fewer than 5 sequences - skipped" > ../../per_gene/EOG091G09HR/infer_single_ML.stdout.txt
		touch raxml.skipped
	fi
        touch ../../per_gene/EOG091G09HR/EOG091G09HR.raxml.done
        [0m
[Sun Jul  5 21:47:04 2020]
Finished job 1972.
397 of 3292 steps (12%) done

[Sun Jul  5 21:47:04 2020]
rule score_and_cut:
    input: per_gene/EOG091G0I85/EOG091G0I85.clustalo.fasta
    output: per_gene/EOG091G0I85/ALICUT_EOG091G0I85.clustalo.fasta
    jobid: 1149
    wildcards: BUSCO=EOG091G0I85
    threads: 2


        cd per_gene/EOG091G0I85
        Aliscore.pl -N -r 200000000000000000 -i ../../per_gene/EOG091G0I85/EOG091G0I85.clustalo.fasta &> aliscore.log
        ALICUT.pl -s &> alicut.log
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/63c88c27a0fa300f57066b0ef65fefcb.simg
[Sun Jul  5 21:47:15 2020]
Finished job 1149.
398 of 3292 steps (12%) done

[Sun Jul  5 21:47:15 2020]
rule remove_empty:
    input: per_gene/EOG091G0I85/ALICUT_EOG091G0I85.clustalo.fasta
    output: per_gene/EOG091G0I85/empty_check.done
    jobid: 1971
    wildcards: BUSCO=EOG091G0I85


         if [ "$(cat per_gene/EOG091G0I85/ALICUT_EOG091G0I85.clustalo.fasta | grep -v ">" | sed 's/-//g' | grep "^$" | wc -l)" -gt 0 ]
         then
              cp per_gene/EOG091G0I85/ALICUT_EOG091G0I85.clustalo.fasta per_gene/EOG091G0I85/ALICUT_EOG091G0I85.clustalo.fasta.backup
              bash ../scripts/remove_empty.sh per_gene/EOG091G0I85/ALICUT_EOG091G0I85.clustalo.fasta.backup > per_gene/EOG091G0I85/ALICUT_EOG091G0I85.clustalo.fasta
         fi
         touch per_gene/EOG091G0I85/empty_check.done
         
[Sun Jul  5 21:47:15 2020]
Finished job 1971.
399 of 3292 steps (12%) done

[Sun Jul  5 21:47:15 2020]
rule find_best_model:
    input: per_gene/EOG091G0I85/ALICUT_EOG091G0I85.clustalo.fasta, per_gene/EOG091G0I85/empty_check.done
    output: per_gene/EOG091G0I85/EOG091G0I85.best_model
    log: per_gene/EOG091G0I85/find_best_model.stderr.txt
    jobid: 1148
    wildcards: BUSCO=EOG091G0I85
    threads: 2


        cd per_gene/EOG091G0I85
        if [ ! -d find_best_model ]
        then
            mkdir find_best_model
        fi
        cd find_best_model
        ln -s ../../../per_gene/EOG091G0I85/ALICUT_EOG091G0I85.clustalo.fasta EOG091G0I85.fasta
        ProteinModelSelection.pl EOG091G0I85.fasta 1> ../../../per_gene/EOG091G0I85/EOG091G0I85.best_model 2> ../../../per_gene/EOG091G0I85/find_best_model.stderr.txt
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/c0c09ee657b1e27f2c5687e0e9aa8d70.simg
[Sun Jul  5 21:47:52 2020]
Finished job 1148.
400 of 3292 steps (12%) done

[Sun Jul  5 21:47:52 2020]
rule infer_single_ML:
    input: per_gene/EOG091G0I85/EOG091G0I85.best_model, per_gene/EOG091G0I85/ALICUT_EOG091G0I85.clustalo.fasta
    output: per_gene/EOG091G0I85/EOG091G0I85.raxml.done
    log: per_gene/EOG091G0I85/infer_single_ML.stdout.txt, per_gene/EOG091G0I85/infer_single_ML.stderr.txt
    jobid: 368
    wildcards: BUSCO=EOG091G0I85
    threads: 2


        cd per_gene/EOG091G0I85
	count=$(cat ../../per_gene/EOG091G0I85/ALICUT_EOG091G0I85.clustalo.fasta | grep ">" | wc -l)
	if [ "$count" -gt 5 ]
        then
		RAxMLmodel=$(cat ../../per_gene/EOG091G0I85/EOG091G0I85.best_model | grep "Best" | cut -d ":" -f 2 | tr -d '[:space:]')
                if [ "$(ls -1 | grep "^RAxML" | wc -l)" -ne 0 ]
		then
			rm RAxML*
		fi
        	raxml -f a -T 2 -m PROTGAMMA$RAxMLmodel         	-p 12345 -x 12345 -# 100         	-s ../../per_gene/EOG091G0I85/ALICUT_EOG091G0I85.clustalo.fasta -n EOG091G0I85.clustalo.aln.ALICUT.$RAxMLmodel 		1> ../../per_gene/EOG091G0I85/infer_single_ML.stdout.txt 2> ../../per_gene/EOG091G0I85/infer_single_ML.stderr.txt
	else
		echo "fasta file per_gene/EOG091G0I85/ALICUT_EOG091G0I85.clustalo.fasta contains fewer than 5 sequences - skipped" > ../../per_gene/EOG091G0I85/infer_single_ML.stdout.txt
		touch raxml.skipped
	fi
        touch ../../per_gene/EOG091G0I85/EOG091G0I85.raxml.done
        
[33mJob counts:
	count	jobs
	1	infer_single_ML
	1[0m
[33m
        cd per_gene/EOG091G0I85
	count=$(cat ../../per_gene/EOG091G0I85/ALICUT_EOG091G0I85.clustalo.fasta | grep ">" | wc -l)
	if [ "$count" -gt 5 ]
        then
		RAxMLmodel=$(cat ../../per_gene/EOG091G0I85/EOG091G0I85.best_model | grep "Best" | cut -d ":" -f 2 | tr -d '[:space:]')
                if [ "$(ls -1 | grep "^RAxML" | wc -l)" -ne 0 ]
		then
			rm RAxML*
		fi
        	raxml -f a -T 2 -m PROTGAMMA$RAxMLmodel         	-p 12345 -x 12345 -# 100         	-s ../../per_gene/EOG091G0I85/ALICUT_EOG091G0I85.clustalo.fasta -n EOG091G0I85.clustalo.aln.ALICUT.$RAxMLmodel 		1> ../../per_gene/EOG091G0I85/infer_single_ML.stdout.txt 2> ../../per_gene/EOG091G0I85/infer_single_ML.stderr.txt
	else
		echo "fasta file per_gene/EOG091G0I85/ALICUT_EOG091G0I85.clustalo.fasta contains fewer than 5 sequences - skipped" > ../../per_gene/EOG091G0I85/infer_single_ML.stdout.txt
		touch raxml.skipped
	fi
        touch ../../per_gene/EOG091G0I85/EOG091G0I85.raxml.done
        [0m
[Sun Jul  5 21:48:59 2020]
Finished job 324.
401 of 3292 steps (12%) done

[Sun Jul  5 21:48:59 2020]
rule get_seqs:
    input: /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ingroup.txt, /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/outgroup.txt
    output: per_gene/EOG091G0EAF/EOG091G0EAF.ingroup.fasta
    log: per_gene/EOG091G0EAF/get_seqs.stdout.txt, per_gene/EOG091G0EAF/get_seqs.stderr.txt
    jobid: 3270
    wildcards: BUSCO=EOG091G0EAF
    threads: 2


	basedir=$(pwd)
        cd per_gene/EOG091G0EAF
        
        bash $basedir/../scripts/fetch_seqs.sh EOG091G0EAF /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ingroup.txt /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/outgroup.txt 1> ../../per_gene/EOG091G0EAF/get_seqs.stdout.txt 2> ../../per_gene/EOG091G0EAF/get_seqs.stderr.txt
	mv EOG091G0EAF.fasta $basedir/per_gene/EOG091G0EAF/EOG091G0EAF.ingroup.fasta
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/72476f9d9a5bd0627b4d721143a21354.simg
[Sun Jul  5 21:49:12 2020]
Finished job 3270.
402 of 3292 steps (12%) done

[Sun Jul  5 21:49:12 2020]
rule get_outgroups:
    input: per_gene/EOG091G0EAF/EOG091G0EAF.ingroup.fasta
    output: per_gene/EOG091G0EAF/EOG091G0EAF.orthodb.fasta, per_gene/EOG091G0EAF/EOG091G0EAF.outgroup.fasta
    log: per_gene/EOG091G0EAF/get_outgroups.stdout.txt, per_gene/EOG091G0EAF/get_outgroups.stderr.txt
    jobid: 3271
    wildcards: BUSCO=EOG091G0EAF


        #download fastas from Orhtodb for BUSCO id
        for i in {1..5}
        do
             wget "http://www.orthodb.org/fasta?query=EOG091G0EAF&level=33208" -O per_gene/EOG091G0EAF/EOG091G0EAF.orthodb.fasta 1> per_gene/EOG091G0EAF/get_outgroups.stdout.txt 2> per_gene/EOG091G0EAF/get_outgroups.stderr.txt && break || echo -e "try again ($i)" && sleep 15
        done

	#This is quick an dirty for now and just takes the first protein if there is more than one for an outgroup taxon
        bash ../scripts/download_outgroups.sh taxids.txt per_gene/EOG091G0EAF/EOG091G0EAF.orthodb.fasta > per_gene/EOG091G0EAF/EOG091G0EAF.outgroup.fasta
        
[Sun Jul  5 21:49:13 2020]
Finished job 3271.
403 of 3292 steps (12%) done

[Sun Jul  5 21:49:13 2020]
rule join_groups:
    input: per_gene/EOG091G0EAF/EOG091G0EAF.ingroup.fasta, per_gene/EOG091G0EAF/EOG091G0EAF.outgroup.fasta
    output: per_gene/EOG091G0EAF/EOG091G0EAF.fasta
    jobid: 2459
    wildcards: BUSCO=EOG091G0EAF


        cat per_gene/EOG091G0EAF/EOG091G0EAF.ingroup.fasta per_gene/EOG091G0EAF/EOG091G0EAF.outgroup.fasta > per_gene/EOG091G0EAF/EOG091G0EAF.fasta
        
[Sun Jul  5 21:49:13 2020]
Finished job 2459.
404 of 3292 steps (12%) done

[Sun Jul  5 21:49:13 2020]
rule MSA:
    input: per_gene/EOG091G0EAF/EOG091G0EAF.fasta
    output: per_gene/EOG091G0EAF/EOG091G0EAF.clustalo.fasta
    log: per_gene/EOG091G0EAF/MSA.stdout.txt, per_gene/EOG091G0EAF/MSA.stderr.txt
    jobid: 2038
    wildcards: BUSCO=EOG091G0EAF
    threads: 2


        clustalo -i per_gene/EOG091G0EAF/EOG091G0EAF.fasta -o per_gene/EOG091G0EAF/EOG091G0EAF.clustalo.fasta --threads=2 1> per_gene/EOG091G0EAF/MSA.stdout.txt 2> per_gene/EOG091G0EAF/MSA.stderr.txt
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/d68c9691725a7401923680874285c430.simg
[Sun Jul  5 21:49:14 2020]
Finished job 2038.
405 of 3292 steps (12%) done

[Sun Jul  5 21:49:14 2020]
rule score_and_cut:
    input: per_gene/EOG091G0EAF/EOG091G0EAF.clustalo.fasta
    output: per_gene/EOG091G0EAF/ALICUT_EOG091G0EAF.clustalo.fasta
    jobid: 1215
    wildcards: BUSCO=EOG091G0EAF
    threads: 2


        cd per_gene/EOG091G0EAF
        Aliscore.pl -N -r 200000000000000000 -i ../../per_gene/EOG091G0EAF/EOG091G0EAF.clustalo.fasta &> aliscore.log
        ALICUT.pl -s &> alicut.log
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/63c88c27a0fa300f57066b0ef65fefcb.simg
[Sun Jul  5 21:49:15 2020]
Finished job 354.
406 of 3292 steps (12%) done

[Sun Jul  5 21:49:15 2020]
rule get_seqs:
    input: /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ingroup.txt, /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/outgroup.txt
    output: per_gene/EOG091G0Z4E/EOG091G0Z4E.ingroup.fasta
    log: per_gene/EOG091G0Z4E/get_seqs.stdout.txt, per_gene/EOG091G0Z4E/get_seqs.stderr.txt
    jobid: 2904
    wildcards: BUSCO=EOG091G0Z4E
    threads: 2


	basedir=$(pwd)
        cd per_gene/EOG091G0Z4E
        
        bash $basedir/../scripts/fetch_seqs.sh EOG091G0Z4E /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ingroup.txt /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/outgroup.txt 1> ../../per_gene/EOG091G0Z4E/get_seqs.stdout.txt 2> ../../per_gene/EOG091G0Z4E/get_seqs.stderr.txt
	mv EOG091G0Z4E.fasta $basedir/per_gene/EOG091G0Z4E/EOG091G0Z4E.ingroup.fasta
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/72476f9d9a5bd0627b4d721143a21354.simg
[Sun Jul  5 21:49:28 2020]
Finished job 1215.
407 of 3292 steps (12%) done

[Sun Jul  5 21:49:28 2020]
rule remove_empty:
    input: per_gene/EOG091G0EAF/ALICUT_EOG091G0EAF.clustalo.fasta
    output: per_gene/EOG091G0EAF/empty_check.done
    jobid: 2037
    wildcards: BUSCO=EOG091G0EAF


         if [ "$(cat per_gene/EOG091G0EAF/ALICUT_EOG091G0EAF.clustalo.fasta | grep -v ">" | sed 's/-//g' | grep "^$" | wc -l)" -gt 0 ]
         then
              cp per_gene/EOG091G0EAF/ALICUT_EOG091G0EAF.clustalo.fasta per_gene/EOG091G0EAF/ALICUT_EOG091G0EAF.clustalo.fasta.backup
              bash ../scripts/remove_empty.sh per_gene/EOG091G0EAF/ALICUT_EOG091G0EAF.clustalo.fasta.backup > per_gene/EOG091G0EAF/ALICUT_EOG091G0EAF.clustalo.fasta
         fi
         touch per_gene/EOG091G0EAF/empty_check.done
         
[Sun Jul  5 21:49:28 2020]
Finished job 2037.
408 of 3292 steps (12%) done

[Sun Jul  5 21:49:28 2020]
rule find_best_model:
    input: per_gene/EOG091G0EAF/ALICUT_EOG091G0EAF.clustalo.fasta, per_gene/EOG091G0EAF/empty_check.done
    output: per_gene/EOG091G0EAF/EOG091G0EAF.best_model
    log: per_gene/EOG091G0EAF/find_best_model.stderr.txt
    jobid: 1214
    wildcards: BUSCO=EOG091G0EAF
    threads: 2


        cd per_gene/EOG091G0EAF
        if [ ! -d find_best_model ]
        then
            mkdir find_best_model
        fi
        cd find_best_model
        ln -s ../../../per_gene/EOG091G0EAF/ALICUT_EOG091G0EAF.clustalo.fasta EOG091G0EAF.fasta
        ProteinModelSelection.pl EOG091G0EAF.fasta 1> ../../../per_gene/EOG091G0EAF/EOG091G0EAF.best_model 2> ../../../per_gene/EOG091G0EAF/find_best_model.stderr.txt
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/c0c09ee657b1e27f2c5687e0e9aa8d70.simg
[Sun Jul  5 21:49:34 2020]
Finished job 2904.
409 of 3292 steps (12%) done

[Sun Jul  5 21:49:34 2020]
rule get_outgroups:
    input: per_gene/EOG091G0Z4E/EOG091G0Z4E.ingroup.fasta
    output: per_gene/EOG091G0Z4E/EOG091G0Z4E.orthodb.fasta, per_gene/EOG091G0Z4E/EOG091G0Z4E.outgroup.fasta
    log: per_gene/EOG091G0Z4E/get_outgroups.stdout.txt, per_gene/EOG091G0Z4E/get_outgroups.stderr.txt
    jobid: 2905
    wildcards: BUSCO=EOG091G0Z4E


        #download fastas from Orhtodb for BUSCO id
        for i in {1..5}
        do
             wget "http://www.orthodb.org/fasta?query=EOG091G0Z4E&level=33208" -O per_gene/EOG091G0Z4E/EOG091G0Z4E.orthodb.fasta 1> per_gene/EOG091G0Z4E/get_outgroups.stdout.txt 2> per_gene/EOG091G0Z4E/get_outgroups.stderr.txt && break || echo -e "try again ($i)" && sleep 15
        done

	#This is quick an dirty for now and just takes the first protein if there is more than one for an outgroup taxon
        bash ../scripts/download_outgroups.sh taxids.txt per_gene/EOG091G0Z4E/EOG091G0Z4E.orthodb.fasta > per_gene/EOG091G0Z4E/EOG091G0Z4E.outgroup.fasta
        
[Sun Jul  5 21:49:35 2020]
Finished job 2905.
410 of 3292 steps (12%) done

[Sun Jul  5 21:49:35 2020]
rule join_groups:
    input: per_gene/EOG091G0Z4E/EOG091G0Z4E.ingroup.fasta, per_gene/EOG091G0Z4E/EOG091G0Z4E.outgroup.fasta
    output: per_gene/EOG091G0Z4E/EOG091G0Z4E.fasta
    jobid: 2276
    wildcards: BUSCO=EOG091G0Z4E


        cat per_gene/EOG091G0Z4E/EOG091G0Z4E.ingroup.fasta per_gene/EOG091G0Z4E/EOG091G0Z4E.outgroup.fasta > per_gene/EOG091G0Z4E/EOG091G0Z4E.fasta
        
[Sun Jul  5 21:49:35 2020]
Finished job 2276.
411 of 3292 steps (12%) done

[Sun Jul  5 21:49:35 2020]
rule MSA:
    input: per_gene/EOG091G0Z4E/EOG091G0Z4E.fasta
    output: per_gene/EOG091G0Z4E/EOG091G0Z4E.clustalo.fasta
    log: per_gene/EOG091G0Z4E/MSA.stdout.txt, per_gene/EOG091G0Z4E/MSA.stderr.txt
    jobid: 1672
    wildcards: BUSCO=EOG091G0Z4E
    threads: 2


        clustalo -i per_gene/EOG091G0Z4E/EOG091G0Z4E.fasta -o per_gene/EOG091G0Z4E/EOG091G0Z4E.clustalo.fasta --threads=2 1> per_gene/EOG091G0Z4E/MSA.stdout.txt 2> per_gene/EOG091G0Z4E/MSA.stderr.txt
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/d68c9691725a7401923680874285c430.simg
[Sun Jul  5 21:49:35 2020]
Finished job 1672.
412 of 3292 steps (13%) done

[Sun Jul  5 21:49:35 2020]
rule score_and_cut:
    input: per_gene/EOG091G0Z4E/EOG091G0Z4E.clustalo.fasta
    output: per_gene/EOG091G0Z4E/ALICUT_EOG091G0Z4E.clustalo.fasta
    jobid: 849
    wildcards: BUSCO=EOG091G0Z4E
    threads: 2


        cd per_gene/EOG091G0Z4E
        Aliscore.pl -N -r 200000000000000000 -i ../../per_gene/EOG091G0Z4E/EOG091G0Z4E.clustalo.fasta &> aliscore.log
        ALICUT.pl -s &> alicut.log
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/63c88c27a0fa300f57066b0ef65fefcb.simg
[Sun Jul  5 21:49:41 2020]
Finished job 232.
413 of 3292 steps (13%) done

[Sun Jul  5 21:49:41 2020]
rule get_seqs:
    input: /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ingroup.txt, /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/outgroup.txt
    output: per_gene/EOG091G05AA/EOG091G05AA.ingroup.fasta
    log: per_gene/EOG091G05AA/get_seqs.stdout.txt, per_gene/EOG091G05AA/get_seqs.stderr.txt
    jobid: 2532
    wildcards: BUSCO=EOG091G05AA
    threads: 2


	basedir=$(pwd)
        cd per_gene/EOG091G05AA
        
        bash $basedir/../scripts/fetch_seqs.sh EOG091G05AA /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ingroup.txt /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/outgroup.txt 1> ../../per_gene/EOG091G05AA/get_seqs.stdout.txt 2> ../../per_gene/EOG091G05AA/get_seqs.stderr.txt
	mv EOG091G05AA.fasta $basedir/per_gene/EOG091G05AA/EOG091G05AA.ingroup.fasta
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/72476f9d9a5bd0627b4d721143a21354.simg
[Sun Jul  5 21:49:45 2020]
Finished job 849.
414 of 3292 steps (13%) done

[Sun Jul  5 21:49:46 2020]
rule remove_empty:
    input: per_gene/EOG091G0Z4E/ALICUT_EOG091G0Z4E.clustalo.fasta
    output: per_gene/EOG091G0Z4E/empty_check.done
    jobid: 1671
    wildcards: BUSCO=EOG091G0Z4E


         if [ "$(cat per_gene/EOG091G0Z4E/ALICUT_EOG091G0Z4E.clustalo.fasta | grep -v ">" | sed 's/-//g' | grep "^$" | wc -l)" -gt 0 ]
         then
              cp per_gene/EOG091G0Z4E/ALICUT_EOG091G0Z4E.clustalo.fasta per_gene/EOG091G0Z4E/ALICUT_EOG091G0Z4E.clustalo.fasta.backup
              bash ../scripts/remove_empty.sh per_gene/EOG091G0Z4E/ALICUT_EOG091G0Z4E.clustalo.fasta.backup > per_gene/EOG091G0Z4E/ALICUT_EOG091G0Z4E.clustalo.fasta
         fi
         touch per_gene/EOG091G0Z4E/empty_check.done
         
[Sun Jul  5 21:49:46 2020]
Finished job 1671.
415 of 3292 steps (13%) done

[Sun Jul  5 21:49:46 2020]
rule find_best_model:
    input: per_gene/EOG091G0Z4E/ALICUT_EOG091G0Z4E.clustalo.fasta, per_gene/EOG091G0Z4E/empty_check.done
    output: per_gene/EOG091G0Z4E/EOG091G0Z4E.best_model
    log: per_gene/EOG091G0Z4E/find_best_model.stderr.txt
    jobid: 848
    wildcards: BUSCO=EOG091G0Z4E
    threads: 2


        cd per_gene/EOG091G0Z4E
        if [ ! -d find_best_model ]
        then
            mkdir find_best_model
        fi
        cd find_best_model
        ln -s ../../../per_gene/EOG091G0Z4E/ALICUT_EOG091G0Z4E.clustalo.fasta EOG091G0Z4E.fasta
        ProteinModelSelection.pl EOG091G0Z4E.fasta 1> ../../../per_gene/EOG091G0Z4E/EOG091G0Z4E.best_model 2> ../../../per_gene/EOG091G0Z4E/find_best_model.stderr.txt
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/c0c09ee657b1e27f2c5687e0e9aa8d70.simg
[Sun Jul  5 21:49:57 2020]
Finished job 2532.
416 of 3292 steps (13%) done

[Sun Jul  5 21:49:57 2020]
rule get_outgroups:
    input: per_gene/EOG091G05AA/EOG091G05AA.ingroup.fasta
    output: per_gene/EOG091G05AA/EOG091G05AA.orthodb.fasta, per_gene/EOG091G05AA/EOG091G05AA.outgroup.fasta
    log: per_gene/EOG091G05AA/get_outgroups.stdout.txt, per_gene/EOG091G05AA/get_outgroups.stderr.txt
    jobid: 2533
    wildcards: BUSCO=EOG091G05AA


        #download fastas from Orhtodb for BUSCO id
        for i in {1..5}
        do
             wget "http://www.orthodb.org/fasta?query=EOG091G05AA&level=33208" -O per_gene/EOG091G05AA/EOG091G05AA.orthodb.fasta 1> per_gene/EOG091G05AA/get_outgroups.stdout.txt 2> per_gene/EOG091G05AA/get_outgroups.stderr.txt && break || echo -e "try again ($i)" && sleep 15
        done

	#This is quick an dirty for now and just takes the first protein if there is more than one for an outgroup taxon
        bash ../scripts/download_outgroups.sh taxids.txt per_gene/EOG091G05AA/EOG091G05AA.orthodb.fasta > per_gene/EOG091G05AA/EOG091G05AA.outgroup.fasta
        
[Sun Jul  5 21:49:58 2020]
Finished job 2533.
417 of 3292 steps (13%) done

[Sun Jul  5 21:49:58 2020]
rule join_groups:
    input: per_gene/EOG091G05AA/EOG091G05AA.ingroup.fasta, per_gene/EOG091G05AA/EOG091G05AA.outgroup.fasta
    output: per_gene/EOG091G05AA/EOG091G05AA.fasta
    jobid: 2090
    wildcards: BUSCO=EOG091G05AA


        cat per_gene/EOG091G05AA/EOG091G05AA.ingroup.fasta per_gene/EOG091G05AA/EOG091G05AA.outgroup.fasta > per_gene/EOG091G05AA/EOG091G05AA.fasta
        
[Sun Jul  5 21:49:58 2020]
Finished job 2090.
418 of 3292 steps (13%) done

[Sun Jul  5 21:49:58 2020]
rule MSA:
    input: per_gene/EOG091G05AA/EOG091G05AA.fasta
    output: per_gene/EOG091G05AA/EOG091G05AA.clustalo.fasta
    log: per_gene/EOG091G05AA/MSA.stdout.txt, per_gene/EOG091G05AA/MSA.stderr.txt
    jobid: 1300
    wildcards: BUSCO=EOG091G05AA
    threads: 2


        clustalo -i per_gene/EOG091G05AA/EOG091G05AA.fasta -o per_gene/EOG091G05AA/EOG091G05AA.clustalo.fasta --threads=2 1> per_gene/EOG091G05AA/MSA.stdout.txt 2> per_gene/EOG091G05AA/MSA.stderr.txt
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/d68c9691725a7401923680874285c430.simg
[Sun Jul  5 21:49:58 2020]
Finished job 98.
419 of 3292 steps (13%) done

[Sun Jul  5 21:49:58 2020]
rule get_seqs:
    input: /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ingroup.txt, /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/outgroup.txt
    output: per_gene/EOG091G07Z5/EOG091G07Z5.ingroup.fasta
    log: per_gene/EOG091G07Z5/get_seqs.stdout.txt, per_gene/EOG091G07Z5/get_seqs.stderr.txt
    jobid: 2586
    wildcards: BUSCO=EOG091G07Z5
    threads: 2


	basedir=$(pwd)
        cd per_gene/EOG091G07Z5
        
        bash $basedir/../scripts/fetch_seqs.sh EOG091G07Z5 /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ingroup.txt /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/outgroup.txt 1> ../../per_gene/EOG091G07Z5/get_seqs.stdout.txt 2> ../../per_gene/EOG091G07Z5/get_seqs.stderr.txt
	mv EOG091G07Z5.fasta $basedir/per_gene/EOG091G07Z5/EOG091G07Z5.ingroup.fasta
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/72476f9d9a5bd0627b4d721143a21354.simg
[Sun Jul  5 21:49:59 2020]
Finished job 1300.
420 of 3292 steps (13%) done

[Sun Jul  5 21:49:59 2020]
rule score_and_cut:
    input: per_gene/EOG091G05AA/EOG091G05AA.clustalo.fasta
    output: per_gene/EOG091G05AA/ALICUT_EOG091G05AA.clustalo.fasta
    jobid: 477
    wildcards: BUSCO=EOG091G05AA
    threads: 2


        cd per_gene/EOG091G05AA
        Aliscore.pl -N -r 200000000000000000 -i ../../per_gene/EOG091G05AA/EOG091G05AA.clustalo.fasta &> aliscore.log
        ALICUT.pl -s &> alicut.log
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/63c88c27a0fa300f57066b0ef65fefcb.simg
[Sun Jul  5 21:50:10 2020]
Finished job 477.
421 of 3292 steps (13%) done

[Sun Jul  5 21:50:10 2020]
rule remove_empty:
    input: per_gene/EOG091G05AA/ALICUT_EOG091G05AA.clustalo.fasta
    output: per_gene/EOG091G05AA/empty_check.done
    jobid: 1299
    wildcards: BUSCO=EOG091G05AA


         if [ "$(cat per_gene/EOG091G05AA/ALICUT_EOG091G05AA.clustalo.fasta | grep -v ">" | sed 's/-//g' | grep "^$" | wc -l)" -gt 0 ]
         then
              cp per_gene/EOG091G05AA/ALICUT_EOG091G05AA.clustalo.fasta per_gene/EOG091G05AA/ALICUT_EOG091G05AA.clustalo.fasta.backup
              bash ../scripts/remove_empty.sh per_gene/EOG091G05AA/ALICUT_EOG091G05AA.clustalo.fasta.backup > per_gene/EOG091G05AA/ALICUT_EOG091G05AA.clustalo.fasta
         fi
         touch per_gene/EOG091G05AA/empty_check.done
         
[Sun Jul  5 21:50:11 2020]
Finished job 1299.
422 of 3292 steps (13%) done

[Sun Jul  5 21:50:11 2020]
rule find_best_model:
    input: per_gene/EOG091G05AA/ALICUT_EOG091G05AA.clustalo.fasta, per_gene/EOG091G05AA/empty_check.done
    output: per_gene/EOG091G05AA/EOG091G05AA.best_model
    log: per_gene/EOG091G05AA/find_best_model.stderr.txt
    jobid: 476
    wildcards: BUSCO=EOG091G05AA
    threads: 2


        cd per_gene/EOG091G05AA
        if [ ! -d find_best_model ]
        then
            mkdir find_best_model
        fi
        cd find_best_model
        ln -s ../../../per_gene/EOG091G05AA/ALICUT_EOG091G05AA.clustalo.fasta EOG091G05AA.fasta
        ProteinModelSelection.pl EOG091G05AA.fasta 1> ../../../per_gene/EOG091G05AA/EOG091G05AA.best_model 2> ../../../per_gene/EOG091G05AA/find_best_model.stderr.txt
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/c0c09ee657b1e27f2c5687e0e9aa8d70.simg
[Sun Jul  5 21:50:12 2020]
Finished job 2586.
423 of 3292 steps (13%) done

[Sun Jul  5 21:50:12 2020]
rule get_outgroups:
    input: per_gene/EOG091G07Z5/EOG091G07Z5.ingroup.fasta
    output: per_gene/EOG091G07Z5/EOG091G07Z5.orthodb.fasta, per_gene/EOG091G07Z5/EOG091G07Z5.outgroup.fasta
    log: per_gene/EOG091G07Z5/get_outgroups.stdout.txt, per_gene/EOG091G07Z5/get_outgroups.stderr.txt
    jobid: 2587
    wildcards: BUSCO=EOG091G07Z5


        #download fastas from Orhtodb for BUSCO id
        for i in {1..5}
        do
             wget "http://www.orthodb.org/fasta?query=EOG091G07Z5&level=33208" -O per_gene/EOG091G07Z5/EOG091G07Z5.orthodb.fasta 1> per_gene/EOG091G07Z5/get_outgroups.stdout.txt 2> per_gene/EOG091G07Z5/get_outgroups.stderr.txt && break || echo -e "try again ($i)" && sleep 15
        done

	#This is quick an dirty for now and just takes the first protein if there is more than one for an outgroup taxon
        bash ../scripts/download_outgroups.sh taxids.txt per_gene/EOG091G07Z5/EOG091G07Z5.orthodb.fasta > per_gene/EOG091G07Z5/EOG091G07Z5.outgroup.fasta
        
[Sun Jul  5 21:50:14 2020]
Finished job 2587.
424 of 3292 steps (13%) done

[Sun Jul  5 21:50:14 2020]
rule join_groups:
    input: per_gene/EOG091G07Z5/EOG091G07Z5.ingroup.fasta, per_gene/EOG091G07Z5/EOG091G07Z5.outgroup.fasta
    output: per_gene/EOG091G07Z5/EOG091G07Z5.fasta
    jobid: 2117
    wildcards: BUSCO=EOG091G07Z5


        cat per_gene/EOG091G07Z5/EOG091G07Z5.ingroup.fasta per_gene/EOG091G07Z5/EOG091G07Z5.outgroup.fasta > per_gene/EOG091G07Z5/EOG091G07Z5.fasta
        
[Sun Jul  5 21:50:14 2020]
Finished job 2117.
425 of 3292 steps (13%) done

[Sun Jul  5 21:50:14 2020]
rule MSA:
    input: per_gene/EOG091G07Z5/EOG091G07Z5.fasta
    output: per_gene/EOG091G07Z5/EOG091G07Z5.clustalo.fasta
    log: per_gene/EOG091G07Z5/MSA.stdout.txt, per_gene/EOG091G07Z5/MSA.stderr.txt
    jobid: 1354
    wildcards: BUSCO=EOG091G07Z5
    threads: 2


        clustalo -i per_gene/EOG091G07Z5/EOG091G07Z5.fasta -o per_gene/EOG091G07Z5/EOG091G07Z5.clustalo.fasta --threads=2 1> per_gene/EOG091G07Z5/MSA.stdout.txt 2> per_gene/EOG091G07Z5/MSA.stderr.txt
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/d68c9691725a7401923680874285c430.simg
[Sun Jul  5 21:50:15 2020]
Finished job 1214.
426 of 3292 steps (13%) done

[Sun Jul  5 21:50:15 2020]
rule infer_single_ML:
    input: per_gene/EOG091G0EAF/EOG091G0EAF.best_model, per_gene/EOG091G0EAF/ALICUT_EOG091G0EAF.clustalo.fasta
    output: per_gene/EOG091G0EAF/EOG091G0EAF.raxml.done
    log: per_gene/EOG091G0EAF/infer_single_ML.stdout.txt, per_gene/EOG091G0EAF/infer_single_ML.stderr.txt
    jobid: 401
    wildcards: BUSCO=EOG091G0EAF
    threads: 2


        cd per_gene/EOG091G0EAF
	count=$(cat ../../per_gene/EOG091G0EAF/ALICUT_EOG091G0EAF.clustalo.fasta | grep ">" | wc -l)
	if [ "$count" -gt 5 ]
        then
		RAxMLmodel=$(cat ../../per_gene/EOG091G0EAF/EOG091G0EAF.best_model | grep "Best" | cut -d ":" -f 2 | tr -d '[:space:]')
                if [ "$(ls -1 | grep "^RAxML" | wc -l)" -ne 0 ]
		then
			rm RAxML*
		fi
        	raxml -f a -T 2 -m PROTGAMMA$RAxMLmodel         	-p 12345 -x 12345 -# 100         	-s ../../per_gene/EOG091G0EAF/ALICUT_EOG091G0EAF.clustalo.fasta -n EOG091G0EAF.clustalo.aln.ALICUT.$RAxMLmodel 		1> ../../per_gene/EOG091G0EAF/infer_single_ML.stdout.txt 2> ../../per_gene/EOG091G0EAF/infer_single_ML.stderr.txt
	else
		echo "fasta file per_gene/EOG091G0EAF/ALICUT_EOG091G0EAF.clustalo.fasta contains fewer than 5 sequences - skipped" > ../../per_gene/EOG091G0EAF/infer_single_ML.stdout.txt
		touch raxml.skipped
	fi
        touch ../../per_gene/EOG091G0EAF/EOG091G0EAF.raxml.done
        
[33mJob counts:
	count	jobs
	1	infer_single_ML
	1[0m
[33m
        cd per_gene/EOG091G0EAF
	count=$(cat ../../per_gene/EOG091G0EAF/ALICUT_EOG091G0EAF.clustalo.fasta | grep ">" | wc -l)
	if [ "$count" -gt 5 ]
        then
		RAxMLmodel=$(cat ../../per_gene/EOG091G0EAF/EOG091G0EAF.best_model | grep "Best" | cut -d ":" -f 2 | tr -d '[:space:]')
                if [ "$(ls -1 | grep "^RAxML" | wc -l)" -ne 0 ]
		then
			rm RAxML*
		fi
        	raxml -f a -T 2 -m PROTGAMMA$RAxMLmodel         	-p 12345 -x 12345 -# 100         	-s ../../per_gene/EOG091G0EAF/ALICUT_EOG091G0EAF.clustalo.fasta -n EOG091G0EAF.clustalo.aln.ALICUT.$RAxMLmodel 		1> ../../per_gene/EOG091G0EAF/infer_single_ML.stdout.txt 2> ../../per_gene/EOG091G0EAF/infer_single_ML.stderr.txt
	else
		echo "fasta file per_gene/EOG091G0EAF/ALICUT_EOG091G0EAF.clustalo.fasta contains fewer than 5 sequences - skipped" > ../../per_gene/EOG091G0EAF/infer_single_ML.stdout.txt
		touch raxml.skipped
	fi
        touch ../../per_gene/EOG091G0EAF/EOG091G0EAF.raxml.done
        [0m
[Sun Jul  5 21:50:16 2020]
Finished job 1354.
427 of 3292 steps (13%) done

[Sun Jul  5 21:50:16 2020]
rule score_and_cut:
    input: per_gene/EOG091G07Z5/EOG091G07Z5.clustalo.fasta
    output: per_gene/EOG091G07Z5/ALICUT_EOG091G07Z5.clustalo.fasta
    jobid: 531
    wildcards: BUSCO=EOG091G07Z5
    threads: 2


        cd per_gene/EOG091G07Z5
        Aliscore.pl -N -r 200000000000000000 -i ../../per_gene/EOG091G07Z5/EOG091G07Z5.clustalo.fasta &> aliscore.log
        ALICUT.pl -s &> alicut.log
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/63c88c27a0fa300f57066b0ef65fefcb.simg
[Sun Jul  5 21:50:18 2020]
Finished job 848.
428 of 3292 steps (13%) done

[Sun Jul  5 21:50:18 2020]
rule infer_single_ML:
    input: per_gene/EOG091G0Z4E/EOG091G0Z4E.best_model, per_gene/EOG091G0Z4E/ALICUT_EOG091G0Z4E.clustalo.fasta
    output: per_gene/EOG091G0Z4E/EOG091G0Z4E.raxml.done
    log: per_gene/EOG091G0Z4E/infer_single_ML.stdout.txt, per_gene/EOG091G0Z4E/infer_single_ML.stderr.txt
    jobid: 218
    wildcards: BUSCO=EOG091G0Z4E
    threads: 2


        cd per_gene/EOG091G0Z4E
	count=$(cat ../../per_gene/EOG091G0Z4E/ALICUT_EOG091G0Z4E.clustalo.fasta | grep ">" | wc -l)
	if [ "$count" -gt 5 ]
        then
		RAxMLmodel=$(cat ../../per_gene/EOG091G0Z4E/EOG091G0Z4E.best_model | grep "Best" | cut -d ":" -f 2 | tr -d '[:space:]')
                if [ "$(ls -1 | grep "^RAxML" | wc -l)" -ne 0 ]
		then
			rm RAxML*
		fi
        	raxml -f a -T 2 -m PROTGAMMA$RAxMLmodel         	-p 12345 -x 12345 -# 100         	-s ../../per_gene/EOG091G0Z4E/ALICUT_EOG091G0Z4E.clustalo.fasta -n EOG091G0Z4E.clustalo.aln.ALICUT.$RAxMLmodel 		1> ../../per_gene/EOG091G0Z4E/infer_single_ML.stdout.txt 2> ../../per_gene/EOG091G0Z4E/infer_single_ML.stderr.txt
	else
		echo "fasta file per_gene/EOG091G0Z4E/ALICUT_EOG091G0Z4E.clustalo.fasta contains fewer than 5 sequences - skipped" > ../../per_gene/EOG091G0Z4E/infer_single_ML.stdout.txt
		touch raxml.skipped
	fi
        touch ../../per_gene/EOG091G0Z4E/EOG091G0Z4E.raxml.done
        
[33mJob counts:
	count	jobs
	1	infer_single_ML
	1[0m
[33m
        cd per_gene/EOG091G0Z4E
	count=$(cat ../../per_gene/EOG091G0Z4E/ALICUT_EOG091G0Z4E.clustalo.fasta | grep ">" | wc -l)
	if [ "$count" -gt 5 ]
        then
		RAxMLmodel=$(cat ../../per_gene/EOG091G0Z4E/EOG091G0Z4E.best_model | grep "Best" | cut -d ":" -f 2 | tr -d '[:space:]')
                if [ "$(ls -1 | grep "^RAxML" | wc -l)" -ne 0 ]
		then
			rm RAxML*
		fi
        	raxml -f a -T 2 -m PROTGAMMA$RAxMLmodel         	-p 12345 -x 12345 -# 100         	-s ../../per_gene/EOG091G0Z4E/ALICUT_EOG091G0Z4E.clustalo.fasta -n EOG091G0Z4E.clustalo.aln.ALICUT.$RAxMLmodel 		1> ../../per_gene/EOG091G0Z4E/infer_single_ML.stdout.txt 2> ../../per_gene/EOG091G0Z4E/infer_single_ML.stderr.txt
	else
		echo "fasta file per_gene/EOG091G0Z4E/ALICUT_EOG091G0Z4E.clustalo.fasta contains fewer than 5 sequences - skipped" > ../../per_gene/EOG091G0Z4E/infer_single_ML.stdout.txt
		touch raxml.skipped
	fi
        touch ../../per_gene/EOG091G0Z4E/EOG091G0Z4E.raxml.done
        [0m
[Sun Jul  5 21:50:27 2020]
Finished job 531.
429 of 3292 steps (13%) done

[Sun Jul  5 21:50:27 2020]
rule remove_empty:
    input: per_gene/EOG091G07Z5/ALICUT_EOG091G07Z5.clustalo.fasta
    output: per_gene/EOG091G07Z5/empty_check.done
    jobid: 1353
    wildcards: BUSCO=EOG091G07Z5


         if [ "$(cat per_gene/EOG091G07Z5/ALICUT_EOG091G07Z5.clustalo.fasta | grep -v ">" | sed 's/-//g' | grep "^$" | wc -l)" -gt 0 ]
         then
              cp per_gene/EOG091G07Z5/ALICUT_EOG091G07Z5.clustalo.fasta per_gene/EOG091G07Z5/ALICUT_EOG091G07Z5.clustalo.fasta.backup
              bash ../scripts/remove_empty.sh per_gene/EOG091G07Z5/ALICUT_EOG091G07Z5.clustalo.fasta.backup > per_gene/EOG091G07Z5/ALICUT_EOG091G07Z5.clustalo.fasta
         fi
         touch per_gene/EOG091G07Z5/empty_check.done
         
[Sun Jul  5 21:50:27 2020]
Finished job 1353.
430 of 3292 steps (13%) done

[Sun Jul  5 21:50:27 2020]
rule find_best_model:
    input: per_gene/EOG091G07Z5/ALICUT_EOG091G07Z5.clustalo.fasta, per_gene/EOG091G07Z5/empty_check.done
    output: per_gene/EOG091G07Z5/EOG091G07Z5.best_model
    log: per_gene/EOG091G07Z5/find_best_model.stderr.txt
    jobid: 530
    wildcards: BUSCO=EOG091G07Z5
    threads: 2


        cd per_gene/EOG091G07Z5
        if [ ! -d find_best_model ]
        then
            mkdir find_best_model
        fi
        cd find_best_model
        ln -s ../../../per_gene/EOG091G07Z5/ALICUT_EOG091G07Z5.clustalo.fasta EOG091G07Z5.fasta
        ProteinModelSelection.pl EOG091G07Z5.fasta 1> ../../../per_gene/EOG091G07Z5/EOG091G07Z5.best_model 2> ../../../per_gene/EOG091G07Z5/find_best_model.stderr.txt
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/c0c09ee657b1e27f2c5687e0e9aa8d70.simg
[Sun Jul  5 21:50:54 2020]
Finished job 270.
431 of 3292 steps (13%) done

[Sun Jul  5 21:50:54 2020]
rule get_seqs:
    input: /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ingroup.txt, /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/outgroup.txt
    output: per_gene/EOG091G0QRW/EOG091G0QRW.ingroup.fasta
    log: per_gene/EOG091G0QRW/get_seqs.stdout.txt, per_gene/EOG091G0QRW/get_seqs.stderr.txt
    jobid: 2820
    wildcards: BUSCO=EOG091G0QRW
    threads: 2


	basedir=$(pwd)
        cd per_gene/EOG091G0QRW
        
        bash $basedir/../scripts/fetch_seqs.sh EOG091G0QRW /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ingroup.txt /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/outgroup.txt 1> ../../per_gene/EOG091G0QRW/get_seqs.stdout.txt 2> ../../per_gene/EOG091G0QRW/get_seqs.stderr.txt
	mv EOG091G0QRW.fasta $basedir/per_gene/EOG091G0QRW/EOG091G0QRW.ingroup.fasta
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/72476f9d9a5bd0627b4d721143a21354.simg
[Sun Jul  5 21:51:06 2020]
Finished job 2820.
432 of 3292 steps (13%) done

[Sun Jul  5 21:51:06 2020]
rule get_outgroups:
    input: per_gene/EOG091G0QRW/EOG091G0QRW.ingroup.fasta
    output: per_gene/EOG091G0QRW/EOG091G0QRW.orthodb.fasta, per_gene/EOG091G0QRW/EOG091G0QRW.outgroup.fasta
    log: per_gene/EOG091G0QRW/get_outgroups.stdout.txt, per_gene/EOG091G0QRW/get_outgroups.stderr.txt
    jobid: 2821
    wildcards: BUSCO=EOG091G0QRW


        #download fastas from Orhtodb for BUSCO id
        for i in {1..5}
        do
             wget "http://www.orthodb.org/fasta?query=EOG091G0QRW&level=33208" -O per_gene/EOG091G0QRW/EOG091G0QRW.orthodb.fasta 1> per_gene/EOG091G0QRW/get_outgroups.stdout.txt 2> per_gene/EOG091G0QRW/get_outgroups.stderr.txt && break || echo -e "try again ($i)" && sleep 15
        done

	#This is quick an dirty for now and just takes the first protein if there is more than one for an outgroup taxon
        bash ../scripts/download_outgroups.sh taxids.txt per_gene/EOG091G0QRW/EOG091G0QRW.orthodb.fasta > per_gene/EOG091G0QRW/EOG091G0QRW.outgroup.fasta
        
[Sun Jul  5 21:51:06 2020]
Finished job 303.
433 of 3292 steps (13%) done

[Sun Jul  5 21:51:06 2020]
rule get_seqs:
    input: /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ingroup.txt, /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/outgroup.txt
    output: per_gene/EOG091G03QC/EOG091G03QC.ingroup.fasta
    log: per_gene/EOG091G03QC/get_seqs.stdout.txt, per_gene/EOG091G03QC/get_seqs.stderr.txt
    jobid: 2950
    wildcards: BUSCO=EOG091G03QC
    threads: 2


	basedir=$(pwd)
        cd per_gene/EOG091G03QC
        
        bash $basedir/../scripts/fetch_seqs.sh EOG091G03QC /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ingroup.txt /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/outgroup.txt 1> ../../per_gene/EOG091G03QC/get_seqs.stdout.txt 2> ../../per_gene/EOG091G03QC/get_seqs.stderr.txt
	mv EOG091G03QC.fasta $basedir/per_gene/EOG091G03QC/EOG091G03QC.ingroup.fasta
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/72476f9d9a5bd0627b4d721143a21354.simg
[Sun Jul  5 21:51:07 2020]
Finished job 2821.
434 of 3292 steps (13%) done

[Sun Jul  5 21:51:07 2020]
rule join_groups:
    input: per_gene/EOG091G0QRW/EOG091G0QRW.ingroup.fasta, per_gene/EOG091G0QRW/EOG091G0QRW.outgroup.fasta
    output: per_gene/EOG091G0QRW/EOG091G0QRW.fasta
    jobid: 2234
    wildcards: BUSCO=EOG091G0QRW


        cat per_gene/EOG091G0QRW/EOG091G0QRW.ingroup.fasta per_gene/EOG091G0QRW/EOG091G0QRW.outgroup.fasta > per_gene/EOG091G0QRW/EOG091G0QRW.fasta
        
[Sun Jul  5 21:51:07 2020]
Finished job 2234.
435 of 3292 steps (13%) done

[Sun Jul  5 21:51:07 2020]
rule MSA:
    input: per_gene/EOG091G0QRW/EOG091G0QRW.fasta
    output: per_gene/EOG091G0QRW/EOG091G0QRW.clustalo.fasta
    log: per_gene/EOG091G0QRW/MSA.stdout.txt, per_gene/EOG091G0QRW/MSA.stderr.txt
    jobid: 1588
    wildcards: BUSCO=EOG091G0QRW
    threads: 2


        clustalo -i per_gene/EOG091G0QRW/EOG091G0QRW.fasta -o per_gene/EOG091G0QRW/EOG091G0QRW.clustalo.fasta --threads=2 1> per_gene/EOG091G0QRW/MSA.stdout.txt 2> per_gene/EOG091G0QRW/MSA.stderr.txt
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/d68c9691725a7401923680874285c430.simg
[Sun Jul  5 21:51:07 2020]
Finished job 1588.
436 of 3292 steps (13%) done

[Sun Jul  5 21:51:07 2020]
rule score_and_cut:
    input: per_gene/EOG091G0QRW/EOG091G0QRW.clustalo.fasta
    output: per_gene/EOG091G0QRW/ALICUT_EOG091G0QRW.clustalo.fasta
    jobid: 765
    wildcards: BUSCO=EOG091G0QRW
    threads: 2


        cd per_gene/EOG091G0QRW
        Aliscore.pl -N -r 200000000000000000 -i ../../per_gene/EOG091G0QRW/EOG091G0QRW.clustalo.fasta &> aliscore.log
        ALICUT.pl -s &> alicut.log
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/63c88c27a0fa300f57066b0ef65fefcb.simg
[Sun Jul  5 21:51:08 2020]
Finished job 530.
437 of 3292 steps (13%) done

[Sun Jul  5 21:51:08 2020]
rule infer_single_ML:
    input: per_gene/EOG091G07Z5/EOG091G07Z5.best_model, per_gene/EOG091G07Z5/ALICUT_EOG091G07Z5.clustalo.fasta
    output: per_gene/EOG091G07Z5/EOG091G07Z5.raxml.done
    log: per_gene/EOG091G07Z5/infer_single_ML.stdout.txt, per_gene/EOG091G07Z5/infer_single_ML.stderr.txt
    jobid: 59
    wildcards: BUSCO=EOG091G07Z5
    threads: 2


        cd per_gene/EOG091G07Z5
	count=$(cat ../../per_gene/EOG091G07Z5/ALICUT_EOG091G07Z5.clustalo.fasta | grep ">" | wc -l)
	if [ "$count" -gt 5 ]
        then
		RAxMLmodel=$(cat ../../per_gene/EOG091G07Z5/EOG091G07Z5.best_model | grep "Best" | cut -d ":" -f 2 | tr -d '[:space:]')
                if [ "$(ls -1 | grep "^RAxML" | wc -l)" -ne 0 ]
		then
			rm RAxML*
		fi
        	raxml -f a -T 2 -m PROTGAMMA$RAxMLmodel         	-p 12345 -x 12345 -# 100         	-s ../../per_gene/EOG091G07Z5/ALICUT_EOG091G07Z5.clustalo.fasta -n EOG091G07Z5.clustalo.aln.ALICUT.$RAxMLmodel 		1> ../../per_gene/EOG091G07Z5/infer_single_ML.stdout.txt 2> ../../per_gene/EOG091G07Z5/infer_single_ML.stderr.txt
	else
		echo "fasta file per_gene/EOG091G07Z5/ALICUT_EOG091G07Z5.clustalo.fasta contains fewer than 5 sequences - skipped" > ../../per_gene/EOG091G07Z5/infer_single_ML.stdout.txt
		touch raxml.skipped
	fi
        touch ../../per_gene/EOG091G07Z5/EOG091G07Z5.raxml.done
        
[33mJob counts:
	count	jobs
	1	infer_single_ML
	1[0m
[33m
        cd per_gene/EOG091G07Z5
	count=$(cat ../../per_gene/EOG091G07Z5/ALICUT_EOG091G07Z5.clustalo.fasta | grep ">" | wc -l)
	if [ "$count" -gt 5 ]
        then
		RAxMLmodel=$(cat ../../per_gene/EOG091G07Z5/EOG091G07Z5.best_model | grep "Best" | cut -d ":" -f 2 | tr -d '[:space:]')
                if [ "$(ls -1 | grep "^RAxML" | wc -l)" -ne 0 ]
		then
			rm RAxML*
		fi
        	raxml -f a -T 2 -m PROTGAMMA$RAxMLmodel         	-p 12345 -x 12345 -# 100         	-s ../../per_gene/EOG091G07Z5/ALICUT_EOG091G07Z5.clustalo.fasta -n EOG091G07Z5.clustalo.aln.ALICUT.$RAxMLmodel 		1> ../../per_gene/EOG091G07Z5/infer_single_ML.stdout.txt 2> ../../per_gene/EOG091G07Z5/infer_single_ML.stderr.txt
	else
		echo "fasta file per_gene/EOG091G07Z5/ALICUT_EOG091G07Z5.clustalo.fasta contains fewer than 5 sequences - skipped" > ../../per_gene/EOG091G07Z5/infer_single_ML.stdout.txt
		touch raxml.skipped
	fi
        touch ../../per_gene/EOG091G07Z5/EOG091G07Z5.raxml.done
        [0m
[Sun Jul  5 21:51:11 2020]
Finished job 476.
438 of 3292 steps (13%) done

[Sun Jul  5 21:51:11 2020]
rule infer_single_ML:
    input: per_gene/EOG091G05AA/EOG091G05AA.best_model, per_gene/EOG091G05AA/ALICUT_EOG091G05AA.clustalo.fasta
    output: per_gene/EOG091G05AA/EOG091G05AA.raxml.done
    log: per_gene/EOG091G05AA/infer_single_ML.stdout.txt, per_gene/EOG091G05AA/infer_single_ML.stderr.txt
    jobid: 32
    wildcards: BUSCO=EOG091G05AA
    threads: 2


        cd per_gene/EOG091G05AA
	count=$(cat ../../per_gene/EOG091G05AA/ALICUT_EOG091G05AA.clustalo.fasta | grep ">" | wc -l)
	if [ "$count" -gt 5 ]
        then
		RAxMLmodel=$(cat ../../per_gene/EOG091G05AA/EOG091G05AA.best_model | grep "Best" | cut -d ":" -f 2 | tr -d '[:space:]')
                if [ "$(ls -1 | grep "^RAxML" | wc -l)" -ne 0 ]
		then
			rm RAxML*
		fi
        	raxml -f a -T 2 -m PROTGAMMA$RAxMLmodel         	-p 12345 -x 12345 -# 100         	-s ../../per_gene/EOG091G05AA/ALICUT_EOG091G05AA.clustalo.fasta -n EOG091G05AA.clustalo.aln.ALICUT.$RAxMLmodel 		1> ../../per_gene/EOG091G05AA/infer_single_ML.stdout.txt 2> ../../per_gene/EOG091G05AA/infer_single_ML.stderr.txt
	else
		echo "fasta file per_gene/EOG091G05AA/ALICUT_EOG091G05AA.clustalo.fasta contains fewer than 5 sequences - skipped" > ../../per_gene/EOG091G05AA/infer_single_ML.stdout.txt
		touch raxml.skipped
	fi
        touch ../../per_gene/EOG091G05AA/EOG091G05AA.raxml.done
        
[33mJob counts:
	count	jobs
	1	infer_single_ML
	1[0m
[33m
        cd per_gene/EOG091G05AA
	count=$(cat ../../per_gene/EOG091G05AA/ALICUT_EOG091G05AA.clustalo.fasta | grep ">" | wc -l)
	if [ "$count" -gt 5 ]
        then
		RAxMLmodel=$(cat ../../per_gene/EOG091G05AA/EOG091G05AA.best_model | grep "Best" | cut -d ":" -f 2 | tr -d '[:space:]')
                if [ "$(ls -1 | grep "^RAxML" | wc -l)" -ne 0 ]
		then
			rm RAxML*
		fi
        	raxml -f a -T 2 -m PROTGAMMA$RAxMLmodel         	-p 12345 -x 12345 -# 100         	-s ../../per_gene/EOG091G05AA/ALICUT_EOG091G05AA.clustalo.fasta -n EOG091G05AA.clustalo.aln.ALICUT.$RAxMLmodel 		1> ../../per_gene/EOG091G05AA/infer_single_ML.stdout.txt 2> ../../per_gene/EOG091G05AA/infer_single_ML.stderr.txt
	else
		echo "fasta file per_gene/EOG091G05AA/ALICUT_EOG091G05AA.clustalo.fasta contains fewer than 5 sequences - skipped" > ../../per_gene/EOG091G05AA/infer_single_ML.stdout.txt
		touch raxml.skipped
	fi
        touch ../../per_gene/EOG091G05AA/EOG091G05AA.raxml.done
        [0m
[Sun Jul  5 21:51:17 2020]
Finished job 765.
439 of 3292 steps (13%) done

[Sun Jul  5 21:51:17 2020]
rule remove_empty:
    input: per_gene/EOG091G0QRW/ALICUT_EOG091G0QRW.clustalo.fasta
    output: per_gene/EOG091G0QRW/empty_check.done
    jobid: 1587
    wildcards: BUSCO=EOG091G0QRW


         if [ "$(cat per_gene/EOG091G0QRW/ALICUT_EOG091G0QRW.clustalo.fasta | grep -v ">" | sed 's/-//g' | grep "^$" | wc -l)" -gt 0 ]
         then
              cp per_gene/EOG091G0QRW/ALICUT_EOG091G0QRW.clustalo.fasta per_gene/EOG091G0QRW/ALICUT_EOG091G0QRW.clustalo.fasta.backup
              bash ../scripts/remove_empty.sh per_gene/EOG091G0QRW/ALICUT_EOG091G0QRW.clustalo.fasta.backup > per_gene/EOG091G0QRW/ALICUT_EOG091G0QRW.clustalo.fasta
         fi
         touch per_gene/EOG091G0QRW/empty_check.done
         
[Sun Jul  5 21:51:17 2020]
Finished job 1587.
440 of 3292 steps (13%) done

[Sun Jul  5 21:51:17 2020]
rule find_best_model:
    input: per_gene/EOG091G0QRW/ALICUT_EOG091G0QRW.clustalo.fasta, per_gene/EOG091G0QRW/empty_check.done
    output: per_gene/EOG091G0QRW/EOG091G0QRW.best_model
    log: per_gene/EOG091G0QRW/find_best_model.stderr.txt
    jobid: 764
    wildcards: BUSCO=EOG091G0QRW
    threads: 2


        cd per_gene/EOG091G0QRW
        if [ ! -d find_best_model ]
        then
            mkdir find_best_model
        fi
        cd find_best_model
        ln -s ../../../per_gene/EOG091G0QRW/ALICUT_EOG091G0QRW.clustalo.fasta EOG091G0QRW.fasta
        ProteinModelSelection.pl EOG091G0QRW.fasta 1> ../../../per_gene/EOG091G0QRW/EOG091G0QRW.best_model 2> ../../../per_gene/EOG091G0QRW/find_best_model.stderr.txt
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/c0c09ee657b1e27f2c5687e0e9aa8d70.simg
[Sun Jul  5 21:51:19 2020]
Finished job 2950.
441 of 3292 steps (13%) done

[Sun Jul  5 21:51:19 2020]
rule get_outgroups:
    input: per_gene/EOG091G03QC/EOG091G03QC.ingroup.fasta
    output: per_gene/EOG091G03QC/EOG091G03QC.orthodb.fasta, per_gene/EOG091G03QC/EOG091G03QC.outgroup.fasta
    log: per_gene/EOG091G03QC/get_outgroups.stdout.txt, per_gene/EOG091G03QC/get_outgroups.stderr.txt
    jobid: 2951
    wildcards: BUSCO=EOG091G03QC


        #download fastas from Orhtodb for BUSCO id
        for i in {1..5}
        do
             wget "http://www.orthodb.org/fasta?query=EOG091G03QC&level=33208" -O per_gene/EOG091G03QC/EOG091G03QC.orthodb.fasta 1> per_gene/EOG091G03QC/get_outgroups.stdout.txt 2> per_gene/EOG091G03QC/get_outgroups.stderr.txt && break || echo -e "try again ($i)" && sleep 15
        done

	#This is quick an dirty for now and just takes the first protein if there is more than one for an outgroup taxon
        bash ../scripts/download_outgroups.sh taxids.txt per_gene/EOG091G03QC/EOG091G03QC.orthodb.fasta > per_gene/EOG091G03QC/EOG091G03QC.outgroup.fasta
        
[Sun Jul  5 21:51:20 2020]
Finished job 2951.
442 of 3292 steps (13%) done

[Sun Jul  5 21:51:20 2020]
rule join_groups:
    input: per_gene/EOG091G03QC/EOG091G03QC.ingroup.fasta, per_gene/EOG091G03QC/EOG091G03QC.outgroup.fasta
    output: per_gene/EOG091G03QC/EOG091G03QC.fasta
    jobid: 2299
    wildcards: BUSCO=EOG091G03QC


        cat per_gene/EOG091G03QC/EOG091G03QC.ingroup.fasta per_gene/EOG091G03QC/EOG091G03QC.outgroup.fasta > per_gene/EOG091G03QC/EOG091G03QC.fasta
        
[Sun Jul  5 21:51:20 2020]
Finished job 2299.
443 of 3292 steps (13%) done

[Sun Jul  5 21:51:20 2020]
rule MSA:
    input: per_gene/EOG091G03QC/EOG091G03QC.fasta
    output: per_gene/EOG091G03QC/EOG091G03QC.clustalo.fasta
    log: per_gene/EOG091G03QC/MSA.stdout.txt, per_gene/EOG091G03QC/MSA.stderr.txt
    jobid: 1718
    wildcards: BUSCO=EOG091G03QC
    threads: 2


        clustalo -i per_gene/EOG091G03QC/EOG091G03QC.fasta -o per_gene/EOG091G03QC/EOG091G03QC.clustalo.fasta --threads=2 1> per_gene/EOG091G03QC/MSA.stdout.txt 2> per_gene/EOG091G03QC/MSA.stderr.txt
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/d68c9691725a7401923680874285c430.simg
[Sun Jul  5 21:51:23 2020]
Finished job 1718.
444 of 3292 steps (13%) done

[Sun Jul  5 21:51:23 2020]
rule score_and_cut:
    input: per_gene/EOG091G03QC/EOG091G03QC.clustalo.fasta
    output: per_gene/EOG091G03QC/ALICUT_EOG091G03QC.clustalo.fasta
    jobid: 895
    wildcards: BUSCO=EOG091G03QC
    threads: 2


        cd per_gene/EOG091G03QC
        Aliscore.pl -N -r 200000000000000000 -i ../../per_gene/EOG091G03QC/EOG091G03QC.clustalo.fasta &> aliscore.log
        ALICUT.pl -s &> alicut.log
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/63c88c27a0fa300f57066b0ef65fefcb.simg
[Sun Jul  5 21:51:34 2020]
Finished job 895.
445 of 3292 steps (14%) done

[Sun Jul  5 21:51:34 2020]
rule remove_empty:
    input: per_gene/EOG091G03QC/ALICUT_EOG091G03QC.clustalo.fasta
    output: per_gene/EOG091G03QC/empty_check.done
    jobid: 1717
    wildcards: BUSCO=EOG091G03QC


         if [ "$(cat per_gene/EOG091G03QC/ALICUT_EOG091G03QC.clustalo.fasta | grep -v ">" | sed 's/-//g' | grep "^$" | wc -l)" -gt 0 ]
         then
              cp per_gene/EOG091G03QC/ALICUT_EOG091G03QC.clustalo.fasta per_gene/EOG091G03QC/ALICUT_EOG091G03QC.clustalo.fasta.backup
              bash ../scripts/remove_empty.sh per_gene/EOG091G03QC/ALICUT_EOG091G03QC.clustalo.fasta.backup > per_gene/EOG091G03QC/ALICUT_EOG091G03QC.clustalo.fasta
         fi
         touch per_gene/EOG091G03QC/empty_check.done
         
[Sun Jul  5 21:51:34 2020]
Finished job 1717.
446 of 3292 steps (14%) done

[Sun Jul  5 21:51:34 2020]
rule find_best_model:
    input: per_gene/EOG091G03QC/ALICUT_EOG091G03QC.clustalo.fasta, per_gene/EOG091G03QC/empty_check.done
    output: per_gene/EOG091G03QC/EOG091G03QC.best_model
    log: per_gene/EOG091G03QC/find_best_model.stderr.txt
    jobid: 894
    wildcards: BUSCO=EOG091G03QC
    threads: 2


        cd per_gene/EOG091G03QC
        if [ ! -d find_best_model ]
        then
            mkdir find_best_model
        fi
        cd find_best_model
        ln -s ../../../per_gene/EOG091G03QC/ALICUT_EOG091G03QC.clustalo.fasta EOG091G03QC.fasta
        ProteinModelSelection.pl EOG091G03QC.fasta 1> ../../../per_gene/EOG091G03QC/EOG091G03QC.best_model 2> ../../../per_gene/EOG091G03QC/find_best_model.stderr.txt
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/c0c09ee657b1e27f2c5687e0e9aa8d70.simg
[Sun Jul  5 21:51:44 2020]
Finished job 764.
447 of 3292 steps (14%) done

[Sun Jul  5 21:51:44 2020]
rule infer_single_ML:
    input: per_gene/EOG091G0QRW/EOG091G0QRW.best_model, per_gene/EOG091G0QRW/ALICUT_EOG091G0QRW.clustalo.fasta
    output: per_gene/EOG091G0QRW/EOG091G0QRW.raxml.done
    log: per_gene/EOG091G0QRW/infer_single_ML.stdout.txt, per_gene/EOG091G0QRW/infer_single_ML.stderr.txt
    jobid: 176
    wildcards: BUSCO=EOG091G0QRW
    threads: 2


        cd per_gene/EOG091G0QRW
	count=$(cat ../../per_gene/EOG091G0QRW/ALICUT_EOG091G0QRW.clustalo.fasta | grep ">" | wc -l)
	if [ "$count" -gt 5 ]
        then
		RAxMLmodel=$(cat ../../per_gene/EOG091G0QRW/EOG091G0QRW.best_model | grep "Best" | cut -d ":" -f 2 | tr -d '[:space:]')
                if [ "$(ls -1 | grep "^RAxML" | wc -l)" -ne 0 ]
		then
			rm RAxML*
		fi
        	raxml -f a -T 2 -m PROTGAMMA$RAxMLmodel         	-p 12345 -x 12345 -# 100         	-s ../../per_gene/EOG091G0QRW/ALICUT_EOG091G0QRW.clustalo.fasta -n EOG091G0QRW.clustalo.aln.ALICUT.$RAxMLmodel 		1> ../../per_gene/EOG091G0QRW/infer_single_ML.stdout.txt 2> ../../per_gene/EOG091G0QRW/infer_single_ML.stderr.txt
	else
		echo "fasta file per_gene/EOG091G0QRW/ALICUT_EOG091G0QRW.clustalo.fasta contains fewer than 5 sequences - skipped" > ../../per_gene/EOG091G0QRW/infer_single_ML.stdout.txt
		touch raxml.skipped
	fi
        touch ../../per_gene/EOG091G0QRW/EOG091G0QRW.raxml.done
        
[33mJob counts:
	count	jobs
	1	infer_single_ML
	1[0m
[33m
        cd per_gene/EOG091G0QRW
	count=$(cat ../../per_gene/EOG091G0QRW/ALICUT_EOG091G0QRW.clustalo.fasta | grep ">" | wc -l)
	if [ "$count" -gt 5 ]
        then
		RAxMLmodel=$(cat ../../per_gene/EOG091G0QRW/EOG091G0QRW.best_model | grep "Best" | cut -d ":" -f 2 | tr -d '[:space:]')
                if [ "$(ls -1 | grep "^RAxML" | wc -l)" -ne 0 ]
		then
			rm RAxML*
		fi
        	raxml -f a -T 2 -m PROTGAMMA$RAxMLmodel         	-p 12345 -x 12345 -# 100         	-s ../../per_gene/EOG091G0QRW/ALICUT_EOG091G0QRW.clustalo.fasta -n EOG091G0QRW.clustalo.aln.ALICUT.$RAxMLmodel 		1> ../../per_gene/EOG091G0QRW/infer_single_ML.stdout.txt 2> ../../per_gene/EOG091G0QRW/infer_single_ML.stderr.txt
	else
		echo "fasta file per_gene/EOG091G0QRW/ALICUT_EOG091G0QRW.clustalo.fasta contains fewer than 5 sequences - skipped" > ../../per_gene/EOG091G0QRW/infer_single_ML.stdout.txt
		touch raxml.skipped
	fi
        touch ../../per_gene/EOG091G0QRW/EOG091G0QRW.raxml.done
        [0m
[Sun Jul  5 21:52:04 2020]
Finished job 112.
448 of 3292 steps (14%) done

[Sun Jul  5 21:52:04 2020]
rule get_seqs:
    input: /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ingroup.txt, /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/outgroup.txt
    output: per_gene/EOG091G0BG4/EOG091G0BG4.ingroup.fasta
    log: per_gene/EOG091G0BG4/get_seqs.stdout.txt, per_gene/EOG091G0BG4/get_seqs.stderr.txt
    jobid: 3268
    wildcards: BUSCO=EOG091G0BG4
    threads: 2


	basedir=$(pwd)
        cd per_gene/EOG091G0BG4
        
        bash $basedir/../scripts/fetch_seqs.sh EOG091G0BG4 /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ingroup.txt /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/outgroup.txt 1> ../../per_gene/EOG091G0BG4/get_seqs.stdout.txt 2> ../../per_gene/EOG091G0BG4/get_seqs.stderr.txt
	mv EOG091G0BG4.fasta $basedir/per_gene/EOG091G0BG4/EOG091G0BG4.ingroup.fasta
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/72476f9d9a5bd0627b4d721143a21354.simg
[Sun Jul  5 21:52:14 2020]
Finished job 894.
449 of 3292 steps (14%) done

[Sun Jul  5 21:52:14 2020]
rule infer_single_ML:
    input: per_gene/EOG091G03QC/EOG091G03QC.best_model, per_gene/EOG091G03QC/ALICUT_EOG091G03QC.clustalo.fasta
    output: per_gene/EOG091G03QC/EOG091G03QC.raxml.done
    log: per_gene/EOG091G03QC/infer_single_ML.stdout.txt, per_gene/EOG091G03QC/infer_single_ML.stderr.txt
    jobid: 241
    wildcards: BUSCO=EOG091G03QC
    threads: 2


        cd per_gene/EOG091G03QC
	count=$(cat ../../per_gene/EOG091G03QC/ALICUT_EOG091G03QC.clustalo.fasta | grep ">" | wc -l)
	if [ "$count" -gt 5 ]
        then
		RAxMLmodel=$(cat ../../per_gene/EOG091G03QC/EOG091G03QC.best_model | grep "Best" | cut -d ":" -f 2 | tr -d '[:space:]')
                if [ "$(ls -1 | grep "^RAxML" | wc -l)" -ne 0 ]
		then
			rm RAxML*
		fi
        	raxml -f a -T 2 -m PROTGAMMA$RAxMLmodel         	-p 12345 -x 12345 -# 100         	-s ../../per_gene/EOG091G03QC/ALICUT_EOG091G03QC.clustalo.fasta -n EOG091G03QC.clustalo.aln.ALICUT.$RAxMLmodel 		1> ../../per_gene/EOG091G03QC/infer_single_ML.stdout.txt 2> ../../per_gene/EOG091G03QC/infer_single_ML.stderr.txt
	else
		echo "fasta file per_gene/EOG091G03QC/ALICUT_EOG091G03QC.clustalo.fasta contains fewer than 5 sequences - skipped" > ../../per_gene/EOG091G03QC/infer_single_ML.stdout.txt
		touch raxml.skipped
	fi
        touch ../../per_gene/EOG091G03QC/EOG091G03QC.raxml.done
        
[33mJob counts:
	count	jobs
	1	infer_single_ML
	1[0m
[33m
        cd per_gene/EOG091G03QC
	count=$(cat ../../per_gene/EOG091G03QC/ALICUT_EOG091G03QC.clustalo.fasta | grep ">" | wc -l)
	if [ "$count" -gt 5 ]
        then
		RAxMLmodel=$(cat ../../per_gene/EOG091G03QC/EOG091G03QC.best_model | grep "Best" | cut -d ":" -f 2 | tr -d '[:space:]')
                if [ "$(ls -1 | grep "^RAxML" | wc -l)" -ne 0 ]
		then
			rm RAxML*
		fi
        	raxml -f a -T 2 -m PROTGAMMA$RAxMLmodel         	-p 12345 -x 12345 -# 100         	-s ../../per_gene/EOG091G03QC/ALICUT_EOG091G03QC.clustalo.fasta -n EOG091G03QC.clustalo.aln.ALICUT.$RAxMLmodel 		1> ../../per_gene/EOG091G03QC/infer_single_ML.stdout.txt 2> ../../per_gene/EOG091G03QC/infer_single_ML.stderr.txt
	else
		echo "fasta file per_gene/EOG091G03QC/ALICUT_EOG091G03QC.clustalo.fasta contains fewer than 5 sequences - skipped" > ../../per_gene/EOG091G03QC/infer_single_ML.stdout.txt
		touch raxml.skipped
	fi
        touch ../../per_gene/EOG091G03QC/EOG091G03QC.raxml.done
        [0m
[Sun Jul  5 21:52:18 2020]
Finished job 3268.
450 of 3292 steps (14%) done

[Sun Jul  5 21:52:18 2020]
[Sun Jul  5 21:52:18 2020]
Finished job 368.
rule get_outgroups:
    input: per_gene/EOG091G0BG4/EOG091G0BG4.ingroup.fasta
    output: per_gene/EOG091G0BG4/EOG091G0BG4.orthodb.fasta, per_gene/EOG091G0BG4/EOG091G0BG4.outgroup.fasta
    log: per_gene/EOG091G0BG4/get_outgroups.stdout.txt, per_gene/EOG091G0BG4/get_outgroups.stderr.txt
    jobid: 3269
    wildcards: BUSCO=EOG091G0BG4
451 of 3292 steps (14%) done


        #download fastas from Orhtodb for BUSCO id
        for i in {1..5}
        do
             wget "http://www.orthodb.org/fasta?query=EOG091G0BG4&level=33208" -O per_gene/EOG091G0BG4/EOG091G0BG4.orthodb.fasta 1> per_gene/EOG091G0BG4/get_outgroups.stdout.txt 2> per_gene/EOG091G0BG4/get_outgroups.stderr.txt && break || echo -e "try again ($i)" && sleep 15
        done

	#This is quick an dirty for now and just takes the first protein if there is more than one for an outgroup taxon
        bash ../scripts/download_outgroups.sh taxids.txt per_gene/EOG091G0BG4/EOG091G0BG4.orthodb.fasta > per_gene/EOG091G0BG4/EOG091G0BG4.outgroup.fasta
        

[Sun Jul  5 21:52:18 2020]
rule get_seqs:
    input: /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ingroup.txt, /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/outgroup.txt
    output: per_gene/EOG091G0X3B/EOG091G0X3B.ingroup.fasta
    log: per_gene/EOG091G0X3B/get_seqs.stdout.txt, per_gene/EOG091G0X3B/get_seqs.stderr.txt
    jobid: 3034
    wildcards: BUSCO=EOG091G0X3B
    threads: 2


	basedir=$(pwd)
        cd per_gene/EOG091G0X3B
        
        bash $basedir/../scripts/fetch_seqs.sh EOG091G0X3B /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ingroup.txt /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/outgroup.txt 1> ../../per_gene/EOG091G0X3B/get_seqs.stdout.txt 2> ../../per_gene/EOG091G0X3B/get_seqs.stderr.txt
	mv EOG091G0X3B.fasta $basedir/per_gene/EOG091G0X3B/EOG091G0X3B.ingroup.fasta
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/72476f9d9a5bd0627b4d721143a21354.simg
[Sun Jul  5 21:52:19 2020]
Finished job 3269.
452 of 3292 steps (14%) done

[Sun Jul  5 21:52:19 2020]
rule join_groups:
    input: per_gene/EOG091G0BG4/EOG091G0BG4.ingroup.fasta, per_gene/EOG091G0BG4/EOG091G0BG4.outgroup.fasta
    output: per_gene/EOG091G0BG4/EOG091G0BG4.fasta
    jobid: 2458
    wildcards: BUSCO=EOG091G0BG4


        cat per_gene/EOG091G0BG4/EOG091G0BG4.ingroup.fasta per_gene/EOG091G0BG4/EOG091G0BG4.outgroup.fasta > per_gene/EOG091G0BG4/EOG091G0BG4.fasta
        
[Sun Jul  5 21:52:19 2020]
Finished job 2458.
453 of 3292 steps (14%) done

[Sun Jul  5 21:52:19 2020]
rule MSA:
    input: per_gene/EOG091G0BG4/EOG091G0BG4.fasta
    output: per_gene/EOG091G0BG4/EOG091G0BG4.clustalo.fasta
    log: per_gene/EOG091G0BG4/MSA.stdout.txt, per_gene/EOG091G0BG4/MSA.stderr.txt
    jobid: 2036
    wildcards: BUSCO=EOG091G0BG4
    threads: 2


        clustalo -i per_gene/EOG091G0BG4/EOG091G0BG4.fasta -o per_gene/EOG091G0BG4/EOG091G0BG4.clustalo.fasta --threads=2 1> per_gene/EOG091G0BG4/MSA.stdout.txt 2> per_gene/EOG091G0BG4/MSA.stderr.txt
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/d68c9691725a7401923680874285c430.simg
[Sun Jul  5 21:52:20 2020]
Finished job 2036.
454 of 3292 steps (14%) done

[Sun Jul  5 21:52:20 2020]
rule score_and_cut:
    input: per_gene/EOG091G0BG4/EOG091G0BG4.clustalo.fasta
    output: per_gene/EOG091G0BG4/ALICUT_EOG091G0BG4.clustalo.fasta
    jobid: 1213
    wildcards: BUSCO=EOG091G0BG4
    threads: 2


        cd per_gene/EOG091G0BG4
        Aliscore.pl -N -r 200000000000000000 -i ../../per_gene/EOG091G0BG4/EOG091G0BG4.clustalo.fasta &> aliscore.log
        ALICUT.pl -s &> alicut.log
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/63c88c27a0fa300f57066b0ef65fefcb.simg
[Sun Jul  5 21:52:28 2020]
Finished job 3034.
455 of 3292 steps (14%) done

[Sun Jul  5 21:52:28 2020]
rule get_outgroups:
    input: per_gene/EOG091G0X3B/EOG091G0X3B.ingroup.fasta
    output: per_gene/EOG091G0X3B/EOG091G0X3B.orthodb.fasta, per_gene/EOG091G0X3B/EOG091G0X3B.outgroup.fasta
    log: per_gene/EOG091G0X3B/get_outgroups.stdout.txt, per_gene/EOG091G0X3B/get_outgroups.stderr.txt
    jobid: 3035
    wildcards: BUSCO=EOG091G0X3B


        #download fastas from Orhtodb for BUSCO id
        for i in {1..5}
        do
             wget "http://www.orthodb.org/fasta?query=EOG091G0X3B&level=33208" -O per_gene/EOG091G0X3B/EOG091G0X3B.orthodb.fasta 1> per_gene/EOG091G0X3B/get_outgroups.stdout.txt 2> per_gene/EOG091G0X3B/get_outgroups.stderr.txt && break || echo -e "try again ($i)" && sleep 15
        done

	#This is quick an dirty for now and just takes the first protein if there is more than one for an outgroup taxon
        bash ../scripts/download_outgroups.sh taxids.txt per_gene/EOG091G0X3B/EOG091G0X3B.orthodb.fasta > per_gene/EOG091G0X3B/EOG091G0X3B.outgroup.fasta
        
[Sun Jul  5 21:52:29 2020]
Finished job 3035.
456 of 3292 steps (14%) done

[Sun Jul  5 21:52:29 2020]
rule join_groups:
    input: per_gene/EOG091G0X3B/EOG091G0X3B.ingroup.fasta, per_gene/EOG091G0X3B/EOG091G0X3B.outgroup.fasta
    output: per_gene/EOG091G0X3B/EOG091G0X3B.fasta
    jobid: 2341
    wildcards: BUSCO=EOG091G0X3B


        cat per_gene/EOG091G0X3B/EOG091G0X3B.ingroup.fasta per_gene/EOG091G0X3B/EOG091G0X3B.outgroup.fasta > per_gene/EOG091G0X3B/EOG091G0X3B.fasta
        
[Sun Jul  5 21:52:29 2020]
Finished job 2341.
457 of 3292 steps (14%) done

[Sun Jul  5 21:52:29 2020]
rule MSA:
    input: per_gene/EOG091G0X3B/EOG091G0X3B.fasta
    output: per_gene/EOG091G0X3B/EOG091G0X3B.clustalo.fasta
    log: per_gene/EOG091G0X3B/MSA.stdout.txt, per_gene/EOG091G0X3B/MSA.stderr.txt
    jobid: 1802
    wildcards: BUSCO=EOG091G0X3B
    threads: 2


        clustalo -i per_gene/EOG091G0X3B/EOG091G0X3B.fasta -o per_gene/EOG091G0X3B/EOG091G0X3B.clustalo.fasta --threads=2 1> per_gene/EOG091G0X3B/MSA.stdout.txt 2> per_gene/EOG091G0X3B/MSA.stderr.txt
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/d68c9691725a7401923680874285c430.simg
[Sun Jul  5 21:52:29 2020]
Finished job 18.
458 of 3292 steps (14%) done

[Sun Jul  5 21:52:29 2020]
rule get_seqs:
    input: /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ingroup.txt, /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/outgroup.txt
    output: per_gene/EOG091G00UD/EOG091G00UD.ingroup.fasta
    log: per_gene/EOG091G00UD/get_seqs.stdout.txt, per_gene/EOG091G00UD/get_seqs.stderr.txt
    jobid: 2472
    wildcards: BUSCO=EOG091G00UD
    threads: 2


	basedir=$(pwd)
        cd per_gene/EOG091G00UD
        
        bash $basedir/../scripts/fetch_seqs.sh EOG091G00UD /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ingroup.txt /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/outgroup.txt 1> ../../per_gene/EOG091G00UD/get_seqs.stdout.txt 2> ../../per_gene/EOG091G00UD/get_seqs.stderr.txt
	mv EOG091G00UD.fasta $basedir/per_gene/EOG091G00UD/EOG091G00UD.ingroup.fasta
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/72476f9d9a5bd0627b4d721143a21354.simg
[Sun Jul  5 21:52:29 2020]
Finished job 1802.
459 of 3292 steps (14%) done

[Sun Jul  5 21:52:29 2020]
rule score_and_cut:
    input: per_gene/EOG091G0X3B/EOG091G0X3B.clustalo.fasta
    output: per_gene/EOG091G0X3B/ALICUT_EOG091G0X3B.clustalo.fasta
    jobid: 979
    wildcards: BUSCO=EOG091G0X3B
    threads: 2


        cd per_gene/EOG091G0X3B
        Aliscore.pl -N -r 200000000000000000 -i ../../per_gene/EOG091G0X3B/EOG091G0X3B.clustalo.fasta &> aliscore.log
        ALICUT.pl -s &> alicut.log
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/63c88c27a0fa300f57066b0ef65fefcb.simg
[Sun Jul  5 21:52:30 2020]
Finished job 1213.
460 of 3292 steps (14%) done

[Sun Jul  5 21:52:30 2020]
rule remove_empty:
    input: per_gene/EOG091G0BG4/ALICUT_EOG091G0BG4.clustalo.fasta
    output: per_gene/EOG091G0BG4/empty_check.done
    jobid: 2035
    wildcards: BUSCO=EOG091G0BG4


         if [ "$(cat per_gene/EOG091G0BG4/ALICUT_EOG091G0BG4.clustalo.fasta | grep -v ">" | sed 's/-//g' | grep "^$" | wc -l)" -gt 0 ]
         then
              cp per_gene/EOG091G0BG4/ALICUT_EOG091G0BG4.clustalo.fasta per_gene/EOG091G0BG4/ALICUT_EOG091G0BG4.clustalo.fasta.backup
              bash ../scripts/remove_empty.sh per_gene/EOG091G0BG4/ALICUT_EOG091G0BG4.clustalo.fasta.backup > per_gene/EOG091G0BG4/ALICUT_EOG091G0BG4.clustalo.fasta
         fi
         touch per_gene/EOG091G0BG4/empty_check.done
         
[Sun Jul  5 21:52:30 2020]
Finished job 2035.
461 of 3292 steps (14%) done

[Sun Jul  5 21:52:30 2020]
rule find_best_model:
    input: per_gene/EOG091G0BG4/ALICUT_EOG091G0BG4.clustalo.fasta, per_gene/EOG091G0BG4/empty_check.done
    output: per_gene/EOG091G0BG4/EOG091G0BG4.best_model
    log: per_gene/EOG091G0BG4/find_best_model.stderr.txt
    jobid: 1212
    wildcards: BUSCO=EOG091G0BG4
    threads: 2


        cd per_gene/EOG091G0BG4
        if [ ! -d find_best_model ]
        then
            mkdir find_best_model
        fi
        cd find_best_model
        ln -s ../../../per_gene/EOG091G0BG4/ALICUT_EOG091G0BG4.clustalo.fasta EOG091G0BG4.fasta
        ProteinModelSelection.pl EOG091G0BG4.fasta 1> ../../../per_gene/EOG091G0BG4/EOG091G0BG4.best_model 2> ../../../per_gene/EOG091G0BG4/find_best_model.stderr.txt
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/c0c09ee657b1e27f2c5687e0e9aa8d70.simg
[Sun Jul  5 21:52:38 2020]
Finished job 2472.
462 of 3292 steps (14%) done

[Sun Jul  5 21:52:38 2020]
rule get_outgroups:
    input: per_gene/EOG091G00UD/EOG091G00UD.ingroup.fasta
    output: per_gene/EOG091G00UD/EOG091G00UD.orthodb.fasta, per_gene/EOG091G00UD/EOG091G00UD.outgroup.fasta
    log: per_gene/EOG091G00UD/get_outgroups.stdout.txt, per_gene/EOG091G00UD/get_outgroups.stderr.txt
    jobid: 2473
    wildcards: BUSCO=EOG091G00UD


        #download fastas from Orhtodb for BUSCO id
        for i in {1..5}
        do
             wget "http://www.orthodb.org/fasta?query=EOG091G00UD&level=33208" -O per_gene/EOG091G00UD/EOG091G00UD.orthodb.fasta 1> per_gene/EOG091G00UD/get_outgroups.stdout.txt 2> per_gene/EOG091G00UD/get_outgroups.stderr.txt && break || echo -e "try again ($i)" && sleep 15
        done

	#This is quick an dirty for now and just takes the first protein if there is more than one for an outgroup taxon
        bash ../scripts/download_outgroups.sh taxids.txt per_gene/EOG091G00UD/EOG091G00UD.orthodb.fasta > per_gene/EOG091G00UD/EOG091G00UD.outgroup.fasta
        
[Sun Jul  5 21:52:38 2020]
Finished job 2473.
463 of 3292 steps (14%) done

[Sun Jul  5 21:52:38 2020]
rule join_groups:
    input: per_gene/EOG091G00UD/EOG091G00UD.ingroup.fasta, per_gene/EOG091G00UD/EOG091G00UD.outgroup.fasta
    output: per_gene/EOG091G00UD/EOG091G00UD.fasta
    jobid: 2060
    wildcards: BUSCO=EOG091G00UD


        cat per_gene/EOG091G00UD/EOG091G00UD.ingroup.fasta per_gene/EOG091G00UD/EOG091G00UD.outgroup.fasta > per_gene/EOG091G00UD/EOG091G00UD.fasta
        
[Sun Jul  5 21:52:38 2020]
Finished job 2060.
464 of 3292 steps (14%) done
[Sun Jul  5 21:52:38 2020]
Finished job 979.
465 of 3292 steps (14%) done

[Sun Jul  5 21:52:39 2020]
rule MSA:
    input: per_gene/EOG091G00UD/EOG091G00UD.fasta
    output: per_gene/EOG091G00UD/EOG091G00UD.clustalo.fasta
    log: per_gene/EOG091G00UD/MSA.stdout.txt, per_gene/EOG091G00UD/MSA.stderr.txt
    jobid: 1240
    wildcards: BUSCO=EOG091G00UD
    threads: 2


        clustalo -i per_gene/EOG091G00UD/EOG091G00UD.fasta -o per_gene/EOG091G00UD/EOG091G00UD.clustalo.fasta --threads=2 1> per_gene/EOG091G00UD/MSA.stdout.txt 2> per_gene/EOG091G00UD/MSA.stderr.txt
        

Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/d68c9691725a7401923680874285c430.simg
[Sun Jul  5 21:52:39 2020]
rule remove_empty:
    input: per_gene/EOG091G0X3B/ALICUT_EOG091G0X3B.clustalo.fasta
    output: per_gene/EOG091G0X3B/empty_check.done
    jobid: 1801
    wildcards: BUSCO=EOG091G0X3B


         if [ "$(cat per_gene/EOG091G0X3B/ALICUT_EOG091G0X3B.clustalo.fasta | grep -v ">" | sed 's/-//g' | grep "^$" | wc -l)" -gt 0 ]
         then
              cp per_gene/EOG091G0X3B/ALICUT_EOG091G0X3B.clustalo.fasta per_gene/EOG091G0X3B/ALICUT_EOG091G0X3B.clustalo.fasta.backup
              bash ../scripts/remove_empty.sh per_gene/EOG091G0X3B/ALICUT_EOG091G0X3B.clustalo.fasta.backup > per_gene/EOG091G0X3B/ALICUT_EOG091G0X3B.clustalo.fasta
         fi
         touch per_gene/EOG091G0X3B/empty_check.done
         
[Sun Jul  5 21:52:39 2020]
Finished job 1801.
466 of 3292 steps (14%) done

[Sun Jul  5 21:52:39 2020]
rule find_best_model:
    input: per_gene/EOG091G0X3B/ALICUT_EOG091G0X3B.clustalo.fasta, per_gene/EOG091G0X3B/empty_check.done
    output: per_gene/EOG091G0X3B/EOG091G0X3B.best_model
    log: per_gene/EOG091G0X3B/find_best_model.stderr.txt
    jobid: 978
    wildcards: BUSCO=EOG091G0X3B
    threads: 2


        cd per_gene/EOG091G0X3B
        if [ ! -d find_best_model ]
        then
            mkdir find_best_model
        fi
        cd find_best_model
        ln -s ../../../per_gene/EOG091G0X3B/ALICUT_EOG091G0X3B.clustalo.fasta EOG091G0X3B.fasta
        ProteinModelSelection.pl EOG091G0X3B.fasta 1> ../../../per_gene/EOG091G0X3B/EOG091G0X3B.best_model 2> ../../../per_gene/EOG091G0X3B/find_best_model.stderr.txt
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/c0c09ee657b1e27f2c5687e0e9aa8d70.simg
[Sun Jul  5 21:52:42 2020]
Finished job 151.
467 of 3292 steps (14%) done

[Sun Jul  5 21:52:42 2020]
rule get_seqs:
    input: /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ingroup.txt, /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/outgroup.txt
    output: per_gene/EOG091G038T/EOG091G038T.ingroup.fasta
    log: per_gene/EOG091G038T/get_seqs.stdout.txt, per_gene/EOG091G038T/get_seqs.stderr.txt
    jobid: 3054
    wildcards: BUSCO=EOG091G038T
    threads: 2


	basedir=$(pwd)
        cd per_gene/EOG091G038T
        
        bash $basedir/../scripts/fetch_seqs.sh EOG091G038T /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ingroup.txt /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/outgroup.txt 1> ../../per_gene/EOG091G038T/get_seqs.stdout.txt 2> ../../per_gene/EOG091G038T/get_seqs.stderr.txt
	mv EOG091G038T.fasta $basedir/per_gene/EOG091G038T/EOG091G038T.ingroup.fasta
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/72476f9d9a5bd0627b4d721143a21354.simg
[Sun Jul  5 21:52:43 2020]
Finished job 1240.
468 of 3292 steps (14%) done

[Sun Jul  5 21:52:43 2020]
rule score_and_cut:
    input: per_gene/EOG091G00UD/EOG091G00UD.clustalo.fasta
    output: per_gene/EOG091G00UD/ALICUT_EOG091G00UD.clustalo.fasta
    jobid: 417
    wildcards: BUSCO=EOG091G00UD
    threads: 2


        cd per_gene/EOG091G00UD
        Aliscore.pl -N -r 200000000000000000 -i ../../per_gene/EOG091G00UD/EOG091G00UD.clustalo.fasta &> aliscore.log
        ALICUT.pl -s &> alicut.log
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/63c88c27a0fa300f57066b0ef65fefcb.simg
[Sun Jul  5 21:52:54 2020]
Finished job 3054.
469 of 3292 steps (14%) done
[Sun Jul  5 21:52:54 2020]
Finished job 417.
470 of 3292 steps (14%) done

[Sun Jul  5 21:52:54 2020]
rule get_outgroups:
    input: per_gene/EOG091G038T/EOG091G038T.ingroup.fasta
    output: per_gene/EOG091G038T/EOG091G038T.orthodb.fasta, per_gene/EOG091G038T/EOG091G038T.outgroup.fasta
    log: per_gene/EOG091G038T/get_outgroups.stdout.txt, per_gene/EOG091G038T/get_outgroups.stderr.txt
    jobid: 3055
    wildcards: BUSCO=EOG091G038T


        #download fastas from Orhtodb for BUSCO id
        for i in {1..5}
        do
             wget "http://www.orthodb.org/fasta?query=EOG091G038T&level=33208" -O per_gene/EOG091G038T/EOG091G038T.orthodb.fasta 1> per_gene/EOG091G038T/get_outgroups.stdout.txt 2> per_gene/EOG091G038T/get_outgroups.stderr.txt && break || echo -e "try again ($i)" && sleep 15
        done

	#This is quick an dirty for now and just takes the first protein if there is more than one for an outgroup taxon
        bash ../scripts/download_outgroups.sh taxids.txt per_gene/EOG091G038T/EOG091G038T.orthodb.fasta > per_gene/EOG091G038T/EOG091G038T.outgroup.fasta
        

[Sun Jul  5 21:52:55 2020]
rule get_seqs:
    input: /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ingroup.txt, /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/outgroup.txt
    output: per_gene/EOG091G0MDG/EOG091G0MDG.ingroup.fasta
    log: per_gene/EOG091G0MDG/get_seqs.stdout.txt, per_gene/EOG091G0MDG/get_seqs.stderr.txt
    jobid: 2762
    wildcards: BUSCO=EOG091G0MDG
    threads: 2


	basedir=$(pwd)
        cd per_gene/EOG091G0MDG
        
        bash $basedir/../scripts/fetch_seqs.sh EOG091G0MDG /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ingroup.txt /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/outgroup.txt 1> ../../per_gene/EOG091G0MDG/get_seqs.stdout.txt 2> ../../per_gene/EOG091G0MDG/get_seqs.stderr.txt
	mv EOG091G0MDG.fasta $basedir/per_gene/EOG091G0MDG/EOG091G0MDG.ingroup.fasta
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/72476f9d9a5bd0627b4d721143a21354.simg

[Sun Jul  5 21:52:55 2020]
rule remove_empty:
    input: per_gene/EOG091G00UD/ALICUT_EOG091G00UD.clustalo.fasta
    output: per_gene/EOG091G00UD/empty_check.done
    jobid: 1239
    wildcards: BUSCO=EOG091G00UD


         if [ "$(cat per_gene/EOG091G00UD/ALICUT_EOG091G00UD.clustalo.fasta | grep -v ">" | sed 's/-//g' | grep "^$" | wc -l)" -gt 0 ]
         then
              cp per_gene/EOG091G00UD/ALICUT_EOG091G00UD.clustalo.fasta per_gene/EOG091G00UD/ALICUT_EOG091G00UD.clustalo.fasta.backup
              bash ../scripts/remove_empty.sh per_gene/EOG091G00UD/ALICUT_EOG091G00UD.clustalo.fasta.backup > per_gene/EOG091G00UD/ALICUT_EOG091G00UD.clustalo.fasta
         fi
         touch per_gene/EOG091G00UD/empty_check.done
         
[Sun Jul  5 21:52:55 2020]
Finished job 1239.
471 of 3292 steps (14%) done
[Sun Jul  5 21:52:56 2020]
Finished job 3055.
472 of 3292 steps (14%) done

[Sun Jul  5 21:52:56 2020]
rule join_groups:
    input: per_gene/EOG091G038T/EOG091G038T.ingroup.fasta, per_gene/EOG091G038T/EOG091G038T.outgroup.fasta
    output: per_gene/EOG091G038T/EOG091G038T.fasta
    jobid: 2351
    wildcards: BUSCO=EOG091G038T


        cat per_gene/EOG091G038T/EOG091G038T.ingroup.fasta per_gene/EOG091G038T/EOG091G038T.outgroup.fasta > per_gene/EOG091G038T/EOG091G038T.fasta
        
[Sun Jul  5 21:52:56 2020]
Finished job 2351.
473 of 3292 steps (14%) done

[Sun Jul  5 21:52:56 2020]
rule MSA:
    input: per_gene/EOG091G038T/EOG091G038T.fasta
    output: per_gene/EOG091G038T/EOG091G038T.clustalo.fasta
    log: per_gene/EOG091G038T/MSA.stdout.txt, per_gene/EOG091G038T/MSA.stderr.txt
    jobid: 1822
    wildcards: BUSCO=EOG091G038T
    threads: 2


        clustalo -i per_gene/EOG091G038T/EOG091G038T.fasta -o per_gene/EOG091G038T/EOG091G038T.clustalo.fasta --threads=2 1> per_gene/EOG091G038T/MSA.stdout.txt 2> per_gene/EOG091G038T/MSA.stderr.txt
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/d68c9691725a7401923680874285c430.simg
[Sun Jul  5 21:52:57 2020]
Finished job 1822.
474 of 3292 steps (14%) done

[Sun Jul  5 21:52:57 2020]
rule score_and_cut:
    input: per_gene/EOG091G038T/EOG091G038T.clustalo.fasta
    output: per_gene/EOG091G038T/ALICUT_EOG091G038T.clustalo.fasta
    jobid: 999
    wildcards: BUSCO=EOG091G038T
    threads: 2


        cd per_gene/EOG091G038T
        Aliscore.pl -N -r 200000000000000000 -i ../../per_gene/EOG091G038T/EOG091G038T.clustalo.fasta &> aliscore.log
        ALICUT.pl -s &> alicut.log
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/63c88c27a0fa300f57066b0ef65fefcb.simg
[Sun Jul  5 21:53:07 2020]
Finished job 999.
475 of 3292 steps (14%) done

[Sun Jul  5 21:53:07 2020]
rule find_best_model:
    input: per_gene/EOG091G00UD/ALICUT_EOG091G00UD.clustalo.fasta, per_gene/EOG091G00UD/empty_check.done
    output: per_gene/EOG091G00UD/EOG091G00UD.best_model
    log: per_gene/EOG091G00UD/find_best_model.stderr.txt
    jobid: 416
    wildcards: BUSCO=EOG091G00UD
    threads: 2


        cd per_gene/EOG091G00UD
        if [ ! -d find_best_model ]
        then
            mkdir find_best_model
        fi
        cd find_best_model
        ln -s ../../../per_gene/EOG091G00UD/ALICUT_EOG091G00UD.clustalo.fasta EOG091G00UD.fasta
        ProteinModelSelection.pl EOG091G00UD.fasta 1> ../../../per_gene/EOG091G00UD/EOG091G00UD.best_model 2> ../../../per_gene/EOG091G00UD/find_best_model.stderr.txt
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/c0c09ee657b1e27f2c5687e0e9aa8d70.simg
[Sun Jul  5 21:53:09 2020]
Finished job 2762.
476 of 3292 steps (14%) done

[Sun Jul  5 21:53:09 2020]
rule get_outgroups:
    input: per_gene/EOG091G0MDG/EOG091G0MDG.ingroup.fasta
    output: per_gene/EOG091G0MDG/EOG091G0MDG.orthodb.fasta, per_gene/EOG091G0MDG/EOG091G0MDG.outgroup.fasta
    log: per_gene/EOG091G0MDG/get_outgroups.stdout.txt, per_gene/EOG091G0MDG/get_outgroups.stderr.txt
    jobid: 2763
    wildcards: BUSCO=EOG091G0MDG


        #download fastas from Orhtodb for BUSCO id
        for i in {1..5}
        do
             wget "http://www.orthodb.org/fasta?query=EOG091G0MDG&level=33208" -O per_gene/EOG091G0MDG/EOG091G0MDG.orthodb.fasta 1> per_gene/EOG091G0MDG/get_outgroups.stdout.txt 2> per_gene/EOG091G0MDG/get_outgroups.stderr.txt && break || echo -e "try again ($i)" && sleep 15
        done

	#This is quick an dirty for now and just takes the first protein if there is more than one for an outgroup taxon
        bash ../scripts/download_outgroups.sh taxids.txt per_gene/EOG091G0MDG/EOG091G0MDG.orthodb.fasta > per_gene/EOG091G0MDG/EOG091G0MDG.outgroup.fasta
        

[Sun Jul  5 21:53:09 2020]
rule remove_empty:
    input: per_gene/EOG091G038T/ALICUT_EOG091G038T.clustalo.fasta
    output: per_gene/EOG091G038T/empty_check.done
    jobid: 1821
    wildcards: BUSCO=EOG091G038T


         if [ "$(cat per_gene/EOG091G038T/ALICUT_EOG091G038T.clustalo.fasta | grep -v ">" | sed 's/-//g' | grep "^$" | wc -l)" -gt 0 ]
         then
              cp per_gene/EOG091G038T/ALICUT_EOG091G038T.clustalo.fasta per_gene/EOG091G038T/ALICUT_EOG091G038T.clustalo.fasta.backup
              bash ../scripts/remove_empty.sh per_gene/EOG091G038T/ALICUT_EOG091G038T.clustalo.fasta.backup > per_gene/EOG091G038T/ALICUT_EOG091G038T.clustalo.fasta
         fi
         touch per_gene/EOG091G038T/empty_check.done
         
[Sun Jul  5 21:53:09 2020]
Finished job 1821.
477 of 3292 steps (14%) done
[Sun Jul  5 21:53:09 2020]
Finished job 1212.
478 of 3292 steps (15%) done

[Sun Jul  5 21:53:09 2020]
rule find_best_model:
    input: per_gene/EOG091G038T/ALICUT_EOG091G038T.clustalo.fasta, per_gene/EOG091G038T/empty_check.done
    output: per_gene/EOG091G038T/EOG091G038T.best_model
    log: per_gene/EOG091G038T/find_best_model.stderr.txt
    jobid: 998
    wildcards: BUSCO=EOG091G038T
    threads: 2


        cd per_gene/EOG091G038T
        if [ ! -d find_best_model ]
        then
            mkdir find_best_model
        fi
        cd find_best_model
        ln -s ../../../per_gene/EOG091G038T/ALICUT_EOG091G038T.clustalo.fasta EOG091G038T.fasta
        ProteinModelSelection.pl EOG091G038T.fasta 1> ../../../per_gene/EOG091G038T/EOG091G038T.best_model 2> ../../../per_gene/EOG091G038T/find_best_model.stderr.txt
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/c0c09ee657b1e27f2c5687e0e9aa8d70.simg
[Sun Jul  5 21:53:10 2020]
Finished job 2763.
479 of 3292 steps (15%) done

[Sun Jul  5 21:53:10 2020]
rule join_groups:
    input: per_gene/EOG091G0MDG/EOG091G0MDG.ingroup.fasta, per_gene/EOG091G0MDG/EOG091G0MDG.outgroup.fasta
    output: per_gene/EOG091G0MDG/EOG091G0MDG.fasta
    jobid: 2205
    wildcards: BUSCO=EOG091G0MDG


        cat per_gene/EOG091G0MDG/EOG091G0MDG.ingroup.fasta per_gene/EOG091G0MDG/EOG091G0MDG.outgroup.fasta > per_gene/EOG091G0MDG/EOG091G0MDG.fasta
        
[Sun Jul  5 21:53:10 2020]
Finished job 2205.
480 of 3292 steps (15%) done

[Sun Jul  5 21:53:10 2020]
rule MSA:
    input: per_gene/EOG091G0MDG/EOG091G0MDG.fasta
    output: per_gene/EOG091G0MDG/EOG091G0MDG.clustalo.fasta
    log: per_gene/EOG091G0MDG/MSA.stdout.txt, per_gene/EOG091G0MDG/MSA.stderr.txt
    jobid: 1530
    wildcards: BUSCO=EOG091G0MDG
    threads: 2


        clustalo -i per_gene/EOG091G0MDG/EOG091G0MDG.fasta -o per_gene/EOG091G0MDG/EOG091G0MDG.clustalo.fasta --threads=2 1> per_gene/EOG091G0MDG/MSA.stdout.txt 2> per_gene/EOG091G0MDG/MSA.stderr.txt
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/d68c9691725a7401923680874285c430.simg
[Sun Jul  5 21:53:11 2020]
Finished job 1530.
481 of 3292 steps (15%) done

[Sun Jul  5 21:53:11 2020]
rule score_and_cut:
    input: per_gene/EOG091G0MDG/EOG091G0MDG.clustalo.fasta
    output: per_gene/EOG091G0MDG/ALICUT_EOG091G0MDG.clustalo.fasta
    jobid: 707
    wildcards: BUSCO=EOG091G0MDG
    threads: 2


        cd per_gene/EOG091G0MDG
        Aliscore.pl -N -r 200000000000000000 -i ../../per_gene/EOG091G0MDG/EOG091G0MDG.clustalo.fasta &> aliscore.log
        ALICUT.pl -s &> alicut.log
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/63c88c27a0fa300f57066b0ef65fefcb.simg
[Sun Jul  5 21:53:11 2020]
Finished job 978.
482 of 3292 steps (15%) done

[Sun Jul  5 21:53:11 2020]
rule infer_single_ML:
    input: per_gene/EOG091G0BG4/EOG091G0BG4.best_model, per_gene/EOG091G0BG4/ALICUT_EOG091G0BG4.clustalo.fasta
    output: per_gene/EOG091G0BG4/EOG091G0BG4.raxml.done
    log: per_gene/EOG091G0BG4/infer_single_ML.stdout.txt, per_gene/EOG091G0BG4/infer_single_ML.stderr.txt
    jobid: 400
    wildcards: BUSCO=EOG091G0BG4
    threads: 2


        cd per_gene/EOG091G0BG4
	count=$(cat ../../per_gene/EOG091G0BG4/ALICUT_EOG091G0BG4.clustalo.fasta | grep ">" | wc -l)
	if [ "$count" -gt 5 ]
        then
		RAxMLmodel=$(cat ../../per_gene/EOG091G0BG4/EOG091G0BG4.best_model | grep "Best" | cut -d ":" -f 2 | tr -d '[:space:]')
                if [ "$(ls -1 | grep "^RAxML" | wc -l)" -ne 0 ]
		then
			rm RAxML*
		fi
        	raxml -f a -T 2 -m PROTGAMMA$RAxMLmodel         	-p 12345 -x 12345 -# 100         	-s ../../per_gene/EOG091G0BG4/ALICUT_EOG091G0BG4.clustalo.fasta -n EOG091G0BG4.clustalo.aln.ALICUT.$RAxMLmodel 		1> ../../per_gene/EOG091G0BG4/infer_single_ML.stdout.txt 2> ../../per_gene/EOG091G0BG4/infer_single_ML.stderr.txt
	else
		echo "fasta file per_gene/EOG091G0BG4/ALICUT_EOG091G0BG4.clustalo.fasta contains fewer than 5 sequences - skipped" > ../../per_gene/EOG091G0BG4/infer_single_ML.stdout.txt
		touch raxml.skipped
	fi
        touch ../../per_gene/EOG091G0BG4/EOG091G0BG4.raxml.done
        
[33mJob counts:
	count	jobs
	1	infer_single_ML
	1[0m
[33m
        cd per_gene/EOG091G0BG4
	count=$(cat ../../per_gene/EOG091G0BG4/ALICUT_EOG091G0BG4.clustalo.fasta | grep ">" | wc -l)
	if [ "$count" -gt 5 ]
        then
		RAxMLmodel=$(cat ../../per_gene/EOG091G0BG4/EOG091G0BG4.best_model | grep "Best" | cut -d ":" -f 2 | tr -d '[:space:]')
                if [ "$(ls -1 | grep "^RAxML" | wc -l)" -ne 0 ]
		then
			rm RAxML*
		fi
        	raxml -f a -T 2 -m PROTGAMMA$RAxMLmodel         	-p 12345 -x 12345 -# 100         	-s ../../per_gene/EOG091G0BG4/ALICUT_EOG091G0BG4.clustalo.fasta -n EOG091G0BG4.clustalo.aln.ALICUT.$RAxMLmodel 		1> ../../per_gene/EOG091G0BG4/infer_single_ML.stdout.txt 2> ../../per_gene/EOG091G0BG4/infer_single_ML.stderr.txt
	else
		echo "fasta file per_gene/EOG091G0BG4/ALICUT_EOG091G0BG4.clustalo.fasta contains fewer than 5 sequences - skipped" > ../../per_gene/EOG091G0BG4/infer_single_ML.stdout.txt
		touch raxml.skipped
	fi
        touch ../../per_gene/EOG091G0BG4/EOG091G0BG4.raxml.done
        [0m
[Sun Jul  5 21:53:22 2020]
Finished job 707.
483 of 3292 steps (15%) done

[Sun Jul  5 21:53:22 2020]
rule remove_empty:
    input: per_gene/EOG091G0MDG/ALICUT_EOG091G0MDG.clustalo.fasta
    output: per_gene/EOG091G0MDG/empty_check.done
    jobid: 1529
    wildcards: BUSCO=EOG091G0MDG


         if [ "$(cat per_gene/EOG091G0MDG/ALICUT_EOG091G0MDG.clustalo.fasta | grep -v ">" | sed 's/-//g' | grep "^$" | wc -l)" -gt 0 ]
         then
              cp per_gene/EOG091G0MDG/ALICUT_EOG091G0MDG.clustalo.fasta per_gene/EOG091G0MDG/ALICUT_EOG091G0MDG.clustalo.fasta.backup
              bash ../scripts/remove_empty.sh per_gene/EOG091G0MDG/ALICUT_EOG091G0MDG.clustalo.fasta.backup > per_gene/EOG091G0MDG/ALICUT_EOG091G0MDG.clustalo.fasta
         fi
         touch per_gene/EOG091G0MDG/empty_check.done
         
[Sun Jul  5 21:53:22 2020]
Finished job 1529.
484 of 3292 steps (15%) done

[Sun Jul  5 21:53:22 2020]
rule find_best_model:
    input: per_gene/EOG091G0MDG/ALICUT_EOG091G0MDG.clustalo.fasta, per_gene/EOG091G0MDG/empty_check.done
    output: per_gene/EOG091G0MDG/EOG091G0MDG.best_model
    log: per_gene/EOG091G0MDG/find_best_model.stderr.txt
    jobid: 706
    wildcards: BUSCO=EOG091G0MDG
    threads: 2


        cd per_gene/EOG091G0MDG
        if [ ! -d find_best_model ]
        then
            mkdir find_best_model
        fi
        cd find_best_model
        ln -s ../../../per_gene/EOG091G0MDG/ALICUT_EOG091G0MDG.clustalo.fasta EOG091G0MDG.fasta
        ProteinModelSelection.pl EOG091G0MDG.fasta 1> ../../../per_gene/EOG091G0MDG/EOG091G0MDG.best_model 2> ../../../per_gene/EOG091G0MDG/find_best_model.stderr.txt
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/c0c09ee657b1e27f2c5687e0e9aa8d70.simg
[Sun Jul  5 21:53:33 2020]
Finished job 105.
485 of 3292 steps (15%) done

[Sun Jul  5 21:53:33 2020]
rule infer_single_ML:
    input: per_gene/EOG091G0X3B/EOG091G0X3B.best_model, per_gene/EOG091G0X3B/ALICUT_EOG091G0X3B.clustalo.fasta
    output: per_gene/EOG091G0X3B/EOG091G0X3B.raxml.done
    log: per_gene/EOG091G0X3B/infer_single_ML.stdout.txt, per_gene/EOG091G0X3B/infer_single_ML.stderr.txt
    jobid: 283
    wildcards: BUSCO=EOG091G0X3B
    threads: 2


        cd per_gene/EOG091G0X3B
	count=$(cat ../../per_gene/EOG091G0X3B/ALICUT_EOG091G0X3B.clustalo.fasta | grep ">" | wc -l)
	if [ "$count" -gt 5 ]
        then
		RAxMLmodel=$(cat ../../per_gene/EOG091G0X3B/EOG091G0X3B.best_model | grep "Best" | cut -d ":" -f 2 | tr -d '[:space:]')
                if [ "$(ls -1 | grep "^RAxML" | wc -l)" -ne 0 ]
		then
			rm RAxML*
		fi
        	raxml -f a -T 2 -m PROTGAMMA$RAxMLmodel         	-p 12345 -x 12345 -# 100         	-s ../../per_gene/EOG091G0X3B/ALICUT_EOG091G0X3B.clustalo.fasta -n EOG091G0X3B.clustalo.aln.ALICUT.$RAxMLmodel 		1> ../../per_gene/EOG091G0X3B/infer_single_ML.stdout.txt 2> ../../per_gene/EOG091G0X3B/infer_single_ML.stderr.txt
	else
		echo "fasta file per_gene/EOG091G0X3B/ALICUT_EOG091G0X3B.clustalo.fasta contains fewer than 5 sequences - skipped" > ../../per_gene/EOG091G0X3B/infer_single_ML.stdout.txt
		touch raxml.skipped
	fi
        touch ../../per_gene/EOG091G0X3B/EOG091G0X3B.raxml.done
        
[33mJob counts:
	count	jobs
	1	infer_single_ML
	1[0m
[33m
        cd per_gene/EOG091G0X3B
	count=$(cat ../../per_gene/EOG091G0X3B/ALICUT_EOG091G0X3B.clustalo.fasta | grep ">" | wc -l)
	if [ "$count" -gt 5 ]
        then
		RAxMLmodel=$(cat ../../per_gene/EOG091G0X3B/EOG091G0X3B.best_model | grep "Best" | cut -d ":" -f 2 | tr -d '[:space:]')
                if [ "$(ls -1 | grep "^RAxML" | wc -l)" -ne 0 ]
		then
			rm RAxML*
		fi
        	raxml -f a -T 2 -m PROTGAMMA$RAxMLmodel         	-p 12345 -x 12345 -# 100         	-s ../../per_gene/EOG091G0X3B/ALICUT_EOG091G0X3B.clustalo.fasta -n EOG091G0X3B.clustalo.aln.ALICUT.$RAxMLmodel 		1> ../../per_gene/EOG091G0X3B/infer_single_ML.stdout.txt 2> ../../per_gene/EOG091G0X3B/infer_single_ML.stderr.txt
	else
		echo "fasta file per_gene/EOG091G0X3B/ALICUT_EOG091G0X3B.clustalo.fasta contains fewer than 5 sequences - skipped" > ../../per_gene/EOG091G0X3B/infer_single_ML.stdout.txt
		touch raxml.skipped
	fi
        touch ../../per_gene/EOG091G0X3B/EOG091G0X3B.raxml.done
        [0m
[Sun Jul  5 21:53:34 2020]
Finished job 69.
486 of 3292 steps (15%) done

[Sun Jul  5 21:53:34 2020]
rule get_seqs:
    input: /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ingroup.txt, /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/outgroup.txt
    output: per_gene/EOG091G0CEW/EOG091G0CEW.ingroup.fasta
    log: per_gene/EOG091G0CEW/get_seqs.stdout.txt, per_gene/EOG091G0CEW/get_seqs.stderr.txt
    jobid: 2646
    wildcards: BUSCO=EOG091G0CEW
    threads: 2


	basedir=$(pwd)
        cd per_gene/EOG091G0CEW
        
        bash $basedir/../scripts/fetch_seqs.sh EOG091G0CEW /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ingroup.txt /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/outgroup.txt 1> ../../per_gene/EOG091G0CEW/get_seqs.stdout.txt 2> ../../per_gene/EOG091G0CEW/get_seqs.stderr.txt
	mv EOG091G0CEW.fasta $basedir/per_gene/EOG091G0CEW/EOG091G0CEW.ingroup.fasta
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/72476f9d9a5bd0627b4d721143a21354.simg
[Sun Jul  5 21:53:34 2020]
Finished job 42.
487 of 3292 steps (15%) done

[Sun Jul  5 21:53:34 2020]
rule get_seqs:
    input: /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ingroup.txt, /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/outgroup.txt
    output: per_gene/EOG091G0TQF/EOG091G0TQF.ingroup.fasta
    log: per_gene/EOG091G0TQF/get_seqs.stdout.txt, per_gene/EOG091G0TQF/get_seqs.stderr.txt
    jobid: 3026
    wildcards: BUSCO=EOG091G0TQF
    threads: 2


	basedir=$(pwd)
        cd per_gene/EOG091G0TQF
        
        bash $basedir/../scripts/fetch_seqs.sh EOG091G0TQF /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ingroup.txt /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/outgroup.txt 1> ../../per_gene/EOG091G0TQF/get_seqs.stdout.txt 2> ../../per_gene/EOG091G0TQF/get_seqs.stderr.txt
	mv EOG091G0TQF.fasta $basedir/per_gene/EOG091G0TQF/EOG091G0TQF.ingroup.fasta
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/72476f9d9a5bd0627b4d721143a21354.simg
[Sun Jul  5 21:53:41 2020]
Finished job 19.
488 of 3292 steps (15%) done

[Sun Jul  5 21:53:41 2020]
rule get_seqs:
    input: /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ingroup.txt, /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/outgroup.txt
    output: per_gene/EOG091G0BQF/EOG091G0BQF.ingroup.fasta
    log: per_gene/EOG091G0BQF/get_seqs.stdout.txt, per_gene/EOG091G0BQF/get_seqs.stderr.txt
    jobid: 3082
    wildcards: BUSCO=EOG091G0BQF
    threads: 2


	basedir=$(pwd)
        cd per_gene/EOG091G0BQF
        
        bash $basedir/../scripts/fetch_seqs.sh EOG091G0BQF /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ingroup.txt /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/outgroup.txt 1> ../../per_gene/EOG091G0BQF/get_seqs.stdout.txt 2> ../../per_gene/EOG091G0BQF/get_seqs.stderr.txt
	mv EOG091G0BQF.fasta $basedir/per_gene/EOG091G0BQF/EOG091G0BQF.ingroup.fasta
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/72476f9d9a5bd0627b4d721143a21354.simg
[Sun Jul  5 21:53:50 2020]
Finished job 218.
489 of 3292 steps (15%) done

[Sun Jul  5 21:53:50 2020]
rule get_seqs:
    input: /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ingroup.txt, /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/outgroup.txt
    output: per_gene/EOG091G027G/EOG091G027G.ingroup.fasta
    log: per_gene/EOG091G027G/get_seqs.stdout.txt, per_gene/EOG091G027G/get_seqs.stderr.txt
    jobid: 2490
    wildcards: BUSCO=EOG091G027G
    threads: 2


	basedir=$(pwd)
        cd per_gene/EOG091G027G
        
        bash $basedir/../scripts/fetch_seqs.sh EOG091G027G /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ingroup.txt /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/outgroup.txt 1> ../../per_gene/EOG091G027G/get_seqs.stdout.txt 2> ../../per_gene/EOG091G027G/get_seqs.stderr.txt
	mv EOG091G027G.fasta $basedir/per_gene/EOG091G027G/EOG091G027G.ingroup.fasta
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/72476f9d9a5bd0627b4d721143a21354.simg
[Sun Jul  5 21:53:54 2020]
Finished job 2646.
490 of 3292 steps (15%) done

[Sun Jul  5 21:53:55 2020]
rule get_outgroups:
    input: per_gene/EOG091G0CEW/EOG091G0CEW.ingroup.fasta
    output: per_gene/EOG091G0CEW/EOG091G0CEW.orthodb.fasta, per_gene/EOG091G0CEW/EOG091G0CEW.outgroup.fasta
    log: per_gene/EOG091G0CEW/get_outgroups.stdout.txt, per_gene/EOG091G0CEW/get_outgroups.stderr.txt
    jobid: 2647
    wildcards: BUSCO=EOG091G0CEW


        #download fastas from Orhtodb for BUSCO id
        for i in {1..5}
        do
             wget "http://www.orthodb.org/fasta?query=EOG091G0CEW&level=33208" -O per_gene/EOG091G0CEW/EOG091G0CEW.orthodb.fasta 1> per_gene/EOG091G0CEW/get_outgroups.stdout.txt 2> per_gene/EOG091G0CEW/get_outgroups.stderr.txt && break || echo -e "try again ($i)" && sleep 15
        done

	#This is quick an dirty for now and just takes the first protein if there is more than one for an outgroup taxon
        bash ../scripts/download_outgroups.sh taxids.txt per_gene/EOG091G0CEW/EOG091G0CEW.orthodb.fasta > per_gene/EOG091G0CEW/EOG091G0CEW.outgroup.fasta
        
[Sun Jul  5 21:53:55 2020]
Finished job 3026.
491 of 3292 steps (15%) done

[Sun Jul  5 21:53:55 2020]
rule get_seqs:
    input: /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ingroup.txt, /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/outgroup.txt
    output: per_gene/EOG091G0TVG/EOG091G0TVG.ingroup.fasta
    log: per_gene/EOG091G0TVG/get_seqs.stdout.txt, per_gene/EOG091G0TVG/get_seqs.stderr.txt
    jobid: 2858
    wildcards: BUSCO=EOG091G0TVG
    threads: 2


	basedir=$(pwd)
        cd per_gene/EOG091G0TVG
        
        bash $basedir/../scripts/fetch_seqs.sh EOG091G0TVG /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ingroup.txt /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/outgroup.txt 1> ../../per_gene/EOG091G0TVG/get_seqs.stdout.txt 2> ../../per_gene/EOG091G0TVG/get_seqs.stderr.txt
	mv EOG091G0TVG.fasta $basedir/per_gene/EOG091G0TVG/EOG091G0TVG.ingroup.fasta
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/72476f9d9a5bd0627b4d721143a21354.simg

[Sun Jul  5 21:53:55 2020]
rule get_outgroups:
    input: per_gene/EOG091G0TQF/EOG091G0TQF.ingroup.fasta
    output: per_gene/EOG091G0TQF/EOG091G0TQF.orthodb.fasta, per_gene/EOG091G0TQF/EOG091G0TQF.outgroup.fasta
    log: per_gene/EOG091G0TQF/get_outgroups.stdout.txt, per_gene/EOG091G0TQF/get_outgroups.stderr.txt
    jobid: 3027
    wildcards: BUSCO=EOG091G0TQF


        #download fastas from Orhtodb for BUSCO id
        for i in {1..5}
        do
             wget "http://www.orthodb.org/fasta?query=EOG091G0TQF&level=33208" -O per_gene/EOG091G0TQF/EOG091G0TQF.orthodb.fasta 1> per_gene/EOG091G0TQF/get_outgroups.stdout.txt 2> per_gene/EOG091G0TQF/get_outgroups.stderr.txt && break || echo -e "try again ($i)" && sleep 15
        done

	#This is quick an dirty for now and just takes the first protein if there is more than one for an outgroup taxon
        bash ../scripts/download_outgroups.sh taxids.txt per_gene/EOG091G0TQF/EOG091G0TQF.orthodb.fasta > per_gene/EOG091G0TQF/EOG091G0TQF.outgroup.fasta
        
[Sun Jul  5 21:53:56 2020]
Finished job 2647.
492 of 3292 steps (15%) done

[Sun Jul  5 21:53:56 2020]
rule join_groups:
    input: per_gene/EOG091G0CEW/EOG091G0CEW.ingroup.fasta, per_gene/EOG091G0CEW/EOG091G0CEW.outgroup.fasta
    output: per_gene/EOG091G0CEW/EOG091G0CEW.fasta
    jobid: 2147
    wildcards: BUSCO=EOG091G0CEW


        cat per_gene/EOG091G0CEW/EOG091G0CEW.ingroup.fasta per_gene/EOG091G0CEW/EOG091G0CEW.outgroup.fasta > per_gene/EOG091G0CEW/EOG091G0CEW.fasta
        
[Sun Jul  5 21:53:56 2020]
Finished job 2147.
493 of 3292 steps (15%) done
[Sun Jul  5 21:53:57 2020]
Finished job 3027.
494 of 3292 steps (15%) done

[Sun Jul  5 21:53:57 2020]
rule MSA:
    input: per_gene/EOG091G0CEW/EOG091G0CEW.fasta
    output: per_gene/EOG091G0CEW/EOG091G0CEW.clustalo.fasta
    log: per_gene/EOG091G0CEW/MSA.stdout.txt, per_gene/EOG091G0CEW/MSA.stderr.txt
    jobid: 1414
    wildcards: BUSCO=EOG091G0CEW
    threads: 2


        clustalo -i per_gene/EOG091G0CEW/EOG091G0CEW.fasta -o per_gene/EOG091G0CEW/EOG091G0CEW.clustalo.fasta --threads=2 1> per_gene/EOG091G0CEW/MSA.stdout.txt 2> per_gene/EOG091G0CEW/MSA.stderr.txt
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/d68c9691725a7401923680874285c430.simg
[Sun Jul  5 21:53:58 2020]
Finished job 1414.
495 of 3292 steps (15%) done

[Sun Jul  5 21:53:58 2020]
rule score_and_cut:
    input: per_gene/EOG091G0CEW/EOG091G0CEW.clustalo.fasta
    output: per_gene/EOG091G0CEW/ALICUT_EOG091G0CEW.clustalo.fasta
    jobid: 591
    wildcards: BUSCO=EOG091G0CEW
    threads: 2


        cd per_gene/EOG091G0CEW
        Aliscore.pl -N -r 200000000000000000 -i ../../per_gene/EOG091G0CEW/EOG091G0CEW.clustalo.fasta &> aliscore.log
        ALICUT.pl -s &> alicut.log
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/63c88c27a0fa300f57066b0ef65fefcb.simg
[Sun Jul  5 21:54:00 2020]
Finished job 3082.
496 of 3292 steps (15%) done

[Sun Jul  5 21:54:00 2020]
rule get_outgroups:
    input: per_gene/EOG091G0BQF/EOG091G0BQF.ingroup.fasta
    output: per_gene/EOG091G0BQF/EOG091G0BQF.orthodb.fasta, per_gene/EOG091G0BQF/EOG091G0BQF.outgroup.fasta
    log: per_gene/EOG091G0BQF/get_outgroups.stdout.txt, per_gene/EOG091G0BQF/get_outgroups.stderr.txt
    jobid: 3083
    wildcards: BUSCO=EOG091G0BQF


        #download fastas from Orhtodb for BUSCO id
        for i in {1..5}
        do
             wget "http://www.orthodb.org/fasta?query=EOG091G0BQF&level=33208" -O per_gene/EOG091G0BQF/EOG091G0BQF.orthodb.fasta 1> per_gene/EOG091G0BQF/get_outgroups.stdout.txt 2> per_gene/EOG091G0BQF/get_outgroups.stderr.txt && break || echo -e "try again ($i)" && sleep 15
        done

	#This is quick an dirty for now and just takes the first protein if there is more than one for an outgroup taxon
        bash ../scripts/download_outgroups.sh taxids.txt per_gene/EOG091G0BQF/EOG091G0BQF.orthodb.fasta > per_gene/EOG091G0BQF/EOG091G0BQF.outgroup.fasta
        

[Sun Jul  5 21:54:00 2020]
rule join_groups:
    input: per_gene/EOG091G0TQF/EOG091G0TQF.ingroup.fasta, per_gene/EOG091G0TQF/EOG091G0TQF.outgroup.fasta
    output: per_gene/EOG091G0TQF/EOG091G0TQF.fasta
    jobid: 2337
    wildcards: BUSCO=EOG091G0TQF


        cat per_gene/EOG091G0TQF/EOG091G0TQF.ingroup.fasta per_gene/EOG091G0TQF/EOG091G0TQF.outgroup.fasta > per_gene/EOG091G0TQF/EOG091G0TQF.fasta
        
[Sun Jul  5 21:54:00 2020]
Finished job 2337.
497 of 3292 steps (15%) done
[Sun Jul  5 21:54:01 2020]
Finished job 3083.
498 of 3292 steps (15%) done

[Sun Jul  5 21:54:01 2020]
rule join_groups:
    input: per_gene/EOG091G0BQF/EOG091G0BQF.ingroup.fasta, per_gene/EOG091G0BQF/EOG091G0BQF.outgroup.fasta
    output: per_gene/EOG091G0BQF/EOG091G0BQF.fasta
    jobid: 2365
    wildcards: BUSCO=EOG091G0BQF


        cat per_gene/EOG091G0BQF/EOG091G0BQF.ingroup.fasta per_gene/EOG091G0BQF/EOG091G0BQF.outgroup.fasta > per_gene/EOG091G0BQF/EOG091G0BQF.fasta
        
[Sun Jul  5 21:54:01 2020]
Finished job 2365.
499 of 3292 steps (15%) done

[Sun Jul  5 21:54:01 2020]
rule MSA:
    input: per_gene/EOG091G0BQF/EOG091G0BQF.fasta
    output: per_gene/EOG091G0BQF/EOG091G0BQF.clustalo.fasta
    log: per_gene/EOG091G0BQF/MSA.stdout.txt, per_gene/EOG091G0BQF/MSA.stderr.txt
    jobid: 1850
    wildcards: BUSCO=EOG091G0BQF
    threads: 2


        clustalo -i per_gene/EOG091G0BQF/EOG091G0BQF.fasta -o per_gene/EOG091G0BQF/EOG091G0BQF.clustalo.fasta --threads=2 1> per_gene/EOG091G0BQF/MSA.stdout.txt 2> per_gene/EOG091G0BQF/MSA.stderr.txt
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/d68c9691725a7401923680874285c430.simg
[Sun Jul  5 21:54:02 2020]
Finished job 1850.
500 of 3292 steps (15%) done

[Sun Jul  5 21:54:02 2020]
rule score_and_cut:
    input: per_gene/EOG091G0BQF/EOG091G0BQF.clustalo.fasta
    output: per_gene/EOG091G0BQF/ALICUT_EOG091G0BQF.clustalo.fasta
    jobid: 1027
    wildcards: BUSCO=EOG091G0BQF
    threads: 2


        cd per_gene/EOG091G0BQF
        Aliscore.pl -N -r 200000000000000000 -i ../../per_gene/EOG091G0BQF/EOG091G0BQF.clustalo.fasta &> aliscore.log
        ALICUT.pl -s &> alicut.log
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/63c88c27a0fa300f57066b0ef65fefcb.simg
[Sun Jul  5 21:54:07 2020]
Finished job 998.
501 of 3292 steps (15%) done

[Sun Jul  5 21:54:07 2020]
rule infer_single_ML:
    input: per_gene/EOG091G038T/EOG091G038T.best_model, per_gene/EOG091G038T/ALICUT_EOG091G038T.clustalo.fasta
    output: per_gene/EOG091G038T/EOG091G038T.raxml.done
    log: per_gene/EOG091G038T/infer_single_ML.stdout.txt, per_gene/EOG091G038T/infer_single_ML.stderr.txt
    jobid: 293
    wildcards: BUSCO=EOG091G038T
    threads: 2


        cd per_gene/EOG091G038T
	count=$(cat ../../per_gene/EOG091G038T/ALICUT_EOG091G038T.clustalo.fasta | grep ">" | wc -l)
	if [ "$count" -gt 5 ]
        then
		RAxMLmodel=$(cat ../../per_gene/EOG091G038T/EOG091G038T.best_model | grep "Best" | cut -d ":" -f 2 | tr -d '[:space:]')
                if [ "$(ls -1 | grep "^RAxML" | wc -l)" -ne 0 ]
		then
			rm RAxML*
		fi
        	raxml -f a -T 2 -m PROTGAMMA$RAxMLmodel         	-p 12345 -x 12345 -# 100         	-s ../../per_gene/EOG091G038T/ALICUT_EOG091G038T.clustalo.fasta -n EOG091G038T.clustalo.aln.ALICUT.$RAxMLmodel 		1> ../../per_gene/EOG091G038T/infer_single_ML.stdout.txt 2> ../../per_gene/EOG091G038T/infer_single_ML.stderr.txt
	else
		echo "fasta file per_gene/EOG091G038T/ALICUT_EOG091G038T.clustalo.fasta contains fewer than 5 sequences - skipped" > ../../per_gene/EOG091G038T/infer_single_ML.stdout.txt
		touch raxml.skipped
	fi
        touch ../../per_gene/EOG091G038T/EOG091G038T.raxml.done
        
[Sun Jul  5 21:54:07 2020]
Finished job 591.
502 of 3292 steps (15%) done
[Sun Jul  5 21:54:07 2020]
Finished job 2490.
503 of 3292 steps (15%) done

[Sun Jul  5 21:54:07 2020]
rule get_outgroups:
    input: per_gene/EOG091G027G/EOG091G027G.ingroup.fasta
    output: per_gene/EOG091G027G/EOG091G027G.orthodb.fasta, per_gene/EOG091G027G/EOG091G027G.outgroup.fasta
    log: per_gene/EOG091G027G/get_outgroups.stdout.txt, per_gene/EOG091G027G/get_outgroups.stderr.txt
    jobid: 2491
    wildcards: BUSCO=EOG091G027G


        #download fastas from Orhtodb for BUSCO id
        for i in {1..5}
        do
             wget "http://www.orthodb.org/fasta?query=EOG091G027G&level=33208" -O per_gene/EOG091G027G/EOG091G027G.orthodb.fasta 1> per_gene/EOG091G027G/get_outgroups.stdout.txt 2> per_gene/EOG091G027G/get_outgroups.stderr.txt && break || echo -e "try again ($i)" && sleep 15
        done

	#This is quick an dirty for now and just takes the first protein if there is more than one for an outgroup taxon
        bash ../scripts/download_outgroups.sh taxids.txt per_gene/EOG091G027G/EOG091G027G.orthodb.fasta > per_gene/EOG091G027G/EOG091G027G.outgroup.fasta
        

[Sun Jul  5 21:54:07 2020]
rule MSA:
    input: per_gene/EOG091G0TQF/EOG091G0TQF.fasta
    output: per_gene/EOG091G0TQF/EOG091G0TQF.clustalo.fasta
    log: per_gene/EOG091G0TQF/MSA.stdout.txt, per_gene/EOG091G0TQF/MSA.stderr.txt
    jobid: 1794
    wildcards: BUSCO=EOG091G0TQF
    threads: 2


        clustalo -i per_gene/EOG091G0TQF/EOG091G0TQF.fasta -o per_gene/EOG091G0TQF/EOG091G0TQF.clustalo.fasta --threads=2 1> per_gene/EOG091G0TQF/MSA.stdout.txt 2> per_gene/EOG091G0TQF/MSA.stderr.txt
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/d68c9691725a7401923680874285c430.simg

[Sun Jul  5 21:54:07 2020]
rule remove_empty:
    input: per_gene/EOG091G0CEW/ALICUT_EOG091G0CEW.clustalo.fasta
    output: per_gene/EOG091G0CEW/empty_check.done
    jobid: 1413
    wildcards: BUSCO=EOG091G0CEW


         if [ "$(cat per_gene/EOG091G0CEW/ALICUT_EOG091G0CEW.clustalo.fasta | grep -v ">" | sed 's/-//g' | grep "^$" | wc -l)" -gt 0 ]
         then
              cp per_gene/EOG091G0CEW/ALICUT_EOG091G0CEW.clustalo.fasta per_gene/EOG091G0CEW/ALICUT_EOG091G0CEW.clustalo.fasta.backup
              bash ../scripts/remove_empty.sh per_gene/EOG091G0CEW/ALICUT_EOG091G0CEW.clustalo.fasta.backup > per_gene/EOG091G0CEW/ALICUT_EOG091G0CEW.clustalo.fasta
         fi
         touch per_gene/EOG091G0CEW/empty_check.done
         
[Sun Jul  5 21:54:07 2020]
Finished job 1413.
504 of 3292 steps (15%) done
[33mJob counts:
	count	jobs
	1	infer_single_ML
	1[0m
[33m
        cd per_gene/EOG091G038T
	count=$(cat ../../per_gene/EOG091G038T/ALICUT_EOG091G038T.clustalo.fasta | grep ">" | wc -l)
	if [ "$count" -gt 5 ]
        then
		RAxMLmodel=$(cat ../../per_gene/EOG091G038T/EOG091G038T.best_model | grep "Best" | cut -d ":" -f 2 | tr -d '[:space:]')
                if [ "$(ls -1 | grep "^RAxML" | wc -l)" -ne 0 ]
		then
			rm RAxML*
		fi
        	raxml -f a -T 2 -m PROTGAMMA$RAxMLmodel         	-p 12345 -x 12345 -# 100         	-s ../../per_gene/EOG091G038T/ALICUT_EOG091G038T.clustalo.fasta -n EOG091G038T.clustalo.aln.ALICUT.$RAxMLmodel 		1> ../../per_gene/EOG091G038T/infer_single_ML.stdout.txt 2> ../../per_gene/EOG091G038T/infer_single_ML.stderr.txt
	else
		echo "fasta file per_gene/EOG091G038T/ALICUT_EOG091G038T.clustalo.fasta contains fewer than 5 sequences - skipped" > ../../per_gene/EOG091G038T/infer_single_ML.stdout.txt
		touch raxml.skipped
	fi
        touch ../../per_gene/EOG091G038T/EOG091G038T.raxml.done
        [0m
[Sun Jul  5 21:54:08 2020]
Finished job 1794.
505 of 3292 steps (15%) done

[Sun Jul  5 21:54:08 2020]
rule score_and_cut:
    input: per_gene/EOG091G0TQF/EOG091G0TQF.clustalo.fasta
    output: per_gene/EOG091G0TQF/ALICUT_EOG091G0TQF.clustalo.fasta
    jobid: 971
    wildcards: BUSCO=EOG091G0TQF
    threads: 2


        cd per_gene/EOG091G0TQF
        Aliscore.pl -N -r 200000000000000000 -i ../../per_gene/EOG091G0TQF/EOG091G0TQF.clustalo.fasta &> aliscore.log
        ALICUT.pl -s &> alicut.log
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/63c88c27a0fa300f57066b0ef65fefcb.simg
[Sun Jul  5 21:54:08 2020]
Finished job 2491.
506 of 3292 steps (15%) done

[Sun Jul  5 21:54:08 2020]
rule join_groups:
    input: per_gene/EOG091G027G/EOG091G027G.ingroup.fasta, per_gene/EOG091G027G/EOG091G027G.outgroup.fasta
    output: per_gene/EOG091G027G/EOG091G027G.fasta
    jobid: 2069
    wildcards: BUSCO=EOG091G027G


        cat per_gene/EOG091G027G/EOG091G027G.ingroup.fasta per_gene/EOG091G027G/EOG091G027G.outgroup.fasta > per_gene/EOG091G027G/EOG091G027G.fasta
        
[Sun Jul  5 21:54:08 2020]
Finished job 2069.
507 of 3292 steps (15%) done

[Sun Jul  5 21:54:08 2020]
rule MSA:
    input: per_gene/EOG091G027G/EOG091G027G.fasta
    output: per_gene/EOG091G027G/EOG091G027G.clustalo.fasta
    log: per_gene/EOG091G027G/MSA.stdout.txt, per_gene/EOG091G027G/MSA.stderr.txt
    jobid: 1258
    wildcards: BUSCO=EOG091G027G
    threads: 2


        clustalo -i per_gene/EOG091G027G/EOG091G027G.fasta -o per_gene/EOG091G027G/EOG091G027G.clustalo.fasta --threads=2 1> per_gene/EOG091G027G/MSA.stdout.txt 2> per_gene/EOG091G027G/MSA.stderr.txt
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/d68c9691725a7401923680874285c430.simg
[Sun Jul  5 21:54:09 2020]
Finished job 2858.
508 of 3292 steps (15%) done

[Sun Jul  5 21:54:09 2020]
rule find_best_model:
    input: per_gene/EOG091G0CEW/ALICUT_EOG091G0CEW.clustalo.fasta, per_gene/EOG091G0CEW/empty_check.done
    output: per_gene/EOG091G0CEW/EOG091G0CEW.best_model
    log: per_gene/EOG091G0CEW/find_best_model.stderr.txt
    jobid: 590
    wildcards: BUSCO=EOG091G0CEW
    threads: 2


        cd per_gene/EOG091G0CEW
        if [ ! -d find_best_model ]
        then
            mkdir find_best_model
        fi
        cd find_best_model
        ln -s ../../../per_gene/EOG091G0CEW/ALICUT_EOG091G0CEW.clustalo.fasta EOG091G0CEW.fasta
        ProteinModelSelection.pl EOG091G0CEW.fasta 1> ../../../per_gene/EOG091G0CEW/EOG091G0CEW.best_model 2> ../../../per_gene/EOG091G0CEW/find_best_model.stderr.txt
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/c0c09ee657b1e27f2c5687e0e9aa8d70.simg
[Sun Jul  5 21:54:10 2020]
Finished job 1027.
509 of 3292 steps (15%) done

[Sun Jul  5 21:54:10 2020]
rule get_outgroups:
    input: per_gene/EOG091G0TVG/EOG091G0TVG.ingroup.fasta
    output: per_gene/EOG091G0TVG/EOG091G0TVG.orthodb.fasta, per_gene/EOG091G0TVG/EOG091G0TVG.outgroup.fasta
    log: per_gene/EOG091G0TVG/get_outgroups.stdout.txt, per_gene/EOG091G0TVG/get_outgroups.stderr.txt
    jobid: 2859
    wildcards: BUSCO=EOG091G0TVG


        #download fastas from Orhtodb for BUSCO id
        for i in {1..5}
        do
             wget "http://www.orthodb.org/fasta?query=EOG091G0TVG&level=33208" -O per_gene/EOG091G0TVG/EOG091G0TVG.orthodb.fasta 1> per_gene/EOG091G0TVG/get_outgroups.stdout.txt 2> per_gene/EOG091G0TVG/get_outgroups.stderr.txt && break || echo -e "try again ($i)" && sleep 15
        done

	#This is quick an dirty for now and just takes the first protein if there is more than one for an outgroup taxon
        bash ../scripts/download_outgroups.sh taxids.txt per_gene/EOG091G0TVG/EOG091G0TVG.orthodb.fasta > per_gene/EOG091G0TVG/EOG091G0TVG.outgroup.fasta
        

[Sun Jul  5 21:54:10 2020]
rule remove_empty:
    input: per_gene/EOG091G0BQF/ALICUT_EOG091G0BQF.clustalo.fasta
    output: per_gene/EOG091G0BQF/empty_check.done
    jobid: 1849
    wildcards: BUSCO=EOG091G0BQF


         if [ "$(cat per_gene/EOG091G0BQF/ALICUT_EOG091G0BQF.clustalo.fasta | grep -v ">" | sed 's/-//g' | grep "^$" | wc -l)" -gt 0 ]
         then
              cp per_gene/EOG091G0BQF/ALICUT_EOG091G0BQF.clustalo.fasta per_gene/EOG091G0BQF/ALICUT_EOG091G0BQF.clustalo.fasta.backup
              bash ../scripts/remove_empty.sh per_gene/EOG091G0BQF/ALICUT_EOG091G0BQF.clustalo.fasta.backup > per_gene/EOG091G0BQF/ALICUT_EOG091G0BQF.clustalo.fasta
         fi
         touch per_gene/EOG091G0BQF/empty_check.done
         
[Sun Jul  5 21:54:10 2020]
Finished job 1849.
510 of 3292 steps (15%) done
[Sun Jul  5 21:54:11 2020]
Finished job 2859.
511 of 3292 steps (16%) done

[Sun Jul  5 21:54:11 2020]
rule find_best_model:
    input: per_gene/EOG091G0BQF/ALICUT_EOG091G0BQF.clustalo.fasta, per_gene/EOG091G0BQF/empty_check.done
    output: per_gene/EOG091G0BQF/EOG091G0BQF.best_model
    log: per_gene/EOG091G0BQF/find_best_model.stderr.txt
    jobid: 1026
    wildcards: BUSCO=EOG091G0BQF
    threads: 2


        cd per_gene/EOG091G0BQF
        if [ ! -d find_best_model ]
        then
            mkdir find_best_model
        fi
        cd find_best_model
        ln -s ../../../per_gene/EOG091G0BQF/ALICUT_EOG091G0BQF.clustalo.fasta EOG091G0BQF.fasta
        ProteinModelSelection.pl EOG091G0BQF.fasta 1> ../../../per_gene/EOG091G0BQF/EOG091G0BQF.best_model 2> ../../../per_gene/EOG091G0BQF/find_best_model.stderr.txt
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/c0c09ee657b1e27f2c5687e0e9aa8d70.simg
[Sun Jul  5 21:54:11 2020]
Finished job 706.
512 of 3292 steps (16%) done

[Sun Jul  5 21:54:11 2020]
rule infer_single_ML:
    input: per_gene/EOG091G0MDG/EOG091G0MDG.best_model, per_gene/EOG091G0MDG/ALICUT_EOG091G0MDG.clustalo.fasta
    output: per_gene/EOG091G0MDG/EOG091G0MDG.raxml.done
    log: per_gene/EOG091G0MDG/infer_single_ML.stdout.txt, per_gene/EOG091G0MDG/infer_single_ML.stderr.txt
    jobid: 147
    wildcards: BUSCO=EOG091G0MDG
    threads: 2


        cd per_gene/EOG091G0MDG
	count=$(cat ../../per_gene/EOG091G0MDG/ALICUT_EOG091G0MDG.clustalo.fasta | grep ">" | wc -l)
	if [ "$count" -gt 5 ]
        then
		RAxMLmodel=$(cat ../../per_gene/EOG091G0MDG/EOG091G0MDG.best_model | grep "Best" | cut -d ":" -f 2 | tr -d '[:space:]')
                if [ "$(ls -1 | grep "^RAxML" | wc -l)" -ne 0 ]
		then
			rm RAxML*
		fi
        	raxml -f a -T 2 -m PROTGAMMA$RAxMLmodel         	-p 12345 -x 12345 -# 100         	-s ../../per_gene/EOG091G0MDG/ALICUT_EOG091G0MDG.clustalo.fasta -n EOG091G0MDG.clustalo.aln.ALICUT.$RAxMLmodel 		1> ../../per_gene/EOG091G0MDG/infer_single_ML.stdout.txt 2> ../../per_gene/EOG091G0MDG/infer_single_ML.stderr.txt
	else
		echo "fasta file per_gene/EOG091G0MDG/ALICUT_EOG091G0MDG.clustalo.fasta contains fewer than 5 sequences - skipped" > ../../per_gene/EOG091G0MDG/infer_single_ML.stdout.txt
		touch raxml.skipped
	fi
        touch ../../per_gene/EOG091G0MDG/EOG091G0MDG.raxml.done
        
[Sun Jul  5 21:54:13 2020]
Finished job 1258.
513 of 3292 steps (16%) done

[Sun Jul  5 21:54:13 2020]
rule score_and_cut:
    input: per_gene/EOG091G027G/EOG091G027G.clustalo.fasta
    output: per_gene/EOG091G027G/ALICUT_EOG091G027G.clustalo.fasta
    jobid: 435
    wildcards: BUSCO=EOG091G027G
    threads: 2


        cd per_gene/EOG091G027G
        Aliscore.pl -N -r 200000000000000000 -i ../../per_gene/EOG091G027G/EOG091G027G.clustalo.fasta &> aliscore.log
        ALICUT.pl -s &> alicut.log
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/63c88c27a0fa300f57066b0ef65fefcb.simg
[33mJob counts:
	count	jobs
	1	infer_single_ML
	1[0m
[33m
        cd per_gene/EOG091G0MDG
	count=$(cat ../../per_gene/EOG091G0MDG/ALICUT_EOG091G0MDG.clustalo.fasta | grep ">" | wc -l)
	if [ "$count" -gt 5 ]
        then
		RAxMLmodel=$(cat ../../per_gene/EOG091G0MDG/EOG091G0MDG.best_model | grep "Best" | cut -d ":" -f 2 | tr -d '[:space:]')
                if [ "$(ls -1 | grep "^RAxML" | wc -l)" -ne 0 ]
		then
			rm RAxML*
		fi
        	raxml -f a -T 2 -m PROTGAMMA$RAxMLmodel         	-p 12345 -x 12345 -# 100         	-s ../../per_gene/EOG091G0MDG/ALICUT_EOG091G0MDG.clustalo.fasta -n EOG091G0MDG.clustalo.aln.ALICUT.$RAxMLmodel 		1> ../../per_gene/EOG091G0MDG/infer_single_ML.stdout.txt 2> ../../per_gene/EOG091G0MDG/infer_single_ML.stderr.txt
	else
		echo "fasta file per_gene/EOG091G0MDG/ALICUT_EOG091G0MDG.clustalo.fasta contains fewer than 5 sequences - skipped" > ../../per_gene/EOG091G0MDG/infer_single_ML.stdout.txt
		touch raxml.skipped
	fi
        touch ../../per_gene/EOG091G0MDG/EOG091G0MDG.raxml.done
        [0m
[Sun Jul  5 21:54:16 2020]
Finished job 971.
514 of 3292 steps (16%) done

[Sun Jul  5 21:54:16 2020]
rule remove_empty:
    input: per_gene/EOG091G0TQF/ALICUT_EOG091G0TQF.clustalo.fasta
    output: per_gene/EOG091G0TQF/empty_check.done
    jobid: 1793
    wildcards: BUSCO=EOG091G0TQF


         if [ "$(cat per_gene/EOG091G0TQF/ALICUT_EOG091G0TQF.clustalo.fasta | grep -v ">" | sed 's/-//g' | grep "^$" | wc -l)" -gt 0 ]
         then
              cp per_gene/EOG091G0TQF/ALICUT_EOG091G0TQF.clustalo.fasta per_gene/EOG091G0TQF/ALICUT_EOG091G0TQF.clustalo.fasta.backup
              bash ../scripts/remove_empty.sh per_gene/EOG091G0TQF/ALICUT_EOG091G0TQF.clustalo.fasta.backup > per_gene/EOG091G0TQF/ALICUT_EOG091G0TQF.clustalo.fasta
         fi
         touch per_gene/EOG091G0TQF/empty_check.done
         

[Sun Jul  5 21:54:16 2020]
rule join_groups:
    input: per_gene/EOG091G0TVG/EOG091G0TVG.ingroup.fasta, per_gene/EOG091G0TVG/EOG091G0TVG.outgroup.fasta
    output: per_gene/EOG091G0TVG/EOG091G0TVG.fasta
    jobid: 2253
    wildcards: BUSCO=EOG091G0TVG


        cat per_gene/EOG091G0TVG/EOG091G0TVG.ingroup.fasta per_gene/EOG091G0TVG/EOG091G0TVG.outgroup.fasta > per_gene/EOG091G0TVG/EOG091G0TVG.fasta
        
[Sun Jul  5 21:54:16 2020]
Finished job 1793.
515 of 3292 steps (16%) done
[Sun Jul  5 21:54:16 2020]
Finished job 2253.
516 of 3292 steps (16%) done

[Sun Jul  5 21:54:16 2020]
rule find_best_model:
    input: per_gene/EOG091G0TQF/ALICUT_EOG091G0TQF.clustalo.fasta, per_gene/EOG091G0TQF/empty_check.done
    output: per_gene/EOG091G0TQF/EOG091G0TQF.best_model
    log: per_gene/EOG091G0TQF/find_best_model.stderr.txt
    jobid: 970
    wildcards: BUSCO=EOG091G0TQF
    threads: 2


        cd per_gene/EOG091G0TQF
        if [ ! -d find_best_model ]
        then
            mkdir find_best_model
        fi
        cd find_best_model
        ln -s ../../../per_gene/EOG091G0TQF/ALICUT_EOG091G0TQF.clustalo.fasta EOG091G0TQF.fasta
        ProteinModelSelection.pl EOG091G0TQF.fasta 1> ../../../per_gene/EOG091G0TQF/EOG091G0TQF.best_model 2> ../../../per_gene/EOG091G0TQF/find_best_model.stderr.txt
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/c0c09ee657b1e27f2c5687e0e9aa8d70.simg
[Sun Jul  5 21:54:19 2020]
Finished job 416.
517 of 3292 steps (16%) done

[Sun Jul  5 21:54:19 2020]
rule infer_single_ML:
    input: per_gene/EOG091G00UD/EOG091G00UD.best_model, per_gene/EOG091G00UD/ALICUT_EOG091G00UD.clustalo.fasta
    output: per_gene/EOG091G00UD/EOG091G00UD.raxml.done
    log: per_gene/EOG091G00UD/infer_single_ML.stdout.txt, per_gene/EOG091G00UD/infer_single_ML.stderr.txt
    jobid: 2
    wildcards: BUSCO=EOG091G00UD
    threads: 2


        cd per_gene/EOG091G00UD
	count=$(cat ../../per_gene/EOG091G00UD/ALICUT_EOG091G00UD.clustalo.fasta | grep ">" | wc -l)
	if [ "$count" -gt 5 ]
        then
		RAxMLmodel=$(cat ../../per_gene/EOG091G00UD/EOG091G00UD.best_model | grep "Best" | cut -d ":" -f 2 | tr -d '[:space:]')
                if [ "$(ls -1 | grep "^RAxML" | wc -l)" -ne 0 ]
		then
			rm RAxML*
		fi
        	raxml -f a -T 2 -m PROTGAMMA$RAxMLmodel         	-p 12345 -x 12345 -# 100         	-s ../../per_gene/EOG091G00UD/ALICUT_EOG091G00UD.clustalo.fasta -n EOG091G00UD.clustalo.aln.ALICUT.$RAxMLmodel 		1> ../../per_gene/EOG091G00UD/infer_single_ML.stdout.txt 2> ../../per_gene/EOG091G00UD/infer_single_ML.stderr.txt
	else
		echo "fasta file per_gene/EOG091G00UD/ALICUT_EOG091G00UD.clustalo.fasta contains fewer than 5 sequences - skipped" > ../../per_gene/EOG091G00UD/infer_single_ML.stdout.txt
		touch raxml.skipped
	fi
        touch ../../per_gene/EOG091G00UD/EOG091G00UD.raxml.done
        
[33mJob counts:
	count	jobs
	1	infer_single_ML
	1[0m
[33m
        cd per_gene/EOG091G00UD
	count=$(cat ../../per_gene/EOG091G00UD/ALICUT_EOG091G00UD.clustalo.fasta | grep ">" | wc -l)
	if [ "$count" -gt 5 ]
        then
		RAxMLmodel=$(cat ../../per_gene/EOG091G00UD/EOG091G00UD.best_model | grep "Best" | cut -d ":" -f 2 | tr -d '[:space:]')
                if [ "$(ls -1 | grep "^RAxML" | wc -l)" -ne 0 ]
		then
			rm RAxML*
		fi
        	raxml -f a -T 2 -m PROTGAMMA$RAxMLmodel         	-p 12345 -x 12345 -# 100         	-s ../../per_gene/EOG091G00UD/ALICUT_EOG091G00UD.clustalo.fasta -n EOG091G00UD.clustalo.aln.ALICUT.$RAxMLmodel 		1> ../../per_gene/EOG091G00UD/infer_single_ML.stdout.txt 2> ../../per_gene/EOG091G00UD/infer_single_ML.stderr.txt
	else
		echo "fasta file per_gene/EOG091G00UD/ALICUT_EOG091G00UD.clustalo.fasta contains fewer than 5 sequences - skipped" > ../../per_gene/EOG091G00UD/infer_single_ML.stdout.txt
		touch raxml.skipped
	fi
        touch ../../per_gene/EOG091G00UD/EOG091G00UD.raxml.done
        [0m
[Sun Jul  5 21:54:26 2020]
Finished job 435.
518 of 3292 steps (16%) done

[Sun Jul  5 21:54:26 2020]
rule remove_empty:
    input: per_gene/EOG091G027G/ALICUT_EOG091G027G.clustalo.fasta
    output: per_gene/EOG091G027G/empty_check.done
    jobid: 1257
    wildcards: BUSCO=EOG091G027G


         if [ "$(cat per_gene/EOG091G027G/ALICUT_EOG091G027G.clustalo.fasta | grep -v ">" | sed 's/-//g' | grep "^$" | wc -l)" -gt 0 ]
         then
              cp per_gene/EOG091G027G/ALICUT_EOG091G027G.clustalo.fasta per_gene/EOG091G027G/ALICUT_EOG091G027G.clustalo.fasta.backup
              bash ../scripts/remove_empty.sh per_gene/EOG091G027G/ALICUT_EOG091G027G.clustalo.fasta.backup > per_gene/EOG091G027G/ALICUT_EOG091G027G.clustalo.fasta
         fi
         touch per_gene/EOG091G027G/empty_check.done
         
[Sun Jul  5 21:54:26 2020]
Finished job 1257.
519 of 3292 steps (16%) done

[Sun Jul  5 21:54:26 2020]
rule find_best_model:
    input: per_gene/EOG091G027G/ALICUT_EOG091G027G.clustalo.fasta, per_gene/EOG091G027G/empty_check.done
    output: per_gene/EOG091G027G/EOG091G027G.best_model
    log: per_gene/EOG091G027G/find_best_model.stderr.txt
    jobid: 434
    wildcards: BUSCO=EOG091G027G
    threads: 2


        cd per_gene/EOG091G027G
        if [ ! -d find_best_model ]
        then
            mkdir find_best_model
        fi
        cd find_best_model
        ln -s ../../../per_gene/EOG091G027G/ALICUT_EOG091G027G.clustalo.fasta EOG091G027G.fasta
        ProteinModelSelection.pl EOG091G027G.fasta 1> ../../../per_gene/EOG091G027G/EOG091G027G.best_model 2> ../../../per_gene/EOG091G027G/find_best_model.stderr.txt
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/c0c09ee657b1e27f2c5687e0e9aa8d70.simg
[Sun Jul  5 21:54:39 2020]
Finished job 176.
520 of 3292 steps (16%) done

[Sun Jul  5 21:54:39 2020]
rule MSA:
    input: per_gene/EOG091G0TVG/EOG091G0TVG.fasta
    output: per_gene/EOG091G0TVG/EOG091G0TVG.clustalo.fasta
    log: per_gene/EOG091G0TVG/MSA.stdout.txt, per_gene/EOG091G0TVG/MSA.stderr.txt
    jobid: 1626
    wildcards: BUSCO=EOG091G0TVG
    threads: 2


        clustalo -i per_gene/EOG091G0TVG/EOG091G0TVG.fasta -o per_gene/EOG091G0TVG/EOG091G0TVG.clustalo.fasta --threads=2 1> per_gene/EOG091G0TVG/MSA.stdout.txt 2> per_gene/EOG091G0TVG/MSA.stderr.txt
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/d68c9691725a7401923680874285c430.simg
[Sun Jul  5 21:54:40 2020]
Finished job 1626.
521 of 3292 steps (16%) done

[Sun Jul  5 21:54:40 2020]
rule score_and_cut:
    input: per_gene/EOG091G0TVG/EOG091G0TVG.clustalo.fasta
    output: per_gene/EOG091G0TVG/ALICUT_EOG091G0TVG.clustalo.fasta
    jobid: 803
    wildcards: BUSCO=EOG091G0TVG
    threads: 2


        cd per_gene/EOG091G0TVG
        Aliscore.pl -N -r 200000000000000000 -i ../../per_gene/EOG091G0TVG/EOG091G0TVG.clustalo.fasta &> aliscore.log
        ALICUT.pl -s &> alicut.log
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/63c88c27a0fa300f57066b0ef65fefcb.simg
[Sun Jul  5 21:54:42 2020]
Finished job 590.
522 of 3292 steps (16%) done

[Sun Jul  5 21:54:42 2020]
rule infer_single_ML:
    input: per_gene/EOG091G0CEW/EOG091G0CEW.best_model, per_gene/EOG091G0CEW/ALICUT_EOG091G0CEW.clustalo.fasta
    output: per_gene/EOG091G0CEW/EOG091G0CEW.raxml.done
    log: per_gene/EOG091G0CEW/infer_single_ML.stdout.txt, per_gene/EOG091G0CEW/infer_single_ML.stderr.txt
    jobid: 89
    wildcards: BUSCO=EOG091G0CEW
    threads: 2


        cd per_gene/EOG091G0CEW
	count=$(cat ../../per_gene/EOG091G0CEW/ALICUT_EOG091G0CEW.clustalo.fasta | grep ">" | wc -l)
	if [ "$count" -gt 5 ]
        then
		RAxMLmodel=$(cat ../../per_gene/EOG091G0CEW/EOG091G0CEW.best_model | grep "Best" | cut -d ":" -f 2 | tr -d '[:space:]')
                if [ "$(ls -1 | grep "^RAxML" | wc -l)" -ne 0 ]
		then
			rm RAxML*
		fi
        	raxml -f a -T 2 -m PROTGAMMA$RAxMLmodel         	-p 12345 -x 12345 -# 100         	-s ../../per_gene/EOG091G0CEW/ALICUT_EOG091G0CEW.clustalo.fasta -n EOG091G0CEW.clustalo.aln.ALICUT.$RAxMLmodel 		1> ../../per_gene/EOG091G0CEW/infer_single_ML.stdout.txt 2> ../../per_gene/EOG091G0CEW/infer_single_ML.stderr.txt
	else
		echo "fasta file per_gene/EOG091G0CEW/ALICUT_EOG091G0CEW.clustalo.fasta contains fewer than 5 sequences - skipped" > ../../per_gene/EOG091G0CEW/infer_single_ML.stdout.txt
		touch raxml.skipped
	fi
        touch ../../per_gene/EOG091G0CEW/EOG091G0CEW.raxml.done
        
[33mJob counts:
	count	jobs
	1	infer_single_ML
	1[0m
[33m
        cd per_gene/EOG091G0CEW
	count=$(cat ../../per_gene/EOG091G0CEW/ALICUT_EOG091G0CEW.clustalo.fasta | grep ">" | wc -l)
	if [ "$count" -gt 5 ]
        then
		RAxMLmodel=$(cat ../../per_gene/EOG091G0CEW/EOG091G0CEW.best_model | grep "Best" | cut -d ":" -f 2 | tr -d '[:space:]')
                if [ "$(ls -1 | grep "^RAxML" | wc -l)" -ne 0 ]
		then
			rm RAxML*
		fi
        	raxml -f a -T 2 -m PROTGAMMA$RAxMLmodel         	-p 12345 -x 12345 -# 100         	-s ../../per_gene/EOG091G0CEW/ALICUT_EOG091G0CEW.clustalo.fasta -n EOG091G0CEW.clustalo.aln.ALICUT.$RAxMLmodel 		1> ../../per_gene/EOG091G0CEW/infer_single_ML.stdout.txt 2> ../../per_gene/EOG091G0CEW/infer_single_ML.stderr.txt
	else
		echo "fasta file per_gene/EOG091G0CEW/ALICUT_EOG091G0CEW.clustalo.fasta contains fewer than 5 sequences - skipped" > ../../per_gene/EOG091G0CEW/infer_single_ML.stdout.txt
		touch raxml.skipped
	fi
        touch ../../per_gene/EOG091G0CEW/EOG091G0CEW.raxml.done
        [0m
[Sun Jul  5 21:54:44 2020]
Finished job 970.
523 of 3292 steps (16%) done

[Sun Jul  5 21:54:44 2020]
rule infer_single_ML:
    input: per_gene/EOG091G0TQF/EOG091G0TQF.best_model, per_gene/EOG091G0TQF/ALICUT_EOG091G0TQF.clustalo.fasta
    output: per_gene/EOG091G0TQF/EOG091G0TQF.raxml.done
    log: per_gene/EOG091G0TQF/infer_single_ML.stdout.txt, per_gene/EOG091G0TQF/infer_single_ML.stderr.txt
    jobid: 279
    wildcards: BUSCO=EOG091G0TQF
    threads: 2


        cd per_gene/EOG091G0TQF
	count=$(cat ../../per_gene/EOG091G0TQF/ALICUT_EOG091G0TQF.clustalo.fasta | grep ">" | wc -l)
	if [ "$count" -gt 5 ]
        then
		RAxMLmodel=$(cat ../../per_gene/EOG091G0TQF/EOG091G0TQF.best_model | grep "Best" | cut -d ":" -f 2 | tr -d '[:space:]')
                if [ "$(ls -1 | grep "^RAxML" | wc -l)" -ne 0 ]
		then
			rm RAxML*
		fi
        	raxml -f a -T 2 -m PROTGAMMA$RAxMLmodel         	-p 12345 -x 12345 -# 100         	-s ../../per_gene/EOG091G0TQF/ALICUT_EOG091G0TQF.clustalo.fasta -n EOG091G0TQF.clustalo.aln.ALICUT.$RAxMLmodel 		1> ../../per_gene/EOG091G0TQF/infer_single_ML.stdout.txt 2> ../../per_gene/EOG091G0TQF/infer_single_ML.stderr.txt
	else
		echo "fasta file per_gene/EOG091G0TQF/ALICUT_EOG091G0TQF.clustalo.fasta contains fewer than 5 sequences - skipped" > ../../per_gene/EOG091G0TQF/infer_single_ML.stdout.txt
		touch raxml.skipped
	fi
        touch ../../per_gene/EOG091G0TQF/EOG091G0TQF.raxml.done
        
[33mJob counts:
	count	jobs
	1	infer_single_ML
	1[0m
[33m
        cd per_gene/EOG091G0TQF
	count=$(cat ../../per_gene/EOG091G0TQF/ALICUT_EOG091G0TQF.clustalo.fasta | grep ">" | wc -l)
	if [ "$count" -gt 5 ]
        then
		RAxMLmodel=$(cat ../../per_gene/EOG091G0TQF/EOG091G0TQF.best_model | grep "Best" | cut -d ":" -f 2 | tr -d '[:space:]')
                if [ "$(ls -1 | grep "^RAxML" | wc -l)" -ne 0 ]
		then
			rm RAxML*
		fi
        	raxml -f a -T 2 -m PROTGAMMA$RAxMLmodel         	-p 12345 -x 12345 -# 100         	-s ../../per_gene/EOG091G0TQF/ALICUT_EOG091G0TQF.clustalo.fasta -n EOG091G0TQF.clustalo.aln.ALICUT.$RAxMLmodel 		1> ../../per_gene/EOG091G0TQF/infer_single_ML.stdout.txt 2> ../../per_gene/EOG091G0TQF/infer_single_ML.stderr.txt
	else
		echo "fasta file per_gene/EOG091G0TQF/ALICUT_EOG091G0TQF.clustalo.fasta contains fewer than 5 sequences - skipped" > ../../per_gene/EOG091G0TQF/infer_single_ML.stdout.txt
		touch raxml.skipped
	fi
        touch ../../per_gene/EOG091G0TQF/EOG091G0TQF.raxml.done
        [0m
[Sun Jul  5 21:54:49 2020]
Finished job 803.
524 of 3292 steps (16%) done

[Sun Jul  5 21:54:49 2020]
rule remove_empty:
    input: per_gene/EOG091G0TVG/ALICUT_EOG091G0TVG.clustalo.fasta
    output: per_gene/EOG091G0TVG/empty_check.done
    jobid: 1625
    wildcards: BUSCO=EOG091G0TVG


         if [ "$(cat per_gene/EOG091G0TVG/ALICUT_EOG091G0TVG.clustalo.fasta | grep -v ">" | sed 's/-//g' | grep "^$" | wc -l)" -gt 0 ]
         then
              cp per_gene/EOG091G0TVG/ALICUT_EOG091G0TVG.clustalo.fasta per_gene/EOG091G0TVG/ALICUT_EOG091G0TVG.clustalo.fasta.backup
              bash ../scripts/remove_empty.sh per_gene/EOG091G0TVG/ALICUT_EOG091G0TVG.clustalo.fasta.backup > per_gene/EOG091G0TVG/ALICUT_EOG091G0TVG.clustalo.fasta
         fi
         touch per_gene/EOG091G0TVG/empty_check.done
         
[Sun Jul  5 21:54:49 2020]
Finished job 1625.
525 of 3292 steps (16%) done

[Sun Jul  5 21:54:49 2020]
rule find_best_model:
    input: per_gene/EOG091G0TVG/ALICUT_EOG091G0TVG.clustalo.fasta, per_gene/EOG091G0TVG/empty_check.done
    output: per_gene/EOG091G0TVG/EOG091G0TVG.best_model
    log: per_gene/EOG091G0TVG/find_best_model.stderr.txt
    jobid: 802
    wildcards: BUSCO=EOG091G0TVG
    threads: 2


        cd per_gene/EOG091G0TVG
        if [ ! -d find_best_model ]
        then
            mkdir find_best_model
        fi
        cd find_best_model
        ln -s ../../../per_gene/EOG091G0TVG/ALICUT_EOG091G0TVG.clustalo.fasta EOG091G0TVG.fasta
        ProteinModelSelection.pl EOG091G0TVG.fasta 1> ../../../per_gene/EOG091G0TVG/EOG091G0TVG.best_model 2> ../../../per_gene/EOG091G0TVG/find_best_model.stderr.txt
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/c0c09ee657b1e27f2c5687e0e9aa8d70.simg
[Sun Jul  5 21:54:58 2020]
Finished job 1026.
526 of 3292 steps (16%) done

[Sun Jul  5 21:54:58 2020]
rule infer_single_ML:
    input: per_gene/EOG091G0BQF/EOG091G0BQF.best_model, per_gene/EOG091G0BQF/ALICUT_EOG091G0BQF.clustalo.fasta
    output: per_gene/EOG091G0BQF/EOG091G0BQF.raxml.done
    log: per_gene/EOG091G0BQF/infer_single_ML.stdout.txt, per_gene/EOG091G0BQF/infer_single_ML.stderr.txt
    jobid: 307
    wildcards: BUSCO=EOG091G0BQF
    threads: 2


        cd per_gene/EOG091G0BQF
	count=$(cat ../../per_gene/EOG091G0BQF/ALICUT_EOG091G0BQF.clustalo.fasta | grep ">" | wc -l)
	if [ "$count" -gt 5 ]
        then
		RAxMLmodel=$(cat ../../per_gene/EOG091G0BQF/EOG091G0BQF.best_model | grep "Best" | cut -d ":" -f 2 | tr -d '[:space:]')
                if [ "$(ls -1 | grep "^RAxML" | wc -l)" -ne 0 ]
		then
			rm RAxML*
		fi
        	raxml -f a -T 2 -m PROTGAMMA$RAxMLmodel         	-p 12345 -x 12345 -# 100         	-s ../../per_gene/EOG091G0BQF/ALICUT_EOG091G0BQF.clustalo.fasta -n EOG091G0BQF.clustalo.aln.ALICUT.$RAxMLmodel 		1> ../../per_gene/EOG091G0BQF/infer_single_ML.stdout.txt 2> ../../per_gene/EOG091G0BQF/infer_single_ML.stderr.txt
	else
		echo "fasta file per_gene/EOG091G0BQF/ALICUT_EOG091G0BQF.clustalo.fasta contains fewer than 5 sequences - skipped" > ../../per_gene/EOG091G0BQF/infer_single_ML.stdout.txt
		touch raxml.skipped
	fi
        touch ../../per_gene/EOG091G0BQF/EOG091G0BQF.raxml.done
        
[33mJob counts:
	count	jobs
	1	infer_single_ML
	1[0m
[33m
        cd per_gene/EOG091G0BQF
	count=$(cat ../../per_gene/EOG091G0BQF/ALICUT_EOG091G0BQF.clustalo.fasta | grep ">" | wc -l)
	if [ "$count" -gt 5 ]
        then
		RAxMLmodel=$(cat ../../per_gene/EOG091G0BQF/EOG091G0BQF.best_model | grep "Best" | cut -d ":" -f 2 | tr -d '[:space:]')
                if [ "$(ls -1 | grep "^RAxML" | wc -l)" -ne 0 ]
		then
			rm RAxML*
		fi
        	raxml -f a -T 2 -m PROTGAMMA$RAxMLmodel         	-p 12345 -x 12345 -# 100         	-s ../../per_gene/EOG091G0BQF/ALICUT_EOG091G0BQF.clustalo.fasta -n EOG091G0BQF.clustalo.aln.ALICUT.$RAxMLmodel 		1> ../../per_gene/EOG091G0BQF/infer_single_ML.stdout.txt 2> ../../per_gene/EOG091G0BQF/infer_single_ML.stderr.txt
	else
		echo "fasta file per_gene/EOG091G0BQF/ALICUT_EOG091G0BQF.clustalo.fasta contains fewer than 5 sequences - skipped" > ../../per_gene/EOG091G0BQF/infer_single_ML.stdout.txt
		touch raxml.skipped
	fi
        touch ../../per_gene/EOG091G0BQF/EOG091G0BQF.raxml.done
        [0m
[Sun Jul  5 21:55:23 2020]
Finished job 802.
527 of 3292 steps (16%) done

[Sun Jul  5 21:55:23 2020]
rule infer_single_ML:
    input: per_gene/EOG091G0TVG/EOG091G0TVG.best_model, per_gene/EOG091G0TVG/ALICUT_EOG091G0TVG.clustalo.fasta
    output: per_gene/EOG091G0TVG/EOG091G0TVG.raxml.done
    log: per_gene/EOG091G0TVG/infer_single_ML.stdout.txt, per_gene/EOG091G0TVG/infer_single_ML.stderr.txt
    jobid: 195
    wildcards: BUSCO=EOG091G0TVG
    threads: 2


        cd per_gene/EOG091G0TVG
	count=$(cat ../../per_gene/EOG091G0TVG/ALICUT_EOG091G0TVG.clustalo.fasta | grep ">" | wc -l)
	if [ "$count" -gt 5 ]
        then
		RAxMLmodel=$(cat ../../per_gene/EOG091G0TVG/EOG091G0TVG.best_model | grep "Best" | cut -d ":" -f 2 | tr -d '[:space:]')
                if [ "$(ls -1 | grep "^RAxML" | wc -l)" -ne 0 ]
		then
			rm RAxML*
		fi
        	raxml -f a -T 2 -m PROTGAMMA$RAxMLmodel         	-p 12345 -x 12345 -# 100         	-s ../../per_gene/EOG091G0TVG/ALICUT_EOG091G0TVG.clustalo.fasta -n EOG091G0TVG.clustalo.aln.ALICUT.$RAxMLmodel 		1> ../../per_gene/EOG091G0TVG/infer_single_ML.stdout.txt 2> ../../per_gene/EOG091G0TVG/infer_single_ML.stderr.txt
	else
		echo "fasta file per_gene/EOG091G0TVG/ALICUT_EOG091G0TVG.clustalo.fasta contains fewer than 5 sequences - skipped" > ../../per_gene/EOG091G0TVG/infer_single_ML.stdout.txt
		touch raxml.skipped
	fi
        touch ../../per_gene/EOG091G0TVG/EOG091G0TVG.raxml.done
        
[33mJob counts:
	count	jobs
	1	infer_single_ML
	1[0m
[33m
        cd per_gene/EOG091G0TVG
	count=$(cat ../../per_gene/EOG091G0TVG/ALICUT_EOG091G0TVG.clustalo.fasta | grep ">" | wc -l)
	if [ "$count" -gt 5 ]
        then
		RAxMLmodel=$(cat ../../per_gene/EOG091G0TVG/EOG091G0TVG.best_model | grep "Best" | cut -d ":" -f 2 | tr -d '[:space:]')
                if [ "$(ls -1 | grep "^RAxML" | wc -l)" -ne 0 ]
		then
			rm RAxML*
		fi
        	raxml -f a -T 2 -m PROTGAMMA$RAxMLmodel         	-p 12345 -x 12345 -# 100         	-s ../../per_gene/EOG091G0TVG/ALICUT_EOG091G0TVG.clustalo.fasta -n EOG091G0TVG.clustalo.aln.ALICUT.$RAxMLmodel 		1> ../../per_gene/EOG091G0TVG/infer_single_ML.stdout.txt 2> ../../per_gene/EOG091G0TVG/infer_single_ML.stderr.txt
	else
		echo "fasta file per_gene/EOG091G0TVG/ALICUT_EOG091G0TVG.clustalo.fasta contains fewer than 5 sequences - skipped" > ../../per_gene/EOG091G0TVG/infer_single_ML.stdout.txt
		touch raxml.skipped
	fi
        touch ../../per_gene/EOG091G0TVG/EOG091G0TVG.raxml.done
        [0m
[Sun Jul  5 21:55:46 2020]
Finished job 434.
528 of 3292 steps (16%) done

[Sun Jul  5 21:55:46 2020]
rule infer_single_ML:
    input: per_gene/EOG091G027G/EOG091G027G.best_model, per_gene/EOG091G027G/ALICUT_EOG091G027G.clustalo.fasta
    output: per_gene/EOG091G027G/EOG091G027G.raxml.done
    log: per_gene/EOG091G027G/infer_single_ML.stdout.txt, per_gene/EOG091G027G/infer_single_ML.stderr.txt
    jobid: 11
    wildcards: BUSCO=EOG091G027G
    threads: 2


        cd per_gene/EOG091G027G
	count=$(cat ../../per_gene/EOG091G027G/ALICUT_EOG091G027G.clustalo.fasta | grep ">" | wc -l)
	if [ "$count" -gt 5 ]
        then
		RAxMLmodel=$(cat ../../per_gene/EOG091G027G/EOG091G027G.best_model | grep "Best" | cut -d ":" -f 2 | tr -d '[:space:]')
                if [ "$(ls -1 | grep "^RAxML" | wc -l)" -ne 0 ]
		then
			rm RAxML*
		fi
        	raxml -f a -T 2 -m PROTGAMMA$RAxMLmodel         	-p 12345 -x 12345 -# 100         	-s ../../per_gene/EOG091G027G/ALICUT_EOG091G027G.clustalo.fasta -n EOG091G027G.clustalo.aln.ALICUT.$RAxMLmodel 		1> ../../per_gene/EOG091G027G/infer_single_ML.stdout.txt 2> ../../per_gene/EOG091G027G/infer_single_ML.stderr.txt
	else
		echo "fasta file per_gene/EOG091G027G/ALICUT_EOG091G027G.clustalo.fasta contains fewer than 5 sequences - skipped" > ../../per_gene/EOG091G027G/infer_single_ML.stdout.txt
		touch raxml.skipped
	fi
        touch ../../per_gene/EOG091G027G/EOG091G027G.raxml.done
        
[33mJob counts:
	count	jobs
	1	infer_single_ML
	1[0m
[33m
        cd per_gene/EOG091G027G
	count=$(cat ../../per_gene/EOG091G027G/ALICUT_EOG091G027G.clustalo.fasta | grep ">" | wc -l)
	if [ "$count" -gt 5 ]
        then
		RAxMLmodel=$(cat ../../per_gene/EOG091G027G/EOG091G027G.best_model | grep "Best" | cut -d ":" -f 2 | tr -d '[:space:]')
                if [ "$(ls -1 | grep "^RAxML" | wc -l)" -ne 0 ]
		then
			rm RAxML*
		fi
        	raxml -f a -T 2 -m PROTGAMMA$RAxMLmodel         	-p 12345 -x 12345 -# 100         	-s ../../per_gene/EOG091G027G/ALICUT_EOG091G027G.clustalo.fasta -n EOG091G027G.clustalo.aln.ALICUT.$RAxMLmodel 		1> ../../per_gene/EOG091G027G/infer_single_ML.stdout.txt 2> ../../per_gene/EOG091G027G/infer_single_ML.stderr.txt
	else
		echo "fasta file per_gene/EOG091G027G/ALICUT_EOG091G027G.clustalo.fasta contains fewer than 5 sequences - skipped" > ../../per_gene/EOG091G027G/infer_single_ML.stdout.txt
		touch raxml.skipped
	fi
        touch ../../per_gene/EOG091G027G/EOG091G027G.raxml.done
        [0m
[Sun Jul  5 21:56:13 2020]
Finished job 3.
529 of 3292 steps (16%) done

[Sun Jul  5 21:56:13 2020]
rule get_seqs:
    input: /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ingroup.txt, /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/outgroup.txt
    output: per_gene/EOG091G074G/EOG091G074G.ingroup.fasta
    log: per_gene/EOG091G074G/get_seqs.stdout.txt, per_gene/EOG091G074G/get_seqs.stderr.txt
    jobid: 3068
    wildcards: BUSCO=EOG091G074G
    threads: 2


	basedir=$(pwd)
        cd per_gene/EOG091G074G
        
        bash $basedir/../scripts/fetch_seqs.sh EOG091G074G /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ingroup.txt /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/outgroup.txt 1> ../../per_gene/EOG091G074G/get_seqs.stdout.txt 2> ../../per_gene/EOG091G074G/get_seqs.stderr.txt
	mv EOG091G074G.fasta $basedir/per_gene/EOG091G074G/EOG091G074G.ingroup.fasta
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/72476f9d9a5bd0627b4d721143a21354.simg
[Sun Jul  5 21:56:26 2020]
Finished job 3068.
530 of 3292 steps (16%) done

[Sun Jul  5 21:56:26 2020]
rule get_outgroups:
    input: per_gene/EOG091G074G/EOG091G074G.ingroup.fasta
    output: per_gene/EOG091G074G/EOG091G074G.orthodb.fasta, per_gene/EOG091G074G/EOG091G074G.outgroup.fasta
    log: per_gene/EOG091G074G/get_outgroups.stdout.txt, per_gene/EOG091G074G/get_outgroups.stderr.txt
    jobid: 3069
    wildcards: BUSCO=EOG091G074G


        #download fastas from Orhtodb for BUSCO id
        for i in {1..5}
        do
             wget "http://www.orthodb.org/fasta?query=EOG091G074G&level=33208" -O per_gene/EOG091G074G/EOG091G074G.orthodb.fasta 1> per_gene/EOG091G074G/get_outgroups.stdout.txt 2> per_gene/EOG091G074G/get_outgroups.stderr.txt && break || echo -e "try again ($i)" && sleep 15
        done

	#This is quick an dirty for now and just takes the first protein if there is more than one for an outgroup taxon
        bash ../scripts/download_outgroups.sh taxids.txt per_gene/EOG091G074G/EOG091G074G.orthodb.fasta > per_gene/EOG091G074G/EOG091G074G.outgroup.fasta
        
[Sun Jul  5 21:56:27 2020]
Finished job 3069.
531 of 3292 steps (16%) done

[Sun Jul  5 21:56:27 2020]
rule join_groups:
    input: per_gene/EOG091G074G/EOG091G074G.ingroup.fasta, per_gene/EOG091G074G/EOG091G074G.outgroup.fasta
    output: per_gene/EOG091G074G/EOG091G074G.fasta
    jobid: 2358
    wildcards: BUSCO=EOG091G074G


        cat per_gene/EOG091G074G/EOG091G074G.ingroup.fasta per_gene/EOG091G074G/EOG091G074G.outgroup.fasta > per_gene/EOG091G074G/EOG091G074G.fasta
        
[Sun Jul  5 21:56:27 2020]
Finished job 2358.
532 of 3292 steps (16%) done

[Sun Jul  5 21:56:27 2020]
rule MSA:
    input: per_gene/EOG091G074G/EOG091G074G.fasta
    output: per_gene/EOG091G074G/EOG091G074G.clustalo.fasta
    log: per_gene/EOG091G074G/MSA.stdout.txt, per_gene/EOG091G074G/MSA.stderr.txt
    jobid: 1836
    wildcards: BUSCO=EOG091G074G
    threads: 2


        clustalo -i per_gene/EOG091G074G/EOG091G074G.fasta -o per_gene/EOG091G074G/EOG091G074G.clustalo.fasta --threads=2 1> per_gene/EOG091G074G/MSA.stdout.txt 2> per_gene/EOG091G074G/MSA.stderr.txt
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/d68c9691725a7401923680874285c430.simg
[Sun Jul  5 21:56:29 2020]
Finished job 1836.
533 of 3292 steps (16%) done

[Sun Jul  5 21:56:29 2020]
rule score_and_cut:
    input: per_gene/EOG091G074G/EOG091G074G.clustalo.fasta
    output: per_gene/EOG091G074G/ALICUT_EOG091G074G.clustalo.fasta
    jobid: 1013
    wildcards: BUSCO=EOG091G074G
    threads: 2


        cd per_gene/EOG091G074G
        Aliscore.pl -N -r 200000000000000000 -i ../../per_gene/EOG091G074G/EOG091G074G.clustalo.fasta &> aliscore.log
        ALICUT.pl -s &> alicut.log
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/63c88c27a0fa300f57066b0ef65fefcb.simg
[Sun Jul  5 21:56:39 2020]
Finished job 1013.
534 of 3292 steps (16%) done

[Sun Jul  5 21:56:39 2020]
rule remove_empty:
    input: per_gene/EOG091G074G/ALICUT_EOG091G074G.clustalo.fasta
    output: per_gene/EOG091G074G/empty_check.done
    jobid: 1835
    wildcards: BUSCO=EOG091G074G


         if [ "$(cat per_gene/EOG091G074G/ALICUT_EOG091G074G.clustalo.fasta | grep -v ">" | sed 's/-//g' | grep "^$" | wc -l)" -gt 0 ]
         then
              cp per_gene/EOG091G074G/ALICUT_EOG091G074G.clustalo.fasta per_gene/EOG091G074G/ALICUT_EOG091G074G.clustalo.fasta.backup
              bash ../scripts/remove_empty.sh per_gene/EOG091G074G/ALICUT_EOG091G074G.clustalo.fasta.backup > per_gene/EOG091G074G/ALICUT_EOG091G074G.clustalo.fasta
         fi
         touch per_gene/EOG091G074G/empty_check.done
         
[Sun Jul  5 21:56:39 2020]
Finished job 1835.
535 of 3292 steps (16%) done

[Sun Jul  5 21:56:39 2020]
rule find_best_model:
    input: per_gene/EOG091G074G/ALICUT_EOG091G074G.clustalo.fasta, per_gene/EOG091G074G/empty_check.done
    output: per_gene/EOG091G074G/EOG091G074G.best_model
    log: per_gene/EOG091G074G/find_best_model.stderr.txt
    jobid: 1012
    wildcards: BUSCO=EOG091G074G
    threads: 2


        cd per_gene/EOG091G074G
        if [ ! -d find_best_model ]
        then
            mkdir find_best_model
        fi
        cd find_best_model
        ln -s ../../../per_gene/EOG091G074G/ALICUT_EOG091G074G.clustalo.fasta EOG091G074G.fasta
        ProteinModelSelection.pl EOG091G074G.fasta 1> ../../../per_gene/EOG091G074G/EOG091G074G.best_model 2> ../../../per_gene/EOG091G074G/find_best_model.stderr.txt
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/c0c09ee657b1e27f2c5687e0e9aa8d70.simg
[Sun Jul  5 21:57:17 2020]
Finished job 1012.
536 of 3292 steps (16%) done

[Sun Jul  5 21:57:17 2020]
rule infer_single_ML:
    input: per_gene/EOG091G074G/EOG091G074G.best_model, per_gene/EOG091G074G/ALICUT_EOG091G074G.clustalo.fasta
    output: per_gene/EOG091G074G/EOG091G074G.raxml.done
    log: per_gene/EOG091G074G/infer_single_ML.stdout.txt, per_gene/EOG091G074G/infer_single_ML.stderr.txt
    jobid: 300
    wildcards: BUSCO=EOG091G074G
    threads: 2


        cd per_gene/EOG091G074G
	count=$(cat ../../per_gene/EOG091G074G/ALICUT_EOG091G074G.clustalo.fasta | grep ">" | wc -l)
	if [ "$count" -gt 5 ]
        then
		RAxMLmodel=$(cat ../../per_gene/EOG091G074G/EOG091G074G.best_model | grep "Best" | cut -d ":" -f 2 | tr -d '[:space:]')
                if [ "$(ls -1 | grep "^RAxML" | wc -l)" -ne 0 ]
		then
			rm RAxML*
		fi
        	raxml -f a -T 2 -m PROTGAMMA$RAxMLmodel         	-p 12345 -x 12345 -# 100         	-s ../../per_gene/EOG091G074G/ALICUT_EOG091G074G.clustalo.fasta -n EOG091G074G.clustalo.aln.ALICUT.$RAxMLmodel 		1> ../../per_gene/EOG091G074G/infer_single_ML.stdout.txt 2> ../../per_gene/EOG091G074G/infer_single_ML.stderr.txt
	else
		echo "fasta file per_gene/EOG091G074G/ALICUT_EOG091G074G.clustalo.fasta contains fewer than 5 sequences - skipped" > ../../per_gene/EOG091G074G/infer_single_ML.stdout.txt
		touch raxml.skipped
	fi
        touch ../../per_gene/EOG091G074G/EOG091G074G.raxml.done
        
[33mJob counts:
	count	jobs
	1	infer_single_ML
	1[0m
[33m
        cd per_gene/EOG091G074G
	count=$(cat ../../per_gene/EOG091G074G/ALICUT_EOG091G074G.clustalo.fasta | grep ">" | wc -l)
	if [ "$count" -gt 5 ]
        then
		RAxMLmodel=$(cat ../../per_gene/EOG091G074G/EOG091G074G.best_model | grep "Best" | cut -d ":" -f 2 | tr -d '[:space:]')
                if [ "$(ls -1 | grep "^RAxML" | wc -l)" -ne 0 ]
		then
			rm RAxML*
		fi
        	raxml -f a -T 2 -m PROTGAMMA$RAxMLmodel         	-p 12345 -x 12345 -# 100         	-s ../../per_gene/EOG091G074G/ALICUT_EOG091G074G.clustalo.fasta -n EOG091G074G.clustalo.aln.ALICUT.$RAxMLmodel 		1> ../../per_gene/EOG091G074G/infer_single_ML.stdout.txt 2> ../../per_gene/EOG091G074G/infer_single_ML.stderr.txt
	else
		echo "fasta file per_gene/EOG091G074G/ALICUT_EOG091G074G.clustalo.fasta contains fewer than 5 sequences - skipped" > ../../per_gene/EOG091G074G/infer_single_ML.stdout.txt
		touch raxml.skipped
	fi
        touch ../../per_gene/EOG091G074G/EOG091G074G.raxml.done
        [0m
[Sun Jul  5 21:57:50 2020]
Finished job 283.
537 of 3292 steps (16%) done

[Sun Jul  5 21:57:50 2020]
rule get_seqs:
    input: /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ingroup.txt, /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/outgroup.txt
    output: per_gene/EOG091G02LY/EOG091G02LY.ingroup.fasta
    log: per_gene/EOG091G02LY/get_seqs.stdout.txt, per_gene/EOG091G02LY/get_seqs.stderr.txt
    jobid: 2492
    wildcards: BUSCO=EOG091G02LY
    threads: 2


	basedir=$(pwd)
        cd per_gene/EOG091G02LY
        
        bash $basedir/../scripts/fetch_seqs.sh EOG091G02LY /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ingroup.txt /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/outgroup.txt 1> ../../per_gene/EOG091G02LY/get_seqs.stdout.txt 2> ../../per_gene/EOG091G02LY/get_seqs.stderr.txt
	mv EOG091G02LY.fasta $basedir/per_gene/EOG091G02LY/EOG091G02LY.ingroup.fasta
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/72476f9d9a5bd0627b4d721143a21354.simg
[Sun Jul  5 21:58:04 2020]
Finished job 2492.
538 of 3292 steps (16%) done

[Sun Jul  5 21:58:04 2020]
rule get_outgroups:
    input: per_gene/EOG091G02LY/EOG091G02LY.ingroup.fasta
    output: per_gene/EOG091G02LY/EOG091G02LY.orthodb.fasta, per_gene/EOG091G02LY/EOG091G02LY.outgroup.fasta
    log: per_gene/EOG091G02LY/get_outgroups.stdout.txt, per_gene/EOG091G02LY/get_outgroups.stderr.txt
    jobid: 2493
    wildcards: BUSCO=EOG091G02LY


        #download fastas from Orhtodb for BUSCO id
        for i in {1..5}
        do
             wget "http://www.orthodb.org/fasta?query=EOG091G02LY&level=33208" -O per_gene/EOG091G02LY/EOG091G02LY.orthodb.fasta 1> per_gene/EOG091G02LY/get_outgroups.stdout.txt 2> per_gene/EOG091G02LY/get_outgroups.stderr.txt && break || echo -e "try again ($i)" && sleep 15
        done

	#This is quick an dirty for now and just takes the first protein if there is more than one for an outgroup taxon
        bash ../scripts/download_outgroups.sh taxids.txt per_gene/EOG091G02LY/EOG091G02LY.orthodb.fasta > per_gene/EOG091G02LY/EOG091G02LY.outgroup.fasta
        
[Sun Jul  5 21:58:05 2020]
Finished job 2493.
539 of 3292 steps (16%) done

[Sun Jul  5 21:58:05 2020]
rule join_groups:
    input: per_gene/EOG091G02LY/EOG091G02LY.ingroup.fasta, per_gene/EOG091G02LY/EOG091G02LY.outgroup.fasta
    output: per_gene/EOG091G02LY/EOG091G02LY.fasta
    jobid: 2070
    wildcards: BUSCO=EOG091G02LY


        cat per_gene/EOG091G02LY/EOG091G02LY.ingroup.fasta per_gene/EOG091G02LY/EOG091G02LY.outgroup.fasta > per_gene/EOG091G02LY/EOG091G02LY.fasta
        
[Sun Jul  5 21:58:05 2020]
Finished job 2070.
540 of 3292 steps (16%) done

[Sun Jul  5 21:58:05 2020]
rule MSA:
    input: per_gene/EOG091G02LY/EOG091G02LY.fasta
    output: per_gene/EOG091G02LY/EOG091G02LY.clustalo.fasta
    log: per_gene/EOG091G02LY/MSA.stdout.txt, per_gene/EOG091G02LY/MSA.stderr.txt
    jobid: 1260
    wildcards: BUSCO=EOG091G02LY
    threads: 2


        clustalo -i per_gene/EOG091G02LY/EOG091G02LY.fasta -o per_gene/EOG091G02LY/EOG091G02LY.clustalo.fasta --threads=2 1> per_gene/EOG091G02LY/MSA.stdout.txt 2> per_gene/EOG091G02LY/MSA.stderr.txt
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/d68c9691725a7401923680874285c430.simg
[Sun Jul  5 21:58:08 2020]
Finished job 1260.
541 of 3292 steps (16%) done

[Sun Jul  5 21:58:08 2020]
rule score_and_cut:
    input: per_gene/EOG091G02LY/EOG091G02LY.clustalo.fasta
    output: per_gene/EOG091G02LY/ALICUT_EOG091G02LY.clustalo.fasta
    jobid: 437
    wildcards: BUSCO=EOG091G02LY
    threads: 2


        cd per_gene/EOG091G02LY
        Aliscore.pl -N -r 200000000000000000 -i ../../per_gene/EOG091G02LY/EOG091G02LY.clustalo.fasta &> aliscore.log
        ALICUT.pl -s &> alicut.log
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/63c88c27a0fa300f57066b0ef65fefcb.simg
[Sun Jul  5 21:58:19 2020]
Finished job 437.
542 of 3292 steps (16%) done

[Sun Jul  5 21:58:19 2020]
rule remove_empty:
    input: per_gene/EOG091G02LY/ALICUT_EOG091G02LY.clustalo.fasta
    output: per_gene/EOG091G02LY/empty_check.done
    jobid: 1259
    wildcards: BUSCO=EOG091G02LY


         if [ "$(cat per_gene/EOG091G02LY/ALICUT_EOG091G02LY.clustalo.fasta | grep -v ">" | sed 's/-//g' | grep "^$" | wc -l)" -gt 0 ]
         then
              cp per_gene/EOG091G02LY/ALICUT_EOG091G02LY.clustalo.fasta per_gene/EOG091G02LY/ALICUT_EOG091G02LY.clustalo.fasta.backup
              bash ../scripts/remove_empty.sh per_gene/EOG091G02LY/ALICUT_EOG091G02LY.clustalo.fasta.backup > per_gene/EOG091G02LY/ALICUT_EOG091G02LY.clustalo.fasta
         fi
         touch per_gene/EOG091G02LY/empty_check.done
         
[Sun Jul  5 21:58:19 2020]
Finished job 1259.
543 of 3292 steps (16%) done

[Sun Jul  5 21:58:19 2020]
rule find_best_model:
    input: per_gene/EOG091G02LY/ALICUT_EOG091G02LY.clustalo.fasta, per_gene/EOG091G02LY/empty_check.done
    output: per_gene/EOG091G02LY/EOG091G02LY.best_model
    log: per_gene/EOG091G02LY/find_best_model.stderr.txt
    jobid: 436
    wildcards: BUSCO=EOG091G02LY
    threads: 2


        cd per_gene/EOG091G02LY
        if [ ! -d find_best_model ]
        then
            mkdir find_best_model
        fi
        cd find_best_model
        ln -s ../../../per_gene/EOG091G02LY/ALICUT_EOG091G02LY.clustalo.fasta EOG091G02LY.fasta
        ProteinModelSelection.pl EOG091G02LY.fasta 1> ../../../per_gene/EOG091G02LY/EOG091G02LY.best_model 2> ../../../per_gene/EOG091G02LY/find_best_model.stderr.txt
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/c0c09ee657b1e27f2c5687e0e9aa8d70.simg
[Sun Jul  5 21:58:25 2020]
Finished job 59.
544 of 3292 steps (17%) done

[Sun Jul  5 21:58:25 2020]
rule get_seqs:
    input: /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ingroup.txt, /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/outgroup.txt
    output: per_gene/EOG091G0G6Z/EOG091G0G6Z.ingroup.fasta
    log: per_gene/EOG091G0G6Z/get_seqs.stdout.txt, per_gene/EOG091G0G6Z/get_seqs.stderr.txt
    jobid: 2684
    wildcards: BUSCO=EOG091G0G6Z
    threads: 2


	basedir=$(pwd)
        cd per_gene/EOG091G0G6Z
        
        bash $basedir/../scripts/fetch_seqs.sh EOG091G0G6Z /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ingroup.txt /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/outgroup.txt 1> ../../per_gene/EOG091G0G6Z/get_seqs.stdout.txt 2> ../../per_gene/EOG091G0G6Z/get_seqs.stderr.txt
	mv EOG091G0G6Z.fasta $basedir/per_gene/EOG091G0G6Z/EOG091G0G6Z.ingroup.fasta
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/72476f9d9a5bd0627b4d721143a21354.simg
[Sun Jul  5 21:58:38 2020]
Finished job 2684.
545 of 3292 steps (17%) done

[Sun Jul  5 21:58:38 2020]
rule get_outgroups:
    input: per_gene/EOG091G0G6Z/EOG091G0G6Z.ingroup.fasta
    output: per_gene/EOG091G0G6Z/EOG091G0G6Z.orthodb.fasta, per_gene/EOG091G0G6Z/EOG091G0G6Z.outgroup.fasta
    log: per_gene/EOG091G0G6Z/get_outgroups.stdout.txt, per_gene/EOG091G0G6Z/get_outgroups.stderr.txt
    jobid: 2685
    wildcards: BUSCO=EOG091G0G6Z


        #download fastas from Orhtodb for BUSCO id
        for i in {1..5}
        do
             wget "http://www.orthodb.org/fasta?query=EOG091G0G6Z&level=33208" -O per_gene/EOG091G0G6Z/EOG091G0G6Z.orthodb.fasta 1> per_gene/EOG091G0G6Z/get_outgroups.stdout.txt 2> per_gene/EOG091G0G6Z/get_outgroups.stderr.txt && break || echo -e "try again ($i)" && sleep 15
        done

	#This is quick an dirty for now and just takes the first protein if there is more than one for an outgroup taxon
        bash ../scripts/download_outgroups.sh taxids.txt per_gene/EOG091G0G6Z/EOG091G0G6Z.orthodb.fasta > per_gene/EOG091G0G6Z/EOG091G0G6Z.outgroup.fasta
        
[Sun Jul  5 21:58:39 2020]
Finished job 2685.
546 of 3292 steps (17%) done

[Sun Jul  5 21:58:39 2020]
rule join_groups:
    input: per_gene/EOG091G0G6Z/EOG091G0G6Z.ingroup.fasta, per_gene/EOG091G0G6Z/EOG091G0G6Z.outgroup.fasta
    output: per_gene/EOG091G0G6Z/EOG091G0G6Z.fasta
    jobid: 2166
    wildcards: BUSCO=EOG091G0G6Z


        cat per_gene/EOG091G0G6Z/EOG091G0G6Z.ingroup.fasta per_gene/EOG091G0G6Z/EOG091G0G6Z.outgroup.fasta > per_gene/EOG091G0G6Z/EOG091G0G6Z.fasta
        
[Sun Jul  5 21:58:39 2020]
Finished job 2166.
547 of 3292 steps (17%) done

[Sun Jul  5 21:58:39 2020]
rule MSA:
    input: per_gene/EOG091G0G6Z/EOG091G0G6Z.fasta
    output: per_gene/EOG091G0G6Z/EOG091G0G6Z.clustalo.fasta
    log: per_gene/EOG091G0G6Z/MSA.stdout.txt, per_gene/EOG091G0G6Z/MSA.stderr.txt
    jobid: 1452
    wildcards: BUSCO=EOG091G0G6Z
    threads: 2


        clustalo -i per_gene/EOG091G0G6Z/EOG091G0G6Z.fasta -o per_gene/EOG091G0G6Z/EOG091G0G6Z.clustalo.fasta --threads=2 1> per_gene/EOG091G0G6Z/MSA.stdout.txt 2> per_gene/EOG091G0G6Z/MSA.stderr.txt
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/d68c9691725a7401923680874285c430.simg
[Sun Jul  5 21:58:40 2020]
Finished job 1452.
548 of 3292 steps (17%) done

[Sun Jul  5 21:58:40 2020]
rule score_and_cut:
    input: per_gene/EOG091G0G6Z/EOG091G0G6Z.clustalo.fasta
    output: per_gene/EOG091G0G6Z/ALICUT_EOG091G0G6Z.clustalo.fasta
    jobid: 629
    wildcards: BUSCO=EOG091G0G6Z
    threads: 2


        cd per_gene/EOG091G0G6Z
        Aliscore.pl -N -r 200000000000000000 -i ../../per_gene/EOG091G0G6Z/EOG091G0G6Z.clustalo.fasta &> aliscore.log
        ALICUT.pl -s &> alicut.log
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/63c88c27a0fa300f57066b0ef65fefcb.simg
[Sun Jul  5 21:58:42 2020]
Finished job 147.
549 of 3292 steps (17%) done

[Sun Jul  5 21:58:42 2020]
rule get_seqs:
    input: /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ingroup.txt, /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/outgroup.txt
    output: per_gene/EOG091G0RR3/EOG091G0RR3.ingroup.fasta
    log: per_gene/EOG091G0RR3/get_seqs.stdout.txt, per_gene/EOG091G0RR3/get_seqs.stderr.txt
    jobid: 2836
    wildcards: BUSCO=EOG091G0RR3
    threads: 2


	basedir=$(pwd)
        cd per_gene/EOG091G0RR3
        
        bash $basedir/../scripts/fetch_seqs.sh EOG091G0RR3 /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ingroup.txt /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/outgroup.txt 1> ../../per_gene/EOG091G0RR3/get_seqs.stdout.txt 2> ../../per_gene/EOG091G0RR3/get_seqs.stderr.txt
	mv EOG091G0RR3.fasta $basedir/per_gene/EOG091G0RR3/EOG091G0RR3.ingroup.fasta
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/72476f9d9a5bd0627b4d721143a21354.simg
[Sun Jul  5 21:58:51 2020]
Finished job 629.
550 of 3292 steps (17%) done

[Sun Jul  5 21:58:51 2020]
rule remove_empty:
    input: per_gene/EOG091G0G6Z/ALICUT_EOG091G0G6Z.clustalo.fasta
    output: per_gene/EOG091G0G6Z/empty_check.done
    jobid: 1451
    wildcards: BUSCO=EOG091G0G6Z


         if [ "$(cat per_gene/EOG091G0G6Z/ALICUT_EOG091G0G6Z.clustalo.fasta | grep -v ">" | sed 's/-//g' | grep "^$" | wc -l)" -gt 0 ]
         then
              cp per_gene/EOG091G0G6Z/ALICUT_EOG091G0G6Z.clustalo.fasta per_gene/EOG091G0G6Z/ALICUT_EOG091G0G6Z.clustalo.fasta.backup
              bash ../scripts/remove_empty.sh per_gene/EOG091G0G6Z/ALICUT_EOG091G0G6Z.clustalo.fasta.backup > per_gene/EOG091G0G6Z/ALICUT_EOG091G0G6Z.clustalo.fasta
         fi
         touch per_gene/EOG091G0G6Z/empty_check.done
         
[Sun Jul  5 21:58:51 2020]
Finished job 1451.
551 of 3292 steps (17%) done

[Sun Jul  5 21:58:51 2020]
rule find_best_model:
    input: per_gene/EOG091G0G6Z/ALICUT_EOG091G0G6Z.clustalo.fasta, per_gene/EOG091G0G6Z/empty_check.done
    output: per_gene/EOG091G0G6Z/EOG091G0G6Z.best_model
    log: per_gene/EOG091G0G6Z/find_best_model.stderr.txt
    jobid: 628
    wildcards: BUSCO=EOG091G0G6Z
    threads: 2


        cd per_gene/EOG091G0G6Z
        if [ ! -d find_best_model ]
        then
            mkdir find_best_model
        fi
        cd find_best_model
        ln -s ../../../per_gene/EOG091G0G6Z/ALICUT_EOG091G0G6Z.clustalo.fasta EOG091G0G6Z.fasta
        ProteinModelSelection.pl EOG091G0G6Z.fasta 1> ../../../per_gene/EOG091G0G6Z/EOG091G0G6Z.best_model 2> ../../../per_gene/EOG091G0G6Z/find_best_model.stderr.txt
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/c0c09ee657b1e27f2c5687e0e9aa8d70.simg
[Sun Jul  5 21:58:59 2020]
Finished job 89.
552 of 3292 steps (17%) done

[Sun Jul  5 21:58:59 2020]
rule get_seqs:
    input: /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ingroup.txt, /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/outgroup.txt
    output: per_gene/EOG091G0MCM/EOG091G0MCM.ingroup.fasta
    log: per_gene/EOG091G0MCM/get_seqs.stdout.txt, per_gene/EOG091G0MCM/get_seqs.stderr.txt
    jobid: 3000
    wildcards: BUSCO=EOG091G0MCM
    threads: 2


	basedir=$(pwd)
        cd per_gene/EOG091G0MCM
        
        bash $basedir/../scripts/fetch_seqs.sh EOG091G0MCM /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ingroup.txt /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/outgroup.txt 1> ../../per_gene/EOG091G0MCM/get_seqs.stdout.txt 2> ../../per_gene/EOG091G0MCM/get_seqs.stderr.txt
	mv EOG091G0MCM.fasta $basedir/per_gene/EOG091G0MCM/EOG091G0MCM.ingroup.fasta
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/72476f9d9a5bd0627b4d721143a21354.simg
[Sun Jul  5 21:59:00 2020]
Finished job 2836.
553 of 3292 steps (17%) done

[Sun Jul  5 21:59:00 2020]
rule get_outgroups:
    input: per_gene/EOG091G0RR3/EOG091G0RR3.ingroup.fasta
    output: per_gene/EOG091G0RR3/EOG091G0RR3.orthodb.fasta, per_gene/EOG091G0RR3/EOG091G0RR3.outgroup.fasta
    log: per_gene/EOG091G0RR3/get_outgroups.stdout.txt, per_gene/EOG091G0RR3/get_outgroups.stderr.txt
    jobid: 2837
    wildcards: BUSCO=EOG091G0RR3


        #download fastas from Orhtodb for BUSCO id
        for i in {1..5}
        do
             wget "http://www.orthodb.org/fasta?query=EOG091G0RR3&level=33208" -O per_gene/EOG091G0RR3/EOG091G0RR3.orthodb.fasta 1> per_gene/EOG091G0RR3/get_outgroups.stdout.txt 2> per_gene/EOG091G0RR3/get_outgroups.stderr.txt && break || echo -e "try again ($i)" && sleep 15
        done

	#This is quick an dirty for now and just takes the first protein if there is more than one for an outgroup taxon
        bash ../scripts/download_outgroups.sh taxids.txt per_gene/EOG091G0RR3/EOG091G0RR3.orthodb.fasta > per_gene/EOG091G0RR3/EOG091G0RR3.outgroup.fasta
        
[Sun Jul  5 21:59:01 2020]
Finished job 2837.
554 of 3292 steps (17%) done

[Sun Jul  5 21:59:01 2020]
rule join_groups:
    input: per_gene/EOG091G0RR3/EOG091G0RR3.ingroup.fasta, per_gene/EOG091G0RR3/EOG091G0RR3.outgroup.fasta
    output: per_gene/EOG091G0RR3/EOG091G0RR3.fasta
    jobid: 2242
    wildcards: BUSCO=EOG091G0RR3


        cat per_gene/EOG091G0RR3/EOG091G0RR3.ingroup.fasta per_gene/EOG091G0RR3/EOG091G0RR3.outgroup.fasta > per_gene/EOG091G0RR3/EOG091G0RR3.fasta
        
[Sun Jul  5 21:59:01 2020]
Finished job 2242.
555 of 3292 steps (17%) done

[Sun Jul  5 21:59:01 2020]
rule MSA:
    input: per_gene/EOG091G0RR3/EOG091G0RR3.fasta
    output: per_gene/EOG091G0RR3/EOG091G0RR3.clustalo.fasta
    log: per_gene/EOG091G0RR3/MSA.stdout.txt, per_gene/EOG091G0RR3/MSA.stderr.txt
    jobid: 1604
    wildcards: BUSCO=EOG091G0RR3
    threads: 2


        clustalo -i per_gene/EOG091G0RR3/EOG091G0RR3.fasta -o per_gene/EOG091G0RR3/EOG091G0RR3.clustalo.fasta --threads=2 1> per_gene/EOG091G0RR3/MSA.stdout.txt 2> per_gene/EOG091G0RR3/MSA.stderr.txt
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/d68c9691725a7401923680874285c430.simg
[Sun Jul  5 21:59:01 2020]
Finished job 1604.
556 of 3292 steps (17%) done

[Sun Jul  5 21:59:02 2020]
rule score_and_cut:
    input: per_gene/EOG091G0RR3/EOG091G0RR3.clustalo.fasta
    output: per_gene/EOG091G0RR3/ALICUT_EOG091G0RR3.clustalo.fasta
    jobid: 781
    wildcards: BUSCO=EOG091G0RR3
    threads: 2


        cd per_gene/EOG091G0RR3
        Aliscore.pl -N -r 200000000000000000 -i ../../per_gene/EOG091G0RR3/EOG091G0RR3.clustalo.fasta &> aliscore.log
        ALICUT.pl -s &> alicut.log
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/63c88c27a0fa300f57066b0ef65fefcb.simg
[Sun Jul  5 21:59:07 2020]
Finished job 401.
557 of 3292 steps (17%) done

[Sun Jul  5 21:59:07 2020]
rule get_seqs:
    input: /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ingroup.txt, /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/outgroup.txt
    output: per_gene/EOG091G065D/EOG091G065D.ingroup.fasta
    log: per_gene/EOG091G065D/get_seqs.stdout.txt, per_gene/EOG091G065D/get_seqs.stderr.txt
    jobid: 3062
    wildcards: BUSCO=EOG091G065D
    threads: 2


	basedir=$(pwd)
        cd per_gene/EOG091G065D
        
        bash $basedir/../scripts/fetch_seqs.sh EOG091G065D /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ingroup.txt /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/outgroup.txt 1> ../../per_gene/EOG091G065D/get_seqs.stdout.txt 2> ../../per_gene/EOG091G065D/get_seqs.stderr.txt
	mv EOG091G065D.fasta $basedir/per_gene/EOG091G065D/EOG091G065D.ingroup.fasta
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/72476f9d9a5bd0627b4d721143a21354.simg
[Sun Jul  5 21:59:10 2020]
Finished job 3000.
558 of 3292 steps (17%) done

[Sun Jul  5 21:59:10 2020]
rule get_outgroups:
    input: per_gene/EOG091G0MCM/EOG091G0MCM.ingroup.fasta
    output: per_gene/EOG091G0MCM/EOG091G0MCM.orthodb.fasta, per_gene/EOG091G0MCM/EOG091G0MCM.outgroup.fasta
    log: per_gene/EOG091G0MCM/get_outgroups.stdout.txt, per_gene/EOG091G0MCM/get_outgroups.stderr.txt
    jobid: 3001
    wildcards: BUSCO=EOG091G0MCM


        #download fastas from Orhtodb for BUSCO id
        for i in {1..5}
        do
             wget "http://www.orthodb.org/fasta?query=EOG091G0MCM&level=33208" -O per_gene/EOG091G0MCM/EOG091G0MCM.orthodb.fasta 1> per_gene/EOG091G0MCM/get_outgroups.stdout.txt 2> per_gene/EOG091G0MCM/get_outgroups.stderr.txt && break || echo -e "try again ($i)" && sleep 15
        done

	#This is quick an dirty for now and just takes the first protein if there is more than one for an outgroup taxon
        bash ../scripts/download_outgroups.sh taxids.txt per_gene/EOG091G0MCM/EOG091G0MCM.orthodb.fasta > per_gene/EOG091G0MCM/EOG091G0MCM.outgroup.fasta
        
[Sun Jul  5 21:59:11 2020]
Finished job 3001.
559 of 3292 steps (17%) done

[Sun Jul  5 21:59:11 2020]
rule join_groups:
    input: per_gene/EOG091G0MCM/EOG091G0MCM.ingroup.fasta, per_gene/EOG091G0MCM/EOG091G0MCM.outgroup.fasta
    output: per_gene/EOG091G0MCM/EOG091G0MCM.fasta
    jobid: 2324
    wildcards: BUSCO=EOG091G0MCM


        cat per_gene/EOG091G0MCM/EOG091G0MCM.ingroup.fasta per_gene/EOG091G0MCM/EOG091G0MCM.outgroup.fasta > per_gene/EOG091G0MCM/EOG091G0MCM.fasta
        
[Sun Jul  5 21:59:11 2020]
Finished job 2324.
560 of 3292 steps (17%) done

[Sun Jul  5 21:59:11 2020]
rule MSA:
    input: per_gene/EOG091G0MCM/EOG091G0MCM.fasta
    output: per_gene/EOG091G0MCM/EOG091G0MCM.clustalo.fasta
    log: per_gene/EOG091G0MCM/MSA.stdout.txt, per_gene/EOG091G0MCM/MSA.stderr.txt
    jobid: 1768
    wildcards: BUSCO=EOG091G0MCM
    threads: 2


        clustalo -i per_gene/EOG091G0MCM/EOG091G0MCM.fasta -o per_gene/EOG091G0MCM/EOG091G0MCM.clustalo.fasta --threads=2 1> per_gene/EOG091G0MCM/MSA.stdout.txt 2> per_gene/EOG091G0MCM/MSA.stderr.txt
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/d68c9691725a7401923680874285c430.simg
[Sun Jul  5 21:59:12 2020]
Finished job 1768.
561 of 3292 steps (17%) done

[Sun Jul  5 21:59:12 2020]
rule score_and_cut:
    input: per_gene/EOG091G0MCM/EOG091G0MCM.clustalo.fasta
    output: per_gene/EOG091G0MCM/ALICUT_EOG091G0MCM.clustalo.fasta
    jobid: 945
    wildcards: BUSCO=EOG091G0MCM
    threads: 2


        cd per_gene/EOG091G0MCM
        Aliscore.pl -N -r 200000000000000000 -i ../../per_gene/EOG091G0MCM/EOG091G0MCM.clustalo.fasta &> aliscore.log
        ALICUT.pl -s &> alicut.log
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/63c88c27a0fa300f57066b0ef65fefcb.simg
[Sun Jul  5 21:59:12 2020]
Finished job 781.
562 of 3292 steps (17%) done

[Sun Jul  5 21:59:12 2020]
rule remove_empty:
    input: per_gene/EOG091G0RR3/ALICUT_EOG091G0RR3.clustalo.fasta
    output: per_gene/EOG091G0RR3/empty_check.done
    jobid: 1603
    wildcards: BUSCO=EOG091G0RR3


         if [ "$(cat per_gene/EOG091G0RR3/ALICUT_EOG091G0RR3.clustalo.fasta | grep -v ">" | sed 's/-//g' | grep "^$" | wc -l)" -gt 0 ]
         then
              cp per_gene/EOG091G0RR3/ALICUT_EOG091G0RR3.clustalo.fasta per_gene/EOG091G0RR3/ALICUT_EOG091G0RR3.clustalo.fasta.backup
              bash ../scripts/remove_empty.sh per_gene/EOG091G0RR3/ALICUT_EOG091G0RR3.clustalo.fasta.backup > per_gene/EOG091G0RR3/ALICUT_EOG091G0RR3.clustalo.fasta
         fi
         touch per_gene/EOG091G0RR3/empty_check.done
         
[Sun Jul  5 21:59:12 2020]
Finished job 1603.
563 of 3292 steps (17%) done

[Sun Jul  5 21:59:12 2020]
rule find_best_model:
    input: per_gene/EOG091G0RR3/ALICUT_EOG091G0RR3.clustalo.fasta, per_gene/EOG091G0RR3/empty_check.done
    output: per_gene/EOG091G0RR3/EOG091G0RR3.best_model
    log: per_gene/EOG091G0RR3/find_best_model.stderr.txt
    jobid: 780
    wildcards: BUSCO=EOG091G0RR3
    threads: 2


        cd per_gene/EOG091G0RR3
        if [ ! -d find_best_model ]
        then
            mkdir find_best_model
        fi
        cd find_best_model
        ln -s ../../../per_gene/EOG091G0RR3/ALICUT_EOG091G0RR3.clustalo.fasta EOG091G0RR3.fasta
        ProteinModelSelection.pl EOG091G0RR3.fasta 1> ../../../per_gene/EOG091G0RR3/EOG091G0RR3.best_model 2> ../../../per_gene/EOG091G0RR3/find_best_model.stderr.txt
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/c0c09ee657b1e27f2c5687e0e9aa8d70.simg
[Sun Jul  5 21:59:17 2020]
Finished job 400.
564 of 3292 steps (17%) done

[Sun Jul  5 21:59:17 2020]
rule get_seqs:
    input: /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ingroup.txt, /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/outgroup.txt
    output: per_gene/EOG091G0K2R/EOG091G0K2R.ingroup.fasta
    log: per_gene/EOG091G0K2R/get_seqs.stdout.txt, per_gene/EOG091G0K2R/get_seqs.stderr.txt
    jobid: 2730
    wildcards: BUSCO=EOG091G0K2R
    threads: 2


	basedir=$(pwd)
        cd per_gene/EOG091G0K2R
        
        bash $basedir/../scripts/fetch_seqs.sh EOG091G0K2R /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ingroup.txt /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/outgroup.txt 1> ../../per_gene/EOG091G0K2R/get_seqs.stdout.txt 2> ../../per_gene/EOG091G0K2R/get_seqs.stderr.txt
	mv EOG091G0K2R.fasta $basedir/per_gene/EOG091G0K2R/EOG091G0K2R.ingroup.fasta
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/72476f9d9a5bd0627b4d721143a21354.simg
[Sun Jul  5 21:59:19 2020]
Finished job 3062.
565 of 3292 steps (17%) done

[Sun Jul  5 21:59:19 2020]
rule get_outgroups:
    input: per_gene/EOG091G065D/EOG091G065D.ingroup.fasta
    output: per_gene/EOG091G065D/EOG091G065D.orthodb.fasta, per_gene/EOG091G065D/EOG091G065D.outgroup.fasta
    log: per_gene/EOG091G065D/get_outgroups.stdout.txt, per_gene/EOG091G065D/get_outgroups.stderr.txt
    jobid: 3063
    wildcards: BUSCO=EOG091G065D


        #download fastas from Orhtodb for BUSCO id
        for i in {1..5}
        do
             wget "http://www.orthodb.org/fasta?query=EOG091G065D&level=33208" -O per_gene/EOG091G065D/EOG091G065D.orthodb.fasta 1> per_gene/EOG091G065D/get_outgroups.stdout.txt 2> per_gene/EOG091G065D/get_outgroups.stderr.txt && break || echo -e "try again ($i)" && sleep 15
        done

	#This is quick an dirty for now and just takes the first protein if there is more than one for an outgroup taxon
        bash ../scripts/download_outgroups.sh taxids.txt per_gene/EOG091G065D/EOG091G065D.orthodb.fasta > per_gene/EOG091G065D/EOG091G065D.outgroup.fasta
        
[Sun Jul  5 21:59:20 2020]
Finished job 3063.
566 of 3292 steps (17%) done

[Sun Jul  5 21:59:20 2020]
rule join_groups:
    input: per_gene/EOG091G065D/EOG091G065D.ingroup.fasta, per_gene/EOG091G065D/EOG091G065D.outgroup.fasta
    output: per_gene/EOG091G065D/EOG091G065D.fasta
    jobid: 2355
    wildcards: BUSCO=EOG091G065D


        cat per_gene/EOG091G065D/EOG091G065D.ingroup.fasta per_gene/EOG091G065D/EOG091G065D.outgroup.fasta > per_gene/EOG091G065D/EOG091G065D.fasta
        
[Sun Jul  5 21:59:20 2020]
Finished job 2355.
567 of 3292 steps (17%) done

[Sun Jul  5 21:59:20 2020]
rule MSA:
    input: per_gene/EOG091G065D/EOG091G065D.fasta
    output: per_gene/EOG091G065D/EOG091G065D.clustalo.fasta
    log: per_gene/EOG091G065D/MSA.stdout.txt, per_gene/EOG091G065D/MSA.stderr.txt
    jobid: 1830
    wildcards: BUSCO=EOG091G065D
    threads: 2


        clustalo -i per_gene/EOG091G065D/EOG091G065D.fasta -o per_gene/EOG091G065D/EOG091G065D.clustalo.fasta --threads=2 1> per_gene/EOG091G065D/MSA.stdout.txt 2> per_gene/EOG091G065D/MSA.stderr.txt
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/d68c9691725a7401923680874285c430.simg
[Sun Jul  5 21:59:22 2020]
Finished job 628.
568 of 3292 steps (17%) done

[Sun Jul  5 21:59:22 2020]
rule infer_single_ML:
    input: per_gene/EOG091G0G6Z/EOG091G0G6Z.best_model, per_gene/EOG091G0G6Z/ALICUT_EOG091G0G6Z.clustalo.fasta
    output: per_gene/EOG091G0G6Z/EOG091G0G6Z.raxml.done
    log: per_gene/EOG091G0G6Z/infer_single_ML.stdout.txt, per_gene/EOG091G0G6Z/infer_single_ML.stderr.txt
    jobid: 108
    wildcards: BUSCO=EOG091G0G6Z
    threads: 2


        cd per_gene/EOG091G0G6Z
	count=$(cat ../../per_gene/EOG091G0G6Z/ALICUT_EOG091G0G6Z.clustalo.fasta | grep ">" | wc -l)
	if [ "$count" -gt 5 ]
        then
		RAxMLmodel=$(cat ../../per_gene/EOG091G0G6Z/EOG091G0G6Z.best_model | grep "Best" | cut -d ":" -f 2 | tr -d '[:space:]')
                if [ "$(ls -1 | grep "^RAxML" | wc -l)" -ne 0 ]
		then
			rm RAxML*
		fi
        	raxml -f a -T 2 -m PROTGAMMA$RAxMLmodel         	-p 12345 -x 12345 -# 100         	-s ../../per_gene/EOG091G0G6Z/ALICUT_EOG091G0G6Z.clustalo.fasta -n EOG091G0G6Z.clustalo.aln.ALICUT.$RAxMLmodel 		1> ../../per_gene/EOG091G0G6Z/infer_single_ML.stdout.txt 2> ../../per_gene/EOG091G0G6Z/infer_single_ML.stderr.txt
	else
		echo "fasta file per_gene/EOG091G0G6Z/ALICUT_EOG091G0G6Z.clustalo.fasta contains fewer than 5 sequences - skipped" > ../../per_gene/EOG091G0G6Z/infer_single_ML.stdout.txt
		touch raxml.skipped
	fi
        touch ../../per_gene/EOG091G0G6Z/EOG091G0G6Z.raxml.done
        
[Sun Jul  5 21:59:22 2020]
Finished job 945.
569 of 3292 steps (17%) done

[Sun Jul  5 21:59:22 2020]
rule remove_empty:
    input: per_gene/EOG091G0MCM/ALICUT_EOG091G0MCM.clustalo.fasta
    output: per_gene/EOG091G0MCM/empty_check.done
    jobid: 1767
    wildcards: BUSCO=EOG091G0MCM


         if [ "$(cat per_gene/EOG091G0MCM/ALICUT_EOG091G0MCM.clustalo.fasta | grep -v ">" | sed 's/-//g' | grep "^$" | wc -l)" -gt 0 ]
         then
              cp per_gene/EOG091G0MCM/ALICUT_EOG091G0MCM.clustalo.fasta per_gene/EOG091G0MCM/ALICUT_EOG091G0MCM.clustalo.fasta.backup
              bash ../scripts/remove_empty.sh per_gene/EOG091G0MCM/ALICUT_EOG091G0MCM.clustalo.fasta.backup > per_gene/EOG091G0MCM/ALICUT_EOG091G0MCM.clustalo.fasta
         fi
         touch per_gene/EOG091G0MCM/empty_check.done
         
[Sun Jul  5 21:59:22 2020]
Finished job 1767.
570 of 3292 steps (17%) done

[Sun Jul  5 21:59:22 2020]
rule find_best_model:
    input: per_gene/EOG091G0MCM/ALICUT_EOG091G0MCM.clustalo.fasta, per_gene/EOG091G0MCM/empty_check.done
    output: per_gene/EOG091G0MCM/EOG091G0MCM.best_model
    log: per_gene/EOG091G0MCM/find_best_model.stderr.txt
    jobid: 944
    wildcards: BUSCO=EOG091G0MCM
    threads: 2


        cd per_gene/EOG091G0MCM
        if [ ! -d find_best_model ]
        then
            mkdir find_best_model
        fi
        cd find_best_model
        ln -s ../../../per_gene/EOG091G0MCM/ALICUT_EOG091G0MCM.clustalo.fasta EOG091G0MCM.fasta
        ProteinModelSelection.pl EOG091G0MCM.fasta 1> ../../../per_gene/EOG091G0MCM/EOG091G0MCM.best_model 2> ../../../per_gene/EOG091G0MCM/find_best_model.stderr.txt
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/c0c09ee657b1e27f2c5687e0e9aa8d70.simg
[33mJob counts:
	count	jobs
	1	infer_single_ML
	1[0m
[33m
        cd per_gene/EOG091G0G6Z
	count=$(cat ../../per_gene/EOG091G0G6Z/ALICUT_EOG091G0G6Z.clustalo.fasta | grep ">" | wc -l)
	if [ "$count" -gt 5 ]
        then
		RAxMLmodel=$(cat ../../per_gene/EOG091G0G6Z/EOG091G0G6Z.best_model | grep "Best" | cut -d ":" -f 2 | tr -d '[:space:]')
                if [ "$(ls -1 | grep "^RAxML" | wc -l)" -ne 0 ]
		then
			rm RAxML*
		fi
        	raxml -f a -T 2 -m PROTGAMMA$RAxMLmodel         	-p 12345 -x 12345 -# 100         	-s ../../per_gene/EOG091G0G6Z/ALICUT_EOG091G0G6Z.clustalo.fasta -n EOG091G0G6Z.clustalo.aln.ALICUT.$RAxMLmodel 		1> ../../per_gene/EOG091G0G6Z/infer_single_ML.stdout.txt 2> ../../per_gene/EOG091G0G6Z/infer_single_ML.stderr.txt
	else
		echo "fasta file per_gene/EOG091G0G6Z/ALICUT_EOG091G0G6Z.clustalo.fasta contains fewer than 5 sequences - skipped" > ../../per_gene/EOG091G0G6Z/infer_single_ML.stdout.txt
		touch raxml.skipped
	fi
        touch ../../per_gene/EOG091G0G6Z/EOG091G0G6Z.raxml.done
        [0m
[Sun Jul  5 21:59:23 2020]
Finished job 1830.
571 of 3292 steps (17%) done

[Sun Jul  5 21:59:23 2020]
rule score_and_cut:
    input: per_gene/EOG091G065D/EOG091G065D.clustalo.fasta
    output: per_gene/EOG091G065D/ALICUT_EOG091G065D.clustalo.fasta
    jobid: 1007
    wildcards: BUSCO=EOG091G065D
    threads: 2


        cd per_gene/EOG091G065D
        Aliscore.pl -N -r 200000000000000000 -i ../../per_gene/EOG091G065D/EOG091G065D.clustalo.fasta &> aliscore.log
        ALICUT.pl -s &> alicut.log
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/63c88c27a0fa300f57066b0ef65fefcb.simg
[Sun Jul  5 21:59:29 2020]
Finished job 436.
572 of 3292 steps (17%) done

[Sun Jul  5 21:59:29 2020]
rule infer_single_ML:
    input: per_gene/EOG091G02LY/EOG091G02LY.best_model, per_gene/EOG091G02LY/ALICUT_EOG091G02LY.clustalo.fasta
    output: per_gene/EOG091G02LY/EOG091G02LY.raxml.done
    log: per_gene/EOG091G02LY/infer_single_ML.stdout.txt, per_gene/EOG091G02LY/infer_single_ML.stderr.txt
    jobid: 12
    wildcards: BUSCO=EOG091G02LY
    threads: 2


        cd per_gene/EOG091G02LY
	count=$(cat ../../per_gene/EOG091G02LY/ALICUT_EOG091G02LY.clustalo.fasta | grep ">" | wc -l)
	if [ "$count" -gt 5 ]
        then
		RAxMLmodel=$(cat ../../per_gene/EOG091G02LY/EOG091G02LY.best_model | grep "Best" | cut -d ":" -f 2 | tr -d '[:space:]')
                if [ "$(ls -1 | grep "^RAxML" | wc -l)" -ne 0 ]
		then
			rm RAxML*
		fi
        	raxml -f a -T 2 -m PROTGAMMA$RAxMLmodel         	-p 12345 -x 12345 -# 100         	-s ../../per_gene/EOG091G02LY/ALICUT_EOG091G02LY.clustalo.fasta -n EOG091G02LY.clustalo.aln.ALICUT.$RAxMLmodel 		1> ../../per_gene/EOG091G02LY/infer_single_ML.stdout.txt 2> ../../per_gene/EOG091G02LY/infer_single_ML.stderr.txt
	else
		echo "fasta file per_gene/EOG091G02LY/ALICUT_EOG091G02LY.clustalo.fasta contains fewer than 5 sequences - skipped" > ../../per_gene/EOG091G02LY/infer_single_ML.stdout.txt
		touch raxml.skipped
	fi
        touch ../../per_gene/EOG091G02LY/EOG091G02LY.raxml.done
        
[33mJob counts:
	count	jobs
	1	infer_single_ML
	1[0m
[33m
        cd per_gene/EOG091G02LY
	count=$(cat ../../per_gene/EOG091G02LY/ALICUT_EOG091G02LY.clustalo.fasta | grep ">" | wc -l)
	if [ "$count" -gt 5 ]
        then
		RAxMLmodel=$(cat ../../per_gene/EOG091G02LY/EOG091G02LY.best_model | grep "Best" | cut -d ":" -f 2 | tr -d '[:space:]')
                if [ "$(ls -1 | grep "^RAxML" | wc -l)" -ne 0 ]
		then
			rm RAxML*
		fi
        	raxml -f a -T 2 -m PROTGAMMA$RAxMLmodel         	-p 12345 -x 12345 -# 100         	-s ../../per_gene/EOG091G02LY/ALICUT_EOG091G02LY.clustalo.fasta -n EOG091G02LY.clustalo.aln.ALICUT.$RAxMLmodel 		1> ../../per_gene/EOG091G02LY/infer_single_ML.stdout.txt 2> ../../per_gene/EOG091G02LY/infer_single_ML.stderr.txt
	else
		echo "fasta file per_gene/EOG091G02LY/ALICUT_EOG091G02LY.clustalo.fasta contains fewer than 5 sequences - skipped" > ../../per_gene/EOG091G02LY/infer_single_ML.stdout.txt
		touch raxml.skipped
	fi
        touch ../../per_gene/EOG091G02LY/EOG091G02LY.raxml.done
        [0m
[Sun Jul  5 21:59:33 2020]
Finished job 1007.
573 of 3292 steps (17%) done

[Sun Jul  5 21:59:33 2020]
rule remove_empty:
    input: per_gene/EOG091G065D/ALICUT_EOG091G065D.clustalo.fasta
    output: per_gene/EOG091G065D/empty_check.done
    jobid: 1829
    wildcards: BUSCO=EOG091G065D


         if [ "$(cat per_gene/EOG091G065D/ALICUT_EOG091G065D.clustalo.fasta | grep -v ">" | sed 's/-//g' | grep "^$" | wc -l)" -gt 0 ]
         then
              cp per_gene/EOG091G065D/ALICUT_EOG091G065D.clustalo.fasta per_gene/EOG091G065D/ALICUT_EOG091G065D.clustalo.fasta.backup
              bash ../scripts/remove_empty.sh per_gene/EOG091G065D/ALICUT_EOG091G065D.clustalo.fasta.backup > per_gene/EOG091G065D/ALICUT_EOG091G065D.clustalo.fasta
         fi
         touch per_gene/EOG091G065D/empty_check.done
         
[Sun Jul  5 21:59:33 2020]
Finished job 1829.
574 of 3292 steps (17%) done

[Sun Jul  5 21:59:33 2020]
rule find_best_model:
    input: per_gene/EOG091G065D/ALICUT_EOG091G065D.clustalo.fasta, per_gene/EOG091G065D/empty_check.done
    output: per_gene/EOG091G065D/EOG091G065D.best_model
    log: per_gene/EOG091G065D/find_best_model.stderr.txt
    jobid: 1006
    wildcards: BUSCO=EOG091G065D
    threads: 2


        cd per_gene/EOG091G065D
        if [ ! -d find_best_model ]
        then
            mkdir find_best_model
        fi
        cd find_best_model
        ln -s ../../../per_gene/EOG091G065D/ALICUT_EOG091G065D.clustalo.fasta EOG091G065D.fasta
        ProteinModelSelection.pl EOG091G065D.fasta 1> ../../../per_gene/EOG091G065D/EOG091G065D.best_model 2> ../../../per_gene/EOG091G065D/find_best_model.stderr.txt
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/c0c09ee657b1e27f2c5687e0e9aa8d70.simg
[Sun Jul  5 21:59:34 2020]
Finished job 2730.
575 of 3292 steps (17%) done

[Sun Jul  5 21:59:34 2020]
rule get_outgroups:
    input: per_gene/EOG091G0K2R/EOG091G0K2R.ingroup.fasta
    output: per_gene/EOG091G0K2R/EOG091G0K2R.orthodb.fasta, per_gene/EOG091G0K2R/EOG091G0K2R.outgroup.fasta
    log: per_gene/EOG091G0K2R/get_outgroups.stdout.txt, per_gene/EOG091G0K2R/get_outgroups.stderr.txt
    jobid: 2731
    wildcards: BUSCO=EOG091G0K2R


        #download fastas from Orhtodb for BUSCO id
        for i in {1..5}
        do
             wget "http://www.orthodb.org/fasta?query=EOG091G0K2R&level=33208" -O per_gene/EOG091G0K2R/EOG091G0K2R.orthodb.fasta 1> per_gene/EOG091G0K2R/get_outgroups.stdout.txt 2> per_gene/EOG091G0K2R/get_outgroups.stderr.txt && break || echo -e "try again ($i)" && sleep 15
        done

	#This is quick an dirty for now and just takes the first protein if there is more than one for an outgroup taxon
        bash ../scripts/download_outgroups.sh taxids.txt per_gene/EOG091G0K2R/EOG091G0K2R.orthodb.fasta > per_gene/EOG091G0K2R/EOG091G0K2R.outgroup.fasta
        
[Sun Jul  5 21:59:35 2020]
Finished job 279.
576 of 3292 steps (17%) done

[Sun Jul  5 21:59:35 2020]
rule get_seqs:
    input: /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ingroup.txt, /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/outgroup.txt
    output: per_gene/EOG091G0KSX/EOG091G0KSX.ingroup.fasta
    log: per_gene/EOG091G0KSX/get_seqs.stdout.txt, per_gene/EOG091G0KSX/get_seqs.stderr.txt
    jobid: 2742
    wildcards: BUSCO=EOG091G0KSX
    threads: 2


	basedir=$(pwd)
        cd per_gene/EOG091G0KSX
        
        bash $basedir/../scripts/fetch_seqs.sh EOG091G0KSX /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ingroup.txt /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/outgroup.txt 1> ../../per_gene/EOG091G0KSX/get_seqs.stdout.txt 2> ../../per_gene/EOG091G0KSX/get_seqs.stderr.txt
	mv EOG091G0KSX.fasta $basedir/per_gene/EOG091G0KSX/EOG091G0KSX.ingroup.fasta
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/72476f9d9a5bd0627b4d721143a21354.simg
[Sun Jul  5 21:59:35 2020]
Finished job 2731.
577 of 3292 steps (18%) done

[Sun Jul  5 21:59:35 2020]
rule join_groups:
    input: per_gene/EOG091G0K2R/EOG091G0K2R.ingroup.fasta, per_gene/EOG091G0K2R/EOG091G0K2R.outgroup.fasta
    output: per_gene/EOG091G0K2R/EOG091G0K2R.fasta
    jobid: 2189
    wildcards: BUSCO=EOG091G0K2R


        cat per_gene/EOG091G0K2R/EOG091G0K2R.ingroup.fasta per_gene/EOG091G0K2R/EOG091G0K2R.outgroup.fasta > per_gene/EOG091G0K2R/EOG091G0K2R.fasta
        
[Sun Jul  5 21:59:35 2020]
Finished job 2189.
578 of 3292 steps (18%) done

[Sun Jul  5 21:59:35 2020]
rule MSA:
    input: per_gene/EOG091G0K2R/EOG091G0K2R.fasta
    output: per_gene/EOG091G0K2R/EOG091G0K2R.clustalo.fasta
    log: per_gene/EOG091G0K2R/MSA.stdout.txt, per_gene/EOG091G0K2R/MSA.stderr.txt
    jobid: 1498
    wildcards: BUSCO=EOG091G0K2R
    threads: 2


        clustalo -i per_gene/EOG091G0K2R/EOG091G0K2R.fasta -o per_gene/EOG091G0K2R/EOG091G0K2R.clustalo.fasta --threads=2 1> per_gene/EOG091G0K2R/MSA.stdout.txt 2> per_gene/EOG091G0K2R/MSA.stderr.txt
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/d68c9691725a7401923680874285c430.simg
[Sun Jul  5 21:59:37 2020]
Finished job 1498.
579 of 3292 steps (18%) done

[Sun Jul  5 21:59:37 2020]
rule score_and_cut:
    input: per_gene/EOG091G0K2R/EOG091G0K2R.clustalo.fasta
    output: per_gene/EOG091G0K2R/ALICUT_EOG091G0K2R.clustalo.fasta
    jobid: 675
    wildcards: BUSCO=EOG091G0K2R
    threads: 2


        cd per_gene/EOG091G0K2R
        Aliscore.pl -N -r 200000000000000000 -i ../../per_gene/EOG091G0K2R/EOG091G0K2R.clustalo.fasta &> aliscore.log
        ALICUT.pl -s &> alicut.log
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/63c88c27a0fa300f57066b0ef65fefcb.simg
[Sun Jul  5 21:59:47 2020]
Finished job 675.
580 of 3292 steps (18%) done

[Sun Jul  5 21:59:47 2020]
rule remove_empty:
    input: per_gene/EOG091G0K2R/ALICUT_EOG091G0K2R.clustalo.fasta
    output: per_gene/EOG091G0K2R/empty_check.done
    jobid: 1497
    wildcards: BUSCO=EOG091G0K2R


         if [ "$(cat per_gene/EOG091G0K2R/ALICUT_EOG091G0K2R.clustalo.fasta | grep -v ">" | sed 's/-//g' | grep "^$" | wc -l)" -gt 0 ]
         then
              cp per_gene/EOG091G0K2R/ALICUT_EOG091G0K2R.clustalo.fasta per_gene/EOG091G0K2R/ALICUT_EOG091G0K2R.clustalo.fasta.backup
              bash ../scripts/remove_empty.sh per_gene/EOG091G0K2R/ALICUT_EOG091G0K2R.clustalo.fasta.backup > per_gene/EOG091G0K2R/ALICUT_EOG091G0K2R.clustalo.fasta
         fi
         touch per_gene/EOG091G0K2R/empty_check.done
         
[Sun Jul  5 21:59:47 2020]
Finished job 1497.
581 of 3292 steps (18%) done

[Sun Jul  5 21:59:47 2020]
rule find_best_model:
    input: per_gene/EOG091G0K2R/ALICUT_EOG091G0K2R.clustalo.fasta, per_gene/EOG091G0K2R/empty_check.done
    output: per_gene/EOG091G0K2R/EOG091G0K2R.best_model
    log: per_gene/EOG091G0K2R/find_best_model.stderr.txt
    jobid: 674
    wildcards: BUSCO=EOG091G0K2R
    threads: 2


        cd per_gene/EOG091G0K2R
        if [ ! -d find_best_model ]
        then
            mkdir find_best_model
        fi
        cd find_best_model
        ln -s ../../../per_gene/EOG091G0K2R/ALICUT_EOG091G0K2R.clustalo.fasta EOG091G0K2R.fasta
        ProteinModelSelection.pl EOG091G0K2R.fasta 1> ../../../per_gene/EOG091G0K2R/EOG091G0K2R.best_model 2> ../../../per_gene/EOG091G0K2R/find_best_model.stderr.txt
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/c0c09ee657b1e27f2c5687e0e9aa8d70.simg
[Sun Jul  5 21:59:50 2020]
Finished job 2742.
582 of 3292 steps (18%) done

[Sun Jul  5 21:59:50 2020]
rule get_outgroups:
    input: per_gene/EOG091G0KSX/EOG091G0KSX.ingroup.fasta
    output: per_gene/EOG091G0KSX/EOG091G0KSX.orthodb.fasta, per_gene/EOG091G0KSX/EOG091G0KSX.outgroup.fasta
    log: per_gene/EOG091G0KSX/get_outgroups.stdout.txt, per_gene/EOG091G0KSX/get_outgroups.stderr.txt
    jobid: 2743
    wildcards: BUSCO=EOG091G0KSX


        #download fastas from Orhtodb for BUSCO id
        for i in {1..5}
        do
             wget "http://www.orthodb.org/fasta?query=EOG091G0KSX&level=33208" -O per_gene/EOG091G0KSX/EOG091G0KSX.orthodb.fasta 1> per_gene/EOG091G0KSX/get_outgroups.stdout.txt 2> per_gene/EOG091G0KSX/get_outgroups.stderr.txt && break || echo -e "try again ($i)" && sleep 15
        done

	#This is quick an dirty for now and just takes the first protein if there is more than one for an outgroup taxon
        bash ../scripts/download_outgroups.sh taxids.txt per_gene/EOG091G0KSX/EOG091G0KSX.orthodb.fasta > per_gene/EOG091G0KSX/EOG091G0KSX.outgroup.fasta
        
[Sun Jul  5 21:59:50 2020]
Finished job 780.
583 of 3292 steps (18%) done

[Sun Jul  5 21:59:50 2020]
rule infer_single_ML:
    input: per_gene/EOG091G0RR3/EOG091G0RR3.best_model, per_gene/EOG091G0RR3/ALICUT_EOG091G0RR3.clustalo.fasta
    output: per_gene/EOG091G0RR3/EOG091G0RR3.raxml.done
    log: per_gene/EOG091G0RR3/infer_single_ML.stdout.txt, per_gene/EOG091G0RR3/infer_single_ML.stderr.txt
    jobid: 184
    wildcards: BUSCO=EOG091G0RR3
    threads: 2


        cd per_gene/EOG091G0RR3
	count=$(cat ../../per_gene/EOG091G0RR3/ALICUT_EOG091G0RR3.clustalo.fasta | grep ">" | wc -l)
	if [ "$count" -gt 5 ]
        then
		RAxMLmodel=$(cat ../../per_gene/EOG091G0RR3/EOG091G0RR3.best_model | grep "Best" | cut -d ":" -f 2 | tr -d '[:space:]')
                if [ "$(ls -1 | grep "^RAxML" | wc -l)" -ne 0 ]
		then
			rm RAxML*
		fi
        	raxml -f a -T 2 -m PROTGAMMA$RAxMLmodel         	-p 12345 -x 12345 -# 100         	-s ../../per_gene/EOG091G0RR3/ALICUT_EOG091G0RR3.clustalo.fasta -n EOG091G0RR3.clustalo.aln.ALICUT.$RAxMLmodel 		1> ../../per_gene/EOG091G0RR3/infer_single_ML.stdout.txt 2> ../../per_gene/EOG091G0RR3/infer_single_ML.stderr.txt
	else
		echo "fasta file per_gene/EOG091G0RR3/ALICUT_EOG091G0RR3.clustalo.fasta contains fewer than 5 sequences - skipped" > ../../per_gene/EOG091G0RR3/infer_single_ML.stdout.txt
		touch raxml.skipped
	fi
        touch ../../per_gene/EOG091G0RR3/EOG091G0RR3.raxml.done
        
[33mJob counts:
	count	jobs
	1	infer_single_ML
	1[0m
[33m
        cd per_gene/EOG091G0RR3
	count=$(cat ../../per_gene/EOG091G0RR3/ALICUT_EOG091G0RR3.clustalo.fasta | grep ">" | wc -l)
	if [ "$count" -gt 5 ]
        then
		RAxMLmodel=$(cat ../../per_gene/EOG091G0RR3/EOG091G0RR3.best_model | grep "Best" | cut -d ":" -f 2 | tr -d '[:space:]')
                if [ "$(ls -1 | grep "^RAxML" | wc -l)" -ne 0 ]
		then
			rm RAxML*
		fi
        	raxml -f a -T 2 -m PROTGAMMA$RAxMLmodel         	-p 12345 -x 12345 -# 100         	-s ../../per_gene/EOG091G0RR3/ALICUT_EOG091G0RR3.clustalo.fasta -n EOG091G0RR3.clustalo.aln.ALICUT.$RAxMLmodel 		1> ../../per_gene/EOG091G0RR3/infer_single_ML.stdout.txt 2> ../../per_gene/EOG091G0RR3/infer_single_ML.stderr.txt
	else
		echo "fasta file per_gene/EOG091G0RR3/ALICUT_EOG091G0RR3.clustalo.fasta contains fewer than 5 sequences - skipped" > ../../per_gene/EOG091G0RR3/infer_single_ML.stdout.txt
		touch raxml.skipped
	fi
        touch ../../per_gene/EOG091G0RR3/EOG091G0RR3.raxml.done
        [0m
[Sun Jul  5 21:59:51 2020]
Finished job 2743.
584 of 3292 steps (18%) done

[Sun Jul  5 21:59:51 2020]
rule join_groups:
    input: per_gene/EOG091G0KSX/EOG091G0KSX.ingroup.fasta, per_gene/EOG091G0KSX/EOG091G0KSX.outgroup.fasta
    output: per_gene/EOG091G0KSX/EOG091G0KSX.fasta
    jobid: 2195
    wildcards: BUSCO=EOG091G0KSX


        cat per_gene/EOG091G0KSX/EOG091G0KSX.ingroup.fasta per_gene/EOG091G0KSX/EOG091G0KSX.outgroup.fasta > per_gene/EOG091G0KSX/EOG091G0KSX.fasta
        
[Sun Jul  5 21:59:51 2020]
Finished job 2195.
585 of 3292 steps (18%) done

[Sun Jul  5 21:59:51 2020]
rule MSA:
    input: per_gene/EOG091G0KSX/EOG091G0KSX.fasta
    output: per_gene/EOG091G0KSX/EOG091G0KSX.clustalo.fasta
    log: per_gene/EOG091G0KSX/MSA.stdout.txt, per_gene/EOG091G0KSX/MSA.stderr.txt
    jobid: 1510
    wildcards: BUSCO=EOG091G0KSX
    threads: 2


        clustalo -i per_gene/EOG091G0KSX/EOG091G0KSX.fasta -o per_gene/EOG091G0KSX/EOG091G0KSX.clustalo.fasta --threads=2 1> per_gene/EOG091G0KSX/MSA.stdout.txt 2> per_gene/EOG091G0KSX/MSA.stderr.txt
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/d68c9691725a7401923680874285c430.simg
[Sun Jul  5 21:59:52 2020]
Finished job 1510.
586 of 3292 steps (18%) done

[Sun Jul  5 21:59:52 2020]
rule score_and_cut:
    input: per_gene/EOG091G0KSX/EOG091G0KSX.clustalo.fasta
    output: per_gene/EOG091G0KSX/ALICUT_EOG091G0KSX.clustalo.fasta
    jobid: 687
    wildcards: BUSCO=EOG091G0KSX
    threads: 2


        cd per_gene/EOG091G0KSX
        Aliscore.pl -N -r 200000000000000000 -i ../../per_gene/EOG091G0KSX/EOG091G0KSX.clustalo.fasta &> aliscore.log
        ALICUT.pl -s &> alicut.log
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/63c88c27a0fa300f57066b0ef65fefcb.simg
[Sun Jul  5 21:59:53 2020]
Finished job 944.
587 of 3292 steps (18%) done

[Sun Jul  5 21:59:53 2020]
rule infer_single_ML:
    input: per_gene/EOG091G0MCM/EOG091G0MCM.best_model, per_gene/EOG091G0MCM/ALICUT_EOG091G0MCM.clustalo.fasta
    output: per_gene/EOG091G0MCM/EOG091G0MCM.raxml.done
    log: per_gene/EOG091G0MCM/infer_single_ML.stdout.txt, per_gene/EOG091G0MCM/infer_single_ML.stderr.txt
    jobid: 266
    wildcards: BUSCO=EOG091G0MCM
    threads: 2


        cd per_gene/EOG091G0MCM
	count=$(cat ../../per_gene/EOG091G0MCM/ALICUT_EOG091G0MCM.clustalo.fasta | grep ">" | wc -l)
	if [ "$count" -gt 5 ]
        then
		RAxMLmodel=$(cat ../../per_gene/EOG091G0MCM/EOG091G0MCM.best_model | grep "Best" | cut -d ":" -f 2 | tr -d '[:space:]')
                if [ "$(ls -1 | grep "^RAxML" | wc -l)" -ne 0 ]
		then
			rm RAxML*
		fi
        	raxml -f a -T 2 -m PROTGAMMA$RAxMLmodel         	-p 12345 -x 12345 -# 100         	-s ../../per_gene/EOG091G0MCM/ALICUT_EOG091G0MCM.clustalo.fasta -n EOG091G0MCM.clustalo.aln.ALICUT.$RAxMLmodel 		1> ../../per_gene/EOG091G0MCM/infer_single_ML.stdout.txt 2> ../../per_gene/EOG091G0MCM/infer_single_ML.stderr.txt
	else
		echo "fasta file per_gene/EOG091G0MCM/ALICUT_EOG091G0MCM.clustalo.fasta contains fewer than 5 sequences - skipped" > ../../per_gene/EOG091G0MCM/infer_single_ML.stdout.txt
		touch raxml.skipped
	fi
        touch ../../per_gene/EOG091G0MCM/EOG091G0MCM.raxml.done
        
[33mJob counts:
	count	jobs
	1	infer_single_ML
	1[0m
[33m
        cd per_gene/EOG091G0MCM
	count=$(cat ../../per_gene/EOG091G0MCM/ALICUT_EOG091G0MCM.clustalo.fasta | grep ">" | wc -l)
	if [ "$count" -gt 5 ]
        then
		RAxMLmodel=$(cat ../../per_gene/EOG091G0MCM/EOG091G0MCM.best_model | grep "Best" | cut -d ":" -f 2 | tr -d '[:space:]')
                if [ "$(ls -1 | grep "^RAxML" | wc -l)" -ne 0 ]
		then
			rm RAxML*
		fi
        	raxml -f a -T 2 -m PROTGAMMA$RAxMLmodel         	-p 12345 -x 12345 -# 100         	-s ../../per_gene/EOG091G0MCM/ALICUT_EOG091G0MCM.clustalo.fasta -n EOG091G0MCM.clustalo.aln.ALICUT.$RAxMLmodel 		1> ../../per_gene/EOG091G0MCM/infer_single_ML.stdout.txt 2> ../../per_gene/EOG091G0MCM/infer_single_ML.stderr.txt
	else
		echo "fasta file per_gene/EOG091G0MCM/ALICUT_EOG091G0MCM.clustalo.fasta contains fewer than 5 sequences - skipped" > ../../per_gene/EOG091G0MCM/infer_single_ML.stdout.txt
		touch raxml.skipped
	fi
        touch ../../per_gene/EOG091G0MCM/EOG091G0MCM.raxml.done
        [0m
[Sun Jul  5 22:00:02 2020]
Finished job 687.
588 of 3292 steps (18%) done

[Sun Jul  5 22:00:02 2020]
rule remove_empty:
    input: per_gene/EOG091G0KSX/ALICUT_EOG091G0KSX.clustalo.fasta
    output: per_gene/EOG091G0KSX/empty_check.done
    jobid: 1509
    wildcards: BUSCO=EOG091G0KSX


         if [ "$(cat per_gene/EOG091G0KSX/ALICUT_EOG091G0KSX.clustalo.fasta | grep -v ">" | sed 's/-//g' | grep "^$" | wc -l)" -gt 0 ]
         then
              cp per_gene/EOG091G0KSX/ALICUT_EOG091G0KSX.clustalo.fasta per_gene/EOG091G0KSX/ALICUT_EOG091G0KSX.clustalo.fasta.backup
              bash ../scripts/remove_empty.sh per_gene/EOG091G0KSX/ALICUT_EOG091G0KSX.clustalo.fasta.backup > per_gene/EOG091G0KSX/ALICUT_EOG091G0KSX.clustalo.fasta
         fi
         touch per_gene/EOG091G0KSX/empty_check.done
         
[Sun Jul  5 22:00:02 2020]
Finished job 1509.
589 of 3292 steps (18%) done

[Sun Jul  5 22:00:02 2020]
rule find_best_model:
    input: per_gene/EOG091G0KSX/ALICUT_EOG091G0KSX.clustalo.fasta, per_gene/EOG091G0KSX/empty_check.done
    output: per_gene/EOG091G0KSX/EOG091G0KSX.best_model
    log: per_gene/EOG091G0KSX/find_best_model.stderr.txt
    jobid: 686
    wildcards: BUSCO=EOG091G0KSX
    threads: 2


        cd per_gene/EOG091G0KSX
        if [ ! -d find_best_model ]
        then
            mkdir find_best_model
        fi
        cd find_best_model
        ln -s ../../../per_gene/EOG091G0KSX/ALICUT_EOG091G0KSX.clustalo.fasta EOG091G0KSX.fasta
        ProteinModelSelection.pl EOG091G0KSX.fasta 1> ../../../per_gene/EOG091G0KSX/EOG091G0KSX.best_model 2> ../../../per_gene/EOG091G0KSX/find_best_model.stderr.txt
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/c0c09ee657b1e27f2c5687e0e9aa8d70.simg
[Sun Jul  5 22:00:02 2020]
Finished job 195.
590 of 3292 steps (18%) done

[Sun Jul  5 22:00:02 2020]
rule get_seqs:
    input: /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ingroup.txt, /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/outgroup.txt
    output: per_gene/EOG091G0PHL/EOG091G0PHL.ingroup.fasta
    log: per_gene/EOG091G0PHL/get_seqs.stdout.txt, per_gene/EOG091G0PHL/get_seqs.stderr.txt
    jobid: 2804
    wildcards: BUSCO=EOG091G0PHL
    threads: 2


	basedir=$(pwd)
        cd per_gene/EOG091G0PHL
        
        bash $basedir/../scripts/fetch_seqs.sh EOG091G0PHL /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ingroup.txt /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/outgroup.txt 1> ../../per_gene/EOG091G0PHL/get_seqs.stdout.txt 2> ../../per_gene/EOG091G0PHL/get_seqs.stderr.txt
	mv EOG091G0PHL.fasta $basedir/per_gene/EOG091G0PHL/EOG091G0PHL.ingroup.fasta
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/72476f9d9a5bd0627b4d721143a21354.simg
[Sun Jul  5 22:00:03 2020]
Finished job 1.
591 of 3292 steps (18%) done

[Sun Jul  5 22:00:03 2020]
rule get_seqs:
    input: /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ingroup.txt, /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/outgroup.txt
    output: per_gene/EOG091G09GO/EOG091G09GO.ingroup.fasta
    log: per_gene/EOG091G09GO/get_seqs.stdout.txt, per_gene/EOG091G09GO/get_seqs.stderr.txt
    jobid: 2604
    wildcards: BUSCO=EOG091G09GO
    threads: 2


	basedir=$(pwd)
        cd per_gene/EOG091G09GO
        
        bash $basedir/../scripts/fetch_seqs.sh EOG091G09GO /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ingroup.txt /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/outgroup.txt 1> ../../per_gene/EOG091G09GO/get_seqs.stdout.txt 2> ../../per_gene/EOG091G09GO/get_seqs.stderr.txt
	mv EOG091G09GO.fasta $basedir/per_gene/EOG091G09GO/EOG091G09GO.ingroup.fasta
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/72476f9d9a5bd0627b4d721143a21354.simg
[Sun Jul  5 22:00:10 2020]
Finished job 674.
592 of 3292 steps (18%) done

[Sun Jul  5 22:00:10 2020]
rule infer_single_ML:
    input: per_gene/EOG091G0K2R/EOG091G0K2R.best_model, per_gene/EOG091G0K2R/ALICUT_EOG091G0K2R.clustalo.fasta
    output: per_gene/EOG091G0K2R/EOG091G0K2R.raxml.done
    log: per_gene/EOG091G0K2R/infer_single_ML.stdout.txt, per_gene/EOG091G0K2R/infer_single_ML.stderr.txt
    jobid: 131
    wildcards: BUSCO=EOG091G0K2R
    threads: 2


        cd per_gene/EOG091G0K2R
	count=$(cat ../../per_gene/EOG091G0K2R/ALICUT_EOG091G0K2R.clustalo.fasta | grep ">" | wc -l)
	if [ "$count" -gt 5 ]
        then
		RAxMLmodel=$(cat ../../per_gene/EOG091G0K2R/EOG091G0K2R.best_model | grep "Best" | cut -d ":" -f 2 | tr -d '[:space:]')
                if [ "$(ls -1 | grep "^RAxML" | wc -l)" -ne 0 ]
		then
			rm RAxML*
		fi
        	raxml -f a -T 2 -m PROTGAMMA$RAxMLmodel         	-p 12345 -x 12345 -# 100         	-s ../../per_gene/EOG091G0K2R/ALICUT_EOG091G0K2R.clustalo.fasta -n EOG091G0K2R.clustalo.aln.ALICUT.$RAxMLmodel 		1> ../../per_gene/EOG091G0K2R/infer_single_ML.stdout.txt 2> ../../per_gene/EOG091G0K2R/infer_single_ML.stderr.txt
	else
		echo "fasta file per_gene/EOG091G0K2R/ALICUT_EOG091G0K2R.clustalo.fasta contains fewer than 5 sequences - skipped" > ../../per_gene/EOG091G0K2R/infer_single_ML.stdout.txt
		touch raxml.skipped
	fi
        touch ../../per_gene/EOG091G0K2R/EOG091G0K2R.raxml.done
        
[33mJob counts:
	count	jobs
	1	infer_single_ML
	1[0m
[33m
        cd per_gene/EOG091G0K2R
	count=$(cat ../../per_gene/EOG091G0K2R/ALICUT_EOG091G0K2R.clustalo.fasta | grep ">" | wc -l)
	if [ "$count" -gt 5 ]
        then
		RAxMLmodel=$(cat ../../per_gene/EOG091G0K2R/EOG091G0K2R.best_model | grep "Best" | cut -d ":" -f 2 | tr -d '[:space:]')
                if [ "$(ls -1 | grep "^RAxML" | wc -l)" -ne 0 ]
		then
			rm RAxML*
		fi
        	raxml -f a -T 2 -m PROTGAMMA$RAxMLmodel         	-p 12345 -x 12345 -# 100         	-s ../../per_gene/EOG091G0K2R/ALICUT_EOG091G0K2R.clustalo.fasta -n EOG091G0K2R.clustalo.aln.ALICUT.$RAxMLmodel 		1> ../../per_gene/EOG091G0K2R/infer_single_ML.stdout.txt 2> ../../per_gene/EOG091G0K2R/infer_single_ML.stderr.txt
	else
		echo "fasta file per_gene/EOG091G0K2R/ALICUT_EOG091G0K2R.clustalo.fasta contains fewer than 5 sequences - skipped" > ../../per_gene/EOG091G0K2R/infer_single_ML.stdout.txt
		touch raxml.skipped
	fi
        touch ../../per_gene/EOG091G0K2R/EOG091G0K2R.raxml.done
        [0m
[Sun Jul  5 22:00:14 2020]
Finished job 2804.
593 of 3292 steps (18%) done

[Sun Jul  5 22:00:14 2020]
rule get_outgroups:
    input: per_gene/EOG091G0PHL/EOG091G0PHL.ingroup.fasta
    output: per_gene/EOG091G0PHL/EOG091G0PHL.orthodb.fasta, per_gene/EOG091G0PHL/EOG091G0PHL.outgroup.fasta
    log: per_gene/EOG091G0PHL/get_outgroups.stdout.txt, per_gene/EOG091G0PHL/get_outgroups.stderr.txt
    jobid: 2805
    wildcards: BUSCO=EOG091G0PHL


        #download fastas from Orhtodb for BUSCO id
        for i in {1..5}
        do
             wget "http://www.orthodb.org/fasta?query=EOG091G0PHL&level=33208" -O per_gene/EOG091G0PHL/EOG091G0PHL.orthodb.fasta 1> per_gene/EOG091G0PHL/get_outgroups.stdout.txt 2> per_gene/EOG091G0PHL/get_outgroups.stderr.txt && break || echo -e "try again ($i)" && sleep 15
        done

	#This is quick an dirty for now and just takes the first protein if there is more than one for an outgroup taxon
        bash ../scripts/download_outgroups.sh taxids.txt per_gene/EOG091G0PHL/EOG091G0PHL.orthodb.fasta > per_gene/EOG091G0PHL/EOG091G0PHL.outgroup.fasta
        
[Sun Jul  5 22:00:14 2020]
Finished job 2604.
594 of 3292 steps (18%) done

[Sun Jul  5 22:00:14 2020]
rule get_seqs:
    input: /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ingroup.txt, /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/outgroup.txt
    output: per_gene/EOG091G0RRN/EOG091G0RRN.ingroup.fasta
    log: per_gene/EOG091G0RRN/get_seqs.stdout.txt, per_gene/EOG091G0RRN/get_seqs.stderr.txt
    jobid: 3018
    wildcards: BUSCO=EOG091G0RRN
    threads: 2


	basedir=$(pwd)
        cd per_gene/EOG091G0RRN
        
        bash $basedir/../scripts/fetch_seqs.sh EOG091G0RRN /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ingroup.txt /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/outgroup.txt 1> ../../per_gene/EOG091G0RRN/get_seqs.stdout.txt 2> ../../per_gene/EOG091G0RRN/get_seqs.stderr.txt
	mv EOG091G0RRN.fasta $basedir/per_gene/EOG091G0RRN/EOG091G0RRN.ingroup.fasta
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/72476f9d9a5bd0627b4d721143a21354.simg

[Sun Jul  5 22:00:14 2020]
rule get_outgroups:
    input: per_gene/EOG091G09GO/EOG091G09GO.ingroup.fasta
    output: per_gene/EOG091G09GO/EOG091G09GO.orthodb.fasta, per_gene/EOG091G09GO/EOG091G09GO.outgroup.fasta
    log: per_gene/EOG091G09GO/get_outgroups.stdout.txt, per_gene/EOG091G09GO/get_outgroups.stderr.txt
    jobid: 2605
    wildcards: BUSCO=EOG091G09GO


        #download fastas from Orhtodb for BUSCO id
        for i in {1..5}
        do
             wget "http://www.orthodb.org/fasta?query=EOG091G09GO&level=33208" -O per_gene/EOG091G09GO/EOG091G09GO.orthodb.fasta 1> per_gene/EOG091G09GO/get_outgroups.stdout.txt 2> per_gene/EOG091G09GO/get_outgroups.stderr.txt && break || echo -e "try again ($i)" && sleep 15
        done

	#This is quick an dirty for now and just takes the first protein if there is more than one for an outgroup taxon
        bash ../scripts/download_outgroups.sh taxids.txt per_gene/EOG091G09GO/EOG091G09GO.orthodb.fasta > per_gene/EOG091G09GO/EOG091G09GO.outgroup.fasta
        
[Sun Jul  5 22:00:16 2020]
Finished job 2805.
595 of 3292 steps (18%) done

[Sun Jul  5 22:00:16 2020]
rule join_groups:
    input: per_gene/EOG091G0PHL/EOG091G0PHL.ingroup.fasta, per_gene/EOG091G0PHL/EOG091G0PHL.outgroup.fasta
    output: per_gene/EOG091G0PHL/EOG091G0PHL.fasta
    jobid: 2226
    wildcards: BUSCO=EOG091G0PHL


        cat per_gene/EOG091G0PHL/EOG091G0PHL.ingroup.fasta per_gene/EOG091G0PHL/EOG091G0PHL.outgroup.fasta > per_gene/EOG091G0PHL/EOG091G0PHL.fasta
        
[Sun Jul  5 22:00:16 2020]
Finished job 2226.
596 of 3292 steps (18%) done
[Sun Jul  5 22:00:16 2020]
Finished job 1006.
597 of 3292 steps (18%) done

[Sun Jul  5 22:00:16 2020]
rule infer_single_ML:
    input: per_gene/EOG091G065D/EOG091G065D.best_model, per_gene/EOG091G065D/ALICUT_EOG091G065D.clustalo.fasta
    output: per_gene/EOG091G065D/EOG091G065D.raxml.done
    log: per_gene/EOG091G065D/infer_single_ML.stdout.txt, per_gene/EOG091G065D/infer_single_ML.stderr.txt
    jobid: 297
    wildcards: BUSCO=EOG091G065D
    threads: 2


        cd per_gene/EOG091G065D
	count=$(cat ../../per_gene/EOG091G065D/ALICUT_EOG091G065D.clustalo.fasta | grep ">" | wc -l)
	if [ "$count" -gt 5 ]
        then
		RAxMLmodel=$(cat ../../per_gene/EOG091G065D/EOG091G065D.best_model | grep "Best" | cut -d ":" -f 2 | tr -d '[:space:]')
                if [ "$(ls -1 | grep "^RAxML" | wc -l)" -ne 0 ]
		then
			rm RAxML*
		fi
        	raxml -f a -T 2 -m PROTGAMMA$RAxMLmodel         	-p 12345 -x 12345 -# 100         	-s ../../per_gene/EOG091G065D/ALICUT_EOG091G065D.clustalo.fasta -n EOG091G065D.clustalo.aln.ALICUT.$RAxMLmodel 		1> ../../per_gene/EOG091G065D/infer_single_ML.stdout.txt 2> ../../per_gene/EOG091G065D/infer_single_ML.stderr.txt
	else
		echo "fasta file per_gene/EOG091G065D/ALICUT_EOG091G065D.clustalo.fasta contains fewer than 5 sequences - skipped" > ../../per_gene/EOG091G065D/infer_single_ML.stdout.txt
		touch raxml.skipped
	fi
        touch ../../per_gene/EOG091G065D/EOG091G065D.raxml.done
        
[Sun Jul  5 22:00:17 2020]
Finished job 2605.
598 of 3292 steps (18%) done

[Sun Jul  5 22:00:17 2020]
rule join_groups:
    input: per_gene/EOG091G09GO/EOG091G09GO.ingroup.fasta, per_gene/EOG091G09GO/EOG091G09GO.outgroup.fasta
    output: per_gene/EOG091G09GO/EOG091G09GO.fasta
    jobid: 2126
    wildcards: BUSCO=EOG091G09GO


        cat per_gene/EOG091G09GO/EOG091G09GO.ingroup.fasta per_gene/EOG091G09GO/EOG091G09GO.outgroup.fasta > per_gene/EOG091G09GO/EOG091G09GO.fasta
        
[Sun Jul  5 22:00:17 2020]
Finished job 2126.
599 of 3292 steps (18%) done

[Sun Jul  5 22:00:17 2020]
rule MSA:
    input: per_gene/EOG091G09GO/EOG091G09GO.fasta
    output: per_gene/EOG091G09GO/EOG091G09GO.clustalo.fasta
    log: per_gene/EOG091G09GO/MSA.stdout.txt, per_gene/EOG091G09GO/MSA.stderr.txt
    jobid: 1372
    wildcards: BUSCO=EOG091G09GO
    threads: 2


        clustalo -i per_gene/EOG091G09GO/EOG091G09GO.fasta -o per_gene/EOG091G09GO/EOG091G09GO.clustalo.fasta --threads=2 1> per_gene/EOG091G09GO/MSA.stdout.txt 2> per_gene/EOG091G09GO/MSA.stderr.txt
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/d68c9691725a7401923680874285c430.simg
[33mJob counts:
	count	jobs
	1	infer_single_ML
	1[0m
[33m
        cd per_gene/EOG091G065D
	count=$(cat ../../per_gene/EOG091G065D/ALICUT_EOG091G065D.clustalo.fasta | grep ">" | wc -l)
	if [ "$count" -gt 5 ]
        then
		RAxMLmodel=$(cat ../../per_gene/EOG091G065D/EOG091G065D.best_model | grep "Best" | cut -d ":" -f 2 | tr -d '[:space:]')
                if [ "$(ls -1 | grep "^RAxML" | wc -l)" -ne 0 ]
		then
			rm RAxML*
		fi
        	raxml -f a -T 2 -m PROTGAMMA$RAxMLmodel         	-p 12345 -x 12345 -# 100         	-s ../../per_gene/EOG091G065D/ALICUT_EOG091G065D.clustalo.fasta -n EOG091G065D.clustalo.aln.ALICUT.$RAxMLmodel 		1> ../../per_gene/EOG091G065D/infer_single_ML.stdout.txt 2> ../../per_gene/EOG091G065D/infer_single_ML.stderr.txt
	else
		echo "fasta file per_gene/EOG091G065D/ALICUT_EOG091G065D.clustalo.fasta contains fewer than 5 sequences - skipped" > ../../per_gene/EOG091G065D/infer_single_ML.stdout.txt
		touch raxml.skipped
	fi
        touch ../../per_gene/EOG091G065D/EOG091G065D.raxml.done
        [0m
[Sun Jul  5 22:00:19 2020]
Finished job 1372.
600 of 3292 steps (18%) done

[Sun Jul  5 22:00:19 2020]
rule score_and_cut:
    input: per_gene/EOG091G09GO/EOG091G09GO.clustalo.fasta
    output: per_gene/EOG091G09GO/ALICUT_EOG091G09GO.clustalo.fasta
    jobid: 549
    wildcards: BUSCO=EOG091G09GO
    threads: 2


        cd per_gene/EOG091G09GO
        Aliscore.pl -N -r 200000000000000000 -i ../../per_gene/EOG091G09GO/EOG091G09GO.clustalo.fasta &> aliscore.log
        ALICUT.pl -s &> alicut.log
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/63c88c27a0fa300f57066b0ef65fefcb.simg
[Sun Jul  5 22:00:23 2020]
Finished job 3018.
601 of 3292 steps (18%) done

[Sun Jul  5 22:00:23 2020]
rule MSA:
    input: per_gene/EOG091G0PHL/EOG091G0PHL.fasta
    output: per_gene/EOG091G0PHL/EOG091G0PHL.clustalo.fasta
    log: per_gene/EOG091G0PHL/MSA.stdout.txt, per_gene/EOG091G0PHL/MSA.stderr.txt
    jobid: 1572
    wildcards: BUSCO=EOG091G0PHL
    threads: 2


        clustalo -i per_gene/EOG091G0PHL/EOG091G0PHL.fasta -o per_gene/EOG091G0PHL/EOG091G0PHL.clustalo.fasta --threads=2 1> per_gene/EOG091G0PHL/MSA.stdout.txt 2> per_gene/EOG091G0PHL/MSA.stderr.txt
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/d68c9691725a7401923680874285c430.simg
[Sun Jul  5 22:00:24 2020]
Finished job 1572.
602 of 3292 steps (18%) done
[Sun Jul  5 22:00:24 2020]
Finished job 686.
603 of 3292 steps (18%) done

[Sun Jul  5 22:00:24 2020]
rule score_and_cut:
    input: per_gene/EOG091G0PHL/EOG091G0PHL.clustalo.fasta
    output: per_gene/EOG091G0PHL/ALICUT_EOG091G0PHL.clustalo.fasta
    jobid: 749
    wildcards: BUSCO=EOG091G0PHL
    threads: 2


        cd per_gene/EOG091G0PHL
        Aliscore.pl -N -r 200000000000000000 -i ../../per_gene/EOG091G0PHL/EOG091G0PHL.clustalo.fasta &> aliscore.log
        ALICUT.pl -s &> alicut.log
        

[Sun Jul  5 22:00:24 2020]
rule infer_single_ML:
    input: per_gene/EOG091G0KSX/EOG091G0KSX.best_model, per_gene/EOG091G0KSX/ALICUT_EOG091G0KSX.clustalo.fasta
    output: per_gene/EOG091G0KSX/EOG091G0KSX.raxml.done
    log: per_gene/EOG091G0KSX/infer_single_ML.stdout.txt, per_gene/EOG091G0KSX/infer_single_ML.stderr.txt
    jobid: 137
    wildcards: BUSCO=EOG091G0KSX
    threads: 2


        cd per_gene/EOG091G0KSX
	count=$(cat ../../per_gene/EOG091G0KSX/ALICUT_EOG091G0KSX.clustalo.fasta | grep ">" | wc -l)
	if [ "$count" -gt 5 ]
        then
		RAxMLmodel=$(cat ../../per_gene/EOG091G0KSX/EOG091G0KSX.best_model | grep "Best" | cut -d ":" -f 2 | tr -d '[:space:]')
                if [ "$(ls -1 | grep "^RAxML" | wc -l)" -ne 0 ]
		then
			rm RAxML*
		fi
        	raxml -f a -T 2 -m PROTGAMMA$RAxMLmodel         	-p 12345 -x 12345 -# 100         	-s ../../per_gene/EOG091G0KSX/ALICUT_EOG091G0KSX.clustalo.fasta -n EOG091G0KSX.clustalo.aln.ALICUT.$RAxMLmodel 		1> ../../per_gene/EOG091G0KSX/infer_single_ML.stdout.txt 2> ../../per_gene/EOG091G0KSX/infer_single_ML.stderr.txt
	else
		echo "fasta file per_gene/EOG091G0KSX/ALICUT_EOG091G0KSX.clustalo.fasta contains fewer than 5 sequences - skipped" > ../../per_gene/EOG091G0KSX/infer_single_ML.stdout.txt
		touch raxml.skipped
	fi
        touch ../../per_gene/EOG091G0KSX/EOG091G0KSX.raxml.done
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/63c88c27a0fa300f57066b0ef65fefcb.simg
[Sun Jul  5 22:00:29 2020]
Finished job 549.
604 of 3292 steps (18%) done

[Sun Jul  5 22:00:29 2020]
rule get_outgroups:
    input: per_gene/EOG091G0RRN/EOG091G0RRN.ingroup.fasta
    output: per_gene/EOG091G0RRN/EOG091G0RRN.orthodb.fasta, per_gene/EOG091G0RRN/EOG091G0RRN.outgroup.fasta
    log: per_gene/EOG091G0RRN/get_outgroups.stdout.txt, per_gene/EOG091G0RRN/get_outgroups.stderr.txt
    jobid: 3019
    wildcards: BUSCO=EOG091G0RRN


        #download fastas from Orhtodb for BUSCO id
        for i in {1..5}
        do
             wget "http://www.orthodb.org/fasta?query=EOG091G0RRN&level=33208" -O per_gene/EOG091G0RRN/EOG091G0RRN.orthodb.fasta 1> per_gene/EOG091G0RRN/get_outgroups.stdout.txt 2> per_gene/EOG091G0RRN/get_outgroups.stderr.txt && break || echo -e "try again ($i)" && sleep 15
        done

	#This is quick an dirty for now and just takes the first protein if there is more than one for an outgroup taxon
        bash ../scripts/download_outgroups.sh taxids.txt per_gene/EOG091G0RRN/EOG091G0RRN.orthodb.fasta > per_gene/EOG091G0RRN/EOG091G0RRN.outgroup.fasta
        

[Sun Jul  5 22:00:29 2020]
rule remove_empty:
    input: per_gene/EOG091G09GO/ALICUT_EOG091G09GO.clustalo.fasta
    output: per_gene/EOG091G09GO/empty_check.done
    jobid: 1371
    wildcards: BUSCO=EOG091G09GO


         if [ "$(cat per_gene/EOG091G09GO/ALICUT_EOG091G09GO.clustalo.fasta | grep -v ">" | sed 's/-//g' | grep "^$" | wc -l)" -gt 0 ]
         then
              cp per_gene/EOG091G09GO/ALICUT_EOG091G09GO.clustalo.fasta per_gene/EOG091G09GO/ALICUT_EOG091G09GO.clustalo.fasta.backup
              bash ../scripts/remove_empty.sh per_gene/EOG091G09GO/ALICUT_EOG091G09GO.clustalo.fasta.backup > per_gene/EOG091G09GO/ALICUT_EOG091G09GO.clustalo.fasta
         fi
         touch per_gene/EOG091G09GO/empty_check.done
         
[Sun Jul  5 22:00:29 2020]
Finished job 1371.
605 of 3292 steps (18%) done
[Sun Jul  5 22:00:29 2020]
Finished job 3019.
606 of 3292 steps (18%) done

[Sun Jul  5 22:00:29 2020]
rule find_best_model:
    input: per_gene/EOG091G09GO/ALICUT_EOG091G09GO.clustalo.fasta, per_gene/EOG091G09GO/empty_check.done
    output: per_gene/EOG091G09GO/EOG091G09GO.best_model
    log: per_gene/EOG091G09GO/find_best_model.stderr.txt
    jobid: 548
    wildcards: BUSCO=EOG091G09GO
    threads: 2


        cd per_gene/EOG091G09GO
        if [ ! -d find_best_model ]
        then
            mkdir find_best_model
        fi
        cd find_best_model
        ln -s ../../../per_gene/EOG091G09GO/ALICUT_EOG091G09GO.clustalo.fasta EOG091G09GO.fasta
        ProteinModelSelection.pl EOG091G09GO.fasta 1> ../../../per_gene/EOG091G09GO/EOG091G09GO.best_model 2> ../../../per_gene/EOG091G09GO/find_best_model.stderr.txt
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/c0c09ee657b1e27f2c5687e0e9aa8d70.simg
[33mJob counts:
	count	jobs
	1	infer_single_ML
	1[0m
[33m
        cd per_gene/EOG091G0KSX
	count=$(cat ../../per_gene/EOG091G0KSX/ALICUT_EOG091G0KSX.clustalo.fasta | grep ">" | wc -l)
	if [ "$count" -gt 5 ]
        then
		RAxMLmodel=$(cat ../../per_gene/EOG091G0KSX/EOG091G0KSX.best_model | grep "Best" | cut -d ":" -f 2 | tr -d '[:space:]')
                if [ "$(ls -1 | grep "^RAxML" | wc -l)" -ne 0 ]
		then
			rm RAxML*
		fi
        	raxml -f a -T 2 -m PROTGAMMA$RAxMLmodel         	-p 12345 -x 12345 -# 100         	-s ../../per_gene/EOG091G0KSX/ALICUT_EOG091G0KSX.clustalo.fasta -n EOG091G0KSX.clustalo.aln.ALICUT.$RAxMLmodel 		1> ../../per_gene/EOG091G0KSX/infer_single_ML.stdout.txt 2> ../../per_gene/EOG091G0KSX/infer_single_ML.stderr.txt
	else
		echo "fasta file per_gene/EOG091G0KSX/ALICUT_EOG091G0KSX.clustalo.fasta contains fewer than 5 sequences - skipped" > ../../per_gene/EOG091G0KSX/infer_single_ML.stdout.txt
		touch raxml.skipped
	fi
        touch ../../per_gene/EOG091G0KSX/EOG091G0KSX.raxml.done
        [0m
[Sun Jul  5 22:00:34 2020]
Finished job 749.
607 of 3292 steps (18%) done

[Sun Jul  5 22:00:34 2020]
rule remove_empty:
    input: per_gene/EOG091G0PHL/ALICUT_EOG091G0PHL.clustalo.fasta
    output: per_gene/EOG091G0PHL/empty_check.done
    jobid: 1571
    wildcards: BUSCO=EOG091G0PHL


         if [ "$(cat per_gene/EOG091G0PHL/ALICUT_EOG091G0PHL.clustalo.fasta | grep -v ">" | sed 's/-//g' | grep "^$" | wc -l)" -gt 0 ]
         then
              cp per_gene/EOG091G0PHL/ALICUT_EOG091G0PHL.clustalo.fasta per_gene/EOG091G0PHL/ALICUT_EOG091G0PHL.clustalo.fasta.backup
              bash ../scripts/remove_empty.sh per_gene/EOG091G0PHL/ALICUT_EOG091G0PHL.clustalo.fasta.backup > per_gene/EOG091G0PHL/ALICUT_EOG091G0PHL.clustalo.fasta
         fi
         touch per_gene/EOG091G0PHL/empty_check.done
         

[Sun Jul  5 22:00:34 2020]
rule join_groups:
    input: per_gene/EOG091G0RRN/EOG091G0RRN.ingroup.fasta, per_gene/EOG091G0RRN/EOG091G0RRN.outgroup.fasta
    output: per_gene/EOG091G0RRN/EOG091G0RRN.fasta
    jobid: 2333
    wildcards: BUSCO=EOG091G0RRN


        cat per_gene/EOG091G0RRN/EOG091G0RRN.ingroup.fasta per_gene/EOG091G0RRN/EOG091G0RRN.outgroup.fasta > per_gene/EOG091G0RRN/EOG091G0RRN.fasta
        
[Sun Jul  5 22:00:35 2020]
Finished job 1571.
608 of 3292 steps (18%) done
[Sun Jul  5 22:00:35 2020]
Finished job 2333.
609 of 3292 steps (18%) done

[Sun Jul  5 22:00:35 2020]
rule find_best_model:
    input: per_gene/EOG091G0PHL/ALICUT_EOG091G0PHL.clustalo.fasta, per_gene/EOG091G0PHL/empty_check.done
    output: per_gene/EOG091G0PHL/EOG091G0PHL.best_model
    log: per_gene/EOG091G0PHL/find_best_model.stderr.txt
    jobid: 748
    wildcards: BUSCO=EOG091G0PHL
    threads: 2


        cd per_gene/EOG091G0PHL
        if [ ! -d find_best_model ]
        then
            mkdir find_best_model
        fi
        cd find_best_model
        ln -s ../../../per_gene/EOG091G0PHL/ALICUT_EOG091G0PHL.clustalo.fasta EOG091G0PHL.fasta
        ProteinModelSelection.pl EOG091G0PHL.fasta 1> ../../../per_gene/EOG091G0PHL/EOG091G0PHL.best_model 2> ../../../per_gene/EOG091G0PHL/find_best_model.stderr.txt
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/c0c09ee657b1e27f2c5687e0e9aa8d70.simg
[Sun Jul  5 22:01:04 2020]
Finished job 748.
610 of 3292 steps (19%) done

[Sun Jul  5 22:01:04 2020]
rule infer_single_ML:
    input: per_gene/EOG091G0PHL/EOG091G0PHL.best_model, per_gene/EOG091G0PHL/ALICUT_EOG091G0PHL.clustalo.fasta
    output: per_gene/EOG091G0PHL/EOG091G0PHL.raxml.done
    log: per_gene/EOG091G0PHL/infer_single_ML.stdout.txt, per_gene/EOG091G0PHL/infer_single_ML.stderr.txt
    jobid: 168
    wildcards: BUSCO=EOG091G0PHL
    threads: 2


        cd per_gene/EOG091G0PHL
	count=$(cat ../../per_gene/EOG091G0PHL/ALICUT_EOG091G0PHL.clustalo.fasta | grep ">" | wc -l)
	if [ "$count" -gt 5 ]
        then
		RAxMLmodel=$(cat ../../per_gene/EOG091G0PHL/EOG091G0PHL.best_model | grep "Best" | cut -d ":" -f 2 | tr -d '[:space:]')
                if [ "$(ls -1 | grep "^RAxML" | wc -l)" -ne 0 ]
		then
			rm RAxML*
		fi
        	raxml -f a -T 2 -m PROTGAMMA$RAxMLmodel         	-p 12345 -x 12345 -# 100         	-s ../../per_gene/EOG091G0PHL/ALICUT_EOG091G0PHL.clustalo.fasta -n EOG091G0PHL.clustalo.aln.ALICUT.$RAxMLmodel 		1> ../../per_gene/EOG091G0PHL/infer_single_ML.stdout.txt 2> ../../per_gene/EOG091G0PHL/infer_single_ML.stderr.txt
	else
		echo "fasta file per_gene/EOG091G0PHL/ALICUT_EOG091G0PHL.clustalo.fasta contains fewer than 5 sequences - skipped" > ../../per_gene/EOG091G0PHL/infer_single_ML.stdout.txt
		touch raxml.skipped
	fi
        touch ../../per_gene/EOG091G0PHL/EOG091G0PHL.raxml.done
        
[33mJob counts:
	count	jobs
	1	infer_single_ML
	1[0m
[33m
        cd per_gene/EOG091G0PHL
	count=$(cat ../../per_gene/EOG091G0PHL/ALICUT_EOG091G0PHL.clustalo.fasta | grep ">" | wc -l)
	if [ "$count" -gt 5 ]
        then
		RAxMLmodel=$(cat ../../per_gene/EOG091G0PHL/EOG091G0PHL.best_model | grep "Best" | cut -d ":" -f 2 | tr -d '[:space:]')
                if [ "$(ls -1 | grep "^RAxML" | wc -l)" -ne 0 ]
		then
			rm RAxML*
		fi
        	raxml -f a -T 2 -m PROTGAMMA$RAxMLmodel         	-p 12345 -x 12345 -# 100         	-s ../../per_gene/EOG091G0PHL/ALICUT_EOG091G0PHL.clustalo.fasta -n EOG091G0PHL.clustalo.aln.ALICUT.$RAxMLmodel 		1> ../../per_gene/EOG091G0PHL/infer_single_ML.stdout.txt 2> ../../per_gene/EOG091G0PHL/infer_single_ML.stderr.txt
	else
		echo "fasta file per_gene/EOG091G0PHL/ALICUT_EOG091G0PHL.clustalo.fasta contains fewer than 5 sequences - skipped" > ../../per_gene/EOG091G0PHL/infer_single_ML.stdout.txt
		touch raxml.skipped
	fi
        touch ../../per_gene/EOG091G0PHL/EOG091G0PHL.raxml.done
        [0m
[Sun Jul  5 22:01:14 2020]
Finished job 548.
611 of 3292 steps (19%) done

[Sun Jul  5 22:01:14 2020]
rule infer_single_ML:
    input: per_gene/EOG091G09GO/EOG091G09GO.best_model, per_gene/EOG091G09GO/ALICUT_EOG091G09GO.clustalo.fasta
    output: per_gene/EOG091G09GO/EOG091G09GO.raxml.done
    log: per_gene/EOG091G09GO/infer_single_ML.stdout.txt, per_gene/EOG091G09GO/infer_single_ML.stderr.txt
    jobid: 68
    wildcards: BUSCO=EOG091G09GO
    threads: 2


        cd per_gene/EOG091G09GO
	count=$(cat ../../per_gene/EOG091G09GO/ALICUT_EOG091G09GO.clustalo.fasta | grep ">" | wc -l)
	if [ "$count" -gt 5 ]
        then
		RAxMLmodel=$(cat ../../per_gene/EOG091G09GO/EOG091G09GO.best_model | grep "Best" | cut -d ":" -f 2 | tr -d '[:space:]')
                if [ "$(ls -1 | grep "^RAxML" | wc -l)" -ne 0 ]
		then
			rm RAxML*
		fi
        	raxml -f a -T 2 -m PROTGAMMA$RAxMLmodel         	-p 12345 -x 12345 -# 100         	-s ../../per_gene/EOG091G09GO/ALICUT_EOG091G09GO.clustalo.fasta -n EOG091G09GO.clustalo.aln.ALICUT.$RAxMLmodel 		1> ../../per_gene/EOG091G09GO/infer_single_ML.stdout.txt 2> ../../per_gene/EOG091G09GO/infer_single_ML.stderr.txt
	else
		echo "fasta file per_gene/EOG091G09GO/ALICUT_EOG091G09GO.clustalo.fasta contains fewer than 5 sequences - skipped" > ../../per_gene/EOG091G09GO/infer_single_ML.stdout.txt
		touch raxml.skipped
	fi
        touch ../../per_gene/EOG091G09GO/EOG091G09GO.raxml.done
        
[33mJob counts:
	count	jobs
	1	infer_single_ML
	1[0m
[33m
        cd per_gene/EOG091G09GO
	count=$(cat ../../per_gene/EOG091G09GO/ALICUT_EOG091G09GO.clustalo.fasta | grep ">" | wc -l)
	if [ "$count" -gt 5 ]
        then
		RAxMLmodel=$(cat ../../per_gene/EOG091G09GO/EOG091G09GO.best_model | grep "Best" | cut -d ":" -f 2 | tr -d '[:space:]')
                if [ "$(ls -1 | grep "^RAxML" | wc -l)" -ne 0 ]
		then
			rm RAxML*
		fi
        	raxml -f a -T 2 -m PROTGAMMA$RAxMLmodel         	-p 12345 -x 12345 -# 100         	-s ../../per_gene/EOG091G09GO/ALICUT_EOG091G09GO.clustalo.fasta -n EOG091G09GO.clustalo.aln.ALICUT.$RAxMLmodel 		1> ../../per_gene/EOG091G09GO/infer_single_ML.stdout.txt 2> ../../per_gene/EOG091G09GO/infer_single_ML.stderr.txt
	else
		echo "fasta file per_gene/EOG091G09GO/ALICUT_EOG091G09GO.clustalo.fasta contains fewer than 5 sequences - skipped" > ../../per_gene/EOG091G09GO/infer_single_ML.stdout.txt
		touch raxml.skipped
	fi
        touch ../../per_gene/EOG091G09GO/EOG091G09GO.raxml.done
        [0m
[Sun Jul  5 22:02:28 2020]
Finished job 307.
612 of 3292 steps (19%) done

[Sun Jul  5 22:02:28 2020]
rule MSA:
    input: per_gene/EOG091G0RRN/EOG091G0RRN.fasta
    output: per_gene/EOG091G0RRN/EOG091G0RRN.clustalo.fasta
    log: per_gene/EOG091G0RRN/MSA.stdout.txt, per_gene/EOG091G0RRN/MSA.stderr.txt
    jobid: 1786
    wildcards: BUSCO=EOG091G0RRN
    threads: 2


        clustalo -i per_gene/EOG091G0RRN/EOG091G0RRN.fasta -o per_gene/EOG091G0RRN/EOG091G0RRN.clustalo.fasta --threads=2 1> per_gene/EOG091G0RRN/MSA.stdout.txt 2> per_gene/EOG091G0RRN/MSA.stderr.txt
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/d68c9691725a7401923680874285c430.simg
[Sun Jul  5 22:02:28 2020]
Finished job 1786.
613 of 3292 steps (19%) done

[Sun Jul  5 22:02:28 2020]
rule score_and_cut:
    input: per_gene/EOG091G0RRN/EOG091G0RRN.clustalo.fasta
    output: per_gene/EOG091G0RRN/ALICUT_EOG091G0RRN.clustalo.fasta
    jobid: 963
    wildcards: BUSCO=EOG091G0RRN
    threads: 2


        cd per_gene/EOG091G0RRN
        Aliscore.pl -N -r 200000000000000000 -i ../../per_gene/EOG091G0RRN/EOG091G0RRN.clustalo.fasta &> aliscore.log
        ALICUT.pl -s &> alicut.log
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/63c88c27a0fa300f57066b0ef65fefcb.simg
[Sun Jul  5 22:02:38 2020]
Finished job 241.
614 of 3292 steps (19%) done

[Sun Jul  5 22:02:38 2020]
rule get_seqs:
    input: /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ingroup.txt, /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/outgroup.txt
    output: per_gene/EOG091G0IMD/EOG091G0IMD.ingroup.fasta
    log: per_gene/EOG091G0IMD/get_seqs.stdout.txt, per_gene/EOG091G0IMD/get_seqs.stderr.txt
    jobid: 2986
    wildcards: BUSCO=EOG091G0IMD
    threads: 2


	basedir=$(pwd)
        cd per_gene/EOG091G0IMD
        
        bash $basedir/../scripts/fetch_seqs.sh EOG091G0IMD /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ingroup.txt /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/outgroup.txt 1> ../../per_gene/EOG091G0IMD/get_seqs.stdout.txt 2> ../../per_gene/EOG091G0IMD/get_seqs.stderr.txt
	mv EOG091G0IMD.fasta $basedir/per_gene/EOG091G0IMD/EOG091G0IMD.ingroup.fasta
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/72476f9d9a5bd0627b4d721143a21354.simg
[Sun Jul  5 22:02:38 2020]
Finished job 963.
615 of 3292 steps (19%) done

[Sun Jul  5 22:02:38 2020]
rule remove_empty:
    input: per_gene/EOG091G0RRN/ALICUT_EOG091G0RRN.clustalo.fasta
    output: per_gene/EOG091G0RRN/empty_check.done
    jobid: 1785
    wildcards: BUSCO=EOG091G0RRN


         if [ "$(cat per_gene/EOG091G0RRN/ALICUT_EOG091G0RRN.clustalo.fasta | grep -v ">" | sed 's/-//g' | grep "^$" | wc -l)" -gt 0 ]
         then
              cp per_gene/EOG091G0RRN/ALICUT_EOG091G0RRN.clustalo.fasta per_gene/EOG091G0RRN/ALICUT_EOG091G0RRN.clustalo.fasta.backup
              bash ../scripts/remove_empty.sh per_gene/EOG091G0RRN/ALICUT_EOG091G0RRN.clustalo.fasta.backup > per_gene/EOG091G0RRN/ALICUT_EOG091G0RRN.clustalo.fasta
         fi
         touch per_gene/EOG091G0RRN/empty_check.done
         
[Sun Jul  5 22:02:38 2020]
Finished job 1785.
616 of 3292 steps (19%) done

[Sun Jul  5 22:02:38 2020]
rule find_best_model:
    input: per_gene/EOG091G0RRN/ALICUT_EOG091G0RRN.clustalo.fasta, per_gene/EOG091G0RRN/empty_check.done
    output: per_gene/EOG091G0RRN/EOG091G0RRN.best_model
    log: per_gene/EOG091G0RRN/find_best_model.stderr.txt
    jobid: 962
    wildcards: BUSCO=EOG091G0RRN
    threads: 2


        cd per_gene/EOG091G0RRN
        if [ ! -d find_best_model ]
        then
            mkdir find_best_model
        fi
        cd find_best_model
        ln -s ../../../per_gene/EOG091G0RRN/ALICUT_EOG091G0RRN.clustalo.fasta EOG091G0RRN.fasta
        ProteinModelSelection.pl EOG091G0RRN.fasta 1> ../../../per_gene/EOG091G0RRN/EOG091G0RRN.best_model 2> ../../../per_gene/EOG091G0RRN/find_best_model.stderr.txt
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/c0c09ee657b1e27f2c5687e0e9aa8d70.simg
[Sun Jul  5 22:02:49 2020]
Finished job 108.
617 of 3292 steps (19%) done

[Sun Jul  5 22:02:49 2020]
rule get_seqs:
    input: /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ingroup.txt, /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/outgroup.txt
    output: per_gene/EOG091G0HAI/EOG091G0HAI.ingroup.fasta
    log: per_gene/EOG091G0HAI/get_seqs.stdout.txt, per_gene/EOG091G0HAI/get_seqs.stderr.txt
    jobid: 2984
    wildcards: BUSCO=EOG091G0HAI
    threads: 2


	basedir=$(pwd)
        cd per_gene/EOG091G0HAI
        
        bash $basedir/../scripts/fetch_seqs.sh EOG091G0HAI /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ingroup.txt /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/outgroup.txt 1> ../../per_gene/EOG091G0HAI/get_seqs.stdout.txt 2> ../../per_gene/EOG091G0HAI/get_seqs.stderr.txt
	mv EOG091G0HAI.fasta $basedir/per_gene/EOG091G0HAI/EOG091G0HAI.ingroup.fasta
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/72476f9d9a5bd0627b4d721143a21354.simg
[Sun Jul  5 22:02:54 2020]
Finished job 2986.
618 of 3292 steps (19%) done

[Sun Jul  5 22:02:54 2020]
rule get_outgroups:
    input: per_gene/EOG091G0IMD/EOG091G0IMD.ingroup.fasta
    output: per_gene/EOG091G0IMD/EOG091G0IMD.orthodb.fasta, per_gene/EOG091G0IMD/EOG091G0IMD.outgroup.fasta
    log: per_gene/EOG091G0IMD/get_outgroups.stdout.txt, per_gene/EOG091G0IMD/get_outgroups.stderr.txt
    jobid: 2987
    wildcards: BUSCO=EOG091G0IMD


        #download fastas from Orhtodb for BUSCO id
        for i in {1..5}
        do
             wget "http://www.orthodb.org/fasta?query=EOG091G0IMD&level=33208" -O per_gene/EOG091G0IMD/EOG091G0IMD.orthodb.fasta 1> per_gene/EOG091G0IMD/get_outgroups.stdout.txt 2> per_gene/EOG091G0IMD/get_outgroups.stderr.txt && break || echo -e "try again ($i)" && sleep 15
        done

	#This is quick an dirty for now and just takes the first protein if there is more than one for an outgroup taxon
        bash ../scripts/download_outgroups.sh taxids.txt per_gene/EOG091G0IMD/EOG091G0IMD.orthodb.fasta > per_gene/EOG091G0IMD/EOG091G0IMD.outgroup.fasta
        
[Sun Jul  5 22:02:55 2020]
Finished job 2987.
619 of 3292 steps (19%) done

[Sun Jul  5 22:02:55 2020]
rule join_groups:
    input: per_gene/EOG091G0IMD/EOG091G0IMD.ingroup.fasta, per_gene/EOG091G0IMD/EOG091G0IMD.outgroup.fasta
    output: per_gene/EOG091G0IMD/EOG091G0IMD.fasta
    jobid: 2317
    wildcards: BUSCO=EOG091G0IMD


        cat per_gene/EOG091G0IMD/EOG091G0IMD.ingroup.fasta per_gene/EOG091G0IMD/EOG091G0IMD.outgroup.fasta > per_gene/EOG091G0IMD/EOG091G0IMD.fasta
        
[Sun Jul  5 22:02:55 2020]
Finished job 2317.
620 of 3292 steps (19%) done

[Sun Jul  5 22:02:55 2020]
rule MSA:
    input: per_gene/EOG091G0IMD/EOG091G0IMD.fasta
    output: per_gene/EOG091G0IMD/EOG091G0IMD.clustalo.fasta
    log: per_gene/EOG091G0IMD/MSA.stdout.txt, per_gene/EOG091G0IMD/MSA.stderr.txt
    jobid: 1754
    wildcards: BUSCO=EOG091G0IMD
    threads: 2


        clustalo -i per_gene/EOG091G0IMD/EOG091G0IMD.fasta -o per_gene/EOG091G0IMD/EOG091G0IMD.clustalo.fasta --threads=2 1> per_gene/EOG091G0IMD/MSA.stdout.txt 2> per_gene/EOG091G0IMD/MSA.stderr.txt
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/d68c9691725a7401923680874285c430.simg
[Sun Jul  5 22:02:56 2020]
Finished job 1754.
621 of 3292 steps (19%) done

[Sun Jul  5 22:02:56 2020]
rule score_and_cut:
    input: per_gene/EOG091G0IMD/EOG091G0IMD.clustalo.fasta
    output: per_gene/EOG091G0IMD/ALICUT_EOG091G0IMD.clustalo.fasta
    jobid: 931
    wildcards: BUSCO=EOG091G0IMD
    threads: 2


        cd per_gene/EOG091G0IMD
        Aliscore.pl -N -r 200000000000000000 -i ../../per_gene/EOG091G0IMD/EOG091G0IMD.clustalo.fasta &> aliscore.log
        ALICUT.pl -s &> alicut.log
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/63c88c27a0fa300f57066b0ef65fefcb.simg
[Sun Jul  5 22:03:03 2020]
Finished job 2984.
622 of 3292 steps (19%) done

[Sun Jul  5 22:03:03 2020]
rule get_outgroups:
    input: per_gene/EOG091G0HAI/EOG091G0HAI.ingroup.fasta
    output: per_gene/EOG091G0HAI/EOG091G0HAI.orthodb.fasta, per_gene/EOG091G0HAI/EOG091G0HAI.outgroup.fasta
    log: per_gene/EOG091G0HAI/get_outgroups.stdout.txt, per_gene/EOG091G0HAI/get_outgroups.stderr.txt
    jobid: 2985
    wildcards: BUSCO=EOG091G0HAI


        #download fastas from Orhtodb for BUSCO id
        for i in {1..5}
        do
             wget "http://www.orthodb.org/fasta?query=EOG091G0HAI&level=33208" -O per_gene/EOG091G0HAI/EOG091G0HAI.orthodb.fasta 1> per_gene/EOG091G0HAI/get_outgroups.stdout.txt 2> per_gene/EOG091G0HAI/get_outgroups.stderr.txt && break || echo -e "try again ($i)" && sleep 15
        done

	#This is quick an dirty for now and just takes the first protein if there is more than one for an outgroup taxon
        bash ../scripts/download_outgroups.sh taxids.txt per_gene/EOG091G0HAI/EOG091G0HAI.orthodb.fasta > per_gene/EOG091G0HAI/EOG091G0HAI.outgroup.fasta
        
[Sun Jul  5 22:03:04 2020]
Finished job 2985.
623 of 3292 steps (19%) done

[Sun Jul  5 22:03:04 2020]
rule join_groups:
    input: per_gene/EOG091G0HAI/EOG091G0HAI.ingroup.fasta, per_gene/EOG091G0HAI/EOG091G0HAI.outgroup.fasta
    output: per_gene/EOG091G0HAI/EOG091G0HAI.fasta
    jobid: 2316
    wildcards: BUSCO=EOG091G0HAI


        cat per_gene/EOG091G0HAI/EOG091G0HAI.ingroup.fasta per_gene/EOG091G0HAI/EOG091G0HAI.outgroup.fasta > per_gene/EOG091G0HAI/EOG091G0HAI.fasta
        
[Sun Jul  5 22:03:04 2020]
Finished job 2316.
624 of 3292 steps (19%) done

[Sun Jul  5 22:03:04 2020]
rule MSA:
    input: per_gene/EOG091G0HAI/EOG091G0HAI.fasta
    output: per_gene/EOG091G0HAI/EOG091G0HAI.clustalo.fasta
    log: per_gene/EOG091G0HAI/MSA.stdout.txt, per_gene/EOG091G0HAI/MSA.stderr.txt
    jobid: 1752
    wildcards: BUSCO=EOG091G0HAI
    threads: 2


        clustalo -i per_gene/EOG091G0HAI/EOG091G0HAI.fasta -o per_gene/EOG091G0HAI/EOG091G0HAI.clustalo.fasta --threads=2 1> per_gene/EOG091G0HAI/MSA.stdout.txt 2> per_gene/EOG091G0HAI/MSA.stderr.txt
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/d68c9691725a7401923680874285c430.simg
[Sun Jul  5 22:03:05 2020]
Finished job 1752.
625 of 3292 steps (19%) done

[Sun Jul  5 22:03:05 2020]
rule score_and_cut:
    input: per_gene/EOG091G0HAI/EOG091G0HAI.clustalo.fasta
    output: per_gene/EOG091G0HAI/ALICUT_EOG091G0HAI.clustalo.fasta
    jobid: 929
    wildcards: BUSCO=EOG091G0HAI
    threads: 2


        cd per_gene/EOG091G0HAI
        Aliscore.pl -N -r 200000000000000000 -i ../../per_gene/EOG091G0HAI/EOG091G0HAI.clustalo.fasta &> aliscore.log
        ALICUT.pl -s &> alicut.log
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/63c88c27a0fa300f57066b0ef65fefcb.simg
[Sun Jul  5 22:03:06 2020]
Finished job 931.
626 of 3292 steps (19%) done

[Sun Jul  5 22:03:06 2020]
rule remove_empty:
    input: per_gene/EOG091G0IMD/ALICUT_EOG091G0IMD.clustalo.fasta
    output: per_gene/EOG091G0IMD/empty_check.done
    jobid: 1753
    wildcards: BUSCO=EOG091G0IMD


         if [ "$(cat per_gene/EOG091G0IMD/ALICUT_EOG091G0IMD.clustalo.fasta | grep -v ">" | sed 's/-//g' | grep "^$" | wc -l)" -gt 0 ]
         then
              cp per_gene/EOG091G0IMD/ALICUT_EOG091G0IMD.clustalo.fasta per_gene/EOG091G0IMD/ALICUT_EOG091G0IMD.clustalo.fasta.backup
              bash ../scripts/remove_empty.sh per_gene/EOG091G0IMD/ALICUT_EOG091G0IMD.clustalo.fasta.backup > per_gene/EOG091G0IMD/ALICUT_EOG091G0IMD.clustalo.fasta
         fi
         touch per_gene/EOG091G0IMD/empty_check.done
         
[Sun Jul  5 22:03:06 2020]
Finished job 1753.
627 of 3292 steps (19%) done

[Sun Jul  5 22:03:06 2020]
rule find_best_model:
    input: per_gene/EOG091G0IMD/ALICUT_EOG091G0IMD.clustalo.fasta, per_gene/EOG091G0IMD/empty_check.done
    output: per_gene/EOG091G0IMD/EOG091G0IMD.best_model
    log: per_gene/EOG091G0IMD/find_best_model.stderr.txt
    jobid: 930
    wildcards: BUSCO=EOG091G0IMD
    threads: 2


        cd per_gene/EOG091G0IMD
        if [ ! -d find_best_model ]
        then
            mkdir find_best_model
        fi
        cd find_best_model
        ln -s ../../../per_gene/EOG091G0IMD/ALICUT_EOG091G0IMD.clustalo.fasta EOG091G0IMD.fasta
        ProteinModelSelection.pl EOG091G0IMD.fasta 1> ../../../per_gene/EOG091G0IMD/EOG091G0IMD.best_model 2> ../../../per_gene/EOG091G0IMD/find_best_model.stderr.txt
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/c0c09ee657b1e27f2c5687e0e9aa8d70.simg
[Sun Jul  5 22:03:08 2020]
Finished job 137.
628 of 3292 steps (19%) done

[Sun Jul  5 22:03:08 2020]
rule get_seqs:
    input: /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ingroup.txt, /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/outgroup.txt
    output: per_gene/EOG091G0U75/EOG091G0U75.ingroup.fasta
    log: per_gene/EOG091G0U75/get_seqs.stdout.txt, per_gene/EOG091G0U75/get_seqs.stderr.txt
    jobid: 2864
    wildcards: BUSCO=EOG091G0U75
    threads: 2


	basedir=$(pwd)
        cd per_gene/EOG091G0U75
        
        bash $basedir/../scripts/fetch_seqs.sh EOG091G0U75 /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ingroup.txt /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/outgroup.txt 1> ../../per_gene/EOG091G0U75/get_seqs.stdout.txt 2> ../../per_gene/EOG091G0U75/get_seqs.stderr.txt
	mv EOG091G0U75.fasta $basedir/per_gene/EOG091G0U75/EOG091G0U75.ingroup.fasta
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/72476f9d9a5bd0627b4d721143a21354.simg
[Sun Jul  5 22:03:09 2020]
Finished job 962.
629 of 3292 steps (19%) done

[Sun Jul  5 22:03:09 2020]
rule infer_single_ML:
    input: per_gene/EOG091G0RRN/EOG091G0RRN.best_model, per_gene/EOG091G0RRN/ALICUT_EOG091G0RRN.clustalo.fasta
    output: per_gene/EOG091G0RRN/EOG091G0RRN.raxml.done
    log: per_gene/EOG091G0RRN/infer_single_ML.stdout.txt, per_gene/EOG091G0RRN/infer_single_ML.stderr.txt
    jobid: 275
    wildcards: BUSCO=EOG091G0RRN
    threads: 2


        cd per_gene/EOG091G0RRN
	count=$(cat ../../per_gene/EOG091G0RRN/ALICUT_EOG091G0RRN.clustalo.fasta | grep ">" | wc -l)
	if [ "$count" -gt 5 ]
        then
		RAxMLmodel=$(cat ../../per_gene/EOG091G0RRN/EOG091G0RRN.best_model | grep "Best" | cut -d ":" -f 2 | tr -d '[:space:]')
                if [ "$(ls -1 | grep "^RAxML" | wc -l)" -ne 0 ]
		then
			rm RAxML*
		fi
        	raxml -f a -T 2 -m PROTGAMMA$RAxMLmodel         	-p 12345 -x 12345 -# 100         	-s ../../per_gene/EOG091G0RRN/ALICUT_EOG091G0RRN.clustalo.fasta -n EOG091G0RRN.clustalo.aln.ALICUT.$RAxMLmodel 		1> ../../per_gene/EOG091G0RRN/infer_single_ML.stdout.txt 2> ../../per_gene/EOG091G0RRN/infer_single_ML.stderr.txt
	else
		echo "fasta file per_gene/EOG091G0RRN/ALICUT_EOG091G0RRN.clustalo.fasta contains fewer than 5 sequences - skipped" > ../../per_gene/EOG091G0RRN/infer_single_ML.stdout.txt
		touch raxml.skipped
	fi
        touch ../../per_gene/EOG091G0RRN/EOG091G0RRN.raxml.done
        
[33mJob counts:
	count	jobs
	1	infer_single_ML
	1[0m
[33m
        cd per_gene/EOG091G0RRN
	count=$(cat ../../per_gene/EOG091G0RRN/ALICUT_EOG091G0RRN.clustalo.fasta | grep ">" | wc -l)
	if [ "$count" -gt 5 ]
        then
		RAxMLmodel=$(cat ../../per_gene/EOG091G0RRN/EOG091G0RRN.best_model | grep "Best" | cut -d ":" -f 2 | tr -d '[:space:]')
                if [ "$(ls -1 | grep "^RAxML" | wc -l)" -ne 0 ]
		then
			rm RAxML*
		fi
        	raxml -f a -T 2 -m PROTGAMMA$RAxMLmodel         	-p 12345 -x 12345 -# 100         	-s ../../per_gene/EOG091G0RRN/ALICUT_EOG091G0RRN.clustalo.fasta -n EOG091G0RRN.clustalo.aln.ALICUT.$RAxMLmodel 		1> ../../per_gene/EOG091G0RRN/infer_single_ML.stdout.txt 2> ../../per_gene/EOG091G0RRN/infer_single_ML.stderr.txt
	else
		echo "fasta file per_gene/EOG091G0RRN/ALICUT_EOG091G0RRN.clustalo.fasta contains fewer than 5 sequences - skipped" > ../../per_gene/EOG091G0RRN/infer_single_ML.stdout.txt
		touch raxml.skipped
	fi
        touch ../../per_gene/EOG091G0RRN/EOG091G0RRN.raxml.done
        [0m
[Sun Jul  5 22:03:11 2020]
Finished job 293.
630 of 3292 steps (19%) done

[Sun Jul  5 22:03:11 2020]
rule get_seqs:
    input: /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ingroup.txt, /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/outgroup.txt
    output: per_gene/EOG091G0LRI/EOG091G0LRI.ingroup.fasta
    log: per_gene/EOG091G0LRI/get_seqs.stdout.txt, per_gene/EOG091G0LRI/get_seqs.stderr.txt
    jobid: 2998
    wildcards: BUSCO=EOG091G0LRI
    threads: 2


	basedir=$(pwd)
        cd per_gene/EOG091G0LRI
        
        bash $basedir/../scripts/fetch_seqs.sh EOG091G0LRI /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ingroup.txt /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/outgroup.txt 1> ../../per_gene/EOG091G0LRI/get_seqs.stdout.txt 2> ../../per_gene/EOG091G0LRI/get_seqs.stderr.txt
	mv EOG091G0LRI.fasta $basedir/per_gene/EOG091G0LRI/EOG091G0LRI.ingroup.fasta
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/72476f9d9a5bd0627b4d721143a21354.simg
[Sun Jul  5 22:03:15 2020]
Finished job 929.
631 of 3292 steps (19%) done

[Sun Jul  5 22:03:15 2020]
rule remove_empty:
    input: per_gene/EOG091G0HAI/ALICUT_EOG091G0HAI.clustalo.fasta
    output: per_gene/EOG091G0HAI/empty_check.done
    jobid: 1751
    wildcards: BUSCO=EOG091G0HAI


         if [ "$(cat per_gene/EOG091G0HAI/ALICUT_EOG091G0HAI.clustalo.fasta | grep -v ">" | sed 's/-//g' | grep "^$" | wc -l)" -gt 0 ]
         then
              cp per_gene/EOG091G0HAI/ALICUT_EOG091G0HAI.clustalo.fasta per_gene/EOG091G0HAI/ALICUT_EOG091G0HAI.clustalo.fasta.backup
              bash ../scripts/remove_empty.sh per_gene/EOG091G0HAI/ALICUT_EOG091G0HAI.clustalo.fasta.backup > per_gene/EOG091G0HAI/ALICUT_EOG091G0HAI.clustalo.fasta
         fi
         touch per_gene/EOG091G0HAI/empty_check.done
         
[Sun Jul  5 22:03:15 2020]
Finished job 1751.
632 of 3292 steps (19%) done
[Sun Jul  5 22:03:15 2020]
Finished job 266.
633 of 3292 steps (19%) done

[Sun Jul  5 22:03:15 2020]
rule find_best_model:
    input: per_gene/EOG091G0HAI/ALICUT_EOG091G0HAI.clustalo.fasta, per_gene/EOG091G0HAI/empty_check.done
    output: per_gene/EOG091G0HAI/EOG091G0HAI.best_model
    log: per_gene/EOG091G0HAI/find_best_model.stderr.txt
    jobid: 928
    wildcards: BUSCO=EOG091G0HAI
    threads: 2


        cd per_gene/EOG091G0HAI
        if [ ! -d find_best_model ]
        then
            mkdir find_best_model
        fi
        cd find_best_model
        ln -s ../../../per_gene/EOG091G0HAI/ALICUT_EOG091G0HAI.clustalo.fasta EOG091G0HAI.fasta
        ProteinModelSelection.pl EOG091G0HAI.fasta 1> ../../../per_gene/EOG091G0HAI/EOG091G0HAI.best_model 2> ../../../per_gene/EOG091G0HAI/find_best_model.stderr.txt
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/c0c09ee657b1e27f2c5687e0e9aa8d70.simg

[Sun Jul  5 22:03:15 2020]
rule get_seqs:
    input: /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ingroup.txt, /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/outgroup.txt
    output: per_gene/EOG091G0CTG/EOG091G0CTG.ingroup.fasta
    log: per_gene/EOG091G0CTG/get_seqs.stdout.txt, per_gene/EOG091G0CTG/get_seqs.stderr.txt
    jobid: 2652
    wildcards: BUSCO=EOG091G0CTG
    threads: 2


	basedir=$(pwd)
        cd per_gene/EOG091G0CTG
        
        bash $basedir/../scripts/fetch_seqs.sh EOG091G0CTG /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ingroup.txt /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/outgroup.txt 1> ../../per_gene/EOG091G0CTG/get_seqs.stdout.txt 2> ../../per_gene/EOG091G0CTG/get_seqs.stderr.txt
	mv EOG091G0CTG.fasta $basedir/per_gene/EOG091G0CTG/EOG091G0CTG.ingroup.fasta
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/72476f9d9a5bd0627b4d721143a21354.simg
[Sun Jul  5 22:03:21 2020]
Finished job 131.
634 of 3292 steps (19%) done

[Sun Jul  5 22:03:21 2020]
rule get_seqs:
    input: /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ingroup.txt, /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/outgroup.txt
    output: per_gene/EOG091G0H6A/EOG091G0H6A.ingroup.fasta
    log: per_gene/EOG091G0H6A/get_seqs.stdout.txt, per_gene/EOG091G0H6A/get_seqs.stderr.txt
    jobid: 2702
    wildcards: BUSCO=EOG091G0H6A
    threads: 2


	basedir=$(pwd)
        cd per_gene/EOG091G0H6A
        
        bash $basedir/../scripts/fetch_seqs.sh EOG091G0H6A /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ingroup.txt /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/outgroup.txt 1> ../../per_gene/EOG091G0H6A/get_seqs.stdout.txt 2> ../../per_gene/EOG091G0H6A/get_seqs.stderr.txt
	mv EOG091G0H6A.fasta $basedir/per_gene/EOG091G0H6A/EOG091G0H6A.ingroup.fasta
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/72476f9d9a5bd0627b4d721143a21354.simg
[Sun Jul  5 22:03:23 2020]
Finished job 2864.
635 of 3292 steps (19%) done

[Sun Jul  5 22:03:23 2020]
rule get_outgroups:
    input: per_gene/EOG091G0U75/EOG091G0U75.ingroup.fasta
    output: per_gene/EOG091G0U75/EOG091G0U75.orthodb.fasta, per_gene/EOG091G0U75/EOG091G0U75.outgroup.fasta
    log: per_gene/EOG091G0U75/get_outgroups.stdout.txt, per_gene/EOG091G0U75/get_outgroups.stderr.txt
    jobid: 2865
    wildcards: BUSCO=EOG091G0U75


        #download fastas from Orhtodb for BUSCO id
        for i in {1..5}
        do
             wget "http://www.orthodb.org/fasta?query=EOG091G0U75&level=33208" -O per_gene/EOG091G0U75/EOG091G0U75.orthodb.fasta 1> per_gene/EOG091G0U75/get_outgroups.stdout.txt 2> per_gene/EOG091G0U75/get_outgroups.stderr.txt && break || echo -e "try again ($i)" && sleep 15
        done

	#This is quick an dirty for now and just takes the first protein if there is more than one for an outgroup taxon
        bash ../scripts/download_outgroups.sh taxids.txt per_gene/EOG091G0U75/EOG091G0U75.orthodb.fasta > per_gene/EOG091G0U75/EOG091G0U75.outgroup.fasta
        
[Sun Jul  5 22:03:25 2020]
Finished job 2865.
636 of 3292 steps (19%) done

[Sun Jul  5 22:03:25 2020]
rule join_groups:
    input: per_gene/EOG091G0U75/EOG091G0U75.ingroup.fasta, per_gene/EOG091G0U75/EOG091G0U75.outgroup.fasta
    output: per_gene/EOG091G0U75/EOG091G0U75.fasta
    jobid: 2256
    wildcards: BUSCO=EOG091G0U75


        cat per_gene/EOG091G0U75/EOG091G0U75.ingroup.fasta per_gene/EOG091G0U75/EOG091G0U75.outgroup.fasta > per_gene/EOG091G0U75/EOG091G0U75.fasta
        
[Sun Jul  5 22:03:25 2020]
Finished job 2256.
637 of 3292 steps (19%) done

[Sun Jul  5 22:03:25 2020]
rule MSA:
    input: per_gene/EOG091G0U75/EOG091G0U75.fasta
    output: per_gene/EOG091G0U75/EOG091G0U75.clustalo.fasta
    log: per_gene/EOG091G0U75/MSA.stdout.txt, per_gene/EOG091G0U75/MSA.stderr.txt
    jobid: 1632
    wildcards: BUSCO=EOG091G0U75
    threads: 2


        clustalo -i per_gene/EOG091G0U75/EOG091G0U75.fasta -o per_gene/EOG091G0U75/EOG091G0U75.clustalo.fasta --threads=2 1> per_gene/EOG091G0U75/MSA.stdout.txt 2> per_gene/EOG091G0U75/MSA.stderr.txt
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/d68c9691725a7401923680874285c430.simg
[Sun Jul  5 22:03:26 2020]
Finished job 2998.
638 of 3292 steps (19%) done

[Sun Jul  5 22:03:26 2020]
rule get_outgroups:
    input: per_gene/EOG091G0LRI/EOG091G0LRI.ingroup.fasta
    output: per_gene/EOG091G0LRI/EOG091G0LRI.orthodb.fasta, per_gene/EOG091G0LRI/EOG091G0LRI.outgroup.fasta
    log: per_gene/EOG091G0LRI/get_outgroups.stdout.txt, per_gene/EOG091G0LRI/get_outgroups.stderr.txt
    jobid: 2999
    wildcards: BUSCO=EOG091G0LRI


        #download fastas from Orhtodb for BUSCO id
        for i in {1..5}
        do
             wget "http://www.orthodb.org/fasta?query=EOG091G0LRI&level=33208" -O per_gene/EOG091G0LRI/EOG091G0LRI.orthodb.fasta 1> per_gene/EOG091G0LRI/get_outgroups.stdout.txt 2> per_gene/EOG091G0LRI/get_outgroups.stderr.txt && break || echo -e "try again ($i)" && sleep 15
        done

	#This is quick an dirty for now and just takes the first protein if there is more than one for an outgroup taxon
        bash ../scripts/download_outgroups.sh taxids.txt per_gene/EOG091G0LRI/EOG091G0LRI.orthodb.fasta > per_gene/EOG091G0LRI/EOG091G0LRI.outgroup.fasta
        
[Sun Jul  5 22:03:26 2020]
Finished job 1632.
639 of 3292 steps (19%) done

[Sun Jul  5 22:03:26 2020]
rule score_and_cut:
    input: per_gene/EOG091G0U75/EOG091G0U75.clustalo.fasta
    output: per_gene/EOG091G0U75/ALICUT_EOG091G0U75.clustalo.fasta
    jobid: 809
    wildcards: BUSCO=EOG091G0U75
    threads: 2


        cd per_gene/EOG091G0U75
        Aliscore.pl -N -r 200000000000000000 -i ../../per_gene/EOG091G0U75/EOG091G0U75.clustalo.fasta &> aliscore.log
        ALICUT.pl -s &> alicut.log
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/63c88c27a0fa300f57066b0ef65fefcb.simg
[Sun Jul  5 22:03:26 2020]
Finished job 2999.
640 of 3292 steps (19%) done

[Sun Jul  5 22:03:26 2020]
rule join_groups:
    input: per_gene/EOG091G0LRI/EOG091G0LRI.ingroup.fasta, per_gene/EOG091G0LRI/EOG091G0LRI.outgroup.fasta
    output: per_gene/EOG091G0LRI/EOG091G0LRI.fasta
    jobid: 2323
    wildcards: BUSCO=EOG091G0LRI


        cat per_gene/EOG091G0LRI/EOG091G0LRI.ingroup.fasta per_gene/EOG091G0LRI/EOG091G0LRI.outgroup.fasta > per_gene/EOG091G0LRI/EOG091G0LRI.fasta
        
[Sun Jul  5 22:03:26 2020]
Finished job 2323.
641 of 3292 steps (19%) done

[Sun Jul  5 22:03:26 2020]
rule MSA:
    input: per_gene/EOG091G0LRI/EOG091G0LRI.fasta
    output: per_gene/EOG091G0LRI/EOG091G0LRI.clustalo.fasta
    log: per_gene/EOG091G0LRI/MSA.stdout.txt, per_gene/EOG091G0LRI/MSA.stderr.txt
    jobid: 1766
    wildcards: BUSCO=EOG091G0LRI
    threads: 2


        clustalo -i per_gene/EOG091G0LRI/EOG091G0LRI.fasta -o per_gene/EOG091G0LRI/EOG091G0LRI.clustalo.fasta --threads=2 1> per_gene/EOG091G0LRI/MSA.stdout.txt 2> per_gene/EOG091G0LRI/MSA.stderr.txt
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/d68c9691725a7401923680874285c430.simg
[Sun Jul  5 22:03:27 2020]
Finished job 1766.
642 of 3292 steps (20%) done

[Sun Jul  5 22:03:27 2020]
rule score_and_cut:
    input: per_gene/EOG091G0LRI/EOG091G0LRI.clustalo.fasta
    output: per_gene/EOG091G0LRI/ALICUT_EOG091G0LRI.clustalo.fasta
    jobid: 943
    wildcards: BUSCO=EOG091G0LRI
    threads: 2


        cd per_gene/EOG091G0LRI
        Aliscore.pl -N -r 200000000000000000 -i ../../per_gene/EOG091G0LRI/EOG091G0LRI.clustalo.fasta &> aliscore.log
        ALICUT.pl -s &> alicut.log
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/63c88c27a0fa300f57066b0ef65fefcb.simg
[Sun Jul  5 22:03:31 2020]
Finished job 2652.
643 of 3292 steps (20%) done

[Sun Jul  5 22:03:31 2020]
rule get_outgroups:
    input: per_gene/EOG091G0CTG/EOG091G0CTG.ingroup.fasta
    output: per_gene/EOG091G0CTG/EOG091G0CTG.orthodb.fasta, per_gene/EOG091G0CTG/EOG091G0CTG.outgroup.fasta
    log: per_gene/EOG091G0CTG/get_outgroups.stdout.txt, per_gene/EOG091G0CTG/get_outgroups.stderr.txt
    jobid: 2653
    wildcards: BUSCO=EOG091G0CTG


        #download fastas from Orhtodb for BUSCO id
        for i in {1..5}
        do
             wget "http://www.orthodb.org/fasta?query=EOG091G0CTG&level=33208" -O per_gene/EOG091G0CTG/EOG091G0CTG.orthodb.fasta 1> per_gene/EOG091G0CTG/get_outgroups.stdout.txt 2> per_gene/EOG091G0CTG/get_outgroups.stderr.txt && break || echo -e "try again ($i)" && sleep 15
        done

	#This is quick an dirty for now and just takes the first protein if there is more than one for an outgroup taxon
        bash ../scripts/download_outgroups.sh taxids.txt per_gene/EOG091G0CTG/EOG091G0CTG.orthodb.fasta > per_gene/EOG091G0CTG/EOG091G0CTG.outgroup.fasta
        
[Sun Jul  5 22:03:32 2020]
Finished job 2653.
644 of 3292 steps (20%) done

[Sun Jul  5 22:03:32 2020]
rule join_groups:
    input: per_gene/EOG091G0CTG/EOG091G0CTG.ingroup.fasta, per_gene/EOG091G0CTG/EOG091G0CTG.outgroup.fasta
    output: per_gene/EOG091G0CTG/EOG091G0CTG.fasta
    jobid: 2150
    wildcards: BUSCO=EOG091G0CTG


        cat per_gene/EOG091G0CTG/EOG091G0CTG.ingroup.fasta per_gene/EOG091G0CTG/EOG091G0CTG.outgroup.fasta > per_gene/EOG091G0CTG/EOG091G0CTG.fasta
        
[Sun Jul  5 22:03:32 2020]
Finished job 2150.
645 of 3292 steps (20%) done

[Sun Jul  5 22:03:32 2020]
rule MSA:
    input: per_gene/EOG091G0CTG/EOG091G0CTG.fasta
    output: per_gene/EOG091G0CTG/EOG091G0CTG.clustalo.fasta
    log: per_gene/EOG091G0CTG/MSA.stdout.txt, per_gene/EOG091G0CTG/MSA.stderr.txt
    jobid: 1420
    wildcards: BUSCO=EOG091G0CTG
    threads: 2


        clustalo -i per_gene/EOG091G0CTG/EOG091G0CTG.fasta -o per_gene/EOG091G0CTG/EOG091G0CTG.clustalo.fasta --threads=2 1> per_gene/EOG091G0CTG/MSA.stdout.txt 2> per_gene/EOG091G0CTG/MSA.stderr.txt
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/d68c9691725a7401923680874285c430.simg
[Sun Jul  5 22:03:33 2020]
Finished job 1420.
646 of 3292 steps (20%) done

[Sun Jul  5 22:03:33 2020]
rule score_and_cut:
    input: per_gene/EOG091G0CTG/EOG091G0CTG.clustalo.fasta
    output: per_gene/EOG091G0CTG/ALICUT_EOG091G0CTG.clustalo.fasta
    jobid: 597
    wildcards: BUSCO=EOG091G0CTG
    threads: 2


        cd per_gene/EOG091G0CTG
        Aliscore.pl -N -r 200000000000000000 -i ../../per_gene/EOG091G0CTG/EOG091G0CTG.clustalo.fasta &> aliscore.log
        ALICUT.pl -s &> alicut.log
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/63c88c27a0fa300f57066b0ef65fefcb.simg
[Sun Jul  5 22:03:36 2020]
Finished job 809.
647 of 3292 steps (20%) done

[Sun Jul  5 22:03:36 2020]
rule remove_empty:
    input: per_gene/EOG091G0U75/ALICUT_EOG091G0U75.clustalo.fasta
    output: per_gene/EOG091G0U75/empty_check.done
    jobid: 1631
    wildcards: BUSCO=EOG091G0U75


         if [ "$(cat per_gene/EOG091G0U75/ALICUT_EOG091G0U75.clustalo.fasta | grep -v ">" | sed 's/-//g' | grep "^$" | wc -l)" -gt 0 ]
         then
              cp per_gene/EOG091G0U75/ALICUT_EOG091G0U75.clustalo.fasta per_gene/EOG091G0U75/ALICUT_EOG091G0U75.clustalo.fasta.backup
              bash ../scripts/remove_empty.sh per_gene/EOG091G0U75/ALICUT_EOG091G0U75.clustalo.fasta.backup > per_gene/EOG091G0U75/ALICUT_EOG091G0U75.clustalo.fasta
         fi
         touch per_gene/EOG091G0U75/empty_check.done
         
[Sun Jul  5 22:03:36 2020]
Finished job 1631.
648 of 3292 steps (20%) done

[Sun Jul  5 22:03:36 2020]
rule find_best_model:
    input: per_gene/EOG091G0U75/ALICUT_EOG091G0U75.clustalo.fasta, per_gene/EOG091G0U75/empty_check.done
    output: per_gene/EOG091G0U75/EOG091G0U75.best_model
    log: per_gene/EOG091G0U75/find_best_model.stderr.txt
    jobid: 808
    wildcards: BUSCO=EOG091G0U75
    threads: 2


        cd per_gene/EOG091G0U75
        if [ ! -d find_best_model ]
        then
            mkdir find_best_model
        fi
        cd find_best_model
        ln -s ../../../per_gene/EOG091G0U75/ALICUT_EOG091G0U75.clustalo.fasta EOG091G0U75.fasta
        ProteinModelSelection.pl EOG091G0U75.fasta 1> ../../../per_gene/EOG091G0U75/EOG091G0U75.best_model 2> ../../../per_gene/EOG091G0U75/find_best_model.stderr.txt
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/c0c09ee657b1e27f2c5687e0e9aa8d70.simg
[Sun Jul  5 22:03:38 2020]
Finished job 943.
649 of 3292 steps (20%) done

[Sun Jul  5 22:03:38 2020]
rule remove_empty:
    input: per_gene/EOG091G0LRI/ALICUT_EOG091G0LRI.clustalo.fasta
    output: per_gene/EOG091G0LRI/empty_check.done
    jobid: 1765
    wildcards: BUSCO=EOG091G0LRI


         if [ "$(cat per_gene/EOG091G0LRI/ALICUT_EOG091G0LRI.clustalo.fasta | grep -v ">" | sed 's/-//g' | grep "^$" | wc -l)" -gt 0 ]
         then
              cp per_gene/EOG091G0LRI/ALICUT_EOG091G0LRI.clustalo.fasta per_gene/EOG091G0LRI/ALICUT_EOG091G0LRI.clustalo.fasta.backup
              bash ../scripts/remove_empty.sh per_gene/EOG091G0LRI/ALICUT_EOG091G0LRI.clustalo.fasta.backup > per_gene/EOG091G0LRI/ALICUT_EOG091G0LRI.clustalo.fasta
         fi
         touch per_gene/EOG091G0LRI/empty_check.done
         
[Sun Jul  5 22:03:38 2020]
Finished job 1765.
650 of 3292 steps (20%) done

[Sun Jul  5 22:03:38 2020]
rule find_best_model:
    input: per_gene/EOG091G0LRI/ALICUT_EOG091G0LRI.clustalo.fasta, per_gene/EOG091G0LRI/empty_check.done
    output: per_gene/EOG091G0LRI/EOG091G0LRI.best_model
    log: per_gene/EOG091G0LRI/find_best_model.stderr.txt
    jobid: 942
    wildcards: BUSCO=EOG091G0LRI
    threads: 2


        cd per_gene/EOG091G0LRI
        if [ ! -d find_best_model ]
        then
            mkdir find_best_model
        fi
        cd find_best_model
        ln -s ../../../per_gene/EOG091G0LRI/ALICUT_EOG091G0LRI.clustalo.fasta EOG091G0LRI.fasta
        ProteinModelSelection.pl EOG091G0LRI.fasta 1> ../../../per_gene/EOG091G0LRI/EOG091G0LRI.best_model 2> ../../../per_gene/EOG091G0LRI/find_best_model.stderr.txt
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/c0c09ee657b1e27f2c5687e0e9aa8d70.simg
[Sun Jul  5 22:03:38 2020]
Finished job 2702.
651 of 3292 steps (20%) done

[Sun Jul  5 22:03:38 2020]
rule get_outgroups:
    input: per_gene/EOG091G0H6A/EOG091G0H6A.ingroup.fasta
    output: per_gene/EOG091G0H6A/EOG091G0H6A.orthodb.fasta, per_gene/EOG091G0H6A/EOG091G0H6A.outgroup.fasta
    log: per_gene/EOG091G0H6A/get_outgroups.stdout.txt, per_gene/EOG091G0H6A/get_outgroups.stderr.txt
    jobid: 2703
    wildcards: BUSCO=EOG091G0H6A


        #download fastas from Orhtodb for BUSCO id
        for i in {1..5}
        do
             wget "http://www.orthodb.org/fasta?query=EOG091G0H6A&level=33208" -O per_gene/EOG091G0H6A/EOG091G0H6A.orthodb.fasta 1> per_gene/EOG091G0H6A/get_outgroups.stdout.txt 2> per_gene/EOG091G0H6A/get_outgroups.stderr.txt && break || echo -e "try again ($i)" && sleep 15
        done

	#This is quick an dirty for now and just takes the first protein if there is more than one for an outgroup taxon
        bash ../scripts/download_outgroups.sh taxids.txt per_gene/EOG091G0H6A/EOG091G0H6A.orthodb.fasta > per_gene/EOG091G0H6A/EOG091G0H6A.outgroup.fasta
        
[Sun Jul  5 22:03:39 2020]
Finished job 2703.
652 of 3292 steps (20%) done

[Sun Jul  5 22:03:39 2020]
rule join_groups:
    input: per_gene/EOG091G0H6A/EOG091G0H6A.ingroup.fasta, per_gene/EOG091G0H6A/EOG091G0H6A.outgroup.fasta
    output: per_gene/EOG091G0H6A/EOG091G0H6A.fasta
    jobid: 2175
    wildcards: BUSCO=EOG091G0H6A


        cat per_gene/EOG091G0H6A/EOG091G0H6A.ingroup.fasta per_gene/EOG091G0H6A/EOG091G0H6A.outgroup.fasta > per_gene/EOG091G0H6A/EOG091G0H6A.fasta
        
[Sun Jul  5 22:03:39 2020]
Finished job 2175.
653 of 3292 steps (20%) done

[Sun Jul  5 22:03:39 2020]
rule MSA:
    input: per_gene/EOG091G0H6A/EOG091G0H6A.fasta
    output: per_gene/EOG091G0H6A/EOG091G0H6A.clustalo.fasta
    log: per_gene/EOG091G0H6A/MSA.stdout.txt, per_gene/EOG091G0H6A/MSA.stderr.txt
    jobid: 1470
    wildcards: BUSCO=EOG091G0H6A
    threads: 2


        clustalo -i per_gene/EOG091G0H6A/EOG091G0H6A.fasta -o per_gene/EOG091G0H6A/EOG091G0H6A.clustalo.fasta --threads=2 1> per_gene/EOG091G0H6A/MSA.stdout.txt 2> per_gene/EOG091G0H6A/MSA.stderr.txt
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/d68c9691725a7401923680874285c430.simg
[Sun Jul  5 22:03:40 2020]
Finished job 1470.
654 of 3292 steps (20%) done

[Sun Jul  5 22:03:40 2020]
rule score_and_cut:
    input: per_gene/EOG091G0H6A/EOG091G0H6A.clustalo.fasta
    output: per_gene/EOG091G0H6A/ALICUT_EOG091G0H6A.clustalo.fasta
    jobid: 647
    wildcards: BUSCO=EOG091G0H6A
    threads: 2


        cd per_gene/EOG091G0H6A
        Aliscore.pl -N -r 200000000000000000 -i ../../per_gene/EOG091G0H6A/EOG091G0H6A.clustalo.fasta &> aliscore.log
        ALICUT.pl -s &> alicut.log
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/63c88c27a0fa300f57066b0ef65fefcb.simg
[Sun Jul  5 22:03:45 2020]
Finished job 597.
655 of 3292 steps (20%) done

[Sun Jul  5 22:03:45 2020]
rule remove_empty:
    input: per_gene/EOG091G0CTG/ALICUT_EOG091G0CTG.clustalo.fasta
    output: per_gene/EOG091G0CTG/empty_check.done
    jobid: 1419
    wildcards: BUSCO=EOG091G0CTG


         if [ "$(cat per_gene/EOG091G0CTG/ALICUT_EOG091G0CTG.clustalo.fasta | grep -v ">" | sed 's/-//g' | grep "^$" | wc -l)" -gt 0 ]
         then
              cp per_gene/EOG091G0CTG/ALICUT_EOG091G0CTG.clustalo.fasta per_gene/EOG091G0CTG/ALICUT_EOG091G0CTG.clustalo.fasta.backup
              bash ../scripts/remove_empty.sh per_gene/EOG091G0CTG/ALICUT_EOG091G0CTG.clustalo.fasta.backup > per_gene/EOG091G0CTG/ALICUT_EOG091G0CTG.clustalo.fasta
         fi
         touch per_gene/EOG091G0CTG/empty_check.done
         
[Sun Jul  5 22:03:45 2020]
Finished job 1419.
656 of 3292 steps (20%) done

[Sun Jul  5 22:03:45 2020]
rule find_best_model:
    input: per_gene/EOG091G0CTG/ALICUT_EOG091G0CTG.clustalo.fasta, per_gene/EOG091G0CTG/empty_check.done
    output: per_gene/EOG091G0CTG/EOG091G0CTG.best_model
    log: per_gene/EOG091G0CTG/find_best_model.stderr.txt
    jobid: 596
    wildcards: BUSCO=EOG091G0CTG
    threads: 2


        cd per_gene/EOG091G0CTG
        if [ ! -d find_best_model ]
        then
            mkdir find_best_model
        fi
        cd find_best_model
        ln -s ../../../per_gene/EOG091G0CTG/ALICUT_EOG091G0CTG.clustalo.fasta EOG091G0CTG.fasta
        ProteinModelSelection.pl EOG091G0CTG.fasta 1> ../../../per_gene/EOG091G0CTG/EOG091G0CTG.best_model 2> ../../../per_gene/EOG091G0CTG/find_best_model.stderr.txt
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/c0c09ee657b1e27f2c5687e0e9aa8d70.simg
[Sun Jul  5 22:03:48 2020]
Finished job 930.
657 of 3292 steps (20%) done

[Sun Jul  5 22:03:48 2020]
rule infer_single_ML:
    input: per_gene/EOG091G0IMD/EOG091G0IMD.best_model, per_gene/EOG091G0IMD/ALICUT_EOG091G0IMD.clustalo.fasta
    output: per_gene/EOG091G0IMD/EOG091G0IMD.raxml.done
    log: per_gene/EOG091G0IMD/infer_single_ML.stdout.txt, per_gene/EOG091G0IMD/infer_single_ML.stderr.txt
    jobid: 259
    wildcards: BUSCO=EOG091G0IMD
    threads: 2


        cd per_gene/EOG091G0IMD
	count=$(cat ../../per_gene/EOG091G0IMD/ALICUT_EOG091G0IMD.clustalo.fasta | grep ">" | wc -l)
	if [ "$count" -gt 5 ]
        then
		RAxMLmodel=$(cat ../../per_gene/EOG091G0IMD/EOG091G0IMD.best_model | grep "Best" | cut -d ":" -f 2 | tr -d '[:space:]')
                if [ "$(ls -1 | grep "^RAxML" | wc -l)" -ne 0 ]
		then
			rm RAxML*
		fi
        	raxml -f a -T 2 -m PROTGAMMA$RAxMLmodel         	-p 12345 -x 12345 -# 100         	-s ../../per_gene/EOG091G0IMD/ALICUT_EOG091G0IMD.clustalo.fasta -n EOG091G0IMD.clustalo.aln.ALICUT.$RAxMLmodel 		1> ../../per_gene/EOG091G0IMD/infer_single_ML.stdout.txt 2> ../../per_gene/EOG091G0IMD/infer_single_ML.stderr.txt
	else
		echo "fasta file per_gene/EOG091G0IMD/ALICUT_EOG091G0IMD.clustalo.fasta contains fewer than 5 sequences - skipped" > ../../per_gene/EOG091G0IMD/infer_single_ML.stdout.txt
		touch raxml.skipped
	fi
        touch ../../per_gene/EOG091G0IMD/EOG091G0IMD.raxml.done
        
[33mJob counts:
	count	jobs
	1	infer_single_ML
	1[0m
[33m
        cd per_gene/EOG091G0IMD
	count=$(cat ../../per_gene/EOG091G0IMD/ALICUT_EOG091G0IMD.clustalo.fasta | grep ">" | wc -l)
	if [ "$count" -gt 5 ]
        then
		RAxMLmodel=$(cat ../../per_gene/EOG091G0IMD/EOG091G0IMD.best_model | grep "Best" | cut -d ":" -f 2 | tr -d '[:space:]')
                if [ "$(ls -1 | grep "^RAxML" | wc -l)" -ne 0 ]
		then
			rm RAxML*
		fi
        	raxml -f a -T 2 -m PROTGAMMA$RAxMLmodel         	-p 12345 -x 12345 -# 100         	-s ../../per_gene/EOG091G0IMD/ALICUT_EOG091G0IMD.clustalo.fasta -n EOG091G0IMD.clustalo.aln.ALICUT.$RAxMLmodel 		1> ../../per_gene/EOG091G0IMD/infer_single_ML.stdout.txt 2> ../../per_gene/EOG091G0IMD/infer_single_ML.stderr.txt
	else
		echo "fasta file per_gene/EOG091G0IMD/ALICUT_EOG091G0IMD.clustalo.fasta contains fewer than 5 sequences - skipped" > ../../per_gene/EOG091G0IMD/infer_single_ML.stdout.txt
		touch raxml.skipped
	fi
        touch ../../per_gene/EOG091G0IMD/EOG091G0IMD.raxml.done
        [0m
[Sun Jul  5 22:03:50 2020]
Finished job 647.
658 of 3292 steps (20%) done

[Sun Jul  5 22:03:50 2020]
rule remove_empty:
    input: per_gene/EOG091G0H6A/ALICUT_EOG091G0H6A.clustalo.fasta
    output: per_gene/EOG091G0H6A/empty_check.done
    jobid: 1469
    wildcards: BUSCO=EOG091G0H6A


         if [ "$(cat per_gene/EOG091G0H6A/ALICUT_EOG091G0H6A.clustalo.fasta | grep -v ">" | sed 's/-//g' | grep "^$" | wc -l)" -gt 0 ]
         then
              cp per_gene/EOG091G0H6A/ALICUT_EOG091G0H6A.clustalo.fasta per_gene/EOG091G0H6A/ALICUT_EOG091G0H6A.clustalo.fasta.backup
              bash ../scripts/remove_empty.sh per_gene/EOG091G0H6A/ALICUT_EOG091G0H6A.clustalo.fasta.backup > per_gene/EOG091G0H6A/ALICUT_EOG091G0H6A.clustalo.fasta
         fi
         touch per_gene/EOG091G0H6A/empty_check.done
         
[Sun Jul  5 22:03:50 2020]
Finished job 1469.
659 of 3292 steps (20%) done

[Sun Jul  5 22:03:50 2020]
rule find_best_model:
    input: per_gene/EOG091G0H6A/ALICUT_EOG091G0H6A.clustalo.fasta, per_gene/EOG091G0H6A/empty_check.done
    output: per_gene/EOG091G0H6A/EOG091G0H6A.best_model
    log: per_gene/EOG091G0H6A/find_best_model.stderr.txt
    jobid: 646
    wildcards: BUSCO=EOG091G0H6A
    threads: 2


        cd per_gene/EOG091G0H6A
        if [ ! -d find_best_model ]
        then
            mkdir find_best_model
        fi
        cd find_best_model
        ln -s ../../../per_gene/EOG091G0H6A/ALICUT_EOG091G0H6A.clustalo.fasta EOG091G0H6A.fasta
        ProteinModelSelection.pl EOG091G0H6A.fasta 1> ../../../per_gene/EOG091G0H6A/EOG091G0H6A.best_model 2> ../../../per_gene/EOG091G0H6A/find_best_model.stderr.txt
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/c0c09ee657b1e27f2c5687e0e9aa8d70.simg
[Sun Jul  5 22:04:11 2020]
Finished job 928.
660 of 3292 steps (20%) done

[Sun Jul  5 22:04:11 2020]
rule infer_single_ML:
    input: per_gene/EOG091G0HAI/EOG091G0HAI.best_model, per_gene/EOG091G0HAI/ALICUT_EOG091G0HAI.clustalo.fasta
    output: per_gene/EOG091G0HAI/EOG091G0HAI.raxml.done
    log: per_gene/EOG091G0HAI/infer_single_ML.stdout.txt, per_gene/EOG091G0HAI/infer_single_ML.stderr.txt
    jobid: 258
    wildcards: BUSCO=EOG091G0HAI
    threads: 2


        cd per_gene/EOG091G0HAI
	count=$(cat ../../per_gene/EOG091G0HAI/ALICUT_EOG091G0HAI.clustalo.fasta | grep ">" | wc -l)
	if [ "$count" -gt 5 ]
        then
		RAxMLmodel=$(cat ../../per_gene/EOG091G0HAI/EOG091G0HAI.best_model | grep "Best" | cut -d ":" -f 2 | tr -d '[:space:]')
                if [ "$(ls -1 | grep "^RAxML" | wc -l)" -ne 0 ]
		then
			rm RAxML*
		fi
        	raxml -f a -T 2 -m PROTGAMMA$RAxMLmodel         	-p 12345 -x 12345 -# 100         	-s ../../per_gene/EOG091G0HAI/ALICUT_EOG091G0HAI.clustalo.fasta -n EOG091G0HAI.clustalo.aln.ALICUT.$RAxMLmodel 		1> ../../per_gene/EOG091G0HAI/infer_single_ML.stdout.txt 2> ../../per_gene/EOG091G0HAI/infer_single_ML.stderr.txt
	else
		echo "fasta file per_gene/EOG091G0HAI/ALICUT_EOG091G0HAI.clustalo.fasta contains fewer than 5 sequences - skipped" > ../../per_gene/EOG091G0HAI/infer_single_ML.stdout.txt
		touch raxml.skipped
	fi
        touch ../../per_gene/EOG091G0HAI/EOG091G0HAI.raxml.done
        
[Sun Jul  5 22:04:16 2020]
Finished job 942.
661 of 3292 steps (20%) done

[Sun Jul  5 22:04:16 2020]
rule infer_single_ML:
    input: per_gene/EOG091G0LRI/EOG091G0LRI.best_model, per_gene/EOG091G0LRI/ALICUT_EOG091G0LRI.clustalo.fasta
    output: per_gene/EOG091G0LRI/EOG091G0LRI.raxml.done
    log: per_gene/EOG091G0LRI/infer_single_ML.stdout.txt, per_gene/EOG091G0LRI/infer_single_ML.stderr.txt
    jobid: 265
    wildcards: BUSCO=EOG091G0LRI
    threads: 2


        cd per_gene/EOG091G0LRI
	count=$(cat ../../per_gene/EOG091G0LRI/ALICUT_EOG091G0LRI.clustalo.fasta | grep ">" | wc -l)
	if [ "$count" -gt 5 ]
        then
		RAxMLmodel=$(cat ../../per_gene/EOG091G0LRI/EOG091G0LRI.best_model | grep "Best" | cut -d ":" -f 2 | tr -d '[:space:]')
                if [ "$(ls -1 | grep "^RAxML" | wc -l)" -ne 0 ]
		then
			rm RAxML*
		fi
        	raxml -f a -T 2 -m PROTGAMMA$RAxMLmodel         	-p 12345 -x 12345 -# 100         	-s ../../per_gene/EOG091G0LRI/ALICUT_EOG091G0LRI.clustalo.fasta -n EOG091G0LRI.clustalo.aln.ALICUT.$RAxMLmodel 		1> ../../per_gene/EOG091G0LRI/infer_single_ML.stdout.txt 2> ../../per_gene/EOG091G0LRI/infer_single_ML.stderr.txt
	else
		echo "fasta file per_gene/EOG091G0LRI/ALICUT_EOG091G0LRI.clustalo.fasta contains fewer than 5 sequences - skipped" > ../../per_gene/EOG091G0LRI/infer_single_ML.stdout.txt
		touch raxml.skipped
	fi
        touch ../../per_gene/EOG091G0LRI/EOG091G0LRI.raxml.done
        
[Sun Jul  5 22:04:17 2020]
Finished job 184.
662 of 3292 steps (20%) done

[Sun Jul  5 22:04:17 2020]
rule get_seqs:
    input: /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ingroup.txt, /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/outgroup.txt
    output: per_gene/EOG091G017T/EOG091G017T.ingroup.fasta
    log: per_gene/EOG091G017T/get_seqs.stdout.txt, per_gene/EOG091G017T/get_seqs.stderr.txt
    jobid: 2480
    wildcards: BUSCO=EOG091G017T
    threads: 2


	basedir=$(pwd)
        cd per_gene/EOG091G017T
        
        bash $basedir/../scripts/fetch_seqs.sh EOG091G017T /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ingroup.txt /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/outgroup.txt 1> ../../per_gene/EOG091G017T/get_seqs.stdout.txt 2> ../../per_gene/EOG091G017T/get_seqs.stderr.txt
	mv EOG091G017T.fasta $basedir/per_gene/EOG091G017T/EOG091G017T.ingroup.fasta
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/72476f9d9a5bd0627b4d721143a21354.simg
[Sun Jul  5 22:04:18 2020]
Finished job 808.
663 of 3292 steps (20%) done

[Sun Jul  5 22:04:18 2020]
rule infer_single_ML:
    input: per_gene/EOG091G0U75/EOG091G0U75.best_model, per_gene/EOG091G0U75/ALICUT_EOG091G0U75.clustalo.fasta
    output: per_gene/EOG091G0U75/EOG091G0U75.raxml.done
    log: per_gene/EOG091G0U75/infer_single_ML.stdout.txt, per_gene/EOG091G0U75/infer_single_ML.stderr.txt
    jobid: 198
    wildcards: BUSCO=EOG091G0U75
    threads: 2


        cd per_gene/EOG091G0U75
	count=$(cat ../../per_gene/EOG091G0U75/ALICUT_EOG091G0U75.clustalo.fasta | grep ">" | wc -l)
	if [ "$count" -gt 5 ]
        then
		RAxMLmodel=$(cat ../../per_gene/EOG091G0U75/EOG091G0U75.best_model | grep "Best" | cut -d ":" -f 2 | tr -d '[:space:]')
                if [ "$(ls -1 | grep "^RAxML" | wc -l)" -ne 0 ]
		then
			rm RAxML*
		fi
        	raxml -f a -T 2 -m PROTGAMMA$RAxMLmodel         	-p 12345 -x 12345 -# 100         	-s ../../per_gene/EOG091G0U75/ALICUT_EOG091G0U75.clustalo.fasta -n EOG091G0U75.clustalo.aln.ALICUT.$RAxMLmodel 		1> ../../per_gene/EOG091G0U75/infer_single_ML.stdout.txt 2> ../../per_gene/EOG091G0U75/infer_single_ML.stderr.txt
	else
		echo "fasta file per_gene/EOG091G0U75/ALICUT_EOG091G0U75.clustalo.fasta contains fewer than 5 sequences - skipped" > ../../per_gene/EOG091G0U75/infer_single_ML.stdout.txt
		touch raxml.skipped
	fi
        touch ../../per_gene/EOG091G0U75/EOG091G0U75.raxml.done
        
[33mJob counts:
	count	jobs
	1	infer_single_ML
	1[0m
[33m
        cd per_gene/EOG091G0HAI
	count=$(cat ../../per_gene/EOG091G0HAI/ALICUT_EOG091G0HAI.clustalo.fasta | grep ">" | wc -l)
	if [ "$count" -gt 5 ]
        then
		RAxMLmodel=$(cat ../../per_gene/EOG091G0HAI/EOG091G0HAI.best_model | grep "Best" | cut -d ":" -f 2 | tr -d '[:space:]')
                if [ "$(ls -1 | grep "^RAxML" | wc -l)" -ne 0 ]
		then
			rm RAxML*
		fi
        	raxml -f a -T 2 -m PROTGAMMA$RAxMLmodel         	-p 12345 -x 12345 -# 100         	-s ../../per_gene/EOG091G0HAI/ALICUT_EOG091G0HAI.clustalo.fasta -n EOG091G0HAI.clustalo.aln.ALICUT.$RAxMLmodel 		1> ../../per_gene/EOG091G0HAI/infer_single_ML.stdout.txt 2> ../../per_gene/EOG091G0HAI/infer_single_ML.stderr.txt
	else
		echo "fasta file per_gene/EOG091G0HAI/ALICUT_EOG091G0HAI.clustalo.fasta contains fewer than 5 sequences - skipped" > ../../per_gene/EOG091G0HAI/infer_single_ML.stdout.txt
		touch raxml.skipped
	fi
        touch ../../per_gene/EOG091G0HAI/EOG091G0HAI.raxml.done
        [0m
[33mJob counts:
	count	jobs
	1	infer_single_ML
	1[0m
[33m
        cd per_gene/EOG091G0LRI
	count=$(cat ../../per_gene/EOG091G0LRI/ALICUT_EOG091G0LRI.clustalo.fasta | grep ">" | wc -l)
	if [ "$count" -gt 5 ]
        then
		RAxMLmodel=$(cat ../../per_gene/EOG091G0LRI/EOG091G0LRI.best_model | grep "Best" | cut -d ":" -f 2 | tr -d '[:space:]')
                if [ "$(ls -1 | grep "^RAxML" | wc -l)" -ne 0 ]
		then
			rm RAxML*
		fi
        	raxml -f a -T 2 -m PROTGAMMA$RAxMLmodel         	-p 12345 -x 12345 -# 100         	-s ../../per_gene/EOG091G0LRI/ALICUT_EOG091G0LRI.clustalo.fasta -n EOG091G0LRI.clustalo.aln.ALICUT.$RAxMLmodel 		1> ../../per_gene/EOG091G0LRI/infer_single_ML.stdout.txt 2> ../../per_gene/EOG091G0LRI/infer_single_ML.stderr.txt
	else
		echo "fasta file per_gene/EOG091G0LRI/ALICUT_EOG091G0LRI.clustalo.fasta contains fewer than 5 sequences - skipped" > ../../per_gene/EOG091G0LRI/infer_single_ML.stdout.txt
		touch raxml.skipped
	fi
        touch ../../per_gene/EOG091G0LRI/EOG091G0LRI.raxml.done
        [0m
[33mJob counts:
	count	jobs
	1	infer_single_ML
	1[0m
[33m
        cd per_gene/EOG091G0U75
	count=$(cat ../../per_gene/EOG091G0U75/ALICUT_EOG091G0U75.clustalo.fasta | grep ">" | wc -l)
	if [ "$count" -gt 5 ]
        then
		RAxMLmodel=$(cat ../../per_gene/EOG091G0U75/EOG091G0U75.best_model | grep "Best" | cut -d ":" -f 2 | tr -d '[:space:]')
                if [ "$(ls -1 | grep "^RAxML" | wc -l)" -ne 0 ]
		then
			rm RAxML*
		fi
        	raxml -f a -T 2 -m PROTGAMMA$RAxMLmodel         	-p 12345 -x 12345 -# 100         	-s ../../per_gene/EOG091G0U75/ALICUT_EOG091G0U75.clustalo.fasta -n EOG091G0U75.clustalo.aln.ALICUT.$RAxMLmodel 		1> ../../per_gene/EOG091G0U75/infer_single_ML.stdout.txt 2> ../../per_gene/EOG091G0U75/infer_single_ML.stderr.txt
	else
		echo "fasta file per_gene/EOG091G0U75/ALICUT_EOG091G0U75.clustalo.fasta contains fewer than 5 sequences - skipped" > ../../per_gene/EOG091G0U75/infer_single_ML.stdout.txt
		touch raxml.skipped
	fi
        touch ../../per_gene/EOG091G0U75/EOG091G0U75.raxml.done
        [0m
[Sun Jul  5 22:04:22 2020]
Finished job 646.
664 of 3292 steps (20%) done

[Sun Jul  5 22:04:22 2020]
rule infer_single_ML:
    input: per_gene/EOG091G0H6A/EOG091G0H6A.best_model, per_gene/EOG091G0H6A/ALICUT_EOG091G0H6A.clustalo.fasta
    output: per_gene/EOG091G0H6A/EOG091G0H6A.raxml.done
    log: per_gene/EOG091G0H6A/infer_single_ML.stdout.txt, per_gene/EOG091G0H6A/infer_single_ML.stderr.txt
    jobid: 117
    wildcards: BUSCO=EOG091G0H6A
    threads: 2


        cd per_gene/EOG091G0H6A
	count=$(cat ../../per_gene/EOG091G0H6A/ALICUT_EOG091G0H6A.clustalo.fasta | grep ">" | wc -l)
	if [ "$count" -gt 5 ]
        then
		RAxMLmodel=$(cat ../../per_gene/EOG091G0H6A/EOG091G0H6A.best_model | grep "Best" | cut -d ":" -f 2 | tr -d '[:space:]')
                if [ "$(ls -1 | grep "^RAxML" | wc -l)" -ne 0 ]
		then
			rm RAxML*
		fi
        	raxml -f a -T 2 -m PROTGAMMA$RAxMLmodel         	-p 12345 -x 12345 -# 100         	-s ../../per_gene/EOG091G0H6A/ALICUT_EOG091G0H6A.clustalo.fasta -n EOG091G0H6A.clustalo.aln.ALICUT.$RAxMLmodel 		1> ../../per_gene/EOG091G0H6A/infer_single_ML.stdout.txt 2> ../../per_gene/EOG091G0H6A/infer_single_ML.stderr.txt
	else
		echo "fasta file per_gene/EOG091G0H6A/ALICUT_EOG091G0H6A.clustalo.fasta contains fewer than 5 sequences - skipped" > ../../per_gene/EOG091G0H6A/infer_single_ML.stdout.txt
		touch raxml.skipped
	fi
        touch ../../per_gene/EOG091G0H6A/EOG091G0H6A.raxml.done
        
[33mJob counts:
	count	jobs
	1	infer_single_ML
	1[0m
[33m
        cd per_gene/EOG091G0H6A
	count=$(cat ../../per_gene/EOG091G0H6A/ALICUT_EOG091G0H6A.clustalo.fasta | grep ">" | wc -l)
	if [ "$count" -gt 5 ]
        then
		RAxMLmodel=$(cat ../../per_gene/EOG091G0H6A/EOG091G0H6A.best_model | grep "Best" | cut -d ":" -f 2 | tr -d '[:space:]')
                if [ "$(ls -1 | grep "^RAxML" | wc -l)" -ne 0 ]
		then
			rm RAxML*
		fi
        	raxml -f a -T 2 -m PROTGAMMA$RAxMLmodel         	-p 12345 -x 12345 -# 100         	-s ../../per_gene/EOG091G0H6A/ALICUT_EOG091G0H6A.clustalo.fasta -n EOG091G0H6A.clustalo.aln.ALICUT.$RAxMLmodel 		1> ../../per_gene/EOG091G0H6A/infer_single_ML.stdout.txt 2> ../../per_gene/EOG091G0H6A/infer_single_ML.stderr.txt
	else
		echo "fasta file per_gene/EOG091G0H6A/ALICUT_EOG091G0H6A.clustalo.fasta contains fewer than 5 sequences - skipped" > ../../per_gene/EOG091G0H6A/infer_single_ML.stdout.txt
		touch raxml.skipped
	fi
        touch ../../per_gene/EOG091G0H6A/EOG091G0H6A.raxml.done
        [0m
[Sun Jul  5 22:04:27 2020]
Finished job 596.
665 of 3292 steps (20%) done

[Sun Jul  5 22:04:27 2020]
rule infer_single_ML:
    input: per_gene/EOG091G0CTG/EOG091G0CTG.best_model, per_gene/EOG091G0CTG/ALICUT_EOG091G0CTG.clustalo.fasta
    output: per_gene/EOG091G0CTG/EOG091G0CTG.raxml.done
    log: per_gene/EOG091G0CTG/infer_single_ML.stdout.txt, per_gene/EOG091G0CTG/infer_single_ML.stderr.txt
    jobid: 92
    wildcards: BUSCO=EOG091G0CTG
    threads: 2


        cd per_gene/EOG091G0CTG
	count=$(cat ../../per_gene/EOG091G0CTG/ALICUT_EOG091G0CTG.clustalo.fasta | grep ">" | wc -l)
	if [ "$count" -gt 5 ]
        then
		RAxMLmodel=$(cat ../../per_gene/EOG091G0CTG/EOG091G0CTG.best_model | grep "Best" | cut -d ":" -f 2 | tr -d '[:space:]')
                if [ "$(ls -1 | grep "^RAxML" | wc -l)" -ne 0 ]
		then
			rm RAxML*
		fi
        	raxml -f a -T 2 -m PROTGAMMA$RAxMLmodel         	-p 12345 -x 12345 -# 100         	-s ../../per_gene/EOG091G0CTG/ALICUT_EOG091G0CTG.clustalo.fasta -n EOG091G0CTG.clustalo.aln.ALICUT.$RAxMLmodel 		1> ../../per_gene/EOG091G0CTG/infer_single_ML.stdout.txt 2> ../../per_gene/EOG091G0CTG/infer_single_ML.stderr.txt
	else
		echo "fasta file per_gene/EOG091G0CTG/ALICUT_EOG091G0CTG.clustalo.fasta contains fewer than 5 sequences - skipped" > ../../per_gene/EOG091G0CTG/infer_single_ML.stdout.txt
		touch raxml.skipped
	fi
        touch ../../per_gene/EOG091G0CTG/EOG091G0CTG.raxml.done
        
[33mJob counts:
	count	jobs
	1	infer_single_ML
	1[0m
[33m
        cd per_gene/EOG091G0CTG
	count=$(cat ../../per_gene/EOG091G0CTG/ALICUT_EOG091G0CTG.clustalo.fasta | grep ">" | wc -l)
	if [ "$count" -gt 5 ]
        then
		RAxMLmodel=$(cat ../../per_gene/EOG091G0CTG/EOG091G0CTG.best_model | grep "Best" | cut -d ":" -f 2 | tr -d '[:space:]')
                if [ "$(ls -1 | grep "^RAxML" | wc -l)" -ne 0 ]
		then
			rm RAxML*
		fi
        	raxml -f a -T 2 -m PROTGAMMA$RAxMLmodel         	-p 12345 -x 12345 -# 100         	-s ../../per_gene/EOG091G0CTG/ALICUT_EOG091G0CTG.clustalo.fasta -n EOG091G0CTG.clustalo.aln.ALICUT.$RAxMLmodel 		1> ../../per_gene/EOG091G0CTG/infer_single_ML.stdout.txt 2> ../../per_gene/EOG091G0CTG/infer_single_ML.stderr.txt
	else
		echo "fasta file per_gene/EOG091G0CTG/ALICUT_EOG091G0CTG.clustalo.fasta contains fewer than 5 sequences - skipped" > ../../per_gene/EOG091G0CTG/infer_single_ML.stdout.txt
		touch raxml.skipped
	fi
        touch ../../per_gene/EOG091G0CTG/EOG091G0CTG.raxml.done
        [0m
[Sun Jul  5 22:04:31 2020]
Finished job 2480.
666 of 3292 steps (20%) done

[Sun Jul  5 22:04:31 2020]
rule get_outgroups:
    input: per_gene/EOG091G017T/EOG091G017T.ingroup.fasta
    output: per_gene/EOG091G017T/EOG091G017T.orthodb.fasta, per_gene/EOG091G017T/EOG091G017T.outgroup.fasta
    log: per_gene/EOG091G017T/get_outgroups.stdout.txt, per_gene/EOG091G017T/get_outgroups.stderr.txt
    jobid: 2481
    wildcards: BUSCO=EOG091G017T


        #download fastas from Orhtodb for BUSCO id
        for i in {1..5}
        do
             wget "http://www.orthodb.org/fasta?query=EOG091G017T&level=33208" -O per_gene/EOG091G017T/EOG091G017T.orthodb.fasta 1> per_gene/EOG091G017T/get_outgroups.stdout.txt 2> per_gene/EOG091G017T/get_outgroups.stderr.txt && break || echo -e "try again ($i)" && sleep 15
        done

	#This is quick an dirty for now and just takes the first protein if there is more than one for an outgroup taxon
        bash ../scripts/download_outgroups.sh taxids.txt per_gene/EOG091G017T/EOG091G017T.orthodb.fasta > per_gene/EOG091G017T/EOG091G017T.outgroup.fasta
        
[Sun Jul  5 22:04:32 2020]
Finished job 2481.
667 of 3292 steps (20%) done

[Sun Jul  5 22:04:32 2020]
rule join_groups:
    input: per_gene/EOG091G017T/EOG091G017T.ingroup.fasta, per_gene/EOG091G017T/EOG091G017T.outgroup.fasta
    output: per_gene/EOG091G017T/EOG091G017T.fasta
    jobid: 2064
    wildcards: BUSCO=EOG091G017T


        cat per_gene/EOG091G017T/EOG091G017T.ingroup.fasta per_gene/EOG091G017T/EOG091G017T.outgroup.fasta > per_gene/EOG091G017T/EOG091G017T.fasta
        
[Sun Jul  5 22:04:33 2020]
Finished job 2064.
668 of 3292 steps (20%) done

[Sun Jul  5 22:04:33 2020]
rule MSA:
    input: per_gene/EOG091G017T/EOG091G017T.fasta
    output: per_gene/EOG091G017T/EOG091G017T.clustalo.fasta
    log: per_gene/EOG091G017T/MSA.stdout.txt, per_gene/EOG091G017T/MSA.stderr.txt
    jobid: 1248
    wildcards: BUSCO=EOG091G017T
    threads: 2


        clustalo -i per_gene/EOG091G017T/EOG091G017T.fasta -o per_gene/EOG091G017T/EOG091G017T.clustalo.fasta --threads=2 1> per_gene/EOG091G017T/MSA.stdout.txt 2> per_gene/EOG091G017T/MSA.stderr.txt
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/d68c9691725a7401923680874285c430.simg
[Sun Jul  5 22:04:38 2020]
Finished job 1248.
669 of 3292 steps (20%) done

[Sun Jul  5 22:04:38 2020]
rule score_and_cut:
    input: per_gene/EOG091G017T/EOG091G017T.clustalo.fasta
    output: per_gene/EOG091G017T/ALICUT_EOG091G017T.clustalo.fasta
    jobid: 425
    wildcards: BUSCO=EOG091G017T
    threads: 2


        cd per_gene/EOG091G017T
        Aliscore.pl -N -r 200000000000000000 -i ../../per_gene/EOG091G017T/EOG091G017T.clustalo.fasta &> aliscore.log
        ALICUT.pl -s &> alicut.log
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/63c88c27a0fa300f57066b0ef65fefcb.simg
[Sun Jul  5 22:04:51 2020]
Finished job 425.
670 of 3292 steps (20%) done

[Sun Jul  5 22:04:51 2020]
rule remove_empty:
    input: per_gene/EOG091G017T/ALICUT_EOG091G017T.clustalo.fasta
    output: per_gene/EOG091G017T/empty_check.done
    jobid: 1247
    wildcards: BUSCO=EOG091G017T


         if [ "$(cat per_gene/EOG091G017T/ALICUT_EOG091G017T.clustalo.fasta | grep -v ">" | sed 's/-//g' | grep "^$" | wc -l)" -gt 0 ]
         then
              cp per_gene/EOG091G017T/ALICUT_EOG091G017T.clustalo.fasta per_gene/EOG091G017T/ALICUT_EOG091G017T.clustalo.fasta.backup
              bash ../scripts/remove_empty.sh per_gene/EOG091G017T/ALICUT_EOG091G017T.clustalo.fasta.backup > per_gene/EOG091G017T/ALICUT_EOG091G017T.clustalo.fasta
         fi
         touch per_gene/EOG091G017T/empty_check.done
         
[Sun Jul  5 22:04:51 2020]
Finished job 1247.
671 of 3292 steps (20%) done

[Sun Jul  5 22:04:51 2020]
rule find_best_model:
    input: per_gene/EOG091G017T/ALICUT_EOG091G017T.clustalo.fasta, per_gene/EOG091G017T/empty_check.done
    output: per_gene/EOG091G017T/EOG091G017T.best_model
    log: per_gene/EOG091G017T/find_best_model.stderr.txt
    jobid: 424
    wildcards: BUSCO=EOG091G017T
    threads: 2


        cd per_gene/EOG091G017T
        if [ ! -d find_best_model ]
        then
            mkdir find_best_model
        fi
        cd find_best_model
        ln -s ../../../per_gene/EOG091G017T/ALICUT_EOG091G017T.clustalo.fasta EOG091G017T.fasta
        ProteinModelSelection.pl EOG091G017T.fasta 1> ../../../per_gene/EOG091G017T/EOG091G017T.best_model 2> ../../../per_gene/EOG091G017T/find_best_model.stderr.txt
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/c0c09ee657b1e27f2c5687e0e9aa8d70.simg
[Sun Jul  5 22:04:57 2020]
Finished job 2.
672 of 3292 steps (20%) done

[Sun Jul  5 22:04:57 2020]
rule get_seqs:
    input: /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ingroup.txt, /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/outgroup.txt
    output: per_gene/EOG091G0UKP/EOG091G0UKP.ingroup.fasta
    log: per_gene/EOG091G0UKP/get_seqs.stdout.txt, per_gene/EOG091G0UKP/get_seqs.stderr.txt
    jobid: 2866
    wildcards: BUSCO=EOG091G0UKP
    threads: 2


	basedir=$(pwd)
        cd per_gene/EOG091G0UKP
        
        bash $basedir/../scripts/fetch_seqs.sh EOG091G0UKP /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ingroup.txt /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/outgroup.txt 1> ../../per_gene/EOG091G0UKP/get_seqs.stdout.txt 2> ../../per_gene/EOG091G0UKP/get_seqs.stderr.txt
	mv EOG091G0UKP.fasta $basedir/per_gene/EOG091G0UKP/EOG091G0UKP.ingroup.fasta
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/72476f9d9a5bd0627b4d721143a21354.simg
[Sun Jul  5 22:05:14 2020]
Finished job 2866.
673 of 3292 steps (20%) done

[Sun Jul  5 22:05:15 2020]
rule get_outgroups:
    input: per_gene/EOG091G0UKP/EOG091G0UKP.ingroup.fasta
    output: per_gene/EOG091G0UKP/EOG091G0UKP.orthodb.fasta, per_gene/EOG091G0UKP/EOG091G0UKP.outgroup.fasta
    log: per_gene/EOG091G0UKP/get_outgroups.stdout.txt, per_gene/EOG091G0UKP/get_outgroups.stderr.txt
    jobid: 2867
    wildcards: BUSCO=EOG091G0UKP


        #download fastas from Orhtodb for BUSCO id
        for i in {1..5}
        do
             wget "http://www.orthodb.org/fasta?query=EOG091G0UKP&level=33208" -O per_gene/EOG091G0UKP/EOG091G0UKP.orthodb.fasta 1> per_gene/EOG091G0UKP/get_outgroups.stdout.txt 2> per_gene/EOG091G0UKP/get_outgroups.stderr.txt && break || echo -e "try again ($i)" && sleep 15
        done

	#This is quick an dirty for now and just takes the first protein if there is more than one for an outgroup taxon
        bash ../scripts/download_outgroups.sh taxids.txt per_gene/EOG091G0UKP/EOG091G0UKP.orthodb.fasta > per_gene/EOG091G0UKP/EOG091G0UKP.outgroup.fasta
        
[Sun Jul  5 22:05:16 2020]
Finished job 2867.
674 of 3292 steps (20%) done

[Sun Jul  5 22:05:16 2020]
rule join_groups:
    input: per_gene/EOG091G0UKP/EOG091G0UKP.ingroup.fasta, per_gene/EOG091G0UKP/EOG091G0UKP.outgroup.fasta
    output: per_gene/EOG091G0UKP/EOG091G0UKP.fasta
    jobid: 2257
    wildcards: BUSCO=EOG091G0UKP


        cat per_gene/EOG091G0UKP/EOG091G0UKP.ingroup.fasta per_gene/EOG091G0UKP/EOG091G0UKP.outgroup.fasta > per_gene/EOG091G0UKP/EOG091G0UKP.fasta
        
[Sun Jul  5 22:05:16 2020]
Finished job 2257.
675 of 3292 steps (21%) done

[Sun Jul  5 22:05:16 2020]
rule MSA:
    input: per_gene/EOG091G0UKP/EOG091G0UKP.fasta
    output: per_gene/EOG091G0UKP/EOG091G0UKP.clustalo.fasta
    log: per_gene/EOG091G0UKP/MSA.stdout.txt, per_gene/EOG091G0UKP/MSA.stderr.txt
    jobid: 1634
    wildcards: BUSCO=EOG091G0UKP
    threads: 2


        clustalo -i per_gene/EOG091G0UKP/EOG091G0UKP.fasta -o per_gene/EOG091G0UKP/EOG091G0UKP.clustalo.fasta --threads=2 1> per_gene/EOG091G0UKP/MSA.stdout.txt 2> per_gene/EOG091G0UKP/MSA.stderr.txt
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/d68c9691725a7401923680874285c430.simg
[Sun Jul  5 22:05:17 2020]
Finished job 1634.
676 of 3292 steps (21%) done

[Sun Jul  5 22:05:17 2020]
rule score_and_cut:
    input: per_gene/EOG091G0UKP/EOG091G0UKP.clustalo.fasta
    output: per_gene/EOG091G0UKP/ALICUT_EOG091G0UKP.clustalo.fasta
    jobid: 811
    wildcards: BUSCO=EOG091G0UKP
    threads: 2


        cd per_gene/EOG091G0UKP
        Aliscore.pl -N -r 200000000000000000 -i ../../per_gene/EOG091G0UKP/EOG091G0UKP.clustalo.fasta &> aliscore.log
        ALICUT.pl -s &> alicut.log
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/63c88c27a0fa300f57066b0ef65fefcb.simg
[Sun Jul  5 22:05:27 2020]
Finished job 811.
677 of 3292 steps (21%) done
[Sun Jul  5 22:05:27 2020]
Finished job 168.
678 of 3292 steps (21%) done

[Sun Jul  5 22:05:27 2020]
rule get_seqs:
    input: /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ingroup.txt, /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/outgroup.txt
    output: per_gene/EOG091G0UYL/EOG091G0UYL.ingroup.fasta
    log: per_gene/EOG091G0UYL/get_seqs.stdout.txt, per_gene/EOG091G0UYL/get_seqs.stderr.txt
    jobid: 2870
    wildcards: BUSCO=EOG091G0UYL
    threads: 2


	basedir=$(pwd)
        cd per_gene/EOG091G0UYL
        
        bash $basedir/../scripts/fetch_seqs.sh EOG091G0UYL /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ingroup.txt /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/outgroup.txt 1> ../../per_gene/EOG091G0UYL/get_seqs.stdout.txt 2> ../../per_gene/EOG091G0UYL/get_seqs.stderr.txt
	mv EOG091G0UYL.fasta $basedir/per_gene/EOG091G0UYL/EOG091G0UYL.ingroup.fasta
        

[Sun Jul  5 22:05:27 2020]
rule remove_empty:
    input: per_gene/EOG091G0UKP/ALICUT_EOG091G0UKP.clustalo.fasta
    output: per_gene/EOG091G0UKP/empty_check.done
    jobid: 1633
    wildcards: BUSCO=EOG091G0UKP


         if [ "$(cat per_gene/EOG091G0UKP/ALICUT_EOG091G0UKP.clustalo.fasta | grep -v ">" | sed 's/-//g' | grep "^$" | wc -l)" -gt 0 ]
         then
              cp per_gene/EOG091G0UKP/ALICUT_EOG091G0UKP.clustalo.fasta per_gene/EOG091G0UKP/ALICUT_EOG091G0UKP.clustalo.fasta.backup
              bash ../scripts/remove_empty.sh per_gene/EOG091G0UKP/ALICUT_EOG091G0UKP.clustalo.fasta.backup > per_gene/EOG091G0UKP/ALICUT_EOG091G0UKP.clustalo.fasta
         fi
         touch per_gene/EOG091G0UKP/empty_check.done
         
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/72476f9d9a5bd0627b4d721143a21354.simg
[Sun Jul  5 22:05:27 2020]
Finished job 1633.
679 of 3292 steps (21%) done

[Sun Jul  5 22:05:27 2020]
rule find_best_model:
    input: per_gene/EOG091G0UKP/ALICUT_EOG091G0UKP.clustalo.fasta, per_gene/EOG091G0UKP/empty_check.done
    output: per_gene/EOG091G0UKP/EOG091G0UKP.best_model
    log: per_gene/EOG091G0UKP/find_best_model.stderr.txt
    jobid: 810
    wildcards: BUSCO=EOG091G0UKP
    threads: 2


        cd per_gene/EOG091G0UKP
        if [ ! -d find_best_model ]
        then
            mkdir find_best_model
        fi
        cd find_best_model
        ln -s ../../../per_gene/EOG091G0UKP/ALICUT_EOG091G0UKP.clustalo.fasta EOG091G0UKP.fasta
        ProteinModelSelection.pl EOG091G0UKP.fasta 1> ../../../per_gene/EOG091G0UKP/EOG091G0UKP.best_model 2> ../../../per_gene/EOG091G0UKP/find_best_model.stderr.txt
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/c0c09ee657b1e27f2c5687e0e9aa8d70.simg
[Sun Jul  5 22:05:44 2020]
Finished job 2870.
680 of 3292 steps (21%) done

[Sun Jul  5 22:05:44 2020]
rule get_outgroups:
    input: per_gene/EOG091G0UYL/EOG091G0UYL.ingroup.fasta
    output: per_gene/EOG091G0UYL/EOG091G0UYL.orthodb.fasta, per_gene/EOG091G0UYL/EOG091G0UYL.outgroup.fasta
    log: per_gene/EOG091G0UYL/get_outgroups.stdout.txt, per_gene/EOG091G0UYL/get_outgroups.stderr.txt
    jobid: 2871
    wildcards: BUSCO=EOG091G0UYL


        #download fastas from Orhtodb for BUSCO id
        for i in {1..5}
        do
             wget "http://www.orthodb.org/fasta?query=EOG091G0UYL&level=33208" -O per_gene/EOG091G0UYL/EOG091G0UYL.orthodb.fasta 1> per_gene/EOG091G0UYL/get_outgroups.stdout.txt 2> per_gene/EOG091G0UYL/get_outgroups.stderr.txt && break || echo -e "try again ($i)" && sleep 15
        done

	#This is quick an dirty for now and just takes the first protein if there is more than one for an outgroup taxon
        bash ../scripts/download_outgroups.sh taxids.txt per_gene/EOG091G0UYL/EOG091G0UYL.orthodb.fasta > per_gene/EOG091G0UYL/EOG091G0UYL.outgroup.fasta
        
[Sun Jul  5 22:05:46 2020]
Finished job 2871.
681 of 3292 steps (21%) done

[Sun Jul  5 22:05:46 2020]
rule join_groups:
    input: per_gene/EOG091G0UYL/EOG091G0UYL.ingroup.fasta, per_gene/EOG091G0UYL/EOG091G0UYL.outgroup.fasta
    output: per_gene/EOG091G0UYL/EOG091G0UYL.fasta
    jobid: 2259
    wildcards: BUSCO=EOG091G0UYL


        cat per_gene/EOG091G0UYL/EOG091G0UYL.ingroup.fasta per_gene/EOG091G0UYL/EOG091G0UYL.outgroup.fasta > per_gene/EOG091G0UYL/EOG091G0UYL.fasta
        
[Sun Jul  5 22:05:46 2020]
Finished job 2259.
682 of 3292 steps (21%) done

[Sun Jul  5 22:05:46 2020]
rule MSA:
    input: per_gene/EOG091G0UYL/EOG091G0UYL.fasta
    output: per_gene/EOG091G0UYL/EOG091G0UYL.clustalo.fasta
    log: per_gene/EOG091G0UYL/MSA.stdout.txt, per_gene/EOG091G0UYL/MSA.stderr.txt
    jobid: 1638
    wildcards: BUSCO=EOG091G0UYL
    threads: 2


        clustalo -i per_gene/EOG091G0UYL/EOG091G0UYL.fasta -o per_gene/EOG091G0UYL/EOG091G0UYL.clustalo.fasta --threads=2 1> per_gene/EOG091G0UYL/MSA.stdout.txt 2> per_gene/EOG091G0UYL/MSA.stderr.txt
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/d68c9691725a7401923680874285c430.simg
[Sun Jul  5 22:05:47 2020]
Finished job 1638.
683 of 3292 steps (21%) done

[Sun Jul  5 22:05:47 2020]
rule score_and_cut:
    input: per_gene/EOG091G0UYL/EOG091G0UYL.clustalo.fasta
    output: per_gene/EOG091G0UYL/ALICUT_EOG091G0UYL.clustalo.fasta
    jobid: 815
    wildcards: BUSCO=EOG091G0UYL
    threads: 2


        cd per_gene/EOG091G0UYL
        Aliscore.pl -N -r 200000000000000000 -i ../../per_gene/EOG091G0UYL/EOG091G0UYL.clustalo.fasta &> aliscore.log
        ALICUT.pl -s &> alicut.log
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/63c88c27a0fa300f57066b0ef65fefcb.simg
[Sun Jul  5 22:05:57 2020]
Finished job 815.
684 of 3292 steps (21%) done

[Sun Jul  5 22:05:57 2020]
rule remove_empty:
    input: per_gene/EOG091G0UYL/ALICUT_EOG091G0UYL.clustalo.fasta
    output: per_gene/EOG091G0UYL/empty_check.done
    jobid: 1637
    wildcards: BUSCO=EOG091G0UYL


         if [ "$(cat per_gene/EOG091G0UYL/ALICUT_EOG091G0UYL.clustalo.fasta | grep -v ">" | sed 's/-//g' | grep "^$" | wc -l)" -gt 0 ]
         then
              cp per_gene/EOG091G0UYL/ALICUT_EOG091G0UYL.clustalo.fasta per_gene/EOG091G0UYL/ALICUT_EOG091G0UYL.clustalo.fasta.backup
              bash ../scripts/remove_empty.sh per_gene/EOG091G0UYL/ALICUT_EOG091G0UYL.clustalo.fasta.backup > per_gene/EOG091G0UYL/ALICUT_EOG091G0UYL.clustalo.fasta
         fi
         touch per_gene/EOG091G0UYL/empty_check.done
         
[Sun Jul  5 22:05:58 2020]
Finished job 1637.
685 of 3292 steps (21%) done

[Sun Jul  5 22:05:58 2020]
rule find_best_model:
    input: per_gene/EOG091G0UYL/ALICUT_EOG091G0UYL.clustalo.fasta, per_gene/EOG091G0UYL/empty_check.done
    output: per_gene/EOG091G0UYL/EOG091G0UYL.best_model
    log: per_gene/EOG091G0UYL/find_best_model.stderr.txt
    jobid: 814
    wildcards: BUSCO=EOG091G0UYL
    threads: 2


        cd per_gene/EOG091G0UYL
        if [ ! -d find_best_model ]
        then
            mkdir find_best_model
        fi
        cd find_best_model
        ln -s ../../../per_gene/EOG091G0UYL/ALICUT_EOG091G0UYL.clustalo.fasta EOG091G0UYL.fasta
        ProteinModelSelection.pl EOG091G0UYL.fasta 1> ../../../per_gene/EOG091G0UYL/EOG091G0UYL.best_model 2> ../../../per_gene/EOG091G0UYL/find_best_model.stderr.txt
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/c0c09ee657b1e27f2c5687e0e9aa8d70.simg
[Sun Jul  5 22:06:00 2020]
Finished job 424.
686 of 3292 steps (21%) done

[Sun Jul  5 22:06:00 2020]
rule infer_single_ML:
    input: per_gene/EOG091G017T/EOG091G017T.best_model, per_gene/EOG091G017T/ALICUT_EOG091G017T.clustalo.fasta
    output: per_gene/EOG091G017T/EOG091G017T.raxml.done
    log: per_gene/EOG091G017T/infer_single_ML.stdout.txt, per_gene/EOG091G017T/infer_single_ML.stderr.txt
    jobid: 6
    wildcards: BUSCO=EOG091G017T
    threads: 2


        cd per_gene/EOG091G017T
	count=$(cat ../../per_gene/EOG091G017T/ALICUT_EOG091G017T.clustalo.fasta | grep ">" | wc -l)
	if [ "$count" -gt 5 ]
        then
		RAxMLmodel=$(cat ../../per_gene/EOG091G017T/EOG091G017T.best_model | grep "Best" | cut -d ":" -f 2 | tr -d '[:space:]')
                if [ "$(ls -1 | grep "^RAxML" | wc -l)" -ne 0 ]
		then
			rm RAxML*
		fi
        	raxml -f a -T 2 -m PROTGAMMA$RAxMLmodel         	-p 12345 -x 12345 -# 100         	-s ../../per_gene/EOG091G017T/ALICUT_EOG091G017T.clustalo.fasta -n EOG091G017T.clustalo.aln.ALICUT.$RAxMLmodel 		1> ../../per_gene/EOG091G017T/infer_single_ML.stdout.txt 2> ../../per_gene/EOG091G017T/infer_single_ML.stderr.txt
	else
		echo "fasta file per_gene/EOG091G017T/ALICUT_EOG091G017T.clustalo.fasta contains fewer than 5 sequences - skipped" > ../../per_gene/EOG091G017T/infer_single_ML.stdout.txt
		touch raxml.skipped
	fi
        touch ../../per_gene/EOG091G017T/EOG091G017T.raxml.done
        
[33mJob counts:
	count	jobs
	1	infer_single_ML
	1[0m
[33m
        cd per_gene/EOG091G017T
	count=$(cat ../../per_gene/EOG091G017T/ALICUT_EOG091G017T.clustalo.fasta | grep ">" | wc -l)
	if [ "$count" -gt 5 ]
        then
		RAxMLmodel=$(cat ../../per_gene/EOG091G017T/EOG091G017T.best_model | grep "Best" | cut -d ":" -f 2 | tr -d '[:space:]')
                if [ "$(ls -1 | grep "^RAxML" | wc -l)" -ne 0 ]
		then
			rm RAxML*
		fi
        	raxml -f a -T 2 -m PROTGAMMA$RAxMLmodel         	-p 12345 -x 12345 -# 100         	-s ../../per_gene/EOG091G017T/ALICUT_EOG091G017T.clustalo.fasta -n EOG091G017T.clustalo.aln.ALICUT.$RAxMLmodel 		1> ../../per_gene/EOG091G017T/infer_single_ML.stdout.txt 2> ../../per_gene/EOG091G017T/infer_single_ML.stderr.txt
	else
		echo "fasta file per_gene/EOG091G017T/ALICUT_EOG091G017T.clustalo.fasta contains fewer than 5 sequences - skipped" > ../../per_gene/EOG091G017T/infer_single_ML.stdout.txt
		touch raxml.skipped
	fi
        touch ../../per_gene/EOG091G017T/EOG091G017T.raxml.done
        [0m
[Sun Jul  5 22:06:07 2020]
Finished job 810.
687 of 3292 steps (21%) done

[Sun Jul  5 22:06:07 2020]
rule infer_single_ML:
    input: per_gene/EOG091G0UKP/EOG091G0UKP.best_model, per_gene/EOG091G0UKP/ALICUT_EOG091G0UKP.clustalo.fasta
    output: per_gene/EOG091G0UKP/EOG091G0UKP.raxml.done
    log: per_gene/EOG091G0UKP/infer_single_ML.stdout.txt, per_gene/EOG091G0UKP/infer_single_ML.stderr.txt
    jobid: 199
    wildcards: BUSCO=EOG091G0UKP
    threads: 2


        cd per_gene/EOG091G0UKP
	count=$(cat ../../per_gene/EOG091G0UKP/ALICUT_EOG091G0UKP.clustalo.fasta | grep ">" | wc -l)
	if [ "$count" -gt 5 ]
        then
		RAxMLmodel=$(cat ../../per_gene/EOG091G0UKP/EOG091G0UKP.best_model | grep "Best" | cut -d ":" -f 2 | tr -d '[:space:]')
                if [ "$(ls -1 | grep "^RAxML" | wc -l)" -ne 0 ]
		then
			rm RAxML*
		fi
        	raxml -f a -T 2 -m PROTGAMMA$RAxMLmodel         	-p 12345 -x 12345 -# 100         	-s ../../per_gene/EOG091G0UKP/ALICUT_EOG091G0UKP.clustalo.fasta -n EOG091G0UKP.clustalo.aln.ALICUT.$RAxMLmodel 		1> ../../per_gene/EOG091G0UKP/infer_single_ML.stdout.txt 2> ../../per_gene/EOG091G0UKP/infer_single_ML.stderr.txt
	else
		echo "fasta file per_gene/EOG091G0UKP/ALICUT_EOG091G0UKP.clustalo.fasta contains fewer than 5 sequences - skipped" > ../../per_gene/EOG091G0UKP/infer_single_ML.stdout.txt
		touch raxml.skipped
	fi
        touch ../../per_gene/EOG091G0UKP/EOG091G0UKP.raxml.done
        
[33mJob counts:
	count	jobs
	1	infer_single_ML
	1[0m
[33m
        cd per_gene/EOG091G0UKP
	count=$(cat ../../per_gene/EOG091G0UKP/ALICUT_EOG091G0UKP.clustalo.fasta | grep ">" | wc -l)
	if [ "$count" -gt 5 ]
        then
		RAxMLmodel=$(cat ../../per_gene/EOG091G0UKP/EOG091G0UKP.best_model | grep "Best" | cut -d ":" -f 2 | tr -d '[:space:]')
                if [ "$(ls -1 | grep "^RAxML" | wc -l)" -ne 0 ]
		then
			rm RAxML*
		fi
        	raxml -f a -T 2 -m PROTGAMMA$RAxMLmodel         	-p 12345 -x 12345 -# 100         	-s ../../per_gene/EOG091G0UKP/ALICUT_EOG091G0UKP.clustalo.fasta -n EOG091G0UKP.clustalo.aln.ALICUT.$RAxMLmodel 		1> ../../per_gene/EOG091G0UKP/infer_single_ML.stdout.txt 2> ../../per_gene/EOG091G0UKP/infer_single_ML.stderr.txt
	else
		echo "fasta file per_gene/EOG091G0UKP/ALICUT_EOG091G0UKP.clustalo.fasta contains fewer than 5 sequences - skipped" > ../../per_gene/EOG091G0UKP/infer_single_ML.stdout.txt
		touch raxml.skipped
	fi
        touch ../../per_gene/EOG091G0UKP/EOG091G0UKP.raxml.done
        [0m
[Sun Jul  5 22:06:38 2020]
Finished job 814.
688 of 3292 steps (21%) done

[Sun Jul  5 22:06:38 2020]
rule infer_single_ML:
    input: per_gene/EOG091G0UYL/EOG091G0UYL.best_model, per_gene/EOG091G0UYL/ALICUT_EOG091G0UYL.clustalo.fasta
    output: per_gene/EOG091G0UYL/EOG091G0UYL.raxml.done
    log: per_gene/EOG091G0UYL/infer_single_ML.stdout.txt, per_gene/EOG091G0UYL/infer_single_ML.stderr.txt
    jobid: 201
    wildcards: BUSCO=EOG091G0UYL
    threads: 2


        cd per_gene/EOG091G0UYL
	count=$(cat ../../per_gene/EOG091G0UYL/ALICUT_EOG091G0UYL.clustalo.fasta | grep ">" | wc -l)
	if [ "$count" -gt 5 ]
        then
		RAxMLmodel=$(cat ../../per_gene/EOG091G0UYL/EOG091G0UYL.best_model | grep "Best" | cut -d ":" -f 2 | tr -d '[:space:]')
                if [ "$(ls -1 | grep "^RAxML" | wc -l)" -ne 0 ]
		then
			rm RAxML*
		fi
        	raxml -f a -T 2 -m PROTGAMMA$RAxMLmodel         	-p 12345 -x 12345 -# 100         	-s ../../per_gene/EOG091G0UYL/ALICUT_EOG091G0UYL.clustalo.fasta -n EOG091G0UYL.clustalo.aln.ALICUT.$RAxMLmodel 		1> ../../per_gene/EOG091G0UYL/infer_single_ML.stdout.txt 2> ../../per_gene/EOG091G0UYL/infer_single_ML.stderr.txt
	else
		echo "fasta file per_gene/EOG091G0UYL/ALICUT_EOG091G0UYL.clustalo.fasta contains fewer than 5 sequences - skipped" > ../../per_gene/EOG091G0UYL/infer_single_ML.stdout.txt
		touch raxml.skipped
	fi
        touch ../../per_gene/EOG091G0UYL/EOG091G0UYL.raxml.done
        
[33mJob counts:
	count	jobs
	1	infer_single_ML
	1[0m
[33m
        cd per_gene/EOG091G0UYL
	count=$(cat ../../per_gene/EOG091G0UYL/ALICUT_EOG091G0UYL.clustalo.fasta | grep ">" | wc -l)
	if [ "$count" -gt 5 ]
        then
		RAxMLmodel=$(cat ../../per_gene/EOG091G0UYL/EOG091G0UYL.best_model | grep "Best" | cut -d ":" -f 2 | tr -d '[:space:]')
                if [ "$(ls -1 | grep "^RAxML" | wc -l)" -ne 0 ]
		then
			rm RAxML*
		fi
        	raxml -f a -T 2 -m PROTGAMMA$RAxMLmodel         	-p 12345 -x 12345 -# 100         	-s ../../per_gene/EOG091G0UYL/ALICUT_EOG091G0UYL.clustalo.fasta -n EOG091G0UYL.clustalo.aln.ALICUT.$RAxMLmodel 		1> ../../per_gene/EOG091G0UYL/infer_single_ML.stdout.txt 2> ../../per_gene/EOG091G0UYL/infer_single_ML.stderr.txt
	else
		echo "fasta file per_gene/EOG091G0UYL/ALICUT_EOG091G0UYL.clustalo.fasta contains fewer than 5 sequences - skipped" > ../../per_gene/EOG091G0UYL/infer_single_ML.stdout.txt
		touch raxml.skipped
	fi
        touch ../../per_gene/EOG091G0UYL/EOG091G0UYL.raxml.done
        [0m
[Sun Jul  5 22:06:48 2020]
Finished job 275.
689 of 3292 steps (21%) done

[Sun Jul  5 22:06:48 2020]
rule get_seqs:
    input: /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ingroup.txt, /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/outgroup.txt
    output: per_gene/EOG091G0R21/EOG091G0R21.ingroup.fasta
    log: per_gene/EOG091G0R21/get_seqs.stdout.txt, per_gene/EOG091G0R21/get_seqs.stderr.txt
    jobid: 2830
    wildcards: BUSCO=EOG091G0R21
    threads: 2


	basedir=$(pwd)
        cd per_gene/EOG091G0R21
        
        bash $basedir/../scripts/fetch_seqs.sh EOG091G0R21 /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ingroup.txt /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/outgroup.txt 1> ../../per_gene/EOG091G0R21/get_seqs.stdout.txt 2> ../../per_gene/EOG091G0R21/get_seqs.stderr.txt
	mv EOG091G0R21.fasta $basedir/per_gene/EOG091G0R21/EOG091G0R21.ingroup.fasta
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/72476f9d9a5bd0627b4d721143a21354.simg
[Sun Jul  5 22:07:04 2020]
Finished job 2830.
690 of 3292 steps (21%) done

[Sun Jul  5 22:07:04 2020]
rule get_outgroups:
    input: per_gene/EOG091G0R21/EOG091G0R21.ingroup.fasta
    output: per_gene/EOG091G0R21/EOG091G0R21.orthodb.fasta, per_gene/EOG091G0R21/EOG091G0R21.outgroup.fasta
    log: per_gene/EOG091G0R21/get_outgroups.stdout.txt, per_gene/EOG091G0R21/get_outgroups.stderr.txt
    jobid: 2831
    wildcards: BUSCO=EOG091G0R21


        #download fastas from Orhtodb for BUSCO id
        for i in {1..5}
        do
             wget "http://www.orthodb.org/fasta?query=EOG091G0R21&level=33208" -O per_gene/EOG091G0R21/EOG091G0R21.orthodb.fasta 1> per_gene/EOG091G0R21/get_outgroups.stdout.txt 2> per_gene/EOG091G0R21/get_outgroups.stderr.txt && break || echo -e "try again ($i)" && sleep 15
        done

	#This is quick an dirty for now and just takes the first protein if there is more than one for an outgroup taxon
        bash ../scripts/download_outgroups.sh taxids.txt per_gene/EOG091G0R21/EOG091G0R21.orthodb.fasta > per_gene/EOG091G0R21/EOG091G0R21.outgroup.fasta
        
[Sun Jul  5 22:07:06 2020]
Finished job 2831.
691 of 3292 steps (21%) done

[Sun Jul  5 22:07:06 2020]
rule join_groups:
    input: per_gene/EOG091G0R21/EOG091G0R21.ingroup.fasta, per_gene/EOG091G0R21/EOG091G0R21.outgroup.fasta
    output: per_gene/EOG091G0R21/EOG091G0R21.fasta
    jobid: 2239
    wildcards: BUSCO=EOG091G0R21


        cat per_gene/EOG091G0R21/EOG091G0R21.ingroup.fasta per_gene/EOG091G0R21/EOG091G0R21.outgroup.fasta > per_gene/EOG091G0R21/EOG091G0R21.fasta
        
[Sun Jul  5 22:07:06 2020]
Finished job 2239.
692 of 3292 steps (21%) done

[Sun Jul  5 22:07:06 2020]
rule MSA:
    input: per_gene/EOG091G0R21/EOG091G0R21.fasta
    output: per_gene/EOG091G0R21/EOG091G0R21.clustalo.fasta
    log: per_gene/EOG091G0R21/MSA.stdout.txt, per_gene/EOG091G0R21/MSA.stderr.txt
    jobid: 1598
    wildcards: BUSCO=EOG091G0R21
    threads: 2


        clustalo -i per_gene/EOG091G0R21/EOG091G0R21.fasta -o per_gene/EOG091G0R21/EOG091G0R21.clustalo.fasta --threads=2 1> per_gene/EOG091G0R21/MSA.stdout.txt 2> per_gene/EOG091G0R21/MSA.stderr.txt
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/d68c9691725a7401923680874285c430.simg
[Sun Jul  5 22:07:07 2020]
Finished job 1598.
693 of 3292 steps (21%) done

[Sun Jul  5 22:07:07 2020]
rule score_and_cut:
    input: per_gene/EOG091G0R21/EOG091G0R21.clustalo.fasta
    output: per_gene/EOG091G0R21/ALICUT_EOG091G0R21.clustalo.fasta
    jobid: 775
    wildcards: BUSCO=EOG091G0R21
    threads: 2


        cd per_gene/EOG091G0R21
        Aliscore.pl -N -r 200000000000000000 -i ../../per_gene/EOG091G0R21/EOG091G0R21.clustalo.fasta &> aliscore.log
        ALICUT.pl -s &> alicut.log
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/63c88c27a0fa300f57066b0ef65fefcb.simg
[Sun Jul  5 22:07:19 2020]
Finished job 775.
694 of 3292 steps (21%) done

[Sun Jul  5 22:07:19 2020]
rule remove_empty:
    input: per_gene/EOG091G0R21/ALICUT_EOG091G0R21.clustalo.fasta
    output: per_gene/EOG091G0R21/empty_check.done
    jobid: 1597
    wildcards: BUSCO=EOG091G0R21


         if [ "$(cat per_gene/EOG091G0R21/ALICUT_EOG091G0R21.clustalo.fasta | grep -v ">" | sed 's/-//g' | grep "^$" | wc -l)" -gt 0 ]
         then
              cp per_gene/EOG091G0R21/ALICUT_EOG091G0R21.clustalo.fasta per_gene/EOG091G0R21/ALICUT_EOG091G0R21.clustalo.fasta.backup
              bash ../scripts/remove_empty.sh per_gene/EOG091G0R21/ALICUT_EOG091G0R21.clustalo.fasta.backup > per_gene/EOG091G0R21/ALICUT_EOG091G0R21.clustalo.fasta
         fi
         touch per_gene/EOG091G0R21/empty_check.done
         
[Sun Jul  5 22:07:19 2020]
Finished job 1597.
695 of 3292 steps (21%) done

[Sun Jul  5 22:07:19 2020]
rule find_best_model:
    input: per_gene/EOG091G0R21/ALICUT_EOG091G0R21.clustalo.fasta, per_gene/EOG091G0R21/empty_check.done
    output: per_gene/EOG091G0R21/EOG091G0R21.best_model
    log: per_gene/EOG091G0R21/find_best_model.stderr.txt
    jobid: 774
    wildcards: BUSCO=EOG091G0R21
    threads: 2


        cd per_gene/EOG091G0R21
        if [ ! -d find_best_model ]
        then
            mkdir find_best_model
        fi
        cd find_best_model
        ln -s ../../../per_gene/EOG091G0R21/ALICUT_EOG091G0R21.clustalo.fasta EOG091G0R21.fasta
        ProteinModelSelection.pl EOG091G0R21.fasta 1> ../../../per_gene/EOG091G0R21/EOG091G0R21.best_model 2> ../../../per_gene/EOG091G0R21/find_best_model.stderr.txt
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/c0c09ee657b1e27f2c5687e0e9aa8d70.simg
[Sun Jul  5 22:07:28 2020]
Finished job 32.
696 of 3292 steps (21%) done

[Sun Jul  5 22:07:28 2020]
rule get_seqs:
    input: /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ingroup.txt, /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/outgroup.txt
    output: per_gene/EOG091G0TKH/EOG091G0TKH.ingroup.fasta
    log: per_gene/EOG091G0TKH/get_seqs.stdout.txt, per_gene/EOG091G0TKH/get_seqs.stderr.txt
    jobid: 3024
    wildcards: BUSCO=EOG091G0TKH
    threads: 2


	basedir=$(pwd)
        cd per_gene/EOG091G0TKH
        
        bash $basedir/../scripts/fetch_seqs.sh EOG091G0TKH /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ingroup.txt /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/outgroup.txt 1> ../../per_gene/EOG091G0TKH/get_seqs.stdout.txt 2> ../../per_gene/EOG091G0TKH/get_seqs.stderr.txt
	mv EOG091G0TKH.fasta $basedir/per_gene/EOG091G0TKH/EOG091G0TKH.ingroup.fasta
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/72476f9d9a5bd0627b4d721143a21354.simg
[Sun Jul  5 22:07:32 2020]
Finished job 300.
697 of 3292 steps (21%) done

[Sun Jul  5 22:07:32 2020]
rule get_seqs:
    input: /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ingroup.txt, /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/outgroup.txt
    output: per_gene/EOG091G0HML/EOG091G0HML.ingroup.fasta
    log: per_gene/EOG091G0HML/get_seqs.stdout.txt, per_gene/EOG091G0HML/get_seqs.stderr.txt
    jobid: 3196
    wildcards: BUSCO=EOG091G0HML
    threads: 2


	basedir=$(pwd)
        cd per_gene/EOG091G0HML
        
        bash $basedir/../scripts/fetch_seqs.sh EOG091G0HML /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ingroup.txt /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/outgroup.txt 1> ../../per_gene/EOG091G0HML/get_seqs.stdout.txt 2> ../../per_gene/EOG091G0HML/get_seqs.stderr.txt
	mv EOG091G0HML.fasta $basedir/per_gene/EOG091G0HML/EOG091G0HML.ingroup.fasta
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/72476f9d9a5bd0627b4d721143a21354.simg
[Sun Jul  5 22:07:46 2020]
Finished job 3024.
698 of 3292 steps (21%) done

[Sun Jul  5 22:07:46 2020]
rule get_outgroups:
    input: per_gene/EOG091G0TKH/EOG091G0TKH.ingroup.fasta
    output: per_gene/EOG091G0TKH/EOG091G0TKH.orthodb.fasta, per_gene/EOG091G0TKH/EOG091G0TKH.outgroup.fasta
    log: per_gene/EOG091G0TKH/get_outgroups.stdout.txt, per_gene/EOG091G0TKH/get_outgroups.stderr.txt
    jobid: 3025
    wildcards: BUSCO=EOG091G0TKH


        #download fastas from Orhtodb for BUSCO id
        for i in {1..5}
        do
             wget "http://www.orthodb.org/fasta?query=EOG091G0TKH&level=33208" -O per_gene/EOG091G0TKH/EOG091G0TKH.orthodb.fasta 1> per_gene/EOG091G0TKH/get_outgroups.stdout.txt 2> per_gene/EOG091G0TKH/get_outgroups.stderr.txt && break || echo -e "try again ($i)" && sleep 15
        done

	#This is quick an dirty for now and just takes the first protein if there is more than one for an outgroup taxon
        bash ../scripts/download_outgroups.sh taxids.txt per_gene/EOG091G0TKH/EOG091G0TKH.orthodb.fasta > per_gene/EOG091G0TKH/EOG091G0TKH.outgroup.fasta
        
[Sun Jul  5 22:07:47 2020]
Finished job 3025.
699 of 3292 steps (21%) done

[Sun Jul  5 22:07:47 2020]
rule join_groups:
    input: per_gene/EOG091G0TKH/EOG091G0TKH.ingroup.fasta, per_gene/EOG091G0TKH/EOG091G0TKH.outgroup.fasta
    output: per_gene/EOG091G0TKH/EOG091G0TKH.fasta
    jobid: 2336
    wildcards: BUSCO=EOG091G0TKH


        cat per_gene/EOG091G0TKH/EOG091G0TKH.ingroup.fasta per_gene/EOG091G0TKH/EOG091G0TKH.outgroup.fasta > per_gene/EOG091G0TKH/EOG091G0TKH.fasta
        
[Sun Jul  5 22:07:47 2020]
Finished job 2336.
700 of 3292 steps (21%) done

[Sun Jul  5 22:07:47 2020]
rule MSA:
    input: per_gene/EOG091G0TKH/EOG091G0TKH.fasta
    output: per_gene/EOG091G0TKH/EOG091G0TKH.clustalo.fasta
    log: per_gene/EOG091G0TKH/MSA.stdout.txt, per_gene/EOG091G0TKH/MSA.stderr.txt
    jobid: 1792
    wildcards: BUSCO=EOG091G0TKH
    threads: 2


        clustalo -i per_gene/EOG091G0TKH/EOG091G0TKH.fasta -o per_gene/EOG091G0TKH/EOG091G0TKH.clustalo.fasta --threads=2 1> per_gene/EOG091G0TKH/MSA.stdout.txt 2> per_gene/EOG091G0TKH/MSA.stderr.txt
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/d68c9691725a7401923680874285c430.simg
[Sun Jul  5 22:07:47 2020]
Finished job 1792.
701 of 3292 steps (21%) done

[Sun Jul  5 22:07:47 2020]
rule score_and_cut:
    input: per_gene/EOG091G0TKH/EOG091G0TKH.clustalo.fasta
    output: per_gene/EOG091G0TKH/ALICUT_EOG091G0TKH.clustalo.fasta
    jobid: 969
    wildcards: BUSCO=EOG091G0TKH
    threads: 2


        cd per_gene/EOG091G0TKH
        Aliscore.pl -N -r 200000000000000000 -i ../../per_gene/EOG091G0TKH/EOG091G0TKH.clustalo.fasta &> aliscore.log
        ALICUT.pl -s &> alicut.log
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/63c88c27a0fa300f57066b0ef65fefcb.simg
[Sun Jul  5 22:07:49 2020]
Finished job 3196.
702 of 3292 steps (21%) done

[Sun Jul  5 22:07:49 2020]
rule get_outgroups:
    input: per_gene/EOG091G0HML/EOG091G0HML.ingroup.fasta
    output: per_gene/EOG091G0HML/EOG091G0HML.orthodb.fasta, per_gene/EOG091G0HML/EOG091G0HML.outgroup.fasta
    log: per_gene/EOG091G0HML/get_outgroups.stdout.txt, per_gene/EOG091G0HML/get_outgroups.stderr.txt
    jobid: 3197
    wildcards: BUSCO=EOG091G0HML


        #download fastas from Orhtodb for BUSCO id
        for i in {1..5}
        do
             wget "http://www.orthodb.org/fasta?query=EOG091G0HML&level=33208" -O per_gene/EOG091G0HML/EOG091G0HML.orthodb.fasta 1> per_gene/EOG091G0HML/get_outgroups.stdout.txt 2> per_gene/EOG091G0HML/get_outgroups.stderr.txt && break || echo -e "try again ($i)" && sleep 15
        done

	#This is quick an dirty for now and just takes the first protein if there is more than one for an outgroup taxon
        bash ../scripts/download_outgroups.sh taxids.txt per_gene/EOG091G0HML/EOG091G0HML.orthodb.fasta > per_gene/EOG091G0HML/EOG091G0HML.outgroup.fasta
        
[Sun Jul  5 22:07:50 2020]
Finished job 3197.
703 of 3292 steps (21%) done

[Sun Jul  5 22:07:50 2020]
rule join_groups:
    input: per_gene/EOG091G0HML/EOG091G0HML.ingroup.fasta, per_gene/EOG091G0HML/EOG091G0HML.outgroup.fasta
    output: per_gene/EOG091G0HML/EOG091G0HML.fasta
    jobid: 2422
    wildcards: BUSCO=EOG091G0HML


        cat per_gene/EOG091G0HML/EOG091G0HML.ingroup.fasta per_gene/EOG091G0HML/EOG091G0HML.outgroup.fasta > per_gene/EOG091G0HML/EOG091G0HML.fasta
        
[Sun Jul  5 22:07:50 2020]
Finished job 2422.
704 of 3292 steps (21%) done

[Sun Jul  5 22:07:50 2020]
rule MSA:
    input: per_gene/EOG091G0HML/EOG091G0HML.fasta
    output: per_gene/EOG091G0HML/EOG091G0HML.clustalo.fasta
    log: per_gene/EOG091G0HML/MSA.stdout.txt, per_gene/EOG091G0HML/MSA.stderr.txt
    jobid: 1964
    wildcards: BUSCO=EOG091G0HML
    threads: 2


        clustalo -i per_gene/EOG091G0HML/EOG091G0HML.fasta -o per_gene/EOG091G0HML/EOG091G0HML.clustalo.fasta --threads=2 1> per_gene/EOG091G0HML/MSA.stdout.txt 2> per_gene/EOG091G0HML/MSA.stderr.txt
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/d68c9691725a7401923680874285c430.simg
[Sun Jul  5 22:07:51 2020]
Finished job 1964.
705 of 3292 steps (21%) done

[Sun Jul  5 22:07:51 2020]
rule score_and_cut:
    input: per_gene/EOG091G0HML/EOG091G0HML.clustalo.fasta
    output: per_gene/EOG091G0HML/ALICUT_EOG091G0HML.clustalo.fasta
    jobid: 1141
    wildcards: BUSCO=EOG091G0HML
    threads: 2


        cd per_gene/EOG091G0HML
        Aliscore.pl -N -r 200000000000000000 -i ../../per_gene/EOG091G0HML/EOG091G0HML.clustalo.fasta &> aliscore.log
        ALICUT.pl -s &> alicut.log
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/63c88c27a0fa300f57066b0ef65fefcb.simg
[Sun Jul  5 22:07:58 2020]
Finished job 969.
706 of 3292 steps (21%) done

[Sun Jul  5 22:07:58 2020]
rule remove_empty:
    input: per_gene/EOG091G0TKH/ALICUT_EOG091G0TKH.clustalo.fasta
    output: per_gene/EOG091G0TKH/empty_check.done
    jobid: 1791
    wildcards: BUSCO=EOG091G0TKH


         if [ "$(cat per_gene/EOG091G0TKH/ALICUT_EOG091G0TKH.clustalo.fasta | grep -v ">" | sed 's/-//g' | grep "^$" | wc -l)" -gt 0 ]
         then
              cp per_gene/EOG091G0TKH/ALICUT_EOG091G0TKH.clustalo.fasta per_gene/EOG091G0TKH/ALICUT_EOG091G0TKH.clustalo.fasta.backup
              bash ../scripts/remove_empty.sh per_gene/EOG091G0TKH/ALICUT_EOG091G0TKH.clustalo.fasta.backup > per_gene/EOG091G0TKH/ALICUT_EOG091G0TKH.clustalo.fasta
         fi
         touch per_gene/EOG091G0TKH/empty_check.done
         
[Sun Jul  5 22:07:58 2020]
Finished job 1791.
707 of 3292 steps (21%) done

[Sun Jul  5 22:07:58 2020]
rule find_best_model:
    input: per_gene/EOG091G0TKH/ALICUT_EOG091G0TKH.clustalo.fasta, per_gene/EOG091G0TKH/empty_check.done
    output: per_gene/EOG091G0TKH/EOG091G0TKH.best_model
    log: per_gene/EOG091G0TKH/find_best_model.stderr.txt
    jobid: 968
    wildcards: BUSCO=EOG091G0TKH
    threads: 2


        cd per_gene/EOG091G0TKH
        if [ ! -d find_best_model ]
        then
            mkdir find_best_model
        fi
        cd find_best_model
        ln -s ../../../per_gene/EOG091G0TKH/ALICUT_EOG091G0TKH.clustalo.fasta EOG091G0TKH.fasta
        ProteinModelSelection.pl EOG091G0TKH.fasta 1> ../../../per_gene/EOG091G0TKH/EOG091G0TKH.best_model 2> ../../../per_gene/EOG091G0TKH/find_best_model.stderr.txt
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/c0c09ee657b1e27f2c5687e0e9aa8d70.simg
[Sun Jul  5 22:08:01 2020]
Finished job 1141.
708 of 3292 steps (22%) done

[Sun Jul  5 22:08:01 2020]
rule remove_empty:
    input: per_gene/EOG091G0HML/ALICUT_EOG091G0HML.clustalo.fasta
    output: per_gene/EOG091G0HML/empty_check.done
    jobid: 1963
    wildcards: BUSCO=EOG091G0HML


         if [ "$(cat per_gene/EOG091G0HML/ALICUT_EOG091G0HML.clustalo.fasta | grep -v ">" | sed 's/-//g' | grep "^$" | wc -l)" -gt 0 ]
         then
              cp per_gene/EOG091G0HML/ALICUT_EOG091G0HML.clustalo.fasta per_gene/EOG091G0HML/ALICUT_EOG091G0HML.clustalo.fasta.backup
              bash ../scripts/remove_empty.sh per_gene/EOG091G0HML/ALICUT_EOG091G0HML.clustalo.fasta.backup > per_gene/EOG091G0HML/ALICUT_EOG091G0HML.clustalo.fasta
         fi
         touch per_gene/EOG091G0HML/empty_check.done
         
[Sun Jul  5 22:08:01 2020]
Finished job 1963.
709 of 3292 steps (22%) done

[Sun Jul  5 22:08:01 2020]
rule find_best_model:
    input: per_gene/EOG091G0HML/ALICUT_EOG091G0HML.clustalo.fasta, per_gene/EOG091G0HML/empty_check.done
    output: per_gene/EOG091G0HML/EOG091G0HML.best_model
    log: per_gene/EOG091G0HML/find_best_model.stderr.txt
    jobid: 1140
    wildcards: BUSCO=EOG091G0HML
    threads: 2


        cd per_gene/EOG091G0HML
        if [ ! -d find_best_model ]
        then
            mkdir find_best_model
        fi
        cd find_best_model
        ln -s ../../../per_gene/EOG091G0HML/ALICUT_EOG091G0HML.clustalo.fasta EOG091G0HML.fasta
        ProteinModelSelection.pl EOG091G0HML.fasta 1> ../../../per_gene/EOG091G0HML/EOG091G0HML.best_model 2> ../../../per_gene/EOG091G0HML/find_best_model.stderr.txt
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/c0c09ee657b1e27f2c5687e0e9aa8d70.simg
[Sun Jul  5 22:08:01 2020]
Finished job 774.
710 of 3292 steps (22%) done

[Sun Jul  5 22:08:02 2020]
rule infer_single_ML:
    input: per_gene/EOG091G0R21/EOG091G0R21.best_model, per_gene/EOG091G0R21/ALICUT_EOG091G0R21.clustalo.fasta
    output: per_gene/EOG091G0R21/EOG091G0R21.raxml.done
    log: per_gene/EOG091G0R21/infer_single_ML.stdout.txt, per_gene/EOG091G0R21/infer_single_ML.stderr.txt
    jobid: 181
    wildcards: BUSCO=EOG091G0R21
    threads: 2


        cd per_gene/EOG091G0R21
	count=$(cat ../../per_gene/EOG091G0R21/ALICUT_EOG091G0R21.clustalo.fasta | grep ">" | wc -l)
	if [ "$count" -gt 5 ]
        then
		RAxMLmodel=$(cat ../../per_gene/EOG091G0R21/EOG091G0R21.best_model | grep "Best" | cut -d ":" -f 2 | tr -d '[:space:]')
                if [ "$(ls -1 | grep "^RAxML" | wc -l)" -ne 0 ]
		then
			rm RAxML*
		fi
        	raxml -f a -T 2 -m PROTGAMMA$RAxMLmodel         	-p 12345 -x 12345 -# 100         	-s ../../per_gene/EOG091G0R21/ALICUT_EOG091G0R21.clustalo.fasta -n EOG091G0R21.clustalo.aln.ALICUT.$RAxMLmodel 		1> ../../per_gene/EOG091G0R21/infer_single_ML.stdout.txt 2> ../../per_gene/EOG091G0R21/infer_single_ML.stderr.txt
	else
		echo "fasta file per_gene/EOG091G0R21/ALICUT_EOG091G0R21.clustalo.fasta contains fewer than 5 sequences - skipped" > ../../per_gene/EOG091G0R21/infer_single_ML.stdout.txt
		touch raxml.skipped
	fi
        touch ../../per_gene/EOG091G0R21/EOG091G0R21.raxml.done
        
[Sun Jul  5 22:08:02 2020]
Finished job 117.
711 of 3292 steps (22%) done

[Sun Jul  5 22:08:02 2020]
rule get_seqs:
    input: /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ingroup.txt, /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/outgroup.txt
    output: per_gene/EOG091G0GQO/EOG091G0GQO.ingroup.fasta
    log: per_gene/EOG091G0GQO/get_seqs.stdout.txt, per_gene/EOG091G0GQO/get_seqs.stderr.txt
    jobid: 2694
    wildcards: BUSCO=EOG091G0GQO
    threads: 2


	basedir=$(pwd)
        cd per_gene/EOG091G0GQO
        
        bash $basedir/../scripts/fetch_seqs.sh EOG091G0GQO /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ingroup.txt /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/outgroup.txt 1> ../../per_gene/EOG091G0GQO/get_seqs.stdout.txt 2> ../../per_gene/EOG091G0GQO/get_seqs.stderr.txt
	mv EOG091G0GQO.fasta $basedir/per_gene/EOG091G0GQO/EOG091G0GQO.ingroup.fasta
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/72476f9d9a5bd0627b4d721143a21354.simg
[33mJob counts:
	count	jobs
	1	infer_single_ML
	1[0m
[33m
        cd per_gene/EOG091G0R21
	count=$(cat ../../per_gene/EOG091G0R21/ALICUT_EOG091G0R21.clustalo.fasta | grep ">" | wc -l)
	if [ "$count" -gt 5 ]
        then
		RAxMLmodel=$(cat ../../per_gene/EOG091G0R21/EOG091G0R21.best_model | grep "Best" | cut -d ":" -f 2 | tr -d '[:space:]')
                if [ "$(ls -1 | grep "^RAxML" | wc -l)" -ne 0 ]
		then
			rm RAxML*
		fi
        	raxml -f a -T 2 -m PROTGAMMA$RAxMLmodel         	-p 12345 -x 12345 -# 100         	-s ../../per_gene/EOG091G0R21/ALICUT_EOG091G0R21.clustalo.fasta -n EOG091G0R21.clustalo.aln.ALICUT.$RAxMLmodel 		1> ../../per_gene/EOG091G0R21/infer_single_ML.stdout.txt 2> ../../per_gene/EOG091G0R21/infer_single_ML.stderr.txt
	else
		echo "fasta file per_gene/EOG091G0R21/ALICUT_EOG091G0R21.clustalo.fasta contains fewer than 5 sequences - skipped" > ../../per_gene/EOG091G0R21/infer_single_ML.stdout.txt
		touch raxml.skipped
	fi
        touch ../../per_gene/EOG091G0R21/EOG091G0R21.raxml.done
        [0m
[Sun Jul  5 22:08:19 2020]
Finished job 2694.
712 of 3292 steps (22%) done

[Sun Jul  5 22:08:19 2020]
rule get_outgroups:
    input: per_gene/EOG091G0GQO/EOG091G0GQO.ingroup.fasta
    output: per_gene/EOG091G0GQO/EOG091G0GQO.orthodb.fasta, per_gene/EOG091G0GQO/EOG091G0GQO.outgroup.fasta
    log: per_gene/EOG091G0GQO/get_outgroups.stdout.txt, per_gene/EOG091G0GQO/get_outgroups.stderr.txt
    jobid: 2695
    wildcards: BUSCO=EOG091G0GQO


        #download fastas from Orhtodb for BUSCO id
        for i in {1..5}
        do
             wget "http://www.orthodb.org/fasta?query=EOG091G0GQO&level=33208" -O per_gene/EOG091G0GQO/EOG091G0GQO.orthodb.fasta 1> per_gene/EOG091G0GQO/get_outgroups.stdout.txt 2> per_gene/EOG091G0GQO/get_outgroups.stderr.txt && break || echo -e "try again ($i)" && sleep 15
        done

	#This is quick an dirty for now and just takes the first protein if there is more than one for an outgroup taxon
        bash ../scripts/download_outgroups.sh taxids.txt per_gene/EOG091G0GQO/EOG091G0GQO.orthodb.fasta > per_gene/EOG091G0GQO/EOG091G0GQO.outgroup.fasta
        
[Sun Jul  5 22:08:21 2020]
Finished job 2695.
713 of 3292 steps (22%) done

[Sun Jul  5 22:08:21 2020]
rule join_groups:
    input: per_gene/EOG091G0GQO/EOG091G0GQO.ingroup.fasta, per_gene/EOG091G0GQO/EOG091G0GQO.outgroup.fasta
    output: per_gene/EOG091G0GQO/EOG091G0GQO.fasta
    jobid: 2171
    wildcards: BUSCO=EOG091G0GQO


        cat per_gene/EOG091G0GQO/EOG091G0GQO.ingroup.fasta per_gene/EOG091G0GQO/EOG091G0GQO.outgroup.fasta > per_gene/EOG091G0GQO/EOG091G0GQO.fasta
        
[Sun Jul  5 22:08:21 2020]
Finished job 2171.
714 of 3292 steps (22%) done

[Sun Jul  5 22:08:21 2020]
rule MSA:
    input: per_gene/EOG091G0GQO/EOG091G0GQO.fasta
    output: per_gene/EOG091G0GQO/EOG091G0GQO.clustalo.fasta
    log: per_gene/EOG091G0GQO/MSA.stdout.txt, per_gene/EOG091G0GQO/MSA.stderr.txt
    jobid: 1462
    wildcards: BUSCO=EOG091G0GQO
    threads: 2


        clustalo -i per_gene/EOG091G0GQO/EOG091G0GQO.fasta -o per_gene/EOG091G0GQO/EOG091G0GQO.clustalo.fasta --threads=2 1> per_gene/EOG091G0GQO/MSA.stdout.txt 2> per_gene/EOG091G0GQO/MSA.stderr.txt
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/d68c9691725a7401923680874285c430.simg
[Sun Jul  5 22:08:22 2020]
Finished job 1462.
715 of 3292 steps (22%) done

[Sun Jul  5 22:08:22 2020]
rule score_and_cut:
    input: per_gene/EOG091G0GQO/EOG091G0GQO.clustalo.fasta
    output: per_gene/EOG091G0GQO/ALICUT_EOG091G0GQO.clustalo.fasta
    jobid: 639
    wildcards: BUSCO=EOG091G0GQO
    threads: 2


        cd per_gene/EOG091G0GQO
        Aliscore.pl -N -r 200000000000000000 -i ../../per_gene/EOG091G0GQO/EOG091G0GQO.clustalo.fasta &> aliscore.log
        ALICUT.pl -s &> alicut.log
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/63c88c27a0fa300f57066b0ef65fefcb.simg
[Sun Jul  5 22:08:32 2020]
Finished job 639.
716 of 3292 steps (22%) done

[Sun Jul  5 22:08:32 2020]
rule remove_empty:
    input: per_gene/EOG091G0GQO/ALICUT_EOG091G0GQO.clustalo.fasta
    output: per_gene/EOG091G0GQO/empty_check.done
    jobid: 1461
    wildcards: BUSCO=EOG091G0GQO


         if [ "$(cat per_gene/EOG091G0GQO/ALICUT_EOG091G0GQO.clustalo.fasta | grep -v ">" | sed 's/-//g' | grep "^$" | wc -l)" -gt 0 ]
         then
              cp per_gene/EOG091G0GQO/ALICUT_EOG091G0GQO.clustalo.fasta per_gene/EOG091G0GQO/ALICUT_EOG091G0GQO.clustalo.fasta.backup
              bash ../scripts/remove_empty.sh per_gene/EOG091G0GQO/ALICUT_EOG091G0GQO.clustalo.fasta.backup > per_gene/EOG091G0GQO/ALICUT_EOG091G0GQO.clustalo.fasta
         fi
         touch per_gene/EOG091G0GQO/empty_check.done
         
[Sun Jul  5 22:08:32 2020]
Finished job 1461.
717 of 3292 steps (22%) done

[Sun Jul  5 22:08:32 2020]
rule find_best_model:
    input: per_gene/EOG091G0GQO/ALICUT_EOG091G0GQO.clustalo.fasta, per_gene/EOG091G0GQO/empty_check.done
    output: per_gene/EOG091G0GQO/EOG091G0GQO.best_model
    log: per_gene/EOG091G0GQO/find_best_model.stderr.txt
    jobid: 638
    wildcards: BUSCO=EOG091G0GQO
    threads: 2


        cd per_gene/EOG091G0GQO
        if [ ! -d find_best_model ]
        then
            mkdir find_best_model
        fi
        cd find_best_model
        ln -s ../../../per_gene/EOG091G0GQO/ALICUT_EOG091G0GQO.clustalo.fasta EOG091G0GQO.fasta
        ProteinModelSelection.pl EOG091G0GQO.fasta 1> ../../../per_gene/EOG091G0GQO/EOG091G0GQO.best_model 2> ../../../per_gene/EOG091G0GQO/find_best_model.stderr.txt
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/c0c09ee657b1e27f2c5687e0e9aa8d70.simg
[Sun Jul  5 22:08:38 2020]
Finished job 968.
718 of 3292 steps (22%) done

[Sun Jul  5 22:08:38 2020]
rule infer_single_ML:
    input: per_gene/EOG091G0TKH/EOG091G0TKH.best_model, per_gene/EOG091G0TKH/ALICUT_EOG091G0TKH.clustalo.fasta
    output: per_gene/EOG091G0TKH/EOG091G0TKH.raxml.done
    log: per_gene/EOG091G0TKH/infer_single_ML.stdout.txt, per_gene/EOG091G0TKH/infer_single_ML.stderr.txt
    jobid: 278
    wildcards: BUSCO=EOG091G0TKH
    threads: 2


        cd per_gene/EOG091G0TKH
	count=$(cat ../../per_gene/EOG091G0TKH/ALICUT_EOG091G0TKH.clustalo.fasta | grep ">" | wc -l)
	if [ "$count" -gt 5 ]
        then
		RAxMLmodel=$(cat ../../per_gene/EOG091G0TKH/EOG091G0TKH.best_model | grep "Best" | cut -d ":" -f 2 | tr -d '[:space:]')
                if [ "$(ls -1 | grep "^RAxML" | wc -l)" -ne 0 ]
		then
			rm RAxML*
		fi
        	raxml -f a -T 2 -m PROTGAMMA$RAxMLmodel         	-p 12345 -x 12345 -# 100         	-s ../../per_gene/EOG091G0TKH/ALICUT_EOG091G0TKH.clustalo.fasta -n EOG091G0TKH.clustalo.aln.ALICUT.$RAxMLmodel 		1> ../../per_gene/EOG091G0TKH/infer_single_ML.stdout.txt 2> ../../per_gene/EOG091G0TKH/infer_single_ML.stderr.txt
	else
		echo "fasta file per_gene/EOG091G0TKH/ALICUT_EOG091G0TKH.clustalo.fasta contains fewer than 5 sequences - skipped" > ../../per_gene/EOG091G0TKH/infer_single_ML.stdout.txt
		touch raxml.skipped
	fi
        touch ../../per_gene/EOG091G0TKH/EOG091G0TKH.raxml.done
        
[33mJob counts:
	count	jobs
	1	infer_single_ML
	1[0m
[33m
        cd per_gene/EOG091G0TKH
	count=$(cat ../../per_gene/EOG091G0TKH/ALICUT_EOG091G0TKH.clustalo.fasta | grep ">" | wc -l)
	if [ "$count" -gt 5 ]
        then
		RAxMLmodel=$(cat ../../per_gene/EOG091G0TKH/EOG091G0TKH.best_model | grep "Best" | cut -d ":" -f 2 | tr -d '[:space:]')
                if [ "$(ls -1 | grep "^RAxML" | wc -l)" -ne 0 ]
		then
			rm RAxML*
		fi
        	raxml -f a -T 2 -m PROTGAMMA$RAxMLmodel         	-p 12345 -x 12345 -# 100         	-s ../../per_gene/EOG091G0TKH/ALICUT_EOG091G0TKH.clustalo.fasta -n EOG091G0TKH.clustalo.aln.ALICUT.$RAxMLmodel 		1> ../../per_gene/EOG091G0TKH/infer_single_ML.stdout.txt 2> ../../per_gene/EOG091G0TKH/infer_single_ML.stderr.txt
	else
		echo "fasta file per_gene/EOG091G0TKH/ALICUT_EOG091G0TKH.clustalo.fasta contains fewer than 5 sequences - skipped" > ../../per_gene/EOG091G0TKH/infer_single_ML.stdout.txt
		touch raxml.skipped
	fi
        touch ../../per_gene/EOG091G0TKH/EOG091G0TKH.raxml.done
        [0m
[Sun Jul  5 22:08:46 2020]
Finished job 1140.
719 of 3292 steps (22%) done

[Sun Jul  5 22:08:46 2020]
rule infer_single_ML:
    input: per_gene/EOG091G0HML/EOG091G0HML.best_model, per_gene/EOG091G0HML/ALICUT_EOG091G0HML.clustalo.fasta
    output: per_gene/EOG091G0HML/EOG091G0HML.raxml.done
    log: per_gene/EOG091G0HML/infer_single_ML.stdout.txt, per_gene/EOG091G0HML/infer_single_ML.stderr.txt
    jobid: 364
    wildcards: BUSCO=EOG091G0HML
    threads: 2


        cd per_gene/EOG091G0HML
	count=$(cat ../../per_gene/EOG091G0HML/ALICUT_EOG091G0HML.clustalo.fasta | grep ">" | wc -l)
	if [ "$count" -gt 5 ]
        then
		RAxMLmodel=$(cat ../../per_gene/EOG091G0HML/EOG091G0HML.best_model | grep "Best" | cut -d ":" -f 2 | tr -d '[:space:]')
                if [ "$(ls -1 | grep "^RAxML" | wc -l)" -ne 0 ]
		then
			rm RAxML*
		fi
        	raxml -f a -T 2 -m PROTGAMMA$RAxMLmodel         	-p 12345 -x 12345 -# 100         	-s ../../per_gene/EOG091G0HML/ALICUT_EOG091G0HML.clustalo.fasta -n EOG091G0HML.clustalo.aln.ALICUT.$RAxMLmodel 		1> ../../per_gene/EOG091G0HML/infer_single_ML.stdout.txt 2> ../../per_gene/EOG091G0HML/infer_single_ML.stderr.txt
	else
		echo "fasta file per_gene/EOG091G0HML/ALICUT_EOG091G0HML.clustalo.fasta contains fewer than 5 sequences - skipped" > ../../per_gene/EOG091G0HML/infer_single_ML.stdout.txt
		touch raxml.skipped
	fi
        touch ../../per_gene/EOG091G0HML/EOG091G0HML.raxml.done
        
[33mJob counts:
	count	jobs
	1	infer_single_ML
	1[0m
[33m
        cd per_gene/EOG091G0HML
	count=$(cat ../../per_gene/EOG091G0HML/ALICUT_EOG091G0HML.clustalo.fasta | grep ">" | wc -l)
	if [ "$count" -gt 5 ]
        then
		RAxMLmodel=$(cat ../../per_gene/EOG091G0HML/EOG091G0HML.best_model | grep "Best" | cut -d ":" -f 2 | tr -d '[:space:]')
                if [ "$(ls -1 | grep "^RAxML" | wc -l)" -ne 0 ]
		then
			rm RAxML*
		fi
        	raxml -f a -T 2 -m PROTGAMMA$RAxMLmodel         	-p 12345 -x 12345 -# 100         	-s ../../per_gene/EOG091G0HML/ALICUT_EOG091G0HML.clustalo.fasta -n EOG091G0HML.clustalo.aln.ALICUT.$RAxMLmodel 		1> ../../per_gene/EOG091G0HML/infer_single_ML.stdout.txt 2> ../../per_gene/EOG091G0HML/infer_single_ML.stderr.txt
	else
		echo "fasta file per_gene/EOG091G0HML/ALICUT_EOG091G0HML.clustalo.fasta contains fewer than 5 sequences - skipped" > ../../per_gene/EOG091G0HML/infer_single_ML.stdout.txt
		touch raxml.skipped
	fi
        touch ../../per_gene/EOG091G0HML/EOG091G0HML.raxml.done
        [0m
[Sun Jul  5 22:09:14 2020]
Finished job 265.
720 of 3292 steps (22%) done

[Sun Jul  5 22:09:14 2020]
rule get_seqs:
    input: /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ingroup.txt, /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/outgroup.txt
    output: per_gene/EOG091G0M24/EOG091G0M24.ingroup.fasta
    log: per_gene/EOG091G0M24/get_seqs.stdout.txt, per_gene/EOG091G0M24/get_seqs.stderr.txt
    jobid: 3226
    wildcards: BUSCO=EOG091G0M24
    threads: 2


	basedir=$(pwd)
        cd per_gene/EOG091G0M24
        
        bash $basedir/../scripts/fetch_seqs.sh EOG091G0M24 /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ingroup.txt /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/outgroup.txt 1> ../../per_gene/EOG091G0M24/get_seqs.stdout.txt 2> ../../per_gene/EOG091G0M24/get_seqs.stderr.txt
	mv EOG091G0M24.fasta $basedir/per_gene/EOG091G0M24/EOG091G0M24.ingroup.fasta
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/72476f9d9a5bd0627b4d721143a21354.simg
[Sun Jul  5 22:09:16 2020]
Finished job 638.
721 of 3292 steps (22%) done

[Sun Jul  5 22:09:16 2020]
rule infer_single_ML:
    input: per_gene/EOG091G0GQO/EOG091G0GQO.best_model, per_gene/EOG091G0GQO/ALICUT_EOG091G0GQO.clustalo.fasta
    output: per_gene/EOG091G0GQO/EOG091G0GQO.raxml.done
    log: per_gene/EOG091G0GQO/infer_single_ML.stdout.txt, per_gene/EOG091G0GQO/infer_single_ML.stderr.txt
    jobid: 113
    wildcards: BUSCO=EOG091G0GQO
    threads: 2


        cd per_gene/EOG091G0GQO
	count=$(cat ../../per_gene/EOG091G0GQO/ALICUT_EOG091G0GQO.clustalo.fasta | grep ">" | wc -l)
	if [ "$count" -gt 5 ]
        then
		RAxMLmodel=$(cat ../../per_gene/EOG091G0GQO/EOG091G0GQO.best_model | grep "Best" | cut -d ":" -f 2 | tr -d '[:space:]')
                if [ "$(ls -1 | grep "^RAxML" | wc -l)" -ne 0 ]
		then
			rm RAxML*
		fi
        	raxml -f a -T 2 -m PROTGAMMA$RAxMLmodel         	-p 12345 -x 12345 -# 100         	-s ../../per_gene/EOG091G0GQO/ALICUT_EOG091G0GQO.clustalo.fasta -n EOG091G0GQO.clustalo.aln.ALICUT.$RAxMLmodel 		1> ../../per_gene/EOG091G0GQO/infer_single_ML.stdout.txt 2> ../../per_gene/EOG091G0GQO/infer_single_ML.stderr.txt
	else
		echo "fasta file per_gene/EOG091G0GQO/ALICUT_EOG091G0GQO.clustalo.fasta contains fewer than 5 sequences - skipped" > ../../per_gene/EOG091G0GQO/infer_single_ML.stdout.txt
		touch raxml.skipped
	fi
        touch ../../per_gene/EOG091G0GQO/EOG091G0GQO.raxml.done
        
[33mJob counts:
	count	jobs
	1	infer_single_ML
	1[0m
[33m
        cd per_gene/EOG091G0GQO
	count=$(cat ../../per_gene/EOG091G0GQO/ALICUT_EOG091G0GQO.clustalo.fasta | grep ">" | wc -l)
	if [ "$count" -gt 5 ]
        then
		RAxMLmodel=$(cat ../../per_gene/EOG091G0GQO/EOG091G0GQO.best_model | grep "Best" | cut -d ":" -f 2 | tr -d '[:space:]')
                if [ "$(ls -1 | grep "^RAxML" | wc -l)" -ne 0 ]
		then
			rm RAxML*
		fi
        	raxml -f a -T 2 -m PROTGAMMA$RAxMLmodel         	-p 12345 -x 12345 -# 100         	-s ../../per_gene/EOG091G0GQO/ALICUT_EOG091G0GQO.clustalo.fasta -n EOG091G0GQO.clustalo.aln.ALICUT.$RAxMLmodel 		1> ../../per_gene/EOG091G0GQO/infer_single_ML.stdout.txt 2> ../../per_gene/EOG091G0GQO/infer_single_ML.stderr.txt
	else
		echo "fasta file per_gene/EOG091G0GQO/ALICUT_EOG091G0GQO.clustalo.fasta contains fewer than 5 sequences - skipped" > ../../per_gene/EOG091G0GQO/infer_single_ML.stdout.txt
		touch raxml.skipped
	fi
        touch ../../per_gene/EOG091G0GQO/EOG091G0GQO.raxml.done
        [0m
[Sun Jul  5 22:09:18 2020]
Finished job 297.
722 of 3292 steps (22%) done

[Sun Jul  5 22:09:18 2020]
rule get_seqs:
    input: /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ingroup.txt, /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/outgroup.txt
    output: per_gene/EOG091G049W/EOG091G049W.ingroup.fasta
    log: per_gene/EOG091G049W/get_seqs.stdout.txt, per_gene/EOG091G049W/get_seqs.stderr.txt
    jobid: 3132
    wildcards: BUSCO=EOG091G049W
    threads: 2


	basedir=$(pwd)
        cd per_gene/EOG091G049W
        
        bash $basedir/../scripts/fetch_seqs.sh EOG091G049W /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ingroup.txt /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/outgroup.txt 1> ../../per_gene/EOG091G049W/get_seqs.stdout.txt 2> ../../per_gene/EOG091G049W/get_seqs.stderr.txt
	mv EOG091G049W.fasta $basedir/per_gene/EOG091G049W/EOG091G049W.ingroup.fasta
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/72476f9d9a5bd0627b4d721143a21354.simg
[Sun Jul  5 22:09:24 2020]
Finished job 68.
723 of 3292 steps (22%) done

[Sun Jul  5 22:09:24 2020]
rule get_seqs:
    input: /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ingroup.txt, /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/outgroup.txt
    output: per_gene/EOG091G0NTO/EOG091G0NTO.ingroup.fasta
    log: per_gene/EOG091G0NTO/get_seqs.stdout.txt, per_gene/EOG091G0NTO/get_seqs.stderr.txt
    jobid: 3006
    wildcards: BUSCO=EOG091G0NTO
    threads: 2


	basedir=$(pwd)
        cd per_gene/EOG091G0NTO
        
        bash $basedir/../scripts/fetch_seqs.sh EOG091G0NTO /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ingroup.txt /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/outgroup.txt 1> ../../per_gene/EOG091G0NTO/get_seqs.stdout.txt 2> ../../per_gene/EOG091G0NTO/get_seqs.stderr.txt
	mv EOG091G0NTO.fasta $basedir/per_gene/EOG091G0NTO/EOG091G0NTO.ingroup.fasta
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/72476f9d9a5bd0627b4d721143a21354.simg
[Sun Jul  5 22:09:29 2020]
Finished job 3226.
724 of 3292 steps (22%) done

[Sun Jul  5 22:09:29 2020]
rule get_outgroups:
    input: per_gene/EOG091G0M24/EOG091G0M24.ingroup.fasta
    output: per_gene/EOG091G0M24/EOG091G0M24.orthodb.fasta, per_gene/EOG091G0M24/EOG091G0M24.outgroup.fasta
    log: per_gene/EOG091G0M24/get_outgroups.stdout.txt, per_gene/EOG091G0M24/get_outgroups.stderr.txt
    jobid: 3227
    wildcards: BUSCO=EOG091G0M24


        #download fastas from Orhtodb for BUSCO id
        for i in {1..5}
        do
             wget "http://www.orthodb.org/fasta?query=EOG091G0M24&level=33208" -O per_gene/EOG091G0M24/EOG091G0M24.orthodb.fasta 1> per_gene/EOG091G0M24/get_outgroups.stdout.txt 2> per_gene/EOG091G0M24/get_outgroups.stderr.txt && break || echo -e "try again ($i)" && sleep 15
        done

	#This is quick an dirty for now and just takes the first protein if there is more than one for an outgroup taxon
        bash ../scripts/download_outgroups.sh taxids.txt per_gene/EOG091G0M24/EOG091G0M24.orthodb.fasta > per_gene/EOG091G0M24/EOG091G0M24.outgroup.fasta
        
[Sun Jul  5 22:09:30 2020]
Finished job 3227.
725 of 3292 steps (22%) done

[Sun Jul  5 22:09:30 2020]
rule join_groups:
    input: per_gene/EOG091G0M24/EOG091G0M24.ingroup.fasta, per_gene/EOG091G0M24/EOG091G0M24.outgroup.fasta
    output: per_gene/EOG091G0M24/EOG091G0M24.fasta
    jobid: 2437
    wildcards: BUSCO=EOG091G0M24


        cat per_gene/EOG091G0M24/EOG091G0M24.ingroup.fasta per_gene/EOG091G0M24/EOG091G0M24.outgroup.fasta > per_gene/EOG091G0M24/EOG091G0M24.fasta
        
[Sun Jul  5 22:09:30 2020]
Finished job 2437.
726 of 3292 steps (22%) done

[Sun Jul  5 22:09:30 2020]
rule MSA:
    input: per_gene/EOG091G0M24/EOG091G0M24.fasta
    output: per_gene/EOG091G0M24/EOG091G0M24.clustalo.fasta
    log: per_gene/EOG091G0M24/MSA.stdout.txt, per_gene/EOG091G0M24/MSA.stderr.txt
    jobid: 1994
    wildcards: BUSCO=EOG091G0M24
    threads: 2


        clustalo -i per_gene/EOG091G0M24/EOG091G0M24.fasta -o per_gene/EOG091G0M24/EOG091G0M24.clustalo.fasta --threads=2 1> per_gene/EOG091G0M24/MSA.stdout.txt 2> per_gene/EOG091G0M24/MSA.stderr.txt
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/d68c9691725a7401923680874285c430.simg
[Sun Jul  5 22:09:31 2020]
Finished job 1994.
727 of 3292 steps (22%) done

[Sun Jul  5 22:09:31 2020]
rule score_and_cut:
    input: per_gene/EOG091G0M24/EOG091G0M24.clustalo.fasta
    output: per_gene/EOG091G0M24/ALICUT_EOG091G0M24.clustalo.fasta
    jobid: 1171
    wildcards: BUSCO=EOG091G0M24
    threads: 2


        cd per_gene/EOG091G0M24
        Aliscore.pl -N -r 200000000000000000 -i ../../per_gene/EOG091G0M24/EOG091G0M24.clustalo.fasta &> aliscore.log
        ALICUT.pl -s &> alicut.log
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/63c88c27a0fa300f57066b0ef65fefcb.simg
[Sun Jul  5 22:09:34 2020]
Finished job 3132.
728 of 3292 steps (22%) done

[Sun Jul  5 22:09:34 2020]
rule get_outgroups:
    input: per_gene/EOG091G049W/EOG091G049W.ingroup.fasta
    output: per_gene/EOG091G049W/EOG091G049W.orthodb.fasta, per_gene/EOG091G049W/EOG091G049W.outgroup.fasta
    log: per_gene/EOG091G049W/get_outgroups.stdout.txt, per_gene/EOG091G049W/get_outgroups.stderr.txt
    jobid: 3133
    wildcards: BUSCO=EOG091G049W


        #download fastas from Orhtodb for BUSCO id
        for i in {1..5}
        do
             wget "http://www.orthodb.org/fasta?query=EOG091G049W&level=33208" -O per_gene/EOG091G049W/EOG091G049W.orthodb.fasta 1> per_gene/EOG091G049W/get_outgroups.stdout.txt 2> per_gene/EOG091G049W/get_outgroups.stderr.txt && break || echo -e "try again ($i)" && sleep 15
        done

	#This is quick an dirty for now and just takes the first protein if there is more than one for an outgroup taxon
        bash ../scripts/download_outgroups.sh taxids.txt per_gene/EOG091G049W/EOG091G049W.orthodb.fasta > per_gene/EOG091G049W/EOG091G049W.outgroup.fasta
        
[Sun Jul  5 22:09:34 2020]
Finished job 3133.
729 of 3292 steps (22%) done

[Sun Jul  5 22:09:35 2020]
rule join_groups:
    input: per_gene/EOG091G049W/EOG091G049W.ingroup.fasta, per_gene/EOG091G049W/EOG091G049W.outgroup.fasta
    output: per_gene/EOG091G049W/EOG091G049W.fasta
    jobid: 2390
    wildcards: BUSCO=EOG091G049W


        cat per_gene/EOG091G049W/EOG091G049W.ingroup.fasta per_gene/EOG091G049W/EOG091G049W.outgroup.fasta > per_gene/EOG091G049W/EOG091G049W.fasta
        
[Sun Jul  5 22:09:35 2020]
Finished job 2390.
730 of 3292 steps (22%) done

[Sun Jul  5 22:09:35 2020]
rule MSA:
    input: per_gene/EOG091G049W/EOG091G049W.fasta
    output: per_gene/EOG091G049W/EOG091G049W.clustalo.fasta
    log: per_gene/EOG091G049W/MSA.stdout.txt, per_gene/EOG091G049W/MSA.stderr.txt
    jobid: 1900
    wildcards: BUSCO=EOG091G049W
    threads: 2


        clustalo -i per_gene/EOG091G049W/EOG091G049W.fasta -o per_gene/EOG091G049W/EOG091G049W.clustalo.fasta --threads=2 1> per_gene/EOG091G049W/MSA.stdout.txt 2> per_gene/EOG091G049W/MSA.stderr.txt
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/d68c9691725a7401923680874285c430.simg
[Sun Jul  5 22:09:37 2020]
Finished job 1900.
731 of 3292 steps (22%) done

[Sun Jul  5 22:09:37 2020]
rule score_and_cut:
    input: per_gene/EOG091G049W/EOG091G049W.clustalo.fasta
    output: per_gene/EOG091G049W/ALICUT_EOG091G049W.clustalo.fasta
    jobid: 1077
    wildcards: BUSCO=EOG091G049W
    threads: 2


        cd per_gene/EOG091G049W
        Aliscore.pl -N -r 200000000000000000 -i ../../per_gene/EOG091G049W/EOG091G049W.clustalo.fasta &> aliscore.log
        ALICUT.pl -s &> alicut.log
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/63c88c27a0fa300f57066b0ef65fefcb.simg
[Sun Jul  5 22:09:41 2020]
Finished job 1171.
732 of 3292 steps (22%) done

[Sun Jul  5 22:09:41 2020]
rule remove_empty:
    input: per_gene/EOG091G0M24/ALICUT_EOG091G0M24.clustalo.fasta
    output: per_gene/EOG091G0M24/empty_check.done
    jobid: 1993
    wildcards: BUSCO=EOG091G0M24


         if [ "$(cat per_gene/EOG091G0M24/ALICUT_EOG091G0M24.clustalo.fasta | grep -v ">" | sed 's/-//g' | grep "^$" | wc -l)" -gt 0 ]
         then
              cp per_gene/EOG091G0M24/ALICUT_EOG091G0M24.clustalo.fasta per_gene/EOG091G0M24/ALICUT_EOG091G0M24.clustalo.fasta.backup
              bash ../scripts/remove_empty.sh per_gene/EOG091G0M24/ALICUT_EOG091G0M24.clustalo.fasta.backup > per_gene/EOG091G0M24/ALICUT_EOG091G0M24.clustalo.fasta
         fi
         touch per_gene/EOG091G0M24/empty_check.done
         
[Sun Jul  5 22:09:41 2020]
Finished job 1993.
733 of 3292 steps (22%) done

[Sun Jul  5 22:09:41 2020]
rule find_best_model:
    input: per_gene/EOG091G0M24/ALICUT_EOG091G0M24.clustalo.fasta, per_gene/EOG091G0M24/empty_check.done
    output: per_gene/EOG091G0M24/EOG091G0M24.best_model
    log: per_gene/EOG091G0M24/find_best_model.stderr.txt
    jobid: 1170
    wildcards: BUSCO=EOG091G0M24
    threads: 2


        cd per_gene/EOG091G0M24
        if [ ! -d find_best_model ]
        then
            mkdir find_best_model
        fi
        cd find_best_model
        ln -s ../../../per_gene/EOG091G0M24/ALICUT_EOG091G0M24.clustalo.fasta EOG091G0M24.fasta
        ProteinModelSelection.pl EOG091G0M24.fasta 1> ../../../per_gene/EOG091G0M24/EOG091G0M24.best_model 2> ../../../per_gene/EOG091G0M24/find_best_model.stderr.txt
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/c0c09ee657b1e27f2c5687e0e9aa8d70.simg
[Sun Jul  5 22:09:41 2020]
Finished job 3006.
734 of 3292 steps (22%) done

[Sun Jul  5 22:09:41 2020]
rule get_outgroups:
    input: per_gene/EOG091G0NTO/EOG091G0NTO.ingroup.fasta
    output: per_gene/EOG091G0NTO/EOG091G0NTO.orthodb.fasta, per_gene/EOG091G0NTO/EOG091G0NTO.outgroup.fasta
    log: per_gene/EOG091G0NTO/get_outgroups.stdout.txt, per_gene/EOG091G0NTO/get_outgroups.stderr.txt
    jobid: 3007
    wildcards: BUSCO=EOG091G0NTO


        #download fastas from Orhtodb for BUSCO id
        for i in {1..5}
        do
             wget "http://www.orthodb.org/fasta?query=EOG091G0NTO&level=33208" -O per_gene/EOG091G0NTO/EOG091G0NTO.orthodb.fasta 1> per_gene/EOG091G0NTO/get_outgroups.stdout.txt 2> per_gene/EOG091G0NTO/get_outgroups.stderr.txt && break || echo -e "try again ($i)" && sleep 15
        done

	#This is quick an dirty for now and just takes the first protein if there is more than one for an outgroup taxon
        bash ../scripts/download_outgroups.sh taxids.txt per_gene/EOG091G0NTO/EOG091G0NTO.orthodb.fasta > per_gene/EOG091G0NTO/EOG091G0NTO.outgroup.fasta
        
[Sun Jul  5 22:09:42 2020]
Finished job 3007.
735 of 3292 steps (22%) done

[Sun Jul  5 22:09:42 2020]
rule join_groups:
    input: per_gene/EOG091G0NTO/EOG091G0NTO.ingroup.fasta, per_gene/EOG091G0NTO/EOG091G0NTO.outgroup.fasta
    output: per_gene/EOG091G0NTO/EOG091G0NTO.fasta
    jobid: 2327
    wildcards: BUSCO=EOG091G0NTO


        cat per_gene/EOG091G0NTO/EOG091G0NTO.ingroup.fasta per_gene/EOG091G0NTO/EOG091G0NTO.outgroup.fasta > per_gene/EOG091G0NTO/EOG091G0NTO.fasta
        
[Sun Jul  5 22:09:43 2020]
Finished job 2327.
736 of 3292 steps (22%) done

[Sun Jul  5 22:09:43 2020]
rule MSA:
    input: per_gene/EOG091G0NTO/EOG091G0NTO.fasta
    output: per_gene/EOG091G0NTO/EOG091G0NTO.clustalo.fasta
    log: per_gene/EOG091G0NTO/MSA.stdout.txt, per_gene/EOG091G0NTO/MSA.stderr.txt
    jobid: 1774
    wildcards: BUSCO=EOG091G0NTO
    threads: 2


        clustalo -i per_gene/EOG091G0NTO/EOG091G0NTO.fasta -o per_gene/EOG091G0NTO/EOG091G0NTO.clustalo.fasta --threads=2 1> per_gene/EOG091G0NTO/MSA.stdout.txt 2> per_gene/EOG091G0NTO/MSA.stderr.txt
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/d68c9691725a7401923680874285c430.simg
[Sun Jul  5 22:09:44 2020]
Finished job 1774.
737 of 3292 steps (22%) done

[Sun Jul  5 22:09:44 2020]
rule score_and_cut:
    input: per_gene/EOG091G0NTO/EOG091G0NTO.clustalo.fasta
    output: per_gene/EOG091G0NTO/ALICUT_EOG091G0NTO.clustalo.fasta
    jobid: 951
    wildcards: BUSCO=EOG091G0NTO
    threads: 2


        cd per_gene/EOG091G0NTO
        Aliscore.pl -N -r 200000000000000000 -i ../../per_gene/EOG091G0NTO/EOG091G0NTO.clustalo.fasta &> aliscore.log
        ALICUT.pl -s &> alicut.log
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/63c88c27a0fa300f57066b0ef65fefcb.simg
[Sun Jul  5 22:09:48 2020]
Finished job 1077.
738 of 3292 steps (22%) done

[Sun Jul  5 22:09:48 2020]
rule remove_empty:
    input: per_gene/EOG091G049W/ALICUT_EOG091G049W.clustalo.fasta
    output: per_gene/EOG091G049W/empty_check.done
    jobid: 1899
    wildcards: BUSCO=EOG091G049W


         if [ "$(cat per_gene/EOG091G049W/ALICUT_EOG091G049W.clustalo.fasta | grep -v ">" | sed 's/-//g' | grep "^$" | wc -l)" -gt 0 ]
         then
              cp per_gene/EOG091G049W/ALICUT_EOG091G049W.clustalo.fasta per_gene/EOG091G049W/ALICUT_EOG091G049W.clustalo.fasta.backup
              bash ../scripts/remove_empty.sh per_gene/EOG091G049W/ALICUT_EOG091G049W.clustalo.fasta.backup > per_gene/EOG091G049W/ALICUT_EOG091G049W.clustalo.fasta
         fi
         touch per_gene/EOG091G049W/empty_check.done
         
[Sun Jul  5 22:09:48 2020]
Finished job 1899.
739 of 3292 steps (22%) done

[Sun Jul  5 22:09:48 2020]
rule find_best_model:
    input: per_gene/EOG091G049W/ALICUT_EOG091G049W.clustalo.fasta, per_gene/EOG091G049W/empty_check.done
    output: per_gene/EOG091G049W/EOG091G049W.best_model
    log: per_gene/EOG091G049W/find_best_model.stderr.txt
    jobid: 1076
    wildcards: BUSCO=EOG091G049W
    threads: 2


        cd per_gene/EOG091G049W
        if [ ! -d find_best_model ]
        then
            mkdir find_best_model
        fi
        cd find_best_model
        ln -s ../../../per_gene/EOG091G049W/ALICUT_EOG091G049W.clustalo.fasta EOG091G049W.fasta
        ProteinModelSelection.pl EOG091G049W.fasta 1> ../../../per_gene/EOG091G049W/EOG091G049W.best_model 2> ../../../per_gene/EOG091G049W/find_best_model.stderr.txt
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/c0c09ee657b1e27f2c5687e0e9aa8d70.simg
[Sun Jul  5 22:09:55 2020]
Finished job 951.
740 of 3292 steps (22%) done

[Sun Jul  5 22:09:55 2020]
rule remove_empty:
    input: per_gene/EOG091G0NTO/ALICUT_EOG091G0NTO.clustalo.fasta
    output: per_gene/EOG091G0NTO/empty_check.done
    jobid: 1773
    wildcards: BUSCO=EOG091G0NTO


         if [ "$(cat per_gene/EOG091G0NTO/ALICUT_EOG091G0NTO.clustalo.fasta | grep -v ">" | sed 's/-//g' | grep "^$" | wc -l)" -gt 0 ]
         then
              cp per_gene/EOG091G0NTO/ALICUT_EOG091G0NTO.clustalo.fasta per_gene/EOG091G0NTO/ALICUT_EOG091G0NTO.clustalo.fasta.backup
              bash ../scripts/remove_empty.sh per_gene/EOG091G0NTO/ALICUT_EOG091G0NTO.clustalo.fasta.backup > per_gene/EOG091G0NTO/ALICUT_EOG091G0NTO.clustalo.fasta
         fi
         touch per_gene/EOG091G0NTO/empty_check.done
         
[Sun Jul  5 22:09:55 2020]
Finished job 1773.
741 of 3292 steps (23%) done

[Sun Jul  5 22:09:55 2020]
rule find_best_model:
    input: per_gene/EOG091G0NTO/ALICUT_EOG091G0NTO.clustalo.fasta, per_gene/EOG091G0NTO/empty_check.done
    output: per_gene/EOG091G0NTO/EOG091G0NTO.best_model
    log: per_gene/EOG091G0NTO/find_best_model.stderr.txt
    jobid: 950
    wildcards: BUSCO=EOG091G0NTO
    threads: 2


        cd per_gene/EOG091G0NTO
        if [ ! -d find_best_model ]
        then
            mkdir find_best_model
        fi
        cd find_best_model
        ln -s ../../../per_gene/EOG091G0NTO/ALICUT_EOG091G0NTO.clustalo.fasta EOG091G0NTO.fasta
        ProteinModelSelection.pl EOG091G0NTO.fasta 1> ../../../per_gene/EOG091G0NTO/EOG091G0NTO.best_model 2> ../../../per_gene/EOG091G0NTO/find_best_model.stderr.txt
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/c0c09ee657b1e27f2c5687e0e9aa8d70.simg
[Sun Jul  5 22:09:56 2020]
Finished job 201.
742 of 3292 steps (23%) done

[Sun Jul  5 22:09:57 2020]
rule get_seqs:
    input: /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ingroup.txt, /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/outgroup.txt
    output: per_gene/EOG091G0I8J/EOG091G0I8J.ingroup.fasta
    log: per_gene/EOG091G0I8J/get_seqs.stdout.txt, per_gene/EOG091G0I8J/get_seqs.stderr.txt
    jobid: 2708
    wildcards: BUSCO=EOG091G0I8J
    threads: 2


	basedir=$(pwd)
        cd per_gene/EOG091G0I8J
        
        bash $basedir/../scripts/fetch_seqs.sh EOG091G0I8J /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ingroup.txt /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/outgroup.txt 1> ../../per_gene/EOG091G0I8J/get_seqs.stdout.txt 2> ../../per_gene/EOG091G0I8J/get_seqs.stderr.txt
	mv EOG091G0I8J.fasta $basedir/per_gene/EOG091G0I8J/EOG091G0I8J.ingroup.fasta
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/72476f9d9a5bd0627b4d721143a21354.simg
[Sun Jul  5 22:10:12 2020]
Finished job 2708.
743 of 3292 steps (23%) done

[Sun Jul  5 22:10:12 2020]
rule get_outgroups:
    input: per_gene/EOG091G0I8J/EOG091G0I8J.ingroup.fasta
    output: per_gene/EOG091G0I8J/EOG091G0I8J.orthodb.fasta, per_gene/EOG091G0I8J/EOG091G0I8J.outgroup.fasta
    log: per_gene/EOG091G0I8J/get_outgroups.stdout.txt, per_gene/EOG091G0I8J/get_outgroups.stderr.txt
    jobid: 2709
    wildcards: BUSCO=EOG091G0I8J


        #download fastas from Orhtodb for BUSCO id
        for i in {1..5}
        do
             wget "http://www.orthodb.org/fasta?query=EOG091G0I8J&level=33208" -O per_gene/EOG091G0I8J/EOG091G0I8J.orthodb.fasta 1> per_gene/EOG091G0I8J/get_outgroups.stdout.txt 2> per_gene/EOG091G0I8J/get_outgroups.stderr.txt && break || echo -e "try again ($i)" && sleep 15
        done

	#This is quick an dirty for now and just takes the first protein if there is more than one for an outgroup taxon
        bash ../scripts/download_outgroups.sh taxids.txt per_gene/EOG091G0I8J/EOG091G0I8J.orthodb.fasta > per_gene/EOG091G0I8J/EOG091G0I8J.outgroup.fasta
        
[Sun Jul  5 22:10:14 2020]
Finished job 2709.
744 of 3292 steps (23%) done

[Sun Jul  5 22:10:14 2020]
rule join_groups:
    input: per_gene/EOG091G0I8J/EOG091G0I8J.ingroup.fasta, per_gene/EOG091G0I8J/EOG091G0I8J.outgroup.fasta
    output: per_gene/EOG091G0I8J/EOG091G0I8J.fasta
    jobid: 2178
    wildcards: BUSCO=EOG091G0I8J


        cat per_gene/EOG091G0I8J/EOG091G0I8J.ingroup.fasta per_gene/EOG091G0I8J/EOG091G0I8J.outgroup.fasta > per_gene/EOG091G0I8J/EOG091G0I8J.fasta
        
[Sun Jul  5 22:10:14 2020]
Finished job 2178.
745 of 3292 steps (23%) done

[Sun Jul  5 22:10:14 2020]
rule MSA:
    input: per_gene/EOG091G0I8J/EOG091G0I8J.fasta
    output: per_gene/EOG091G0I8J/EOG091G0I8J.clustalo.fasta
    log: per_gene/EOG091G0I8J/MSA.stdout.txt, per_gene/EOG091G0I8J/MSA.stderr.txt
    jobid: 1476
    wildcards: BUSCO=EOG091G0I8J
    threads: 2


        clustalo -i per_gene/EOG091G0I8J/EOG091G0I8J.fasta -o per_gene/EOG091G0I8J/EOG091G0I8J.clustalo.fasta --threads=2 1> per_gene/EOG091G0I8J/MSA.stdout.txt 2> per_gene/EOG091G0I8J/MSA.stderr.txt
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/d68c9691725a7401923680874285c430.simg
[Sun Jul  5 22:10:16 2020]
Finished job 1476.
746 of 3292 steps (23%) done

[Sun Jul  5 22:10:16 2020]
rule score_and_cut:
    input: per_gene/EOG091G0I8J/EOG091G0I8J.clustalo.fasta
    output: per_gene/EOG091G0I8J/ALICUT_EOG091G0I8J.clustalo.fasta
    jobid: 653
    wildcards: BUSCO=EOG091G0I8J
    threads: 2


        cd per_gene/EOG091G0I8J
        Aliscore.pl -N -r 200000000000000000 -i ../../per_gene/EOG091G0I8J/EOG091G0I8J.clustalo.fasta &> aliscore.log
        ALICUT.pl -s &> alicut.log
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/63c88c27a0fa300f57066b0ef65fefcb.simg
[Sun Jul  5 22:10:18 2020]
Finished job 1170.
747 of 3292 steps (23%) done

[Sun Jul  5 22:10:18 2020]
rule infer_single_ML:
    input: per_gene/EOG091G0M24/EOG091G0M24.best_model, per_gene/EOG091G0M24/ALICUT_EOG091G0M24.clustalo.fasta
    output: per_gene/EOG091G0M24/EOG091G0M24.raxml.done
    log: per_gene/EOG091G0M24/infer_single_ML.stdout.txt, per_gene/EOG091G0M24/infer_single_ML.stderr.txt
    jobid: 379
    wildcards: BUSCO=EOG091G0M24
    threads: 2


        cd per_gene/EOG091G0M24
	count=$(cat ../../per_gene/EOG091G0M24/ALICUT_EOG091G0M24.clustalo.fasta | grep ">" | wc -l)
	if [ "$count" -gt 5 ]
        then
		RAxMLmodel=$(cat ../../per_gene/EOG091G0M24/EOG091G0M24.best_model | grep "Best" | cut -d ":" -f 2 | tr -d '[:space:]')
                if [ "$(ls -1 | grep "^RAxML" | wc -l)" -ne 0 ]
		then
			rm RAxML*
		fi
        	raxml -f a -T 2 -m PROTGAMMA$RAxMLmodel         	-p 12345 -x 12345 -# 100         	-s ../../per_gene/EOG091G0M24/ALICUT_EOG091G0M24.clustalo.fasta -n EOG091G0M24.clustalo.aln.ALICUT.$RAxMLmodel 		1> ../../per_gene/EOG091G0M24/infer_single_ML.stdout.txt 2> ../../per_gene/EOG091G0M24/infer_single_ML.stderr.txt
	else
		echo "fasta file per_gene/EOG091G0M24/ALICUT_EOG091G0M24.clustalo.fasta contains fewer than 5 sequences - skipped" > ../../per_gene/EOG091G0M24/infer_single_ML.stdout.txt
		touch raxml.skipped
	fi
        touch ../../per_gene/EOG091G0M24/EOG091G0M24.raxml.done
        
[33mJob counts:
	count	jobs
	1	infer_single_ML
	1[0m
[33m
        cd per_gene/EOG091G0M24
	count=$(cat ../../per_gene/EOG091G0M24/ALICUT_EOG091G0M24.clustalo.fasta | grep ">" | wc -l)
	if [ "$count" -gt 5 ]
        then
		RAxMLmodel=$(cat ../../per_gene/EOG091G0M24/EOG091G0M24.best_model | grep "Best" | cut -d ":" -f 2 | tr -d '[:space:]')
                if [ "$(ls -1 | grep "^RAxML" | wc -l)" -ne 0 ]
		then
			rm RAxML*
		fi
        	raxml -f a -T 2 -m PROTGAMMA$RAxMLmodel         	-p 12345 -x 12345 -# 100         	-s ../../per_gene/EOG091G0M24/ALICUT_EOG091G0M24.clustalo.fasta -n EOG091G0M24.clustalo.aln.ALICUT.$RAxMLmodel 		1> ../../per_gene/EOG091G0M24/infer_single_ML.stdout.txt 2> ../../per_gene/EOG091G0M24/infer_single_ML.stderr.txt
	else
		echo "fasta file per_gene/EOG091G0M24/ALICUT_EOG091G0M24.clustalo.fasta contains fewer than 5 sequences - skipped" > ../../per_gene/EOG091G0M24/infer_single_ML.stdout.txt
		touch raxml.skipped
	fi
        touch ../../per_gene/EOG091G0M24/EOG091G0M24.raxml.done
        [0m
[Sun Jul  5 22:10:25 2020]
Finished job 653.
748 of 3292 steps (23%) done

[Sun Jul  5 22:10:25 2020]
rule remove_empty:
    input: per_gene/EOG091G0I8J/ALICUT_EOG091G0I8J.clustalo.fasta
    output: per_gene/EOG091G0I8J/empty_check.done
    jobid: 1475
    wildcards: BUSCO=EOG091G0I8J


         if [ "$(cat per_gene/EOG091G0I8J/ALICUT_EOG091G0I8J.clustalo.fasta | grep -v ">" | sed 's/-//g' | grep "^$" | wc -l)" -gt 0 ]
         then
              cp per_gene/EOG091G0I8J/ALICUT_EOG091G0I8J.clustalo.fasta per_gene/EOG091G0I8J/ALICUT_EOG091G0I8J.clustalo.fasta.backup
              bash ../scripts/remove_empty.sh per_gene/EOG091G0I8J/ALICUT_EOG091G0I8J.clustalo.fasta.backup > per_gene/EOG091G0I8J/ALICUT_EOG091G0I8J.clustalo.fasta
         fi
         touch per_gene/EOG091G0I8J/empty_check.done
         
[Sun Jul  5 22:10:25 2020]
Finished job 1475.
749 of 3292 steps (23%) done

[Sun Jul  5 22:10:26 2020]
rule find_best_model:
    input: per_gene/EOG091G0I8J/ALICUT_EOG091G0I8J.clustalo.fasta, per_gene/EOG091G0I8J/empty_check.done
    output: per_gene/EOG091G0I8J/EOG091G0I8J.best_model
    log: per_gene/EOG091G0I8J/find_best_model.stderr.txt
    jobid: 652
    wildcards: BUSCO=EOG091G0I8J
    threads: 2


        cd per_gene/EOG091G0I8J
        if [ ! -d find_best_model ]
        then
            mkdir find_best_model
        fi
        cd find_best_model
        ln -s ../../../per_gene/EOG091G0I8J/ALICUT_EOG091G0I8J.clustalo.fasta EOG091G0I8J.fasta
        ProteinModelSelection.pl EOG091G0I8J.fasta 1> ../../../per_gene/EOG091G0I8J/EOG091G0I8J.best_model 2> ../../../per_gene/EOG091G0I8J/find_best_model.stderr.txt
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/c0c09ee657b1e27f2c5687e0e9aa8d70.simg
[Sun Jul  5 22:10:30 2020]
Finished job 259.
750 of 3292 steps (23%) done

[Sun Jul  5 22:10:30 2020]
rule get_seqs:
    input: /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ingroup.txt, /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/outgroup.txt
    output: per_gene/EOG091G0BHV/EOG091G0BHV.ingroup.fasta
    log: per_gene/EOG091G0BHV/get_seqs.stdout.txt, per_gene/EOG091G0BHV/get_seqs.stderr.txt
    jobid: 2634
    wildcards: BUSCO=EOG091G0BHV
    threads: 2


	basedir=$(pwd)
        cd per_gene/EOG091G0BHV
        
        bash $basedir/../scripts/fetch_seqs.sh EOG091G0BHV /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ingroup.txt /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/outgroup.txt 1> ../../per_gene/EOG091G0BHV/get_seqs.stdout.txt 2> ../../per_gene/EOG091G0BHV/get_seqs.stderr.txt
	mv EOG091G0BHV.fasta $basedir/per_gene/EOG091G0BHV/EOG091G0BHV.ingroup.fasta
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/72476f9d9a5bd0627b4d721143a21354.simg
[Sun Jul  5 22:10:36 2020]
Finished job 950.
751 of 3292 steps (23%) done

[Sun Jul  5 22:10:36 2020]
rule infer_single_ML:
    input: per_gene/EOG091G0NTO/EOG091G0NTO.best_model, per_gene/EOG091G0NTO/ALICUT_EOG091G0NTO.clustalo.fasta
    output: per_gene/EOG091G0NTO/EOG091G0NTO.raxml.done
    log: per_gene/EOG091G0NTO/infer_single_ML.stdout.txt, per_gene/EOG091G0NTO/infer_single_ML.stderr.txt
    jobid: 269
    wildcards: BUSCO=EOG091G0NTO
    threads: 2


        cd per_gene/EOG091G0NTO
	count=$(cat ../../per_gene/EOG091G0NTO/ALICUT_EOG091G0NTO.clustalo.fasta | grep ">" | wc -l)
	if [ "$count" -gt 5 ]
        then
		RAxMLmodel=$(cat ../../per_gene/EOG091G0NTO/EOG091G0NTO.best_model | grep "Best" | cut -d ":" -f 2 | tr -d '[:space:]')
                if [ "$(ls -1 | grep "^RAxML" | wc -l)" -ne 0 ]
		then
			rm RAxML*
		fi
        	raxml -f a -T 2 -m PROTGAMMA$RAxMLmodel         	-p 12345 -x 12345 -# 100         	-s ../../per_gene/EOG091G0NTO/ALICUT_EOG091G0NTO.clustalo.fasta -n EOG091G0NTO.clustalo.aln.ALICUT.$RAxMLmodel 		1> ../../per_gene/EOG091G0NTO/infer_single_ML.stdout.txt 2> ../../per_gene/EOG091G0NTO/infer_single_ML.stderr.txt
	else
		echo "fasta file per_gene/EOG091G0NTO/ALICUT_EOG091G0NTO.clustalo.fasta contains fewer than 5 sequences - skipped" > ../../per_gene/EOG091G0NTO/infer_single_ML.stdout.txt
		touch raxml.skipped
	fi
        touch ../../per_gene/EOG091G0NTO/EOG091G0NTO.raxml.done
        
[Sun Jul  5 22:10:36 2020]
Finished job 1076.
752 of 3292 steps (23%) done

[Sun Jul  5 22:10:36 2020]
rule infer_single_ML:
    input: per_gene/EOG091G049W/EOG091G049W.best_model, per_gene/EOG091G049W/ALICUT_EOG091G049W.clustalo.fasta
    output: per_gene/EOG091G049W/EOG091G049W.raxml.done
    log: per_gene/EOG091G049W/infer_single_ML.stdout.txt, per_gene/EOG091G049W/infer_single_ML.stderr.txt
    jobid: 332
    wildcards: BUSCO=EOG091G049W
    threads: 2


        cd per_gene/EOG091G049W
	count=$(cat ../../per_gene/EOG091G049W/ALICUT_EOG091G049W.clustalo.fasta | grep ">" | wc -l)
	if [ "$count" -gt 5 ]
        then
		RAxMLmodel=$(cat ../../per_gene/EOG091G049W/EOG091G049W.best_model | grep "Best" | cut -d ":" -f 2 | tr -d '[:space:]')
                if [ "$(ls -1 | grep "^RAxML" | wc -l)" -ne 0 ]
		then
			rm RAxML*
		fi
        	raxml -f a -T 2 -m PROTGAMMA$RAxMLmodel         	-p 12345 -x 12345 -# 100         	-s ../../per_gene/EOG091G049W/ALICUT_EOG091G049W.clustalo.fasta -n EOG091G049W.clustalo.aln.ALICUT.$RAxMLmodel 		1> ../../per_gene/EOG091G049W/infer_single_ML.stdout.txt 2> ../../per_gene/EOG091G049W/infer_single_ML.stderr.txt
	else
		echo "fasta file per_gene/EOG091G049W/ALICUT_EOG091G049W.clustalo.fasta contains fewer than 5 sequences - skipped" > ../../per_gene/EOG091G049W/infer_single_ML.stdout.txt
		touch raxml.skipped
	fi
        touch ../../per_gene/EOG091G049W/EOG091G049W.raxml.done
        
[33mJob counts:
	count	jobs
	1	infer_single_ML
	1[0m
[33m
        cd per_gene/EOG091G0NTO
	count=$(cat ../../per_gene/EOG091G0NTO/ALICUT_EOG091G0NTO.clustalo.fasta | grep ">" | wc -l)
	if [ "$count" -gt 5 ]
        then
		RAxMLmodel=$(cat ../../per_gene/EOG091G0NTO/EOG091G0NTO.best_model | grep "Best" | cut -d ":" -f 2 | tr -d '[:space:]')
                if [ "$(ls -1 | grep "^RAxML" | wc -l)" -ne 0 ]
		then
			rm RAxML*
		fi
        	raxml -f a -T 2 -m PROTGAMMA$RAxMLmodel         	-p 12345 -x 12345 -# 100         	-s ../../per_gene/EOG091G0NTO/ALICUT_EOG091G0NTO.clustalo.fasta -n EOG091G0NTO.clustalo.aln.ALICUT.$RAxMLmodel 		1> ../../per_gene/EOG091G0NTO/infer_single_ML.stdout.txt 2> ../../per_gene/EOG091G0NTO/infer_single_ML.stderr.txt
	else
		echo "fasta file per_gene/EOG091G0NTO/ALICUT_EOG091G0NTO.clustalo.fasta contains fewer than 5 sequences - skipped" > ../../per_gene/EOG091G0NTO/infer_single_ML.stdout.txt
		touch raxml.skipped
	fi
        touch ../../per_gene/EOG091G0NTO/EOG091G0NTO.raxml.done
        [0m
[33mJob counts:
	count	jobs
	1	infer_single_ML
	1[0m
[33m
        cd per_gene/EOG091G049W
	count=$(cat ../../per_gene/EOG091G049W/ALICUT_EOG091G049W.clustalo.fasta | grep ">" | wc -l)
	if [ "$count" -gt 5 ]
        then
		RAxMLmodel=$(cat ../../per_gene/EOG091G049W/EOG091G049W.best_model | grep "Best" | cut -d ":" -f 2 | tr -d '[:space:]')
                if [ "$(ls -1 | grep "^RAxML" | wc -l)" -ne 0 ]
		then
			rm RAxML*
		fi
        	raxml -f a -T 2 -m PROTGAMMA$RAxMLmodel         	-p 12345 -x 12345 -# 100         	-s ../../per_gene/EOG091G049W/ALICUT_EOG091G049W.clustalo.fasta -n EOG091G049W.clustalo.aln.ALICUT.$RAxMLmodel 		1> ../../per_gene/EOG091G049W/infer_single_ML.stdout.txt 2> ../../per_gene/EOG091G049W/infer_single_ML.stderr.txt
	else
		echo "fasta file per_gene/EOG091G049W/ALICUT_EOG091G049W.clustalo.fasta contains fewer than 5 sequences - skipped" > ../../per_gene/EOG091G049W/infer_single_ML.stdout.txt
		touch raxml.skipped
	fi
        touch ../../per_gene/EOG091G049W/EOG091G049W.raxml.done
        [0m
[Sun Jul  5 22:10:48 2020]
Finished job 2634.
753 of 3292 steps (23%) done

[Sun Jul  5 22:10:48 2020]
rule get_outgroups:
    input: per_gene/EOG091G0BHV/EOG091G0BHV.ingroup.fasta
    output: per_gene/EOG091G0BHV/EOG091G0BHV.orthodb.fasta, per_gene/EOG091G0BHV/EOG091G0BHV.outgroup.fasta
    log: per_gene/EOG091G0BHV/get_outgroups.stdout.txt, per_gene/EOG091G0BHV/get_outgroups.stderr.txt
    jobid: 2635
    wildcards: BUSCO=EOG091G0BHV


        #download fastas from Orhtodb for BUSCO id
        for i in {1..5}
        do
             wget "http://www.orthodb.org/fasta?query=EOG091G0BHV&level=33208" -O per_gene/EOG091G0BHV/EOG091G0BHV.orthodb.fasta 1> per_gene/EOG091G0BHV/get_outgroups.stdout.txt 2> per_gene/EOG091G0BHV/get_outgroups.stderr.txt && break || echo -e "try again ($i)" && sleep 15
        done

	#This is quick an dirty for now and just takes the first protein if there is more than one for an outgroup taxon
        bash ../scripts/download_outgroups.sh taxids.txt per_gene/EOG091G0BHV/EOG091G0BHV.orthodb.fasta > per_gene/EOG091G0BHV/EOG091G0BHV.outgroup.fasta
        
[Sun Jul  5 22:10:49 2020]
Finished job 2635.
754 of 3292 steps (23%) done

[Sun Jul  5 22:10:49 2020]
rule join_groups:
    input: per_gene/EOG091G0BHV/EOG091G0BHV.ingroup.fasta, per_gene/EOG091G0BHV/EOG091G0BHV.outgroup.fasta
    output: per_gene/EOG091G0BHV/EOG091G0BHV.fasta
    jobid: 2141
    wildcards: BUSCO=EOG091G0BHV


        cat per_gene/EOG091G0BHV/EOG091G0BHV.ingroup.fasta per_gene/EOG091G0BHV/EOG091G0BHV.outgroup.fasta > per_gene/EOG091G0BHV/EOG091G0BHV.fasta
        
[Sun Jul  5 22:10:49 2020]
Finished job 2141.
755 of 3292 steps (23%) done

[Sun Jul  5 22:10:49 2020]
rule MSA:
    input: per_gene/EOG091G0BHV/EOG091G0BHV.fasta
    output: per_gene/EOG091G0BHV/EOG091G0BHV.clustalo.fasta
    log: per_gene/EOG091G0BHV/MSA.stdout.txt, per_gene/EOG091G0BHV/MSA.stderr.txt
    jobid: 1402
    wildcards: BUSCO=EOG091G0BHV
    threads: 2


        clustalo -i per_gene/EOG091G0BHV/EOG091G0BHV.fasta -o per_gene/EOG091G0BHV/EOG091G0BHV.clustalo.fasta --threads=2 1> per_gene/EOG091G0BHV/MSA.stdout.txt 2> per_gene/EOG091G0BHV/MSA.stderr.txt
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/d68c9691725a7401923680874285c430.simg
[Sun Jul  5 22:10:51 2020]
Finished job 1402.
756 of 3292 steps (23%) done

[Sun Jul  5 22:10:51 2020]
rule score_and_cut:
    input: per_gene/EOG091G0BHV/EOG091G0BHV.clustalo.fasta
    output: per_gene/EOG091G0BHV/ALICUT_EOG091G0BHV.clustalo.fasta
    jobid: 579
    wildcards: BUSCO=EOG091G0BHV
    threads: 2


        cd per_gene/EOG091G0BHV
        Aliscore.pl -N -r 200000000000000000 -i ../../per_gene/EOG091G0BHV/EOG091G0BHV.clustalo.fasta &> aliscore.log
        ALICUT.pl -s &> alicut.log
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/63c88c27a0fa300f57066b0ef65fefcb.simg
[Sun Jul  5 22:10:59 2020]
Finished job 199.
757 of 3292 steps (23%) done

[Sun Jul  5 22:10:59 2020]
rule get_seqs:
    input: /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ingroup.txt, /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/outgroup.txt
    output: per_gene/EOG091G06I8/EOG091G06I8.ingroup.fasta
    log: per_gene/EOG091G06I8/get_seqs.stdout.txt, per_gene/EOG091G06I8/get_seqs.stderr.txt
    jobid: 3146
    wildcards: BUSCO=EOG091G06I8
    threads: 2


	basedir=$(pwd)
        cd per_gene/EOG091G06I8
        
        bash $basedir/../scripts/fetch_seqs.sh EOG091G06I8 /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ingroup.txt /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/outgroup.txt 1> ../../per_gene/EOG091G06I8/get_seqs.stdout.txt 2> ../../per_gene/EOG091G06I8/get_seqs.stderr.txt
	mv EOG091G06I8.fasta $basedir/per_gene/EOG091G06I8/EOG091G06I8.ingroup.fasta
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/72476f9d9a5bd0627b4d721143a21354.simg
[Sun Jul  5 22:11:02 2020]
Finished job 579.
758 of 3292 steps (23%) done

[Sun Jul  5 22:11:02 2020]
rule remove_empty:
    input: per_gene/EOG091G0BHV/ALICUT_EOG091G0BHV.clustalo.fasta
    output: per_gene/EOG091G0BHV/empty_check.done
    jobid: 1401
    wildcards: BUSCO=EOG091G0BHV


         if [ "$(cat per_gene/EOG091G0BHV/ALICUT_EOG091G0BHV.clustalo.fasta | grep -v ">" | sed 's/-//g' | grep "^$" | wc -l)" -gt 0 ]
         then
              cp per_gene/EOG091G0BHV/ALICUT_EOG091G0BHV.clustalo.fasta per_gene/EOG091G0BHV/ALICUT_EOG091G0BHV.clustalo.fasta.backup
              bash ../scripts/remove_empty.sh per_gene/EOG091G0BHV/ALICUT_EOG091G0BHV.clustalo.fasta.backup > per_gene/EOG091G0BHV/ALICUT_EOG091G0BHV.clustalo.fasta
         fi
         touch per_gene/EOG091G0BHV/empty_check.done
         
[Sun Jul  5 22:11:02 2020]
Finished job 1401.
759 of 3292 steps (23%) done

[Sun Jul  5 22:11:02 2020]
rule find_best_model:
    input: per_gene/EOG091G0BHV/ALICUT_EOG091G0BHV.clustalo.fasta, per_gene/EOG091G0BHV/empty_check.done
    output: per_gene/EOG091G0BHV/EOG091G0BHV.best_model
    log: per_gene/EOG091G0BHV/find_best_model.stderr.txt
    jobid: 578
    wildcards: BUSCO=EOG091G0BHV
    threads: 2


        cd per_gene/EOG091G0BHV
        if [ ! -d find_best_model ]
        then
            mkdir find_best_model
        fi
        cd find_best_model
        ln -s ../../../per_gene/EOG091G0BHV/ALICUT_EOG091G0BHV.clustalo.fasta EOG091G0BHV.fasta
        ProteinModelSelection.pl EOG091G0BHV.fasta 1> ../../../per_gene/EOG091G0BHV/EOG091G0BHV.best_model 2> ../../../per_gene/EOG091G0BHV/find_best_model.stderr.txt
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/c0c09ee657b1e27f2c5687e0e9aa8d70.simg
[Sun Jul  5 22:11:11 2020]
Finished job 258.
760 of 3292 steps (23%) done

[Sun Jul  5 22:11:11 2020]
rule get_seqs:
    input: /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ingroup.txt, /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/outgroup.txt
    output: per_gene/EOG091G0WLL/EOG091G0WLL.ingroup.fasta
    log: per_gene/EOG091G0WLL/get_seqs.stdout.txt, per_gene/EOG091G0WLL/get_seqs.stderr.txt
    jobid: 2886
    wildcards: BUSCO=EOG091G0WLL
    threads: 2


	basedir=$(pwd)
        cd per_gene/EOG091G0WLL
        
        bash $basedir/../scripts/fetch_seqs.sh EOG091G0WLL /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ingroup.txt /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/outgroup.txt 1> ../../per_gene/EOG091G0WLL/get_seqs.stdout.txt 2> ../../per_gene/EOG091G0WLL/get_seqs.stderr.txt
	mv EOG091G0WLL.fasta $basedir/per_gene/EOG091G0WLL/EOG091G0WLL.ingroup.fasta
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/72476f9d9a5bd0627b4d721143a21354.simg
[Sun Jul  5 22:11:13 2020]
Finished job 652.
761 of 3292 steps (23%) done

[Sun Jul  5 22:11:13 2020]
rule infer_single_ML:
    input: per_gene/EOG091G0I8J/EOG091G0I8J.best_model, per_gene/EOG091G0I8J/ALICUT_EOG091G0I8J.clustalo.fasta
    output: per_gene/EOG091G0I8J/EOG091G0I8J.raxml.done
    log: per_gene/EOG091G0I8J/infer_single_ML.stdout.txt, per_gene/EOG091G0I8J/infer_single_ML.stderr.txt
    jobid: 120
    wildcards: BUSCO=EOG091G0I8J
    threads: 2


        cd per_gene/EOG091G0I8J
	count=$(cat ../../per_gene/EOG091G0I8J/ALICUT_EOG091G0I8J.clustalo.fasta | grep ">" | wc -l)
	if [ "$count" -gt 5 ]
        then
		RAxMLmodel=$(cat ../../per_gene/EOG091G0I8J/EOG091G0I8J.best_model | grep "Best" | cut -d ":" -f 2 | tr -d '[:space:]')
                if [ "$(ls -1 | grep "^RAxML" | wc -l)" -ne 0 ]
		then
			rm RAxML*
		fi
        	raxml -f a -T 2 -m PROTGAMMA$RAxMLmodel         	-p 12345 -x 12345 -# 100         	-s ../../per_gene/EOG091G0I8J/ALICUT_EOG091G0I8J.clustalo.fasta -n EOG091G0I8J.clustalo.aln.ALICUT.$RAxMLmodel 		1> ../../per_gene/EOG091G0I8J/infer_single_ML.stdout.txt 2> ../../per_gene/EOG091G0I8J/infer_single_ML.stderr.txt
	else
		echo "fasta file per_gene/EOG091G0I8J/ALICUT_EOG091G0I8J.clustalo.fasta contains fewer than 5 sequences - skipped" > ../../per_gene/EOG091G0I8J/infer_single_ML.stdout.txt
		touch raxml.skipped
	fi
        touch ../../per_gene/EOG091G0I8J/EOG091G0I8J.raxml.done
        
[33mJob counts:
	count	jobs
	1	infer_single_ML
	1[0m
[33m
        cd per_gene/EOG091G0I8J
	count=$(cat ../../per_gene/EOG091G0I8J/ALICUT_EOG091G0I8J.clustalo.fasta | grep ">" | wc -l)
	if [ "$count" -gt 5 ]
        then
		RAxMLmodel=$(cat ../../per_gene/EOG091G0I8J/EOG091G0I8J.best_model | grep "Best" | cut -d ":" -f 2 | tr -d '[:space:]')
                if [ "$(ls -1 | grep "^RAxML" | wc -l)" -ne 0 ]
		then
			rm RAxML*
		fi
        	raxml -f a -T 2 -m PROTGAMMA$RAxMLmodel         	-p 12345 -x 12345 -# 100         	-s ../../per_gene/EOG091G0I8J/ALICUT_EOG091G0I8J.clustalo.fasta -n EOG091G0I8J.clustalo.aln.ALICUT.$RAxMLmodel 		1> ../../per_gene/EOG091G0I8J/infer_single_ML.stdout.txt 2> ../../per_gene/EOG091G0I8J/infer_single_ML.stderr.txt
	else
		echo "fasta file per_gene/EOG091G0I8J/ALICUT_EOG091G0I8J.clustalo.fasta contains fewer than 5 sequences - skipped" > ../../per_gene/EOG091G0I8J/infer_single_ML.stdout.txt
		touch raxml.skipped
	fi
        touch ../../per_gene/EOG091G0I8J/EOG091G0I8J.raxml.done
        [0m
[Sun Jul  5 22:11:17 2020]
Finished job 3146.
762 of 3292 steps (23%) done

[Sun Jul  5 22:11:17 2020]
rule get_outgroups:
    input: per_gene/EOG091G06I8/EOG091G06I8.ingroup.fasta
    output: per_gene/EOG091G06I8/EOG091G06I8.orthodb.fasta, per_gene/EOG091G06I8/EOG091G06I8.outgroup.fasta
    log: per_gene/EOG091G06I8/get_outgroups.stdout.txt, per_gene/EOG091G06I8/get_outgroups.stderr.txt
    jobid: 3147
    wildcards: BUSCO=EOG091G06I8


        #download fastas from Orhtodb for BUSCO id
        for i in {1..5}
        do
             wget "http://www.orthodb.org/fasta?query=EOG091G06I8&level=33208" -O per_gene/EOG091G06I8/EOG091G06I8.orthodb.fasta 1> per_gene/EOG091G06I8/get_outgroups.stdout.txt 2> per_gene/EOG091G06I8/get_outgroups.stderr.txt && break || echo -e "try again ($i)" && sleep 15
        done

	#This is quick an dirty for now and just takes the first protein if there is more than one for an outgroup taxon
        bash ../scripts/download_outgroups.sh taxids.txt per_gene/EOG091G06I8/EOG091G06I8.orthodb.fasta > per_gene/EOG091G06I8/EOG091G06I8.outgroup.fasta
        
[Sun Jul  5 22:11:18 2020]
Finished job 3147.
763 of 3292 steps (23%) done

[Sun Jul  5 22:11:18 2020]
rule join_groups:
    input: per_gene/EOG091G06I8/EOG091G06I8.ingroup.fasta, per_gene/EOG091G06I8/EOG091G06I8.outgroup.fasta
    output: per_gene/EOG091G06I8/EOG091G06I8.fasta
    jobid: 2397
    wildcards: BUSCO=EOG091G06I8


        cat per_gene/EOG091G06I8/EOG091G06I8.ingroup.fasta per_gene/EOG091G06I8/EOG091G06I8.outgroup.fasta > per_gene/EOG091G06I8/EOG091G06I8.fasta
        
[Sun Jul  5 22:11:18 2020]
Finished job 2397.
764 of 3292 steps (23%) done

[Sun Jul  5 22:11:18 2020]
rule MSA:
    input: per_gene/EOG091G06I8/EOG091G06I8.fasta
    output: per_gene/EOG091G06I8/EOG091G06I8.clustalo.fasta
    log: per_gene/EOG091G06I8/MSA.stdout.txt, per_gene/EOG091G06I8/MSA.stderr.txt
    jobid: 1914
    wildcards: BUSCO=EOG091G06I8
    threads: 2


        clustalo -i per_gene/EOG091G06I8/EOG091G06I8.fasta -o per_gene/EOG091G06I8/EOG091G06I8.clustalo.fasta --threads=2 1> per_gene/EOG091G06I8/MSA.stdout.txt 2> per_gene/EOG091G06I8/MSA.stderr.txt
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/d68c9691725a7401923680874285c430.simg
[Sun Jul  5 22:11:19 2020]
Finished job 1914.
765 of 3292 steps (23%) done

[Sun Jul  5 22:11:19 2020]
rule score_and_cut:
    input: per_gene/EOG091G06I8/EOG091G06I8.clustalo.fasta
    output: per_gene/EOG091G06I8/ALICUT_EOG091G06I8.clustalo.fasta
    jobid: 1091
    wildcards: BUSCO=EOG091G06I8
    threads: 2


        cd per_gene/EOG091G06I8
        Aliscore.pl -N -r 200000000000000000 -i ../../per_gene/EOG091G06I8/EOG091G06I8.clustalo.fasta &> aliscore.log
        ALICUT.pl -s &> alicut.log
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/63c88c27a0fa300f57066b0ef65fefcb.simg
[Sun Jul  5 22:11:29 2020]
Finished job 1091.
766 of 3292 steps (23%) done

[Sun Jul  5 22:11:29 2020]
rule remove_empty:
    input: per_gene/EOG091G06I8/ALICUT_EOG091G06I8.clustalo.fasta
    output: per_gene/EOG091G06I8/empty_check.done
    jobid: 1913
    wildcards: BUSCO=EOG091G06I8


         if [ "$(cat per_gene/EOG091G06I8/ALICUT_EOG091G06I8.clustalo.fasta | grep -v ">" | sed 's/-//g' | grep "^$" | wc -l)" -gt 0 ]
         then
              cp per_gene/EOG091G06I8/ALICUT_EOG091G06I8.clustalo.fasta per_gene/EOG091G06I8/ALICUT_EOG091G06I8.clustalo.fasta.backup
              bash ../scripts/remove_empty.sh per_gene/EOG091G06I8/ALICUT_EOG091G06I8.clustalo.fasta.backup > per_gene/EOG091G06I8/ALICUT_EOG091G06I8.clustalo.fasta
         fi
         touch per_gene/EOG091G06I8/empty_check.done
         
[Sun Jul  5 22:11:29 2020]
Finished job 1913.
767 of 3292 steps (23%) done

[Sun Jul  5 22:11:29 2020]
rule find_best_model:
    input: per_gene/EOG091G06I8/ALICUT_EOG091G06I8.clustalo.fasta, per_gene/EOG091G06I8/empty_check.done
    output: per_gene/EOG091G06I8/EOG091G06I8.best_model
    log: per_gene/EOG091G06I8/find_best_model.stderr.txt
    jobid: 1090
    wildcards: BUSCO=EOG091G06I8
    threads: 2


        cd per_gene/EOG091G06I8
        if [ ! -d find_best_model ]
        then
            mkdir find_best_model
        fi
        cd find_best_model
        ln -s ../../../per_gene/EOG091G06I8/ALICUT_EOG091G06I8.clustalo.fasta EOG091G06I8.fasta
        ProteinModelSelection.pl EOG091G06I8.fasta 1> ../../../per_gene/EOG091G06I8/EOG091G06I8.best_model 2> ../../../per_gene/EOG091G06I8/find_best_model.stderr.txt
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/c0c09ee657b1e27f2c5687e0e9aa8d70.simg
[Sun Jul  5 22:11:30 2020]
Finished job 2886.
768 of 3292 steps (23%) done

[Sun Jul  5 22:11:30 2020]
rule get_outgroups:
    input: per_gene/EOG091G0WLL/EOG091G0WLL.ingroup.fasta
    output: per_gene/EOG091G0WLL/EOG091G0WLL.orthodb.fasta, per_gene/EOG091G0WLL/EOG091G0WLL.outgroup.fasta
    log: per_gene/EOG091G0WLL/get_outgroups.stdout.txt, per_gene/EOG091G0WLL/get_outgroups.stderr.txt
    jobid: 2887
    wildcards: BUSCO=EOG091G0WLL


        #download fastas from Orhtodb for BUSCO id
        for i in {1..5}
        do
             wget "http://www.orthodb.org/fasta?query=EOG091G0WLL&level=33208" -O per_gene/EOG091G0WLL/EOG091G0WLL.orthodb.fasta 1> per_gene/EOG091G0WLL/get_outgroups.stdout.txt 2> per_gene/EOG091G0WLL/get_outgroups.stderr.txt && break || echo -e "try again ($i)" && sleep 15
        done

	#This is quick an dirty for now and just takes the first protein if there is more than one for an outgroup taxon
        bash ../scripts/download_outgroups.sh taxids.txt per_gene/EOG091G0WLL/EOG091G0WLL.orthodb.fasta > per_gene/EOG091G0WLL/EOG091G0WLL.outgroup.fasta
        
[Sun Jul  5 22:11:31 2020]
Finished job 2887.
769 of 3292 steps (23%) done

[Sun Jul  5 22:11:31 2020]
rule join_groups:
    input: per_gene/EOG091G0WLL/EOG091G0WLL.ingroup.fasta, per_gene/EOG091G0WLL/EOG091G0WLL.outgroup.fasta
    output: per_gene/EOG091G0WLL/EOG091G0WLL.fasta
    jobid: 2267
    wildcards: BUSCO=EOG091G0WLL


        cat per_gene/EOG091G0WLL/EOG091G0WLL.ingroup.fasta per_gene/EOG091G0WLL/EOG091G0WLL.outgroup.fasta > per_gene/EOG091G0WLL/EOG091G0WLL.fasta
        
[Sun Jul  5 22:11:31 2020]
Finished job 2267.
770 of 3292 steps (23%) done

[Sun Jul  5 22:11:31 2020]
rule MSA:
    input: per_gene/EOG091G0WLL/EOG091G0WLL.fasta
    output: per_gene/EOG091G0WLL/EOG091G0WLL.clustalo.fasta
    log: per_gene/EOG091G0WLL/MSA.stdout.txt, per_gene/EOG091G0WLL/MSA.stderr.txt
    jobid: 1654
    wildcards: BUSCO=EOG091G0WLL
    threads: 2


        clustalo -i per_gene/EOG091G0WLL/EOG091G0WLL.fasta -o per_gene/EOG091G0WLL/EOG091G0WLL.clustalo.fasta --threads=2 1> per_gene/EOG091G0WLL/MSA.stdout.txt 2> per_gene/EOG091G0WLL/MSA.stderr.txt
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/d68c9691725a7401923680874285c430.simg
[Sun Jul  5 22:11:32 2020]
Finished job 1654.
771 of 3292 steps (23%) done

[Sun Jul  5 22:11:32 2020]
rule score_and_cut:
    input: per_gene/EOG091G0WLL/EOG091G0WLL.clustalo.fasta
    output: per_gene/EOG091G0WLL/ALICUT_EOG091G0WLL.clustalo.fasta
    jobid: 831
    wildcards: BUSCO=EOG091G0WLL
    threads: 2


        cd per_gene/EOG091G0WLL
        Aliscore.pl -N -r 200000000000000000 -i ../../per_gene/EOG091G0WLL/EOG091G0WLL.clustalo.fasta &> aliscore.log
        ALICUT.pl -s &> alicut.log
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/63c88c27a0fa300f57066b0ef65fefcb.simg
[Sun Jul  5 22:11:42 2020]
Finished job 831.
772 of 3292 steps (23%) done

[Sun Jul  5 22:11:42 2020]
rule remove_empty:
    input: per_gene/EOG091G0WLL/ALICUT_EOG091G0WLL.clustalo.fasta
    output: per_gene/EOG091G0WLL/empty_check.done
    jobid: 1653
    wildcards: BUSCO=EOG091G0WLL


         if [ "$(cat per_gene/EOG091G0WLL/ALICUT_EOG091G0WLL.clustalo.fasta | grep -v ">" | sed 's/-//g' | grep "^$" | wc -l)" -gt 0 ]
         then
              cp per_gene/EOG091G0WLL/ALICUT_EOG091G0WLL.clustalo.fasta per_gene/EOG091G0WLL/ALICUT_EOG091G0WLL.clustalo.fasta.backup
              bash ../scripts/remove_empty.sh per_gene/EOG091G0WLL/ALICUT_EOG091G0WLL.clustalo.fasta.backup > per_gene/EOG091G0WLL/ALICUT_EOG091G0WLL.clustalo.fasta
         fi
         touch per_gene/EOG091G0WLL/empty_check.done
         
[Sun Jul  5 22:11:42 2020]
Finished job 1653.
773 of 3292 steps (23%) done

[Sun Jul  5 22:11:42 2020]
rule find_best_model:
    input: per_gene/EOG091G0WLL/ALICUT_EOG091G0WLL.clustalo.fasta, per_gene/EOG091G0WLL/empty_check.done
    output: per_gene/EOG091G0WLL/EOG091G0WLL.best_model
    log: per_gene/EOG091G0WLL/find_best_model.stderr.txt
    jobid: 830
    wildcards: BUSCO=EOG091G0WLL
    threads: 2


        cd per_gene/EOG091G0WLL
        if [ ! -d find_best_model ]
        then
            mkdir find_best_model
        fi
        cd find_best_model
        ln -s ../../../per_gene/EOG091G0WLL/ALICUT_EOG091G0WLL.clustalo.fasta EOG091G0WLL.fasta
        ProteinModelSelection.pl EOG091G0WLL.fasta 1> ../../../per_gene/EOG091G0WLL/EOG091G0WLL.best_model 2> ../../../per_gene/EOG091G0WLL/find_best_model.stderr.txt
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/c0c09ee657b1e27f2c5687e0e9aa8d70.simg
[Sun Jul  5 22:11:47 2020]
Finished job 578.
774 of 3292 steps (24%) done

[Sun Jul  5 22:11:47 2020]
rule infer_single_ML:
    input: per_gene/EOG091G0BHV/EOG091G0BHV.best_model, per_gene/EOG091G0BHV/ALICUT_EOG091G0BHV.clustalo.fasta
    output: per_gene/EOG091G0BHV/EOG091G0BHV.raxml.done
    log: per_gene/EOG091G0BHV/infer_single_ML.stdout.txt, per_gene/EOG091G0BHV/infer_single_ML.stderr.txt
    jobid: 83
    wildcards: BUSCO=EOG091G0BHV
    threads: 2


        cd per_gene/EOG091G0BHV
	count=$(cat ../../per_gene/EOG091G0BHV/ALICUT_EOG091G0BHV.clustalo.fasta | grep ">" | wc -l)
	if [ "$count" -gt 5 ]
        then
		RAxMLmodel=$(cat ../../per_gene/EOG091G0BHV/EOG091G0BHV.best_model | grep "Best" | cut -d ":" -f 2 | tr -d '[:space:]')
                if [ "$(ls -1 | grep "^RAxML" | wc -l)" -ne 0 ]
		then
			rm RAxML*
		fi
        	raxml -f a -T 2 -m PROTGAMMA$RAxMLmodel         	-p 12345 -x 12345 -# 100         	-s ../../per_gene/EOG091G0BHV/ALICUT_EOG091G0BHV.clustalo.fasta -n EOG091G0BHV.clustalo.aln.ALICUT.$RAxMLmodel 		1> ../../per_gene/EOG091G0BHV/infer_single_ML.stdout.txt 2> ../../per_gene/EOG091G0BHV/infer_single_ML.stderr.txt
	else
		echo "fasta file per_gene/EOG091G0BHV/ALICUT_EOG091G0BHV.clustalo.fasta contains fewer than 5 sequences - skipped" > ../../per_gene/EOG091G0BHV/infer_single_ML.stdout.txt
		touch raxml.skipped
	fi
        touch ../../per_gene/EOG091G0BHV/EOG091G0BHV.raxml.done
        
[33mJob counts:
	count	jobs
	1	infer_single_ML
	1[0m
[33m
        cd per_gene/EOG091G0BHV
	count=$(cat ../../per_gene/EOG091G0BHV/ALICUT_EOG091G0BHV.clustalo.fasta | grep ">" | wc -l)
	if [ "$count" -gt 5 ]
        then
		RAxMLmodel=$(cat ../../per_gene/EOG091G0BHV/EOG091G0BHV.best_model | grep "Best" | cut -d ":" -f 2 | tr -d '[:space:]')
                if [ "$(ls -1 | grep "^RAxML" | wc -l)" -ne 0 ]
		then
			rm RAxML*
		fi
        	raxml -f a -T 2 -m PROTGAMMA$RAxMLmodel         	-p 12345 -x 12345 -# 100         	-s ../../per_gene/EOG091G0BHV/ALICUT_EOG091G0BHV.clustalo.fasta -n EOG091G0BHV.clustalo.aln.ALICUT.$RAxMLmodel 		1> ../../per_gene/EOG091G0BHV/infer_single_ML.stdout.txt 2> ../../per_gene/EOG091G0BHV/infer_single_ML.stderr.txt
	else
		echo "fasta file per_gene/EOG091G0BHV/ALICUT_EOG091G0BHV.clustalo.fasta contains fewer than 5 sequences - skipped" > ../../per_gene/EOG091G0BHV/infer_single_ML.stdout.txt
		touch raxml.skipped
	fi
        touch ../../per_gene/EOG091G0BHV/EOG091G0BHV.raxml.done
        [0m
[Sun Jul  5 22:11:53 2020]
Finished job 198.
775 of 3292 steps (24%) done

[Sun Jul  5 22:11:53 2020]
rule get_seqs:
    input: /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ingroup.txt, /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/outgroup.txt
    output: per_gene/EOG091G0803/EOG091G0803.ingroup.fasta
    log: per_gene/EOG091G0803/get_seqs.stdout.txt, per_gene/EOG091G0803/get_seqs.stderr.txt
    jobid: 3158
    wildcards: BUSCO=EOG091G0803
    threads: 2


	basedir=$(pwd)
        cd per_gene/EOG091G0803
        
        bash $basedir/../scripts/fetch_seqs.sh EOG091G0803 /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ingroup.txt /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/outgroup.txt 1> ../../per_gene/EOG091G0803/get_seqs.stdout.txt 2> ../../per_gene/EOG091G0803/get_seqs.stderr.txt
	mv EOG091G0803.fasta $basedir/per_gene/EOG091G0803/EOG091G0803.ingroup.fasta
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/72476f9d9a5bd0627b4d721143a21354.simg
[Sun Jul  5 22:12:12 2020]
Finished job 3158.
776 of 3292 steps (24%) done

[Sun Jul  5 22:12:12 2020]
rule get_outgroups:
    input: per_gene/EOG091G0803/EOG091G0803.ingroup.fasta
    output: per_gene/EOG091G0803/EOG091G0803.orthodb.fasta, per_gene/EOG091G0803/EOG091G0803.outgroup.fasta
    log: per_gene/EOG091G0803/get_outgroups.stdout.txt, per_gene/EOG091G0803/get_outgroups.stderr.txt
    jobid: 3159
    wildcards: BUSCO=EOG091G0803


        #download fastas from Orhtodb for BUSCO id
        for i in {1..5}
        do
             wget "http://www.orthodb.org/fasta?query=EOG091G0803&level=33208" -O per_gene/EOG091G0803/EOG091G0803.orthodb.fasta 1> per_gene/EOG091G0803/get_outgroups.stdout.txt 2> per_gene/EOG091G0803/get_outgroups.stderr.txt && break || echo -e "try again ($i)" && sleep 15
        done

	#This is quick an dirty for now and just takes the first protein if there is more than one for an outgroup taxon
        bash ../scripts/download_outgroups.sh taxids.txt per_gene/EOG091G0803/EOG091G0803.orthodb.fasta > per_gene/EOG091G0803/EOG091G0803.outgroup.fasta
        
[Sun Jul  5 22:12:13 2020]
Finished job 3159.
777 of 3292 steps (24%) done

[Sun Jul  5 22:12:13 2020]
rule join_groups:
    input: per_gene/EOG091G0803/EOG091G0803.ingroup.fasta, per_gene/EOG091G0803/EOG091G0803.outgroup.fasta
    output: per_gene/EOG091G0803/EOG091G0803.fasta
    jobid: 2403
    wildcards: BUSCO=EOG091G0803


        cat per_gene/EOG091G0803/EOG091G0803.ingroup.fasta per_gene/EOG091G0803/EOG091G0803.outgroup.fasta > per_gene/EOG091G0803/EOG091G0803.fasta
        
[Sun Jul  5 22:12:13 2020]
Finished job 2403.
778 of 3292 steps (24%) done

[Sun Jul  5 22:12:13 2020]
rule MSA:
    input: per_gene/EOG091G0803/EOG091G0803.fasta
    output: per_gene/EOG091G0803/EOG091G0803.clustalo.fasta
    log: per_gene/EOG091G0803/MSA.stdout.txt, per_gene/EOG091G0803/MSA.stderr.txt
    jobid: 1926
    wildcards: BUSCO=EOG091G0803
    threads: 2


        clustalo -i per_gene/EOG091G0803/EOG091G0803.fasta -o per_gene/EOG091G0803/EOG091G0803.clustalo.fasta --threads=2 1> per_gene/EOG091G0803/MSA.stdout.txt 2> per_gene/EOG091G0803/MSA.stderr.txt
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/d68c9691725a7401923680874285c430.simg
[Sun Jul  5 22:12:13 2020]
Finished job 1090.
779 of 3292 steps (24%) done

[Sun Jul  5 22:12:13 2020]
rule infer_single_ML:
    input: per_gene/EOG091G06I8/EOG091G06I8.best_model, per_gene/EOG091G06I8/ALICUT_EOG091G06I8.clustalo.fasta
    output: per_gene/EOG091G06I8/EOG091G06I8.raxml.done
    log: per_gene/EOG091G06I8/infer_single_ML.stdout.txt, per_gene/EOG091G06I8/infer_single_ML.stderr.txt
    jobid: 339
    wildcards: BUSCO=EOG091G06I8
    threads: 2


        cd per_gene/EOG091G06I8
	count=$(cat ../../per_gene/EOG091G06I8/ALICUT_EOG091G06I8.clustalo.fasta | grep ">" | wc -l)
	if [ "$count" -gt 5 ]
        then
		RAxMLmodel=$(cat ../../per_gene/EOG091G06I8/EOG091G06I8.best_model | grep "Best" | cut -d ":" -f 2 | tr -d '[:space:]')
                if [ "$(ls -1 | grep "^RAxML" | wc -l)" -ne 0 ]
		then
			rm RAxML*
		fi
        	raxml -f a -T 2 -m PROTGAMMA$RAxMLmodel         	-p 12345 -x 12345 -# 100         	-s ../../per_gene/EOG091G06I8/ALICUT_EOG091G06I8.clustalo.fasta -n EOG091G06I8.clustalo.aln.ALICUT.$RAxMLmodel 		1> ../../per_gene/EOG091G06I8/infer_single_ML.stdout.txt 2> ../../per_gene/EOG091G06I8/infer_single_ML.stderr.txt
	else
		echo "fasta file per_gene/EOG091G06I8/ALICUT_EOG091G06I8.clustalo.fasta contains fewer than 5 sequences - skipped" > ../../per_gene/EOG091G06I8/infer_single_ML.stdout.txt
		touch raxml.skipped
	fi
        touch ../../per_gene/EOG091G06I8/EOG091G06I8.raxml.done
        
[33mJob counts:
	count	jobs
	1	infer_single_ML
	1[0m
[33m
        cd per_gene/EOG091G06I8
	count=$(cat ../../per_gene/EOG091G06I8/ALICUT_EOG091G06I8.clustalo.fasta | grep ">" | wc -l)
	if [ "$count" -gt 5 ]
        then
		RAxMLmodel=$(cat ../../per_gene/EOG091G06I8/EOG091G06I8.best_model | grep "Best" | cut -d ":" -f 2 | tr -d '[:space:]')
                if [ "$(ls -1 | grep "^RAxML" | wc -l)" -ne 0 ]
		then
			rm RAxML*
		fi
        	raxml -f a -T 2 -m PROTGAMMA$RAxMLmodel         	-p 12345 -x 12345 -# 100         	-s ../../per_gene/EOG091G06I8/ALICUT_EOG091G06I8.clustalo.fasta -n EOG091G06I8.clustalo.aln.ALICUT.$RAxMLmodel 		1> ../../per_gene/EOG091G06I8/infer_single_ML.stdout.txt 2> ../../per_gene/EOG091G06I8/infer_single_ML.stderr.txt
	else
		echo "fasta file per_gene/EOG091G06I8/ALICUT_EOG091G06I8.clustalo.fasta contains fewer than 5 sequences - skipped" > ../../per_gene/EOG091G06I8/infer_single_ML.stdout.txt
		touch raxml.skipped
	fi
        touch ../../per_gene/EOG091G06I8/EOG091G06I8.raxml.done
        [0m
[Sun Jul  5 22:12:14 2020]
Finished job 1926.
780 of 3292 steps (24%) done

[Sun Jul  5 22:12:14 2020]
rule score_and_cut:
    input: per_gene/EOG091G0803/EOG091G0803.clustalo.fasta
    output: per_gene/EOG091G0803/ALICUT_EOG091G0803.clustalo.fasta
    jobid: 1103
    wildcards: BUSCO=EOG091G0803
    threads: 2


        cd per_gene/EOG091G0803
        Aliscore.pl -N -r 200000000000000000 -i ../../per_gene/EOG091G0803/EOG091G0803.clustalo.fasta &> aliscore.log
        ALICUT.pl -s &> alicut.log
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/63c88c27a0fa300f57066b0ef65fefcb.simg
[Sun Jul  5 22:12:19 2020]
Finished job 830.
781 of 3292 steps (24%) done

[Sun Jul  5 22:12:19 2020]
rule infer_single_ML:
    input: per_gene/EOG091G0WLL/EOG091G0WLL.best_model, per_gene/EOG091G0WLL/ALICUT_EOG091G0WLL.clustalo.fasta
    output: per_gene/EOG091G0WLL/EOG091G0WLL.raxml.done
    log: per_gene/EOG091G0WLL/infer_single_ML.stdout.txt, per_gene/EOG091G0WLL/infer_single_ML.stderr.txt
    jobid: 209
    wildcards: BUSCO=EOG091G0WLL
    threads: 2


        cd per_gene/EOG091G0WLL
	count=$(cat ../../per_gene/EOG091G0WLL/ALICUT_EOG091G0WLL.clustalo.fasta | grep ">" | wc -l)
	if [ "$count" -gt 5 ]
        then
		RAxMLmodel=$(cat ../../per_gene/EOG091G0WLL/EOG091G0WLL.best_model | grep "Best" | cut -d ":" -f 2 | tr -d '[:space:]')
                if [ "$(ls -1 | grep "^RAxML" | wc -l)" -ne 0 ]
		then
			rm RAxML*
		fi
        	raxml -f a -T 2 -m PROTGAMMA$RAxMLmodel         	-p 12345 -x 12345 -# 100         	-s ../../per_gene/EOG091G0WLL/ALICUT_EOG091G0WLL.clustalo.fasta -n EOG091G0WLL.clustalo.aln.ALICUT.$RAxMLmodel 		1> ../../per_gene/EOG091G0WLL/infer_single_ML.stdout.txt 2> ../../per_gene/EOG091G0WLL/infer_single_ML.stderr.txt
	else
		echo "fasta file per_gene/EOG091G0WLL/ALICUT_EOG091G0WLL.clustalo.fasta contains fewer than 5 sequences - skipped" > ../../per_gene/EOG091G0WLL/infer_single_ML.stdout.txt
		touch raxml.skipped
	fi
        touch ../../per_gene/EOG091G0WLL/EOG091G0WLL.raxml.done
        
[33mJob counts:
	count	jobs
	1	infer_single_ML
	1[0m
[33m
        cd per_gene/EOG091G0WLL
	count=$(cat ../../per_gene/EOG091G0WLL/ALICUT_EOG091G0WLL.clustalo.fasta | grep ">" | wc -l)
	if [ "$count" -gt 5 ]
        then
		RAxMLmodel=$(cat ../../per_gene/EOG091G0WLL/EOG091G0WLL.best_model | grep "Best" | cut -d ":" -f 2 | tr -d '[:space:]')
                if [ "$(ls -1 | grep "^RAxML" | wc -l)" -ne 0 ]
		then
			rm RAxML*
		fi
        	raxml -f a -T 2 -m PROTGAMMA$RAxMLmodel         	-p 12345 -x 12345 -# 100         	-s ../../per_gene/EOG091G0WLL/ALICUT_EOG091G0WLL.clustalo.fasta -n EOG091G0WLL.clustalo.aln.ALICUT.$RAxMLmodel 		1> ../../per_gene/EOG091G0WLL/infer_single_ML.stdout.txt 2> ../../per_gene/EOG091G0WLL/infer_single_ML.stderr.txt
	else
		echo "fasta file per_gene/EOG091G0WLL/ALICUT_EOG091G0WLL.clustalo.fasta contains fewer than 5 sequences - skipped" > ../../per_gene/EOG091G0WLL/infer_single_ML.stdout.txt
		touch raxml.skipped
	fi
        touch ../../per_gene/EOG091G0WLL/EOG091G0WLL.raxml.done
        [0m
[Sun Jul  5 22:12:25 2020]
Finished job 1103.
782 of 3292 steps (24%) done

[Sun Jul  5 22:12:25 2020]
rule remove_empty:
    input: per_gene/EOG091G0803/ALICUT_EOG091G0803.clustalo.fasta
    output: per_gene/EOG091G0803/empty_check.done
    jobid: 1925
    wildcards: BUSCO=EOG091G0803


         if [ "$(cat per_gene/EOG091G0803/ALICUT_EOG091G0803.clustalo.fasta | grep -v ">" | sed 's/-//g' | grep "^$" | wc -l)" -gt 0 ]
         then
              cp per_gene/EOG091G0803/ALICUT_EOG091G0803.clustalo.fasta per_gene/EOG091G0803/ALICUT_EOG091G0803.clustalo.fasta.backup
              bash ../scripts/remove_empty.sh per_gene/EOG091G0803/ALICUT_EOG091G0803.clustalo.fasta.backup > per_gene/EOG091G0803/ALICUT_EOG091G0803.clustalo.fasta
         fi
         touch per_gene/EOG091G0803/empty_check.done
         
[Sun Jul  5 22:12:25 2020]
Finished job 1925.
783 of 3292 steps (24%) done

[Sun Jul  5 22:12:25 2020]
rule find_best_model:
    input: per_gene/EOG091G0803/ALICUT_EOG091G0803.clustalo.fasta, per_gene/EOG091G0803/empty_check.done
    output: per_gene/EOG091G0803/EOG091G0803.best_model
    log: per_gene/EOG091G0803/find_best_model.stderr.txt
    jobid: 1102
    wildcards: BUSCO=EOG091G0803
    threads: 2


        cd per_gene/EOG091G0803
        if [ ! -d find_best_model ]
        then
            mkdir find_best_model
        fi
        cd find_best_model
        ln -s ../../../per_gene/EOG091G0803/ALICUT_EOG091G0803.clustalo.fasta EOG091G0803.fasta
        ProteinModelSelection.pl EOG091G0803.fasta 1> ../../../per_gene/EOG091G0803/EOG091G0803.best_model 2> ../../../per_gene/EOG091G0803/find_best_model.stderr.txt
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/c0c09ee657b1e27f2c5687e0e9aa8d70.simg
[Sun Jul  5 22:12:46 2020]
Finished job 92.
784 of 3292 steps (24%) done

[Sun Jul  5 22:12:46 2020]
rule get_seqs:
    input: /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ingroup.txt, /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/outgroup.txt
    output: per_gene/EOG091G11O6/EOG091G11O6.ingroup.fasta
    log: per_gene/EOG091G11O6/get_seqs.stdout.txt, per_gene/EOG091G11O6/get_seqs.stderr.txt
    jobid: 3260
    wildcards: BUSCO=EOG091G11O6
    threads: 2


	basedir=$(pwd)
        cd per_gene/EOG091G11O6
        
        bash $basedir/../scripts/fetch_seqs.sh EOG091G11O6 /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ingroup.txt /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/outgroup.txt 1> ../../per_gene/EOG091G11O6/get_seqs.stdout.txt 2> ../../per_gene/EOG091G11O6/get_seqs.stderr.txt
	mv EOG091G11O6.fasta $basedir/per_gene/EOG091G11O6/EOG091G11O6.ingroup.fasta
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/72476f9d9a5bd0627b4d721143a21354.simg
[Sun Jul  5 22:12:47 2020]
Finished job 181.
785 of 3292 steps (24%) done

[Sun Jul  5 22:12:47 2020]
rule get_seqs:
    input: /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ingroup.txt, /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/outgroup.txt
    output: per_gene/EOG091G02IP/EOG091G02IP.ingroup.fasta
    log: per_gene/EOG091G02IP/get_seqs.stdout.txt, per_gene/EOG091G02IP/get_seqs.stderr.txt
    jobid: 2946
    wildcards: BUSCO=EOG091G02IP
    threads: 2


	basedir=$(pwd)
        cd per_gene/EOG091G02IP
        
        bash $basedir/../scripts/fetch_seqs.sh EOG091G02IP /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ingroup.txt /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/outgroup.txt 1> ../../per_gene/EOG091G02IP/get_seqs.stdout.txt 2> ../../per_gene/EOG091G02IP/get_seqs.stderr.txt
	mv EOG091G02IP.fasta $basedir/per_gene/EOG091G02IP/EOG091G02IP.ingroup.fasta
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/72476f9d9a5bd0627b4d721143a21354.simg
[Sun Jul  5 22:13:05 2020]
Finished job 2946.
786 of 3292 steps (24%) done

[Sun Jul  5 22:13:05 2020]
rule get_outgroups:
    input: per_gene/EOG091G02IP/EOG091G02IP.ingroup.fasta
    output: per_gene/EOG091G02IP/EOG091G02IP.orthodb.fasta, per_gene/EOG091G02IP/EOG091G02IP.outgroup.fasta
    log: per_gene/EOG091G02IP/get_outgroups.stdout.txt, per_gene/EOG091G02IP/get_outgroups.stderr.txt
    jobid: 2947
    wildcards: BUSCO=EOG091G02IP


        #download fastas from Orhtodb for BUSCO id
        for i in {1..5}
        do
             wget "http://www.orthodb.org/fasta?query=EOG091G02IP&level=33208" -O per_gene/EOG091G02IP/EOG091G02IP.orthodb.fasta 1> per_gene/EOG091G02IP/get_outgroups.stdout.txt 2> per_gene/EOG091G02IP/get_outgroups.stderr.txt && break || echo -e "try again ($i)" && sleep 15
        done

	#This is quick an dirty for now and just takes the first protein if there is more than one for an outgroup taxon
        bash ../scripts/download_outgroups.sh taxids.txt per_gene/EOG091G02IP/EOG091G02IP.orthodb.fasta > per_gene/EOG091G02IP/EOG091G02IP.outgroup.fasta
        
[Sun Jul  5 22:13:06 2020]
Finished job 3260.
787 of 3292 steps (24%) done

[Sun Jul  5 22:13:06 2020]
rule get_seqs:
    input: /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ingroup.txt, /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/outgroup.txt
    output: per_gene/EOG091G0RVD/EOG091G0RVD.ingroup.fasta
    log: per_gene/EOG091G0RVD/get_seqs.stdout.txt, per_gene/EOG091G0RVD/get_seqs.stderr.txt
    jobid: 3020
    wildcards: BUSCO=EOG091G0RVD
    threads: 2


	basedir=$(pwd)
        cd per_gene/EOG091G0RVD
        
        bash $basedir/../scripts/fetch_seqs.sh EOG091G0RVD /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ingroup.txt /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/outgroup.txt 1> ../../per_gene/EOG091G0RVD/get_seqs.stdout.txt 2> ../../per_gene/EOG091G0RVD/get_seqs.stderr.txt
	mv EOG091G0RVD.fasta $basedir/per_gene/EOG091G0RVD/EOG091G0RVD.ingroup.fasta
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/72476f9d9a5bd0627b4d721143a21354.simg

[Sun Jul  5 22:13:12 2020]
rule get_outgroups:
    input: per_gene/EOG091G11O6/EOG091G11O6.ingroup.fasta
    output: per_gene/EOG091G11O6/EOG091G11O6.orthodb.fasta, per_gene/EOG091G11O6/EOG091G11O6.outgroup.fasta
    log: per_gene/EOG091G11O6/get_outgroups.stdout.txt, per_gene/EOG091G11O6/get_outgroups.stderr.txt
    jobid: 3261
    wildcards: BUSCO=EOG091G11O6


        #download fastas from Orhtodb for BUSCO id
        for i in {1..5}
        do
             wget "http://www.orthodb.org/fasta?query=EOG091G11O6&level=33208" -O per_gene/EOG091G11O6/EOG091G11O6.orthodb.fasta 1> per_gene/EOG091G11O6/get_outgroups.stdout.txt 2> per_gene/EOG091G11O6/get_outgroups.stderr.txt && break || echo -e "try again ($i)" && sleep 15
        done

	#This is quick an dirty for now and just takes the first protein if there is more than one for an outgroup taxon
        bash ../scripts/download_outgroups.sh taxids.txt per_gene/EOG091G11O6/EOG091G11O6.orthodb.fasta > per_gene/EOG091G11O6/EOG091G11O6.outgroup.fasta
        
[Sun Jul  5 22:13:12 2020]
Finished job 2947.
788 of 3292 steps (24%) done

[Sun Jul  5 22:13:12 2020]
rule join_groups:
    input: per_gene/EOG091G02IP/EOG091G02IP.ingroup.fasta, per_gene/EOG091G02IP/EOG091G02IP.outgroup.fasta
    output: per_gene/EOG091G02IP/EOG091G02IP.fasta
    jobid: 2297
    wildcards: BUSCO=EOG091G02IP


        cat per_gene/EOG091G02IP/EOG091G02IP.ingroup.fasta per_gene/EOG091G02IP/EOG091G02IP.outgroup.fasta > per_gene/EOG091G02IP/EOG091G02IP.fasta
        
[Sun Jul  5 22:13:12 2020]
Finished job 2297.
789 of 3292 steps (24%) done
[Sun Jul  5 22:13:12 2020]
Finished job 3261.
790 of 3292 steps (24%) done

[Sun Jul  5 22:13:12 2020]
rule MSA:
    input: per_gene/EOG091G02IP/EOG091G02IP.fasta
    output: per_gene/EOG091G02IP/EOG091G02IP.clustalo.fasta
    log: per_gene/EOG091G02IP/MSA.stdout.txt, per_gene/EOG091G02IP/MSA.stderr.txt
    jobid: 1714
    wildcards: BUSCO=EOG091G02IP
    threads: 2


        clustalo -i per_gene/EOG091G02IP/EOG091G02IP.fasta -o per_gene/EOG091G02IP/EOG091G02IP.clustalo.fasta --threads=2 1> per_gene/EOG091G02IP/MSA.stdout.txt 2> per_gene/EOG091G02IP/MSA.stderr.txt
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/d68c9691725a7401923680874285c430.simg
[Sun Jul  5 22:13:13 2020]
Finished job 278.
791 of 3292 steps (24%) done

[Sun Jul  5 22:13:13 2020]
rule join_groups:
    input: per_gene/EOG091G11O6/EOG091G11O6.ingroup.fasta, per_gene/EOG091G11O6/EOG091G11O6.outgroup.fasta
    output: per_gene/EOG091G11O6/EOG091G11O6.fasta
    jobid: 2454
    wildcards: BUSCO=EOG091G11O6


        cat per_gene/EOG091G11O6/EOG091G11O6.ingroup.fasta per_gene/EOG091G11O6/EOG091G11O6.outgroup.fasta > per_gene/EOG091G11O6/EOG091G11O6.fasta
        
[Sun Jul  5 22:13:13 2020]
Finished job 2454.
792 of 3292 steps (24%) done

[Sun Jul  5 22:13:13 2020]
rule MSA:
    input: per_gene/EOG091G11O6/EOG091G11O6.fasta
    output: per_gene/EOG091G11O6/EOG091G11O6.clustalo.fasta
    log: per_gene/EOG091G11O6/MSA.stdout.txt, per_gene/EOG091G11O6/MSA.stderr.txt
    jobid: 2028
    wildcards: BUSCO=EOG091G11O6
    threads: 2


        clustalo -i per_gene/EOG091G11O6/EOG091G11O6.fasta -o per_gene/EOG091G11O6/EOG091G11O6.clustalo.fasta --threads=2 1> per_gene/EOG091G11O6/MSA.stdout.txt 2> per_gene/EOG091G11O6/MSA.stderr.txt
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/d68c9691725a7401923680874285c430.simg
[Sun Jul  5 22:13:14 2020]
Finished job 2028.
793 of 3292 steps (24%) done

[Sun Jul  5 22:13:14 2020]
rule score_and_cut:
    input: per_gene/EOG091G11O6/EOG091G11O6.clustalo.fasta
    output: per_gene/EOG091G11O6/ALICUT_EOG091G11O6.clustalo.fasta
    jobid: 1205
    wildcards: BUSCO=EOG091G11O6
    threads: 2


        cd per_gene/EOG091G11O6
        Aliscore.pl -N -r 200000000000000000 -i ../../per_gene/EOG091G11O6/EOG091G11O6.clustalo.fasta &> aliscore.log
        ALICUT.pl -s &> alicut.log
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/63c88c27a0fa300f57066b0ef65fefcb.simg
[Sun Jul  5 22:13:17 2020]
Finished job 1714.
794 of 3292 steps (24%) done

[Sun Jul  5 22:13:17 2020]
rule score_and_cut:
    input: per_gene/EOG091G02IP/EOG091G02IP.clustalo.fasta
    output: per_gene/EOG091G02IP/ALICUT_EOG091G02IP.clustalo.fasta
    jobid: 891
    wildcards: BUSCO=EOG091G02IP
    threads: 2


        cd per_gene/EOG091G02IP
        Aliscore.pl -N -r 200000000000000000 -i ../../per_gene/EOG091G02IP/EOG091G02IP.clustalo.fasta &> aliscore.log
        ALICUT.pl -s &> alicut.log
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/63c88c27a0fa300f57066b0ef65fefcb.simg
[Sun Jul  5 22:13:23 2020]
Finished job 1205.
795 of 3292 steps (24%) done

[Sun Jul  5 22:13:23 2020]
rule remove_empty:
    input: per_gene/EOG091G11O6/ALICUT_EOG091G11O6.clustalo.fasta
    output: per_gene/EOG091G11O6/empty_check.done
    jobid: 2027
    wildcards: BUSCO=EOG091G11O6


         if [ "$(cat per_gene/EOG091G11O6/ALICUT_EOG091G11O6.clustalo.fasta | grep -v ">" | sed 's/-//g' | grep "^$" | wc -l)" -gt 0 ]
         then
              cp per_gene/EOG091G11O6/ALICUT_EOG091G11O6.clustalo.fasta per_gene/EOG091G11O6/ALICUT_EOG091G11O6.clustalo.fasta.backup
              bash ../scripts/remove_empty.sh per_gene/EOG091G11O6/ALICUT_EOG091G11O6.clustalo.fasta.backup > per_gene/EOG091G11O6/ALICUT_EOG091G11O6.clustalo.fasta
         fi
         touch per_gene/EOG091G11O6/empty_check.done
         
[Sun Jul  5 22:13:23 2020]
Finished job 2027.
796 of 3292 steps (24%) done

[Sun Jul  5 22:13:23 2020]
rule find_best_model:
    input: per_gene/EOG091G11O6/ALICUT_EOG091G11O6.clustalo.fasta, per_gene/EOG091G11O6/empty_check.done
    output: per_gene/EOG091G11O6/EOG091G11O6.best_model
    log: per_gene/EOG091G11O6/find_best_model.stderr.txt
    jobid: 1204
    wildcards: BUSCO=EOG091G11O6
    threads: 2


        cd per_gene/EOG091G11O6
        if [ ! -d find_best_model ]
        then
            mkdir find_best_model
        fi
        cd find_best_model
        ln -s ../../../per_gene/EOG091G11O6/ALICUT_EOG091G11O6.clustalo.fasta EOG091G11O6.fasta
        ProteinModelSelection.pl EOG091G11O6.fasta 1> ../../../per_gene/EOG091G11O6/EOG091G11O6.best_model 2> ../../../per_gene/EOG091G11O6/find_best_model.stderr.txt
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/c0c09ee657b1e27f2c5687e0e9aa8d70.simg
[Sun Jul  5 22:13:24 2020]
Finished job 3020.
797 of 3292 steps (24%) done

[Sun Jul  5 22:13:24 2020]
rule get_outgroups:
    input: per_gene/EOG091G0RVD/EOG091G0RVD.ingroup.fasta
    output: per_gene/EOG091G0RVD/EOG091G0RVD.orthodb.fasta, per_gene/EOG091G0RVD/EOG091G0RVD.outgroup.fasta
    log: per_gene/EOG091G0RVD/get_outgroups.stdout.txt, per_gene/EOG091G0RVD/get_outgroups.stderr.txt
    jobid: 3021
    wildcards: BUSCO=EOG091G0RVD


        #download fastas from Orhtodb for BUSCO id
        for i in {1..5}
        do
             wget "http://www.orthodb.org/fasta?query=EOG091G0RVD&level=33208" -O per_gene/EOG091G0RVD/EOG091G0RVD.orthodb.fasta 1> per_gene/EOG091G0RVD/get_outgroups.stdout.txt 2> per_gene/EOG091G0RVD/get_outgroups.stderr.txt && break || echo -e "try again ($i)" && sleep 15
        done

	#This is quick an dirty for now and just takes the first protein if there is more than one for an outgroup taxon
        bash ../scripts/download_outgroups.sh taxids.txt per_gene/EOG091G0RVD/EOG091G0RVD.orthodb.fasta > per_gene/EOG091G0RVD/EOG091G0RVD.outgroup.fasta
        
[Sun Jul  5 22:13:25 2020]
Finished job 3021.
798 of 3292 steps (24%) done

[Sun Jul  5 22:13:25 2020]
rule join_groups:
    input: per_gene/EOG091G0RVD/EOG091G0RVD.ingroup.fasta, per_gene/EOG091G0RVD/EOG091G0RVD.outgroup.fasta
    output: per_gene/EOG091G0RVD/EOG091G0RVD.fasta
    jobid: 2334
    wildcards: BUSCO=EOG091G0RVD


        cat per_gene/EOG091G0RVD/EOG091G0RVD.ingroup.fasta per_gene/EOG091G0RVD/EOG091G0RVD.outgroup.fasta > per_gene/EOG091G0RVD/EOG091G0RVD.fasta
        
[Sun Jul  5 22:13:25 2020]
Finished job 2334.
799 of 3292 steps (24%) done

[Sun Jul  5 22:13:25 2020]
rule MSA:
    input: per_gene/EOG091G0RVD/EOG091G0RVD.fasta
    output: per_gene/EOG091G0RVD/EOG091G0RVD.clustalo.fasta
    log: per_gene/EOG091G0RVD/MSA.stdout.txt, per_gene/EOG091G0RVD/MSA.stderr.txt
    jobid: 1788
    wildcards: BUSCO=EOG091G0RVD
    threads: 2


        clustalo -i per_gene/EOG091G0RVD/EOG091G0RVD.fasta -o per_gene/EOG091G0RVD/EOG091G0RVD.clustalo.fasta --threads=2 1> per_gene/EOG091G0RVD/MSA.stdout.txt 2> per_gene/EOG091G0RVD/MSA.stderr.txt
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/d68c9691725a7401923680874285c430.simg
[Sun Jul  5 22:13:25 2020]
Finished job 1788.
800 of 3292 steps (24%) done

[Sun Jul  5 22:13:25 2020]
rule score_and_cut:
    input: per_gene/EOG091G0RVD/EOG091G0RVD.clustalo.fasta
    output: per_gene/EOG091G0RVD/ALICUT_EOG091G0RVD.clustalo.fasta
    jobid: 965
    wildcards: BUSCO=EOG091G0RVD
    threads: 2


        cd per_gene/EOG091G0RVD
        Aliscore.pl -N -r 200000000000000000 -i ../../per_gene/EOG091G0RVD/EOG091G0RVD.clustalo.fasta &> aliscore.log
        ALICUT.pl -s &> alicut.log
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/63c88c27a0fa300f57066b0ef65fefcb.simg
[Sun Jul  5 22:13:28 2020]
Finished job 1102.
801 of 3292 steps (24%) done

[Sun Jul  5 22:13:28 2020]
rule infer_single_ML:
    input: per_gene/EOG091G0803/EOG091G0803.best_model, per_gene/EOG091G0803/ALICUT_EOG091G0803.clustalo.fasta
    output: per_gene/EOG091G0803/EOG091G0803.raxml.done
    log: per_gene/EOG091G0803/infer_single_ML.stdout.txt, per_gene/EOG091G0803/infer_single_ML.stderr.txt
    jobid: 345
    wildcards: BUSCO=EOG091G0803
    threads: 2


        cd per_gene/EOG091G0803
	count=$(cat ../../per_gene/EOG091G0803/ALICUT_EOG091G0803.clustalo.fasta | grep ">" | wc -l)
	if [ "$count" -gt 5 ]
        then
		RAxMLmodel=$(cat ../../per_gene/EOG091G0803/EOG091G0803.best_model | grep "Best" | cut -d ":" -f 2 | tr -d '[:space:]')
                if [ "$(ls -1 | grep "^RAxML" | wc -l)" -ne 0 ]
		then
			rm RAxML*
		fi
        	raxml -f a -T 2 -m PROTGAMMA$RAxMLmodel         	-p 12345 -x 12345 -# 100         	-s ../../per_gene/EOG091G0803/ALICUT_EOG091G0803.clustalo.fasta -n EOG091G0803.clustalo.aln.ALICUT.$RAxMLmodel 		1> ../../per_gene/EOG091G0803/infer_single_ML.stdout.txt 2> ../../per_gene/EOG091G0803/infer_single_ML.stderr.txt
	else
		echo "fasta file per_gene/EOG091G0803/ALICUT_EOG091G0803.clustalo.fasta contains fewer than 5 sequences - skipped" > ../../per_gene/EOG091G0803/infer_single_ML.stdout.txt
		touch raxml.skipped
	fi
        touch ../../per_gene/EOG091G0803/EOG091G0803.raxml.done
        
[Sun Jul  5 22:13:28 2020]
Finished job 891.
802 of 3292 steps (24%) done

[Sun Jul  5 22:13:28 2020]
rule remove_empty:
    input: per_gene/EOG091G02IP/ALICUT_EOG091G02IP.clustalo.fasta
    output: per_gene/EOG091G02IP/empty_check.done
    jobid: 1713
    wildcards: BUSCO=EOG091G02IP


         if [ "$(cat per_gene/EOG091G02IP/ALICUT_EOG091G02IP.clustalo.fasta | grep -v ">" | sed 's/-//g' | grep "^$" | wc -l)" -gt 0 ]
         then
              cp per_gene/EOG091G02IP/ALICUT_EOG091G02IP.clustalo.fasta per_gene/EOG091G02IP/ALICUT_EOG091G02IP.clustalo.fasta.backup
              bash ../scripts/remove_empty.sh per_gene/EOG091G02IP/ALICUT_EOG091G02IP.clustalo.fasta.backup > per_gene/EOG091G02IP/ALICUT_EOG091G02IP.clustalo.fasta
         fi
         touch per_gene/EOG091G02IP/empty_check.done
         
[Sun Jul  5 22:13:28 2020]
Finished job 1713.
803 of 3292 steps (24%) done

[Sun Jul  5 22:13:28 2020]
rule find_best_model:
    input: per_gene/EOG091G02IP/ALICUT_EOG091G02IP.clustalo.fasta, per_gene/EOG091G02IP/empty_check.done
    output: per_gene/EOG091G02IP/EOG091G02IP.best_model
    log: per_gene/EOG091G02IP/find_best_model.stderr.txt
    jobid: 890
    wildcards: BUSCO=EOG091G02IP
    threads: 2


        cd per_gene/EOG091G02IP
        if [ ! -d find_best_model ]
        then
            mkdir find_best_model
        fi
        cd find_best_model
        ln -s ../../../per_gene/EOG091G02IP/ALICUT_EOG091G02IP.clustalo.fasta EOG091G02IP.fasta
        ProteinModelSelection.pl EOG091G02IP.fasta 1> ../../../per_gene/EOG091G02IP/EOG091G02IP.best_model 2> ../../../per_gene/EOG091G02IP/find_best_model.stderr.txt
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/c0c09ee657b1e27f2c5687e0e9aa8d70.simg
[33mJob counts:
	count	jobs
	1	infer_single_ML
	1[0m
[33m
        cd per_gene/EOG091G0803
	count=$(cat ../../per_gene/EOG091G0803/ALICUT_EOG091G0803.clustalo.fasta | grep ">" | wc -l)
	if [ "$count" -gt 5 ]
        then
		RAxMLmodel=$(cat ../../per_gene/EOG091G0803/EOG091G0803.best_model | grep "Best" | cut -d ":" -f 2 | tr -d '[:space:]')
                if [ "$(ls -1 | grep "^RAxML" | wc -l)" -ne 0 ]
		then
			rm RAxML*
		fi
        	raxml -f a -T 2 -m PROTGAMMA$RAxMLmodel         	-p 12345 -x 12345 -# 100         	-s ../../per_gene/EOG091G0803/ALICUT_EOG091G0803.clustalo.fasta -n EOG091G0803.clustalo.aln.ALICUT.$RAxMLmodel 		1> ../../per_gene/EOG091G0803/infer_single_ML.stdout.txt 2> ../../per_gene/EOG091G0803/infer_single_ML.stderr.txt
	else
		echo "fasta file per_gene/EOG091G0803/ALICUT_EOG091G0803.clustalo.fasta contains fewer than 5 sequences - skipped" > ../../per_gene/EOG091G0803/infer_single_ML.stdout.txt
		touch raxml.skipped
	fi
        touch ../../per_gene/EOG091G0803/EOG091G0803.raxml.done
        [0m
[Sun Jul  5 22:13:30 2020]
Finished job 379.
804 of 3292 steps (24%) done

[Sun Jul  5 22:13:30 2020]
rule get_seqs:
    input: /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ingroup.txt, /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/outgroup.txt
    output: per_gene/EOG091G0ZRG/EOG091G0ZRG.ingroup.fasta
    log: per_gene/EOG091G0ZRG/get_seqs.stdout.txt, per_gene/EOG091G0ZRG/get_seqs.stderr.txt
    jobid: 3038
    wildcards: BUSCO=EOG091G0ZRG
    threads: 2


	basedir=$(pwd)
        cd per_gene/EOG091G0ZRG
        
        bash $basedir/../scripts/fetch_seqs.sh EOG091G0ZRG /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ingroup.txt /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/outgroup.txt 1> ../../per_gene/EOG091G0ZRG/get_seqs.stdout.txt 2> ../../per_gene/EOG091G0ZRG/get_seqs.stderr.txt
	mv EOG091G0ZRG.fasta $basedir/per_gene/EOG091G0ZRG/EOG091G0ZRG.ingroup.fasta
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/72476f9d9a5bd0627b4d721143a21354.simg
[Sun Jul  5 22:13:36 2020]
Finished job 965.
805 of 3292 steps (24%) done

[Sun Jul  5 22:13:36 2020]
rule remove_empty:
    input: per_gene/EOG091G0RVD/ALICUT_EOG091G0RVD.clustalo.fasta
    output: per_gene/EOG091G0RVD/empty_check.done
    jobid: 1787
    wildcards: BUSCO=EOG091G0RVD


         if [ "$(cat per_gene/EOG091G0RVD/ALICUT_EOG091G0RVD.clustalo.fasta | grep -v ">" | sed 's/-//g' | grep "^$" | wc -l)" -gt 0 ]
         then
              cp per_gene/EOG091G0RVD/ALICUT_EOG091G0RVD.clustalo.fasta per_gene/EOG091G0RVD/ALICUT_EOG091G0RVD.clustalo.fasta.backup
              bash ../scripts/remove_empty.sh per_gene/EOG091G0RVD/ALICUT_EOG091G0RVD.clustalo.fasta.backup > per_gene/EOG091G0RVD/ALICUT_EOG091G0RVD.clustalo.fasta
         fi
         touch per_gene/EOG091G0RVD/empty_check.done
         
[Sun Jul  5 22:13:37 2020]
Finished job 1787.
806 of 3292 steps (24%) done

[Sun Jul  5 22:13:37 2020]
rule find_best_model:
    input: per_gene/EOG091G0RVD/ALICUT_EOG091G0RVD.clustalo.fasta, per_gene/EOG091G0RVD/empty_check.done
    output: per_gene/EOG091G0RVD/EOG091G0RVD.best_model
    log: per_gene/EOG091G0RVD/find_best_model.stderr.txt
    jobid: 964
    wildcards: BUSCO=EOG091G0RVD
    threads: 2


        cd per_gene/EOG091G0RVD
        if [ ! -d find_best_model ]
        then
            mkdir find_best_model
        fi
        cd find_best_model
        ln -s ../../../per_gene/EOG091G0RVD/ALICUT_EOG091G0RVD.clustalo.fasta EOG091G0RVD.fasta
        ProteinModelSelection.pl EOG091G0RVD.fasta 1> ../../../per_gene/EOG091G0RVD/EOG091G0RVD.best_model 2> ../../../per_gene/EOG091G0RVD/find_best_model.stderr.txt
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/c0c09ee657b1e27f2c5687e0e9aa8d70.simg
[Sun Jul  5 22:13:44 2020]
Finished job 3038.
807 of 3292 steps (25%) done

[Sun Jul  5 22:13:44 2020]
rule get_outgroups:
    input: per_gene/EOG091G0ZRG/EOG091G0ZRG.ingroup.fasta
    output: per_gene/EOG091G0ZRG/EOG091G0ZRG.orthodb.fasta, per_gene/EOG091G0ZRG/EOG091G0ZRG.outgroup.fasta
    log: per_gene/EOG091G0ZRG/get_outgroups.stdout.txt, per_gene/EOG091G0ZRG/get_outgroups.stderr.txt
    jobid: 3039
    wildcards: BUSCO=EOG091G0ZRG


        #download fastas from Orhtodb for BUSCO id
        for i in {1..5}
        do
             wget "http://www.orthodb.org/fasta?query=EOG091G0ZRG&level=33208" -O per_gene/EOG091G0ZRG/EOG091G0ZRG.orthodb.fasta 1> per_gene/EOG091G0ZRG/get_outgroups.stdout.txt 2> per_gene/EOG091G0ZRG/get_outgroups.stderr.txt && break || echo -e "try again ($i)" && sleep 15
        done

	#This is quick an dirty for now and just takes the first protein if there is more than one for an outgroup taxon
        bash ../scripts/download_outgroups.sh taxids.txt per_gene/EOG091G0ZRG/EOG091G0ZRG.orthodb.fasta > per_gene/EOG091G0ZRG/EOG091G0ZRG.outgroup.fasta
        
[Sun Jul  5 22:13:45 2020]
Finished job 3039.
808 of 3292 steps (25%) done

[Sun Jul  5 22:13:45 2020]
rule join_groups:
    input: per_gene/EOG091G0ZRG/EOG091G0ZRG.ingroup.fasta, per_gene/EOG091G0ZRG/EOG091G0ZRG.outgroup.fasta
    output: per_gene/EOG091G0ZRG/EOG091G0ZRG.fasta
    jobid: 2343
    wildcards: BUSCO=EOG091G0ZRG


        cat per_gene/EOG091G0ZRG/EOG091G0ZRG.ingroup.fasta per_gene/EOG091G0ZRG/EOG091G0ZRG.outgroup.fasta > per_gene/EOG091G0ZRG/EOG091G0ZRG.fasta
        
[Sun Jul  5 22:13:45 2020]
Finished job 2343.
809 of 3292 steps (25%) done

[Sun Jul  5 22:13:45 2020]
rule MSA:
    input: per_gene/EOG091G0ZRG/EOG091G0ZRG.fasta
    output: per_gene/EOG091G0ZRG/EOG091G0ZRG.clustalo.fasta
    log: per_gene/EOG091G0ZRG/MSA.stdout.txt, per_gene/EOG091G0ZRG/MSA.stderr.txt
    jobid: 1806
    wildcards: BUSCO=EOG091G0ZRG
    threads: 2


        clustalo -i per_gene/EOG091G0ZRG/EOG091G0ZRG.fasta -o per_gene/EOG091G0ZRG/EOG091G0ZRG.clustalo.fasta --threads=2 1> per_gene/EOG091G0ZRG/MSA.stdout.txt 2> per_gene/EOG091G0ZRG/MSA.stderr.txt
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/d68c9691725a7401923680874285c430.simg
[Sun Jul  5 22:13:46 2020]
Finished job 1806.
810 of 3292 steps (25%) done

[Sun Jul  5 22:13:46 2020]
rule score_and_cut:
    input: per_gene/EOG091G0ZRG/EOG091G0ZRG.clustalo.fasta
    output: per_gene/EOG091G0ZRG/ALICUT_EOG091G0ZRG.clustalo.fasta
    jobid: 983
    wildcards: BUSCO=EOG091G0ZRG
    threads: 2


        cd per_gene/EOG091G0ZRG
        Aliscore.pl -N -r 200000000000000000 -i ../../per_gene/EOG091G0ZRG/EOG091G0ZRG.clustalo.fasta &> aliscore.log
        ALICUT.pl -s &> alicut.log
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/63c88c27a0fa300f57066b0ef65fefcb.simg
[Sun Jul  5 22:13:51 2020]
Finished job 1204.
811 of 3292 steps (25%) done

[Sun Jul  5 22:13:51 2020]
rule infer_single_ML:
    input: per_gene/EOG091G11O6/EOG091G11O6.best_model, per_gene/EOG091G11O6/ALICUT_EOG091G11O6.clustalo.fasta
    output: per_gene/EOG091G11O6/EOG091G11O6.raxml.done
    log: per_gene/EOG091G11O6/infer_single_ML.stdout.txt, per_gene/EOG091G11O6/infer_single_ML.stderr.txt
    jobid: 396
    wildcards: BUSCO=EOG091G11O6
    threads: 2


        cd per_gene/EOG091G11O6
	count=$(cat ../../per_gene/EOG091G11O6/ALICUT_EOG091G11O6.clustalo.fasta | grep ">" | wc -l)
	if [ "$count" -gt 5 ]
        then
		RAxMLmodel=$(cat ../../per_gene/EOG091G11O6/EOG091G11O6.best_model | grep "Best" | cut -d ":" -f 2 | tr -d '[:space:]')
                if [ "$(ls -1 | grep "^RAxML" | wc -l)" -ne 0 ]
		then
			rm RAxML*
		fi
        	raxml -f a -T 2 -m PROTGAMMA$RAxMLmodel         	-p 12345 -x 12345 -# 100         	-s ../../per_gene/EOG091G11O6/ALICUT_EOG091G11O6.clustalo.fasta -n EOG091G11O6.clustalo.aln.ALICUT.$RAxMLmodel 		1> ../../per_gene/EOG091G11O6/infer_single_ML.stdout.txt 2> ../../per_gene/EOG091G11O6/infer_single_ML.stderr.txt
	else
		echo "fasta file per_gene/EOG091G11O6/ALICUT_EOG091G11O6.clustalo.fasta contains fewer than 5 sequences - skipped" > ../../per_gene/EOG091G11O6/infer_single_ML.stdout.txt
		touch raxml.skipped
	fi
        touch ../../per_gene/EOG091G11O6/EOG091G11O6.raxml.done
        
[33mJob counts:
	count	jobs
	1	infer_single_ML
	1[0m
[33m
        cd per_gene/EOG091G11O6
	count=$(cat ../../per_gene/EOG091G11O6/ALICUT_EOG091G11O6.clustalo.fasta | grep ">" | wc -l)
	if [ "$count" -gt 5 ]
        then
		RAxMLmodel=$(cat ../../per_gene/EOG091G11O6/EOG091G11O6.best_model | grep "Best" | cut -d ":" -f 2 | tr -d '[:space:]')
                if [ "$(ls -1 | grep "^RAxML" | wc -l)" -ne 0 ]
		then
			rm RAxML*
		fi
        	raxml -f a -T 2 -m PROTGAMMA$RAxMLmodel         	-p 12345 -x 12345 -# 100         	-s ../../per_gene/EOG091G11O6/ALICUT_EOG091G11O6.clustalo.fasta -n EOG091G11O6.clustalo.aln.ALICUT.$RAxMLmodel 		1> ../../per_gene/EOG091G11O6/infer_single_ML.stdout.txt 2> ../../per_gene/EOG091G11O6/infer_single_ML.stderr.txt
	else
		echo "fasta file per_gene/EOG091G11O6/ALICUT_EOG091G11O6.clustalo.fasta contains fewer than 5 sequences - skipped" > ../../per_gene/EOG091G11O6/infer_single_ML.stdout.txt
		touch raxml.skipped
	fi
        touch ../../per_gene/EOG091G11O6/EOG091G11O6.raxml.done
        [0m
[Sun Jul  5 22:13:53 2020]
Finished job 11.
812 of 3292 steps (25%) done

[Sun Jul  5 22:13:53 2020]
rule get_seqs:
    input: /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ingroup.txt, /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/outgroup.txt
    output: per_gene/EOG091G08ZG/EOG091G08ZG.ingroup.fasta
    log: per_gene/EOG091G08ZG/get_seqs.stdout.txt, per_gene/EOG091G08ZG/get_seqs.stderr.txt
    jobid: 2598
    wildcards: BUSCO=EOG091G08ZG
    threads: 2


	basedir=$(pwd)
        cd per_gene/EOG091G08ZG
        
        bash $basedir/../scripts/fetch_seqs.sh EOG091G08ZG /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ingroup.txt /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/outgroup.txt 1> ../../per_gene/EOG091G08ZG/get_seqs.stdout.txt 2> ../../per_gene/EOG091G08ZG/get_seqs.stderr.txt
	mv EOG091G08ZG.fasta $basedir/per_gene/EOG091G08ZG/EOG091G08ZG.ingroup.fasta
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/72476f9d9a5bd0627b4d721143a21354.simg
[Sun Jul  5 22:13:56 2020]
Finished job 983.
813 of 3292 steps (25%) done

[Sun Jul  5 22:13:56 2020]
rule remove_empty:
    input: per_gene/EOG091G0ZRG/ALICUT_EOG091G0ZRG.clustalo.fasta
    output: per_gene/EOG091G0ZRG/empty_check.done
    jobid: 1805
    wildcards: BUSCO=EOG091G0ZRG


         if [ "$(cat per_gene/EOG091G0ZRG/ALICUT_EOG091G0ZRG.clustalo.fasta | grep -v ">" | sed 's/-//g' | grep "^$" | wc -l)" -gt 0 ]
         then
              cp per_gene/EOG091G0ZRG/ALICUT_EOG091G0ZRG.clustalo.fasta per_gene/EOG091G0ZRG/ALICUT_EOG091G0ZRG.clustalo.fasta.backup
              bash ../scripts/remove_empty.sh per_gene/EOG091G0ZRG/ALICUT_EOG091G0ZRG.clustalo.fasta.backup > per_gene/EOG091G0ZRG/ALICUT_EOG091G0ZRG.clustalo.fasta
         fi
         touch per_gene/EOG091G0ZRG/empty_check.done
         
[Sun Jul  5 22:13:56 2020]
Finished job 1805.
814 of 3292 steps (25%) done

[Sun Jul  5 22:13:56 2020]
rule find_best_model:
    input: per_gene/EOG091G0ZRG/ALICUT_EOG091G0ZRG.clustalo.fasta, per_gene/EOG091G0ZRG/empty_check.done
    output: per_gene/EOG091G0ZRG/EOG091G0ZRG.best_model
    log: per_gene/EOG091G0ZRG/find_best_model.stderr.txt
    jobid: 982
    wildcards: BUSCO=EOG091G0ZRG
    threads: 2


        cd per_gene/EOG091G0ZRG
        if [ ! -d find_best_model ]
        then
            mkdir find_best_model
        fi
        cd find_best_model
        ln -s ../../../per_gene/EOG091G0ZRG/ALICUT_EOG091G0ZRG.clustalo.fasta EOG091G0ZRG.fasta
        ProteinModelSelection.pl EOG091G0ZRG.fasta 1> ../../../per_gene/EOG091G0ZRG/EOG091G0ZRG.best_model 2> ../../../per_gene/EOG091G0ZRG/find_best_model.stderr.txt
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/c0c09ee657b1e27f2c5687e0e9aa8d70.simg
[Sun Jul  5 22:14:06 2020]
Finished job 964.
815 of 3292 steps (25%) done

[Sun Jul  5 22:14:06 2020]
rule infer_single_ML:
    input: per_gene/EOG091G0RVD/EOG091G0RVD.best_model, per_gene/EOG091G0RVD/ALICUT_EOG091G0RVD.clustalo.fasta
    output: per_gene/EOG091G0RVD/EOG091G0RVD.raxml.done
    log: per_gene/EOG091G0RVD/infer_single_ML.stdout.txt, per_gene/EOG091G0RVD/infer_single_ML.stderr.txt
    jobid: 276
    wildcards: BUSCO=EOG091G0RVD
    threads: 2


        cd per_gene/EOG091G0RVD
	count=$(cat ../../per_gene/EOG091G0RVD/ALICUT_EOG091G0RVD.clustalo.fasta | grep ">" | wc -l)
	if [ "$count" -gt 5 ]
        then
		RAxMLmodel=$(cat ../../per_gene/EOG091G0RVD/EOG091G0RVD.best_model | grep "Best" | cut -d ":" -f 2 | tr -d '[:space:]')
                if [ "$(ls -1 | grep "^RAxML" | wc -l)" -ne 0 ]
		then
			rm RAxML*
		fi
        	raxml -f a -T 2 -m PROTGAMMA$RAxMLmodel         	-p 12345 -x 12345 -# 100         	-s ../../per_gene/EOG091G0RVD/ALICUT_EOG091G0RVD.clustalo.fasta -n EOG091G0RVD.clustalo.aln.ALICUT.$RAxMLmodel 		1> ../../per_gene/EOG091G0RVD/infer_single_ML.stdout.txt 2> ../../per_gene/EOG091G0RVD/infer_single_ML.stderr.txt
	else
		echo "fasta file per_gene/EOG091G0RVD/ALICUT_EOG091G0RVD.clustalo.fasta contains fewer than 5 sequences - skipped" > ../../per_gene/EOG091G0RVD/infer_single_ML.stdout.txt
		touch raxml.skipped
	fi
        touch ../../per_gene/EOG091G0RVD/EOG091G0RVD.raxml.done
        
[Sun Jul  5 22:14:07 2020]
Finished job 2598.
816 of 3292 steps (25%) done

[Sun Jul  5 22:14:07 2020]
rule get_outgroups:
    input: per_gene/EOG091G08ZG/EOG091G08ZG.ingroup.fasta
    output: per_gene/EOG091G08ZG/EOG091G08ZG.orthodb.fasta, per_gene/EOG091G08ZG/EOG091G08ZG.outgroup.fasta
    log: per_gene/EOG091G08ZG/get_outgroups.stdout.txt, per_gene/EOG091G08ZG/get_outgroups.stderr.txt
    jobid: 2599
    wildcards: BUSCO=EOG091G08ZG


        #download fastas from Orhtodb for BUSCO id
        for i in {1..5}
        do
             wget "http://www.orthodb.org/fasta?query=EOG091G08ZG&level=33208" -O per_gene/EOG091G08ZG/EOG091G08ZG.orthodb.fasta 1> per_gene/EOG091G08ZG/get_outgroups.stdout.txt 2> per_gene/EOG091G08ZG/get_outgroups.stderr.txt && break || echo -e "try again ($i)" && sleep 15
        done

	#This is quick an dirty for now and just takes the first protein if there is more than one for an outgroup taxon
        bash ../scripts/download_outgroups.sh taxids.txt per_gene/EOG091G08ZG/EOG091G08ZG.orthodb.fasta > per_gene/EOG091G08ZG/EOG091G08ZG.outgroup.fasta
        
[33mJob counts:
	count	jobs
	1	infer_single_ML
	1[0m
[33m
        cd per_gene/EOG091G0RVD
	count=$(cat ../../per_gene/EOG091G0RVD/ALICUT_EOG091G0RVD.clustalo.fasta | grep ">" | wc -l)
	if [ "$count" -gt 5 ]
        then
		RAxMLmodel=$(cat ../../per_gene/EOG091G0RVD/EOG091G0RVD.best_model | grep "Best" | cut -d ":" -f 2 | tr -d '[:space:]')
                if [ "$(ls -1 | grep "^RAxML" | wc -l)" -ne 0 ]
		then
			rm RAxML*
		fi
        	raxml -f a -T 2 -m PROTGAMMA$RAxMLmodel         	-p 12345 -x 12345 -# 100         	-s ../../per_gene/EOG091G0RVD/ALICUT_EOG091G0RVD.clustalo.fasta -n EOG091G0RVD.clustalo.aln.ALICUT.$RAxMLmodel 		1> ../../per_gene/EOG091G0RVD/infer_single_ML.stdout.txt 2> ../../per_gene/EOG091G0RVD/infer_single_ML.stderr.txt
	else
		echo "fasta file per_gene/EOG091G0RVD/ALICUT_EOG091G0RVD.clustalo.fasta contains fewer than 5 sequences - skipped" > ../../per_gene/EOG091G0RVD/infer_single_ML.stdout.txt
		touch raxml.skipped
	fi
        touch ../../per_gene/EOG091G0RVD/EOG091G0RVD.raxml.done
        [0m
[Sun Jul  5 22:14:08 2020]
Finished job 2599.
817 of 3292 steps (25%) done

[Sun Jul  5 22:14:08 2020]
rule join_groups:
    input: per_gene/EOG091G08ZG/EOG091G08ZG.ingroup.fasta, per_gene/EOG091G08ZG/EOG091G08ZG.outgroup.fasta
    output: per_gene/EOG091G08ZG/EOG091G08ZG.fasta
    jobid: 2123
    wildcards: BUSCO=EOG091G08ZG


        cat per_gene/EOG091G08ZG/EOG091G08ZG.ingroup.fasta per_gene/EOG091G08ZG/EOG091G08ZG.outgroup.fasta > per_gene/EOG091G08ZG/EOG091G08ZG.fasta
        
[Sun Jul  5 22:14:08 2020]
Finished job 2123.
818 of 3292 steps (25%) done

[Sun Jul  5 22:14:08 2020]
rule MSA:
    input: per_gene/EOG091G08ZG/EOG091G08ZG.fasta
    output: per_gene/EOG091G08ZG/EOG091G08ZG.clustalo.fasta
    log: per_gene/EOG091G08ZG/MSA.stdout.txt, per_gene/EOG091G08ZG/MSA.stderr.txt
    jobid: 1366
    wildcards: BUSCO=EOG091G08ZG
    threads: 2


        clustalo -i per_gene/EOG091G08ZG/EOG091G08ZG.fasta -o per_gene/EOG091G08ZG/EOG091G08ZG.clustalo.fasta --threads=2 1> per_gene/EOG091G08ZG/MSA.stdout.txt 2> per_gene/EOG091G08ZG/MSA.stderr.txt
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/d68c9691725a7401923680874285c430.simg
[Sun Jul  5 22:14:09 2020]
Finished job 1366.
819 of 3292 steps (25%) done

[Sun Jul  5 22:14:09 2020]
rule score_and_cut:
    input: per_gene/EOG091G08ZG/EOG091G08ZG.clustalo.fasta
    output: per_gene/EOG091G08ZG/ALICUT_EOG091G08ZG.clustalo.fasta
    jobid: 543
    wildcards: BUSCO=EOG091G08ZG
    threads: 2


        cd per_gene/EOG091G08ZG
        Aliscore.pl -N -r 200000000000000000 -i ../../per_gene/EOG091G08ZG/EOG091G08ZG.clustalo.fasta &> aliscore.log
        ALICUT.pl -s &> alicut.log
        
[Sun Jul  5 22:14:09 2020]
Finished job 890.
820 of 3292 steps (25%) done
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/63c88c27a0fa300f57066b0ef65fefcb.simg

[Sun Jul  5 22:14:09 2020]
rule infer_single_ML:
    input: per_gene/EOG091G02IP/EOG091G02IP.best_model, per_gene/EOG091G02IP/ALICUT_EOG091G02IP.clustalo.fasta
    output: per_gene/EOG091G02IP/EOG091G02IP.raxml.done
    log: per_gene/EOG091G02IP/infer_single_ML.stdout.txt, per_gene/EOG091G02IP/infer_single_ML.stderr.txt
    jobid: 239
    wildcards: BUSCO=EOG091G02IP
    threads: 2


        cd per_gene/EOG091G02IP
	count=$(cat ../../per_gene/EOG091G02IP/ALICUT_EOG091G02IP.clustalo.fasta | grep ">" | wc -l)
	if [ "$count" -gt 5 ]
        then
		RAxMLmodel=$(cat ../../per_gene/EOG091G02IP/EOG091G02IP.best_model | grep "Best" | cut -d ":" -f 2 | tr -d '[:space:]')
                if [ "$(ls -1 | grep "^RAxML" | wc -l)" -ne 0 ]
		then
			rm RAxML*
		fi
        	raxml -f a -T 2 -m PROTGAMMA$RAxMLmodel         	-p 12345 -x 12345 -# 100         	-s ../../per_gene/EOG091G02IP/ALICUT_EOG091G02IP.clustalo.fasta -n EOG091G02IP.clustalo.aln.ALICUT.$RAxMLmodel 		1> ../../per_gene/EOG091G02IP/infer_single_ML.stdout.txt 2> ../../per_gene/EOG091G02IP/infer_single_ML.stderr.txt
	else
		echo "fasta file per_gene/EOG091G02IP/ALICUT_EOG091G02IP.clustalo.fasta contains fewer than 5 sequences - skipped" > ../../per_gene/EOG091G02IP/infer_single_ML.stdout.txt
		touch raxml.skipped
	fi
        touch ../../per_gene/EOG091G02IP/EOG091G02IP.raxml.done
        
[33mJob counts:
	count	jobs
	1	infer_single_ML
	1[0m
[33m
        cd per_gene/EOG091G02IP
	count=$(cat ../../per_gene/EOG091G02IP/ALICUT_EOG091G02IP.clustalo.fasta | grep ">" | wc -l)
	if [ "$count" -gt 5 ]
        then
		RAxMLmodel=$(cat ../../per_gene/EOG091G02IP/EOG091G02IP.best_model | grep "Best" | cut -d ":" -f 2 | tr -d '[:space:]')
                if [ "$(ls -1 | grep "^RAxML" | wc -l)" -ne 0 ]
		then
			rm RAxML*
		fi
        	raxml -f a -T 2 -m PROTGAMMA$RAxMLmodel         	-p 12345 -x 12345 -# 100         	-s ../../per_gene/EOG091G02IP/ALICUT_EOG091G02IP.clustalo.fasta -n EOG091G02IP.clustalo.aln.ALICUT.$RAxMLmodel 		1> ../../per_gene/EOG091G02IP/infer_single_ML.stdout.txt 2> ../../per_gene/EOG091G02IP/infer_single_ML.stderr.txt
	else
		echo "fasta file per_gene/EOG091G02IP/ALICUT_EOG091G02IP.clustalo.fasta contains fewer than 5 sequences - skipped" > ../../per_gene/EOG091G02IP/infer_single_ML.stdout.txt
		touch raxml.skipped
	fi
        touch ../../per_gene/EOG091G02IP/EOG091G02IP.raxml.done
        [0m
[Sun Jul  5 22:14:19 2020]
Finished job 543.
821 of 3292 steps (25%) done

[Sun Jul  5 22:14:19 2020]
rule remove_empty:
    input: per_gene/EOG091G08ZG/ALICUT_EOG091G08ZG.clustalo.fasta
    output: per_gene/EOG091G08ZG/empty_check.done
    jobid: 1365
    wildcards: BUSCO=EOG091G08ZG


         if [ "$(cat per_gene/EOG091G08ZG/ALICUT_EOG091G08ZG.clustalo.fasta | grep -v ">" | sed 's/-//g' | grep "^$" | wc -l)" -gt 0 ]
         then
              cp per_gene/EOG091G08ZG/ALICUT_EOG091G08ZG.clustalo.fasta per_gene/EOG091G08ZG/ALICUT_EOG091G08ZG.clustalo.fasta.backup
              bash ../scripts/remove_empty.sh per_gene/EOG091G08ZG/ALICUT_EOG091G08ZG.clustalo.fasta.backup > per_gene/EOG091G08ZG/ALICUT_EOG091G08ZG.clustalo.fasta
         fi
         touch per_gene/EOG091G08ZG/empty_check.done
         
[Sun Jul  5 22:14:19 2020]
Finished job 1365.
822 of 3292 steps (25%) done

[Sun Jul  5 22:14:19 2020]
rule find_best_model:
    input: per_gene/EOG091G08ZG/ALICUT_EOG091G08ZG.clustalo.fasta, per_gene/EOG091G08ZG/empty_check.done
    output: per_gene/EOG091G08ZG/EOG091G08ZG.best_model
    log: per_gene/EOG091G08ZG/find_best_model.stderr.txt
    jobid: 542
    wildcards: BUSCO=EOG091G08ZG
    threads: 2


        cd per_gene/EOG091G08ZG
        if [ ! -d find_best_model ]
        then
            mkdir find_best_model
        fi
        cd find_best_model
        ln -s ../../../per_gene/EOG091G08ZG/ALICUT_EOG091G08ZG.clustalo.fasta EOG091G08ZG.fasta
        ProteinModelSelection.pl EOG091G08ZG.fasta 1> ../../../per_gene/EOG091G08ZG/EOG091G08ZG.best_model 2> ../../../per_gene/EOG091G08ZG/find_best_model.stderr.txt
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/c0c09ee657b1e27f2c5687e0e9aa8d70.simg
[Sun Jul  5 22:14:35 2020]
Finished job 982.
823 of 3292 steps (25%) done

[Sun Jul  5 22:14:35 2020]
rule infer_single_ML:
    input: per_gene/EOG091G0ZRG/EOG091G0ZRG.best_model, per_gene/EOG091G0ZRG/ALICUT_EOG091G0ZRG.clustalo.fasta
    output: per_gene/EOG091G0ZRG/EOG091G0ZRG.raxml.done
    log: per_gene/EOG091G0ZRG/infer_single_ML.stdout.txt, per_gene/EOG091G0ZRG/infer_single_ML.stderr.txt
    jobid: 285
    wildcards: BUSCO=EOG091G0ZRG
    threads: 2


        cd per_gene/EOG091G0ZRG
	count=$(cat ../../per_gene/EOG091G0ZRG/ALICUT_EOG091G0ZRG.clustalo.fasta | grep ">" | wc -l)
	if [ "$count" -gt 5 ]
        then
		RAxMLmodel=$(cat ../../per_gene/EOG091G0ZRG/EOG091G0ZRG.best_model | grep "Best" | cut -d ":" -f 2 | tr -d '[:space:]')
                if [ "$(ls -1 | grep "^RAxML" | wc -l)" -ne 0 ]
		then
			rm RAxML*
		fi
        	raxml -f a -T 2 -m PROTGAMMA$RAxMLmodel         	-p 12345 -x 12345 -# 100         	-s ../../per_gene/EOG091G0ZRG/ALICUT_EOG091G0ZRG.clustalo.fasta -n EOG091G0ZRG.clustalo.aln.ALICUT.$RAxMLmodel 		1> ../../per_gene/EOG091G0ZRG/infer_single_ML.stdout.txt 2> ../../per_gene/EOG091G0ZRG/infer_single_ML.stderr.txt
	else
		echo "fasta file per_gene/EOG091G0ZRG/ALICUT_EOG091G0ZRG.clustalo.fasta contains fewer than 5 sequences - skipped" > ../../per_gene/EOG091G0ZRG/infer_single_ML.stdout.txt
		touch raxml.skipped
	fi
        touch ../../per_gene/EOG091G0ZRG/EOG091G0ZRG.raxml.done
        
[33mJob counts:
	count	jobs
	1	infer_single_ML
	1[0m
[33m
        cd per_gene/EOG091G0ZRG
	count=$(cat ../../per_gene/EOG091G0ZRG/ALICUT_EOG091G0ZRG.clustalo.fasta | grep ">" | wc -l)
	if [ "$count" -gt 5 ]
        then
		RAxMLmodel=$(cat ../../per_gene/EOG091G0ZRG/EOG091G0ZRG.best_model | grep "Best" | cut -d ":" -f 2 | tr -d '[:space:]')
                if [ "$(ls -1 | grep "^RAxML" | wc -l)" -ne 0 ]
		then
			rm RAxML*
		fi
        	raxml -f a -T 2 -m PROTGAMMA$RAxMLmodel         	-p 12345 -x 12345 -# 100         	-s ../../per_gene/EOG091G0ZRG/ALICUT_EOG091G0ZRG.clustalo.fasta -n EOG091G0ZRG.clustalo.aln.ALICUT.$RAxMLmodel 		1> ../../per_gene/EOG091G0ZRG/infer_single_ML.stdout.txt 2> ../../per_gene/EOG091G0ZRG/infer_single_ML.stderr.txt
	else
		echo "fasta file per_gene/EOG091G0ZRG/ALICUT_EOG091G0ZRG.clustalo.fasta contains fewer than 5 sequences - skipped" > ../../per_gene/EOG091G0ZRG/infer_single_ML.stdout.txt
		touch raxml.skipped
	fi
        touch ../../per_gene/EOG091G0ZRG/EOG091G0ZRG.raxml.done
        [0m
[Sun Jul  5 22:14:51 2020]
Finished job 364.
824 of 3292 steps (25%) done

[Sun Jul  5 22:14:51 2020]
rule get_seqs:
    input: /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ingroup.txt, /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/outgroup.txt
    output: per_gene/EOG091G04GW/EOG091G04GW.ingroup.fasta
    log: per_gene/EOG091G04GW/get_seqs.stdout.txt, per_gene/EOG091G04GW/get_seqs.stderr.txt
    jobid: 2526
    wildcards: BUSCO=EOG091G04GW
    threads: 2


	basedir=$(pwd)
        cd per_gene/EOG091G04GW
        
        bash $basedir/../scripts/fetch_seqs.sh EOG091G04GW /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ingroup.txt /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/outgroup.txt 1> ../../per_gene/EOG091G04GW/get_seqs.stdout.txt 2> ../../per_gene/EOG091G04GW/get_seqs.stderr.txt
	mv EOG091G04GW.fasta $basedir/per_gene/EOG091G04GW/EOG091G04GW.ingroup.fasta
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/72476f9d9a5bd0627b4d721143a21354.simg
[Sun Jul  5 22:15:02 2020]
Finished job 12.
825 of 3292 steps (25%) done

[Sun Jul  5 22:15:02 2020]
rule get_seqs:
    input: /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ingroup.txt, /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/outgroup.txt
    output: per_gene/EOG091G0977/EOG091G0977.ingroup.fasta
    log: per_gene/EOG091G0977/get_seqs.stdout.txt, per_gene/EOG091G0977/get_seqs.stderr.txt
    jobid: 2600
    wildcards: BUSCO=EOG091G0977
    threads: 2


	basedir=$(pwd)
        cd per_gene/EOG091G0977
        
        bash $basedir/../scripts/fetch_seqs.sh EOG091G0977 /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ingroup.txt /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/outgroup.txt 1> ../../per_gene/EOG091G0977/get_seqs.stdout.txt 2> ../../per_gene/EOG091G0977/get_seqs.stderr.txt
	mv EOG091G0977.fasta $basedir/per_gene/EOG091G0977/EOG091G0977.ingroup.fasta
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/72476f9d9a5bd0627b4d721143a21354.simg
[Sun Jul  5 22:15:05 2020]
Finished job 2526.
826 of 3292 steps (25%) done

[Sun Jul  5 22:15:05 2020]
rule get_outgroups:
    input: per_gene/EOG091G04GW/EOG091G04GW.ingroup.fasta
    output: per_gene/EOG091G04GW/EOG091G04GW.orthodb.fasta, per_gene/EOG091G04GW/EOG091G04GW.outgroup.fasta
    log: per_gene/EOG091G04GW/get_outgroups.stdout.txt, per_gene/EOG091G04GW/get_outgroups.stderr.txt
    jobid: 2527
    wildcards: BUSCO=EOG091G04GW


        #download fastas from Orhtodb for BUSCO id
        for i in {1..5}
        do
             wget "http://www.orthodb.org/fasta?query=EOG091G04GW&level=33208" -O per_gene/EOG091G04GW/EOG091G04GW.orthodb.fasta 1> per_gene/EOG091G04GW/get_outgroups.stdout.txt 2> per_gene/EOG091G04GW/get_outgroups.stderr.txt && break || echo -e "try again ($i)" && sleep 15
        done

	#This is quick an dirty for now and just takes the first protein if there is more than one for an outgroup taxon
        bash ../scripts/download_outgroups.sh taxids.txt per_gene/EOG091G04GW/EOG091G04GW.orthodb.fasta > per_gene/EOG091G04GW/EOG091G04GW.outgroup.fasta
        
[Sun Jul  5 22:15:06 2020]
Finished job 2527.
827 of 3292 steps (25%) done

[Sun Jul  5 22:15:06 2020]
rule join_groups:
    input: per_gene/EOG091G04GW/EOG091G04GW.ingroup.fasta, per_gene/EOG091G04GW/EOG091G04GW.outgroup.fasta
    output: per_gene/EOG091G04GW/EOG091G04GW.fasta
    jobid: 2087
    wildcards: BUSCO=EOG091G04GW


        cat per_gene/EOG091G04GW/EOG091G04GW.ingroup.fasta per_gene/EOG091G04GW/EOG091G04GW.outgroup.fasta > per_gene/EOG091G04GW/EOG091G04GW.fasta
        
[Sun Jul  5 22:15:07 2020]
Finished job 2087.
828 of 3292 steps (25%) done

[Sun Jul  5 22:15:07 2020]
rule MSA:
    input: per_gene/EOG091G04GW/EOG091G04GW.fasta
    output: per_gene/EOG091G04GW/EOG091G04GW.clustalo.fasta
    log: per_gene/EOG091G04GW/MSA.stdout.txt, per_gene/EOG091G04GW/MSA.stderr.txt
    jobid: 1294
    wildcards: BUSCO=EOG091G04GW
    threads: 2


        clustalo -i per_gene/EOG091G04GW/EOG091G04GW.fasta -o per_gene/EOG091G04GW/EOG091G04GW.clustalo.fasta --threads=2 1> per_gene/EOG091G04GW/MSA.stdout.txt 2> per_gene/EOG091G04GW/MSA.stderr.txt
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/d68c9691725a7401923680874285c430.simg
[Sun Jul  5 22:15:09 2020]
Finished job 1294.
829 of 3292 steps (25%) done

[Sun Jul  5 22:15:09 2020]
rule score_and_cut:
    input: per_gene/EOG091G04GW/EOG091G04GW.clustalo.fasta
    output: per_gene/EOG091G04GW/ALICUT_EOG091G04GW.clustalo.fasta
    jobid: 471
    wildcards: BUSCO=EOG091G04GW
    threads: 2


        cd per_gene/EOG091G04GW
        Aliscore.pl -N -r 200000000000000000 -i ../../per_gene/EOG091G04GW/EOG091G04GW.clustalo.fasta &> aliscore.log
        ALICUT.pl -s &> alicut.log
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/63c88c27a0fa300f57066b0ef65fefcb.simg
[Sun Jul  5 22:15:09 2020]
Finished job 542.
830 of 3292 steps (25%) done

[Sun Jul  5 22:15:09 2020]
rule infer_single_ML:
    input: per_gene/EOG091G08ZG/EOG091G08ZG.best_model, per_gene/EOG091G08ZG/ALICUT_EOG091G08ZG.clustalo.fasta
    output: per_gene/EOG091G08ZG/EOG091G08ZG.raxml.done
    log: per_gene/EOG091G08ZG/infer_single_ML.stdout.txt, per_gene/EOG091G08ZG/infer_single_ML.stderr.txt
    jobid: 65
    wildcards: BUSCO=EOG091G08ZG
    threads: 2


        cd per_gene/EOG091G08ZG
	count=$(cat ../../per_gene/EOG091G08ZG/ALICUT_EOG091G08ZG.clustalo.fasta | grep ">" | wc -l)
	if [ "$count" -gt 5 ]
        then
		RAxMLmodel=$(cat ../../per_gene/EOG091G08ZG/EOG091G08ZG.best_model | grep "Best" | cut -d ":" -f 2 | tr -d '[:space:]')
                if [ "$(ls -1 | grep "^RAxML" | wc -l)" -ne 0 ]
		then
			rm RAxML*
		fi
        	raxml -f a -T 2 -m PROTGAMMA$RAxMLmodel         	-p 12345 -x 12345 -# 100         	-s ../../per_gene/EOG091G08ZG/ALICUT_EOG091G08ZG.clustalo.fasta -n EOG091G08ZG.clustalo.aln.ALICUT.$RAxMLmodel 		1> ../../per_gene/EOG091G08ZG/infer_single_ML.stdout.txt 2> ../../per_gene/EOG091G08ZG/infer_single_ML.stderr.txt
	else
		echo "fasta file per_gene/EOG091G08ZG/ALICUT_EOG091G08ZG.clustalo.fasta contains fewer than 5 sequences - skipped" > ../../per_gene/EOG091G08ZG/infer_single_ML.stdout.txt
		touch raxml.skipped
	fi
        touch ../../per_gene/EOG091G08ZG/EOG091G08ZG.raxml.done
        
[33mJob counts:
	count	jobs
	1	infer_single_ML
	1[0m
[33m
        cd per_gene/EOG091G08ZG
	count=$(cat ../../per_gene/EOG091G08ZG/ALICUT_EOG091G08ZG.clustalo.fasta | grep ">" | wc -l)
	if [ "$count" -gt 5 ]
        then
		RAxMLmodel=$(cat ../../per_gene/EOG091G08ZG/EOG091G08ZG.best_model | grep "Best" | cut -d ":" -f 2 | tr -d '[:space:]')
                if [ "$(ls -1 | grep "^RAxML" | wc -l)" -ne 0 ]
		then
			rm RAxML*
		fi
        	raxml -f a -T 2 -m PROTGAMMA$RAxMLmodel         	-p 12345 -x 12345 -# 100         	-s ../../per_gene/EOG091G08ZG/ALICUT_EOG091G08ZG.clustalo.fasta -n EOG091G08ZG.clustalo.aln.ALICUT.$RAxMLmodel 		1> ../../per_gene/EOG091G08ZG/infer_single_ML.stdout.txt 2> ../../per_gene/EOG091G08ZG/infer_single_ML.stderr.txt
	else
		echo "fasta file per_gene/EOG091G08ZG/ALICUT_EOG091G08ZG.clustalo.fasta contains fewer than 5 sequences - skipped" > ../../per_gene/EOG091G08ZG/infer_single_ML.stdout.txt
		touch raxml.skipped
	fi
        touch ../../per_gene/EOG091G08ZG/EOG091G08ZG.raxml.done
        [0m
[Sun Jul  5 22:15:10 2020]
Finished job 113.
831 of 3292 steps (25%) done

[Sun Jul  5 22:15:10 2020]
rule get_seqs:
    input: /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ingroup.txt, /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/outgroup.txt
    output: per_gene/EOG091G0TSE/EOG091G0TSE.ingroup.fasta
    log: per_gene/EOG091G0TSE/get_seqs.stdout.txt, per_gene/EOG091G0TSE/get_seqs.stderr.txt
    jobid: 2856
    wildcards: BUSCO=EOG091G0TSE
    threads: 2


	basedir=$(pwd)
        cd per_gene/EOG091G0TSE
        
        bash $basedir/../scripts/fetch_seqs.sh EOG091G0TSE /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ingroup.txt /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/outgroup.txt 1> ../../per_gene/EOG091G0TSE/get_seqs.stdout.txt 2> ../../per_gene/EOG091G0TSE/get_seqs.stderr.txt
	mv EOG091G0TSE.fasta $basedir/per_gene/EOG091G0TSE/EOG091G0TSE.ingroup.fasta
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/72476f9d9a5bd0627b4d721143a21354.simg
[Sun Jul  5 22:15:14 2020]
Finished job 2600.
832 of 3292 steps (25%) done

[Sun Jul  5 22:15:14 2020]
rule get_outgroups:
    input: per_gene/EOG091G0977/EOG091G0977.ingroup.fasta
    output: per_gene/EOG091G0977/EOG091G0977.orthodb.fasta, per_gene/EOG091G0977/EOG091G0977.outgroup.fasta
    log: per_gene/EOG091G0977/get_outgroups.stdout.txt, per_gene/EOG091G0977/get_outgroups.stderr.txt
    jobid: 2601
    wildcards: BUSCO=EOG091G0977


        #download fastas from Orhtodb for BUSCO id
        for i in {1..5}
        do
             wget "http://www.orthodb.org/fasta?query=EOG091G0977&level=33208" -O per_gene/EOG091G0977/EOG091G0977.orthodb.fasta 1> per_gene/EOG091G0977/get_outgroups.stdout.txt 2> per_gene/EOG091G0977/get_outgroups.stderr.txt && break || echo -e "try again ($i)" && sleep 15
        done

	#This is quick an dirty for now and just takes the first protein if there is more than one for an outgroup taxon
        bash ../scripts/download_outgroups.sh taxids.txt per_gene/EOG091G0977/EOG091G0977.orthodb.fasta > per_gene/EOG091G0977/EOG091G0977.outgroup.fasta
        
[Sun Jul  5 22:15:15 2020]
Finished job 2601.
833 of 3292 steps (25%) done

[Sun Jul  5 22:15:15 2020]
rule join_groups:
    input: per_gene/EOG091G0977/EOG091G0977.ingroup.fasta, per_gene/EOG091G0977/EOG091G0977.outgroup.fasta
    output: per_gene/EOG091G0977/EOG091G0977.fasta
    jobid: 2124
    wildcards: BUSCO=EOG091G0977


        cat per_gene/EOG091G0977/EOG091G0977.ingroup.fasta per_gene/EOG091G0977/EOG091G0977.outgroup.fasta > per_gene/EOG091G0977/EOG091G0977.fasta
        
[Sun Jul  5 22:15:15 2020]
Finished job 2124.
834 of 3292 steps (25%) done

[Sun Jul  5 22:15:15 2020]
rule MSA:
    input: per_gene/EOG091G0977/EOG091G0977.fasta
    output: per_gene/EOG091G0977/EOG091G0977.clustalo.fasta
    log: per_gene/EOG091G0977/MSA.stdout.txt, per_gene/EOG091G0977/MSA.stderr.txt
    jobid: 1368
    wildcards: BUSCO=EOG091G0977
    threads: 2


        clustalo -i per_gene/EOG091G0977/EOG091G0977.fasta -o per_gene/EOG091G0977/EOG091G0977.clustalo.fasta --threads=2 1> per_gene/EOG091G0977/MSA.stdout.txt 2> per_gene/EOG091G0977/MSA.stderr.txt
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/d68c9691725a7401923680874285c430.simg
[Sun Jul  5 22:15:16 2020]
Finished job 1368.
835 of 3292 steps (25%) done

[Sun Jul  5 22:15:16 2020]
rule score_and_cut:
    input: per_gene/EOG091G0977/EOG091G0977.clustalo.fasta
    output: per_gene/EOG091G0977/ALICUT_EOG091G0977.clustalo.fasta
    jobid: 545
    wildcards: BUSCO=EOG091G0977
    threads: 2


        cd per_gene/EOG091G0977
        Aliscore.pl -N -r 200000000000000000 -i ../../per_gene/EOG091G0977/EOG091G0977.clustalo.fasta &> aliscore.log
        ALICUT.pl -s &> alicut.log
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/63c88c27a0fa300f57066b0ef65fefcb.simg
[Sun Jul  5 22:15:19 2020]
Finished job 471.
836 of 3292 steps (25%) done

[Sun Jul  5 22:15:19 2020]
rule remove_empty:
    input: per_gene/EOG091G04GW/ALICUT_EOG091G04GW.clustalo.fasta
    output: per_gene/EOG091G04GW/empty_check.done
    jobid: 1293
    wildcards: BUSCO=EOG091G04GW


         if [ "$(cat per_gene/EOG091G04GW/ALICUT_EOG091G04GW.clustalo.fasta | grep -v ">" | sed 's/-//g' | grep "^$" | wc -l)" -gt 0 ]
         then
              cp per_gene/EOG091G04GW/ALICUT_EOG091G04GW.clustalo.fasta per_gene/EOG091G04GW/ALICUT_EOG091G04GW.clustalo.fasta.backup
              bash ../scripts/remove_empty.sh per_gene/EOG091G04GW/ALICUT_EOG091G04GW.clustalo.fasta.backup > per_gene/EOG091G04GW/ALICUT_EOG091G04GW.clustalo.fasta
         fi
         touch per_gene/EOG091G04GW/empty_check.done
         
[Sun Jul  5 22:15:19 2020]
Finished job 1293.
837 of 3292 steps (25%) done

[Sun Jul  5 22:15:19 2020]
rule find_best_model:
    input: per_gene/EOG091G04GW/ALICUT_EOG091G04GW.clustalo.fasta, per_gene/EOG091G04GW/empty_check.done
    output: per_gene/EOG091G04GW/EOG091G04GW.best_model
    log: per_gene/EOG091G04GW/find_best_model.stderr.txt
    jobid: 470
    wildcards: BUSCO=EOG091G04GW
    threads: 2


        cd per_gene/EOG091G04GW
        if [ ! -d find_best_model ]
        then
            mkdir find_best_model
        fi
        cd find_best_model
        ln -s ../../../per_gene/EOG091G04GW/ALICUT_EOG091G04GW.clustalo.fasta EOG091G04GW.fasta
        ProteinModelSelection.pl EOG091G04GW.fasta 1> ../../../per_gene/EOG091G04GW/EOG091G04GW.best_model 2> ../../../per_gene/EOG091G04GW/find_best_model.stderr.txt
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/c0c09ee657b1e27f2c5687e0e9aa8d70.simg
[Sun Jul  5 22:15:21 2020]
Finished job 2856.
838 of 3292 steps (25%) done

[Sun Jul  5 22:15:21 2020]
rule get_outgroups:
    input: per_gene/EOG091G0TSE/EOG091G0TSE.ingroup.fasta
    output: per_gene/EOG091G0TSE/EOG091G0TSE.orthodb.fasta, per_gene/EOG091G0TSE/EOG091G0TSE.outgroup.fasta
    log: per_gene/EOG091G0TSE/get_outgroups.stdout.txt, per_gene/EOG091G0TSE/get_outgroups.stderr.txt
    jobid: 2857
    wildcards: BUSCO=EOG091G0TSE


        #download fastas from Orhtodb for BUSCO id
        for i in {1..5}
        do
             wget "http://www.orthodb.org/fasta?query=EOG091G0TSE&level=33208" -O per_gene/EOG091G0TSE/EOG091G0TSE.orthodb.fasta 1> per_gene/EOG091G0TSE/get_outgroups.stdout.txt 2> per_gene/EOG091G0TSE/get_outgroups.stderr.txt && break || echo -e "try again ($i)" && sleep 15
        done

	#This is quick an dirty for now and just takes the first protein if there is more than one for an outgroup taxon
        bash ../scripts/download_outgroups.sh taxids.txt per_gene/EOG091G0TSE/EOG091G0TSE.orthodb.fasta > per_gene/EOG091G0TSE/EOG091G0TSE.outgroup.fasta
        
[Sun Jul  5 22:15:22 2020]
Finished job 2857.
839 of 3292 steps (25%) done

[Sun Jul  5 22:15:22 2020]
rule join_groups:
    input: per_gene/EOG091G0TSE/EOG091G0TSE.ingroup.fasta, per_gene/EOG091G0TSE/EOG091G0TSE.outgroup.fasta
    output: per_gene/EOG091G0TSE/EOG091G0TSE.fasta
    jobid: 2252
    wildcards: BUSCO=EOG091G0TSE


        cat per_gene/EOG091G0TSE/EOG091G0TSE.ingroup.fasta per_gene/EOG091G0TSE/EOG091G0TSE.outgroup.fasta > per_gene/EOG091G0TSE/EOG091G0TSE.fasta
        
[Sun Jul  5 22:15:22 2020]
Finished job 2252.
840 of 3292 steps (26%) done

[Sun Jul  5 22:15:22 2020]
rule MSA:
    input: per_gene/EOG091G0TSE/EOG091G0TSE.fasta
    output: per_gene/EOG091G0TSE/EOG091G0TSE.clustalo.fasta
    log: per_gene/EOG091G0TSE/MSA.stdout.txt, per_gene/EOG091G0TSE/MSA.stderr.txt
    jobid: 1624
    wildcards: BUSCO=EOG091G0TSE
    threads: 2


        clustalo -i per_gene/EOG091G0TSE/EOG091G0TSE.fasta -o per_gene/EOG091G0TSE/EOG091G0TSE.clustalo.fasta --threads=2 1> per_gene/EOG091G0TSE/MSA.stdout.txt 2> per_gene/EOG091G0TSE/MSA.stderr.txt
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/d68c9691725a7401923680874285c430.simg
[Sun Jul  5 22:15:23 2020]
Finished job 1624.
841 of 3292 steps (26%) done

[Sun Jul  5 22:15:23 2020]
rule score_and_cut:
    input: per_gene/EOG091G0TSE/EOG091G0TSE.clustalo.fasta
    output: per_gene/EOG091G0TSE/ALICUT_EOG091G0TSE.clustalo.fasta
    jobid: 801
    wildcards: BUSCO=EOG091G0TSE
    threads: 2


        cd per_gene/EOG091G0TSE
        Aliscore.pl -N -r 200000000000000000 -i ../../per_gene/EOG091G0TSE/EOG091G0TSE.clustalo.fasta &> aliscore.log
        ALICUT.pl -s &> alicut.log
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/63c88c27a0fa300f57066b0ef65fefcb.simg
[Sun Jul  5 22:15:26 2020]
Finished job 545.
842 of 3292 steps (26%) done

[Sun Jul  5 22:15:26 2020]
rule remove_empty:
    input: per_gene/EOG091G0977/ALICUT_EOG091G0977.clustalo.fasta
    output: per_gene/EOG091G0977/empty_check.done
    jobid: 1367
    wildcards: BUSCO=EOG091G0977


         if [ "$(cat per_gene/EOG091G0977/ALICUT_EOG091G0977.clustalo.fasta | grep -v ">" | sed 's/-//g' | grep "^$" | wc -l)" -gt 0 ]
         then
              cp per_gene/EOG091G0977/ALICUT_EOG091G0977.clustalo.fasta per_gene/EOG091G0977/ALICUT_EOG091G0977.clustalo.fasta.backup
              bash ../scripts/remove_empty.sh per_gene/EOG091G0977/ALICUT_EOG091G0977.clustalo.fasta.backup > per_gene/EOG091G0977/ALICUT_EOG091G0977.clustalo.fasta
         fi
         touch per_gene/EOG091G0977/empty_check.done
         
[Sun Jul  5 22:15:26 2020]
Finished job 1367.
843 of 3292 steps (26%) done

[Sun Jul  5 22:15:26 2020]
rule find_best_model:
    input: per_gene/EOG091G0977/ALICUT_EOG091G0977.clustalo.fasta, per_gene/EOG091G0977/empty_check.done
    output: per_gene/EOG091G0977/EOG091G0977.best_model
    log: per_gene/EOG091G0977/find_best_model.stderr.txt
    jobid: 544
    wildcards: BUSCO=EOG091G0977
    threads: 2


        cd per_gene/EOG091G0977
        if [ ! -d find_best_model ]
        then
            mkdir find_best_model
        fi
        cd find_best_model
        ln -s ../../../per_gene/EOG091G0977/ALICUT_EOG091G0977.clustalo.fasta EOG091G0977.fasta
        ProteinModelSelection.pl EOG091G0977.fasta 1> ../../../per_gene/EOG091G0977/EOG091G0977.best_model 2> ../../../per_gene/EOG091G0977/find_best_model.stderr.txt
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/c0c09ee657b1e27f2c5687e0e9aa8d70.simg
[Sun Jul  5 22:15:32 2020]
Finished job 801.
844 of 3292 steps (26%) done

[Sun Jul  5 22:15:32 2020]
rule remove_empty:
    input: per_gene/EOG091G0TSE/ALICUT_EOG091G0TSE.clustalo.fasta
    output: per_gene/EOG091G0TSE/empty_check.done
    jobid: 1623
    wildcards: BUSCO=EOG091G0TSE


         if [ "$(cat per_gene/EOG091G0TSE/ALICUT_EOG091G0TSE.clustalo.fasta | grep -v ">" | sed 's/-//g' | grep "^$" | wc -l)" -gt 0 ]
         then
              cp per_gene/EOG091G0TSE/ALICUT_EOG091G0TSE.clustalo.fasta per_gene/EOG091G0TSE/ALICUT_EOG091G0TSE.clustalo.fasta.backup
              bash ../scripts/remove_empty.sh per_gene/EOG091G0TSE/ALICUT_EOG091G0TSE.clustalo.fasta.backup > per_gene/EOG091G0TSE/ALICUT_EOG091G0TSE.clustalo.fasta
         fi
         touch per_gene/EOG091G0TSE/empty_check.done
         
[Sun Jul  5 22:15:32 2020]
Finished job 1623.
845 of 3292 steps (26%) done

[Sun Jul  5 22:15:32 2020]
rule find_best_model:
    input: per_gene/EOG091G0TSE/ALICUT_EOG091G0TSE.clustalo.fasta, per_gene/EOG091G0TSE/empty_check.done
    output: per_gene/EOG091G0TSE/EOG091G0TSE.best_model
    log: per_gene/EOG091G0TSE/find_best_model.stderr.txt
    jobid: 800
    wildcards: BUSCO=EOG091G0TSE
    threads: 2


        cd per_gene/EOG091G0TSE
        if [ ! -d find_best_model ]
        then
            mkdir find_best_model
        fi
        cd find_best_model
        ln -s ../../../per_gene/EOG091G0TSE/ALICUT_EOG091G0TSE.clustalo.fasta EOG091G0TSE.fasta
        ProteinModelSelection.pl EOG091G0TSE.fasta 1> ../../../per_gene/EOG091G0TSE/EOG091G0TSE.best_model 2> ../../../per_gene/EOG091G0TSE/find_best_model.stderr.txt
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/c0c09ee657b1e27f2c5687e0e9aa8d70.simg
[Sun Jul  5 22:16:05 2020]
Finished job 269.
846 of 3292 steps (26%) done

[Sun Jul  5 22:16:06 2020]
rule get_seqs:
    input: /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ingroup.txt, /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/outgroup.txt
    output: per_gene/EOG091G0YHX/EOG091G0YHX.ingroup.fasta
    log: per_gene/EOG091G0YHX/get_seqs.stdout.txt, per_gene/EOG091G0YHX/get_seqs.stderr.txt
    jobid: 3288
    wildcards: BUSCO=EOG091G0YHX
    threads: 2


	basedir=$(pwd)
        cd per_gene/EOG091G0YHX
        
        bash $basedir/../scripts/fetch_seqs.sh EOG091G0YHX /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ingroup.txt /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/outgroup.txt 1> ../../per_gene/EOG091G0YHX/get_seqs.stdout.txt 2> ../../per_gene/EOG091G0YHX/get_seqs.stderr.txt
	mv EOG091G0YHX.fasta $basedir/per_gene/EOG091G0YHX/EOG091G0YHX.ingroup.fasta
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/72476f9d9a5bd0627b4d721143a21354.simg
[Sun Jul  5 22:16:06 2020]
Finished job 209.
847 of 3292 steps (26%) done

[Sun Jul  5 22:16:06 2020]
rule get_seqs:
    input: /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ingroup.txt, /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/outgroup.txt
    output: per_gene/EOG091G0DVQ/EOG091G0DVQ.ingroup.fasta
    log: per_gene/EOG091G0DVQ/get_seqs.stdout.txt, per_gene/EOG091G0DVQ/get_seqs.stderr.txt
    jobid: 2660
    wildcards: BUSCO=EOG091G0DVQ
    threads: 2


	basedir=$(pwd)
        cd per_gene/EOG091G0DVQ
        
        bash $basedir/../scripts/fetch_seqs.sh EOG091G0DVQ /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ingroup.txt /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/outgroup.txt 1> ../../per_gene/EOG091G0DVQ/get_seqs.stdout.txt 2> ../../per_gene/EOG091G0DVQ/get_seqs.stderr.txt
	mv EOG091G0DVQ.fasta $basedir/per_gene/EOG091G0DVQ/EOG091G0DVQ.ingroup.fasta
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/72476f9d9a5bd0627b4d721143a21354.simg
[Sun Jul  5 22:16:08 2020]
Finished job 396.
848 of 3292 steps (26%) done

[Sun Jul  5 22:16:08 2020]
rule get_seqs:
    input: /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ingroup.txt, /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/outgroup.txt
    output: per_gene/EOG091G0NKD/EOG091G0NKD.ingroup.fasta
    log: per_gene/EOG091G0NKD/get_seqs.stdout.txt, per_gene/EOG091G0NKD/get_seqs.stderr.txt
    jobid: 2786
    wildcards: BUSCO=EOG091G0NKD
    threads: 2


	basedir=$(pwd)
        cd per_gene/EOG091G0NKD
        
        bash $basedir/../scripts/fetch_seqs.sh EOG091G0NKD /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ingroup.txt /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/outgroup.txt 1> ../../per_gene/EOG091G0NKD/get_seqs.stdout.txt 2> ../../per_gene/EOG091G0NKD/get_seqs.stderr.txt
	mv EOG091G0NKD.fasta $basedir/per_gene/EOG091G0NKD/EOG091G0NKD.ingroup.fasta
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/72476f9d9a5bd0627b4d721143a21354.simg
[Sun Jul  5 22:16:15 2020]
Finished job 800.
849 of 3292 steps (26%) done

[Sun Jul  5 22:16:15 2020]
rule infer_single_ML:
    input: per_gene/EOG091G0TSE/EOG091G0TSE.best_model, per_gene/EOG091G0TSE/ALICUT_EOG091G0TSE.clustalo.fasta
    output: per_gene/EOG091G0TSE/EOG091G0TSE.raxml.done
    log: per_gene/EOG091G0TSE/infer_single_ML.stdout.txt, per_gene/EOG091G0TSE/infer_single_ML.stderr.txt
    jobid: 194
    wildcards: BUSCO=EOG091G0TSE
    threads: 2


        cd per_gene/EOG091G0TSE
	count=$(cat ../../per_gene/EOG091G0TSE/ALICUT_EOG091G0TSE.clustalo.fasta | grep ">" | wc -l)
	if [ "$count" -gt 5 ]
        then
		RAxMLmodel=$(cat ../../per_gene/EOG091G0TSE/EOG091G0TSE.best_model | grep "Best" | cut -d ":" -f 2 | tr -d '[:space:]')
                if [ "$(ls -1 | grep "^RAxML" | wc -l)" -ne 0 ]
		then
			rm RAxML*
		fi
        	raxml -f a -T 2 -m PROTGAMMA$RAxMLmodel         	-p 12345 -x 12345 -# 100         	-s ../../per_gene/EOG091G0TSE/ALICUT_EOG091G0TSE.clustalo.fasta -n EOG091G0TSE.clustalo.aln.ALICUT.$RAxMLmodel 		1> ../../per_gene/EOG091G0TSE/infer_single_ML.stdout.txt 2> ../../per_gene/EOG091G0TSE/infer_single_ML.stderr.txt
	else
		echo "fasta file per_gene/EOG091G0TSE/ALICUT_EOG091G0TSE.clustalo.fasta contains fewer than 5 sequences - skipped" > ../../per_gene/EOG091G0TSE/infer_single_ML.stdout.txt
		touch raxml.skipped
	fi
        touch ../../per_gene/EOG091G0TSE/EOG091G0TSE.raxml.done
        
[33mJob counts:
	count	jobs
	1	infer_single_ML
	1[0m
[33m
        cd per_gene/EOG091G0TSE
	count=$(cat ../../per_gene/EOG091G0TSE/ALICUT_EOG091G0TSE.clustalo.fasta | grep ">" | wc -l)
	if [ "$count" -gt 5 ]
        then
		RAxMLmodel=$(cat ../../per_gene/EOG091G0TSE/EOG091G0TSE.best_model | grep "Best" | cut -d ":" -f 2 | tr -d '[:space:]')
                if [ "$(ls -1 | grep "^RAxML" | wc -l)" -ne 0 ]
		then
			rm RAxML*
		fi
        	raxml -f a -T 2 -m PROTGAMMA$RAxMLmodel         	-p 12345 -x 12345 -# 100         	-s ../../per_gene/EOG091G0TSE/ALICUT_EOG091G0TSE.clustalo.fasta -n EOG091G0TSE.clustalo.aln.ALICUT.$RAxMLmodel 		1> ../../per_gene/EOG091G0TSE/infer_single_ML.stdout.txt 2> ../../per_gene/EOG091G0TSE/infer_single_ML.stderr.txt
	else
		echo "fasta file per_gene/EOG091G0TSE/ALICUT_EOG091G0TSE.clustalo.fasta contains fewer than 5 sequences - skipped" > ../../per_gene/EOG091G0TSE/infer_single_ML.stdout.txt
		touch raxml.skipped
	fi
        touch ../../per_gene/EOG091G0TSE/EOG091G0TSE.raxml.done
        [0m
[Sun Jul  5 22:16:17 2020]
Finished job 470.
850 of 3292 steps (26%) done

[Sun Jul  5 22:16:17 2020]
rule infer_single_ML:
    input: per_gene/EOG091G04GW/EOG091G04GW.best_model, per_gene/EOG091G04GW/ALICUT_EOG091G04GW.clustalo.fasta
    output: per_gene/EOG091G04GW/EOG091G04GW.raxml.done
    log: per_gene/EOG091G04GW/infer_single_ML.stdout.txt, per_gene/EOG091G04GW/infer_single_ML.stderr.txt
    jobid: 29
    wildcards: BUSCO=EOG091G04GW
    threads: 2


        cd per_gene/EOG091G04GW
	count=$(cat ../../per_gene/EOG091G04GW/ALICUT_EOG091G04GW.clustalo.fasta | grep ">" | wc -l)
	if [ "$count" -gt 5 ]
        then
		RAxMLmodel=$(cat ../../per_gene/EOG091G04GW/EOG091G04GW.best_model | grep "Best" | cut -d ":" -f 2 | tr -d '[:space:]')
                if [ "$(ls -1 | grep "^RAxML" | wc -l)" -ne 0 ]
		then
			rm RAxML*
		fi
        	raxml -f a -T 2 -m PROTGAMMA$RAxMLmodel         	-p 12345 -x 12345 -# 100         	-s ../../per_gene/EOG091G04GW/ALICUT_EOG091G04GW.clustalo.fasta -n EOG091G04GW.clustalo.aln.ALICUT.$RAxMLmodel 		1> ../../per_gene/EOG091G04GW/infer_single_ML.stdout.txt 2> ../../per_gene/EOG091G04GW/infer_single_ML.stderr.txt
	else
		echo "fasta file per_gene/EOG091G04GW/ALICUT_EOG091G04GW.clustalo.fasta contains fewer than 5 sequences - skipped" > ../../per_gene/EOG091G04GW/infer_single_ML.stdout.txt
		touch raxml.skipped
	fi
        touch ../../per_gene/EOG091G04GW/EOG091G04GW.raxml.done
        
[33mJob counts:
	count	jobs
	1	infer_single_ML
	1[0m
[33m
        cd per_gene/EOG091G04GW
	count=$(cat ../../per_gene/EOG091G04GW/ALICUT_EOG091G04GW.clustalo.fasta | grep ">" | wc -l)
	if [ "$count" -gt 5 ]
        then
		RAxMLmodel=$(cat ../../per_gene/EOG091G04GW/EOG091G04GW.best_model | grep "Best" | cut -d ":" -f 2 | tr -d '[:space:]')
                if [ "$(ls -1 | grep "^RAxML" | wc -l)" -ne 0 ]
		then
			rm RAxML*
		fi
        	raxml -f a -T 2 -m PROTGAMMA$RAxMLmodel         	-p 12345 -x 12345 -# 100         	-s ../../per_gene/EOG091G04GW/ALICUT_EOG091G04GW.clustalo.fasta -n EOG091G04GW.clustalo.aln.ALICUT.$RAxMLmodel 		1> ../../per_gene/EOG091G04GW/infer_single_ML.stdout.txt 2> ../../per_gene/EOG091G04GW/infer_single_ML.stderr.txt
	else
		echo "fasta file per_gene/EOG091G04GW/ALICUT_EOG091G04GW.clustalo.fasta contains fewer than 5 sequences - skipped" > ../../per_gene/EOG091G04GW/infer_single_ML.stdout.txt
		touch raxml.skipped
	fi
        touch ../../per_gene/EOG091G04GW/EOG091G04GW.raxml.done
        [0m
[Sun Jul  5 22:16:19 2020]
Finished job 3288.
851 of 3292 steps (26%) done

[Sun Jul  5 22:16:19 2020]
rule get_outgroups:
    input: per_gene/EOG091G0YHX/EOG091G0YHX.ingroup.fasta
    output: per_gene/EOG091G0YHX/EOG091G0YHX.orthodb.fasta, per_gene/EOG091G0YHX/EOG091G0YHX.outgroup.fasta
    log: per_gene/EOG091G0YHX/get_outgroups.stdout.txt, per_gene/EOG091G0YHX/get_outgroups.stderr.txt
    jobid: 3289
    wildcards: BUSCO=EOG091G0YHX


        #download fastas from Orhtodb for BUSCO id
        for i in {1..5}
        do
             wget "http://www.orthodb.org/fasta?query=EOG091G0YHX&level=33208" -O per_gene/EOG091G0YHX/EOG091G0YHX.orthodb.fasta 1> per_gene/EOG091G0YHX/get_outgroups.stdout.txt 2> per_gene/EOG091G0YHX/get_outgroups.stderr.txt && break || echo -e "try again ($i)" && sleep 15
        done

	#This is quick an dirty for now and just takes the first protein if there is more than one for an outgroup taxon
        bash ../scripts/download_outgroups.sh taxids.txt per_gene/EOG091G0YHX/EOG091G0YHX.orthodb.fasta > per_gene/EOG091G0YHX/EOG091G0YHX.outgroup.fasta
        
[Sun Jul  5 22:16:20 2020]
Finished job 3289.
852 of 3292 steps (26%) done

[Sun Jul  5 22:16:20 2020]
rule join_groups:
    input: per_gene/EOG091G0YHX/EOG091G0YHX.ingroup.fasta, per_gene/EOG091G0YHX/EOG091G0YHX.outgroup.fasta
    output: per_gene/EOG091G0YHX/EOG091G0YHX.fasta
    jobid: 2468
    wildcards: BUSCO=EOG091G0YHX


        cat per_gene/EOG091G0YHX/EOG091G0YHX.ingroup.fasta per_gene/EOG091G0YHX/EOG091G0YHX.outgroup.fasta > per_gene/EOG091G0YHX/EOG091G0YHX.fasta
        
[Sun Jul  5 22:16:20 2020]
Finished job 2468.
853 of 3292 steps (26%) done

[Sun Jul  5 22:16:20 2020]
rule MSA:
    input: per_gene/EOG091G0YHX/EOG091G0YHX.fasta
    output: per_gene/EOG091G0YHX/EOG091G0YHX.clustalo.fasta
    log: per_gene/EOG091G0YHX/MSA.stdout.txt, per_gene/EOG091G0YHX/MSA.stderr.txt
    jobid: 2056
    wildcards: BUSCO=EOG091G0YHX
    threads: 2


        clustalo -i per_gene/EOG091G0YHX/EOG091G0YHX.fasta -o per_gene/EOG091G0YHX/EOG091G0YHX.clustalo.fasta --threads=2 1> per_gene/EOG091G0YHX/MSA.stdout.txt 2> per_gene/EOG091G0YHX/MSA.stderr.txt
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/d68c9691725a7401923680874285c430.simg
[Sun Jul  5 22:16:20 2020]
Finished job 2660.
854 of 3292 steps (26%) done

[Sun Jul  5 22:16:20 2020]
rule get_outgroups:
    input: per_gene/EOG091G0DVQ/EOG091G0DVQ.ingroup.fasta
    output: per_gene/EOG091G0DVQ/EOG091G0DVQ.orthodb.fasta, per_gene/EOG091G0DVQ/EOG091G0DVQ.outgroup.fasta
    log: per_gene/EOG091G0DVQ/get_outgroups.stdout.txt, per_gene/EOG091G0DVQ/get_outgroups.stderr.txt
    jobid: 2661
    wildcards: BUSCO=EOG091G0DVQ


        #download fastas from Orhtodb for BUSCO id
        for i in {1..5}
        do
             wget "http://www.orthodb.org/fasta?query=EOG091G0DVQ&level=33208" -O per_gene/EOG091G0DVQ/EOG091G0DVQ.orthodb.fasta 1> per_gene/EOG091G0DVQ/get_outgroups.stdout.txt 2> per_gene/EOG091G0DVQ/get_outgroups.stderr.txt && break || echo -e "try again ($i)" && sleep 15
        done

	#This is quick an dirty for now and just takes the first protein if there is more than one for an outgroup taxon
        bash ../scripts/download_outgroups.sh taxids.txt per_gene/EOG091G0DVQ/EOG091G0DVQ.orthodb.fasta > per_gene/EOG091G0DVQ/EOG091G0DVQ.outgroup.fasta
        
[Sun Jul  5 22:16:21 2020]
Finished job 2056.
855 of 3292 steps (26%) done

[Sun Jul  5 22:16:21 2020]
rule score_and_cut:
    input: per_gene/EOG091G0YHX/EOG091G0YHX.clustalo.fasta
    output: per_gene/EOG091G0YHX/ALICUT_EOG091G0YHX.clustalo.fasta
    jobid: 1233
    wildcards: BUSCO=EOG091G0YHX
    threads: 2


        cd per_gene/EOG091G0YHX
        Aliscore.pl -N -r 200000000000000000 -i ../../per_gene/EOG091G0YHX/EOG091G0YHX.clustalo.fasta &> aliscore.log
        ALICUT.pl -s &> alicut.log
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/63c88c27a0fa300f57066b0ef65fefcb.simg
[Sun Jul  5 22:16:22 2020]
Finished job 2661.
856 of 3292 steps (26%) done

[Sun Jul  5 22:16:22 2020]
rule join_groups:
    input: per_gene/EOG091G0DVQ/EOG091G0DVQ.ingroup.fasta, per_gene/EOG091G0DVQ/EOG091G0DVQ.outgroup.fasta
    output: per_gene/EOG091G0DVQ/EOG091G0DVQ.fasta
    jobid: 2154
    wildcards: BUSCO=EOG091G0DVQ


        cat per_gene/EOG091G0DVQ/EOG091G0DVQ.ingroup.fasta per_gene/EOG091G0DVQ/EOG091G0DVQ.outgroup.fasta > per_gene/EOG091G0DVQ/EOG091G0DVQ.fasta
        
[Sun Jul  5 22:16:22 2020]
Finished job 2154.
857 of 3292 steps (26%) done

[Sun Jul  5 22:16:22 2020]
rule MSA:
    input: per_gene/EOG091G0DVQ/EOG091G0DVQ.fasta
    output: per_gene/EOG091G0DVQ/EOG091G0DVQ.clustalo.fasta
    log: per_gene/EOG091G0DVQ/MSA.stdout.txt, per_gene/EOG091G0DVQ/MSA.stderr.txt
    jobid: 1428
    wildcards: BUSCO=EOG091G0DVQ
    threads: 2


        clustalo -i per_gene/EOG091G0DVQ/EOG091G0DVQ.fasta -o per_gene/EOG091G0DVQ/EOG091G0DVQ.clustalo.fasta --threads=2 1> per_gene/EOG091G0DVQ/MSA.stdout.txt 2> per_gene/EOG091G0DVQ/MSA.stderr.txt
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/d68c9691725a7401923680874285c430.simg
[Sun Jul  5 22:16:22 2020]
Finished job 2786.
858 of 3292 steps (26%) done

[Sun Jul  5 22:16:22 2020]
rule get_outgroups:
    input: per_gene/EOG091G0NKD/EOG091G0NKD.ingroup.fasta
    output: per_gene/EOG091G0NKD/EOG091G0NKD.orthodb.fasta, per_gene/EOG091G0NKD/EOG091G0NKD.outgroup.fasta
    log: per_gene/EOG091G0NKD/get_outgroups.stdout.txt, per_gene/EOG091G0NKD/get_outgroups.stderr.txt
    jobid: 2787
    wildcards: BUSCO=EOG091G0NKD


        #download fastas from Orhtodb for BUSCO id
        for i in {1..5}
        do
             wget "http://www.orthodb.org/fasta?query=EOG091G0NKD&level=33208" -O per_gene/EOG091G0NKD/EOG091G0NKD.orthodb.fasta 1> per_gene/EOG091G0NKD/get_outgroups.stdout.txt 2> per_gene/EOG091G0NKD/get_outgroups.stderr.txt && break || echo -e "try again ($i)" && sleep 15
        done

	#This is quick an dirty for now and just takes the first protein if there is more than one for an outgroup taxon
        bash ../scripts/download_outgroups.sh taxids.txt per_gene/EOG091G0NKD/EOG091G0NKD.orthodb.fasta > per_gene/EOG091G0NKD/EOG091G0NKD.outgroup.fasta
        
[Sun Jul  5 22:16:23 2020]
Finished job 1428.
859 of 3292 steps (26%) done
[Sun Jul  5 22:16:23 2020]
Finished job 2787.
860 of 3292 steps (26%) done
[Sun Jul  5 22:16:23 2020]
Finished job 544.
861 of 3292 steps (26%) done

[Sun Jul  5 22:16:23 2020]
rule get_seqs:
    input: /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ingroup.txt, /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/outgroup.txt
    output: per_gene/EOG091G06MR/EOG091G06MR.ingroup.fasta
    log: per_gene/EOG091G06MR/get_seqs.stdout.txt, per_gene/EOG091G06MR/get_seqs.stderr.txt
    jobid: 3148
    wildcards: BUSCO=EOG091G06MR
    threads: 2


	basedir=$(pwd)
        cd per_gene/EOG091G06MR
        
        bash $basedir/../scripts/fetch_seqs.sh EOG091G06MR /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ingroup.txt /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/outgroup.txt 1> ../../per_gene/EOG091G06MR/get_seqs.stdout.txt 2> ../../per_gene/EOG091G06MR/get_seqs.stderr.txt
	mv EOG091G06MR.fasta $basedir/per_gene/EOG091G06MR/EOG091G06MR.ingroup.fasta
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/72476f9d9a5bd0627b4d721143a21354.simg

[Sun Jul  5 22:16:23 2020]
rule score_and_cut:
    input: per_gene/EOG091G0DVQ/EOG091G0DVQ.clustalo.fasta
    output: per_gene/EOG091G0DVQ/ALICUT_EOG091G0DVQ.clustalo.fasta
    jobid: 605
    wildcards: BUSCO=EOG091G0DVQ
    threads: 2


        cd per_gene/EOG091G0DVQ
        Aliscore.pl -N -r 200000000000000000 -i ../../per_gene/EOG091G0DVQ/EOG091G0DVQ.clustalo.fasta &> aliscore.log
        ALICUT.pl -s &> alicut.log
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/63c88c27a0fa300f57066b0ef65fefcb.simg

[Sun Jul  5 22:16:23 2020]
rule join_groups:
    input: per_gene/EOG091G0NKD/EOG091G0NKD.ingroup.fasta, per_gene/EOG091G0NKD/EOG091G0NKD.outgroup.fasta
    output: per_gene/EOG091G0NKD/EOG091G0NKD.fasta
    jobid: 2217
    wildcards: BUSCO=EOG091G0NKD


        cat per_gene/EOG091G0NKD/EOG091G0NKD.ingroup.fasta per_gene/EOG091G0NKD/EOG091G0NKD.outgroup.fasta > per_gene/EOG091G0NKD/EOG091G0NKD.fasta
        
[Sun Jul  5 22:16:23 2020]
Finished job 2217.
862 of 3292 steps (26%) done

[Sun Jul  5 22:16:23 2020]
rule MSA:
    input: per_gene/EOG091G0NKD/EOG091G0NKD.fasta
    output: per_gene/EOG091G0NKD/EOG091G0NKD.clustalo.fasta
    log: per_gene/EOG091G0NKD/MSA.stdout.txt, per_gene/EOG091G0NKD/MSA.stderr.txt
    jobid: 1554
    wildcards: BUSCO=EOG091G0NKD
    threads: 2


        clustalo -i per_gene/EOG091G0NKD/EOG091G0NKD.fasta -o per_gene/EOG091G0NKD/EOG091G0NKD.clustalo.fasta --threads=2 1> per_gene/EOG091G0NKD/MSA.stdout.txt 2> per_gene/EOG091G0NKD/MSA.stderr.txt
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/d68c9691725a7401923680874285c430.simg
[Sun Jul  5 22:16:25 2020]
Finished job 1554.
863 of 3292 steps (26%) done

[Sun Jul  5 22:16:25 2020]
rule score_and_cut:
    input: per_gene/EOG091G0NKD/EOG091G0NKD.clustalo.fasta
    output: per_gene/EOG091G0NKD/ALICUT_EOG091G0NKD.clustalo.fasta
    jobid: 731
    wildcards: BUSCO=EOG091G0NKD
    threads: 2


        cd per_gene/EOG091G0NKD
        Aliscore.pl -N -r 200000000000000000 -i ../../per_gene/EOG091G0NKD/EOG091G0NKD.clustalo.fasta &> aliscore.log
        ALICUT.pl -s &> alicut.log
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/63c88c27a0fa300f57066b0ef65fefcb.simg
[Sun Jul  5 22:16:31 2020]
Finished job 1233.
864 of 3292 steps (26%) done

[Sun Jul  5 22:16:31 2020]
rule infer_single_ML:
    input: per_gene/EOG091G0977/EOG091G0977.best_model, per_gene/EOG091G0977/ALICUT_EOG091G0977.clustalo.fasta
    output: per_gene/EOG091G0977/EOG091G0977.raxml.done
    log: per_gene/EOG091G0977/infer_single_ML.stdout.txt, per_gene/EOG091G0977/infer_single_ML.stderr.txt
    jobid: 66
    wildcards: BUSCO=EOG091G0977
    threads: 2


        cd per_gene/EOG091G0977
	count=$(cat ../../per_gene/EOG091G0977/ALICUT_EOG091G0977.clustalo.fasta | grep ">" | wc -l)
	if [ "$count" -gt 5 ]
        then
		RAxMLmodel=$(cat ../../per_gene/EOG091G0977/EOG091G0977.best_model | grep "Best" | cut -d ":" -f 2 | tr -d '[:space:]')
                if [ "$(ls -1 | grep "^RAxML" | wc -l)" -ne 0 ]
		then
			rm RAxML*
		fi
        	raxml -f a -T 2 -m PROTGAMMA$RAxMLmodel         	-p 12345 -x 12345 -# 100         	-s ../../per_gene/EOG091G0977/ALICUT_EOG091G0977.clustalo.fasta -n EOG091G0977.clustalo.aln.ALICUT.$RAxMLmodel 		1> ../../per_gene/EOG091G0977/infer_single_ML.stdout.txt 2> ../../per_gene/EOG091G0977/infer_single_ML.stderr.txt
	else
		echo "fasta file per_gene/EOG091G0977/ALICUT_EOG091G0977.clustalo.fasta contains fewer than 5 sequences - skipped" > ../../per_gene/EOG091G0977/infer_single_ML.stdout.txt
		touch raxml.skipped
	fi
        touch ../../per_gene/EOG091G0977/EOG091G0977.raxml.done
        
[33mJob counts:
	count	jobs
	1	infer_single_ML
	1[0m
[33m
        cd per_gene/EOG091G0977
	count=$(cat ../../per_gene/EOG091G0977/ALICUT_EOG091G0977.clustalo.fasta | grep ">" | wc -l)
	if [ "$count" -gt 5 ]
        then
		RAxMLmodel=$(cat ../../per_gene/EOG091G0977/EOG091G0977.best_model | grep "Best" | cut -d ":" -f 2 | tr -d '[:space:]')
                if [ "$(ls -1 | grep "^RAxML" | wc -l)" -ne 0 ]
		then
			rm RAxML*
		fi
        	raxml -f a -T 2 -m PROTGAMMA$RAxMLmodel         	-p 12345 -x 12345 -# 100         	-s ../../per_gene/EOG091G0977/ALICUT_EOG091G0977.clustalo.fasta -n EOG091G0977.clustalo.aln.ALICUT.$RAxMLmodel 		1> ../../per_gene/EOG091G0977/infer_single_ML.stdout.txt 2> ../../per_gene/EOG091G0977/infer_single_ML.stderr.txt
	else
		echo "fasta file per_gene/EOG091G0977/ALICUT_EOG091G0977.clustalo.fasta contains fewer than 5 sequences - skipped" > ../../per_gene/EOG091G0977/infer_single_ML.stdout.txt
		touch raxml.skipped
	fi
        touch ../../per_gene/EOG091G0977/EOG091G0977.raxml.done
        [0m
[Sun Jul  5 22:16:36 2020]
Finished job 605.
865 of 3292 steps (26%) done

[Sun Jul  5 22:16:36 2020]
rule remove_empty:
    input: per_gene/EOG091G0DVQ/ALICUT_EOG091G0DVQ.clustalo.fasta
    output: per_gene/EOG091G0DVQ/empty_check.done
    jobid: 1427
    wildcards: BUSCO=EOG091G0DVQ


         if [ "$(cat per_gene/EOG091G0DVQ/ALICUT_EOG091G0DVQ.clustalo.fasta | grep -v ">" | sed 's/-//g' | grep "^$" | wc -l)" -gt 0 ]
         then
              cp per_gene/EOG091G0DVQ/ALICUT_EOG091G0DVQ.clustalo.fasta per_gene/EOG091G0DVQ/ALICUT_EOG091G0DVQ.clustalo.fasta.backup
              bash ../scripts/remove_empty.sh per_gene/EOG091G0DVQ/ALICUT_EOG091G0DVQ.clustalo.fasta.backup > per_gene/EOG091G0DVQ/ALICUT_EOG091G0DVQ.clustalo.fasta
         fi
         touch per_gene/EOG091G0DVQ/empty_check.done
         

[Sun Jul  5 22:16:36 2020]
rule remove_empty:
    input: per_gene/EOG091G0YHX/ALICUT_EOG091G0YHX.clustalo.fasta
    output: per_gene/EOG091G0YHX/empty_check.done
    jobid: 2055
    wildcards: BUSCO=EOG091G0YHX


         if [ "$(cat per_gene/EOG091G0YHX/ALICUT_EOG091G0YHX.clustalo.fasta | grep -v ">" | sed 's/-//g' | grep "^$" | wc -l)" -gt 0 ]
         then
              cp per_gene/EOG091G0YHX/ALICUT_EOG091G0YHX.clustalo.fasta per_gene/EOG091G0YHX/ALICUT_EOG091G0YHX.clustalo.fasta.backup
              bash ../scripts/remove_empty.sh per_gene/EOG091G0YHX/ALICUT_EOG091G0YHX.clustalo.fasta.backup > per_gene/EOG091G0YHX/ALICUT_EOG091G0YHX.clustalo.fasta
         fi
         touch per_gene/EOG091G0YHX/empty_check.done
         
[Sun Jul  5 22:16:36 2020]
Finished job 1427.
866 of 3292 steps (26%) done
[Sun Jul  5 22:16:36 2020]
Finished job 2055.
867 of 3292 steps (26%) done

[Sun Jul  5 22:16:36 2020]
rule find_best_model:
    input: per_gene/EOG091G0DVQ/ALICUT_EOG091G0DVQ.clustalo.fasta, per_gene/EOG091G0DVQ/empty_check.done
    output: per_gene/EOG091G0DVQ/EOG091G0DVQ.best_model
    log: per_gene/EOG091G0DVQ/find_best_model.stderr.txt
    jobid: 604
    wildcards: BUSCO=EOG091G0DVQ
    threads: 2


        cd per_gene/EOG091G0DVQ
        if [ ! -d find_best_model ]
        then
            mkdir find_best_model
        fi
        cd find_best_model
        ln -s ../../../per_gene/EOG091G0DVQ/ALICUT_EOG091G0DVQ.clustalo.fasta EOG091G0DVQ.fasta
        ProteinModelSelection.pl EOG091G0DVQ.fasta 1> ../../../per_gene/EOG091G0DVQ/EOG091G0DVQ.best_model 2> ../../../per_gene/EOG091G0DVQ/find_best_model.stderr.txt
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/c0c09ee657b1e27f2c5687e0e9aa8d70.simg
[Sun Jul  5 22:16:38 2020]
Finished job 731.
868 of 3292 steps (26%) done

[Sun Jul  5 22:16:39 2020]
rule remove_empty:
    input: per_gene/EOG091G0NKD/ALICUT_EOG091G0NKD.clustalo.fasta
    output: per_gene/EOG091G0NKD/empty_check.done
    jobid: 1553
    wildcards: BUSCO=EOG091G0NKD


         if [ "$(cat per_gene/EOG091G0NKD/ALICUT_EOG091G0NKD.clustalo.fasta | grep -v ">" | sed 's/-//g' | grep "^$" | wc -l)" -gt 0 ]
         then
              cp per_gene/EOG091G0NKD/ALICUT_EOG091G0NKD.clustalo.fasta per_gene/EOG091G0NKD/ALICUT_EOG091G0NKD.clustalo.fasta.backup
              bash ../scripts/remove_empty.sh per_gene/EOG091G0NKD/ALICUT_EOG091G0NKD.clustalo.fasta.backup > per_gene/EOG091G0NKD/ALICUT_EOG091G0NKD.clustalo.fasta
         fi
         touch per_gene/EOG091G0NKD/empty_check.done
         
[Sun Jul  5 22:16:39 2020]
Finished job 1553.
869 of 3292 steps (26%) done

[Sun Jul  5 22:16:39 2020]
rule find_best_model:
    input: per_gene/EOG091G0NKD/ALICUT_EOG091G0NKD.clustalo.fasta, per_gene/EOG091G0NKD/empty_check.done
    output: per_gene/EOG091G0NKD/EOG091G0NKD.best_model
    log: per_gene/EOG091G0NKD/find_best_model.stderr.txt
    jobid: 730
    wildcards: BUSCO=EOG091G0NKD
    threads: 2


        cd per_gene/EOG091G0NKD
        if [ ! -d find_best_model ]
        then
            mkdir find_best_model
        fi
        cd find_best_model
        ln -s ../../../per_gene/EOG091G0NKD/ALICUT_EOG091G0NKD.clustalo.fasta EOG091G0NKD.fasta
        ProteinModelSelection.pl EOG091G0NKD.fasta 1> ../../../per_gene/EOG091G0NKD/EOG091G0NKD.best_model 2> ../../../per_gene/EOG091G0NKD/find_best_model.stderr.txt
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/c0c09ee657b1e27f2c5687e0e9aa8d70.simg
[Sun Jul  5 22:16:45 2020]
Finished job 3148.
870 of 3292 steps (26%) done

[Sun Jul  5 22:16:45 2020]
rule get_outgroups:
    input: per_gene/EOG091G06MR/EOG091G06MR.ingroup.fasta
    output: per_gene/EOG091G06MR/EOG091G06MR.orthodb.fasta, per_gene/EOG091G06MR/EOG091G06MR.outgroup.fasta
    log: per_gene/EOG091G06MR/get_outgroups.stdout.txt, per_gene/EOG091G06MR/get_outgroups.stderr.txt
    jobid: 3149
    wildcards: BUSCO=EOG091G06MR


        #download fastas from Orhtodb for BUSCO id
        for i in {1..5}
        do
             wget "http://www.orthodb.org/fasta?query=EOG091G06MR&level=33208" -O per_gene/EOG091G06MR/EOG091G06MR.orthodb.fasta 1> per_gene/EOG091G06MR/get_outgroups.stdout.txt 2> per_gene/EOG091G06MR/get_outgroups.stderr.txt && break || echo -e "try again ($i)" && sleep 15
        done

	#This is quick an dirty for now and just takes the first protein if there is more than one for an outgroup taxon
        bash ../scripts/download_outgroups.sh taxids.txt per_gene/EOG091G06MR/EOG091G06MR.orthodb.fasta > per_gene/EOG091G06MR/EOG091G06MR.outgroup.fasta
        
[Sun Jul  5 22:16:46 2020]
Finished job 3149.
871 of 3292 steps (26%) done

[Sun Jul  5 22:16:46 2020]
rule join_groups:
    input: per_gene/EOG091G06MR/EOG091G06MR.ingroup.fasta, per_gene/EOG091G06MR/EOG091G06MR.outgroup.fasta
    output: per_gene/EOG091G06MR/EOG091G06MR.fasta
    jobid: 2398
    wildcards: BUSCO=EOG091G06MR


        cat per_gene/EOG091G06MR/EOG091G06MR.ingroup.fasta per_gene/EOG091G06MR/EOG091G06MR.outgroup.fasta > per_gene/EOG091G06MR/EOG091G06MR.fasta
        
[Sun Jul  5 22:16:46 2020]
Finished job 2398.
872 of 3292 steps (26%) done

[Sun Jul  5 22:16:46 2020]
rule MSA:
    input: per_gene/EOG091G06MR/EOG091G06MR.fasta
    output: per_gene/EOG091G06MR/EOG091G06MR.clustalo.fasta
    log: per_gene/EOG091G06MR/MSA.stdout.txt, per_gene/EOG091G06MR/MSA.stderr.txt
    jobid: 1916
    wildcards: BUSCO=EOG091G06MR
    threads: 2


        clustalo -i per_gene/EOG091G06MR/EOG091G06MR.fasta -o per_gene/EOG091G06MR/EOG091G06MR.clustalo.fasta --threads=2 1> per_gene/EOG091G06MR/MSA.stdout.txt 2> per_gene/EOG091G06MR/MSA.stderr.txt
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/d68c9691725a7401923680874285c430.simg
[Sun Jul  5 22:16:48 2020]
Finished job 1916.
873 of 3292 steps (27%) done

[Sun Jul  5 22:16:48 2020]
rule score_and_cut:
    input: per_gene/EOG091G06MR/EOG091G06MR.clustalo.fasta
    output: per_gene/EOG091G06MR/ALICUT_EOG091G06MR.clustalo.fasta
    jobid: 1093
    wildcards: BUSCO=EOG091G06MR
    threads: 2


        cd per_gene/EOG091G06MR
        Aliscore.pl -N -r 200000000000000000 -i ../../per_gene/EOG091G06MR/EOG091G06MR.clustalo.fasta &> aliscore.log
        ALICUT.pl -s &> alicut.log
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/63c88c27a0fa300f57066b0ef65fefcb.simg
[Sun Jul  5 22:17:01 2020]
Finished job 1093.
874 of 3292 steps (27%) done

[Sun Jul  5 22:17:01 2020]
rule remove_empty:
    input: per_gene/EOG091G06MR/ALICUT_EOG091G06MR.clustalo.fasta
    output: per_gene/EOG091G06MR/empty_check.done
    jobid: 1915
    wildcards: BUSCO=EOG091G06MR


         if [ "$(cat per_gene/EOG091G06MR/ALICUT_EOG091G06MR.clustalo.fasta | grep -v ">" | sed 's/-//g' | grep "^$" | wc -l)" -gt 0 ]
         then
              cp per_gene/EOG091G06MR/ALICUT_EOG091G06MR.clustalo.fasta per_gene/EOG091G06MR/ALICUT_EOG091G06MR.clustalo.fasta.backup
              bash ../scripts/remove_empty.sh per_gene/EOG091G06MR/ALICUT_EOG091G06MR.clustalo.fasta.backup > per_gene/EOG091G06MR/ALICUT_EOG091G06MR.clustalo.fasta
         fi
         touch per_gene/EOG091G06MR/empty_check.done
         
[Sun Jul  5 22:17:01 2020]
Finished job 1915.
875 of 3292 steps (27%) done

[Sun Jul  5 22:17:01 2020]
rule find_best_model:
    input: per_gene/EOG091G06MR/ALICUT_EOG091G06MR.clustalo.fasta, per_gene/EOG091G06MR/empty_check.done
    output: per_gene/EOG091G06MR/EOG091G06MR.best_model
    log: per_gene/EOG091G06MR/find_best_model.stderr.txt
    jobid: 1092
    wildcards: BUSCO=EOG091G06MR
    threads: 2


        cd per_gene/EOG091G06MR
        if [ ! -d find_best_model ]
        then
            mkdir find_best_model
        fi
        cd find_best_model
        ln -s ../../../per_gene/EOG091G06MR/ALICUT_EOG091G06MR.clustalo.fasta EOG091G06MR.fasta
        ProteinModelSelection.pl EOG091G06MR.fasta 1> ../../../per_gene/EOG091G06MR/EOG091G06MR.best_model 2> ../../../per_gene/EOG091G06MR/find_best_model.stderr.txt
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/c0c09ee657b1e27f2c5687e0e9aa8d70.simg
[Sun Jul  5 22:17:17 2020]
Finished job 120.
876 of 3292 steps (27%) done

[Sun Jul  5 22:17:17 2020]
rule find_best_model:
    input: per_gene/EOG091G0YHX/ALICUT_EOG091G0YHX.clustalo.fasta, per_gene/EOG091G0YHX/empty_check.done
    output: per_gene/EOG091G0YHX/EOG091G0YHX.best_model
    log: per_gene/EOG091G0YHX/find_best_model.stderr.txt
    jobid: 1232
    wildcards: BUSCO=EOG091G0YHX
    threads: 2


        cd per_gene/EOG091G0YHX
        if [ ! -d find_best_model ]
        then
            mkdir find_best_model
        fi
        cd find_best_model
        ln -s ../../../per_gene/EOG091G0YHX/ALICUT_EOG091G0YHX.clustalo.fasta EOG091G0YHX.fasta
        ProteinModelSelection.pl EOG091G0YHX.fasta 1> ../../../per_gene/EOG091G0YHX/EOG091G0YHX.best_model 2> ../../../per_gene/EOG091G0YHX/find_best_model.stderr.txt
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/c0c09ee657b1e27f2c5687e0e9aa8d70.simg
[Sun Jul  5 22:17:32 2020]
Finished job 6.
877 of 3292 steps (27%) done

[Sun Jul  5 22:17:32 2020]
rule get_seqs:
    input: /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ingroup.txt, /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/outgroup.txt
    output: per_gene/EOG091G06QP/EOG091G06QP.ingroup.fasta
    log: per_gene/EOG091G06QP/get_seqs.stdout.txt, per_gene/EOG091G06QP/get_seqs.stderr.txt
    jobid: 2562
    wildcards: BUSCO=EOG091G06QP
    threads: 2


	basedir=$(pwd)
        cd per_gene/EOG091G06QP
        
        bash $basedir/../scripts/fetch_seqs.sh EOG091G06QP /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ingroup.txt /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/outgroup.txt 1> ../../per_gene/EOG091G06QP/get_seqs.stdout.txt 2> ../../per_gene/EOG091G06QP/get_seqs.stderr.txt
	mv EOG091G06QP.fasta $basedir/per_gene/EOG091G06QP/EOG091G06QP.ingroup.fasta
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/72476f9d9a5bd0627b4d721143a21354.simg
[Sun Jul  5 22:17:33 2020]
Finished job 604.
878 of 3292 steps (27%) done

[Sun Jul  5 22:17:33 2020]
rule infer_single_ML:
    input: per_gene/EOG091G0DVQ/EOG091G0DVQ.best_model, per_gene/EOG091G0DVQ/ALICUT_EOG091G0DVQ.clustalo.fasta
    output: per_gene/EOG091G0DVQ/EOG091G0DVQ.raxml.done
    log: per_gene/EOG091G0DVQ/infer_single_ML.stdout.txt, per_gene/EOG091G0DVQ/infer_single_ML.stderr.txt
    jobid: 96
    wildcards: BUSCO=EOG091G0DVQ
    threads: 2


        cd per_gene/EOG091G0DVQ
	count=$(cat ../../per_gene/EOG091G0DVQ/ALICUT_EOG091G0DVQ.clustalo.fasta | grep ">" | wc -l)
	if [ "$count" -gt 5 ]
        then
		RAxMLmodel=$(cat ../../per_gene/EOG091G0DVQ/EOG091G0DVQ.best_model | grep "Best" | cut -d ":" -f 2 | tr -d '[:space:]')
                if [ "$(ls -1 | grep "^RAxML" | wc -l)" -ne 0 ]
		then
			rm RAxML*
		fi
        	raxml -f a -T 2 -m PROTGAMMA$RAxMLmodel         	-p 12345 -x 12345 -# 100         	-s ../../per_gene/EOG091G0DVQ/ALICUT_EOG091G0DVQ.clustalo.fasta -n EOG091G0DVQ.clustalo.aln.ALICUT.$RAxMLmodel 		1> ../../per_gene/EOG091G0DVQ/infer_single_ML.stdout.txt 2> ../../per_gene/EOG091G0DVQ/infer_single_ML.stderr.txt
	else
		echo "fasta file per_gene/EOG091G0DVQ/ALICUT_EOG091G0DVQ.clustalo.fasta contains fewer than 5 sequences - skipped" > ../../per_gene/EOG091G0DVQ/infer_single_ML.stdout.txt
		touch raxml.skipped
	fi
        touch ../../per_gene/EOG091G0DVQ/EOG091G0DVQ.raxml.done
        
[33mJob counts:
	count	jobs
	1	infer_single_ML
	1[0m
[33m
        cd per_gene/EOG091G0DVQ
	count=$(cat ../../per_gene/EOG091G0DVQ/ALICUT_EOG091G0DVQ.clustalo.fasta | grep ">" | wc -l)
	if [ "$count" -gt 5 ]
        then
		RAxMLmodel=$(cat ../../per_gene/EOG091G0DVQ/EOG091G0DVQ.best_model | grep "Best" | cut -d ":" -f 2 | tr -d '[:space:]')
                if [ "$(ls -1 | grep "^RAxML" | wc -l)" -ne 0 ]
		then
			rm RAxML*
		fi
        	raxml -f a -T 2 -m PROTGAMMA$RAxMLmodel         	-p 12345 -x 12345 -# 100         	-s ../../per_gene/EOG091G0DVQ/ALICUT_EOG091G0DVQ.clustalo.fasta -n EOG091G0DVQ.clustalo.aln.ALICUT.$RAxMLmodel 		1> ../../per_gene/EOG091G0DVQ/infer_single_ML.stdout.txt 2> ../../per_gene/EOG091G0DVQ/infer_single_ML.stderr.txt
	else
		echo "fasta file per_gene/EOG091G0DVQ/ALICUT_EOG091G0DVQ.clustalo.fasta contains fewer than 5 sequences - skipped" > ../../per_gene/EOG091G0DVQ/infer_single_ML.stdout.txt
		touch raxml.skipped
	fi
        touch ../../per_gene/EOG091G0DVQ/EOG091G0DVQ.raxml.done
        [0m
[Sun Jul  5 22:17:38 2020]
Finished job 730.
879 of 3292 steps (27%) done

[Sun Jul  5 22:17:38 2020]
rule infer_single_ML:
    input: per_gene/EOG091G0NKD/EOG091G0NKD.best_model, per_gene/EOG091G0NKD/ALICUT_EOG091G0NKD.clustalo.fasta
    output: per_gene/EOG091G0NKD/EOG091G0NKD.raxml.done
    log: per_gene/EOG091G0NKD/infer_single_ML.stdout.txt, per_gene/EOG091G0NKD/infer_single_ML.stderr.txt
    jobid: 159
    wildcards: BUSCO=EOG091G0NKD
    threads: 2


        cd per_gene/EOG091G0NKD
	count=$(cat ../../per_gene/EOG091G0NKD/ALICUT_EOG091G0NKD.clustalo.fasta | grep ">" | wc -l)
	if [ "$count" -gt 5 ]
        then
		RAxMLmodel=$(cat ../../per_gene/EOG091G0NKD/EOG091G0NKD.best_model | grep "Best" | cut -d ":" -f 2 | tr -d '[:space:]')
                if [ "$(ls -1 | grep "^RAxML" | wc -l)" -ne 0 ]
		then
			rm RAxML*
		fi
        	raxml -f a -T 2 -m PROTGAMMA$RAxMLmodel         	-p 12345 -x 12345 -# 100         	-s ../../per_gene/EOG091G0NKD/ALICUT_EOG091G0NKD.clustalo.fasta -n EOG091G0NKD.clustalo.aln.ALICUT.$RAxMLmodel 		1> ../../per_gene/EOG091G0NKD/infer_single_ML.stdout.txt 2> ../../per_gene/EOG091G0NKD/infer_single_ML.stderr.txt
	else
		echo "fasta file per_gene/EOG091G0NKD/ALICUT_EOG091G0NKD.clustalo.fasta contains fewer than 5 sequences - skipped" > ../../per_gene/EOG091G0NKD/infer_single_ML.stdout.txt
		touch raxml.skipped
	fi
        touch ../../per_gene/EOG091G0NKD/EOG091G0NKD.raxml.done
        
[33mJob counts:
	count	jobs
	1	infer_single_ML
	1[0m
[33m
        cd per_gene/EOG091G0NKD
	count=$(cat ../../per_gene/EOG091G0NKD/ALICUT_EOG091G0NKD.clustalo.fasta | grep ">" | wc -l)
	if [ "$count" -gt 5 ]
        then
		RAxMLmodel=$(cat ../../per_gene/EOG091G0NKD/EOG091G0NKD.best_model | grep "Best" | cut -d ":" -f 2 | tr -d '[:space:]')
                if [ "$(ls -1 | grep "^RAxML" | wc -l)" -ne 0 ]
		then
			rm RAxML*
		fi
        	raxml -f a -T 2 -m PROTGAMMA$RAxMLmodel         	-p 12345 -x 12345 -# 100         	-s ../../per_gene/EOG091G0NKD/ALICUT_EOG091G0NKD.clustalo.fasta -n EOG091G0NKD.clustalo.aln.ALICUT.$RAxMLmodel 		1> ../../per_gene/EOG091G0NKD/infer_single_ML.stdout.txt 2> ../../per_gene/EOG091G0NKD/infer_single_ML.stderr.txt
	else
		echo "fasta file per_gene/EOG091G0NKD/ALICUT_EOG091G0NKD.clustalo.fasta contains fewer than 5 sequences - skipped" > ../../per_gene/EOG091G0NKD/infer_single_ML.stdout.txt
		touch raxml.skipped
	fi
        touch ../../per_gene/EOG091G0NKD/EOG091G0NKD.raxml.done
        [0m
[Sun Jul  5 22:17:53 2020]
Finished job 2562.
880 of 3292 steps (27%) done

[Sun Jul  5 22:17:53 2020]
rule get_outgroups:
    input: per_gene/EOG091G06QP/EOG091G06QP.ingroup.fasta
    output: per_gene/EOG091G06QP/EOG091G06QP.orthodb.fasta, per_gene/EOG091G06QP/EOG091G06QP.outgroup.fasta
    log: per_gene/EOG091G06QP/get_outgroups.stdout.txt, per_gene/EOG091G06QP/get_outgroups.stderr.txt
    jobid: 2563
    wildcards: BUSCO=EOG091G06QP


        #download fastas from Orhtodb for BUSCO id
        for i in {1..5}
        do
             wget "http://www.orthodb.org/fasta?query=EOG091G06QP&level=33208" -O per_gene/EOG091G06QP/EOG091G06QP.orthodb.fasta 1> per_gene/EOG091G06QP/get_outgroups.stdout.txt 2> per_gene/EOG091G06QP/get_outgroups.stderr.txt && break || echo -e "try again ($i)" && sleep 15
        done

	#This is quick an dirty for now and just takes the first protein if there is more than one for an outgroup taxon
        bash ../scripts/download_outgroups.sh taxids.txt per_gene/EOG091G06QP/EOG091G06QP.orthodb.fasta > per_gene/EOG091G06QP/EOG091G06QP.outgroup.fasta
        
[Sun Jul  5 22:17:55 2020]
Finished job 2563.
881 of 3292 steps (27%) done

[Sun Jul  5 22:17:55 2020]
rule join_groups:
    input: per_gene/EOG091G06QP/EOG091G06QP.ingroup.fasta, per_gene/EOG091G06QP/EOG091G06QP.outgroup.fasta
    output: per_gene/EOG091G06QP/EOG091G06QP.fasta
    jobid: 2105
    wildcards: BUSCO=EOG091G06QP


        cat per_gene/EOG091G06QP/EOG091G06QP.ingroup.fasta per_gene/EOG091G06QP/EOG091G06QP.outgroup.fasta > per_gene/EOG091G06QP/EOG091G06QP.fasta
        
[Sun Jul  5 22:17:55 2020]
Finished job 2105.
882 of 3292 steps (27%) done

[Sun Jul  5 22:17:55 2020]
rule MSA:
    input: per_gene/EOG091G06QP/EOG091G06QP.fasta
    output: per_gene/EOG091G06QP/EOG091G06QP.clustalo.fasta
    log: per_gene/EOG091G06QP/MSA.stdout.txt, per_gene/EOG091G06QP/MSA.stderr.txt
    jobid: 1330
    wildcards: BUSCO=EOG091G06QP
    threads: 2


        clustalo -i per_gene/EOG091G06QP/EOG091G06QP.fasta -o per_gene/EOG091G06QP/EOG091G06QP.clustalo.fasta --threads=2 1> per_gene/EOG091G06QP/MSA.stdout.txt 2> per_gene/EOG091G06QP/MSA.stderr.txt
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/d68c9691725a7401923680874285c430.simg
[Sun Jul  5 22:17:58 2020]
Finished job 276.
883 of 3292 steps (27%) done

[Sun Jul  5 22:17:58 2020]
rule get_seqs:
    input: /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ingroup.txt, /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/outgroup.txt
    output: per_gene/EOG091G05NK/EOG091G05NK.ingroup.fasta
    log: per_gene/EOG091G05NK/get_seqs.stdout.txt, per_gene/EOG091G05NK/get_seqs.stderr.txt
    jobid: 2544
    wildcards: BUSCO=EOG091G05NK
    threads: 2


	basedir=$(pwd)
        cd per_gene/EOG091G05NK
        
        bash $basedir/../scripts/fetch_seqs.sh EOG091G05NK /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ingroup.txt /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/outgroup.txt 1> ../../per_gene/EOG091G05NK/get_seqs.stdout.txt 2> ../../per_gene/EOG091G05NK/get_seqs.stderr.txt
	mv EOG091G05NK.fasta $basedir/per_gene/EOG091G05NK/EOG091G05NK.ingroup.fasta
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/72476f9d9a5bd0627b4d721143a21354.simg
[Sun Jul  5 22:17:58 2020]
Finished job 1330.
884 of 3292 steps (27%) done

[Sun Jul  5 22:17:58 2020]
rule score_and_cut:
    input: per_gene/EOG091G06QP/EOG091G06QP.clustalo.fasta
    output: per_gene/EOG091G06QP/ALICUT_EOG091G06QP.clustalo.fasta
    jobid: 507
    wildcards: BUSCO=EOG091G06QP
    threads: 2


        cd per_gene/EOG091G06QP
        Aliscore.pl -N -r 200000000000000000 -i ../../per_gene/EOG091G06QP/EOG091G06QP.clustalo.fasta &> aliscore.log
        ALICUT.pl -s &> alicut.log
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/63c88c27a0fa300f57066b0ef65fefcb.simg
[Sun Jul  5 22:18:02 2020]
Finished job 1092.
885 of 3292 steps (27%) done
[Sun Jul  5 22:18:02 2020]
Finished job 1232.
886 of 3292 steps (27%) done

[Sun Jul  5 22:18:02 2020]
rule infer_single_ML:
    input: per_gene/EOG091G06MR/EOG091G06MR.best_model, per_gene/EOG091G06MR/ALICUT_EOG091G06MR.clustalo.fasta
    output: per_gene/EOG091G06MR/EOG091G06MR.raxml.done
    log: per_gene/EOG091G06MR/infer_single_ML.stdout.txt, per_gene/EOG091G06MR/infer_single_ML.stderr.txt
    jobid: 340
    wildcards: BUSCO=EOG091G06MR
    threads: 2


        cd per_gene/EOG091G06MR
	count=$(cat ../../per_gene/EOG091G06MR/ALICUT_EOG091G06MR.clustalo.fasta | grep ">" | wc -l)
	if [ "$count" -gt 5 ]
        then
		RAxMLmodel=$(cat ../../per_gene/EOG091G06MR/EOG091G06MR.best_model | grep "Best" | cut -d ":" -f 2 | tr -d '[:space:]')
                if [ "$(ls -1 | grep "^RAxML" | wc -l)" -ne 0 ]
		then
			rm RAxML*
		fi
        	raxml -f a -T 2 -m PROTGAMMA$RAxMLmodel         	-p 12345 -x 12345 -# 100         	-s ../../per_gene/EOG091G06MR/ALICUT_EOG091G06MR.clustalo.fasta -n EOG091G06MR.clustalo.aln.ALICUT.$RAxMLmodel 		1> ../../per_gene/EOG091G06MR/infer_single_ML.stdout.txt 2> ../../per_gene/EOG091G06MR/infer_single_ML.stderr.txt
	else
		echo "fasta file per_gene/EOG091G06MR/ALICUT_EOG091G06MR.clustalo.fasta contains fewer than 5 sequences - skipped" > ../../per_gene/EOG091G06MR/infer_single_ML.stdout.txt
		touch raxml.skipped
	fi
        touch ../../per_gene/EOG091G06MR/EOG091G06MR.raxml.done
        

[Sun Jul  5 22:18:02 2020]
rule infer_single_ML:
    input: per_gene/EOG091G0YHX/EOG091G0YHX.best_model, per_gene/EOG091G0YHX/ALICUT_EOG091G0YHX.clustalo.fasta
    output: per_gene/EOG091G0YHX/EOG091G0YHX.raxml.done
    log: per_gene/EOG091G0YHX/infer_single_ML.stdout.txt, per_gene/EOG091G0YHX/infer_single_ML.stderr.txt
    jobid: 410
    wildcards: BUSCO=EOG091G0YHX
    threads: 2


        cd per_gene/EOG091G0YHX
	count=$(cat ../../per_gene/EOG091G0YHX/ALICUT_EOG091G0YHX.clustalo.fasta | grep ">" | wc -l)
	if [ "$count" -gt 5 ]
        then
		RAxMLmodel=$(cat ../../per_gene/EOG091G0YHX/EOG091G0YHX.best_model | grep "Best" | cut -d ":" -f 2 | tr -d '[:space:]')
                if [ "$(ls -1 | grep "^RAxML" | wc -l)" -ne 0 ]
		then
			rm RAxML*
		fi
        	raxml -f a -T 2 -m PROTGAMMA$RAxMLmodel         	-p 12345 -x 12345 -# 100         	-s ../../per_gene/EOG091G0YHX/ALICUT_EOG091G0YHX.clustalo.fasta -n EOG091G0YHX.clustalo.aln.ALICUT.$RAxMLmodel 		1> ../../per_gene/EOG091G0YHX/infer_single_ML.stdout.txt 2> ../../per_gene/EOG091G0YHX/infer_single_ML.stderr.txt
	else
		echo "fasta file per_gene/EOG091G0YHX/ALICUT_EOG091G0YHX.clustalo.fasta contains fewer than 5 sequences - skipped" > ../../per_gene/EOG091G0YHX/infer_single_ML.stdout.txt
		touch raxml.skipped
	fi
        touch ../../per_gene/EOG091G0YHX/EOG091G0YHX.raxml.done
        
[33mJob counts:
	count	jobs
	1	infer_single_ML
	1[0m
[33m
        cd per_gene/EOG091G06MR
	count=$(cat ../../per_gene/EOG091G06MR/ALICUT_EOG091G06MR.clustalo.fasta | grep ">" | wc -l)
	if [ "$count" -gt 5 ]
        then
		RAxMLmodel=$(cat ../../per_gene/EOG091G06MR/EOG091G06MR.best_model | grep "Best" | cut -d ":" -f 2 | tr -d '[:space:]')
                if [ "$(ls -1 | grep "^RAxML" | wc -l)" -ne 0 ]
		then
			rm RAxML*
		fi
        	raxml -f a -T 2 -m PROTGAMMA$RAxMLmodel         	-p 12345 -x 12345 -# 100         	-s ../../per_gene/EOG091G06MR/ALICUT_EOG091G06MR.clustalo.fasta -n EOG091G06MR.clustalo.aln.ALICUT.$RAxMLmodel 		1> ../../per_gene/EOG091G06MR/infer_single_ML.stdout.txt 2> ../../per_gene/EOG091G06MR/infer_single_ML.stderr.txt
	else
		echo "fasta file per_gene/EOG091G06MR/ALICUT_EOG091G06MR.clustalo.fasta contains fewer than 5 sequences - skipped" > ../../per_gene/EOG091G06MR/infer_single_ML.stdout.txt
		touch raxml.skipped
	fi
        touch ../../per_gene/EOG091G06MR/EOG091G06MR.raxml.done
        [0m
[33mJob counts:
	count	jobs
	1	infer_single_ML
	1[0m
[33m
        cd per_gene/EOG091G0YHX
	count=$(cat ../../per_gene/EOG091G0YHX/ALICUT_EOG091G0YHX.clustalo.fasta | grep ">" | wc -l)
	if [ "$count" -gt 5 ]
        then
		RAxMLmodel=$(cat ../../per_gene/EOG091G0YHX/EOG091G0YHX.best_model | grep "Best" | cut -d ":" -f 2 | tr -d '[:space:]')
                if [ "$(ls -1 | grep "^RAxML" | wc -l)" -ne 0 ]
		then
			rm RAxML*
		fi
        	raxml -f a -T 2 -m PROTGAMMA$RAxMLmodel         	-p 12345 -x 12345 -# 100         	-s ../../per_gene/EOG091G0YHX/ALICUT_EOG091G0YHX.clustalo.fasta -n EOG091G0YHX.clustalo.aln.ALICUT.$RAxMLmodel 		1> ../../per_gene/EOG091G0YHX/infer_single_ML.stdout.txt 2> ../../per_gene/EOG091G0YHX/infer_single_ML.stderr.txt
	else
		echo "fasta file per_gene/EOG091G0YHX/ALICUT_EOG091G0YHX.clustalo.fasta contains fewer than 5 sequences - skipped" > ../../per_gene/EOG091G0YHX/infer_single_ML.stdout.txt
		touch raxml.skipped
	fi
        touch ../../per_gene/EOG091G0YHX/EOG091G0YHX.raxml.done
        [0m
[Sun Jul  5 22:18:08 2020]
Finished job 507.
887 of 3292 steps (27%) done

[Sun Jul  5 22:18:08 2020]
rule remove_empty:
    input: per_gene/EOG091G06QP/ALICUT_EOG091G06QP.clustalo.fasta
    output: per_gene/EOG091G06QP/empty_check.done
    jobid: 1329
    wildcards: BUSCO=EOG091G06QP


         if [ "$(cat per_gene/EOG091G06QP/ALICUT_EOG091G06QP.clustalo.fasta | grep -v ">" | sed 's/-//g' | grep "^$" | wc -l)" -gt 0 ]
         then
              cp per_gene/EOG091G06QP/ALICUT_EOG091G06QP.clustalo.fasta per_gene/EOG091G06QP/ALICUT_EOG091G06QP.clustalo.fasta.backup
              bash ../scripts/remove_empty.sh per_gene/EOG091G06QP/ALICUT_EOG091G06QP.clustalo.fasta.backup > per_gene/EOG091G06QP/ALICUT_EOG091G06QP.clustalo.fasta
         fi
         touch per_gene/EOG091G06QP/empty_check.done
         
[Sun Jul  5 22:18:08 2020]
Finished job 1329.
888 of 3292 steps (27%) done

[Sun Jul  5 22:18:08 2020]
rule find_best_model:
    input: per_gene/EOG091G06QP/ALICUT_EOG091G06QP.clustalo.fasta, per_gene/EOG091G06QP/empty_check.done
    output: per_gene/EOG091G06QP/EOG091G06QP.best_model
    log: per_gene/EOG091G06QP/find_best_model.stderr.txt
    jobid: 506
    wildcards: BUSCO=EOG091G06QP
    threads: 2


        cd per_gene/EOG091G06QP
        if [ ! -d find_best_model ]
        then
            mkdir find_best_model
        fi
        cd find_best_model
        ln -s ../../../per_gene/EOG091G06QP/ALICUT_EOG091G06QP.clustalo.fasta EOG091G06QP.fasta
        ProteinModelSelection.pl EOG091G06QP.fasta 1> ../../../per_gene/EOG091G06QP/EOG091G06QP.best_model 2> ../../../per_gene/EOG091G06QP/find_best_model.stderr.txt
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/c0c09ee657b1e27f2c5687e0e9aa8d70.simg
[Sun Jul  5 22:18:16 2020]
Finished job 2544.
889 of 3292 steps (27%) done

[Sun Jul  5 22:18:16 2020]
rule get_outgroups:
    input: per_gene/EOG091G05NK/EOG091G05NK.ingroup.fasta
    output: per_gene/EOG091G05NK/EOG091G05NK.orthodb.fasta, per_gene/EOG091G05NK/EOG091G05NK.outgroup.fasta
    log: per_gene/EOG091G05NK/get_outgroups.stdout.txt, per_gene/EOG091G05NK/get_outgroups.stderr.txt
    jobid: 2545
    wildcards: BUSCO=EOG091G05NK


        #download fastas from Orhtodb for BUSCO id
        for i in {1..5}
        do
             wget "http://www.orthodb.org/fasta?query=EOG091G05NK&level=33208" -O per_gene/EOG091G05NK/EOG091G05NK.orthodb.fasta 1> per_gene/EOG091G05NK/get_outgroups.stdout.txt 2> per_gene/EOG091G05NK/get_outgroups.stderr.txt && break || echo -e "try again ($i)" && sleep 15
        done

	#This is quick an dirty for now and just takes the first protein if there is more than one for an outgroup taxon
        bash ../scripts/download_outgroups.sh taxids.txt per_gene/EOG091G05NK/EOG091G05NK.orthodb.fasta > per_gene/EOG091G05NK/EOG091G05NK.outgroup.fasta
        
[Sun Jul  5 22:18:18 2020]
Finished job 2545.
890 of 3292 steps (27%) done

[Sun Jul  5 22:18:18 2020]
rule join_groups:
    input: per_gene/EOG091G05NK/EOG091G05NK.ingroup.fasta, per_gene/EOG091G05NK/EOG091G05NK.outgroup.fasta
    output: per_gene/EOG091G05NK/EOG091G05NK.fasta
    jobid: 2096
    wildcards: BUSCO=EOG091G05NK


        cat per_gene/EOG091G05NK/EOG091G05NK.ingroup.fasta per_gene/EOG091G05NK/EOG091G05NK.outgroup.fasta > per_gene/EOG091G05NK/EOG091G05NK.fasta
        
[Sun Jul  5 22:18:18 2020]
Finished job 2096.
891 of 3292 steps (27%) done

[Sun Jul  5 22:18:18 2020]
rule MSA:
    input: per_gene/EOG091G05NK/EOG091G05NK.fasta
    output: per_gene/EOG091G05NK/EOG091G05NK.clustalo.fasta
    log: per_gene/EOG091G05NK/MSA.stdout.txt, per_gene/EOG091G05NK/MSA.stderr.txt
    jobid: 1312
    wildcards: BUSCO=EOG091G05NK
    threads: 2


        clustalo -i per_gene/EOG091G05NK/EOG091G05NK.fasta -o per_gene/EOG091G05NK/EOG091G05NK.clustalo.fasta --threads=2 1> per_gene/EOG091G05NK/MSA.stdout.txt 2> per_gene/EOG091G05NK/MSA.stderr.txt
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/d68c9691725a7401923680874285c430.simg
[Sun Jul  5 22:18:22 2020]
Finished job 339.
892 of 3292 steps (27%) done

[Sun Jul  5 22:18:22 2020]
rule get_seqs:
    input: /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ingroup.txt, /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/outgroup.txt
    output: per_gene/EOG091G04LC/EOG091G04LC.ingroup.fasta
    log: per_gene/EOG091G04LC/get_seqs.stdout.txt, per_gene/EOG091G04LC/get_seqs.stderr.txt
    jobid: 3134
    wildcards: BUSCO=EOG091G04LC
    threads: 2


	basedir=$(pwd)
        cd per_gene/EOG091G04LC
        
        bash $basedir/../scripts/fetch_seqs.sh EOG091G04LC /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ingroup.txt /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/outgroup.txt 1> ../../per_gene/EOG091G04LC/get_seqs.stdout.txt 2> ../../per_gene/EOG091G04LC/get_seqs.stderr.txt
	mv EOG091G04LC.fasta $basedir/per_gene/EOG091G04LC/EOG091G04LC.ingroup.fasta
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/72476f9d9a5bd0627b4d721143a21354.simg
[Sun Jul  5 22:18:24 2020]
Finished job 1312.
893 of 3292 steps (27%) done

[Sun Jul  5 22:18:24 2020]
rule score_and_cut:
    input: per_gene/EOG091G05NK/EOG091G05NK.clustalo.fasta
    output: per_gene/EOG091G05NK/ALICUT_EOG091G05NK.clustalo.fasta
    jobid: 489
    wildcards: BUSCO=EOG091G05NK
    threads: 2


        cd per_gene/EOG091G05NK
        Aliscore.pl -N -r 200000000000000000 -i ../../per_gene/EOG091G05NK/EOG091G05NK.clustalo.fasta &> aliscore.log
        ALICUT.pl -s &> alicut.log
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/63c88c27a0fa300f57066b0ef65fefcb.simg
[Sun Jul  5 22:18:38 2020]
Finished job 489.
894 of 3292 steps (27%) done

[Sun Jul  5 22:18:38 2020]
rule remove_empty:
    input: per_gene/EOG091G05NK/ALICUT_EOG091G05NK.clustalo.fasta
    output: per_gene/EOG091G05NK/empty_check.done
    jobid: 1311
    wildcards: BUSCO=EOG091G05NK


         if [ "$(cat per_gene/EOG091G05NK/ALICUT_EOG091G05NK.clustalo.fasta | grep -v ">" | sed 's/-//g' | grep "^$" | wc -l)" -gt 0 ]
         then
              cp per_gene/EOG091G05NK/ALICUT_EOG091G05NK.clustalo.fasta per_gene/EOG091G05NK/ALICUT_EOG091G05NK.clustalo.fasta.backup
              bash ../scripts/remove_empty.sh per_gene/EOG091G05NK/ALICUT_EOG091G05NK.clustalo.fasta.backup > per_gene/EOG091G05NK/ALICUT_EOG091G05NK.clustalo.fasta
         fi
         touch per_gene/EOG091G05NK/empty_check.done
         
[Sun Jul  5 22:18:38 2020]
Finished job 1311.
895 of 3292 steps (27%) done

[Sun Jul  5 22:18:38 2020]
rule find_best_model:
    input: per_gene/EOG091G05NK/ALICUT_EOG091G05NK.clustalo.fasta, per_gene/EOG091G05NK/empty_check.done
    output: per_gene/EOG091G05NK/EOG091G05NK.best_model
    log: per_gene/EOG091G05NK/find_best_model.stderr.txt
    jobid: 488
    wildcards: BUSCO=EOG091G05NK
    threads: 2


        cd per_gene/EOG091G05NK
        if [ ! -d find_best_model ]
        then
            mkdir find_best_model
        fi
        cd find_best_model
        ln -s ../../../per_gene/EOG091G05NK/ALICUT_EOG091G05NK.clustalo.fasta EOG091G05NK.fasta
        ProteinModelSelection.pl EOG091G05NK.fasta 1> ../../../per_gene/EOG091G05NK/EOG091G05NK.best_model 2> ../../../per_gene/EOG091G05NK/find_best_model.stderr.txt
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/c0c09ee657b1e27f2c5687e0e9aa8d70.simg
[Sun Jul  5 22:18:39 2020]
Finished job 3134.
896 of 3292 steps (27%) done

[Sun Jul  5 22:18:39 2020]
rule get_outgroups:
    input: per_gene/EOG091G04LC/EOG091G04LC.ingroup.fasta
    output: per_gene/EOG091G04LC/EOG091G04LC.orthodb.fasta, per_gene/EOG091G04LC/EOG091G04LC.outgroup.fasta
    log: per_gene/EOG091G04LC/get_outgroups.stdout.txt, per_gene/EOG091G04LC/get_outgroups.stderr.txt
    jobid: 3135
    wildcards: BUSCO=EOG091G04LC


        #download fastas from Orhtodb for BUSCO id
        for i in {1..5}
        do
             wget "http://www.orthodb.org/fasta?query=EOG091G04LC&level=33208" -O per_gene/EOG091G04LC/EOG091G04LC.orthodb.fasta 1> per_gene/EOG091G04LC/get_outgroups.stdout.txt 2> per_gene/EOG091G04LC/get_outgroups.stderr.txt && break || echo -e "try again ($i)" && sleep 15
        done

	#This is quick an dirty for now and just takes the first protein if there is more than one for an outgroup taxon
        bash ../scripts/download_outgroups.sh taxids.txt per_gene/EOG091G04LC/EOG091G04LC.orthodb.fasta > per_gene/EOG091G04LC/EOG091G04LC.outgroup.fasta
        
[Sun Jul  5 22:18:40 2020]
Finished job 3135.
897 of 3292 steps (27%) done

[Sun Jul  5 22:18:40 2020]
rule join_groups:
    input: per_gene/EOG091G04LC/EOG091G04LC.ingroup.fasta, per_gene/EOG091G04LC/EOG091G04LC.outgroup.fasta
    output: per_gene/EOG091G04LC/EOG091G04LC.fasta
    jobid: 2391
    wildcards: BUSCO=EOG091G04LC


        cat per_gene/EOG091G04LC/EOG091G04LC.ingroup.fasta per_gene/EOG091G04LC/EOG091G04LC.outgroup.fasta > per_gene/EOG091G04LC/EOG091G04LC.fasta
        
[Sun Jul  5 22:18:40 2020]
Finished job 2391.
898 of 3292 steps (27%) done

[Sun Jul  5 22:18:40 2020]
rule MSA:
    input: per_gene/EOG091G04LC/EOG091G04LC.fasta
    output: per_gene/EOG091G04LC/EOG091G04LC.clustalo.fasta
    log: per_gene/EOG091G04LC/MSA.stdout.txt, per_gene/EOG091G04LC/MSA.stderr.txt
    jobid: 1902
    wildcards: BUSCO=EOG091G04LC
    threads: 2


        clustalo -i per_gene/EOG091G04LC/EOG091G04LC.fasta -o per_gene/EOG091G04LC/EOG091G04LC.clustalo.fasta --threads=2 1> per_gene/EOG091G04LC/MSA.stdout.txt 2> per_gene/EOG091G04LC/MSA.stderr.txt
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/d68c9691725a7401923680874285c430.simg
[Sun Jul  5 22:18:43 2020]
Finished job 83.
899 of 3292 steps (27%) done

[Sun Jul  5 22:18:43 2020]
rule get_seqs:
    input: /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ingroup.txt, /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/outgroup.txt
    output: per_gene/EOG091G0D8I/EOG091G0D8I.ingroup.fasta
    log: per_gene/EOG091G0D8I/get_seqs.stdout.txt, per_gene/EOG091G0D8I/get_seqs.stderr.txt
    jobid: 2972
    wildcards: BUSCO=EOG091G0D8I
    threads: 2


	basedir=$(pwd)
        cd per_gene/EOG091G0D8I
        
        bash $basedir/../scripts/fetch_seqs.sh EOG091G0D8I /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ingroup.txt /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/outgroup.txt 1> ../../per_gene/EOG091G0D8I/get_seqs.stdout.txt 2> ../../per_gene/EOG091G0D8I/get_seqs.stderr.txt
	mv EOG091G0D8I.fasta $basedir/per_gene/EOG091G0D8I/EOG091G0D8I.ingroup.fasta
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/72476f9d9a5bd0627b4d721143a21354.simg
[Sun Jul  5 22:18:43 2020]
Finished job 1902.
900 of 3292 steps (27%) done

[Sun Jul  5 22:18:43 2020]
rule score_and_cut:
    input: per_gene/EOG091G04LC/EOG091G04LC.clustalo.fasta
    output: per_gene/EOG091G04LC/ALICUT_EOG091G04LC.clustalo.fasta
    jobid: 1079
    wildcards: BUSCO=EOG091G04LC
    threads: 2


        cd per_gene/EOG091G04LC
        Aliscore.pl -N -r 200000000000000000 -i ../../per_gene/EOG091G04LC/EOG091G04LC.clustalo.fasta &> aliscore.log
        ALICUT.pl -s &> alicut.log
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/63c88c27a0fa300f57066b0ef65fefcb.simg
[Sun Jul  5 22:18:57 2020]
Finished job 1079.
901 of 3292 steps (27%) done

[Sun Jul  5 22:18:57 2020]
rule remove_empty:
    input: per_gene/EOG091G04LC/ALICUT_EOG091G04LC.clustalo.fasta
    output: per_gene/EOG091G04LC/empty_check.done
    jobid: 1901
    wildcards: BUSCO=EOG091G04LC


         if [ "$(cat per_gene/EOG091G04LC/ALICUT_EOG091G04LC.clustalo.fasta | grep -v ">" | sed 's/-//g' | grep "^$" | wc -l)" -gt 0 ]
         then
              cp per_gene/EOG091G04LC/ALICUT_EOG091G04LC.clustalo.fasta per_gene/EOG091G04LC/ALICUT_EOG091G04LC.clustalo.fasta.backup
              bash ../scripts/remove_empty.sh per_gene/EOG091G04LC/ALICUT_EOG091G04LC.clustalo.fasta.backup > per_gene/EOG091G04LC/ALICUT_EOG091G04LC.clustalo.fasta
         fi
         touch per_gene/EOG091G04LC/empty_check.done
         
[Sun Jul  5 22:18:57 2020]
Finished job 1901.
902 of 3292 steps (27%) done

[Sun Jul  5 22:18:57 2020]
rule find_best_model:
    input: per_gene/EOG091G04LC/ALICUT_EOG091G04LC.clustalo.fasta, per_gene/EOG091G04LC/empty_check.done
    output: per_gene/EOG091G04LC/EOG091G04LC.best_model
    log: per_gene/EOG091G04LC/find_best_model.stderr.txt
    jobid: 1078
    wildcards: BUSCO=EOG091G04LC
    threads: 2


        cd per_gene/EOG091G04LC
        if [ ! -d find_best_model ]
        then
            mkdir find_best_model
        fi
        cd find_best_model
        ln -s ../../../per_gene/EOG091G04LC/ALICUT_EOG091G04LC.clustalo.fasta EOG091G04LC.fasta
        ProteinModelSelection.pl EOG091G04LC.fasta 1> ../../../per_gene/EOG091G04LC/EOG091G04LC.best_model 2> ../../../per_gene/EOG091G04LC/find_best_model.stderr.txt
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/c0c09ee657b1e27f2c5687e0e9aa8d70.simg
[Sun Jul  5 22:19:05 2020]
Finished job 332.
903 of 3292 steps (27%) done

[Sun Jul  5 22:19:05 2020]
rule get_seqs:
    input: /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ingroup.txt, /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/outgroup.txt
    output: per_gene/EOG091G0JI1/EOG091G0JI1.ingroup.fasta
    log: per_gene/EOG091G0JI1/get_seqs.stdout.txt, per_gene/EOG091G0JI1/get_seqs.stderr.txt
    jobid: 2728
    wildcards: BUSCO=EOG091G0JI1
    threads: 2


	basedir=$(pwd)
        cd per_gene/EOG091G0JI1
        
        bash $basedir/../scripts/fetch_seqs.sh EOG091G0JI1 /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ingroup.txt /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/outgroup.txt 1> ../../per_gene/EOG091G0JI1/get_seqs.stdout.txt 2> ../../per_gene/EOG091G0JI1/get_seqs.stderr.txt
	mv EOG091G0JI1.fasta $basedir/per_gene/EOG091G0JI1/EOG091G0JI1.ingroup.fasta
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/72476f9d9a5bd0627b4d721143a21354.simg
[Sun Jul  5 22:19:06 2020]
Finished job 285.
904 of 3292 steps (27%) done

[Sun Jul  5 22:19:06 2020]
rule get_seqs:
    input: /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ingroup.txt, /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/outgroup.txt
    output: per_gene/EOG091G05OW/EOG091G05OW.ingroup.fasta
    log: per_gene/EOG091G05OW/get_seqs.stdout.txt, per_gene/EOG091G05OW/get_seqs.stderr.txt
    jobid: 2550
    wildcards: BUSCO=EOG091G05OW
    threads: 2


	basedir=$(pwd)
        cd per_gene/EOG091G05OW
        
        bash $basedir/../scripts/fetch_seqs.sh EOG091G05OW /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ingroup.txt /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/outgroup.txt 1> ../../per_gene/EOG091G05OW/get_seqs.stdout.txt 2> ../../per_gene/EOG091G05OW/get_seqs.stderr.txt
	mv EOG091G05OW.fasta $basedir/per_gene/EOG091G05OW/EOG091G05OW.ingroup.fasta
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/72476f9d9a5bd0627b4d721143a21354.simg
[Sun Jul  5 22:19:11 2020]
Finished job 506.
905 of 3292 steps (27%) done

[Sun Jul  5 22:19:11 2020]
rule infer_single_ML:
    input: per_gene/EOG091G06QP/EOG091G06QP.best_model, per_gene/EOG091G06QP/ALICUT_EOG091G06QP.clustalo.fasta
    output: per_gene/EOG091G06QP/EOG091G06QP.raxml.done
    log: per_gene/EOG091G06QP/infer_single_ML.stdout.txt, per_gene/EOG091G06QP/infer_single_ML.stderr.txt
    jobid: 47
    wildcards: BUSCO=EOG091G06QP
    threads: 2


        cd per_gene/EOG091G06QP
	count=$(cat ../../per_gene/EOG091G06QP/ALICUT_EOG091G06QP.clustalo.fasta | grep ">" | wc -l)
	if [ "$count" -gt 5 ]
        then
		RAxMLmodel=$(cat ../../per_gene/EOG091G06QP/EOG091G06QP.best_model | grep "Best" | cut -d ":" -f 2 | tr -d '[:space:]')
                if [ "$(ls -1 | grep "^RAxML" | wc -l)" -ne 0 ]
		then
			rm RAxML*
		fi
        	raxml -f a -T 2 -m PROTGAMMA$RAxMLmodel         	-p 12345 -x 12345 -# 100         	-s ../../per_gene/EOG091G06QP/ALICUT_EOG091G06QP.clustalo.fasta -n EOG091G06QP.clustalo.aln.ALICUT.$RAxMLmodel 		1> ../../per_gene/EOG091G06QP/infer_single_ML.stdout.txt 2> ../../per_gene/EOG091G06QP/infer_single_ML.stderr.txt
	else
		echo "fasta file per_gene/EOG091G06QP/ALICUT_EOG091G06QP.clustalo.fasta contains fewer than 5 sequences - skipped" > ../../per_gene/EOG091G06QP/infer_single_ML.stdout.txt
		touch raxml.skipped
	fi
        touch ../../per_gene/EOG091G06QP/EOG091G06QP.raxml.done
        
[33mJob counts:
	count	jobs
	1	infer_single_ML
	1[0m
[33m
        cd per_gene/EOG091G06QP
	count=$(cat ../../per_gene/EOG091G06QP/ALICUT_EOG091G06QP.clustalo.fasta | grep ">" | wc -l)
	if [ "$count" -gt 5 ]
        then
		RAxMLmodel=$(cat ../../per_gene/EOG091G06QP/EOG091G06QP.best_model | grep "Best" | cut -d ":" -f 2 | tr -d '[:space:]')
                if [ "$(ls -1 | grep "^RAxML" | wc -l)" -ne 0 ]
		then
			rm RAxML*
		fi
        	raxml -f a -T 2 -m PROTGAMMA$RAxMLmodel         	-p 12345 -x 12345 -# 100         	-s ../../per_gene/EOG091G06QP/ALICUT_EOG091G06QP.clustalo.fasta -n EOG091G06QP.clustalo.aln.ALICUT.$RAxMLmodel 		1> ../../per_gene/EOG091G06QP/infer_single_ML.stdout.txt 2> ../../per_gene/EOG091G06QP/infer_single_ML.stderr.txt
	else
		echo "fasta file per_gene/EOG091G06QP/ALICUT_EOG091G06QP.clustalo.fasta contains fewer than 5 sequences - skipped" > ../../per_gene/EOG091G06QP/infer_single_ML.stdout.txt
		touch raxml.skipped
	fi
        touch ../../per_gene/EOG091G06QP/EOG091G06QP.raxml.done
        [0m
[Sun Jul  5 22:19:12 2020]
Finished job 2972.
906 of 3292 steps (28%) done

[Sun Jul  5 22:19:12 2020]
rule get_outgroups:
    input: per_gene/EOG091G0D8I/EOG091G0D8I.ingroup.fasta
    output: per_gene/EOG091G0D8I/EOG091G0D8I.orthodb.fasta, per_gene/EOG091G0D8I/EOG091G0D8I.outgroup.fasta
    log: per_gene/EOG091G0D8I/get_outgroups.stdout.txt, per_gene/EOG091G0D8I/get_outgroups.stderr.txt
    jobid: 2973
    wildcards: BUSCO=EOG091G0D8I


        #download fastas from Orhtodb for BUSCO id
        for i in {1..5}
        do
             wget "http://www.orthodb.org/fasta?query=EOG091G0D8I&level=33208" -O per_gene/EOG091G0D8I/EOG091G0D8I.orthodb.fasta 1> per_gene/EOG091G0D8I/get_outgroups.stdout.txt 2> per_gene/EOG091G0D8I/get_outgroups.stderr.txt && break || echo -e "try again ($i)" && sleep 15
        done

	#This is quick an dirty for now and just takes the first protein if there is more than one for an outgroup taxon
        bash ../scripts/download_outgroups.sh taxids.txt per_gene/EOG091G0D8I/EOG091G0D8I.orthodb.fasta > per_gene/EOG091G0D8I/EOG091G0D8I.outgroup.fasta
        
[Sun Jul  5 22:19:13 2020]
Finished job 2973.
907 of 3292 steps (28%) done

[Sun Jul  5 22:19:13 2020]
rule join_groups:
    input: per_gene/EOG091G0D8I/EOG091G0D8I.ingroup.fasta, per_gene/EOG091G0D8I/EOG091G0D8I.outgroup.fasta
    output: per_gene/EOG091G0D8I/EOG091G0D8I.fasta
    jobid: 2310
    wildcards: BUSCO=EOG091G0D8I


        cat per_gene/EOG091G0D8I/EOG091G0D8I.ingroup.fasta per_gene/EOG091G0D8I/EOG091G0D8I.outgroup.fasta > per_gene/EOG091G0D8I/EOG091G0D8I.fasta
        
[Sun Jul  5 22:19:13 2020]
Finished job 2310.
908 of 3292 steps (28%) done

[Sun Jul  5 22:19:13 2020]
rule MSA:
    input: per_gene/EOG091G0D8I/EOG091G0D8I.fasta
    output: per_gene/EOG091G0D8I/EOG091G0D8I.clustalo.fasta
    log: per_gene/EOG091G0D8I/MSA.stdout.txt, per_gene/EOG091G0D8I/MSA.stderr.txt
    jobid: 1740
    wildcards: BUSCO=EOG091G0D8I
    threads: 2


        clustalo -i per_gene/EOG091G0D8I/EOG091G0D8I.fasta -o per_gene/EOG091G0D8I/EOG091G0D8I.clustalo.fasta --threads=2 1> per_gene/EOG091G0D8I/MSA.stdout.txt 2> per_gene/EOG091G0D8I/MSA.stderr.txt
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/d68c9691725a7401923680874285c430.simg
[Sun Jul  5 22:19:15 2020]
Finished job 1740.
909 of 3292 steps (28%) done

[Sun Jul  5 22:19:15 2020]
rule score_and_cut:
    input: per_gene/EOG091G0D8I/EOG091G0D8I.clustalo.fasta
    output: per_gene/EOG091G0D8I/ALICUT_EOG091G0D8I.clustalo.fasta
    jobid: 917
    wildcards: BUSCO=EOG091G0D8I
    threads: 2


        cd per_gene/EOG091G0D8I
        Aliscore.pl -N -r 200000000000000000 -i ../../per_gene/EOG091G0D8I/EOG091G0D8I.clustalo.fasta &> aliscore.log
        ALICUT.pl -s &> alicut.log
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/63c88c27a0fa300f57066b0ef65fefcb.simg
[Sun Jul  5 22:19:23 2020]
Finished job 2728.
910 of 3292 steps (28%) done

[Sun Jul  5 22:19:23 2020]
rule get_outgroups:
    input: per_gene/EOG091G0JI1/EOG091G0JI1.ingroup.fasta
    output: per_gene/EOG091G0JI1/EOG091G0JI1.orthodb.fasta, per_gene/EOG091G0JI1/EOG091G0JI1.outgroup.fasta
    log: per_gene/EOG091G0JI1/get_outgroups.stdout.txt, per_gene/EOG091G0JI1/get_outgroups.stderr.txt
    jobid: 2729
    wildcards: BUSCO=EOG091G0JI1


        #download fastas from Orhtodb for BUSCO id
        for i in {1..5}
        do
             wget "http://www.orthodb.org/fasta?query=EOG091G0JI1&level=33208" -O per_gene/EOG091G0JI1/EOG091G0JI1.orthodb.fasta 1> per_gene/EOG091G0JI1/get_outgroups.stdout.txt 2> per_gene/EOG091G0JI1/get_outgroups.stderr.txt && break || echo -e "try again ($i)" && sleep 15
        done

	#This is quick an dirty for now and just takes the first protein if there is more than one for an outgroup taxon
        bash ../scripts/download_outgroups.sh taxids.txt per_gene/EOG091G0JI1/EOG091G0JI1.orthodb.fasta > per_gene/EOG091G0JI1/EOG091G0JI1.outgroup.fasta
        
[Sun Jul  5 22:19:24 2020]
Finished job 2729.
911 of 3292 steps (28%) done

[Sun Jul  5 22:19:24 2020]
rule join_groups:
    input: per_gene/EOG091G0JI1/EOG091G0JI1.ingroup.fasta, per_gene/EOG091G0JI1/EOG091G0JI1.outgroup.fasta
    output: per_gene/EOG091G0JI1/EOG091G0JI1.fasta
    jobid: 2188
    wildcards: BUSCO=EOG091G0JI1


        cat per_gene/EOG091G0JI1/EOG091G0JI1.ingroup.fasta per_gene/EOG091G0JI1/EOG091G0JI1.outgroup.fasta > per_gene/EOG091G0JI1/EOG091G0JI1.fasta
        
[Sun Jul  5 22:19:24 2020]
Finished job 2188.
912 of 3292 steps (28%) done

[Sun Jul  5 22:19:24 2020]
rule MSA:
    input: per_gene/EOG091G0JI1/EOG091G0JI1.fasta
    output: per_gene/EOG091G0JI1/EOG091G0JI1.clustalo.fasta
    log: per_gene/EOG091G0JI1/MSA.stdout.txt, per_gene/EOG091G0JI1/MSA.stderr.txt
    jobid: 1496
    wildcards: BUSCO=EOG091G0JI1
    threads: 2


        clustalo -i per_gene/EOG091G0JI1/EOG091G0JI1.fasta -o per_gene/EOG091G0JI1/EOG091G0JI1.clustalo.fasta --threads=2 1> per_gene/EOG091G0JI1/MSA.stdout.txt 2> per_gene/EOG091G0JI1/MSA.stderr.txt
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/d68c9691725a7401923680874285c430.simg
[Sun Jul  5 22:19:25 2020]
Finished job 1496.
913 of 3292 steps (28%) done

[Sun Jul  5 22:19:25 2020]
rule score_and_cut:
    input: per_gene/EOG091G0JI1/EOG091G0JI1.clustalo.fasta
    output: per_gene/EOG091G0JI1/ALICUT_EOG091G0JI1.clustalo.fasta
    jobid: 673
    wildcards: BUSCO=EOG091G0JI1
    threads: 2


        cd per_gene/EOG091G0JI1
        Aliscore.pl -N -r 200000000000000000 -i ../../per_gene/EOG091G0JI1/EOG091G0JI1.clustalo.fasta &> aliscore.log
        ALICUT.pl -s &> alicut.log
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/63c88c27a0fa300f57066b0ef65fefcb.simg
[Sun Jul  5 22:19:28 2020]
Finished job 2550.
914 of 3292 steps (28%) done

[Sun Jul  5 22:19:28 2020]
rule get_outgroups:
    input: per_gene/EOG091G05OW/EOG091G05OW.ingroup.fasta
    output: per_gene/EOG091G05OW/EOG091G05OW.orthodb.fasta, per_gene/EOG091G05OW/EOG091G05OW.outgroup.fasta
    log: per_gene/EOG091G05OW/get_outgroups.stdout.txt, per_gene/EOG091G05OW/get_outgroups.stderr.txt
    jobid: 2551
    wildcards: BUSCO=EOG091G05OW


        #download fastas from Orhtodb for BUSCO id
        for i in {1..5}
        do
             wget "http://www.orthodb.org/fasta?query=EOG091G05OW&level=33208" -O per_gene/EOG091G05OW/EOG091G05OW.orthodb.fasta 1> per_gene/EOG091G05OW/get_outgroups.stdout.txt 2> per_gene/EOG091G05OW/get_outgroups.stderr.txt && break || echo -e "try again ($i)" && sleep 15
        done

	#This is quick an dirty for now and just takes the first protein if there is more than one for an outgroup taxon
        bash ../scripts/download_outgroups.sh taxids.txt per_gene/EOG091G05OW/EOG091G05OW.orthodb.fasta > per_gene/EOG091G05OW/EOG091G05OW.outgroup.fasta
        
[Sun Jul  5 22:19:30 2020]
Finished job 2551.
915 of 3292 steps (28%) done

[Sun Jul  5 22:19:30 2020]
rule join_groups:
    input: per_gene/EOG091G05OW/EOG091G05OW.ingroup.fasta, per_gene/EOG091G05OW/EOG091G05OW.outgroup.fasta
    output: per_gene/EOG091G05OW/EOG091G05OW.fasta
    jobid: 2099
    wildcards: BUSCO=EOG091G05OW


        cat per_gene/EOG091G05OW/EOG091G05OW.ingroup.fasta per_gene/EOG091G05OW/EOG091G05OW.outgroup.fasta > per_gene/EOG091G05OW/EOG091G05OW.fasta
        
[Sun Jul  5 22:19:30 2020]
Finished job 917.
916 of 3292 steps (28%) done

[Sun Jul  5 22:19:30 2020]
rule get_seqs:
    input: /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ingroup.txt, /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/outgroup.txt
    output: per_gene/EOG091G0DTP/EOG091G0DTP.ingroup.fasta
    log: per_gene/EOG091G0DTP/get_seqs.stdout.txt, per_gene/EOG091G0DTP/get_seqs.stderr.txt
    jobid: 2658
    wildcards: BUSCO=EOG091G0DTP
    threads: 2


	basedir=$(pwd)
        cd per_gene/EOG091G0DTP
        
        bash $basedir/../scripts/fetch_seqs.sh EOG091G0DTP /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ingroup.txt /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/outgroup.txt 1> ../../per_gene/EOG091G0DTP/get_seqs.stdout.txt 2> ../../per_gene/EOG091G0DTP/get_seqs.stderr.txt
	mv EOG091G0DTP.fasta $basedir/per_gene/EOG091G0DTP/EOG091G0DTP.ingroup.fasta
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/72476f9d9a5bd0627b4d721143a21354.simg

[Sun Jul  5 22:19:30 2020]
rule remove_empty:
    input: per_gene/EOG091G0D8I/ALICUT_EOG091G0D8I.clustalo.fasta
    output: per_gene/EOG091G0D8I/empty_check.done
    jobid: 1739
    wildcards: BUSCO=EOG091G0D8I


         if [ "$(cat per_gene/EOG091G0D8I/ALICUT_EOG091G0D8I.clustalo.fasta | grep -v ">" | sed 's/-//g' | grep "^$" | wc -l)" -gt 0 ]
         then
              cp per_gene/EOG091G0D8I/ALICUT_EOG091G0D8I.clustalo.fasta per_gene/EOG091G0D8I/ALICUT_EOG091G0D8I.clustalo.fasta.backup
              bash ../scripts/remove_empty.sh per_gene/EOG091G0D8I/ALICUT_EOG091G0D8I.clustalo.fasta.backup > per_gene/EOG091G0D8I/ALICUT_EOG091G0D8I.clustalo.fasta
         fi
         touch per_gene/EOG091G0D8I/empty_check.done
         
[Sun Jul  5 22:19:30 2020]
Finished job 2099.
917 of 3292 steps (28%) done
[Sun Jul  5 22:19:30 2020]
Finished job 1739.
918 of 3292 steps (28%) done

[Sun Jul  5 22:19:30 2020]
rule MSA:
    input: per_gene/EOG091G05OW/EOG091G05OW.fasta
    output: per_gene/EOG091G05OW/EOG091G05OW.clustalo.fasta
    log: per_gene/EOG091G05OW/MSA.stdout.txt, per_gene/EOG091G05OW/MSA.stderr.txt
    jobid: 1318
    wildcards: BUSCO=EOG091G05OW
    threads: 2


        clustalo -i per_gene/EOG091G05OW/EOG091G05OW.fasta -o per_gene/EOG091G05OW/EOG091G05OW.clustalo.fasta --threads=2 1> per_gene/EOG091G05OW/MSA.stdout.txt 2> per_gene/EOG091G05OW/MSA.stderr.txt
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/d68c9691725a7401923680874285c430.simg
[Sun Jul  5 22:19:32 2020]
Finished job 1318.
919 of 3292 steps (28%) done

[Sun Jul  5 22:19:32 2020]
rule score_and_cut:
    input: per_gene/EOG091G05OW/EOG091G05OW.clustalo.fasta
    output: per_gene/EOG091G05OW/ALICUT_EOG091G05OW.clustalo.fasta
    jobid: 495
    wildcards: BUSCO=EOG091G05OW
    threads: 2


        cd per_gene/EOG091G05OW
        Aliscore.pl -N -r 200000000000000000 -i ../../per_gene/EOG091G05OW/EOG091G05OW.clustalo.fasta &> aliscore.log
        ALICUT.pl -s &> alicut.log
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/63c88c27a0fa300f57066b0ef65fefcb.simg
[Sun Jul  5 22:19:34 2020]
Finished job 673.
920 of 3292 steps (28%) done

[Sun Jul  5 22:19:34 2020]
rule find_best_model:
    input: per_gene/EOG091G0D8I/ALICUT_EOG091G0D8I.clustalo.fasta, per_gene/EOG091G0D8I/empty_check.done
    output: per_gene/EOG091G0D8I/EOG091G0D8I.best_model
    log: per_gene/EOG091G0D8I/find_best_model.stderr.txt
    jobid: 916
    wildcards: BUSCO=EOG091G0D8I
    threads: 2


        cd per_gene/EOG091G0D8I
        if [ ! -d find_best_model ]
        then
            mkdir find_best_model
        fi
        cd find_best_model
        ln -s ../../../per_gene/EOG091G0D8I/ALICUT_EOG091G0D8I.clustalo.fasta EOG091G0D8I.fasta
        ProteinModelSelection.pl EOG091G0D8I.fasta 1> ../../../per_gene/EOG091G0D8I/EOG091G0D8I.best_model 2> ../../../per_gene/EOG091G0D8I/find_best_model.stderr.txt
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/c0c09ee657b1e27f2c5687e0e9aa8d70.simg
[Sun Jul  5 22:19:39 2020]
Finished job 488.
921 of 3292 steps (28%) done

[Sun Jul  5 22:19:39 2020]
rule infer_single_ML:
    input: per_gene/EOG091G05NK/EOG091G05NK.best_model, per_gene/EOG091G05NK/ALICUT_EOG091G05NK.clustalo.fasta
    output: per_gene/EOG091G05NK/EOG091G05NK.raxml.done
    log: per_gene/EOG091G05NK/infer_single_ML.stdout.txt, per_gene/EOG091G05NK/infer_single_ML.stderr.txt
    jobid: 38
    wildcards: BUSCO=EOG091G05NK
    threads: 2


        cd per_gene/EOG091G05NK
	count=$(cat ../../per_gene/EOG091G05NK/ALICUT_EOG091G05NK.clustalo.fasta | grep ">" | wc -l)
	if [ "$count" -gt 5 ]
        then
		RAxMLmodel=$(cat ../../per_gene/EOG091G05NK/EOG091G05NK.best_model | grep "Best" | cut -d ":" -f 2 | tr -d '[:space:]')
                if [ "$(ls -1 | grep "^RAxML" | wc -l)" -ne 0 ]
		then
			rm RAxML*
		fi
        	raxml -f a -T 2 -m PROTGAMMA$RAxMLmodel         	-p 12345 -x 12345 -# 100         	-s ../../per_gene/EOG091G05NK/ALICUT_EOG091G05NK.clustalo.fasta -n EOG091G05NK.clustalo.aln.ALICUT.$RAxMLmodel 		1> ../../per_gene/EOG091G05NK/infer_single_ML.stdout.txt 2> ../../per_gene/EOG091G05NK/infer_single_ML.stderr.txt
	else
		echo "fasta file per_gene/EOG091G05NK/ALICUT_EOG091G05NK.clustalo.fasta contains fewer than 5 sequences - skipped" > ../../per_gene/EOG091G05NK/infer_single_ML.stdout.txt
		touch raxml.skipped
	fi
        touch ../../per_gene/EOG091G05NK/EOG091G05NK.raxml.done
        
[33mJob counts:
	count	jobs
	1	infer_single_ML
	1[0m
[33m
        cd per_gene/EOG091G05NK
	count=$(cat ../../per_gene/EOG091G05NK/ALICUT_EOG091G05NK.clustalo.fasta | grep ">" | wc -l)
	if [ "$count" -gt 5 ]
        then
		RAxMLmodel=$(cat ../../per_gene/EOG091G05NK/EOG091G05NK.best_model | grep "Best" | cut -d ":" -f 2 | tr -d '[:space:]')
                if [ "$(ls -1 | grep "^RAxML" | wc -l)" -ne 0 ]
		then
			rm RAxML*
		fi
        	raxml -f a -T 2 -m PROTGAMMA$RAxMLmodel         	-p 12345 -x 12345 -# 100         	-s ../../per_gene/EOG091G05NK/ALICUT_EOG091G05NK.clustalo.fasta -n EOG091G05NK.clustalo.aln.ALICUT.$RAxMLmodel 		1> ../../per_gene/EOG091G05NK/infer_single_ML.stdout.txt 2> ../../per_gene/EOG091G05NK/infer_single_ML.stderr.txt
	else
		echo "fasta file per_gene/EOG091G05NK/ALICUT_EOG091G05NK.clustalo.fasta contains fewer than 5 sequences - skipped" > ../../per_gene/EOG091G05NK/infer_single_ML.stdout.txt
		touch raxml.skipped
	fi
        touch ../../per_gene/EOG091G05NK/EOG091G05NK.raxml.done
        [0m
[Sun Jul  5 22:19:41 2020]
Finished job 495.
922 of 3292 steps (28%) done

[Sun Jul  5 22:19:41 2020]
rule remove_empty:
    input: per_gene/EOG091G05OW/ALICUT_EOG091G05OW.clustalo.fasta
    output: per_gene/EOG091G05OW/empty_check.done
    jobid: 1317
    wildcards: BUSCO=EOG091G05OW


         if [ "$(cat per_gene/EOG091G05OW/ALICUT_EOG091G05OW.clustalo.fasta | grep -v ">" | sed 's/-//g' | grep "^$" | wc -l)" -gt 0 ]
         then
              cp per_gene/EOG091G05OW/ALICUT_EOG091G05OW.clustalo.fasta per_gene/EOG091G05OW/ALICUT_EOG091G05OW.clustalo.fasta.backup
              bash ../scripts/remove_empty.sh per_gene/EOG091G05OW/ALICUT_EOG091G05OW.clustalo.fasta.backup > per_gene/EOG091G05OW/ALICUT_EOG091G05OW.clustalo.fasta
         fi
         touch per_gene/EOG091G05OW/empty_check.done
         

[Sun Jul  5 22:19:41 2020]
rule remove_empty:
    input: per_gene/EOG091G0JI1/ALICUT_EOG091G0JI1.clustalo.fasta
    output: per_gene/EOG091G0JI1/empty_check.done
    jobid: 1495
    wildcards: BUSCO=EOG091G0JI1


         if [ "$(cat per_gene/EOG091G0JI1/ALICUT_EOG091G0JI1.clustalo.fasta | grep -v ">" | sed 's/-//g' | grep "^$" | wc -l)" -gt 0 ]
         then
              cp per_gene/EOG091G0JI1/ALICUT_EOG091G0JI1.clustalo.fasta per_gene/EOG091G0JI1/ALICUT_EOG091G0JI1.clustalo.fasta.backup
              bash ../scripts/remove_empty.sh per_gene/EOG091G0JI1/ALICUT_EOG091G0JI1.clustalo.fasta.backup > per_gene/EOG091G0JI1/ALICUT_EOG091G0JI1.clustalo.fasta
         fi
         touch per_gene/EOG091G0JI1/empty_check.done
         
[Sun Jul  5 22:19:41 2020]
Finished job 1317.
923 of 3292 steps (28%) done
[Sun Jul  5 22:19:41 2020]
Finished job 1495.
924 of 3292 steps (28%) done

[Sun Jul  5 22:19:41 2020]
rule find_best_model:
    input: per_gene/EOG091G05OW/ALICUT_EOG091G05OW.clustalo.fasta, per_gene/EOG091G05OW/empty_check.done
    output: per_gene/EOG091G05OW/EOG091G05OW.best_model
    log: per_gene/EOG091G05OW/find_best_model.stderr.txt
    jobid: 494
    wildcards: BUSCO=EOG091G05OW
    threads: 2


        cd per_gene/EOG091G05OW
        if [ ! -d find_best_model ]
        then
            mkdir find_best_model
        fi
        cd find_best_model
        ln -s ../../../per_gene/EOG091G05OW/ALICUT_EOG091G05OW.clustalo.fasta EOG091G05OW.fasta
        ProteinModelSelection.pl EOG091G05OW.fasta 1> ../../../per_gene/EOG091G05OW/EOG091G05OW.best_model 2> ../../../per_gene/EOG091G05OW/find_best_model.stderr.txt
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/c0c09ee657b1e27f2c5687e0e9aa8d70.simg
[Sun Jul  5 22:19:49 2020]
Finished job 2658.
925 of 3292 steps (28%) done

[Sun Jul  5 22:19:49 2020]
rule get_outgroups:
    input: per_gene/EOG091G0DTP/EOG091G0DTP.ingroup.fasta
    output: per_gene/EOG091G0DTP/EOG091G0DTP.orthodb.fasta, per_gene/EOG091G0DTP/EOG091G0DTP.outgroup.fasta
    log: per_gene/EOG091G0DTP/get_outgroups.stdout.txt, per_gene/EOG091G0DTP/get_outgroups.stderr.txt
    jobid: 2659
    wildcards: BUSCO=EOG091G0DTP


        #download fastas from Orhtodb for BUSCO id
        for i in {1..5}
        do
             wget "http://www.orthodb.org/fasta?query=EOG091G0DTP&level=33208" -O per_gene/EOG091G0DTP/EOG091G0DTP.orthodb.fasta 1> per_gene/EOG091G0DTP/get_outgroups.stdout.txt 2> per_gene/EOG091G0DTP/get_outgroups.stderr.txt && break || echo -e "try again ($i)" && sleep 15
        done

	#This is quick an dirty for now and just takes the first protein if there is more than one for an outgroup taxon
        bash ../scripts/download_outgroups.sh taxids.txt per_gene/EOG091G0DTP/EOG091G0DTP.orthodb.fasta > per_gene/EOG091G0DTP/EOG091G0DTP.outgroup.fasta
        
[Sun Jul  5 22:19:50 2020]
Finished job 2659.
926 of 3292 steps (28%) done

[Sun Jul  5 22:19:50 2020]
rule join_groups:
    input: per_gene/EOG091G0DTP/EOG091G0DTP.ingroup.fasta, per_gene/EOG091G0DTP/EOG091G0DTP.outgroup.fasta
    output: per_gene/EOG091G0DTP/EOG091G0DTP.fasta
    jobid: 2153
    wildcards: BUSCO=EOG091G0DTP


        cat per_gene/EOG091G0DTP/EOG091G0DTP.ingroup.fasta per_gene/EOG091G0DTP/EOG091G0DTP.outgroup.fasta > per_gene/EOG091G0DTP/EOG091G0DTP.fasta
        
[Sun Jul  5 22:19:50 2020]
Finished job 2153.
927 of 3292 steps (28%) done

[Sun Jul  5 22:19:50 2020]
rule MSA:
    input: per_gene/EOG091G0DTP/EOG091G0DTP.fasta
    output: per_gene/EOG091G0DTP/EOG091G0DTP.clustalo.fasta
    log: per_gene/EOG091G0DTP/MSA.stdout.txt, per_gene/EOG091G0DTP/MSA.stderr.txt
    jobid: 1426
    wildcards: BUSCO=EOG091G0DTP
    threads: 2


        clustalo -i per_gene/EOG091G0DTP/EOG091G0DTP.fasta -o per_gene/EOG091G0DTP/EOG091G0DTP.clustalo.fasta --threads=2 1> per_gene/EOG091G0DTP/MSA.stdout.txt 2> per_gene/EOG091G0DTP/MSA.stderr.txt
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/d68c9691725a7401923680874285c430.simg
[Sun Jul  5 22:19:51 2020]
Finished job 1426.
928 of 3292 steps (28%) done

[Sun Jul  5 22:19:51 2020]
rule score_and_cut:
    input: per_gene/EOG091G0DTP/EOG091G0DTP.clustalo.fasta
    output: per_gene/EOG091G0DTP/ALICUT_EOG091G0DTP.clustalo.fasta
    jobid: 603
    wildcards: BUSCO=EOG091G0DTP
    threads: 2


        cd per_gene/EOG091G0DTP
        Aliscore.pl -N -r 200000000000000000 -i ../../per_gene/EOG091G0DTP/EOG091G0DTP.clustalo.fasta &> aliscore.log
        ALICUT.pl -s &> alicut.log
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/63c88c27a0fa300f57066b0ef65fefcb.simg
[Sun Jul  5 22:19:52 2020]
Finished job 1078.
929 of 3292 steps (28%) done

[Sun Jul  5 22:19:52 2020]
rule infer_single_ML:
    input: per_gene/EOG091G04LC/EOG091G04LC.best_model, per_gene/EOG091G04LC/ALICUT_EOG091G04LC.clustalo.fasta
    output: per_gene/EOG091G04LC/EOG091G04LC.raxml.done
    log: per_gene/EOG091G04LC/infer_single_ML.stdout.txt, per_gene/EOG091G04LC/infer_single_ML.stderr.txt
    jobid: 333
    wildcards: BUSCO=EOG091G04LC
    threads: 2


        cd per_gene/EOG091G04LC
	count=$(cat ../../per_gene/EOG091G04LC/ALICUT_EOG091G04LC.clustalo.fasta | grep ">" | wc -l)
	if [ "$count" -gt 5 ]
        then
		RAxMLmodel=$(cat ../../per_gene/EOG091G04LC/EOG091G04LC.best_model | grep "Best" | cut -d ":" -f 2 | tr -d '[:space:]')
                if [ "$(ls -1 | grep "^RAxML" | wc -l)" -ne 0 ]
		then
			rm RAxML*
		fi
        	raxml -f a -T 2 -m PROTGAMMA$RAxMLmodel         	-p 12345 -x 12345 -# 100         	-s ../../per_gene/EOG091G04LC/ALICUT_EOG091G04LC.clustalo.fasta -n EOG091G04LC.clustalo.aln.ALICUT.$RAxMLmodel 		1> ../../per_gene/EOG091G04LC/infer_single_ML.stdout.txt 2> ../../per_gene/EOG091G04LC/infer_single_ML.stderr.txt
	else
		echo "fasta file per_gene/EOG091G04LC/ALICUT_EOG091G04LC.clustalo.fasta contains fewer than 5 sequences - skipped" > ../../per_gene/EOG091G04LC/infer_single_ML.stdout.txt
		touch raxml.skipped
	fi
        touch ../../per_gene/EOG091G04LC/EOG091G04LC.raxml.done
        
[33mJob counts:
	count	jobs
	1	infer_single_ML
	1[0m
[33m
        cd per_gene/EOG091G04LC
	count=$(cat ../../per_gene/EOG091G04LC/ALICUT_EOG091G04LC.clustalo.fasta | grep ">" | wc -l)
	if [ "$count" -gt 5 ]
        then
		RAxMLmodel=$(cat ../../per_gene/EOG091G04LC/EOG091G04LC.best_model | grep "Best" | cut -d ":" -f 2 | tr -d '[:space:]')
                if [ "$(ls -1 | grep "^RAxML" | wc -l)" -ne 0 ]
		then
			rm RAxML*
		fi
        	raxml -f a -T 2 -m PROTGAMMA$RAxMLmodel         	-p 12345 -x 12345 -# 100         	-s ../../per_gene/EOG091G04LC/ALICUT_EOG091G04LC.clustalo.fasta -n EOG091G04LC.clustalo.aln.ALICUT.$RAxMLmodel 		1> ../../per_gene/EOG091G04LC/infer_single_ML.stdout.txt 2> ../../per_gene/EOG091G04LC/infer_single_ML.stderr.txt
	else
		echo "fasta file per_gene/EOG091G04LC/ALICUT_EOG091G04LC.clustalo.fasta contains fewer than 5 sequences - skipped" > ../../per_gene/EOG091G04LC/infer_single_ML.stdout.txt
		touch raxml.skipped
	fi
        touch ../../per_gene/EOG091G04LC/EOG091G04LC.raxml.done
        [0m
[Sun Jul  5 22:20:02 2020]
Finished job 603.
930 of 3292 steps (28%) done

[Sun Jul  5 22:20:02 2020]
rule remove_empty:
    input: per_gene/EOG091G0DTP/ALICUT_EOG091G0DTP.clustalo.fasta
    output: per_gene/EOG091G0DTP/empty_check.done
    jobid: 1425
    wildcards: BUSCO=EOG091G0DTP


         if [ "$(cat per_gene/EOG091G0DTP/ALICUT_EOG091G0DTP.clustalo.fasta | grep -v ">" | sed 's/-//g' | grep "^$" | wc -l)" -gt 0 ]
         then
              cp per_gene/EOG091G0DTP/ALICUT_EOG091G0DTP.clustalo.fasta per_gene/EOG091G0DTP/ALICUT_EOG091G0DTP.clustalo.fasta.backup
              bash ../scripts/remove_empty.sh per_gene/EOG091G0DTP/ALICUT_EOG091G0DTP.clustalo.fasta.backup > per_gene/EOG091G0DTP/ALICUT_EOG091G0DTP.clustalo.fasta
         fi
         touch per_gene/EOG091G0DTP/empty_check.done
         
[Sun Jul  5 22:20:02 2020]
Finished job 1425.
931 of 3292 steps (28%) done

[Sun Jul  5 22:20:02 2020]
rule find_best_model:
    input: per_gene/EOG091G0DTP/ALICUT_EOG091G0DTP.clustalo.fasta, per_gene/EOG091G0DTP/empty_check.done
    output: per_gene/EOG091G0DTP/EOG091G0DTP.best_model
    log: per_gene/EOG091G0DTP/find_best_model.stderr.txt
    jobid: 602
    wildcards: BUSCO=EOG091G0DTP
    threads: 2


        cd per_gene/EOG091G0DTP
        if [ ! -d find_best_model ]
        then
            mkdir find_best_model
        fi
        cd find_best_model
        ln -s ../../../per_gene/EOG091G0DTP/ALICUT_EOG091G0DTP.clustalo.fasta EOG091G0DTP.fasta
        ProteinModelSelection.pl EOG091G0DTP.fasta 1> ../../../per_gene/EOG091G0DTP/EOG091G0DTP.best_model 2> ../../../per_gene/EOG091G0DTP/find_best_model.stderr.txt
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/c0c09ee657b1e27f2c5687e0e9aa8d70.simg
[Sun Jul  5 22:20:15 2020]
Finished job 916.
932 of 3292 steps (28%) done

[Sun Jul  5 22:20:15 2020]
rule infer_single_ML:
    input: per_gene/EOG091G0D8I/EOG091G0D8I.best_model, per_gene/EOG091G0D8I/ALICUT_EOG091G0D8I.clustalo.fasta
    output: per_gene/EOG091G0D8I/EOG091G0D8I.raxml.done
    log: per_gene/EOG091G0D8I/infer_single_ML.stdout.txt, per_gene/EOG091G0D8I/infer_single_ML.stderr.txt
    jobid: 252
    wildcards: BUSCO=EOG091G0D8I
    threads: 2


        cd per_gene/EOG091G0D8I
	count=$(cat ../../per_gene/EOG091G0D8I/ALICUT_EOG091G0D8I.clustalo.fasta | grep ">" | wc -l)
	if [ "$count" -gt 5 ]
        then
		RAxMLmodel=$(cat ../../per_gene/EOG091G0D8I/EOG091G0D8I.best_model | grep "Best" | cut -d ":" -f 2 | tr -d '[:space:]')
                if [ "$(ls -1 | grep "^RAxML" | wc -l)" -ne 0 ]
		then
			rm RAxML*
		fi
        	raxml -f a -T 2 -m PROTGAMMA$RAxMLmodel         	-p 12345 -x 12345 -# 100         	-s ../../per_gene/EOG091G0D8I/ALICUT_EOG091G0D8I.clustalo.fasta -n EOG091G0D8I.clustalo.aln.ALICUT.$RAxMLmodel 		1> ../../per_gene/EOG091G0D8I/infer_single_ML.stdout.txt 2> ../../per_gene/EOG091G0D8I/infer_single_ML.stderr.txt
	else
		echo "fasta file per_gene/EOG091G0D8I/ALICUT_EOG091G0D8I.clustalo.fasta contains fewer than 5 sequences - skipped" > ../../per_gene/EOG091G0D8I/infer_single_ML.stdout.txt
		touch raxml.skipped
	fi
        touch ../../per_gene/EOG091G0D8I/EOG091G0D8I.raxml.done
        
[33mJob counts:
	count	jobs
	1	infer_single_ML
	1[0m
[33m
        cd per_gene/EOG091G0D8I
	count=$(cat ../../per_gene/EOG091G0D8I/ALICUT_EOG091G0D8I.clustalo.fasta | grep ">" | wc -l)
	if [ "$count" -gt 5 ]
        then
		RAxMLmodel=$(cat ../../per_gene/EOG091G0D8I/EOG091G0D8I.best_model | grep "Best" | cut -d ":" -f 2 | tr -d '[:space:]')
                if [ "$(ls -1 | grep "^RAxML" | wc -l)" -ne 0 ]
		then
			rm RAxML*
		fi
        	raxml -f a -T 2 -m PROTGAMMA$RAxMLmodel         	-p 12345 -x 12345 -# 100         	-s ../../per_gene/EOG091G0D8I/ALICUT_EOG091G0D8I.clustalo.fasta -n EOG091G0D8I.clustalo.aln.ALICUT.$RAxMLmodel 		1> ../../per_gene/EOG091G0D8I/infer_single_ML.stdout.txt 2> ../../per_gene/EOG091G0D8I/infer_single_ML.stderr.txt
	else
		echo "fasta file per_gene/EOG091G0D8I/ALICUT_EOG091G0D8I.clustalo.fasta contains fewer than 5 sequences - skipped" > ../../per_gene/EOG091G0D8I/infer_single_ML.stdout.txt
		touch raxml.skipped
	fi
        touch ../../per_gene/EOG091G0D8I/EOG091G0D8I.raxml.done
        [0m
[Sun Jul  5 22:20:28 2020]
Finished job 239.
933 of 3292 steps (28%) done

[Sun Jul  5 22:20:28 2020]
rule find_best_model:
    input: per_gene/EOG091G0JI1/ALICUT_EOG091G0JI1.clustalo.fasta, per_gene/EOG091G0JI1/empty_check.done
    output: per_gene/EOG091G0JI1/EOG091G0JI1.best_model
    log: per_gene/EOG091G0JI1/find_best_model.stderr.txt
    jobid: 672
    wildcards: BUSCO=EOG091G0JI1
    threads: 2


        cd per_gene/EOG091G0JI1
        if [ ! -d find_best_model ]
        then
            mkdir find_best_model
        fi
        cd find_best_model
        ln -s ../../../per_gene/EOG091G0JI1/ALICUT_EOG091G0JI1.clustalo.fasta EOG091G0JI1.fasta
        ProteinModelSelection.pl EOG091G0JI1.fasta 1> ../../../per_gene/EOG091G0JI1/EOG091G0JI1.best_model 2> ../../../per_gene/EOG091G0JI1/find_best_model.stderr.txt
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/c0c09ee657b1e27f2c5687e0e9aa8d70.simg
[Sun Jul  5 22:20:44 2020]
Finished job 410.
934 of 3292 steps (28%) done

[Sun Jul  5 22:20:44 2020]
rule get_seqs:
    input: /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ingroup.txt, /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/outgroup.txt
    output: per_gene/EOG091G0KRB/EOG091G0KRB.ingroup.fasta
    log: per_gene/EOG091G0KRB/get_seqs.stdout.txt, per_gene/EOG091G0KRB/get_seqs.stderr.txt
    jobid: 2740
    wildcards: BUSCO=EOG091G0KRB
    threads: 2


	basedir=$(pwd)
        cd per_gene/EOG091G0KRB
        
        bash $basedir/../scripts/fetch_seqs.sh EOG091G0KRB /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ingroup.txt /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/outgroup.txt 1> ../../per_gene/EOG091G0KRB/get_seqs.stdout.txt 2> ../../per_gene/EOG091G0KRB/get_seqs.stderr.txt
	mv EOG091G0KRB.fasta $basedir/per_gene/EOG091G0KRB/EOG091G0KRB.ingroup.fasta
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/72476f9d9a5bd0627b4d721143a21354.simg
[Sun Jul  5 22:20:46 2020]
Finished job 602.
935 of 3292 steps (28%) done

[Sun Jul  5 22:20:46 2020]
rule infer_single_ML:
    input: per_gene/EOG091G0DTP/EOG091G0DTP.best_model, per_gene/EOG091G0DTP/ALICUT_EOG091G0DTP.clustalo.fasta
    output: per_gene/EOG091G0DTP/EOG091G0DTP.raxml.done
    log: per_gene/EOG091G0DTP/infer_single_ML.stdout.txt, per_gene/EOG091G0DTP/infer_single_ML.stderr.txt
    jobid: 95
    wildcards: BUSCO=EOG091G0DTP
    threads: 2


        cd per_gene/EOG091G0DTP
	count=$(cat ../../per_gene/EOG091G0DTP/ALICUT_EOG091G0DTP.clustalo.fasta | grep ">" | wc -l)
	if [ "$count" -gt 5 ]
        then
		RAxMLmodel=$(cat ../../per_gene/EOG091G0DTP/EOG091G0DTP.best_model | grep "Best" | cut -d ":" -f 2 | tr -d '[:space:]')
                if [ "$(ls -1 | grep "^RAxML" | wc -l)" -ne 0 ]
		then
			rm RAxML*
		fi
        	raxml -f a -T 2 -m PROTGAMMA$RAxMLmodel         	-p 12345 -x 12345 -# 100         	-s ../../per_gene/EOG091G0DTP/ALICUT_EOG091G0DTP.clustalo.fasta -n EOG091G0DTP.clustalo.aln.ALICUT.$RAxMLmodel 		1> ../../per_gene/EOG091G0DTP/infer_single_ML.stdout.txt 2> ../../per_gene/EOG091G0DTP/infer_single_ML.stderr.txt
	else
		echo "fasta file per_gene/EOG091G0DTP/ALICUT_EOG091G0DTP.clustalo.fasta contains fewer than 5 sequences - skipped" > ../../per_gene/EOG091G0DTP/infer_single_ML.stdout.txt
		touch raxml.skipped
	fi
        touch ../../per_gene/EOG091G0DTP/EOG091G0DTP.raxml.done
        
[33mJob counts:
	count	jobs
	1	infer_single_ML
	1[0m
[33m
        cd per_gene/EOG091G0DTP
	count=$(cat ../../per_gene/EOG091G0DTP/ALICUT_EOG091G0DTP.clustalo.fasta | grep ">" | wc -l)
	if [ "$count" -gt 5 ]
        then
		RAxMLmodel=$(cat ../../per_gene/EOG091G0DTP/EOG091G0DTP.best_model | grep "Best" | cut -d ":" -f 2 | tr -d '[:space:]')
                if [ "$(ls -1 | grep "^RAxML" | wc -l)" -ne 0 ]
		then
			rm RAxML*
		fi
        	raxml -f a -T 2 -m PROTGAMMA$RAxMLmodel         	-p 12345 -x 12345 -# 100         	-s ../../per_gene/EOG091G0DTP/ALICUT_EOG091G0DTP.clustalo.fasta -n EOG091G0DTP.clustalo.aln.ALICUT.$RAxMLmodel 		1> ../../per_gene/EOG091G0DTP/infer_single_ML.stdout.txt 2> ../../per_gene/EOG091G0DTP/infer_single_ML.stderr.txt
	else
		echo "fasta file per_gene/EOG091G0DTP/ALICUT_EOG091G0DTP.clustalo.fasta contains fewer than 5 sequences - skipped" > ../../per_gene/EOG091G0DTP/infer_single_ML.stdout.txt
		touch raxml.skipped
	fi
        touch ../../per_gene/EOG091G0DTP/EOG091G0DTP.raxml.done
        [0m
[Sun Jul  5 22:20:53 2020]
Finished job 494.
936 of 3292 steps (28%) done

[Sun Jul  5 22:20:53 2020]
rule infer_single_ML:
    input: per_gene/EOG091G05OW/EOG091G05OW.best_model, per_gene/EOG091G05OW/ALICUT_EOG091G05OW.clustalo.fasta
    output: per_gene/EOG091G05OW/EOG091G05OW.raxml.done
    log: per_gene/EOG091G05OW/infer_single_ML.stdout.txt, per_gene/EOG091G05OW/infer_single_ML.stderr.txt
    jobid: 41
    wildcards: BUSCO=EOG091G05OW
    threads: 2


        cd per_gene/EOG091G05OW
	count=$(cat ../../per_gene/EOG091G05OW/ALICUT_EOG091G05OW.clustalo.fasta | grep ">" | wc -l)
	if [ "$count" -gt 5 ]
        then
		RAxMLmodel=$(cat ../../per_gene/EOG091G05OW/EOG091G05OW.best_model | grep "Best" | cut -d ":" -f 2 | tr -d '[:space:]')
                if [ "$(ls -1 | grep "^RAxML" | wc -l)" -ne 0 ]
		then
			rm RAxML*
		fi
        	raxml -f a -T 2 -m PROTGAMMA$RAxMLmodel         	-p 12345 -x 12345 -# 100         	-s ../../per_gene/EOG091G05OW/ALICUT_EOG091G05OW.clustalo.fasta -n EOG091G05OW.clustalo.aln.ALICUT.$RAxMLmodel 		1> ../../per_gene/EOG091G05OW/infer_single_ML.stdout.txt 2> ../../per_gene/EOG091G05OW/infer_single_ML.stderr.txt
	else
		echo "fasta file per_gene/EOG091G05OW/ALICUT_EOG091G05OW.clustalo.fasta contains fewer than 5 sequences - skipped" > ../../per_gene/EOG091G05OW/infer_single_ML.stdout.txt
		touch raxml.skipped
	fi
        touch ../../per_gene/EOG091G05OW/EOG091G05OW.raxml.done
        
[33mJob counts:
	count	jobs
	1	infer_single_ML
	1[0m
[33m
        cd per_gene/EOG091G05OW
	count=$(cat ../../per_gene/EOG091G05OW/ALICUT_EOG091G05OW.clustalo.fasta | grep ">" | wc -l)
	if [ "$count" -gt 5 ]
        then
		RAxMLmodel=$(cat ../../per_gene/EOG091G05OW/EOG091G05OW.best_model | grep "Best" | cut -d ":" -f 2 | tr -d '[:space:]')
                if [ "$(ls -1 | grep "^RAxML" | wc -l)" -ne 0 ]
		then
			rm RAxML*
		fi
        	raxml -f a -T 2 -m PROTGAMMA$RAxMLmodel         	-p 12345 -x 12345 -# 100         	-s ../../per_gene/EOG091G05OW/ALICUT_EOG091G05OW.clustalo.fasta -n EOG091G05OW.clustalo.aln.ALICUT.$RAxMLmodel 		1> ../../per_gene/EOG091G05OW/infer_single_ML.stdout.txt 2> ../../per_gene/EOG091G05OW/infer_single_ML.stderr.txt
	else
		echo "fasta file per_gene/EOG091G05OW/ALICUT_EOG091G05OW.clustalo.fasta contains fewer than 5 sequences - skipped" > ../../per_gene/EOG091G05OW/infer_single_ML.stdout.txt
		touch raxml.skipped
	fi
        touch ../../per_gene/EOG091G05OW/EOG091G05OW.raxml.done
        [0m
[Sun Jul  5 22:20:58 2020]
Finished job 672.
937 of 3292 steps (28%) done

[Sun Jul  5 22:20:58 2020]
rule infer_single_ML:
    input: per_gene/EOG091G0JI1/EOG091G0JI1.best_model, per_gene/EOG091G0JI1/ALICUT_EOG091G0JI1.clustalo.fasta
    output: per_gene/EOG091G0JI1/EOG091G0JI1.raxml.done
    log: per_gene/EOG091G0JI1/infer_single_ML.stdout.txt, per_gene/EOG091G0JI1/infer_single_ML.stderr.txt
    jobid: 130
    wildcards: BUSCO=EOG091G0JI1
    threads: 2


        cd per_gene/EOG091G0JI1
	count=$(cat ../../per_gene/EOG091G0JI1/ALICUT_EOG091G0JI1.clustalo.fasta | grep ">" | wc -l)
	if [ "$count" -gt 5 ]
        then
		RAxMLmodel=$(cat ../../per_gene/EOG091G0JI1/EOG091G0JI1.best_model | grep "Best" | cut -d ":" -f 2 | tr -d '[:space:]')
                if [ "$(ls -1 | grep "^RAxML" | wc -l)" -ne 0 ]
		then
			rm RAxML*
		fi
        	raxml -f a -T 2 -m PROTGAMMA$RAxMLmodel         	-p 12345 -x 12345 -# 100         	-s ../../per_gene/EOG091G0JI1/ALICUT_EOG091G0JI1.clustalo.fasta -n EOG091G0JI1.clustalo.aln.ALICUT.$RAxMLmodel 		1> ../../per_gene/EOG091G0JI1/infer_single_ML.stdout.txt 2> ../../per_gene/EOG091G0JI1/infer_single_ML.stderr.txt
	else
		echo "fasta file per_gene/EOG091G0JI1/ALICUT_EOG091G0JI1.clustalo.fasta contains fewer than 5 sequences - skipped" > ../../per_gene/EOG091G0JI1/infer_single_ML.stdout.txt
		touch raxml.skipped
	fi
        touch ../../per_gene/EOG091G0JI1/EOG091G0JI1.raxml.done
        
[33mJob counts:
	count	jobs
	1	infer_single_ML
	1[0m
[33m
        cd per_gene/EOG091G0JI1
	count=$(cat ../../per_gene/EOG091G0JI1/ALICUT_EOG091G0JI1.clustalo.fasta | grep ">" | wc -l)
	if [ "$count" -gt 5 ]
        then
		RAxMLmodel=$(cat ../../per_gene/EOG091G0JI1/EOG091G0JI1.best_model | grep "Best" | cut -d ":" -f 2 | tr -d '[:space:]')
                if [ "$(ls -1 | grep "^RAxML" | wc -l)" -ne 0 ]
		then
			rm RAxML*
		fi
        	raxml -f a -T 2 -m PROTGAMMA$RAxMLmodel         	-p 12345 -x 12345 -# 100         	-s ../../per_gene/EOG091G0JI1/ALICUT_EOG091G0JI1.clustalo.fasta -n EOG091G0JI1.clustalo.aln.ALICUT.$RAxMLmodel 		1> ../../per_gene/EOG091G0JI1/infer_single_ML.stdout.txt 2> ../../per_gene/EOG091G0JI1/infer_single_ML.stderr.txt
	else
		echo "fasta file per_gene/EOG091G0JI1/ALICUT_EOG091G0JI1.clustalo.fasta contains fewer than 5 sequences - skipped" > ../../per_gene/EOG091G0JI1/infer_single_ML.stdout.txt
		touch raxml.skipped
	fi
        touch ../../per_gene/EOG091G0JI1/EOG091G0JI1.raxml.done
        [0m
[Sun Jul  5 22:21:00 2020]
Finished job 2740.
938 of 3292 steps (28%) done

[Sun Jul  5 22:21:00 2020]
rule get_outgroups:
    input: per_gene/EOG091G0KRB/EOG091G0KRB.ingroup.fasta
    output: per_gene/EOG091G0KRB/EOG091G0KRB.orthodb.fasta, per_gene/EOG091G0KRB/EOG091G0KRB.outgroup.fasta
    log: per_gene/EOG091G0KRB/get_outgroups.stdout.txt, per_gene/EOG091G0KRB/get_outgroups.stderr.txt
    jobid: 2741
    wildcards: BUSCO=EOG091G0KRB


        #download fastas from Orhtodb for BUSCO id
        for i in {1..5}
        do
             wget "http://www.orthodb.org/fasta?query=EOG091G0KRB&level=33208" -O per_gene/EOG091G0KRB/EOG091G0KRB.orthodb.fasta 1> per_gene/EOG091G0KRB/get_outgroups.stdout.txt 2> per_gene/EOG091G0KRB/get_outgroups.stderr.txt && break || echo -e "try again ($i)" && sleep 15
        done

	#This is quick an dirty for now and just takes the first protein if there is more than one for an outgroup taxon
        bash ../scripts/download_outgroups.sh taxids.txt per_gene/EOG091G0KRB/EOG091G0KRB.orthodb.fasta > per_gene/EOG091G0KRB/EOG091G0KRB.outgroup.fasta
        
[Sun Jul  5 22:21:01 2020]
Finished job 2741.
939 of 3292 steps (29%) done

[Sun Jul  5 22:21:01 2020]
rule join_groups:
    input: per_gene/EOG091G0KRB/EOG091G0KRB.ingroup.fasta, per_gene/EOG091G0KRB/EOG091G0KRB.outgroup.fasta
    output: per_gene/EOG091G0KRB/EOG091G0KRB.fasta
    jobid: 2194
    wildcards: BUSCO=EOG091G0KRB


        cat per_gene/EOG091G0KRB/EOG091G0KRB.ingroup.fasta per_gene/EOG091G0KRB/EOG091G0KRB.outgroup.fasta > per_gene/EOG091G0KRB/EOG091G0KRB.fasta
        
[Sun Jul  5 22:21:01 2020]
Finished job 2194.
940 of 3292 steps (29%) done

[Sun Jul  5 22:21:01 2020]
rule MSA:
    input: per_gene/EOG091G0KRB/EOG091G0KRB.fasta
    output: per_gene/EOG091G0KRB/EOG091G0KRB.clustalo.fasta
    log: per_gene/EOG091G0KRB/MSA.stdout.txt, per_gene/EOG091G0KRB/MSA.stderr.txt
    jobid: 1508
    wildcards: BUSCO=EOG091G0KRB
    threads: 2


        clustalo -i per_gene/EOG091G0KRB/EOG091G0KRB.fasta -o per_gene/EOG091G0KRB/EOG091G0KRB.clustalo.fasta --threads=2 1> per_gene/EOG091G0KRB/MSA.stdout.txt 2> per_gene/EOG091G0KRB/MSA.stderr.txt
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/d68c9691725a7401923680874285c430.simg
[Sun Jul  5 22:21:02 2020]
Finished job 194.
941 of 3292 steps (29%) done

[Sun Jul  5 22:21:02 2020]
rule get_seqs:
    input: /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ingroup.txt, /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/outgroup.txt
    output: per_gene/EOG091G0AHJ/EOG091G0AHJ.ingroup.fasta
    log: per_gene/EOG091G0AHJ/get_seqs.stdout.txt, per_gene/EOG091G0AHJ/get_seqs.stderr.txt
    jobid: 2966
    wildcards: BUSCO=EOG091G0AHJ
    threads: 2


	basedir=$(pwd)
        cd per_gene/EOG091G0AHJ
        
        bash $basedir/../scripts/fetch_seqs.sh EOG091G0AHJ /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ingroup.txt /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/outgroup.txt 1> ../../per_gene/EOG091G0AHJ/get_seqs.stdout.txt 2> ../../per_gene/EOG091G0AHJ/get_seqs.stderr.txt
	mv EOG091G0AHJ.fasta $basedir/per_gene/EOG091G0AHJ/EOG091G0AHJ.ingroup.fasta
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/72476f9d9a5bd0627b4d721143a21354.simg
[Sun Jul  5 22:21:02 2020]
Finished job 1508.
942 of 3292 steps (29%) done

[Sun Jul  5 22:21:02 2020]
rule score_and_cut:
    input: per_gene/EOG091G0KRB/EOG091G0KRB.clustalo.fasta
    output: per_gene/EOG091G0KRB/ALICUT_EOG091G0KRB.clustalo.fasta
    jobid: 685
    wildcards: BUSCO=EOG091G0KRB
    threads: 2


        cd per_gene/EOG091G0KRB
        Aliscore.pl -N -r 200000000000000000 -i ../../per_gene/EOG091G0KRB/EOG091G0KRB.clustalo.fasta &> aliscore.log
        ALICUT.pl -s &> alicut.log
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/63c88c27a0fa300f57066b0ef65fefcb.simg
[Sun Jul  5 22:21:13 2020]
Finished job 685.
943 of 3292 steps (29%) done

[Sun Jul  5 22:21:13 2020]
rule remove_empty:
    input: per_gene/EOG091G0KRB/ALICUT_EOG091G0KRB.clustalo.fasta
    output: per_gene/EOG091G0KRB/empty_check.done
    jobid: 1507
    wildcards: BUSCO=EOG091G0KRB


         if [ "$(cat per_gene/EOG091G0KRB/ALICUT_EOG091G0KRB.clustalo.fasta | grep -v ">" | sed 's/-//g' | grep "^$" | wc -l)" -gt 0 ]
         then
              cp per_gene/EOG091G0KRB/ALICUT_EOG091G0KRB.clustalo.fasta per_gene/EOG091G0KRB/ALICUT_EOG091G0KRB.clustalo.fasta.backup
              bash ../scripts/remove_empty.sh per_gene/EOG091G0KRB/ALICUT_EOG091G0KRB.clustalo.fasta.backup > per_gene/EOG091G0KRB/ALICUT_EOG091G0KRB.clustalo.fasta
         fi
         touch per_gene/EOG091G0KRB/empty_check.done
         
[Sun Jul  5 22:21:14 2020]
Finished job 1507.
944 of 3292 steps (29%) done

[Sun Jul  5 22:21:14 2020]
rule find_best_model:
    input: per_gene/EOG091G0KRB/ALICUT_EOG091G0KRB.clustalo.fasta, per_gene/EOG091G0KRB/empty_check.done
    output: per_gene/EOG091G0KRB/EOG091G0KRB.best_model
    log: per_gene/EOG091G0KRB/find_best_model.stderr.txt
    jobid: 684
    wildcards: BUSCO=EOG091G0KRB
    threads: 2


        cd per_gene/EOG091G0KRB
        if [ ! -d find_best_model ]
        then
            mkdir find_best_model
        fi
        cd find_best_model
        ln -s ../../../per_gene/EOG091G0KRB/ALICUT_EOG091G0KRB.clustalo.fasta EOG091G0KRB.fasta
        ProteinModelSelection.pl EOG091G0KRB.fasta 1> ../../../per_gene/EOG091G0KRB/EOG091G0KRB.best_model 2> ../../../per_gene/EOG091G0KRB/find_best_model.stderr.txt
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/c0c09ee657b1e27f2c5687e0e9aa8d70.simg
[Sun Jul  5 22:21:14 2020]
Finished job 2966.
945 of 3292 steps (29%) done

[Sun Jul  5 22:21:14 2020]
rule get_outgroups:
    input: per_gene/EOG091G0AHJ/EOG091G0AHJ.ingroup.fasta
    output: per_gene/EOG091G0AHJ/EOG091G0AHJ.orthodb.fasta, per_gene/EOG091G0AHJ/EOG091G0AHJ.outgroup.fasta
    log: per_gene/EOG091G0AHJ/get_outgroups.stdout.txt, per_gene/EOG091G0AHJ/get_outgroups.stderr.txt
    jobid: 2967
    wildcards: BUSCO=EOG091G0AHJ


        #download fastas from Orhtodb for BUSCO id
        for i in {1..5}
        do
             wget "http://www.orthodb.org/fasta?query=EOG091G0AHJ&level=33208" -O per_gene/EOG091G0AHJ/EOG091G0AHJ.orthodb.fasta 1> per_gene/EOG091G0AHJ/get_outgroups.stdout.txt 2> per_gene/EOG091G0AHJ/get_outgroups.stderr.txt && break || echo -e "try again ($i)" && sleep 15
        done

	#This is quick an dirty for now and just takes the first protein if there is more than one for an outgroup taxon
        bash ../scripts/download_outgroups.sh taxids.txt per_gene/EOG091G0AHJ/EOG091G0AHJ.orthodb.fasta > per_gene/EOG091G0AHJ/EOG091G0AHJ.outgroup.fasta
        
[Sun Jul  5 22:21:15 2020]
Finished job 2967.
946 of 3292 steps (29%) done

[Sun Jul  5 22:21:15 2020]
rule join_groups:
    input: per_gene/EOG091G0AHJ/EOG091G0AHJ.ingroup.fasta, per_gene/EOG091G0AHJ/EOG091G0AHJ.outgroup.fasta
    output: per_gene/EOG091G0AHJ/EOG091G0AHJ.fasta
    jobid: 2307
    wildcards: BUSCO=EOG091G0AHJ


        cat per_gene/EOG091G0AHJ/EOG091G0AHJ.ingroup.fasta per_gene/EOG091G0AHJ/EOG091G0AHJ.outgroup.fasta > per_gene/EOG091G0AHJ/EOG091G0AHJ.fasta
        
[Sun Jul  5 22:21:15 2020]
Finished job 2307.
947 of 3292 steps (29%) done

[Sun Jul  5 22:21:15 2020]
rule MSA:
    input: per_gene/EOG091G0AHJ/EOG091G0AHJ.fasta
    output: per_gene/EOG091G0AHJ/EOG091G0AHJ.clustalo.fasta
    log: per_gene/EOG091G0AHJ/MSA.stdout.txt, per_gene/EOG091G0AHJ/MSA.stderr.txt
    jobid: 1734
    wildcards: BUSCO=EOG091G0AHJ
    threads: 2


        clustalo -i per_gene/EOG091G0AHJ/EOG091G0AHJ.fasta -o per_gene/EOG091G0AHJ/EOG091G0AHJ.clustalo.fasta --threads=2 1> per_gene/EOG091G0AHJ/MSA.stdout.txt 2> per_gene/EOG091G0AHJ/MSA.stderr.txt
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/d68c9691725a7401923680874285c430.simg
[Sun Jul  5 22:21:16 2020]
Finished job 1734.
948 of 3292 steps (29%) done

[Sun Jul  5 22:21:16 2020]
rule score_and_cut:
    input: per_gene/EOG091G0AHJ/EOG091G0AHJ.clustalo.fasta
    output: per_gene/EOG091G0AHJ/ALICUT_EOG091G0AHJ.clustalo.fasta
    jobid: 911
    wildcards: BUSCO=EOG091G0AHJ
    threads: 2


        cd per_gene/EOG091G0AHJ
        Aliscore.pl -N -r 200000000000000000 -i ../../per_gene/EOG091G0AHJ/EOG091G0AHJ.clustalo.fasta &> aliscore.log
        ALICUT.pl -s &> alicut.log
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/63c88c27a0fa300f57066b0ef65fefcb.simg
[Sun Jul  5 22:21:26 2020]
Finished job 911.
949 of 3292 steps (29%) done

[Sun Jul  5 22:21:26 2020]
rule remove_empty:
    input: per_gene/EOG091G0AHJ/ALICUT_EOG091G0AHJ.clustalo.fasta
    output: per_gene/EOG091G0AHJ/empty_check.done
    jobid: 1733
    wildcards: BUSCO=EOG091G0AHJ


         if [ "$(cat per_gene/EOG091G0AHJ/ALICUT_EOG091G0AHJ.clustalo.fasta | grep -v ">" | sed 's/-//g' | grep "^$" | wc -l)" -gt 0 ]
         then
              cp per_gene/EOG091G0AHJ/ALICUT_EOG091G0AHJ.clustalo.fasta per_gene/EOG091G0AHJ/ALICUT_EOG091G0AHJ.clustalo.fasta.backup
              bash ../scripts/remove_empty.sh per_gene/EOG091G0AHJ/ALICUT_EOG091G0AHJ.clustalo.fasta.backup > per_gene/EOG091G0AHJ/ALICUT_EOG091G0AHJ.clustalo.fasta
         fi
         touch per_gene/EOG091G0AHJ/empty_check.done
         
[Sun Jul  5 22:21:26 2020]
Finished job 1733.
950 of 3292 steps (29%) done

[Sun Jul  5 22:21:26 2020]
rule find_best_model:
    input: per_gene/EOG091G0AHJ/ALICUT_EOG091G0AHJ.clustalo.fasta, per_gene/EOG091G0AHJ/empty_check.done
    output: per_gene/EOG091G0AHJ/EOG091G0AHJ.best_model
    log: per_gene/EOG091G0AHJ/find_best_model.stderr.txt
    jobid: 910
    wildcards: BUSCO=EOG091G0AHJ
    threads: 2


        cd per_gene/EOG091G0AHJ
        if [ ! -d find_best_model ]
        then
            mkdir find_best_model
        fi
        cd find_best_model
        ln -s ../../../per_gene/EOG091G0AHJ/ALICUT_EOG091G0AHJ.clustalo.fasta EOG091G0AHJ.fasta
        ProteinModelSelection.pl EOG091G0AHJ.fasta 1> ../../../per_gene/EOG091G0AHJ/EOG091G0AHJ.best_model 2> ../../../per_gene/EOG091G0AHJ/find_best_model.stderr.txt
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/c0c09ee657b1e27f2c5687e0e9aa8d70.simg
[Sun Jul  5 22:21:29 2020]
Finished job 345.
951 of 3292 steps (29%) done

[Sun Jul  5 22:21:29 2020]
rule get_seqs:
    input: /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ingroup.txt, /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/outgroup.txt
    output: per_gene/EOG091G05RA/EOG091G05RA.ingroup.fasta
    log: per_gene/EOG091G05RA/get_seqs.stdout.txt, per_gene/EOG091G05RA/get_seqs.stderr.txt
    jobid: 3060
    wildcards: BUSCO=EOG091G05RA
    threads: 2


	basedir=$(pwd)
        cd per_gene/EOG091G05RA
        
        bash $basedir/../scripts/fetch_seqs.sh EOG091G05RA /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ingroup.txt /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/outgroup.txt 1> ../../per_gene/EOG091G05RA/get_seqs.stdout.txt 2> ../../per_gene/EOG091G05RA/get_seqs.stderr.txt
	mv EOG091G05RA.fasta $basedir/per_gene/EOG091G05RA/EOG091G05RA.ingroup.fasta
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/72476f9d9a5bd0627b4d721143a21354.simg
[Sun Jul  5 22:21:44 2020]
Finished job 3060.
952 of 3292 steps (29%) done

[Sun Jul  5 22:21:44 2020]
rule get_outgroups:
    input: per_gene/EOG091G05RA/EOG091G05RA.ingroup.fasta
    output: per_gene/EOG091G05RA/EOG091G05RA.orthodb.fasta, per_gene/EOG091G05RA/EOG091G05RA.outgroup.fasta
    log: per_gene/EOG091G05RA/get_outgroups.stdout.txt, per_gene/EOG091G05RA/get_outgroups.stderr.txt
    jobid: 3061
    wildcards: BUSCO=EOG091G05RA


        #download fastas from Orhtodb for BUSCO id
        for i in {1..5}
        do
             wget "http://www.orthodb.org/fasta?query=EOG091G05RA&level=33208" -O per_gene/EOG091G05RA/EOG091G05RA.orthodb.fasta 1> per_gene/EOG091G05RA/get_outgroups.stdout.txt 2> per_gene/EOG091G05RA/get_outgroups.stderr.txt && break || echo -e "try again ($i)" && sleep 15
        done

	#This is quick an dirty for now and just takes the first protein if there is more than one for an outgroup taxon
        bash ../scripts/download_outgroups.sh taxids.txt per_gene/EOG091G05RA/EOG091G05RA.orthodb.fasta > per_gene/EOG091G05RA/EOG091G05RA.outgroup.fasta
        
[Sun Jul  5 22:21:45 2020]
Finished job 3061.
953 of 3292 steps (29%) done

[Sun Jul  5 22:21:45 2020]
rule join_groups:
    input: per_gene/EOG091G05RA/EOG091G05RA.ingroup.fasta, per_gene/EOG091G05RA/EOG091G05RA.outgroup.fasta
    output: per_gene/EOG091G05RA/EOG091G05RA.fasta
    jobid: 2354
    wildcards: BUSCO=EOG091G05RA


        cat per_gene/EOG091G05RA/EOG091G05RA.ingroup.fasta per_gene/EOG091G05RA/EOG091G05RA.outgroup.fasta > per_gene/EOG091G05RA/EOG091G05RA.fasta
        
[Sun Jul  5 22:21:45 2020]
Finished job 2354.
954 of 3292 steps (29%) done

[Sun Jul  5 22:21:45 2020]
rule MSA:
    input: per_gene/EOG091G05RA/EOG091G05RA.fasta
    output: per_gene/EOG091G05RA/EOG091G05RA.clustalo.fasta
    log: per_gene/EOG091G05RA/MSA.stdout.txt, per_gene/EOG091G05RA/MSA.stderr.txt
    jobid: 1828
    wildcards: BUSCO=EOG091G05RA
    threads: 2


        clustalo -i per_gene/EOG091G05RA/EOG091G05RA.fasta -o per_gene/EOG091G05RA/EOG091G05RA.clustalo.fasta --threads=2 1> per_gene/EOG091G05RA/MSA.stdout.txt 2> per_gene/EOG091G05RA/MSA.stderr.txt
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/d68c9691725a7401923680874285c430.simg
[Sun Jul  5 22:21:47 2020]
Finished job 1828.
955 of 3292 steps (29%) done

[Sun Jul  5 22:21:47 2020]
rule score_and_cut:
    input: per_gene/EOG091G05RA/EOG091G05RA.clustalo.fasta
    output: per_gene/EOG091G05RA/ALICUT_EOG091G05RA.clustalo.fasta
    jobid: 1005
    wildcards: BUSCO=EOG091G05RA
    threads: 2


        cd per_gene/EOG091G05RA
        Aliscore.pl -N -r 200000000000000000 -i ../../per_gene/EOG091G05RA/EOG091G05RA.clustalo.fasta &> aliscore.log
        ALICUT.pl -s &> alicut.log
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/63c88c27a0fa300f57066b0ef65fefcb.simg
[Sun Jul  5 22:21:50 2020]
Finished job 684.
956 of 3292 steps (29%) done

[Sun Jul  5 22:21:50 2020]
rule infer_single_ML:
    input: per_gene/EOG091G0KRB/EOG091G0KRB.best_model, per_gene/EOG091G0KRB/ALICUT_EOG091G0KRB.clustalo.fasta
    output: per_gene/EOG091G0KRB/EOG091G0KRB.raxml.done
    log: per_gene/EOG091G0KRB/infer_single_ML.stdout.txt, per_gene/EOG091G0KRB/infer_single_ML.stderr.txt
    jobid: 136
    wildcards: BUSCO=EOG091G0KRB
    threads: 2


        cd per_gene/EOG091G0KRB
	count=$(cat ../../per_gene/EOG091G0KRB/ALICUT_EOG091G0KRB.clustalo.fasta | grep ">" | wc -l)
	if [ "$count" -gt 5 ]
        then
		RAxMLmodel=$(cat ../../per_gene/EOG091G0KRB/EOG091G0KRB.best_model | grep "Best" | cut -d ":" -f 2 | tr -d '[:space:]')
                if [ "$(ls -1 | grep "^RAxML" | wc -l)" -ne 0 ]
		then
			rm RAxML*
		fi
        	raxml -f a -T 2 -m PROTGAMMA$RAxMLmodel         	-p 12345 -x 12345 -# 100         	-s ../../per_gene/EOG091G0KRB/ALICUT_EOG091G0KRB.clustalo.fasta -n EOG091G0KRB.clustalo.aln.ALICUT.$RAxMLmodel 		1> ../../per_gene/EOG091G0KRB/infer_single_ML.stdout.txt 2> ../../per_gene/EOG091G0KRB/infer_single_ML.stderr.txt
	else
		echo "fasta file per_gene/EOG091G0KRB/ALICUT_EOG091G0KRB.clustalo.fasta contains fewer than 5 sequences - skipped" > ../../per_gene/EOG091G0KRB/infer_single_ML.stdout.txt
		touch raxml.skipped
	fi
        touch ../../per_gene/EOG091G0KRB/EOG091G0KRB.raxml.done
        
[33mJob counts:
	count	jobs
	1	infer_single_ML
	1[0m
[33m
        cd per_gene/EOG091G0KRB
	count=$(cat ../../per_gene/EOG091G0KRB/ALICUT_EOG091G0KRB.clustalo.fasta | grep ">" | wc -l)
	if [ "$count" -gt 5 ]
        then
		RAxMLmodel=$(cat ../../per_gene/EOG091G0KRB/EOG091G0KRB.best_model | grep "Best" | cut -d ":" -f 2 | tr -d '[:space:]')
                if [ "$(ls -1 | grep "^RAxML" | wc -l)" -ne 0 ]
		then
			rm RAxML*
		fi
        	raxml -f a -T 2 -m PROTGAMMA$RAxMLmodel         	-p 12345 -x 12345 -# 100         	-s ../../per_gene/EOG091G0KRB/ALICUT_EOG091G0KRB.clustalo.fasta -n EOG091G0KRB.clustalo.aln.ALICUT.$RAxMLmodel 		1> ../../per_gene/EOG091G0KRB/infer_single_ML.stdout.txt 2> ../../per_gene/EOG091G0KRB/infer_single_ML.stderr.txt
	else
		echo "fasta file per_gene/EOG091G0KRB/ALICUT_EOG091G0KRB.clustalo.fasta contains fewer than 5 sequences - skipped" > ../../per_gene/EOG091G0KRB/infer_single_ML.stdout.txt
		touch raxml.skipped
	fi
        touch ../../per_gene/EOG091G0KRB/EOG091G0KRB.raxml.done
        [0m
[Sun Jul  5 22:21:57 2020]
Finished job 1005.
957 of 3292 steps (29%) done

[Sun Jul  5 22:21:57 2020]
rule remove_empty:
    input: per_gene/EOG091G05RA/ALICUT_EOG091G05RA.clustalo.fasta
    output: per_gene/EOG091G05RA/empty_check.done
    jobid: 1827
    wildcards: BUSCO=EOG091G05RA


         if [ "$(cat per_gene/EOG091G05RA/ALICUT_EOG091G05RA.clustalo.fasta | grep -v ">" | sed 's/-//g' | grep "^$" | wc -l)" -gt 0 ]
         then
              cp per_gene/EOG091G05RA/ALICUT_EOG091G05RA.clustalo.fasta per_gene/EOG091G05RA/ALICUT_EOG091G05RA.clustalo.fasta.backup
              bash ../scripts/remove_empty.sh per_gene/EOG091G05RA/ALICUT_EOG091G05RA.clustalo.fasta.backup > per_gene/EOG091G05RA/ALICUT_EOG091G05RA.clustalo.fasta
         fi
         touch per_gene/EOG091G05RA/empty_check.done
         
[Sun Jul  5 22:21:58 2020]
Finished job 1827.
958 of 3292 steps (29%) done

[Sun Jul  5 22:21:58 2020]
rule find_best_model:
    input: per_gene/EOG091G05RA/ALICUT_EOG091G05RA.clustalo.fasta, per_gene/EOG091G05RA/empty_check.done
    output: per_gene/EOG091G05RA/EOG091G05RA.best_model
    log: per_gene/EOG091G05RA/find_best_model.stderr.txt
    jobid: 1004
    wildcards: BUSCO=EOG091G05RA
    threads: 2


        cd per_gene/EOG091G05RA
        if [ ! -d find_best_model ]
        then
            mkdir find_best_model
        fi
        cd find_best_model
        ln -s ../../../per_gene/EOG091G05RA/ALICUT_EOG091G05RA.clustalo.fasta EOG091G05RA.fasta
        ProteinModelSelection.pl EOG091G05RA.fasta 1> ../../../per_gene/EOG091G05RA/EOG091G05RA.best_model 2> ../../../per_gene/EOG091G05RA/find_best_model.stderr.txt
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/c0c09ee657b1e27f2c5687e0e9aa8d70.simg
[Sun Jul  5 22:22:05 2020]
Finished job 65.
959 of 3292 steps (29%) done

[Sun Jul  5 22:22:05 2020]
rule get_seqs:
    input: /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ingroup.txt, /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/outgroup.txt
    output: per_gene/EOG091G06Y7/EOG091G06Y7.ingroup.fasta
    log: per_gene/EOG091G06Y7/get_seqs.stdout.txt, per_gene/EOG091G06Y7/get_seqs.stderr.txt
    jobid: 2568
    wildcards: BUSCO=EOG091G06Y7
    threads: 2


	basedir=$(pwd)
        cd per_gene/EOG091G06Y7
        
        bash $basedir/../scripts/fetch_seqs.sh EOG091G06Y7 /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ingroup.txt /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/outgroup.txt 1> ../../per_gene/EOG091G06Y7/get_seqs.stdout.txt 2> ../../per_gene/EOG091G06Y7/get_seqs.stderr.txt
	mv EOG091G06Y7.fasta $basedir/per_gene/EOG091G06Y7/EOG091G06Y7.ingroup.fasta
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/72476f9d9a5bd0627b4d721143a21354.simg
[Sun Jul  5 22:22:18 2020]
Finished job 910.
960 of 3292 steps (29%) done

[Sun Jul  5 22:22:18 2020]
rule infer_single_ML:
    input: per_gene/EOG091G0AHJ/EOG091G0AHJ.best_model, per_gene/EOG091G0AHJ/ALICUT_EOG091G0AHJ.clustalo.fasta
    output: per_gene/EOG091G0AHJ/EOG091G0AHJ.raxml.done
    log: per_gene/EOG091G0AHJ/infer_single_ML.stdout.txt, per_gene/EOG091G0AHJ/infer_single_ML.stderr.txt
    jobid: 249
    wildcards: BUSCO=EOG091G0AHJ
    threads: 2


        cd per_gene/EOG091G0AHJ
	count=$(cat ../../per_gene/EOG091G0AHJ/ALICUT_EOG091G0AHJ.clustalo.fasta | grep ">" | wc -l)
	if [ "$count" -gt 5 ]
        then
		RAxMLmodel=$(cat ../../per_gene/EOG091G0AHJ/EOG091G0AHJ.best_model | grep "Best" | cut -d ":" -f 2 | tr -d '[:space:]')
                if [ "$(ls -1 | grep "^RAxML" | wc -l)" -ne 0 ]
		then
			rm RAxML*
		fi
        	raxml -f a -T 2 -m PROTGAMMA$RAxMLmodel         	-p 12345 -x 12345 -# 100         	-s ../../per_gene/EOG091G0AHJ/ALICUT_EOG091G0AHJ.clustalo.fasta -n EOG091G0AHJ.clustalo.aln.ALICUT.$RAxMLmodel 		1> ../../per_gene/EOG091G0AHJ/infer_single_ML.stdout.txt 2> ../../per_gene/EOG091G0AHJ/infer_single_ML.stderr.txt
	else
		echo "fasta file per_gene/EOG091G0AHJ/ALICUT_EOG091G0AHJ.clustalo.fasta contains fewer than 5 sequences - skipped" > ../../per_gene/EOG091G0AHJ/infer_single_ML.stdout.txt
		touch raxml.skipped
	fi
        touch ../../per_gene/EOG091G0AHJ/EOG091G0AHJ.raxml.done
        
[33mJob counts:
	count	jobs
	1	infer_single_ML
	1[0m
[33m
        cd per_gene/EOG091G0AHJ
	count=$(cat ../../per_gene/EOG091G0AHJ/ALICUT_EOG091G0AHJ.clustalo.fasta | grep ">" | wc -l)
	if [ "$count" -gt 5 ]
        then
		RAxMLmodel=$(cat ../../per_gene/EOG091G0AHJ/EOG091G0AHJ.best_model | grep "Best" | cut -d ":" -f 2 | tr -d '[:space:]')
                if [ "$(ls -1 | grep "^RAxML" | wc -l)" -ne 0 ]
		then
			rm RAxML*
		fi
        	raxml -f a -T 2 -m PROTGAMMA$RAxMLmodel         	-p 12345 -x 12345 -# 100         	-s ../../per_gene/EOG091G0AHJ/ALICUT_EOG091G0AHJ.clustalo.fasta -n EOG091G0AHJ.clustalo.aln.ALICUT.$RAxMLmodel 		1> ../../per_gene/EOG091G0AHJ/infer_single_ML.stdout.txt 2> ../../per_gene/EOG091G0AHJ/infer_single_ML.stderr.txt
	else
		echo "fasta file per_gene/EOG091G0AHJ/ALICUT_EOG091G0AHJ.clustalo.fasta contains fewer than 5 sequences - skipped" > ../../per_gene/EOG091G0AHJ/infer_single_ML.stdout.txt
		touch raxml.skipped
	fi
        touch ../../per_gene/EOG091G0AHJ/EOG091G0AHJ.raxml.done
        [0m
[Sun Jul  5 22:22:19 2020]
Finished job 96.
961 of 3292 steps (29%) done

[Sun Jul  5 22:22:19 2020]
rule get_seqs:
    input: /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ingroup.txt, /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/outgroup.txt
    output: per_gene/EOG091G0M22/EOG091G0M22.ingroup.fasta
    log: per_gene/EOG091G0M22/get_seqs.stdout.txt, per_gene/EOG091G0M22/get_seqs.stderr.txt
    jobid: 2758
    wildcards: BUSCO=EOG091G0M22
    threads: 2


	basedir=$(pwd)
        cd per_gene/EOG091G0M22
        
        bash $basedir/../scripts/fetch_seqs.sh EOG091G0M22 /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ingroup.txt /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/outgroup.txt 1> ../../per_gene/EOG091G0M22/get_seqs.stdout.txt 2> ../../per_gene/EOG091G0M22/get_seqs.stderr.txt
	mv EOG091G0M22.fasta $basedir/per_gene/EOG091G0M22/EOG091G0M22.ingroup.fasta
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/72476f9d9a5bd0627b4d721143a21354.simg
[Sun Jul  5 22:22:20 2020]
Finished job 2568.
962 of 3292 steps (29%) done

[Sun Jul  5 22:22:20 2020]
rule get_outgroups:
    input: per_gene/EOG091G06Y7/EOG091G06Y7.ingroup.fasta
    output: per_gene/EOG091G06Y7/EOG091G06Y7.orthodb.fasta, per_gene/EOG091G06Y7/EOG091G06Y7.outgroup.fasta
    log: per_gene/EOG091G06Y7/get_outgroups.stdout.txt, per_gene/EOG091G06Y7/get_outgroups.stderr.txt
    jobid: 2569
    wildcards: BUSCO=EOG091G06Y7


        #download fastas from Orhtodb for BUSCO id
        for i in {1..5}
        do
             wget "http://www.orthodb.org/fasta?query=EOG091G06Y7&level=33208" -O per_gene/EOG091G06Y7/EOG091G06Y7.orthodb.fasta 1> per_gene/EOG091G06Y7/get_outgroups.stdout.txt 2> per_gene/EOG091G06Y7/get_outgroups.stderr.txt && break || echo -e "try again ($i)" && sleep 15
        done

	#This is quick an dirty for now and just takes the first protein if there is more than one for an outgroup taxon
        bash ../scripts/download_outgroups.sh taxids.txt per_gene/EOG091G06Y7/EOG091G06Y7.orthodb.fasta > per_gene/EOG091G06Y7/EOG091G06Y7.outgroup.fasta
        
[Sun Jul  5 22:22:21 2020]
Finished job 2569.
963 of 3292 steps (29%) done

[Sun Jul  5 22:22:21 2020]
rule join_groups:
    input: per_gene/EOG091G06Y7/EOG091G06Y7.ingroup.fasta, per_gene/EOG091G06Y7/EOG091G06Y7.outgroup.fasta
    output: per_gene/EOG091G06Y7/EOG091G06Y7.fasta
    jobid: 2108
    wildcards: BUSCO=EOG091G06Y7


        cat per_gene/EOG091G06Y7/EOG091G06Y7.ingroup.fasta per_gene/EOG091G06Y7/EOG091G06Y7.outgroup.fasta > per_gene/EOG091G06Y7/EOG091G06Y7.fasta
        
[Sun Jul  5 22:22:21 2020]
Finished job 2108.
964 of 3292 steps (29%) done

[Sun Jul  5 22:22:21 2020]
rule MSA:
    input: per_gene/EOG091G06Y7/EOG091G06Y7.fasta
    output: per_gene/EOG091G06Y7/EOG091G06Y7.clustalo.fasta
    log: per_gene/EOG091G06Y7/MSA.stdout.txt, per_gene/EOG091G06Y7/MSA.stderr.txt
    jobid: 1336
    wildcards: BUSCO=EOG091G06Y7
    threads: 2


        clustalo -i per_gene/EOG091G06Y7/EOG091G06Y7.fasta -o per_gene/EOG091G06Y7/EOG091G06Y7.clustalo.fasta --threads=2 1> per_gene/EOG091G06Y7/MSA.stdout.txt 2> per_gene/EOG091G06Y7/MSA.stderr.txt
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/d68c9691725a7401923680874285c430.simg
[Sun Jul  5 22:22:24 2020]
Finished job 1336.
965 of 3292 steps (29%) done

[Sun Jul  5 22:22:24 2020]
rule score_and_cut:
    input: per_gene/EOG091G06Y7/EOG091G06Y7.clustalo.fasta
    output: per_gene/EOG091G06Y7/ALICUT_EOG091G06Y7.clustalo.fasta
    jobid: 513
    wildcards: BUSCO=EOG091G06Y7
    threads: 2


        cd per_gene/EOG091G06Y7
        Aliscore.pl -N -r 200000000000000000 -i ../../per_gene/EOG091G06Y7/EOG091G06Y7.clustalo.fasta &> aliscore.log
        ALICUT.pl -s &> alicut.log
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/63c88c27a0fa300f57066b0ef65fefcb.simg
[Sun Jul  5 22:22:32 2020]
Finished job 2758.
966 of 3292 steps (29%) done

[Sun Jul  5 22:22:32 2020]
rule get_outgroups:
    input: per_gene/EOG091G0M22/EOG091G0M22.ingroup.fasta
    output: per_gene/EOG091G0M22/EOG091G0M22.orthodb.fasta, per_gene/EOG091G0M22/EOG091G0M22.outgroup.fasta
    log: per_gene/EOG091G0M22/get_outgroups.stdout.txt, per_gene/EOG091G0M22/get_outgroups.stderr.txt
    jobid: 2759
    wildcards: BUSCO=EOG091G0M22


        #download fastas from Orhtodb for BUSCO id
        for i in {1..5}
        do
             wget "http://www.orthodb.org/fasta?query=EOG091G0M22&level=33208" -O per_gene/EOG091G0M22/EOG091G0M22.orthodb.fasta 1> per_gene/EOG091G0M22/get_outgroups.stdout.txt 2> per_gene/EOG091G0M22/get_outgroups.stderr.txt && break || echo -e "try again ($i)" && sleep 15
        done

	#This is quick an dirty for now and just takes the first protein if there is more than one for an outgroup taxon
        bash ../scripts/download_outgroups.sh taxids.txt per_gene/EOG091G0M22/EOG091G0M22.orthodb.fasta > per_gene/EOG091G0M22/EOG091G0M22.outgroup.fasta
        
[Sun Jul  5 22:22:33 2020]
Finished job 2759.
967 of 3292 steps (29%) done

[Sun Jul  5 22:22:33 2020]
rule join_groups:
    input: per_gene/EOG091G0M22/EOG091G0M22.ingroup.fasta, per_gene/EOG091G0M22/EOG091G0M22.outgroup.fasta
    output: per_gene/EOG091G0M22/EOG091G0M22.fasta
    jobid: 2203
    wildcards: BUSCO=EOG091G0M22


        cat per_gene/EOG091G0M22/EOG091G0M22.ingroup.fasta per_gene/EOG091G0M22/EOG091G0M22.outgroup.fasta > per_gene/EOG091G0M22/EOG091G0M22.fasta
        
[Sun Jul  5 22:22:33 2020]
Finished job 2203.
968 of 3292 steps (29%) done

[Sun Jul  5 22:22:33 2020]
rule MSA:
    input: per_gene/EOG091G0M22/EOG091G0M22.fasta
    output: per_gene/EOG091G0M22/EOG091G0M22.clustalo.fasta
    log: per_gene/EOG091G0M22/MSA.stdout.txt, per_gene/EOG091G0M22/MSA.stderr.txt
    jobid: 1526
    wildcards: BUSCO=EOG091G0M22
    threads: 2


        clustalo -i per_gene/EOG091G0M22/EOG091G0M22.fasta -o per_gene/EOG091G0M22/EOG091G0M22.clustalo.fasta --threads=2 1> per_gene/EOG091G0M22/MSA.stdout.txt 2> per_gene/EOG091G0M22/MSA.stderr.txt
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/d68c9691725a7401923680874285c430.simg
[Sun Jul  5 22:22:34 2020]
Finished job 1526.
969 of 3292 steps (29%) done

[Sun Jul  5 22:22:34 2020]
rule score_and_cut:
    input: per_gene/EOG091G0M22/EOG091G0M22.clustalo.fasta
    output: per_gene/EOG091G0M22/ALICUT_EOG091G0M22.clustalo.fasta
    jobid: 703
    wildcards: BUSCO=EOG091G0M22
    threads: 2


        cd per_gene/EOG091G0M22
        Aliscore.pl -N -r 200000000000000000 -i ../../per_gene/EOG091G0M22/EOG091G0M22.clustalo.fasta &> aliscore.log
        ALICUT.pl -s &> alicut.log
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/63c88c27a0fa300f57066b0ef65fefcb.simg
[Sun Jul  5 22:22:34 2020]
Finished job 513.
970 of 3292 steps (29%) done

[Sun Jul  5 22:22:34 2020]
rule remove_empty:
    input: per_gene/EOG091G06Y7/ALICUT_EOG091G06Y7.clustalo.fasta
    output: per_gene/EOG091G06Y7/empty_check.done
    jobid: 1335
    wildcards: BUSCO=EOG091G06Y7


         if [ "$(cat per_gene/EOG091G06Y7/ALICUT_EOG091G06Y7.clustalo.fasta | grep -v ">" | sed 's/-//g' | grep "^$" | wc -l)" -gt 0 ]
         then
              cp per_gene/EOG091G06Y7/ALICUT_EOG091G06Y7.clustalo.fasta per_gene/EOG091G06Y7/ALICUT_EOG091G06Y7.clustalo.fasta.backup
              bash ../scripts/remove_empty.sh per_gene/EOG091G06Y7/ALICUT_EOG091G06Y7.clustalo.fasta.backup > per_gene/EOG091G06Y7/ALICUT_EOG091G06Y7.clustalo.fasta
         fi
         touch per_gene/EOG091G06Y7/empty_check.done
         
[Sun Jul  5 22:22:34 2020]
Finished job 1335.
971 of 3292 steps (29%) done

[Sun Jul  5 22:22:34 2020]
rule find_best_model:
    input: per_gene/EOG091G06Y7/ALICUT_EOG091G06Y7.clustalo.fasta, per_gene/EOG091G06Y7/empty_check.done
    output: per_gene/EOG091G06Y7/EOG091G06Y7.best_model
    log: per_gene/EOG091G06Y7/find_best_model.stderr.txt
    jobid: 512
    wildcards: BUSCO=EOG091G06Y7
    threads: 2


        cd per_gene/EOG091G06Y7
        if [ ! -d find_best_model ]
        then
            mkdir find_best_model
        fi
        cd find_best_model
        ln -s ../../../per_gene/EOG091G06Y7/ALICUT_EOG091G06Y7.clustalo.fasta EOG091G06Y7.fasta
        ProteinModelSelection.pl EOG091G06Y7.fasta 1> ../../../per_gene/EOG091G06Y7/EOG091G06Y7.best_model 2> ../../../per_gene/EOG091G06Y7/find_best_model.stderr.txt
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/c0c09ee657b1e27f2c5687e0e9aa8d70.simg
[Sun Jul  5 22:22:38 2020]
Finished job 1004.
972 of 3292 steps (30%) done

[Sun Jul  5 22:22:38 2020]
rule infer_single_ML:
    input: per_gene/EOG091G05RA/EOG091G05RA.best_model, per_gene/EOG091G05RA/ALICUT_EOG091G05RA.clustalo.fasta
    output: per_gene/EOG091G05RA/EOG091G05RA.raxml.done
    log: per_gene/EOG091G05RA/infer_single_ML.stdout.txt, per_gene/EOG091G05RA/infer_single_ML.stderr.txt
    jobid: 296
    wildcards: BUSCO=EOG091G05RA
    threads: 2


        cd per_gene/EOG091G05RA
	count=$(cat ../../per_gene/EOG091G05RA/ALICUT_EOG091G05RA.clustalo.fasta | grep ">" | wc -l)
	if [ "$count" -gt 5 ]
        then
		RAxMLmodel=$(cat ../../per_gene/EOG091G05RA/EOG091G05RA.best_model | grep "Best" | cut -d ":" -f 2 | tr -d '[:space:]')
                if [ "$(ls -1 | grep "^RAxML" | wc -l)" -ne 0 ]
		then
			rm RAxML*
		fi
        	raxml -f a -T 2 -m PROTGAMMA$RAxMLmodel         	-p 12345 -x 12345 -# 100         	-s ../../per_gene/EOG091G05RA/ALICUT_EOG091G05RA.clustalo.fasta -n EOG091G05RA.clustalo.aln.ALICUT.$RAxMLmodel 		1> ../../per_gene/EOG091G05RA/infer_single_ML.stdout.txt 2> ../../per_gene/EOG091G05RA/infer_single_ML.stderr.txt
	else
		echo "fasta file per_gene/EOG091G05RA/ALICUT_EOG091G05RA.clustalo.fasta contains fewer than 5 sequences - skipped" > ../../per_gene/EOG091G05RA/infer_single_ML.stdout.txt
		touch raxml.skipped
	fi
        touch ../../per_gene/EOG091G05RA/EOG091G05RA.raxml.done
        
[33mJob counts:
	count	jobs
	1	infer_single_ML
	1[0m
[33m
        cd per_gene/EOG091G05RA
	count=$(cat ../../per_gene/EOG091G05RA/ALICUT_EOG091G05RA.clustalo.fasta | grep ">" | wc -l)
	if [ "$count" -gt 5 ]
        then
		RAxMLmodel=$(cat ../../per_gene/EOG091G05RA/EOG091G05RA.best_model | grep "Best" | cut -d ":" -f 2 | tr -d '[:space:]')
                if [ "$(ls -1 | grep "^RAxML" | wc -l)" -ne 0 ]
		then
			rm RAxML*
		fi
        	raxml -f a -T 2 -m PROTGAMMA$RAxMLmodel         	-p 12345 -x 12345 -# 100         	-s ../../per_gene/EOG091G05RA/ALICUT_EOG091G05RA.clustalo.fasta -n EOG091G05RA.clustalo.aln.ALICUT.$RAxMLmodel 		1> ../../per_gene/EOG091G05RA/infer_single_ML.stdout.txt 2> ../../per_gene/EOG091G05RA/infer_single_ML.stderr.txt
	else
		echo "fasta file per_gene/EOG091G05RA/ALICUT_EOG091G05RA.clustalo.fasta contains fewer than 5 sequences - skipped" > ../../per_gene/EOG091G05RA/infer_single_ML.stdout.txt
		touch raxml.skipped
	fi
        touch ../../per_gene/EOG091G05RA/EOG091G05RA.raxml.done
        [0m
[Sun Jul  5 22:22:43 2020]
Finished job 703.
973 of 3292 steps (30%) done

[Sun Jul  5 22:22:43 2020]
rule remove_empty:
    input: per_gene/EOG091G0M22/ALICUT_EOG091G0M22.clustalo.fasta
    output: per_gene/EOG091G0M22/empty_check.done
    jobid: 1525
    wildcards: BUSCO=EOG091G0M22


         if [ "$(cat per_gene/EOG091G0M22/ALICUT_EOG091G0M22.clustalo.fasta | grep -v ">" | sed 's/-//g' | grep "^$" | wc -l)" -gt 0 ]
         then
              cp per_gene/EOG091G0M22/ALICUT_EOG091G0M22.clustalo.fasta per_gene/EOG091G0M22/ALICUT_EOG091G0M22.clustalo.fasta.backup
              bash ../scripts/remove_empty.sh per_gene/EOG091G0M22/ALICUT_EOG091G0M22.clustalo.fasta.backup > per_gene/EOG091G0M22/ALICUT_EOG091G0M22.clustalo.fasta
         fi
         touch per_gene/EOG091G0M22/empty_check.done
         
[Sun Jul  5 22:22:43 2020]
Finished job 1525.
974 of 3292 steps (30%) done

[Sun Jul  5 22:22:43 2020]
rule find_best_model:
    input: per_gene/EOG091G0M22/ALICUT_EOG091G0M22.clustalo.fasta, per_gene/EOG091G0M22/empty_check.done
    output: per_gene/EOG091G0M22/EOG091G0M22.best_model
    log: per_gene/EOG091G0M22/find_best_model.stderr.txt
    jobid: 702
    wildcards: BUSCO=EOG091G0M22
    threads: 2


        cd per_gene/EOG091G0M22
        if [ ! -d find_best_model ]
        then
            mkdir find_best_model
        fi
        cd find_best_model
        ln -s ../../../per_gene/EOG091G0M22/ALICUT_EOG091G0M22.clustalo.fasta EOG091G0M22.fasta
        ProteinModelSelection.pl EOG091G0M22.fasta 1> ../../../per_gene/EOG091G0M22/EOG091G0M22.best_model 2> ../../../per_gene/EOG091G0M22/find_best_model.stderr.txt
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/c0c09ee657b1e27f2c5687e0e9aa8d70.simg
[Sun Jul  5 22:23:17 2020]
Finished job 702.
975 of 3292 steps (30%) done

[Sun Jul  5 22:23:17 2020]
rule infer_single_ML:
    input: per_gene/EOG091G0M22/EOG091G0M22.best_model, per_gene/EOG091G0M22/ALICUT_EOG091G0M22.clustalo.fasta
    output: per_gene/EOG091G0M22/EOG091G0M22.raxml.done
    log: per_gene/EOG091G0M22/infer_single_ML.stdout.txt, per_gene/EOG091G0M22/infer_single_ML.stderr.txt
    jobid: 145
    wildcards: BUSCO=EOG091G0M22
    threads: 2


        cd per_gene/EOG091G0M22
	count=$(cat ../../per_gene/EOG091G0M22/ALICUT_EOG091G0M22.clustalo.fasta | grep ">" | wc -l)
	if [ "$count" -gt 5 ]
        then
		RAxMLmodel=$(cat ../../per_gene/EOG091G0M22/EOG091G0M22.best_model | grep "Best" | cut -d ":" -f 2 | tr -d '[:space:]')
                if [ "$(ls -1 | grep "^RAxML" | wc -l)" -ne 0 ]
		then
			rm RAxML*
		fi
        	raxml -f a -T 2 -m PROTGAMMA$RAxMLmodel         	-p 12345 -x 12345 -# 100         	-s ../../per_gene/EOG091G0M22/ALICUT_EOG091G0M22.clustalo.fasta -n EOG091G0M22.clustalo.aln.ALICUT.$RAxMLmodel 		1> ../../per_gene/EOG091G0M22/infer_single_ML.stdout.txt 2> ../../per_gene/EOG091G0M22/infer_single_ML.stderr.txt
	else
		echo "fasta file per_gene/EOG091G0M22/ALICUT_EOG091G0M22.clustalo.fasta contains fewer than 5 sequences - skipped" > ../../per_gene/EOG091G0M22/infer_single_ML.stdout.txt
		touch raxml.skipped
	fi
        touch ../../per_gene/EOG091G0M22/EOG091G0M22.raxml.done
        
[33mJob counts:
	count	jobs
	1	infer_single_ML
	1[0m
[33m
        cd per_gene/EOG091G0M22
	count=$(cat ../../per_gene/EOG091G0M22/ALICUT_EOG091G0M22.clustalo.fasta | grep ">" | wc -l)
	if [ "$count" -gt 5 ]
        then
		RAxMLmodel=$(cat ../../per_gene/EOG091G0M22/EOG091G0M22.best_model | grep "Best" | cut -d ":" -f 2 | tr -d '[:space:]')
                if [ "$(ls -1 | grep "^RAxML" | wc -l)" -ne 0 ]
		then
			rm RAxML*
		fi
        	raxml -f a -T 2 -m PROTGAMMA$RAxMLmodel         	-p 12345 -x 12345 -# 100         	-s ../../per_gene/EOG091G0M22/ALICUT_EOG091G0M22.clustalo.fasta -n EOG091G0M22.clustalo.aln.ALICUT.$RAxMLmodel 		1> ../../per_gene/EOG091G0M22/infer_single_ML.stdout.txt 2> ../../per_gene/EOG091G0M22/infer_single_ML.stderr.txt
	else
		echo "fasta file per_gene/EOG091G0M22/ALICUT_EOG091G0M22.clustalo.fasta contains fewer than 5 sequences - skipped" > ../../per_gene/EOG091G0M22/infer_single_ML.stdout.txt
		touch raxml.skipped
	fi
        touch ../../per_gene/EOG091G0M22/EOG091G0M22.raxml.done
        [0m
[Sun Jul  5 22:23:20 2020]
Finished job 130.
976 of 3292 steps (30%) done

[Sun Jul  5 22:23:20 2020]
rule get_seqs:
    input: /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ingroup.txt, /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/outgroup.txt
    output: per_gene/EOG091G05GZ/EOG091G05GZ.ingroup.fasta
    log: per_gene/EOG091G05GZ/get_seqs.stdout.txt, per_gene/EOG091G05GZ/get_seqs.stderr.txt
    jobid: 2538
    wildcards: BUSCO=EOG091G05GZ
    threads: 2


	basedir=$(pwd)
        cd per_gene/EOG091G05GZ
        
        bash $basedir/../scripts/fetch_seqs.sh EOG091G05GZ /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ingroup.txt /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/outgroup.txt 1> ../../per_gene/EOG091G05GZ/get_seqs.stdout.txt 2> ../../per_gene/EOG091G05GZ/get_seqs.stderr.txt
	mv EOG091G05GZ.fasta $basedir/per_gene/EOG091G05GZ/EOG091G05GZ.ingroup.fasta
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/72476f9d9a5bd0627b4d721143a21354.simg
[Sun Jul  5 22:23:24 2020]
Finished job 512.
977 of 3292 steps (30%) done

[Sun Jul  5 22:23:24 2020]
rule infer_single_ML:
    input: per_gene/EOG091G06Y7/EOG091G06Y7.best_model, per_gene/EOG091G06Y7/ALICUT_EOG091G06Y7.clustalo.fasta
    output: per_gene/EOG091G06Y7/EOG091G06Y7.raxml.done
    log: per_gene/EOG091G06Y7/infer_single_ML.stdout.txt, per_gene/EOG091G06Y7/infer_single_ML.stderr.txt
    jobid: 50
    wildcards: BUSCO=EOG091G06Y7
    threads: 2


        cd per_gene/EOG091G06Y7
	count=$(cat ../../per_gene/EOG091G06Y7/ALICUT_EOG091G06Y7.clustalo.fasta | grep ">" | wc -l)
	if [ "$count" -gt 5 ]
        then
		RAxMLmodel=$(cat ../../per_gene/EOG091G06Y7/EOG091G06Y7.best_model | grep "Best" | cut -d ":" -f 2 | tr -d '[:space:]')
                if [ "$(ls -1 | grep "^RAxML" | wc -l)" -ne 0 ]
		then
			rm RAxML*
		fi
        	raxml -f a -T 2 -m PROTGAMMA$RAxMLmodel         	-p 12345 -x 12345 -# 100         	-s ../../per_gene/EOG091G06Y7/ALICUT_EOG091G06Y7.clustalo.fasta -n EOG091G06Y7.clustalo.aln.ALICUT.$RAxMLmodel 		1> ../../per_gene/EOG091G06Y7/infer_single_ML.stdout.txt 2> ../../per_gene/EOG091G06Y7/infer_single_ML.stderr.txt
	else
		echo "fasta file per_gene/EOG091G06Y7/ALICUT_EOG091G06Y7.clustalo.fasta contains fewer than 5 sequences - skipped" > ../../per_gene/EOG091G06Y7/infer_single_ML.stdout.txt
		touch raxml.skipped
	fi
        touch ../../per_gene/EOG091G06Y7/EOG091G06Y7.raxml.done
        
[33mJob counts:
	count	jobs
	1	infer_single_ML
	1[0m
[33m
        cd per_gene/EOG091G06Y7
	count=$(cat ../../per_gene/EOG091G06Y7/ALICUT_EOG091G06Y7.clustalo.fasta | grep ">" | wc -l)
	if [ "$count" -gt 5 ]
        then
		RAxMLmodel=$(cat ../../per_gene/EOG091G06Y7/EOG091G06Y7.best_model | grep "Best" | cut -d ":" -f 2 | tr -d '[:space:]')
                if [ "$(ls -1 | grep "^RAxML" | wc -l)" -ne 0 ]
		then
			rm RAxML*
		fi
        	raxml -f a -T 2 -m PROTGAMMA$RAxMLmodel         	-p 12345 -x 12345 -# 100         	-s ../../per_gene/EOG091G06Y7/ALICUT_EOG091G06Y7.clustalo.fasta -n EOG091G06Y7.clustalo.aln.ALICUT.$RAxMLmodel 		1> ../../per_gene/EOG091G06Y7/infer_single_ML.stdout.txt 2> ../../per_gene/EOG091G06Y7/infer_single_ML.stderr.txt
	else
		echo "fasta file per_gene/EOG091G06Y7/ALICUT_EOG091G06Y7.clustalo.fasta contains fewer than 5 sequences - skipped" > ../../per_gene/EOG091G06Y7/infer_single_ML.stdout.txt
		touch raxml.skipped
	fi
        touch ../../per_gene/EOG091G06Y7/EOG091G06Y7.raxml.done
        [0m
[Sun Jul  5 22:23:35 2020]
Finished job 2538.
978 of 3292 steps (30%) done

[Sun Jul  5 22:23:35 2020]
rule get_outgroups:
    input: per_gene/EOG091G05GZ/EOG091G05GZ.ingroup.fasta
    output: per_gene/EOG091G05GZ/EOG091G05GZ.orthodb.fasta, per_gene/EOG091G05GZ/EOG091G05GZ.outgroup.fasta
    log: per_gene/EOG091G05GZ/get_outgroups.stdout.txt, per_gene/EOG091G05GZ/get_outgroups.stderr.txt
    jobid: 2539
    wildcards: BUSCO=EOG091G05GZ


        #download fastas from Orhtodb for BUSCO id
        for i in {1..5}
        do
             wget "http://www.orthodb.org/fasta?query=EOG091G05GZ&level=33208" -O per_gene/EOG091G05GZ/EOG091G05GZ.orthodb.fasta 1> per_gene/EOG091G05GZ/get_outgroups.stdout.txt 2> per_gene/EOG091G05GZ/get_outgroups.stderr.txt && break || echo -e "try again ($i)" && sleep 15
        done

	#This is quick an dirty for now and just takes the first protein if there is more than one for an outgroup taxon
        bash ../scripts/download_outgroups.sh taxids.txt per_gene/EOG091G05GZ/EOG091G05GZ.orthodb.fasta > per_gene/EOG091G05GZ/EOG091G05GZ.outgroup.fasta
        
[Sun Jul  5 22:23:36 2020]
Finished job 2539.
979 of 3292 steps (30%) done

[Sun Jul  5 22:23:36 2020]
rule join_groups:
    input: per_gene/EOG091G05GZ/EOG091G05GZ.ingroup.fasta, per_gene/EOG091G05GZ/EOG091G05GZ.outgroup.fasta
    output: per_gene/EOG091G05GZ/EOG091G05GZ.fasta
    jobid: 2093
    wildcards: BUSCO=EOG091G05GZ


        cat per_gene/EOG091G05GZ/EOG091G05GZ.ingroup.fasta per_gene/EOG091G05GZ/EOG091G05GZ.outgroup.fasta > per_gene/EOG091G05GZ/EOG091G05GZ.fasta
        
[Sun Jul  5 22:23:36 2020]
Finished job 2093.
980 of 3292 steps (30%) done

[Sun Jul  5 22:23:36 2020]
rule MSA:
    input: per_gene/EOG091G05GZ/EOG091G05GZ.fasta
    output: per_gene/EOG091G05GZ/EOG091G05GZ.clustalo.fasta
    log: per_gene/EOG091G05GZ/MSA.stdout.txt, per_gene/EOG091G05GZ/MSA.stderr.txt
    jobid: 1306
    wildcards: BUSCO=EOG091G05GZ
    threads: 2


        clustalo -i per_gene/EOG091G05GZ/EOG091G05GZ.fasta -o per_gene/EOG091G05GZ/EOG091G05GZ.clustalo.fasta --threads=2 1> per_gene/EOG091G05GZ/MSA.stdout.txt 2> per_gene/EOG091G05GZ/MSA.stderr.txt
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/d68c9691725a7401923680874285c430.simg
[Sun Jul  5 22:23:40 2020]
Finished job 1306.
981 of 3292 steps (30%) done

[Sun Jul  5 22:23:40 2020]
rule score_and_cut:
    input: per_gene/EOG091G05GZ/EOG091G05GZ.clustalo.fasta
    output: per_gene/EOG091G05GZ/ALICUT_EOG091G05GZ.clustalo.fasta
    jobid: 483
    wildcards: BUSCO=EOG091G05GZ
    threads: 2


        cd per_gene/EOG091G05GZ
        Aliscore.pl -N -r 200000000000000000 -i ../../per_gene/EOG091G05GZ/EOG091G05GZ.clustalo.fasta &> aliscore.log
        ALICUT.pl -s &> alicut.log
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/63c88c27a0fa300f57066b0ef65fefcb.simg
[Sun Jul  5 22:23:51 2020]
Finished job 483.
982 of 3292 steps (30%) done

[Sun Jul  5 22:23:51 2020]
rule remove_empty:
    input: per_gene/EOG091G05GZ/ALICUT_EOG091G05GZ.clustalo.fasta
    output: per_gene/EOG091G05GZ/empty_check.done
    jobid: 1305
    wildcards: BUSCO=EOG091G05GZ


         if [ "$(cat per_gene/EOG091G05GZ/ALICUT_EOG091G05GZ.clustalo.fasta | grep -v ">" | sed 's/-//g' | grep "^$" | wc -l)" -gt 0 ]
         then
              cp per_gene/EOG091G05GZ/ALICUT_EOG091G05GZ.clustalo.fasta per_gene/EOG091G05GZ/ALICUT_EOG091G05GZ.clustalo.fasta.backup
              bash ../scripts/remove_empty.sh per_gene/EOG091G05GZ/ALICUT_EOG091G05GZ.clustalo.fasta.backup > per_gene/EOG091G05GZ/ALICUT_EOG091G05GZ.clustalo.fasta
         fi
         touch per_gene/EOG091G05GZ/empty_check.done
         
[Sun Jul  5 22:23:51 2020]
Finished job 1305.
983 of 3292 steps (30%) done

[Sun Jul  5 22:23:51 2020]
rule find_best_model:
    input: per_gene/EOG091G05GZ/ALICUT_EOG091G05GZ.clustalo.fasta, per_gene/EOG091G05GZ/empty_check.done
    output: per_gene/EOG091G05GZ/EOG091G05GZ.best_model
    log: per_gene/EOG091G05GZ/find_best_model.stderr.txt
    jobid: 482
    wildcards: BUSCO=EOG091G05GZ
    threads: 2


        cd per_gene/EOG091G05GZ
        if [ ! -d find_best_model ]
        then
            mkdir find_best_model
        fi
        cd find_best_model
        ln -s ../../../per_gene/EOG091G05GZ/ALICUT_EOG091G05GZ.clustalo.fasta EOG091G05GZ.fasta
        ProteinModelSelection.pl EOG091G05GZ.fasta 1> ../../../per_gene/EOG091G05GZ/EOG091G05GZ.best_model 2> ../../../per_gene/EOG091G05GZ/find_best_model.stderr.txt
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/c0c09ee657b1e27f2c5687e0e9aa8d70.simg
[Sun Jul  5 22:24:14 2020]
Finished job 66.
984 of 3292 steps (30%) done

[Sun Jul  5 22:24:14 2020]
rule get_seqs:
    input: /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ingroup.txt, /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/outgroup.txt
    output: per_gene/EOG091G0FQ2/EOG091G0FQ2.ingroup.fasta
    log: per_gene/EOG091G0FQ2/get_seqs.stdout.txt, per_gene/EOG091G0FQ2/get_seqs.stderr.txt
    jobid: 2980
    wildcards: BUSCO=EOG091G0FQ2
    threads: 2


	basedir=$(pwd)
        cd per_gene/EOG091G0FQ2
        
        bash $basedir/../scripts/fetch_seqs.sh EOG091G0FQ2 /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ingroup.txt /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/outgroup.txt 1> ../../per_gene/EOG091G0FQ2/get_seqs.stdout.txt 2> ../../per_gene/EOG091G0FQ2/get_seqs.stderr.txt
	mv EOG091G0FQ2.fasta $basedir/per_gene/EOG091G0FQ2/EOG091G0FQ2.ingroup.fasta
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/72476f9d9a5bd0627b4d721143a21354.simg
[Sun Jul  5 22:24:20 2020]
Finished job 159.
985 of 3292 steps (30%) done

[Sun Jul  5 22:24:20 2020]
rule get_seqs:
    input: /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ingroup.txt, /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/outgroup.txt
    output: per_gene/EOG091G0RM8/EOG091G0RM8.ingroup.fasta
    log: per_gene/EOG091G0RM8/get_seqs.stdout.txt, per_gene/EOG091G0RM8/get_seqs.stderr.txt
    jobid: 3016
    wildcards: BUSCO=EOG091G0RM8
    threads: 2


	basedir=$(pwd)
        cd per_gene/EOG091G0RM8
        
        bash $basedir/../scripts/fetch_seqs.sh EOG091G0RM8 /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ingroup.txt /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/outgroup.txt 1> ../../per_gene/EOG091G0RM8/get_seqs.stdout.txt 2> ../../per_gene/EOG091G0RM8/get_seqs.stderr.txt
	mv EOG091G0RM8.fasta $basedir/per_gene/EOG091G0RM8/EOG091G0RM8.ingroup.fasta
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/72476f9d9a5bd0627b4d721143a21354.simg
[Sun Jul  5 22:24:30 2020]
Finished job 2980.
986 of 3292 steps (30%) done

[Sun Jul  5 22:24:30 2020]
rule get_outgroups:
    input: per_gene/EOG091G0FQ2/EOG091G0FQ2.ingroup.fasta
    output: per_gene/EOG091G0FQ2/EOG091G0FQ2.orthodb.fasta, per_gene/EOG091G0FQ2/EOG091G0FQ2.outgroup.fasta
    log: per_gene/EOG091G0FQ2/get_outgroups.stdout.txt, per_gene/EOG091G0FQ2/get_outgroups.stderr.txt
    jobid: 2981
    wildcards: BUSCO=EOG091G0FQ2


        #download fastas from Orhtodb for BUSCO id
        for i in {1..5}
        do
             wget "http://www.orthodb.org/fasta?query=EOG091G0FQ2&level=33208" -O per_gene/EOG091G0FQ2/EOG091G0FQ2.orthodb.fasta 1> per_gene/EOG091G0FQ2/get_outgroups.stdout.txt 2> per_gene/EOG091G0FQ2/get_outgroups.stderr.txt && break || echo -e "try again ($i)" && sleep 15
        done

	#This is quick an dirty for now and just takes the first protein if there is more than one for an outgroup taxon
        bash ../scripts/download_outgroups.sh taxids.txt per_gene/EOG091G0FQ2/EOG091G0FQ2.orthodb.fasta > per_gene/EOG091G0FQ2/EOG091G0FQ2.outgroup.fasta
        
[Sun Jul  5 22:24:31 2020]
Finished job 2981.
987 of 3292 steps (30%) done

[Sun Jul  5 22:24:31 2020]
rule join_groups:
    input: per_gene/EOG091G0FQ2/EOG091G0FQ2.ingroup.fasta, per_gene/EOG091G0FQ2/EOG091G0FQ2.outgroup.fasta
    output: per_gene/EOG091G0FQ2/EOG091G0FQ2.fasta
    jobid: 2314
    wildcards: BUSCO=EOG091G0FQ2


        cat per_gene/EOG091G0FQ2/EOG091G0FQ2.ingroup.fasta per_gene/EOG091G0FQ2/EOG091G0FQ2.outgroup.fasta > per_gene/EOG091G0FQ2/EOG091G0FQ2.fasta
        
[Sun Jul  5 22:24:31 2020]
Finished job 2314.
988 of 3292 steps (30%) done

[Sun Jul  5 22:24:31 2020]
rule MSA:
    input: per_gene/EOG091G0FQ2/EOG091G0FQ2.fasta
    output: per_gene/EOG091G0FQ2/EOG091G0FQ2.clustalo.fasta
    log: per_gene/EOG091G0FQ2/MSA.stdout.txt, per_gene/EOG091G0FQ2/MSA.stderr.txt
    jobid: 1748
    wildcards: BUSCO=EOG091G0FQ2
    threads: 2


        clustalo -i per_gene/EOG091G0FQ2/EOG091G0FQ2.fasta -o per_gene/EOG091G0FQ2/EOG091G0FQ2.clustalo.fasta --threads=2 1> per_gene/EOG091G0FQ2/MSA.stdout.txt 2> per_gene/EOG091G0FQ2/MSA.stderr.txt
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/d68c9691725a7401923680874285c430.simg
[Sun Jul  5 22:24:32 2020]
Finished job 1748.
989 of 3292 steps (30%) done

[Sun Jul  5 22:24:33 2020]
rule score_and_cut:
    input: per_gene/EOG091G0FQ2/EOG091G0FQ2.clustalo.fasta
    output: per_gene/EOG091G0FQ2/ALICUT_EOG091G0FQ2.clustalo.fasta
    jobid: 925
    wildcards: BUSCO=EOG091G0FQ2
    threads: 2


        cd per_gene/EOG091G0FQ2
        Aliscore.pl -N -r 200000000000000000 -i ../../per_gene/EOG091G0FQ2/EOG091G0FQ2.clustalo.fasta &> aliscore.log
        ALICUT.pl -s &> alicut.log
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/63c88c27a0fa300f57066b0ef65fefcb.simg
[Sun Jul  5 22:24:35 2020]
Finished job 3016.
990 of 3292 steps (30%) done

[Sun Jul  5 22:24:35 2020]
rule get_outgroups:
    input: per_gene/EOG091G0RM8/EOG091G0RM8.ingroup.fasta
    output: per_gene/EOG091G0RM8/EOG091G0RM8.orthodb.fasta, per_gene/EOG091G0RM8/EOG091G0RM8.outgroup.fasta
    log: per_gene/EOG091G0RM8/get_outgroups.stdout.txt, per_gene/EOG091G0RM8/get_outgroups.stderr.txt
    jobid: 3017
    wildcards: BUSCO=EOG091G0RM8


        #download fastas from Orhtodb for BUSCO id
        for i in {1..5}
        do
             wget "http://www.orthodb.org/fasta?query=EOG091G0RM8&level=33208" -O per_gene/EOG091G0RM8/EOG091G0RM8.orthodb.fasta 1> per_gene/EOG091G0RM8/get_outgroups.stdout.txt 2> per_gene/EOG091G0RM8/get_outgroups.stderr.txt && break || echo -e "try again ($i)" && sleep 15
        done

	#This is quick an dirty for now and just takes the first protein if there is more than one for an outgroup taxon
        bash ../scripts/download_outgroups.sh taxids.txt per_gene/EOG091G0RM8/EOG091G0RM8.orthodb.fasta > per_gene/EOG091G0RM8/EOG091G0RM8.outgroup.fasta
        
[Sun Jul  5 22:24:35 2020]
Finished job 3017.
991 of 3292 steps (30%) done

[Sun Jul  5 22:24:35 2020]
rule join_groups:
    input: per_gene/EOG091G0RM8/EOG091G0RM8.ingroup.fasta, per_gene/EOG091G0RM8/EOG091G0RM8.outgroup.fasta
    output: per_gene/EOG091G0RM8/EOG091G0RM8.fasta
    jobid: 2332
    wildcards: BUSCO=EOG091G0RM8


        cat per_gene/EOG091G0RM8/EOG091G0RM8.ingroup.fasta per_gene/EOG091G0RM8/EOG091G0RM8.outgroup.fasta > per_gene/EOG091G0RM8/EOG091G0RM8.fasta
        
[Sun Jul  5 22:24:35 2020]
Finished job 2332.
992 of 3292 steps (30%) done

[Sun Jul  5 22:24:35 2020]
rule MSA:
    input: per_gene/EOG091G0RM8/EOG091G0RM8.fasta
    output: per_gene/EOG091G0RM8/EOG091G0RM8.clustalo.fasta
    log: per_gene/EOG091G0RM8/MSA.stdout.txt, per_gene/EOG091G0RM8/MSA.stderr.txt
    jobid: 1784
    wildcards: BUSCO=EOG091G0RM8
    threads: 2


        clustalo -i per_gene/EOG091G0RM8/EOG091G0RM8.fasta -o per_gene/EOG091G0RM8/EOG091G0RM8.clustalo.fasta --threads=2 1> per_gene/EOG091G0RM8/MSA.stdout.txt 2> per_gene/EOG091G0RM8/MSA.stderr.txt
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/d68c9691725a7401923680874285c430.simg
[Sun Jul  5 22:24:36 2020]
Finished job 1784.
993 of 3292 steps (30%) done

[Sun Jul  5 22:24:36 2020]
rule score_and_cut:
    input: per_gene/EOG091G0RM8/EOG091G0RM8.clustalo.fasta
    output: per_gene/EOG091G0RM8/ALICUT_EOG091G0RM8.clustalo.fasta
    jobid: 961
    wildcards: BUSCO=EOG091G0RM8
    threads: 2


        cd per_gene/EOG091G0RM8
        Aliscore.pl -N -r 200000000000000000 -i ../../per_gene/EOG091G0RM8/EOG091G0RM8.clustalo.fasta &> aliscore.log
        ALICUT.pl -s &> alicut.log
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/63c88c27a0fa300f57066b0ef65fefcb.simg
[Sun Jul  5 22:24:38 2020]
Finished job 482.
994 of 3292 steps (30%) done

[Sun Jul  5 22:24:38 2020]
rule infer_single_ML:
    input: per_gene/EOG091G05GZ/EOG091G05GZ.best_model, per_gene/EOG091G05GZ/ALICUT_EOG091G05GZ.clustalo.fasta
    output: per_gene/EOG091G05GZ/EOG091G05GZ.raxml.done
    log: per_gene/EOG091G05GZ/infer_single_ML.stdout.txt, per_gene/EOG091G05GZ/infer_single_ML.stderr.txt
    jobid: 35
    wildcards: BUSCO=EOG091G05GZ
    threads: 2


        cd per_gene/EOG091G05GZ
	count=$(cat ../../per_gene/EOG091G05GZ/ALICUT_EOG091G05GZ.clustalo.fasta | grep ">" | wc -l)
	if [ "$count" -gt 5 ]
        then
		RAxMLmodel=$(cat ../../per_gene/EOG091G05GZ/EOG091G05GZ.best_model | grep "Best" | cut -d ":" -f 2 | tr -d '[:space:]')
                if [ "$(ls -1 | grep "^RAxML" | wc -l)" -ne 0 ]
		then
			rm RAxML*
		fi
        	raxml -f a -T 2 -m PROTGAMMA$RAxMLmodel         	-p 12345 -x 12345 -# 100         	-s ../../per_gene/EOG091G05GZ/ALICUT_EOG091G05GZ.clustalo.fasta -n EOG091G05GZ.clustalo.aln.ALICUT.$RAxMLmodel 		1> ../../per_gene/EOG091G05GZ/infer_single_ML.stdout.txt 2> ../../per_gene/EOG091G05GZ/infer_single_ML.stderr.txt
	else
		echo "fasta file per_gene/EOG091G05GZ/ALICUT_EOG091G05GZ.clustalo.fasta contains fewer than 5 sequences - skipped" > ../../per_gene/EOG091G05GZ/infer_single_ML.stdout.txt
		touch raxml.skipped
	fi
        touch ../../per_gene/EOG091G05GZ/EOG091G05GZ.raxml.done
        
[33mJob counts:
	count	jobs
	1	infer_single_ML
	1[0m
[33m
        cd per_gene/EOG091G05GZ
	count=$(cat ../../per_gene/EOG091G05GZ/ALICUT_EOG091G05GZ.clustalo.fasta | grep ">" | wc -l)
	if [ "$count" -gt 5 ]
        then
		RAxMLmodel=$(cat ../../per_gene/EOG091G05GZ/EOG091G05GZ.best_model | grep "Best" | cut -d ":" -f 2 | tr -d '[:space:]')
                if [ "$(ls -1 | grep "^RAxML" | wc -l)" -ne 0 ]
		then
			rm RAxML*
		fi
        	raxml -f a -T 2 -m PROTGAMMA$RAxMLmodel         	-p 12345 -x 12345 -# 100         	-s ../../per_gene/EOG091G05GZ/ALICUT_EOG091G05GZ.clustalo.fasta -n EOG091G05GZ.clustalo.aln.ALICUT.$RAxMLmodel 		1> ../../per_gene/EOG091G05GZ/infer_single_ML.stdout.txt 2> ../../per_gene/EOG091G05GZ/infer_single_ML.stderr.txt
	else
		echo "fasta file per_gene/EOG091G05GZ/ALICUT_EOG091G05GZ.clustalo.fasta contains fewer than 5 sequences - skipped" > ../../per_gene/EOG091G05GZ/infer_single_ML.stdout.txt
		touch raxml.skipped
	fi
        touch ../../per_gene/EOG091G05GZ/EOG091G05GZ.raxml.done
        [0m
[Sun Jul  5 22:24:42 2020]
Finished job 925.
995 of 3292 steps (30%) done

[Sun Jul  5 22:24:42 2020]
rule remove_empty:
    input: per_gene/EOG091G0FQ2/ALICUT_EOG091G0FQ2.clustalo.fasta
    output: per_gene/EOG091G0FQ2/empty_check.done
    jobid: 1747
    wildcards: BUSCO=EOG091G0FQ2


         if [ "$(cat per_gene/EOG091G0FQ2/ALICUT_EOG091G0FQ2.clustalo.fasta | grep -v ">" | sed 's/-//g' | grep "^$" | wc -l)" -gt 0 ]
         then
              cp per_gene/EOG091G0FQ2/ALICUT_EOG091G0FQ2.clustalo.fasta per_gene/EOG091G0FQ2/ALICUT_EOG091G0FQ2.clustalo.fasta.backup
              bash ../scripts/remove_empty.sh per_gene/EOG091G0FQ2/ALICUT_EOG091G0FQ2.clustalo.fasta.backup > per_gene/EOG091G0FQ2/ALICUT_EOG091G0FQ2.clustalo.fasta
         fi
         touch per_gene/EOG091G0FQ2/empty_check.done
         
[Sun Jul  5 22:24:42 2020]
Finished job 1747.
996 of 3292 steps (30%) done

[Sun Jul  5 22:24:42 2020]
rule find_best_model:
    input: per_gene/EOG091G0FQ2/ALICUT_EOG091G0FQ2.clustalo.fasta, per_gene/EOG091G0FQ2/empty_check.done
    output: per_gene/EOG091G0FQ2/EOG091G0FQ2.best_model
    log: per_gene/EOG091G0FQ2/find_best_model.stderr.txt
    jobid: 924
    wildcards: BUSCO=EOG091G0FQ2
    threads: 2


        cd per_gene/EOG091G0FQ2
        if [ ! -d find_best_model ]
        then
            mkdir find_best_model
        fi
        cd find_best_model
        ln -s ../../../per_gene/EOG091G0FQ2/ALICUT_EOG091G0FQ2.clustalo.fasta EOG091G0FQ2.fasta
        ProteinModelSelection.pl EOG091G0FQ2.fasta 1> ../../../per_gene/EOG091G0FQ2/EOG091G0FQ2.best_model 2> ../../../per_gene/EOG091G0FQ2/find_best_model.stderr.txt
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/c0c09ee657b1e27f2c5687e0e9aa8d70.simg
[Sun Jul  5 22:24:47 2020]
Finished job 961.
997 of 3292 steps (30%) done

[Sun Jul  5 22:24:47 2020]
rule remove_empty:
    input: per_gene/EOG091G0RM8/ALICUT_EOG091G0RM8.clustalo.fasta
    output: per_gene/EOG091G0RM8/empty_check.done
    jobid: 1783
    wildcards: BUSCO=EOG091G0RM8


         if [ "$(cat per_gene/EOG091G0RM8/ALICUT_EOG091G0RM8.clustalo.fasta | grep -v ">" | sed 's/-//g' | grep "^$" | wc -l)" -gt 0 ]
         then
              cp per_gene/EOG091G0RM8/ALICUT_EOG091G0RM8.clustalo.fasta per_gene/EOG091G0RM8/ALICUT_EOG091G0RM8.clustalo.fasta.backup
              bash ../scripts/remove_empty.sh per_gene/EOG091G0RM8/ALICUT_EOG091G0RM8.clustalo.fasta.backup > per_gene/EOG091G0RM8/ALICUT_EOG091G0RM8.clustalo.fasta
         fi
         touch per_gene/EOG091G0RM8/empty_check.done
         
[Sun Jul  5 22:24:47 2020]
Finished job 1783.
998 of 3292 steps (30%) done

[Sun Jul  5 22:24:47 2020]
rule find_best_model:
    input: per_gene/EOG091G0RM8/ALICUT_EOG091G0RM8.clustalo.fasta, per_gene/EOG091G0RM8/empty_check.done
    output: per_gene/EOG091G0RM8/EOG091G0RM8.best_model
    log: per_gene/EOG091G0RM8/find_best_model.stderr.txt
    jobid: 960
    wildcards: BUSCO=EOG091G0RM8
    threads: 2


        cd per_gene/EOG091G0RM8
        if [ ! -d find_best_model ]
        then
            mkdir find_best_model
        fi
        cd find_best_model
        ln -s ../../../per_gene/EOG091G0RM8/ALICUT_EOG091G0RM8.clustalo.fasta EOG091G0RM8.fasta
        ProteinModelSelection.pl EOG091G0RM8.fasta 1> ../../../per_gene/EOG091G0RM8/EOG091G0RM8.best_model 2> ../../../per_gene/EOG091G0RM8/find_best_model.stderr.txt
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/c0c09ee657b1e27f2c5687e0e9aa8d70.simg
[Sun Jul  5 22:25:16 2020]
Finished job 145.
999 of 3292 steps (30%) done

[Sun Jul  5 22:25:16 2020]
rule get_seqs:
    input: /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ingroup.txt, /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/outgroup.txt
    output: per_gene/EOG091G0QUH/EOG091G0QUH.ingroup.fasta
    log: per_gene/EOG091G0QUH/get_seqs.stdout.txt, per_gene/EOG091G0QUH/get_seqs.stderr.txt
    jobid: 2822
    wildcards: BUSCO=EOG091G0QUH
    threads: 2


	basedir=$(pwd)
        cd per_gene/EOG091G0QUH
        
        bash $basedir/../scripts/fetch_seqs.sh EOG091G0QUH /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ingroup.txt /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/outgroup.txt 1> ../../per_gene/EOG091G0QUH/get_seqs.stdout.txt 2> ../../per_gene/EOG091G0QUH/get_seqs.stderr.txt
	mv EOG091G0QUH.fasta $basedir/per_gene/EOG091G0QUH/EOG091G0QUH.ingroup.fasta
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/72476f9d9a5bd0627b4d721143a21354.simg
[Sun Jul  5 22:25:20 2020]
Finished job 960.
1000 of 3292 steps (30%) done

[Sun Jul  5 22:25:20 2020]
rule infer_single_ML:
    input: per_gene/EOG091G0RM8/EOG091G0RM8.best_model, per_gene/EOG091G0RM8/ALICUT_EOG091G0RM8.clustalo.fasta
    output: per_gene/EOG091G0RM8/EOG091G0RM8.raxml.done
    log: per_gene/EOG091G0RM8/infer_single_ML.stdout.txt, per_gene/EOG091G0RM8/infer_single_ML.stderr.txt
    jobid: 274
    wildcards: BUSCO=EOG091G0RM8
    threads: 2


        cd per_gene/EOG091G0RM8
	count=$(cat ../../per_gene/EOG091G0RM8/ALICUT_EOG091G0RM8.clustalo.fasta | grep ">" | wc -l)
	if [ "$count" -gt 5 ]
        then
		RAxMLmodel=$(cat ../../per_gene/EOG091G0RM8/EOG091G0RM8.best_model | grep "Best" | cut -d ":" -f 2 | tr -d '[:space:]')
                if [ "$(ls -1 | grep "^RAxML" | wc -l)" -ne 0 ]
		then
			rm RAxML*
		fi
        	raxml -f a -T 2 -m PROTGAMMA$RAxMLmodel         	-p 12345 -x 12345 -# 100         	-s ../../per_gene/EOG091G0RM8/ALICUT_EOG091G0RM8.clustalo.fasta -n EOG091G0RM8.clustalo.aln.ALICUT.$RAxMLmodel 		1> ../../per_gene/EOG091G0RM8/infer_single_ML.stdout.txt 2> ../../per_gene/EOG091G0RM8/infer_single_ML.stderr.txt
	else
		echo "fasta file per_gene/EOG091G0RM8/ALICUT_EOG091G0RM8.clustalo.fasta contains fewer than 5 sequences - skipped" > ../../per_gene/EOG091G0RM8/infer_single_ML.stdout.txt
		touch raxml.skipped
	fi
        touch ../../per_gene/EOG091G0RM8/EOG091G0RM8.raxml.done
        
[33mJob counts:
	count	jobs
	1	infer_single_ML
	1[0m
[33m
        cd per_gene/EOG091G0RM8
	count=$(cat ../../per_gene/EOG091G0RM8/ALICUT_EOG091G0RM8.clustalo.fasta | grep ">" | wc -l)
	if [ "$count" -gt 5 ]
        then
		RAxMLmodel=$(cat ../../per_gene/EOG091G0RM8/EOG091G0RM8.best_model | grep "Best" | cut -d ":" -f 2 | tr -d '[:space:]')
                if [ "$(ls -1 | grep "^RAxML" | wc -l)" -ne 0 ]
		then
			rm RAxML*
		fi
        	raxml -f a -T 2 -m PROTGAMMA$RAxMLmodel         	-p 12345 -x 12345 -# 100         	-s ../../per_gene/EOG091G0RM8/ALICUT_EOG091G0RM8.clustalo.fasta -n EOG091G0RM8.clustalo.aln.ALICUT.$RAxMLmodel 		1> ../../per_gene/EOG091G0RM8/infer_single_ML.stdout.txt 2> ../../per_gene/EOG091G0RM8/infer_single_ML.stderr.txt
	else
		echo "fasta file per_gene/EOG091G0RM8/ALICUT_EOG091G0RM8.clustalo.fasta contains fewer than 5 sequences - skipped" > ../../per_gene/EOG091G0RM8/infer_single_ML.stdout.txt
		touch raxml.skipped
	fi
        touch ../../per_gene/EOG091G0RM8/EOG091G0RM8.raxml.done
        [0m
[Sun Jul  5 22:25:25 2020]
Finished job 924.
1001 of 3292 steps (30%) done

[Sun Jul  5 22:25:25 2020]
rule infer_single_ML:
    input: per_gene/EOG091G0FQ2/EOG091G0FQ2.best_model, per_gene/EOG091G0FQ2/ALICUT_EOG091G0FQ2.clustalo.fasta
    output: per_gene/EOG091G0FQ2/EOG091G0FQ2.raxml.done
    log: per_gene/EOG091G0FQ2/infer_single_ML.stdout.txt, per_gene/EOG091G0FQ2/infer_single_ML.stderr.txt
    jobid: 256
    wildcards: BUSCO=EOG091G0FQ2
    threads: 2


        cd per_gene/EOG091G0FQ2
	count=$(cat ../../per_gene/EOG091G0FQ2/ALICUT_EOG091G0FQ2.clustalo.fasta | grep ">" | wc -l)
	if [ "$count" -gt 5 ]
        then
		RAxMLmodel=$(cat ../../per_gene/EOG091G0FQ2/EOG091G0FQ2.best_model | grep "Best" | cut -d ":" -f 2 | tr -d '[:space:]')
                if [ "$(ls -1 | grep "^RAxML" | wc -l)" -ne 0 ]
		then
			rm RAxML*
		fi
        	raxml -f a -T 2 -m PROTGAMMA$RAxMLmodel         	-p 12345 -x 12345 -# 100         	-s ../../per_gene/EOG091G0FQ2/ALICUT_EOG091G0FQ2.clustalo.fasta -n EOG091G0FQ2.clustalo.aln.ALICUT.$RAxMLmodel 		1> ../../per_gene/EOG091G0FQ2/infer_single_ML.stdout.txt 2> ../../per_gene/EOG091G0FQ2/infer_single_ML.stderr.txt
	else
		echo "fasta file per_gene/EOG091G0FQ2/ALICUT_EOG091G0FQ2.clustalo.fasta contains fewer than 5 sequences - skipped" > ../../per_gene/EOG091G0FQ2/infer_single_ML.stdout.txt
		touch raxml.skipped
	fi
        touch ../../per_gene/EOG091G0FQ2/EOG091G0FQ2.raxml.done
        
[33mJob counts:
	count	jobs
	1	infer_single_ML
	1[0m
[33m
        cd per_gene/EOG091G0FQ2
	count=$(cat ../../per_gene/EOG091G0FQ2/ALICUT_EOG091G0FQ2.clustalo.fasta | grep ">" | wc -l)
	if [ "$count" -gt 5 ]
        then
		RAxMLmodel=$(cat ../../per_gene/EOG091G0FQ2/EOG091G0FQ2.best_model | grep "Best" | cut -d ":" -f 2 | tr -d '[:space:]')
                if [ "$(ls -1 | grep "^RAxML" | wc -l)" -ne 0 ]
		then
			rm RAxML*
		fi
        	raxml -f a -T 2 -m PROTGAMMA$RAxMLmodel         	-p 12345 -x 12345 -# 100         	-s ../../per_gene/EOG091G0FQ2/ALICUT_EOG091G0FQ2.clustalo.fasta -n EOG091G0FQ2.clustalo.aln.ALICUT.$RAxMLmodel 		1> ../../per_gene/EOG091G0FQ2/infer_single_ML.stdout.txt 2> ../../per_gene/EOG091G0FQ2/infer_single_ML.stderr.txt
	else
		echo "fasta file per_gene/EOG091G0FQ2/ALICUT_EOG091G0FQ2.clustalo.fasta contains fewer than 5 sequences - skipped" > ../../per_gene/EOG091G0FQ2/infer_single_ML.stdout.txt
		touch raxml.skipped
	fi
        touch ../../per_gene/EOG091G0FQ2/EOG091G0FQ2.raxml.done
        [0m
[Sun Jul  5 22:25:30 2020]
Finished job 2822.
1002 of 3292 steps (30%) done

[Sun Jul  5 22:25:30 2020]
rule get_outgroups:
    input: per_gene/EOG091G0QUH/EOG091G0QUH.ingroup.fasta
    output: per_gene/EOG091G0QUH/EOG091G0QUH.orthodb.fasta, per_gene/EOG091G0QUH/EOG091G0QUH.outgroup.fasta
    log: per_gene/EOG091G0QUH/get_outgroups.stdout.txt, per_gene/EOG091G0QUH/get_outgroups.stderr.txt
    jobid: 2823
    wildcards: BUSCO=EOG091G0QUH


        #download fastas from Orhtodb for BUSCO id
        for i in {1..5}
        do
             wget "http://www.orthodb.org/fasta?query=EOG091G0QUH&level=33208" -O per_gene/EOG091G0QUH/EOG091G0QUH.orthodb.fasta 1> per_gene/EOG091G0QUH/get_outgroups.stdout.txt 2> per_gene/EOG091G0QUH/get_outgroups.stderr.txt && break || echo -e "try again ($i)" && sleep 15
        done

	#This is quick an dirty for now and just takes the first protein if there is more than one for an outgroup taxon
        bash ../scripts/download_outgroups.sh taxids.txt per_gene/EOG091G0QUH/EOG091G0QUH.orthodb.fasta > per_gene/EOG091G0QUH/EOG091G0QUH.outgroup.fasta
        
[Sun Jul  5 22:25:31 2020]
Finished job 2823.
1003 of 3292 steps (30%) done

[Sun Jul  5 22:25:31 2020]
rule join_groups:
    input: per_gene/EOG091G0QUH/EOG091G0QUH.ingroup.fasta, per_gene/EOG091G0QUH/EOG091G0QUH.outgroup.fasta
    output: per_gene/EOG091G0QUH/EOG091G0QUH.fasta
    jobid: 2235
    wildcards: BUSCO=EOG091G0QUH


        cat per_gene/EOG091G0QUH/EOG091G0QUH.ingroup.fasta per_gene/EOG091G0QUH/EOG091G0QUH.outgroup.fasta > per_gene/EOG091G0QUH/EOG091G0QUH.fasta
        
[Sun Jul  5 22:25:31 2020]
Finished job 2235.
1004 of 3292 steps (30%) done

[Sun Jul  5 22:25:31 2020]
rule MSA:
    input: per_gene/EOG091G0QUH/EOG091G0QUH.fasta
    output: per_gene/EOG091G0QUH/EOG091G0QUH.clustalo.fasta
    log: per_gene/EOG091G0QUH/MSA.stdout.txt, per_gene/EOG091G0QUH/MSA.stderr.txt
    jobid: 1590
    wildcards: BUSCO=EOG091G0QUH
    threads: 2


        clustalo -i per_gene/EOG091G0QUH/EOG091G0QUH.fasta -o per_gene/EOG091G0QUH/EOG091G0QUH.clustalo.fasta --threads=2 1> per_gene/EOG091G0QUH/MSA.stdout.txt 2> per_gene/EOG091G0QUH/MSA.stderr.txt
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/d68c9691725a7401923680874285c430.simg
[Sun Jul  5 22:25:32 2020]
Finished job 1590.
1005 of 3292 steps (31%) done

[Sun Jul  5 22:25:32 2020]
rule score_and_cut:
    input: per_gene/EOG091G0QUH/EOG091G0QUH.clustalo.fasta
    output: per_gene/EOG091G0QUH/ALICUT_EOG091G0QUH.clustalo.fasta
    jobid: 767
    wildcards: BUSCO=EOG091G0QUH
    threads: 2


        cd per_gene/EOG091G0QUH
        Aliscore.pl -N -r 200000000000000000 -i ../../per_gene/EOG091G0QUH/EOG091G0QUH.clustalo.fasta &> aliscore.log
        ALICUT.pl -s &> alicut.log
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/63c88c27a0fa300f57066b0ef65fefcb.simg
[Sun Jul  5 22:25:42 2020]
Finished job 767.
1006 of 3292 steps (31%) done

[Sun Jul  5 22:25:42 2020]
rule remove_empty:
    input: per_gene/EOG091G0QUH/ALICUT_EOG091G0QUH.clustalo.fasta
    output: per_gene/EOG091G0QUH/empty_check.done
    jobid: 1589
    wildcards: BUSCO=EOG091G0QUH


         if [ "$(cat per_gene/EOG091G0QUH/ALICUT_EOG091G0QUH.clustalo.fasta | grep -v ">" | sed 's/-//g' | grep "^$" | wc -l)" -gt 0 ]
         then
              cp per_gene/EOG091G0QUH/ALICUT_EOG091G0QUH.clustalo.fasta per_gene/EOG091G0QUH/ALICUT_EOG091G0QUH.clustalo.fasta.backup
              bash ../scripts/remove_empty.sh per_gene/EOG091G0QUH/ALICUT_EOG091G0QUH.clustalo.fasta.backup > per_gene/EOG091G0QUH/ALICUT_EOG091G0QUH.clustalo.fasta
         fi
         touch per_gene/EOG091G0QUH/empty_check.done
         
[Sun Jul  5 22:25:42 2020]
Finished job 1589.
1007 of 3292 steps (31%) done

[Sun Jul  5 22:25:42 2020]
rule find_best_model:
    input: per_gene/EOG091G0QUH/ALICUT_EOG091G0QUH.clustalo.fasta, per_gene/EOG091G0QUH/empty_check.done
    output: per_gene/EOG091G0QUH/EOG091G0QUH.best_model
    log: per_gene/EOG091G0QUH/find_best_model.stderr.txt
    jobid: 766
    wildcards: BUSCO=EOG091G0QUH
    threads: 2


        cd per_gene/EOG091G0QUH
        if [ ! -d find_best_model ]
        then
            mkdir find_best_model
        fi
        cd find_best_model
        ln -s ../../../per_gene/EOG091G0QUH/ALICUT_EOG091G0QUH.clustalo.fasta EOG091G0QUH.fasta
        ProteinModelSelection.pl EOG091G0QUH.fasta 1> ../../../per_gene/EOG091G0QUH/EOG091G0QUH.best_model 2> ../../../per_gene/EOG091G0QUH/find_best_model.stderr.txt
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/c0c09ee657b1e27f2c5687e0e9aa8d70.simg
[Sun Jul  5 22:25:50 2020]
Finished job 333.
1008 of 3292 steps (31%) done

[Sun Jul  5 22:25:50 2020]
rule get_seqs:
    input: /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ingroup.txt, /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/outgroup.txt
    output: per_gene/EOG091G0MLD/EOG091G0MLD.ingroup.fasta
    log: per_gene/EOG091G0MLD/get_seqs.stdout.txt, per_gene/EOG091G0MLD/get_seqs.stderr.txt
    jobid: 3236
    wildcards: BUSCO=EOG091G0MLD
    threads: 2


	basedir=$(pwd)
        cd per_gene/EOG091G0MLD
        
        bash $basedir/../scripts/fetch_seqs.sh EOG091G0MLD /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ingroup.txt /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/outgroup.txt 1> ../../per_gene/EOG091G0MLD/get_seqs.stdout.txt 2> ../../per_gene/EOG091G0MLD/get_seqs.stderr.txt
	mv EOG091G0MLD.fasta $basedir/per_gene/EOG091G0MLD/EOG091G0MLD.ingroup.fasta
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/72476f9d9a5bd0627b4d721143a21354.simg
[Sun Jul  5 22:26:04 2020]
Finished job 3236.
1009 of 3292 steps (31%) done

[Sun Jul  5 22:26:04 2020]
rule get_outgroups:
    input: per_gene/EOG091G0MLD/EOG091G0MLD.ingroup.fasta
    output: per_gene/EOG091G0MLD/EOG091G0MLD.orthodb.fasta, per_gene/EOG091G0MLD/EOG091G0MLD.outgroup.fasta
    log: per_gene/EOG091G0MLD/get_outgroups.stdout.txt, per_gene/EOG091G0MLD/get_outgroups.stderr.txt
    jobid: 3237
    wildcards: BUSCO=EOG091G0MLD


        #download fastas from Orhtodb for BUSCO id
        for i in {1..5}
        do
             wget "http://www.orthodb.org/fasta?query=EOG091G0MLD&level=33208" -O per_gene/EOG091G0MLD/EOG091G0MLD.orthodb.fasta 1> per_gene/EOG091G0MLD/get_outgroups.stdout.txt 2> per_gene/EOG091G0MLD/get_outgroups.stderr.txt && break || echo -e "try again ($i)" && sleep 15
        done

	#This is quick an dirty for now and just takes the first protein if there is more than one for an outgroup taxon
        bash ../scripts/download_outgroups.sh taxids.txt per_gene/EOG091G0MLD/EOG091G0MLD.orthodb.fasta > per_gene/EOG091G0MLD/EOG091G0MLD.outgroup.fasta
        
[Sun Jul  5 22:26:05 2020]
Finished job 3237.
1010 of 3292 steps (31%) done

[Sun Jul  5 22:26:05 2020]
rule join_groups:
    input: per_gene/EOG091G0MLD/EOG091G0MLD.ingroup.fasta, per_gene/EOG091G0MLD/EOG091G0MLD.outgroup.fasta
    output: per_gene/EOG091G0MLD/EOG091G0MLD.fasta
    jobid: 2442
    wildcards: BUSCO=EOG091G0MLD


        cat per_gene/EOG091G0MLD/EOG091G0MLD.ingroup.fasta per_gene/EOG091G0MLD/EOG091G0MLD.outgroup.fasta > per_gene/EOG091G0MLD/EOG091G0MLD.fasta
        
[Sun Jul  5 22:26:05 2020]
Finished job 2442.
1011 of 3292 steps (31%) done

[Sun Jul  5 22:26:05 2020]
rule MSA:
    input: per_gene/EOG091G0MLD/EOG091G0MLD.fasta
    output: per_gene/EOG091G0MLD/EOG091G0MLD.clustalo.fasta
    log: per_gene/EOG091G0MLD/MSA.stdout.txt, per_gene/EOG091G0MLD/MSA.stderr.txt
    jobid: 2004
    wildcards: BUSCO=EOG091G0MLD
    threads: 2


        clustalo -i per_gene/EOG091G0MLD/EOG091G0MLD.fasta -o per_gene/EOG091G0MLD/EOG091G0MLD.clustalo.fasta --threads=2 1> per_gene/EOG091G0MLD/MSA.stdout.txt 2> per_gene/EOG091G0MLD/MSA.stderr.txt
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/d68c9691725a7401923680874285c430.simg
[Sun Jul  5 22:26:07 2020]
Finished job 2004.
1012 of 3292 steps (31%) done

[Sun Jul  5 22:26:07 2020]
rule score_and_cut:
    input: per_gene/EOG091G0MLD/EOG091G0MLD.clustalo.fasta
    output: per_gene/EOG091G0MLD/ALICUT_EOG091G0MLD.clustalo.fasta
    jobid: 1181
    wildcards: BUSCO=EOG091G0MLD
    threads: 2


        cd per_gene/EOG091G0MLD
        Aliscore.pl -N -r 200000000000000000 -i ../../per_gene/EOG091G0MLD/EOG091G0MLD.clustalo.fasta &> aliscore.log
        ALICUT.pl -s &> alicut.log
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/63c88c27a0fa300f57066b0ef65fefcb.simg
[Sun Jul  5 22:26:10 2020]
Finished job 766.
1013 of 3292 steps (31%) done

[Sun Jul  5 22:26:10 2020]
rule infer_single_ML:
    input: per_gene/EOG091G0QUH/EOG091G0QUH.best_model, per_gene/EOG091G0QUH/ALICUT_EOG091G0QUH.clustalo.fasta
    output: per_gene/EOG091G0QUH/EOG091G0QUH.raxml.done
    log: per_gene/EOG091G0QUH/infer_single_ML.stdout.txt, per_gene/EOG091G0QUH/infer_single_ML.stderr.txt
    jobid: 177
    wildcards: BUSCO=EOG091G0QUH
    threads: 2


        cd per_gene/EOG091G0QUH
	count=$(cat ../../per_gene/EOG091G0QUH/ALICUT_EOG091G0QUH.clustalo.fasta | grep ">" | wc -l)
	if [ "$count" -gt 5 ]
        then
		RAxMLmodel=$(cat ../../per_gene/EOG091G0QUH/EOG091G0QUH.best_model | grep "Best" | cut -d ":" -f 2 | tr -d '[:space:]')
                if [ "$(ls -1 | grep "^RAxML" | wc -l)" -ne 0 ]
		then
			rm RAxML*
		fi
        	raxml -f a -T 2 -m PROTGAMMA$RAxMLmodel         	-p 12345 -x 12345 -# 100         	-s ../../per_gene/EOG091G0QUH/ALICUT_EOG091G0QUH.clustalo.fasta -n EOG091G0QUH.clustalo.aln.ALICUT.$RAxMLmodel 		1> ../../per_gene/EOG091G0QUH/infer_single_ML.stdout.txt 2> ../../per_gene/EOG091G0QUH/infer_single_ML.stderr.txt
	else
		echo "fasta file per_gene/EOG091G0QUH/ALICUT_EOG091G0QUH.clustalo.fasta contains fewer than 5 sequences - skipped" > ../../per_gene/EOG091G0QUH/infer_single_ML.stdout.txt
		touch raxml.skipped
	fi
        touch ../../per_gene/EOG091G0QUH/EOG091G0QUH.raxml.done
        
[33mJob counts:
	count	jobs
	1	infer_single_ML
	1[0m
[33m
        cd per_gene/EOG091G0QUH
	count=$(cat ../../per_gene/EOG091G0QUH/ALICUT_EOG091G0QUH.clustalo.fasta | grep ">" | wc -l)
	if [ "$count" -gt 5 ]
        then
		RAxMLmodel=$(cat ../../per_gene/EOG091G0QUH/EOG091G0QUH.best_model | grep "Best" | cut -d ":" -f 2 | tr -d '[:space:]')
                if [ "$(ls -1 | grep "^RAxML" | wc -l)" -ne 0 ]
		then
			rm RAxML*
		fi
        	raxml -f a -T 2 -m PROTGAMMA$RAxMLmodel         	-p 12345 -x 12345 -# 100         	-s ../../per_gene/EOG091G0QUH/ALICUT_EOG091G0QUH.clustalo.fasta -n EOG091G0QUH.clustalo.aln.ALICUT.$RAxMLmodel 		1> ../../per_gene/EOG091G0QUH/infer_single_ML.stdout.txt 2> ../../per_gene/EOG091G0QUH/infer_single_ML.stderr.txt
	else
		echo "fasta file per_gene/EOG091G0QUH/ALICUT_EOG091G0QUH.clustalo.fasta contains fewer than 5 sequences - skipped" > ../../per_gene/EOG091G0QUH/infer_single_ML.stdout.txt
		touch raxml.skipped
	fi
        touch ../../per_gene/EOG091G0QUH/EOG091G0QUH.raxml.done
        [0m
[Sun Jul  5 22:26:18 2020]
Finished job 1181.
1014 of 3292 steps (31%) done

[Sun Jul  5 22:26:18 2020]
rule remove_empty:
    input: per_gene/EOG091G0MLD/ALICUT_EOG091G0MLD.clustalo.fasta
    output: per_gene/EOG091G0MLD/empty_check.done
    jobid: 2003
    wildcards: BUSCO=EOG091G0MLD


         if [ "$(cat per_gene/EOG091G0MLD/ALICUT_EOG091G0MLD.clustalo.fasta | grep -v ">" | sed 's/-//g' | grep "^$" | wc -l)" -gt 0 ]
         then
              cp per_gene/EOG091G0MLD/ALICUT_EOG091G0MLD.clustalo.fasta per_gene/EOG091G0MLD/ALICUT_EOG091G0MLD.clustalo.fasta.backup
              bash ../scripts/remove_empty.sh per_gene/EOG091G0MLD/ALICUT_EOG091G0MLD.clustalo.fasta.backup > per_gene/EOG091G0MLD/ALICUT_EOG091G0MLD.clustalo.fasta
         fi
         touch per_gene/EOG091G0MLD/empty_check.done
         
[Sun Jul  5 22:26:18 2020]
Finished job 2003.
1015 of 3292 steps (31%) done

[Sun Jul  5 22:26:18 2020]
rule find_best_model:
    input: per_gene/EOG091G0MLD/ALICUT_EOG091G0MLD.clustalo.fasta, per_gene/EOG091G0MLD/empty_check.done
    output: per_gene/EOG091G0MLD/EOG091G0MLD.best_model
    log: per_gene/EOG091G0MLD/find_best_model.stderr.txt
    jobid: 1180
    wildcards: BUSCO=EOG091G0MLD
    threads: 2


        cd per_gene/EOG091G0MLD
        if [ ! -d find_best_model ]
        then
            mkdir find_best_model
        fi
        cd find_best_model
        ln -s ../../../per_gene/EOG091G0MLD/ALICUT_EOG091G0MLD.clustalo.fasta EOG091G0MLD.fasta
        ProteinModelSelection.pl EOG091G0MLD.fasta 1> ../../../per_gene/EOG091G0MLD/EOG091G0MLD.best_model 2> ../../../per_gene/EOG091G0MLD/find_best_model.stderr.txt
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/c0c09ee657b1e27f2c5687e0e9aa8d70.simg
[Sun Jul  5 22:26:21 2020]
Finished job 340.
1016 of 3292 steps (31%) done

[Sun Jul  5 22:26:21 2020]
rule get_seqs:
    input: /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ingroup.txt, /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/outgroup.txt
    output: per_gene/EOG091G0G6C/EOG091G0G6C.ingroup.fasta
    log: per_gene/EOG091G0G6C/get_seqs.stdout.txt, per_gene/EOG091G0G6C/get_seqs.stderr.txt
    jobid: 2682
    wildcards: BUSCO=EOG091G0G6C
    threads: 2


	basedir=$(pwd)
        cd per_gene/EOG091G0G6C
        
        bash $basedir/../scripts/fetch_seqs.sh EOG091G0G6C /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ingroup.txt /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/outgroup.txt 1> ../../per_gene/EOG091G0G6C/get_seqs.stdout.txt 2> ../../per_gene/EOG091G0G6C/get_seqs.stderr.txt
	mv EOG091G0G6C.fasta $basedir/per_gene/EOG091G0G6C/EOG091G0G6C.ingroup.fasta
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/72476f9d9a5bd0627b4d721143a21354.simg
[Sun Jul  5 22:26:27 2020]
Finished job 29.
1017 of 3292 steps (31%) done

[Sun Jul  5 22:26:27 2020]
rule get_seqs:
    input: /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ingroup.txt, /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/outgroup.txt
    output: per_gene/EOG091G096V/EOG091G096V.ingroup.fasta
    log: per_gene/EOG091G096V/get_seqs.stdout.txt, per_gene/EOG091G096V/get_seqs.stderr.txt
    jobid: 3164
    wildcards: BUSCO=EOG091G096V
    threads: 2


	basedir=$(pwd)
        cd per_gene/EOG091G096V
        
        bash $basedir/../scripts/fetch_seqs.sh EOG091G096V /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ingroup.txt /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/outgroup.txt 1> ../../per_gene/EOG091G096V/get_seqs.stdout.txt 2> ../../per_gene/EOG091G096V/get_seqs.stderr.txt
	mv EOG091G096V.fasta $basedir/per_gene/EOG091G096V/EOG091G096V.ingroup.fasta
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/72476f9d9a5bd0627b4d721143a21354.simg
[Sun Jul  5 22:26:34 2020]
Finished job 2682.
1018 of 3292 steps (31%) done

[Sun Jul  5 22:26:34 2020]
rule get_outgroups:
    input: per_gene/EOG091G0G6C/EOG091G0G6C.ingroup.fasta
    output: per_gene/EOG091G0G6C/EOG091G0G6C.orthodb.fasta, per_gene/EOG091G0G6C/EOG091G0G6C.outgroup.fasta
    log: per_gene/EOG091G0G6C/get_outgroups.stdout.txt, per_gene/EOG091G0G6C/get_outgroups.stderr.txt
    jobid: 2683
    wildcards: BUSCO=EOG091G0G6C


        #download fastas from Orhtodb for BUSCO id
        for i in {1..5}
        do
             wget "http://www.orthodb.org/fasta?query=EOG091G0G6C&level=33208" -O per_gene/EOG091G0G6C/EOG091G0G6C.orthodb.fasta 1> per_gene/EOG091G0G6C/get_outgroups.stdout.txt 2> per_gene/EOG091G0G6C/get_outgroups.stderr.txt && break || echo -e "try again ($i)" && sleep 15
        done

	#This is quick an dirty for now and just takes the first protein if there is more than one for an outgroup taxon
        bash ../scripts/download_outgroups.sh taxids.txt per_gene/EOG091G0G6C/EOG091G0G6C.orthodb.fasta > per_gene/EOG091G0G6C/EOG091G0G6C.outgroup.fasta
        
[Sun Jul  5 22:26:35 2020]
Finished job 2683.
1019 of 3292 steps (31%) done

[Sun Jul  5 22:26:35 2020]
rule join_groups:
    input: per_gene/EOG091G0G6C/EOG091G0G6C.ingroup.fasta, per_gene/EOG091G0G6C/EOG091G0G6C.outgroup.fasta
    output: per_gene/EOG091G0G6C/EOG091G0G6C.fasta
    jobid: 2165
    wildcards: BUSCO=EOG091G0G6C


        cat per_gene/EOG091G0G6C/EOG091G0G6C.ingroup.fasta per_gene/EOG091G0G6C/EOG091G0G6C.outgroup.fasta > per_gene/EOG091G0G6C/EOG091G0G6C.fasta
        
[Sun Jul  5 22:26:35 2020]
Finished job 2165.
1020 of 3292 steps (31%) done

[Sun Jul  5 22:26:35 2020]
rule MSA:
    input: per_gene/EOG091G0G6C/EOG091G0G6C.fasta
    output: per_gene/EOG091G0G6C/EOG091G0G6C.clustalo.fasta
    log: per_gene/EOG091G0G6C/MSA.stdout.txt, per_gene/EOG091G0G6C/MSA.stderr.txt
    jobid: 1450
    wildcards: BUSCO=EOG091G0G6C
    threads: 2


        clustalo -i per_gene/EOG091G0G6C/EOG091G0G6C.fasta -o per_gene/EOG091G0G6C/EOG091G0G6C.clustalo.fasta --threads=2 1> per_gene/EOG091G0G6C/MSA.stdout.txt 2> per_gene/EOG091G0G6C/MSA.stderr.txt
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/d68c9691725a7401923680874285c430.simg
[Sun Jul  5 22:26:35 2020]
Finished job 1450.
1021 of 3292 steps (31%) done

[Sun Jul  5 22:26:35 2020]
rule score_and_cut:
    input: per_gene/EOG091G0G6C/EOG091G0G6C.clustalo.fasta
    output: per_gene/EOG091G0G6C/ALICUT_EOG091G0G6C.clustalo.fasta
    jobid: 627
    wildcards: BUSCO=EOG091G0G6C
    threads: 2


        cd per_gene/EOG091G0G6C
        Aliscore.pl -N -r 200000000000000000 -i ../../per_gene/EOG091G0G6C/EOG091G0G6C.clustalo.fasta &> aliscore.log
        ALICUT.pl -s &> alicut.log
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/63c88c27a0fa300f57066b0ef65fefcb.simg
[Sun Jul  5 22:26:36 2020]
Finished job 136.
1022 of 3292 steps (31%) done

[Sun Jul  5 22:26:36 2020]
rule get_seqs:
    input: /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ingroup.txt, /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/outgroup.txt
    output: per_gene/EOG091G0TCJ/EOG091G0TCJ.ingroup.fasta
    log: per_gene/EOG091G0TCJ/get_seqs.stdout.txt, per_gene/EOG091G0TCJ/get_seqs.stderr.txt
    jobid: 2850
    wildcards: BUSCO=EOG091G0TCJ
    threads: 2


	basedir=$(pwd)
        cd per_gene/EOG091G0TCJ
        
        bash $basedir/../scripts/fetch_seqs.sh EOG091G0TCJ /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ingroup.txt /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/outgroup.txt 1> ../../per_gene/EOG091G0TCJ/get_seqs.stdout.txt 2> ../../per_gene/EOG091G0TCJ/get_seqs.stderr.txt
	mv EOG091G0TCJ.fasta $basedir/per_gene/EOG091G0TCJ/EOG091G0TCJ.ingroup.fasta
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/72476f9d9a5bd0627b4d721143a21354.simg
[Sun Jul  5 22:26:40 2020]
Finished job 3164.
1023 of 3292 steps (31%) done

[Sun Jul  5 22:26:40 2020]
rule get_outgroups:
    input: per_gene/EOG091G096V/EOG091G096V.ingroup.fasta
    output: per_gene/EOG091G096V/EOG091G096V.orthodb.fasta, per_gene/EOG091G096V/EOG091G096V.outgroup.fasta
    log: per_gene/EOG091G096V/get_outgroups.stdout.txt, per_gene/EOG091G096V/get_outgroups.stderr.txt
    jobid: 3165
    wildcards: BUSCO=EOG091G096V


        #download fastas from Orhtodb for BUSCO id
        for i in {1..5}
        do
             wget "http://www.orthodb.org/fasta?query=EOG091G096V&level=33208" -O per_gene/EOG091G096V/EOG091G096V.orthodb.fasta 1> per_gene/EOG091G096V/get_outgroups.stdout.txt 2> per_gene/EOG091G096V/get_outgroups.stderr.txt && break || echo -e "try again ($i)" && sleep 15
        done

	#This is quick an dirty for now and just takes the first protein if there is more than one for an outgroup taxon
        bash ../scripts/download_outgroups.sh taxids.txt per_gene/EOG091G096V/EOG091G096V.orthodb.fasta > per_gene/EOG091G096V/EOG091G096V.outgroup.fasta
        
[Sun Jul  5 22:26:40 2020]
Finished job 3165.
1024 of 3292 steps (31%) done

[Sun Jul  5 22:26:40 2020]
rule join_groups:
    input: per_gene/EOG091G096V/EOG091G096V.ingroup.fasta, per_gene/EOG091G096V/EOG091G096V.outgroup.fasta
    output: per_gene/EOG091G096V/EOG091G096V.fasta
    jobid: 2406
    wildcards: BUSCO=EOG091G096V


        cat per_gene/EOG091G096V/EOG091G096V.ingroup.fasta per_gene/EOG091G096V/EOG091G096V.outgroup.fasta > per_gene/EOG091G096V/EOG091G096V.fasta
        
[Sun Jul  5 22:26:40 2020]
Finished job 2406.
1025 of 3292 steps (31%) done

[Sun Jul  5 22:26:40 2020]
rule MSA:
    input: per_gene/EOG091G096V/EOG091G096V.fasta
    output: per_gene/EOG091G096V/EOG091G096V.clustalo.fasta
    log: per_gene/EOG091G096V/MSA.stdout.txt, per_gene/EOG091G096V/MSA.stderr.txt
    jobid: 1932
    wildcards: BUSCO=EOG091G096V
    threads: 2


        clustalo -i per_gene/EOG091G096V/EOG091G096V.fasta -o per_gene/EOG091G096V/EOG091G096V.clustalo.fasta --threads=2 1> per_gene/EOG091G096V/MSA.stdout.txt 2> per_gene/EOG091G096V/MSA.stderr.txt
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/d68c9691725a7401923680874285c430.simg
[Sun Jul  5 22:26:43 2020]
Finished job 1180.
1026 of 3292 steps (31%) done

[Sun Jul  5 22:26:43 2020]
rule infer_single_ML:
    input: per_gene/EOG091G0MLD/EOG091G0MLD.best_model, per_gene/EOG091G0MLD/ALICUT_EOG091G0MLD.clustalo.fasta
    output: per_gene/EOG091G0MLD/EOG091G0MLD.raxml.done
    log: per_gene/EOG091G0MLD/infer_single_ML.stdout.txt, per_gene/EOG091G0MLD/infer_single_ML.stderr.txt
    jobid: 384
    wildcards: BUSCO=EOG091G0MLD
    threads: 2


        cd per_gene/EOG091G0MLD
	count=$(cat ../../per_gene/EOG091G0MLD/ALICUT_EOG091G0MLD.clustalo.fasta | grep ">" | wc -l)
	if [ "$count" -gt 5 ]
        then
		RAxMLmodel=$(cat ../../per_gene/EOG091G0MLD/EOG091G0MLD.best_model | grep "Best" | cut -d ":" -f 2 | tr -d '[:space:]')
                if [ "$(ls -1 | grep "^RAxML" | wc -l)" -ne 0 ]
		then
			rm RAxML*
		fi
        	raxml -f a -T 2 -m PROTGAMMA$RAxMLmodel         	-p 12345 -x 12345 -# 100         	-s ../../per_gene/EOG091G0MLD/ALICUT_EOG091G0MLD.clustalo.fasta -n EOG091G0MLD.clustalo.aln.ALICUT.$RAxMLmodel 		1> ../../per_gene/EOG091G0MLD/infer_single_ML.stdout.txt 2> ../../per_gene/EOG091G0MLD/infer_single_ML.stderr.txt
	else
		echo "fasta file per_gene/EOG091G0MLD/ALICUT_EOG091G0MLD.clustalo.fasta contains fewer than 5 sequences - skipped" > ../../per_gene/EOG091G0MLD/infer_single_ML.stdout.txt
		touch raxml.skipped
	fi
        touch ../../per_gene/EOG091G0MLD/EOG091G0MLD.raxml.done
        
[Sun Jul  5 22:26:43 2020]
Finished job 1932.
1027 of 3292 steps (31%) done

[Sun Jul  5 22:26:43 2020]
rule score_and_cut:
    input: per_gene/EOG091G096V/EOG091G096V.clustalo.fasta
    output: per_gene/EOG091G096V/ALICUT_EOG091G096V.clustalo.fasta
    jobid: 1109
    wildcards: BUSCO=EOG091G096V
    threads: 2


        cd per_gene/EOG091G096V
        Aliscore.pl -N -r 200000000000000000 -i ../../per_gene/EOG091G096V/EOG091G096V.clustalo.fasta &> aliscore.log
        ALICUT.pl -s &> alicut.log
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/63c88c27a0fa300f57066b0ef65fefcb.simg
[33mJob counts:
	count	jobs
	1	infer_single_ML
	1[0m
[33m
        cd per_gene/EOG091G0MLD
	count=$(cat ../../per_gene/EOG091G0MLD/ALICUT_EOG091G0MLD.clustalo.fasta | grep ">" | wc -l)
	if [ "$count" -gt 5 ]
        then
		RAxMLmodel=$(cat ../../per_gene/EOG091G0MLD/EOG091G0MLD.best_model | grep "Best" | cut -d ":" -f 2 | tr -d '[:space:]')
                if [ "$(ls -1 | grep "^RAxML" | wc -l)" -ne 0 ]
		then
			rm RAxML*
		fi
        	raxml -f a -T 2 -m PROTGAMMA$RAxMLmodel         	-p 12345 -x 12345 -# 100         	-s ../../per_gene/EOG091G0MLD/ALICUT_EOG091G0MLD.clustalo.fasta -n EOG091G0MLD.clustalo.aln.ALICUT.$RAxMLmodel 		1> ../../per_gene/EOG091G0MLD/infer_single_ML.stdout.txt 2> ../../per_gene/EOG091G0MLD/infer_single_ML.stderr.txt
	else
		echo "fasta file per_gene/EOG091G0MLD/ALICUT_EOG091G0MLD.clustalo.fasta contains fewer than 5 sequences - skipped" > ../../per_gene/EOG091G0MLD/infer_single_ML.stdout.txt
		touch raxml.skipped
	fi
        touch ../../per_gene/EOG091G0MLD/EOG091G0MLD.raxml.done
        [0m
[Sun Jul  5 22:26:44 2020]
Finished job 627.
1028 of 3292 steps (31%) done

[Sun Jul  5 22:26:44 2020]
rule remove_empty:
    input: per_gene/EOG091G0G6C/ALICUT_EOG091G0G6C.clustalo.fasta
    output: per_gene/EOG091G0G6C/empty_check.done
    jobid: 1449
    wildcards: BUSCO=EOG091G0G6C


         if [ "$(cat per_gene/EOG091G0G6C/ALICUT_EOG091G0G6C.clustalo.fasta | grep -v ">" | sed 's/-//g' | grep "^$" | wc -l)" -gt 0 ]
         then
              cp per_gene/EOG091G0G6C/ALICUT_EOG091G0G6C.clustalo.fasta per_gene/EOG091G0G6C/ALICUT_EOG091G0G6C.clustalo.fasta.backup
              bash ../scripts/remove_empty.sh per_gene/EOG091G0G6C/ALICUT_EOG091G0G6C.clustalo.fasta.backup > per_gene/EOG091G0G6C/ALICUT_EOG091G0G6C.clustalo.fasta
         fi
         touch per_gene/EOG091G0G6C/empty_check.done
         
[Sun Jul  5 22:26:44 2020]
Finished job 1449.
1029 of 3292 steps (31%) done

[Sun Jul  5 22:26:44 2020]
rule find_best_model:
    input: per_gene/EOG091G0G6C/ALICUT_EOG091G0G6C.clustalo.fasta, per_gene/EOG091G0G6C/empty_check.done
    output: per_gene/EOG091G0G6C/EOG091G0G6C.best_model
    log: per_gene/EOG091G0G6C/find_best_model.stderr.txt
    jobid: 626
    wildcards: BUSCO=EOG091G0G6C
    threads: 2


        cd per_gene/EOG091G0G6C
        if [ ! -d find_best_model ]
        then
            mkdir find_best_model
        fi
        cd find_best_model
        ln -s ../../../per_gene/EOG091G0G6C/ALICUT_EOG091G0G6C.clustalo.fasta EOG091G0G6C.fasta
        ProteinModelSelection.pl EOG091G0G6C.fasta 1> ../../../per_gene/EOG091G0G6C/EOG091G0G6C.best_model 2> ../../../per_gene/EOG091G0G6C/find_best_model.stderr.txt
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/c0c09ee657b1e27f2c5687e0e9aa8d70.simg
[Sun Jul  5 22:26:49 2020]
Finished job 2850.
1030 of 3292 steps (31%) done

[Sun Jul  5 22:26:49 2020]
rule get_outgroups:
    input: per_gene/EOG091G0TCJ/EOG091G0TCJ.ingroup.fasta
    output: per_gene/EOG091G0TCJ/EOG091G0TCJ.orthodb.fasta, per_gene/EOG091G0TCJ/EOG091G0TCJ.outgroup.fasta
    log: per_gene/EOG091G0TCJ/get_outgroups.stdout.txt, per_gene/EOG091G0TCJ/get_outgroups.stderr.txt
    jobid: 2851
    wildcards: BUSCO=EOG091G0TCJ


        #download fastas from Orhtodb for BUSCO id
        for i in {1..5}
        do
             wget "http://www.orthodb.org/fasta?query=EOG091G0TCJ&level=33208" -O per_gene/EOG091G0TCJ/EOG091G0TCJ.orthodb.fasta 1> per_gene/EOG091G0TCJ/get_outgroups.stdout.txt 2> per_gene/EOG091G0TCJ/get_outgroups.stderr.txt && break || echo -e "try again ($i)" && sleep 15
        done

	#This is quick an dirty for now and just takes the first protein if there is more than one for an outgroup taxon
        bash ../scripts/download_outgroups.sh taxids.txt per_gene/EOG091G0TCJ/EOG091G0TCJ.orthodb.fasta > per_gene/EOG091G0TCJ/EOG091G0TCJ.outgroup.fasta
        
[Sun Jul  5 22:26:50 2020]
Finished job 2851.
1031 of 3292 steps (31%) done

[Sun Jul  5 22:26:50 2020]
rule join_groups:
    input: per_gene/EOG091G0TCJ/EOG091G0TCJ.ingroup.fasta, per_gene/EOG091G0TCJ/EOG091G0TCJ.outgroup.fasta
    output: per_gene/EOG091G0TCJ/EOG091G0TCJ.fasta
    jobid: 2249
    wildcards: BUSCO=EOG091G0TCJ


        cat per_gene/EOG091G0TCJ/EOG091G0TCJ.ingroup.fasta per_gene/EOG091G0TCJ/EOG091G0TCJ.outgroup.fasta > per_gene/EOG091G0TCJ/EOG091G0TCJ.fasta
        
[Sun Jul  5 22:26:50 2020]
Finished job 2249.
1032 of 3292 steps (31%) done

[Sun Jul  5 22:26:50 2020]
rule MSA:
    input: per_gene/EOG091G0TCJ/EOG091G0TCJ.fasta
    output: per_gene/EOG091G0TCJ/EOG091G0TCJ.clustalo.fasta
    log: per_gene/EOG091G0TCJ/MSA.stdout.txt, per_gene/EOG091G0TCJ/MSA.stderr.txt
    jobid: 1618
    wildcards: BUSCO=EOG091G0TCJ
    threads: 2


        clustalo -i per_gene/EOG091G0TCJ/EOG091G0TCJ.fasta -o per_gene/EOG091G0TCJ/EOG091G0TCJ.clustalo.fasta --threads=2 1> per_gene/EOG091G0TCJ/MSA.stdout.txt 2> per_gene/EOG091G0TCJ/MSA.stderr.txt
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/d68c9691725a7401923680874285c430.simg
[Sun Jul  5 22:26:51 2020]
Finished job 1618.
1033 of 3292 steps (31%) done

[Sun Jul  5 22:26:51 2020]
rule score_and_cut:
    input: per_gene/EOG091G0TCJ/EOG091G0TCJ.clustalo.fasta
    output: per_gene/EOG091G0TCJ/ALICUT_EOG091G0TCJ.clustalo.fasta
    jobid: 795
    wildcards: BUSCO=EOG091G0TCJ
    threads: 2


        cd per_gene/EOG091G0TCJ
        Aliscore.pl -N -r 200000000000000000 -i ../../per_gene/EOG091G0TCJ/EOG091G0TCJ.clustalo.fasta &> aliscore.log
        ALICUT.pl -s &> alicut.log
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/63c88c27a0fa300f57066b0ef65fefcb.simg
[Sun Jul  5 22:26:53 2020]
Finished job 1109.
1034 of 3292 steps (31%) done

[Sun Jul  5 22:26:53 2020]
rule remove_empty:
    input: per_gene/EOG091G096V/ALICUT_EOG091G096V.clustalo.fasta
    output: per_gene/EOG091G096V/empty_check.done
    jobid: 1931
    wildcards: BUSCO=EOG091G096V


         if [ "$(cat per_gene/EOG091G096V/ALICUT_EOG091G096V.clustalo.fasta | grep -v ">" | sed 's/-//g' | grep "^$" | wc -l)" -gt 0 ]
         then
              cp per_gene/EOG091G096V/ALICUT_EOG091G096V.clustalo.fasta per_gene/EOG091G096V/ALICUT_EOG091G096V.clustalo.fasta.backup
              bash ../scripts/remove_empty.sh per_gene/EOG091G096V/ALICUT_EOG091G096V.clustalo.fasta.backup > per_gene/EOG091G096V/ALICUT_EOG091G096V.clustalo.fasta
         fi
         touch per_gene/EOG091G096V/empty_check.done
         
[Sun Jul  5 22:26:53 2020]
Finished job 1931.
1035 of 3292 steps (31%) done

[Sun Jul  5 22:26:53 2020]
rule find_best_model:
    input: per_gene/EOG091G096V/ALICUT_EOG091G096V.clustalo.fasta, per_gene/EOG091G096V/empty_check.done
    output: per_gene/EOG091G096V/EOG091G096V.best_model
    log: per_gene/EOG091G096V/find_best_model.stderr.txt
    jobid: 1108
    wildcards: BUSCO=EOG091G096V
    threads: 2


        cd per_gene/EOG091G096V
        if [ ! -d find_best_model ]
        then
            mkdir find_best_model
        fi
        cd find_best_model
        ln -s ../../../per_gene/EOG091G096V/ALICUT_EOG091G096V.clustalo.fasta EOG091G096V.fasta
        ProteinModelSelection.pl EOG091G096V.fasta 1> ../../../per_gene/EOG091G096V/EOG091G096V.best_model 2> ../../../per_gene/EOG091G096V/find_best_model.stderr.txt
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/c0c09ee657b1e27f2c5687e0e9aa8d70.simg
[Sun Jul  5 22:27:00 2020]
Finished job 795.
1036 of 3292 steps (31%) done

[Sun Jul  5 22:27:01 2020]
rule remove_empty:
    input: per_gene/EOG091G0TCJ/ALICUT_EOG091G0TCJ.clustalo.fasta
    output: per_gene/EOG091G0TCJ/empty_check.done
    jobid: 1617
    wildcards: BUSCO=EOG091G0TCJ


         if [ "$(cat per_gene/EOG091G0TCJ/ALICUT_EOG091G0TCJ.clustalo.fasta | grep -v ">" | sed 's/-//g' | grep "^$" | wc -l)" -gt 0 ]
         then
              cp per_gene/EOG091G0TCJ/ALICUT_EOG091G0TCJ.clustalo.fasta per_gene/EOG091G0TCJ/ALICUT_EOG091G0TCJ.clustalo.fasta.backup
              bash ../scripts/remove_empty.sh per_gene/EOG091G0TCJ/ALICUT_EOG091G0TCJ.clustalo.fasta.backup > per_gene/EOG091G0TCJ/ALICUT_EOG091G0TCJ.clustalo.fasta
         fi
         touch per_gene/EOG091G0TCJ/empty_check.done
         
[Sun Jul  5 22:27:01 2020]
Finished job 1617.
1037 of 3292 steps (32%) done

[Sun Jul  5 22:27:01 2020]
rule find_best_model:
    input: per_gene/EOG091G0TCJ/ALICUT_EOG091G0TCJ.clustalo.fasta, per_gene/EOG091G0TCJ/empty_check.done
    output: per_gene/EOG091G0TCJ/EOG091G0TCJ.best_model
    log: per_gene/EOG091G0TCJ/find_best_model.stderr.txt
    jobid: 794
    wildcards: BUSCO=EOG091G0TCJ
    threads: 2


        cd per_gene/EOG091G0TCJ
        if [ ! -d find_best_model ]
        then
            mkdir find_best_model
        fi
        cd find_best_model
        ln -s ../../../per_gene/EOG091G0TCJ/ALICUT_EOG091G0TCJ.clustalo.fasta EOG091G0TCJ.fasta
        ProteinModelSelection.pl EOG091G0TCJ.fasta 1> ../../../per_gene/EOG091G0TCJ/EOG091G0TCJ.best_model 2> ../../../per_gene/EOG091G0TCJ/find_best_model.stderr.txt
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/c0c09ee657b1e27f2c5687e0e9aa8d70.simg
[Sun Jul  5 22:27:07 2020]
Finished job 252.
1038 of 3292 steps (32%) done

[Sun Jul  5 22:27:07 2020]
rule get_seqs:
    input: /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ingroup.txt, /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/outgroup.txt
    output: per_gene/EOG091G0PEI/EOG091G0PEI.ingroup.fasta
    log: per_gene/EOG091G0PEI/get_seqs.stdout.txt, per_gene/EOG091G0PEI/get_seqs.stderr.txt
    jobid: 2802
    wildcards: BUSCO=EOG091G0PEI
    threads: 2


	basedir=$(pwd)
        cd per_gene/EOG091G0PEI
        
        bash $basedir/../scripts/fetch_seqs.sh EOG091G0PEI /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ingroup.txt /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/outgroup.txt 1> ../../per_gene/EOG091G0PEI/get_seqs.stdout.txt 2> ../../per_gene/EOG091G0PEI/get_seqs.stderr.txt
	mv EOG091G0PEI.fasta $basedir/per_gene/EOG091G0PEI/EOG091G0PEI.ingroup.fasta
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/72476f9d9a5bd0627b4d721143a21354.simg
[Sun Jul  5 22:27:09 2020]
Finished job 47.
1039 of 3292 steps (32%) done

[Sun Jul  5 22:27:09 2020]
rule get_seqs:
    input: /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ingroup.txt, /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/outgroup.txt
    output: per_gene/EOG091G0KRZ/EOG091G0KRZ.ingroup.fasta
    log: per_gene/EOG091G0KRZ/get_seqs.stdout.txt, per_gene/EOG091G0KRZ/get_seqs.stderr.txt
    jobid: 3222
    wildcards: BUSCO=EOG091G0KRZ
    threads: 2


	basedir=$(pwd)
        cd per_gene/EOG091G0KRZ
        
        bash $basedir/../scripts/fetch_seqs.sh EOG091G0KRZ /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ingroup.txt /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/outgroup.txt 1> ../../per_gene/EOG091G0KRZ/get_seqs.stdout.txt 2> ../../per_gene/EOG091G0KRZ/get_seqs.stderr.txt
	mv EOG091G0KRZ.fasta $basedir/per_gene/EOG091G0KRZ/EOG091G0KRZ.ingroup.fasta
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/72476f9d9a5bd0627b4d721143a21354.simg
[Sun Jul  5 22:27:16 2020]
Finished job 626.
1040 of 3292 steps (32%) done

[Sun Jul  5 22:27:16 2020]
rule infer_single_ML:
    input: per_gene/EOG091G0G6C/EOG091G0G6C.best_model, per_gene/EOG091G0G6C/ALICUT_EOG091G0G6C.clustalo.fasta
    output: per_gene/EOG091G0G6C/EOG091G0G6C.raxml.done
    log: per_gene/EOG091G0G6C/infer_single_ML.stdout.txt, per_gene/EOG091G0G6C/infer_single_ML.stderr.txt
    jobid: 107
    wildcards: BUSCO=EOG091G0G6C
    threads: 2


        cd per_gene/EOG091G0G6C
	count=$(cat ../../per_gene/EOG091G0G6C/ALICUT_EOG091G0G6C.clustalo.fasta | grep ">" | wc -l)
	if [ "$count" -gt 5 ]
        then
		RAxMLmodel=$(cat ../../per_gene/EOG091G0G6C/EOG091G0G6C.best_model | grep "Best" | cut -d ":" -f 2 | tr -d '[:space:]')
                if [ "$(ls -1 | grep "^RAxML" | wc -l)" -ne 0 ]
		then
			rm RAxML*
		fi
        	raxml -f a -T 2 -m PROTGAMMA$RAxMLmodel         	-p 12345 -x 12345 -# 100         	-s ../../per_gene/EOG091G0G6C/ALICUT_EOG091G0G6C.clustalo.fasta -n EOG091G0G6C.clustalo.aln.ALICUT.$RAxMLmodel 		1> ../../per_gene/EOG091G0G6C/infer_single_ML.stdout.txt 2> ../../per_gene/EOG091G0G6C/infer_single_ML.stderr.txt
	else
		echo "fasta file per_gene/EOG091G0G6C/ALICUT_EOG091G0G6C.clustalo.fasta contains fewer than 5 sequences - skipped" > ../../per_gene/EOG091G0G6C/infer_single_ML.stdout.txt
		touch raxml.skipped
	fi
        touch ../../per_gene/EOG091G0G6C/EOG091G0G6C.raxml.done
        
[33mJob counts:
	count	jobs
	1	infer_single_ML
	1[0m
[33m
        cd per_gene/EOG091G0G6C
	count=$(cat ../../per_gene/EOG091G0G6C/ALICUT_EOG091G0G6C.clustalo.fasta | grep ">" | wc -l)
	if [ "$count" -gt 5 ]
        then
		RAxMLmodel=$(cat ../../per_gene/EOG091G0G6C/EOG091G0G6C.best_model | grep "Best" | cut -d ":" -f 2 | tr -d '[:space:]')
                if [ "$(ls -1 | grep "^RAxML" | wc -l)" -ne 0 ]
		then
			rm RAxML*
		fi
        	raxml -f a -T 2 -m PROTGAMMA$RAxMLmodel         	-p 12345 -x 12345 -# 100         	-s ../../per_gene/EOG091G0G6C/ALICUT_EOG091G0G6C.clustalo.fasta -n EOG091G0G6C.clustalo.aln.ALICUT.$RAxMLmodel 		1> ../../per_gene/EOG091G0G6C/infer_single_ML.stdout.txt 2> ../../per_gene/EOG091G0G6C/infer_single_ML.stderr.txt
	else
		echo "fasta file per_gene/EOG091G0G6C/ALICUT_EOG091G0G6C.clustalo.fasta contains fewer than 5 sequences - skipped" > ../../per_gene/EOG091G0G6C/infer_single_ML.stdout.txt
		touch raxml.skipped
	fi
        touch ../../per_gene/EOG091G0G6C/EOG091G0G6C.raxml.done
        [0m
[Sun Jul  5 22:27:21 2020]
Finished job 3222.
1041 of 3292 steps (32%) done

[Sun Jul  5 22:27:21 2020]
rule get_outgroups:
    input: per_gene/EOG091G0KRZ/EOG091G0KRZ.ingroup.fasta
    output: per_gene/EOG091G0KRZ/EOG091G0KRZ.orthodb.fasta, per_gene/EOG091G0KRZ/EOG091G0KRZ.outgroup.fasta
    log: per_gene/EOG091G0KRZ/get_outgroups.stdout.txt, per_gene/EOG091G0KRZ/get_outgroups.stderr.txt
    jobid: 3223
    wildcards: BUSCO=EOG091G0KRZ


        #download fastas from Orhtodb for BUSCO id
        for i in {1..5}
        do
             wget "http://www.orthodb.org/fasta?query=EOG091G0KRZ&level=33208" -O per_gene/EOG091G0KRZ/EOG091G0KRZ.orthodb.fasta 1> per_gene/EOG091G0KRZ/get_outgroups.stdout.txt 2> per_gene/EOG091G0KRZ/get_outgroups.stderr.txt && break || echo -e "try again ($i)" && sleep 15
        done

	#This is quick an dirty for now and just takes the first protein if there is more than one for an outgroup taxon
        bash ../scripts/download_outgroups.sh taxids.txt per_gene/EOG091G0KRZ/EOG091G0KRZ.orthodb.fasta > per_gene/EOG091G0KRZ/EOG091G0KRZ.outgroup.fasta
        
[Sun Jul  5 22:27:21 2020]
Finished job 2802.
1042 of 3292 steps (32%) done

[Sun Jul  5 22:27:21 2020]
rule get_outgroups:
    input: per_gene/EOG091G0PEI/EOG091G0PEI.ingroup.fasta
    output: per_gene/EOG091G0PEI/EOG091G0PEI.orthodb.fasta, per_gene/EOG091G0PEI/EOG091G0PEI.outgroup.fasta
    log: per_gene/EOG091G0PEI/get_outgroups.stdout.txt, per_gene/EOG091G0PEI/get_outgroups.stderr.txt
    jobid: 2803
    wildcards: BUSCO=EOG091G0PEI


        #download fastas from Orhtodb for BUSCO id
        for i in {1..5}
        do
             wget "http://www.orthodb.org/fasta?query=EOG091G0PEI&level=33208" -O per_gene/EOG091G0PEI/EOG091G0PEI.orthodb.fasta 1> per_gene/EOG091G0PEI/get_outgroups.stdout.txt 2> per_gene/EOG091G0PEI/get_outgroups.stderr.txt && break || echo -e "try again ($i)" && sleep 15
        done

	#This is quick an dirty for now and just takes the first protein if there is more than one for an outgroup taxon
        bash ../scripts/download_outgroups.sh taxids.txt per_gene/EOG091G0PEI/EOG091G0PEI.orthodb.fasta > per_gene/EOG091G0PEI/EOG091G0PEI.outgroup.fasta
        

[Sun Jul  5 22:27:21 2020]
rule get_seqs:
    input: /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ingroup.txt, /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/outgroup.txt
    output: per_gene/EOG091G03FL/EOG091G03FL.ingroup.fasta
    log: per_gene/EOG091G03FL/get_seqs.stdout.txt, per_gene/EOG091G03FL/get_seqs.stderr.txt
    jobid: 2948
    wildcards: BUSCO=EOG091G03FL
    threads: 2


	basedir=$(pwd)
        cd per_gene/EOG091G03FL
        
        bash $basedir/../scripts/fetch_seqs.sh EOG091G03FL /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ingroup.txt /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/outgroup.txt 1> ../../per_gene/EOG091G03FL/get_seqs.stdout.txt 2> ../../per_gene/EOG091G03FL/get_seqs.stderr.txt
	mv EOG091G03FL.fasta $basedir/per_gene/EOG091G03FL/EOG091G03FL.ingroup.fasta
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/72476f9d9a5bd0627b4d721143a21354.simg
[Sun Jul  5 22:27:23 2020]
Finished job 3223.
1043 of 3292 steps (32%) done

[Sun Jul  5 22:27:23 2020]
rule join_groups:
    input: per_gene/EOG091G0KRZ/EOG091G0KRZ.ingroup.fasta, per_gene/EOG091G0KRZ/EOG091G0KRZ.outgroup.fasta
    output: per_gene/EOG091G0KRZ/EOG091G0KRZ.fasta
    jobid: 2435
    wildcards: BUSCO=EOG091G0KRZ


        cat per_gene/EOG091G0KRZ/EOG091G0KRZ.ingroup.fasta per_gene/EOG091G0KRZ/EOG091G0KRZ.outgroup.fasta > per_gene/EOG091G0KRZ/EOG091G0KRZ.fasta
        
[Sun Jul  5 22:27:23 2020]
Finished job 2435.
1044 of 3292 steps (32%) done
[Sun Jul  5 22:27:23 2020]
Finished job 2803.
1045 of 3292 steps (32%) done

[Sun Jul  5 22:27:23 2020]
rule MSA:
    input: per_gene/EOG091G0KRZ/EOG091G0KRZ.fasta
    output: per_gene/EOG091G0KRZ/EOG091G0KRZ.clustalo.fasta
    log: per_gene/EOG091G0KRZ/MSA.stdout.txt, per_gene/EOG091G0KRZ/MSA.stderr.txt
    jobid: 1990
    wildcards: BUSCO=EOG091G0KRZ
    threads: 2


        clustalo -i per_gene/EOG091G0KRZ/EOG091G0KRZ.fasta -o per_gene/EOG091G0KRZ/EOG091G0KRZ.clustalo.fasta --threads=2 1> per_gene/EOG091G0KRZ/MSA.stdout.txt 2> per_gene/EOG091G0KRZ/MSA.stderr.txt
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/d68c9691725a7401923680874285c430.simg
[Sun Jul  5 22:27:24 2020]
Finished job 1990.
1046 of 3292 steps (32%) done

[Sun Jul  5 22:27:24 2020]
rule score_and_cut:
    input: per_gene/EOG091G0KRZ/EOG091G0KRZ.clustalo.fasta
    output: per_gene/EOG091G0KRZ/ALICUT_EOG091G0KRZ.clustalo.fasta
    jobid: 1167
    wildcards: BUSCO=EOG091G0KRZ
    threads: 2


        cd per_gene/EOG091G0KRZ
        Aliscore.pl -N -r 200000000000000000 -i ../../per_gene/EOG091G0KRZ/EOG091G0KRZ.clustalo.fasta &> aliscore.log
        ALICUT.pl -s &> alicut.log
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/63c88c27a0fa300f57066b0ef65fefcb.simg
[Sun Jul  5 22:27:27 2020]
Finished job 1108.
1047 of 3292 steps (32%) done

[Sun Jul  5 22:27:27 2020]
rule infer_single_ML:
    input: per_gene/EOG091G096V/EOG091G096V.best_model, per_gene/EOG091G096V/ALICUT_EOG091G096V.clustalo.fasta
    output: per_gene/EOG091G096V/EOG091G096V.raxml.done
    log: per_gene/EOG091G096V/infer_single_ML.stdout.txt, per_gene/EOG091G096V/infer_single_ML.stderr.txt
    jobid: 348
    wildcards: BUSCO=EOG091G096V
    threads: 2


        cd per_gene/EOG091G096V
	count=$(cat ../../per_gene/EOG091G096V/ALICUT_EOG091G096V.clustalo.fasta | grep ">" | wc -l)
	if [ "$count" -gt 5 ]
        then
		RAxMLmodel=$(cat ../../per_gene/EOG091G096V/EOG091G096V.best_model | grep "Best" | cut -d ":" -f 2 | tr -d '[:space:]')
                if [ "$(ls -1 | grep "^RAxML" | wc -l)" -ne 0 ]
		then
			rm RAxML*
		fi
        	raxml -f a -T 2 -m PROTGAMMA$RAxMLmodel         	-p 12345 -x 12345 -# 100         	-s ../../per_gene/EOG091G096V/ALICUT_EOG091G096V.clustalo.fasta -n EOG091G096V.clustalo.aln.ALICUT.$RAxMLmodel 		1> ../../per_gene/EOG091G096V/infer_single_ML.stdout.txt 2> ../../per_gene/EOG091G096V/infer_single_ML.stderr.txt
	else
		echo "fasta file per_gene/EOG091G096V/ALICUT_EOG091G096V.clustalo.fasta contains fewer than 5 sequences - skipped" > ../../per_gene/EOG091G096V/infer_single_ML.stdout.txt
		touch raxml.skipped
	fi
        touch ../../per_gene/EOG091G096V/EOG091G096V.raxml.done
        
[33mJob counts:
	count	jobs
	1	infer_single_ML
	1[0m
[33m
        cd per_gene/EOG091G096V
	count=$(cat ../../per_gene/EOG091G096V/ALICUT_EOG091G096V.clustalo.fasta | grep ">" | wc -l)
	if [ "$count" -gt 5 ]
        then
		RAxMLmodel=$(cat ../../per_gene/EOG091G096V/EOG091G096V.best_model | grep "Best" | cut -d ":" -f 2 | tr -d '[:space:]')
                if [ "$(ls -1 | grep "^RAxML" | wc -l)" -ne 0 ]
		then
			rm RAxML*
		fi
        	raxml -f a -T 2 -m PROTGAMMA$RAxMLmodel         	-p 12345 -x 12345 -# 100         	-s ../../per_gene/EOG091G096V/ALICUT_EOG091G096V.clustalo.fasta -n EOG091G096V.clustalo.aln.ALICUT.$RAxMLmodel 		1> ../../per_gene/EOG091G096V/infer_single_ML.stdout.txt 2> ../../per_gene/EOG091G096V/infer_single_ML.stderr.txt
	else
		echo "fasta file per_gene/EOG091G096V/ALICUT_EOG091G096V.clustalo.fasta contains fewer than 5 sequences - skipped" > ../../per_gene/EOG091G096V/infer_single_ML.stdout.txt
		touch raxml.skipped
	fi
        touch ../../per_gene/EOG091G096V/EOG091G096V.raxml.done
        [0m
[Sun Jul  5 22:27:30 2020]
Finished job 794.
1048 of 3292 steps (32%) done

[Sun Jul  5 22:27:30 2020]
rule join_groups:
    input: per_gene/EOG091G0PEI/EOG091G0PEI.ingroup.fasta, per_gene/EOG091G0PEI/EOG091G0PEI.outgroup.fasta
    output: per_gene/EOG091G0PEI/EOG091G0PEI.fasta
    jobid: 2225
    wildcards: BUSCO=EOG091G0PEI


        cat per_gene/EOG091G0PEI/EOG091G0PEI.ingroup.fasta per_gene/EOG091G0PEI/EOG091G0PEI.outgroup.fasta > per_gene/EOG091G0PEI/EOG091G0PEI.fasta
        
[Sun Jul  5 22:27:30 2020]
Finished job 2225.
1049 of 3292 steps (32%) done

[Sun Jul  5 22:27:30 2020]
rule MSA:
    input: per_gene/EOG091G0PEI/EOG091G0PEI.fasta
    output: per_gene/EOG091G0PEI/EOG091G0PEI.clustalo.fasta
    log: per_gene/EOG091G0PEI/MSA.stdout.txt, per_gene/EOG091G0PEI/MSA.stderr.txt
    jobid: 1570
    wildcards: BUSCO=EOG091G0PEI
    threads: 2


        clustalo -i per_gene/EOG091G0PEI/EOG091G0PEI.fasta -o per_gene/EOG091G0PEI/EOG091G0PEI.clustalo.fasta --threads=2 1> per_gene/EOG091G0PEI/MSA.stdout.txt 2> per_gene/EOG091G0PEI/MSA.stderr.txt
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/d68c9691725a7401923680874285c430.simg
[Sun Jul  5 22:27:31 2020]
Finished job 1570.
1050 of 3292 steps (32%) done

[Sun Jul  5 22:27:31 2020]
rule score_and_cut:
    input: per_gene/EOG091G0PEI/EOG091G0PEI.clustalo.fasta
    output: per_gene/EOG091G0PEI/ALICUT_EOG091G0PEI.clustalo.fasta
    jobid: 747
    wildcards: BUSCO=EOG091G0PEI
    threads: 2


        cd per_gene/EOG091G0PEI
        Aliscore.pl -N -r 200000000000000000 -i ../../per_gene/EOG091G0PEI/EOG091G0PEI.clustalo.fasta &> aliscore.log
        ALICUT.pl -s &> alicut.log
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/63c88c27a0fa300f57066b0ef65fefcb.simg
[Sun Jul  5 22:27:34 2020]
Finished job 1167.
1051 of 3292 steps (32%) done

[Sun Jul  5 22:27:34 2020]
rule remove_empty:
    input: per_gene/EOG091G0KRZ/ALICUT_EOG091G0KRZ.clustalo.fasta
    output: per_gene/EOG091G0KRZ/empty_check.done
    jobid: 1989
    wildcards: BUSCO=EOG091G0KRZ


         if [ "$(cat per_gene/EOG091G0KRZ/ALICUT_EOG091G0KRZ.clustalo.fasta | grep -v ">" | sed 's/-//g' | grep "^$" | wc -l)" -gt 0 ]
         then
              cp per_gene/EOG091G0KRZ/ALICUT_EOG091G0KRZ.clustalo.fasta per_gene/EOG091G0KRZ/ALICUT_EOG091G0KRZ.clustalo.fasta.backup
              bash ../scripts/remove_empty.sh per_gene/EOG091G0KRZ/ALICUT_EOG091G0KRZ.clustalo.fasta.backup > per_gene/EOG091G0KRZ/ALICUT_EOG091G0KRZ.clustalo.fasta
         fi
         touch per_gene/EOG091G0KRZ/empty_check.done
         
[Sun Jul  5 22:27:34 2020]
Finished job 1989.
1052 of 3292 steps (32%) done

[Sun Jul  5 22:27:34 2020]
rule find_best_model:
    input: per_gene/EOG091G0KRZ/ALICUT_EOG091G0KRZ.clustalo.fasta, per_gene/EOG091G0KRZ/empty_check.done
    output: per_gene/EOG091G0KRZ/EOG091G0KRZ.best_model
    log: per_gene/EOG091G0KRZ/find_best_model.stderr.txt
    jobid: 1166
    wildcards: BUSCO=EOG091G0KRZ
    threads: 2


        cd per_gene/EOG091G0KRZ
        if [ ! -d find_best_model ]
        then
            mkdir find_best_model
        fi
        cd find_best_model
        ln -s ../../../per_gene/EOG091G0KRZ/ALICUT_EOG091G0KRZ.clustalo.fasta EOG091G0KRZ.fasta
        ProteinModelSelection.pl EOG091G0KRZ.fasta 1> ../../../per_gene/EOG091G0KRZ/EOG091G0KRZ.best_model 2> ../../../per_gene/EOG091G0KRZ/find_best_model.stderr.txt
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/c0c09ee657b1e27f2c5687e0e9aa8d70.simg
[Sun Jul  5 22:27:34 2020]
Finished job 2948.
1053 of 3292 steps (32%) done

[Sun Jul  5 22:27:34 2020]
rule get_outgroups:
    input: per_gene/EOG091G03FL/EOG091G03FL.ingroup.fasta
    output: per_gene/EOG091G03FL/EOG091G03FL.orthodb.fasta, per_gene/EOG091G03FL/EOG091G03FL.outgroup.fasta
    log: per_gene/EOG091G03FL/get_outgroups.stdout.txt, per_gene/EOG091G03FL/get_outgroups.stderr.txt
    jobid: 2949
    wildcards: BUSCO=EOG091G03FL


        #download fastas from Orhtodb for BUSCO id
        for i in {1..5}
        do
             wget "http://www.orthodb.org/fasta?query=EOG091G03FL&level=33208" -O per_gene/EOG091G03FL/EOG091G03FL.orthodb.fasta 1> per_gene/EOG091G03FL/get_outgroups.stdout.txt 2> per_gene/EOG091G03FL/get_outgroups.stderr.txt && break || echo -e "try again ($i)" && sleep 15
        done

	#This is quick an dirty for now and just takes the first protein if there is more than one for an outgroup taxon
        bash ../scripts/download_outgroups.sh taxids.txt per_gene/EOG091G03FL/EOG091G03FL.orthodb.fasta > per_gene/EOG091G03FL/EOG091G03FL.outgroup.fasta
        
[Sun Jul  5 22:27:35 2020]
Finished job 2949.
1054 of 3292 steps (32%) done

[Sun Jul  5 22:27:35 2020]
rule join_groups:
    input: per_gene/EOG091G03FL/EOG091G03FL.ingroup.fasta, per_gene/EOG091G03FL/EOG091G03FL.outgroup.fasta
    output: per_gene/EOG091G03FL/EOG091G03FL.fasta
    jobid: 2298
    wildcards: BUSCO=EOG091G03FL


        cat per_gene/EOG091G03FL/EOG091G03FL.ingroup.fasta per_gene/EOG091G03FL/EOG091G03FL.outgroup.fasta > per_gene/EOG091G03FL/EOG091G03FL.fasta
        
[Sun Jul  5 22:27:35 2020]
Finished job 2298.
1055 of 3292 steps (32%) done

[Sun Jul  5 22:27:35 2020]
rule MSA:
    input: per_gene/EOG091G03FL/EOG091G03FL.fasta
    output: per_gene/EOG091G03FL/EOG091G03FL.clustalo.fasta
    log: per_gene/EOG091G03FL/MSA.stdout.txt, per_gene/EOG091G03FL/MSA.stderr.txt
    jobid: 1716
    wildcards: BUSCO=EOG091G03FL
    threads: 2


        clustalo -i per_gene/EOG091G03FL/EOG091G03FL.fasta -o per_gene/EOG091G03FL/EOG091G03FL.clustalo.fasta --threads=2 1> per_gene/EOG091G03FL/MSA.stdout.txt 2> per_gene/EOG091G03FL/MSA.stderr.txt
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/d68c9691725a7401923680874285c430.simg
[Sun Jul  5 22:27:38 2020]
Finished job 1716.
1056 of 3292 steps (32%) done

[Sun Jul  5 22:27:38 2020]
rule score_and_cut:
    input: per_gene/EOG091G03FL/EOG091G03FL.clustalo.fasta
    output: per_gene/EOG091G03FL/ALICUT_EOG091G03FL.clustalo.fasta
    jobid: 893
    wildcards: BUSCO=EOG091G03FL
    threads: 2


        cd per_gene/EOG091G03FL
        Aliscore.pl -N -r 200000000000000000 -i ../../per_gene/EOG091G03FL/EOG091G03FL.clustalo.fasta &> aliscore.log
        ALICUT.pl -s &> alicut.log
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/63c88c27a0fa300f57066b0ef65fefcb.simg
[Sun Jul  5 22:27:41 2020]
Finished job 747.
1057 of 3292 steps (32%) done

[Sun Jul  5 22:27:41 2020]
rule remove_empty:
    input: per_gene/EOG091G0PEI/ALICUT_EOG091G0PEI.clustalo.fasta
    output: per_gene/EOG091G0PEI/empty_check.done
    jobid: 1569
    wildcards: BUSCO=EOG091G0PEI


         if [ "$(cat per_gene/EOG091G0PEI/ALICUT_EOG091G0PEI.clustalo.fasta | grep -v ">" | sed 's/-//g' | grep "^$" | wc -l)" -gt 0 ]
         then
              cp per_gene/EOG091G0PEI/ALICUT_EOG091G0PEI.clustalo.fasta per_gene/EOG091G0PEI/ALICUT_EOG091G0PEI.clustalo.fasta.backup
              bash ../scripts/remove_empty.sh per_gene/EOG091G0PEI/ALICUT_EOG091G0PEI.clustalo.fasta.backup > per_gene/EOG091G0PEI/ALICUT_EOG091G0PEI.clustalo.fasta
         fi
         touch per_gene/EOG091G0PEI/empty_check.done
         
[Sun Jul  5 22:27:41 2020]
Finished job 1569.
1058 of 3292 steps (32%) done

[Sun Jul  5 22:27:41 2020]
rule find_best_model:
    input: per_gene/EOG091G0PEI/ALICUT_EOG091G0PEI.clustalo.fasta, per_gene/EOG091G0PEI/empty_check.done
    output: per_gene/EOG091G0PEI/EOG091G0PEI.best_model
    log: per_gene/EOG091G0PEI/find_best_model.stderr.txt
    jobid: 746
    wildcards: BUSCO=EOG091G0PEI
    threads: 2


        cd per_gene/EOG091G0PEI
        if [ ! -d find_best_model ]
        then
            mkdir find_best_model
        fi
        cd find_best_model
        ln -s ../../../per_gene/EOG091G0PEI/ALICUT_EOG091G0PEI.clustalo.fasta EOG091G0PEI.fasta
        ProteinModelSelection.pl EOG091G0PEI.fasta 1> ../../../per_gene/EOG091G0PEI/EOG091G0PEI.best_model 2> ../../../per_gene/EOG091G0PEI/find_best_model.stderr.txt
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/c0c09ee657b1e27f2c5687e0e9aa8d70.simg
[Sun Jul  5 22:27:49 2020]
Finished job 893.
1059 of 3292 steps (32%) done

[Sun Jul  5 22:27:49 2020]
rule remove_empty:
    input: per_gene/EOG091G03FL/ALICUT_EOG091G03FL.clustalo.fasta
    output: per_gene/EOG091G03FL/empty_check.done
    jobid: 1715
    wildcards: BUSCO=EOG091G03FL


         if [ "$(cat per_gene/EOG091G03FL/ALICUT_EOG091G03FL.clustalo.fasta | grep -v ">" | sed 's/-//g' | grep "^$" | wc -l)" -gt 0 ]
         then
              cp per_gene/EOG091G03FL/ALICUT_EOG091G03FL.clustalo.fasta per_gene/EOG091G03FL/ALICUT_EOG091G03FL.clustalo.fasta.backup
              bash ../scripts/remove_empty.sh per_gene/EOG091G03FL/ALICUT_EOG091G03FL.clustalo.fasta.backup > per_gene/EOG091G03FL/ALICUT_EOG091G03FL.clustalo.fasta
         fi
         touch per_gene/EOG091G03FL/empty_check.done
         
[Sun Jul  5 22:27:49 2020]
Finished job 1715.
1060 of 3292 steps (32%) done

[Sun Jul  5 22:27:49 2020]
rule find_best_model:
    input: per_gene/EOG091G03FL/ALICUT_EOG091G03FL.clustalo.fasta, per_gene/EOG091G03FL/empty_check.done
    output: per_gene/EOG091G03FL/EOG091G03FL.best_model
    log: per_gene/EOG091G03FL/find_best_model.stderr.txt
    jobid: 892
    wildcards: BUSCO=EOG091G03FL
    threads: 2


        cd per_gene/EOG091G03FL
        if [ ! -d find_best_model ]
        then
            mkdir find_best_model
        fi
        cd find_best_model
        ln -s ../../../per_gene/EOG091G03FL/ALICUT_EOG091G03FL.clustalo.fasta EOG091G03FL.fasta
        ProteinModelSelection.pl EOG091G03FL.fasta 1> ../../../per_gene/EOG091G03FL/EOG091G03FL.best_model 2> ../../../per_gene/EOG091G03FL/find_best_model.stderr.txt
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/c0c09ee657b1e27f2c5687e0e9aa8d70.simg
[Sun Jul  5 22:28:00 2020]
Finished job 1166.
1061 of 3292 steps (32%) done

[Sun Jul  5 22:28:00 2020]
rule infer_single_ML:
    input: per_gene/EOG091G0KRZ/EOG091G0KRZ.best_model, per_gene/EOG091G0KRZ/ALICUT_EOG091G0KRZ.clustalo.fasta
    output: per_gene/EOG091G0KRZ/EOG091G0KRZ.raxml.done
    log: per_gene/EOG091G0KRZ/infer_single_ML.stdout.txt, per_gene/EOG091G0KRZ/infer_single_ML.stderr.txt
    jobid: 377
    wildcards: BUSCO=EOG091G0KRZ
    threads: 2


        cd per_gene/EOG091G0KRZ
	count=$(cat ../../per_gene/EOG091G0KRZ/ALICUT_EOG091G0KRZ.clustalo.fasta | grep ">" | wc -l)
	if [ "$count" -gt 5 ]
        then
		RAxMLmodel=$(cat ../../per_gene/EOG091G0KRZ/EOG091G0KRZ.best_model | grep "Best" | cut -d ":" -f 2 | tr -d '[:space:]')
                if [ "$(ls -1 | grep "^RAxML" | wc -l)" -ne 0 ]
		then
			rm RAxML*
		fi
        	raxml -f a -T 2 -m PROTGAMMA$RAxMLmodel         	-p 12345 -x 12345 -# 100         	-s ../../per_gene/EOG091G0KRZ/ALICUT_EOG091G0KRZ.clustalo.fasta -n EOG091G0KRZ.clustalo.aln.ALICUT.$RAxMLmodel 		1> ../../per_gene/EOG091G0KRZ/infer_single_ML.stdout.txt 2> ../../per_gene/EOG091G0KRZ/infer_single_ML.stderr.txt
	else
		echo "fasta file per_gene/EOG091G0KRZ/ALICUT_EOG091G0KRZ.clustalo.fasta contains fewer than 5 sequences - skipped" > ../../per_gene/EOG091G0KRZ/infer_single_ML.stdout.txt
		touch raxml.skipped
	fi
        touch ../../per_gene/EOG091G0KRZ/EOG091G0KRZ.raxml.done
        
[33mJob counts:
	count	jobs
	1	infer_single_ML
	1[0m
[33m
        cd per_gene/EOG091G0KRZ
	count=$(cat ../../per_gene/EOG091G0KRZ/ALICUT_EOG091G0KRZ.clustalo.fasta | grep ">" | wc -l)
	if [ "$count" -gt 5 ]
        then
		RAxMLmodel=$(cat ../../per_gene/EOG091G0KRZ/EOG091G0KRZ.best_model | grep "Best" | cut -d ":" -f 2 | tr -d '[:space:]')
                if [ "$(ls -1 | grep "^RAxML" | wc -l)" -ne 0 ]
		then
			rm RAxML*
		fi
        	raxml -f a -T 2 -m PROTGAMMA$RAxMLmodel         	-p 12345 -x 12345 -# 100         	-s ../../per_gene/EOG091G0KRZ/ALICUT_EOG091G0KRZ.clustalo.fasta -n EOG091G0KRZ.clustalo.aln.ALICUT.$RAxMLmodel 		1> ../../per_gene/EOG091G0KRZ/infer_single_ML.stdout.txt 2> ../../per_gene/EOG091G0KRZ/infer_single_ML.stderr.txt
	else
		echo "fasta file per_gene/EOG091G0KRZ/ALICUT_EOG091G0KRZ.clustalo.fasta contains fewer than 5 sequences - skipped" > ../../per_gene/EOG091G0KRZ/infer_single_ML.stdout.txt
		touch raxml.skipped
	fi
        touch ../../per_gene/EOG091G0KRZ/EOG091G0KRZ.raxml.done
        [0m
[Sun Jul  5 22:28:11 2020]
Finished job 746.
1062 of 3292 steps (32%) done

[Sun Jul  5 22:28:11 2020]
rule infer_single_ML:
    input: per_gene/EOG091G0PEI/EOG091G0PEI.best_model, per_gene/EOG091G0PEI/ALICUT_EOG091G0PEI.clustalo.fasta
    output: per_gene/EOG091G0PEI/EOG091G0PEI.raxml.done
    log: per_gene/EOG091G0PEI/infer_single_ML.stdout.txt, per_gene/EOG091G0PEI/infer_single_ML.stderr.txt
    jobid: 167
    wildcards: BUSCO=EOG091G0PEI
    threads: 2


        cd per_gene/EOG091G0PEI
	count=$(cat ../../per_gene/EOG091G0PEI/ALICUT_EOG091G0PEI.clustalo.fasta | grep ">" | wc -l)
	if [ "$count" -gt 5 ]
        then
		RAxMLmodel=$(cat ../../per_gene/EOG091G0PEI/EOG091G0PEI.best_model | grep "Best" | cut -d ":" -f 2 | tr -d '[:space:]')
                if [ "$(ls -1 | grep "^RAxML" | wc -l)" -ne 0 ]
		then
			rm RAxML*
		fi
        	raxml -f a -T 2 -m PROTGAMMA$RAxMLmodel         	-p 12345 -x 12345 -# 100         	-s ../../per_gene/EOG091G0PEI/ALICUT_EOG091G0PEI.clustalo.fasta -n EOG091G0PEI.clustalo.aln.ALICUT.$RAxMLmodel 		1> ../../per_gene/EOG091G0PEI/infer_single_ML.stdout.txt 2> ../../per_gene/EOG091G0PEI/infer_single_ML.stderr.txt
	else
		echo "fasta file per_gene/EOG091G0PEI/ALICUT_EOG091G0PEI.clustalo.fasta contains fewer than 5 sequences - skipped" > ../../per_gene/EOG091G0PEI/infer_single_ML.stdout.txt
		touch raxml.skipped
	fi
        touch ../../per_gene/EOG091G0PEI/EOG091G0PEI.raxml.done
        
[33mJob counts:
	count	jobs
	1	infer_single_ML
	1[0m
[33m
        cd per_gene/EOG091G0PEI
	count=$(cat ../../per_gene/EOG091G0PEI/ALICUT_EOG091G0PEI.clustalo.fasta | grep ">" | wc -l)
	if [ "$count" -gt 5 ]
        then
		RAxMLmodel=$(cat ../../per_gene/EOG091G0PEI/EOG091G0PEI.best_model | grep "Best" | cut -d ":" -f 2 | tr -d '[:space:]')
                if [ "$(ls -1 | grep "^RAxML" | wc -l)" -ne 0 ]
		then
			rm RAxML*
		fi
        	raxml -f a -T 2 -m PROTGAMMA$RAxMLmodel         	-p 12345 -x 12345 -# 100         	-s ../../per_gene/EOG091G0PEI/ALICUT_EOG091G0PEI.clustalo.fasta -n EOG091G0PEI.clustalo.aln.ALICUT.$RAxMLmodel 		1> ../../per_gene/EOG091G0PEI/infer_single_ML.stdout.txt 2> ../../per_gene/EOG091G0PEI/infer_single_ML.stderr.txt
	else
		echo "fasta file per_gene/EOG091G0PEI/ALICUT_EOG091G0PEI.clustalo.fasta contains fewer than 5 sequences - skipped" > ../../per_gene/EOG091G0PEI/infer_single_ML.stdout.txt
		touch raxml.skipped
	fi
        touch ../../per_gene/EOG091G0PEI/EOG091G0PEI.raxml.done
        [0m
[Sun Jul  5 22:28:39 2020]
Finished job 892.
1063 of 3292 steps (32%) done

[Sun Jul  5 22:28:39 2020]
rule infer_single_ML:
    input: per_gene/EOG091G03FL/EOG091G03FL.best_model, per_gene/EOG091G03FL/ALICUT_EOG091G03FL.clustalo.fasta
    output: per_gene/EOG091G03FL/EOG091G03FL.raxml.done
    log: per_gene/EOG091G03FL/infer_single_ML.stdout.txt, per_gene/EOG091G03FL/infer_single_ML.stderr.txt
    jobid: 240
    wildcards: BUSCO=EOG091G03FL
    threads: 2


        cd per_gene/EOG091G03FL
	count=$(cat ../../per_gene/EOG091G03FL/ALICUT_EOG091G03FL.clustalo.fasta | grep ">" | wc -l)
	if [ "$count" -gt 5 ]
        then
		RAxMLmodel=$(cat ../../per_gene/EOG091G03FL/EOG091G03FL.best_model | grep "Best" | cut -d ":" -f 2 | tr -d '[:space:]')
                if [ "$(ls -1 | grep "^RAxML" | wc -l)" -ne 0 ]
		then
			rm RAxML*
		fi
        	raxml -f a -T 2 -m PROTGAMMA$RAxMLmodel         	-p 12345 -x 12345 -# 100         	-s ../../per_gene/EOG091G03FL/ALICUT_EOG091G03FL.clustalo.fasta -n EOG091G03FL.clustalo.aln.ALICUT.$RAxMLmodel 		1> ../../per_gene/EOG091G03FL/infer_single_ML.stdout.txt 2> ../../per_gene/EOG091G03FL/infer_single_ML.stderr.txt
	else
		echo "fasta file per_gene/EOG091G03FL/ALICUT_EOG091G03FL.clustalo.fasta contains fewer than 5 sequences - skipped" > ../../per_gene/EOG091G03FL/infer_single_ML.stdout.txt
		touch raxml.skipped
	fi
        touch ../../per_gene/EOG091G03FL/EOG091G03FL.raxml.done
        
[33mJob counts:
	count	jobs
	1	infer_single_ML
	1[0m
[33m
        cd per_gene/EOG091G03FL
	count=$(cat ../../per_gene/EOG091G03FL/ALICUT_EOG091G03FL.clustalo.fasta | grep ">" | wc -l)
	if [ "$count" -gt 5 ]
        then
		RAxMLmodel=$(cat ../../per_gene/EOG091G03FL/EOG091G03FL.best_model | grep "Best" | cut -d ":" -f 2 | tr -d '[:space:]')
                if [ "$(ls -1 | grep "^RAxML" | wc -l)" -ne 0 ]
		then
			rm RAxML*
		fi
        	raxml -f a -T 2 -m PROTGAMMA$RAxMLmodel         	-p 12345 -x 12345 -# 100         	-s ../../per_gene/EOG091G03FL/ALICUT_EOG091G03FL.clustalo.fasta -n EOG091G03FL.clustalo.aln.ALICUT.$RAxMLmodel 		1> ../../per_gene/EOG091G03FL/infer_single_ML.stdout.txt 2> ../../per_gene/EOG091G03FL/infer_single_ML.stderr.txt
	else
		echo "fasta file per_gene/EOG091G03FL/ALICUT_EOG091G03FL.clustalo.fasta contains fewer than 5 sequences - skipped" > ../../per_gene/EOG091G03FL/infer_single_ML.stdout.txt
		touch raxml.skipped
	fi
        touch ../../per_gene/EOG091G03FL/EOG091G03FL.raxml.done
        [0m
[Sun Jul  5 22:28:42 2020]
Finished job 249.
1064 of 3292 steps (32%) done

[Sun Jul  5 22:28:42 2020]
rule infer_single_ML:
    input: per_gene/EOG091G0TCJ/EOG091G0TCJ.best_model, per_gene/EOG091G0TCJ/ALICUT_EOG091G0TCJ.clustalo.fasta
    output: per_gene/EOG091G0TCJ/EOG091G0TCJ.raxml.done
    log: per_gene/EOG091G0TCJ/infer_single_ML.stdout.txt, per_gene/EOG091G0TCJ/infer_single_ML.stderr.txt
    jobid: 191
    wildcards: BUSCO=EOG091G0TCJ
    threads: 2


        cd per_gene/EOG091G0TCJ
	count=$(cat ../../per_gene/EOG091G0TCJ/ALICUT_EOG091G0TCJ.clustalo.fasta | grep ">" | wc -l)
	if [ "$count" -gt 5 ]
        then
		RAxMLmodel=$(cat ../../per_gene/EOG091G0TCJ/EOG091G0TCJ.best_model | grep "Best" | cut -d ":" -f 2 | tr -d '[:space:]')
                if [ "$(ls -1 | grep "^RAxML" | wc -l)" -ne 0 ]
		then
			rm RAxML*
		fi
        	raxml -f a -T 2 -m PROTGAMMA$RAxMLmodel         	-p 12345 -x 12345 -# 100         	-s ../../per_gene/EOG091G0TCJ/ALICUT_EOG091G0TCJ.clustalo.fasta -n EOG091G0TCJ.clustalo.aln.ALICUT.$RAxMLmodel 		1> ../../per_gene/EOG091G0TCJ/infer_single_ML.stdout.txt 2> ../../per_gene/EOG091G0TCJ/infer_single_ML.stderr.txt
	else
		echo "fasta file per_gene/EOG091G0TCJ/ALICUT_EOG091G0TCJ.clustalo.fasta contains fewer than 5 sequences - skipped" > ../../per_gene/EOG091G0TCJ/infer_single_ML.stdout.txt
		touch raxml.skipped
	fi
        touch ../../per_gene/EOG091G0TCJ/EOG091G0TCJ.raxml.done
        
[33mJob counts:
	count	jobs
	1	infer_single_ML
	1[0m
[33m
        cd per_gene/EOG091G0TCJ
	count=$(cat ../../per_gene/EOG091G0TCJ/ALICUT_EOG091G0TCJ.clustalo.fasta | grep ">" | wc -l)
	if [ "$count" -gt 5 ]
        then
		RAxMLmodel=$(cat ../../per_gene/EOG091G0TCJ/EOG091G0TCJ.best_model | grep "Best" | cut -d ":" -f 2 | tr -d '[:space:]')
                if [ "$(ls -1 | grep "^RAxML" | wc -l)" -ne 0 ]
		then
			rm RAxML*
		fi
        	raxml -f a -T 2 -m PROTGAMMA$RAxMLmodel         	-p 12345 -x 12345 -# 100         	-s ../../per_gene/EOG091G0TCJ/ALICUT_EOG091G0TCJ.clustalo.fasta -n EOG091G0TCJ.clustalo.aln.ALICUT.$RAxMLmodel 		1> ../../per_gene/EOG091G0TCJ/infer_single_ML.stdout.txt 2> ../../per_gene/EOG091G0TCJ/infer_single_ML.stderr.txt
	else
		echo "fasta file per_gene/EOG091G0TCJ/ALICUT_EOG091G0TCJ.clustalo.fasta contains fewer than 5 sequences - skipped" > ../../per_gene/EOG091G0TCJ/infer_single_ML.stdout.txt
		touch raxml.skipped
	fi
        touch ../../per_gene/EOG091G0TCJ/EOG091G0TCJ.raxml.done
        [0m
[Sun Jul  5 22:28:45 2020]
Finished job 296.
1065 of 3292 steps (32%) done

[Sun Jul  5 22:28:45 2020]
rule get_seqs:
    input: /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ingroup.txt, /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/outgroup.txt
    output: per_gene/EOG091G17K3/EOG091G17K3.ingroup.fasta
    log: per_gene/EOG091G17K3/get_seqs.stdout.txt, per_gene/EOG091G17K3/get_seqs.stderr.txt
    jobid: 2936
    wildcards: BUSCO=EOG091G17K3
    threads: 2


	basedir=$(pwd)
        cd per_gene/EOG091G17K3
        
        bash $basedir/../scripts/fetch_seqs.sh EOG091G17K3 /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ingroup.txt /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/outgroup.txt 1> ../../per_gene/EOG091G17K3/get_seqs.stdout.txt 2> ../../per_gene/EOG091G17K3/get_seqs.stderr.txt
	mv EOG091G17K3.fasta $basedir/per_gene/EOG091G17K3/EOG091G17K3.ingroup.fasta
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/72476f9d9a5bd0627b4d721143a21354.simg
[Sun Jul  5 22:28:56 2020]
Finished job 274.
1066 of 3292 steps (32%) done

[Sun Jul  5 22:28:56 2020]
rule get_seqs:
    input: /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ingroup.txt, /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/outgroup.txt
    output: per_gene/EOG091G0554/EOG091G0554.ingroup.fasta
    log: per_gene/EOG091G0554/get_seqs.stdout.txt, per_gene/EOG091G0554/get_seqs.stderr.txt
    jobid: 3266
    wildcards: BUSCO=EOG091G0554
    threads: 2


	basedir=$(pwd)
        cd per_gene/EOG091G0554
        
        bash $basedir/../scripts/fetch_seqs.sh EOG091G0554 /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ingroup.txt /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/outgroup.txt 1> ../../per_gene/EOG091G0554/get_seqs.stdout.txt 2> ../../per_gene/EOG091G0554/get_seqs.stderr.txt
	mv EOG091G0554.fasta $basedir/per_gene/EOG091G0554/EOG091G0554.ingroup.fasta
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/72476f9d9a5bd0627b4d721143a21354.simg
[Sun Jul  5 22:29:01 2020]
Finished job 38.
1067 of 3292 steps (32%) done

[Sun Jul  5 22:29:01 2020]
rule get_seqs:
    input: /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ingroup.txt, /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/outgroup.txt
    output: per_gene/EOG091G046Y/EOG091G046Y.ingroup.fasta
    log: per_gene/EOG091G046Y/get_seqs.stdout.txt, per_gene/EOG091G046Y/get_seqs.stderr.txt
    jobid: 2522
    wildcards: BUSCO=EOG091G046Y
    threads: 2


	basedir=$(pwd)
        cd per_gene/EOG091G046Y
        
        bash $basedir/../scripts/fetch_seqs.sh EOG091G046Y /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ingroup.txt /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/outgroup.txt 1> ../../per_gene/EOG091G046Y/get_seqs.stdout.txt 2> ../../per_gene/EOG091G046Y/get_seqs.stderr.txt
	mv EOG091G046Y.fasta $basedir/per_gene/EOG091G046Y/EOG091G046Y.ingroup.fasta
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/72476f9d9a5bd0627b4d721143a21354.simg
[Sun Jul  5 22:29:04 2020]
Finished job 2936.
1068 of 3292 steps (32%) done

[Sun Jul  5 22:29:04 2020]
rule get_outgroups:
    input: per_gene/EOG091G17K3/EOG091G17K3.ingroup.fasta
    output: per_gene/EOG091G17K3/EOG091G17K3.orthodb.fasta, per_gene/EOG091G17K3/EOG091G17K3.outgroup.fasta
    log: per_gene/EOG091G17K3/get_outgroups.stdout.txt, per_gene/EOG091G17K3/get_outgroups.stderr.txt
    jobid: 2937
    wildcards: BUSCO=EOG091G17K3


        #download fastas from Orhtodb for BUSCO id
        for i in {1..5}
        do
             wget "http://www.orthodb.org/fasta?query=EOG091G17K3&level=33208" -O per_gene/EOG091G17K3/EOG091G17K3.orthodb.fasta 1> per_gene/EOG091G17K3/get_outgroups.stdout.txt 2> per_gene/EOG091G17K3/get_outgroups.stderr.txt && break || echo -e "try again ($i)" && sleep 15
        done

	#This is quick an dirty for now and just takes the first protein if there is more than one for an outgroup taxon
        bash ../scripts/download_outgroups.sh taxids.txt per_gene/EOG091G17K3/EOG091G17K3.orthodb.fasta > per_gene/EOG091G17K3/EOG091G17K3.outgroup.fasta
        
[Sun Jul  5 22:29:05 2020]
Finished job 2937.
1069 of 3292 steps (32%) done

[Sun Jul  5 22:29:05 2020]
rule join_groups:
    input: per_gene/EOG091G17K3/EOG091G17K3.ingroup.fasta, per_gene/EOG091G17K3/EOG091G17K3.outgroup.fasta
    output: per_gene/EOG091G17K3/EOG091G17K3.fasta
    jobid: 2292
    wildcards: BUSCO=EOG091G17K3


        cat per_gene/EOG091G17K3/EOG091G17K3.ingroup.fasta per_gene/EOG091G17K3/EOG091G17K3.outgroup.fasta > per_gene/EOG091G17K3/EOG091G17K3.fasta
        
[Sun Jul  5 22:29:05 2020]
Finished job 2292.
1070 of 3292 steps (33%) done

[Sun Jul  5 22:29:05 2020]
rule MSA:
    input: per_gene/EOG091G17K3/EOG091G17K3.fasta
    output: per_gene/EOG091G17K3/EOG091G17K3.clustalo.fasta
    log: per_gene/EOG091G17K3/MSA.stdout.txt, per_gene/EOG091G17K3/MSA.stderr.txt
    jobid: 1704
    wildcards: BUSCO=EOG091G17K3
    threads: 2


        clustalo -i per_gene/EOG091G17K3/EOG091G17K3.fasta -o per_gene/EOG091G17K3/EOG091G17K3.clustalo.fasta --threads=2 1> per_gene/EOG091G17K3/MSA.stdout.txt 2> per_gene/EOG091G17K3/MSA.stderr.txt
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/d68c9691725a7401923680874285c430.simg
[Sun Jul  5 22:29:06 2020]
Finished job 1704.
1071 of 3292 steps (33%) done

[Sun Jul  5 22:29:06 2020]
rule score_and_cut:
    input: per_gene/EOG091G17K3/EOG091G17K3.clustalo.fasta
    output: per_gene/EOG091G17K3/ALICUT_EOG091G17K3.clustalo.fasta
    jobid: 881
    wildcards: BUSCO=EOG091G17K3
    threads: 2


        cd per_gene/EOG091G17K3
        Aliscore.pl -N -r 200000000000000000 -i ../../per_gene/EOG091G17K3/EOG091G17K3.clustalo.fasta &> aliscore.log
        ALICUT.pl -s &> alicut.log
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/63c88c27a0fa300f57066b0ef65fefcb.simg
[Sun Jul  5 22:29:10 2020]
Finished job 3266.
1072 of 3292 steps (33%) done

[Sun Jul  5 22:29:10 2020]
rule get_outgroups:
    input: per_gene/EOG091G0554/EOG091G0554.ingroup.fasta
    output: per_gene/EOG091G0554/EOG091G0554.orthodb.fasta, per_gene/EOG091G0554/EOG091G0554.outgroup.fasta
    log: per_gene/EOG091G0554/get_outgroups.stdout.txt, per_gene/EOG091G0554/get_outgroups.stderr.txt
    jobid: 3267
    wildcards: BUSCO=EOG091G0554


        #download fastas from Orhtodb for BUSCO id
        for i in {1..5}
        do
             wget "http://www.orthodb.org/fasta?query=EOG091G0554&level=33208" -O per_gene/EOG091G0554/EOG091G0554.orthodb.fasta 1> per_gene/EOG091G0554/get_outgroups.stdout.txt 2> per_gene/EOG091G0554/get_outgroups.stderr.txt && break || echo -e "try again ($i)" && sleep 15
        done

	#This is quick an dirty for now and just takes the first protein if there is more than one for an outgroup taxon
        bash ../scripts/download_outgroups.sh taxids.txt per_gene/EOG091G0554/EOG091G0554.orthodb.fasta > per_gene/EOG091G0554/EOG091G0554.outgroup.fasta
        
[Sun Jul  5 22:29:11 2020]
Finished job 3267.
1073 of 3292 steps (33%) done

[Sun Jul  5 22:29:11 2020]
rule join_groups:
    input: per_gene/EOG091G0554/EOG091G0554.ingroup.fasta, per_gene/EOG091G0554/EOG091G0554.outgroup.fasta
    output: per_gene/EOG091G0554/EOG091G0554.fasta
    jobid: 2457
    wildcards: BUSCO=EOG091G0554


        cat per_gene/EOG091G0554/EOG091G0554.ingroup.fasta per_gene/EOG091G0554/EOG091G0554.outgroup.fasta > per_gene/EOG091G0554/EOG091G0554.fasta
        
[Sun Jul  5 22:29:12 2020]
Finished job 2457.
1074 of 3292 steps (33%) done

[Sun Jul  5 22:29:12 2020]
rule MSA:
    input: per_gene/EOG091G0554/EOG091G0554.fasta
    output: per_gene/EOG091G0554/EOG091G0554.clustalo.fasta
    log: per_gene/EOG091G0554/MSA.stdout.txt, per_gene/EOG091G0554/MSA.stderr.txt
    jobid: 2034
    wildcards: BUSCO=EOG091G0554
    threads: 2


        clustalo -i per_gene/EOG091G0554/EOG091G0554.fasta -o per_gene/EOG091G0554/EOG091G0554.clustalo.fasta --threads=2 1> per_gene/EOG091G0554/MSA.stdout.txt 2> per_gene/EOG091G0554/MSA.stderr.txt
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/d68c9691725a7401923680874285c430.simg
[Sun Jul  5 22:29:15 2020]
Finished job 2034.
1075 of 3292 steps (33%) done

[Sun Jul  5 22:29:15 2020]
rule score_and_cut:
    input: per_gene/EOG091G0554/EOG091G0554.clustalo.fasta
    output: per_gene/EOG091G0554/ALICUT_EOG091G0554.clustalo.fasta
    jobid: 1211
    wildcards: BUSCO=EOG091G0554
    threads: 2


        cd per_gene/EOG091G0554
        Aliscore.pl -N -r 200000000000000000 -i ../../per_gene/EOG091G0554/EOG091G0554.clustalo.fasta &> aliscore.log
        ALICUT.pl -s &> alicut.log
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/63c88c27a0fa300f57066b0ef65fefcb.simg
[Sun Jul  5 22:29:15 2020]
Finished job 2522.
1076 of 3292 steps (33%) done

[Sun Jul  5 22:29:15 2020]
rule get_outgroups:
    input: per_gene/EOG091G046Y/EOG091G046Y.ingroup.fasta
    output: per_gene/EOG091G046Y/EOG091G046Y.orthodb.fasta, per_gene/EOG091G046Y/EOG091G046Y.outgroup.fasta
    log: per_gene/EOG091G046Y/get_outgroups.stdout.txt, per_gene/EOG091G046Y/get_outgroups.stderr.txt
    jobid: 2523
    wildcards: BUSCO=EOG091G046Y


        #download fastas from Orhtodb for BUSCO id
        for i in {1..5}
        do
             wget "http://www.orthodb.org/fasta?query=EOG091G046Y&level=33208" -O per_gene/EOG091G046Y/EOG091G046Y.orthodb.fasta 1> per_gene/EOG091G046Y/get_outgroups.stdout.txt 2> per_gene/EOG091G046Y/get_outgroups.stderr.txt && break || echo -e "try again ($i)" && sleep 15
        done

	#This is quick an dirty for now and just takes the first protein if there is more than one for an outgroup taxon
        bash ../scripts/download_outgroups.sh taxids.txt per_gene/EOG091G046Y/EOG091G046Y.orthodb.fasta > per_gene/EOG091G046Y/EOG091G046Y.outgroup.fasta
        
[Sun Jul  5 22:29:16 2020]
Finished job 2523.
1077 of 3292 steps (33%) done
[Sun Jul  5 22:29:16 2020]
Finished job 881.
1078 of 3292 steps (33%) done

[Sun Jul  5 22:29:16 2020]
rule get_seqs:
    input: /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ingroup.txt, /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/outgroup.txt
    output: per_gene/EOG091G07NJ/EOG091G07NJ.ingroup.fasta
    log: per_gene/EOG091G07NJ/get_seqs.stdout.txt, per_gene/EOG091G07NJ/get_seqs.stderr.txt
    jobid: 2578
    wildcards: BUSCO=EOG091G07NJ
    threads: 2


	basedir=$(pwd)
        cd per_gene/EOG091G07NJ
        
        bash $basedir/../scripts/fetch_seqs.sh EOG091G07NJ /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ingroup.txt /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/outgroup.txt 1> ../../per_gene/EOG091G07NJ/get_seqs.stdout.txt 2> ../../per_gene/EOG091G07NJ/get_seqs.stderr.txt
	mv EOG091G07NJ.fasta $basedir/per_gene/EOG091G07NJ/EOG091G07NJ.ingroup.fasta
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/72476f9d9a5bd0627b4d721143a21354.simg

[Sun Jul  5 22:29:16 2020]
rule join_groups:
    input: per_gene/EOG091G046Y/EOG091G046Y.ingroup.fasta, per_gene/EOG091G046Y/EOG091G046Y.outgroup.fasta
    output: per_gene/EOG091G046Y/EOG091G046Y.fasta
    jobid: 2085
    wildcards: BUSCO=EOG091G046Y


        cat per_gene/EOG091G046Y/EOG091G046Y.ingroup.fasta per_gene/EOG091G046Y/EOG091G046Y.outgroup.fasta > per_gene/EOG091G046Y/EOG091G046Y.fasta
        

[Sun Jul  5 22:29:16 2020]
rule remove_empty:
    input: per_gene/EOG091G17K3/ALICUT_EOG091G17K3.clustalo.fasta
    output: per_gene/EOG091G17K3/empty_check.done
    jobid: 1703
    wildcards: BUSCO=EOG091G17K3


         if [ "$(cat per_gene/EOG091G17K3/ALICUT_EOG091G17K3.clustalo.fasta | grep -v ">" | sed 's/-//g' | grep "^$" | wc -l)" -gt 0 ]
         then
              cp per_gene/EOG091G17K3/ALICUT_EOG091G17K3.clustalo.fasta per_gene/EOG091G17K3/ALICUT_EOG091G17K3.clustalo.fasta.backup
              bash ../scripts/remove_empty.sh per_gene/EOG091G17K3/ALICUT_EOG091G17K3.clustalo.fasta.backup > per_gene/EOG091G17K3/ALICUT_EOG091G17K3.clustalo.fasta
         fi
         touch per_gene/EOG091G17K3/empty_check.done
         
[Sun Jul  5 22:29:16 2020]
Finished job 2085.
1079 of 3292 steps (33%) done
[Sun Jul  5 22:29:16 2020]
Finished job 1703.
1080 of 3292 steps (33%) done

[Sun Jul  5 22:29:16 2020]
rule MSA:
    input: per_gene/EOG091G046Y/EOG091G046Y.fasta
    output: per_gene/EOG091G046Y/EOG091G046Y.clustalo.fasta
    log: per_gene/EOG091G046Y/MSA.stdout.txt, per_gene/EOG091G046Y/MSA.stderr.txt
    jobid: 1290
    wildcards: BUSCO=EOG091G046Y
    threads: 2


        clustalo -i per_gene/EOG091G046Y/EOG091G046Y.fasta -o per_gene/EOG091G046Y/EOG091G046Y.clustalo.fasta --threads=2 1> per_gene/EOG091G046Y/MSA.stdout.txt 2> per_gene/EOG091G046Y/MSA.stderr.txt
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/d68c9691725a7401923680874285c430.simg
[Sun Jul  5 22:29:18 2020]
Finished job 1290.
1081 of 3292 steps (33%) done

[Sun Jul  5 22:29:18 2020]
rule score_and_cut:
    input: per_gene/EOG091G046Y/EOG091G046Y.clustalo.fasta
    output: per_gene/EOG091G046Y/ALICUT_EOG091G046Y.clustalo.fasta
    jobid: 467
    wildcards: BUSCO=EOG091G046Y
    threads: 2


        cd per_gene/EOG091G046Y
        Aliscore.pl -N -r 200000000000000000 -i ../../per_gene/EOG091G046Y/EOG091G046Y.clustalo.fasta &> aliscore.log
        ALICUT.pl -s &> alicut.log
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/63c88c27a0fa300f57066b0ef65fefcb.simg
[Sun Jul  5 22:29:19 2020]
Finished job 177.
1082 of 3292 steps (33%) done

[Sun Jul  5 22:29:19 2020]
rule find_best_model:
    input: per_gene/EOG091G17K3/ALICUT_EOG091G17K3.clustalo.fasta, per_gene/EOG091G17K3/empty_check.done
    output: per_gene/EOG091G17K3/EOG091G17K3.best_model
    log: per_gene/EOG091G17K3/find_best_model.stderr.txt
    jobid: 880
    wildcards: BUSCO=EOG091G17K3
    threads: 2


        cd per_gene/EOG091G17K3
        if [ ! -d find_best_model ]
        then
            mkdir find_best_model
        fi
        cd find_best_model
        ln -s ../../../per_gene/EOG091G17K3/ALICUT_EOG091G17K3.clustalo.fasta EOG091G17K3.fasta
        ProteinModelSelection.pl EOG091G17K3.fasta 1> ../../../per_gene/EOG091G17K3/EOG091G17K3.best_model 2> ../../../per_gene/EOG091G17K3/find_best_model.stderr.txt
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/c0c09ee657b1e27f2c5687e0e9aa8d70.simg
[Sun Jul  5 22:29:26 2020]
Finished job 1211.
1083 of 3292 steps (33%) done

[Sun Jul  5 22:29:26 2020]
rule remove_empty:
    input: per_gene/EOG091G0554/ALICUT_EOG091G0554.clustalo.fasta
    output: per_gene/EOG091G0554/empty_check.done
    jobid: 2033
    wildcards: BUSCO=EOG091G0554


         if [ "$(cat per_gene/EOG091G0554/ALICUT_EOG091G0554.clustalo.fasta | grep -v ">" | sed 's/-//g' | grep "^$" | wc -l)" -gt 0 ]
         then
              cp per_gene/EOG091G0554/ALICUT_EOG091G0554.clustalo.fasta per_gene/EOG091G0554/ALICUT_EOG091G0554.clustalo.fasta.backup
              bash ../scripts/remove_empty.sh per_gene/EOG091G0554/ALICUT_EOG091G0554.clustalo.fasta.backup > per_gene/EOG091G0554/ALICUT_EOG091G0554.clustalo.fasta
         fi
         touch per_gene/EOG091G0554/empty_check.done
         
[Sun Jul  5 22:29:26 2020]
Finished job 2033.
1084 of 3292 steps (33%) done

[Sun Jul  5 22:29:26 2020]
rule find_best_model:
    input: per_gene/EOG091G0554/ALICUT_EOG091G0554.clustalo.fasta, per_gene/EOG091G0554/empty_check.done
    output: per_gene/EOG091G0554/EOG091G0554.best_model
    log: per_gene/EOG091G0554/find_best_model.stderr.txt
    jobid: 1210
    wildcards: BUSCO=EOG091G0554
    threads: 2


        cd per_gene/EOG091G0554
        if [ ! -d find_best_model ]
        then
            mkdir find_best_model
        fi
        cd find_best_model
        ln -s ../../../per_gene/EOG091G0554/ALICUT_EOG091G0554.clustalo.fasta EOG091G0554.fasta
        ProteinModelSelection.pl EOG091G0554.fasta 1> ../../../per_gene/EOG091G0554/EOG091G0554.best_model 2> ../../../per_gene/EOG091G0554/find_best_model.stderr.txt
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/c0c09ee657b1e27f2c5687e0e9aa8d70.simg
[Sun Jul  5 22:29:28 2020]
Finished job 467.
1085 of 3292 steps (33%) done

[Sun Jul  5 22:29:28 2020]
rule remove_empty:
    input: per_gene/EOG091G046Y/ALICUT_EOG091G046Y.clustalo.fasta
    output: per_gene/EOG091G046Y/empty_check.done
    jobid: 1289
    wildcards: BUSCO=EOG091G046Y


         if [ "$(cat per_gene/EOG091G046Y/ALICUT_EOG091G046Y.clustalo.fasta | grep -v ">" | sed 's/-//g' | grep "^$" | wc -l)" -gt 0 ]
         then
              cp per_gene/EOG091G046Y/ALICUT_EOG091G046Y.clustalo.fasta per_gene/EOG091G046Y/ALICUT_EOG091G046Y.clustalo.fasta.backup
              bash ../scripts/remove_empty.sh per_gene/EOG091G046Y/ALICUT_EOG091G046Y.clustalo.fasta.backup > per_gene/EOG091G046Y/ALICUT_EOG091G046Y.clustalo.fasta
         fi
         touch per_gene/EOG091G046Y/empty_check.done
         
[Sun Jul  5 22:29:28 2020]
Finished job 1289.
1086 of 3292 steps (33%) done

[Sun Jul  5 22:29:28 2020]
rule find_best_model:
    input: per_gene/EOG091G046Y/ALICUT_EOG091G046Y.clustalo.fasta, per_gene/EOG091G046Y/empty_check.done
    output: per_gene/EOG091G046Y/EOG091G046Y.best_model
    log: per_gene/EOG091G046Y/find_best_model.stderr.txt
    jobid: 466
    wildcards: BUSCO=EOG091G046Y
    threads: 2


        cd per_gene/EOG091G046Y
        if [ ! -d find_best_model ]
        then
            mkdir find_best_model
        fi
        cd find_best_model
        ln -s ../../../per_gene/EOG091G046Y/ALICUT_EOG091G046Y.clustalo.fasta EOG091G046Y.fasta
        ProteinModelSelection.pl EOG091G046Y.fasta 1> ../../../per_gene/EOG091G046Y/EOG091G046Y.best_model 2> ../../../per_gene/EOG091G046Y/find_best_model.stderr.txt
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/c0c09ee657b1e27f2c5687e0e9aa8d70.simg
[Sun Jul  5 22:29:31 2020]
Finished job 2578.
1087 of 3292 steps (33%) done

[Sun Jul  5 22:29:31 2020]
rule get_outgroups:
    input: per_gene/EOG091G07NJ/EOG091G07NJ.ingroup.fasta
    output: per_gene/EOG091G07NJ/EOG091G07NJ.orthodb.fasta, per_gene/EOG091G07NJ/EOG091G07NJ.outgroup.fasta
    log: per_gene/EOG091G07NJ/get_outgroups.stdout.txt, per_gene/EOG091G07NJ/get_outgroups.stderr.txt
    jobid: 2579
    wildcards: BUSCO=EOG091G07NJ


        #download fastas from Orhtodb for BUSCO id
        for i in {1..5}
        do
             wget "http://www.orthodb.org/fasta?query=EOG091G07NJ&level=33208" -O per_gene/EOG091G07NJ/EOG091G07NJ.orthodb.fasta 1> per_gene/EOG091G07NJ/get_outgroups.stdout.txt 2> per_gene/EOG091G07NJ/get_outgroups.stderr.txt && break || echo -e "try again ($i)" && sleep 15
        done

	#This is quick an dirty for now and just takes the first protein if there is more than one for an outgroup taxon
        bash ../scripts/download_outgroups.sh taxids.txt per_gene/EOG091G07NJ/EOG091G07NJ.orthodb.fasta > per_gene/EOG091G07NJ/EOG091G07NJ.outgroup.fasta
        
[Sun Jul  5 22:29:32 2020]
Finished job 2579.
1088 of 3292 steps (33%) done

[Sun Jul  5 22:29:32 2020]
rule join_groups:
    input: per_gene/EOG091G07NJ/EOG091G07NJ.ingroup.fasta, per_gene/EOG091G07NJ/EOG091G07NJ.outgroup.fasta
    output: per_gene/EOG091G07NJ/EOG091G07NJ.fasta
    jobid: 2113
    wildcards: BUSCO=EOG091G07NJ


        cat per_gene/EOG091G07NJ/EOG091G07NJ.ingroup.fasta per_gene/EOG091G07NJ/EOG091G07NJ.outgroup.fasta > per_gene/EOG091G07NJ/EOG091G07NJ.fasta
        
[Sun Jul  5 22:29:32 2020]
Finished job 2113.
1089 of 3292 steps (33%) done

[Sun Jul  5 22:29:32 2020]
rule MSA:
    input: per_gene/EOG091G07NJ/EOG091G07NJ.fasta
    output: per_gene/EOG091G07NJ/EOG091G07NJ.clustalo.fasta
    log: per_gene/EOG091G07NJ/MSA.stdout.txt, per_gene/EOG091G07NJ/MSA.stderr.txt
    jobid: 1346
    wildcards: BUSCO=EOG091G07NJ
    threads: 2


        clustalo -i per_gene/EOG091G07NJ/EOG091G07NJ.fasta -o per_gene/EOG091G07NJ/EOG091G07NJ.clustalo.fasta --threads=2 1> per_gene/EOG091G07NJ/MSA.stdout.txt 2> per_gene/EOG091G07NJ/MSA.stderr.txt
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/d68c9691725a7401923680874285c430.simg
[Sun Jul  5 22:29:33 2020]
Finished job 1346.
1090 of 3292 steps (33%) done

[Sun Jul  5 22:29:33 2020]
rule score_and_cut:
    input: per_gene/EOG091G07NJ/EOG091G07NJ.clustalo.fasta
    output: per_gene/EOG091G07NJ/ALICUT_EOG091G07NJ.clustalo.fasta
    jobid: 523
    wildcards: BUSCO=EOG091G07NJ
    threads: 2


        cd per_gene/EOG091G07NJ
        Aliscore.pl -N -r 200000000000000000 -i ../../per_gene/EOG091G07NJ/EOG091G07NJ.clustalo.fasta &> aliscore.log
        ALICUT.pl -s &> alicut.log
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/63c88c27a0fa300f57066b0ef65fefcb.simg
[Sun Jul  5 22:29:41 2020]
Finished job 384.
1091 of 3292 steps (33%) done

[Sun Jul  5 22:29:41 2020]
rule get_seqs:
    input: /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ingroup.txt, /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/outgroup.txt
    output: per_gene/EOG091G0R04/EOG091G0R04.ingroup.fasta
    log: per_gene/EOG091G0R04/get_seqs.stdout.txt, per_gene/EOG091G0R04/get_seqs.stderr.txt
    jobid: 2828
    wildcards: BUSCO=EOG091G0R04
    threads: 2


	basedir=$(pwd)
        cd per_gene/EOG091G0R04
        
        bash $basedir/../scripts/fetch_seqs.sh EOG091G0R04 /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ingroup.txt /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/outgroup.txt 1> ../../per_gene/EOG091G0R04/get_seqs.stdout.txt 2> ../../per_gene/EOG091G0R04/get_seqs.stderr.txt
	mv EOG091G0R04.fasta $basedir/per_gene/EOG091G0R04/EOG091G0R04.ingroup.fasta
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/72476f9d9a5bd0627b4d721143a21354.simg
[Sun Jul  5 22:29:43 2020]
Finished job 95.
1092 of 3292 steps (33%) done

[Sun Jul  5 22:29:43 2020]
rule get_seqs:
    input: /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ingroup.txt, /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/outgroup.txt
    output: per_gene/EOG091G0GKH/EOG091G0GKH.ingroup.fasta
    log: per_gene/EOG091G0GKH/get_seqs.stdout.txt, per_gene/EOG091G0GKH/get_seqs.stderr.txt
    jobid: 2690
    wildcards: BUSCO=EOG091G0GKH
    threads: 2


	basedir=$(pwd)
        cd per_gene/EOG091G0GKH
        
        bash $basedir/../scripts/fetch_seqs.sh EOG091G0GKH /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ingroup.txt /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/outgroup.txt 1> ../../per_gene/EOG091G0GKH/get_seqs.stdout.txt 2> ../../per_gene/EOG091G0GKH/get_seqs.stderr.txt
	mv EOG091G0GKH.fasta $basedir/per_gene/EOG091G0GKH/EOG091G0GKH.ingroup.fasta
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/72476f9d9a5bd0627b4d721143a21354.simg
[Sun Jul  5 22:29:43 2020]
Finished job 523.
1093 of 3292 steps (33%) done

[Sun Jul  5 22:29:43 2020]
rule remove_empty:
    input: per_gene/EOG091G07NJ/ALICUT_EOG091G07NJ.clustalo.fasta
    output: per_gene/EOG091G07NJ/empty_check.done
    jobid: 1345
    wildcards: BUSCO=EOG091G07NJ


         if [ "$(cat per_gene/EOG091G07NJ/ALICUT_EOG091G07NJ.clustalo.fasta | grep -v ">" | sed 's/-//g' | grep "^$" | wc -l)" -gt 0 ]
         then
              cp per_gene/EOG091G07NJ/ALICUT_EOG091G07NJ.clustalo.fasta per_gene/EOG091G07NJ/ALICUT_EOG091G07NJ.clustalo.fasta.backup
              bash ../scripts/remove_empty.sh per_gene/EOG091G07NJ/ALICUT_EOG091G07NJ.clustalo.fasta.backup > per_gene/EOG091G07NJ/ALICUT_EOG091G07NJ.clustalo.fasta
         fi
         touch per_gene/EOG091G07NJ/empty_check.done
         
[Sun Jul  5 22:29:43 2020]
Finished job 1345.
1094 of 3292 steps (33%) done

[Sun Jul  5 22:29:43 2020]
rule find_best_model:
    input: per_gene/EOG091G07NJ/ALICUT_EOG091G07NJ.clustalo.fasta, per_gene/EOG091G07NJ/empty_check.done
    output: per_gene/EOG091G07NJ/EOG091G07NJ.best_model
    log: per_gene/EOG091G07NJ/find_best_model.stderr.txt
    jobid: 522
    wildcards: BUSCO=EOG091G07NJ
    threads: 2


        cd per_gene/EOG091G07NJ
        if [ ! -d find_best_model ]
        then
            mkdir find_best_model
        fi
        cd find_best_model
        ln -s ../../../per_gene/EOG091G07NJ/ALICUT_EOG091G07NJ.clustalo.fasta EOG091G07NJ.fasta
        ProteinModelSelection.pl EOG091G07NJ.fasta 1> ../../../per_gene/EOG091G07NJ/EOG091G07NJ.best_model 2> ../../../per_gene/EOG091G07NJ/find_best_model.stderr.txt
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/c0c09ee657b1e27f2c5687e0e9aa8d70.simg
[Sun Jul  5 22:29:57 2020]
Finished job 880.
1095 of 3292 steps (33%) done

[Sun Jul  5 22:29:57 2020]
rule infer_single_ML:
    input: per_gene/EOG091G17K3/EOG091G17K3.best_model, per_gene/EOG091G17K3/ALICUT_EOG091G17K3.clustalo.fasta
    output: per_gene/EOG091G17K3/EOG091G17K3.raxml.done
    log: per_gene/EOG091G17K3/infer_single_ML.stdout.txt, per_gene/EOG091G17K3/infer_single_ML.stderr.txt
    jobid: 234
    wildcards: BUSCO=EOG091G17K3
    threads: 2


        cd per_gene/EOG091G17K3
	count=$(cat ../../per_gene/EOG091G17K3/ALICUT_EOG091G17K3.clustalo.fasta | grep ">" | wc -l)
	if [ "$count" -gt 5 ]
        then
		RAxMLmodel=$(cat ../../per_gene/EOG091G17K3/EOG091G17K3.best_model | grep "Best" | cut -d ":" -f 2 | tr -d '[:space:]')
                if [ "$(ls -1 | grep "^RAxML" | wc -l)" -ne 0 ]
		then
			rm RAxML*
		fi
        	raxml -f a -T 2 -m PROTGAMMA$RAxMLmodel         	-p 12345 -x 12345 -# 100         	-s ../../per_gene/EOG091G17K3/ALICUT_EOG091G17K3.clustalo.fasta -n EOG091G17K3.clustalo.aln.ALICUT.$RAxMLmodel 		1> ../../per_gene/EOG091G17K3/infer_single_ML.stdout.txt 2> ../../per_gene/EOG091G17K3/infer_single_ML.stderr.txt
	else
		echo "fasta file per_gene/EOG091G17K3/ALICUT_EOG091G17K3.clustalo.fasta contains fewer than 5 sequences - skipped" > ../../per_gene/EOG091G17K3/infer_single_ML.stdout.txt
		touch raxml.skipped
	fi
        touch ../../per_gene/EOG091G17K3/EOG091G17K3.raxml.done
        
[33mJob counts:
	count	jobs
	1	infer_single_ML
	1[0m
[33m
        cd per_gene/EOG091G17K3
	count=$(cat ../../per_gene/EOG091G17K3/ALICUT_EOG091G17K3.clustalo.fasta | grep ">" | wc -l)
	if [ "$count" -gt 5 ]
        then
		RAxMLmodel=$(cat ../../per_gene/EOG091G17K3/EOG091G17K3.best_model | grep "Best" | cut -d ":" -f 2 | tr -d '[:space:]')
                if [ "$(ls -1 | grep "^RAxML" | wc -l)" -ne 0 ]
		then
			rm RAxML*
		fi
        	raxml -f a -T 2 -m PROTGAMMA$RAxMLmodel         	-p 12345 -x 12345 -# 100         	-s ../../per_gene/EOG091G17K3/ALICUT_EOG091G17K3.clustalo.fasta -n EOG091G17K3.clustalo.aln.ALICUT.$RAxMLmodel 		1> ../../per_gene/EOG091G17K3/infer_single_ML.stdout.txt 2> ../../per_gene/EOG091G17K3/infer_single_ML.stderr.txt
	else
		echo "fasta file per_gene/EOG091G17K3/ALICUT_EOG091G17K3.clustalo.fasta contains fewer than 5 sequences - skipped" > ../../per_gene/EOG091G17K3/infer_single_ML.stdout.txt
		touch raxml.skipped
	fi
        touch ../../per_gene/EOG091G17K3/EOG091G17K3.raxml.done
        [0m
[Sun Jul  5 22:29:58 2020]
Finished job 2828.
1096 of 3292 steps (33%) done

[Sun Jul  5 22:29:58 2020]
rule get_outgroups:
    input: per_gene/EOG091G0R04/EOG091G0R04.ingroup.fasta
    output: per_gene/EOG091G0R04/EOG091G0R04.orthodb.fasta, per_gene/EOG091G0R04/EOG091G0R04.outgroup.fasta
    log: per_gene/EOG091G0R04/get_outgroups.stdout.txt, per_gene/EOG091G0R04/get_outgroups.stderr.txt
    jobid: 2829
    wildcards: BUSCO=EOG091G0R04


        #download fastas from Orhtodb for BUSCO id
        for i in {1..5}
        do
             wget "http://www.orthodb.org/fasta?query=EOG091G0R04&level=33208" -O per_gene/EOG091G0R04/EOG091G0R04.orthodb.fasta 1> per_gene/EOG091G0R04/get_outgroups.stdout.txt 2> per_gene/EOG091G0R04/get_outgroups.stderr.txt && break || echo -e "try again ($i)" && sleep 15
        done

	#This is quick an dirty for now and just takes the first protein if there is more than one for an outgroup taxon
        bash ../scripts/download_outgroups.sh taxids.txt per_gene/EOG091G0R04/EOG091G0R04.orthodb.fasta > per_gene/EOG091G0R04/EOG091G0R04.outgroup.fasta
        
[Sun Jul  5 22:29:59 2020]
Finished job 2829.
1097 of 3292 steps (33%) done
[Sun Jul  5 22:29:59 2020]
Finished job 2690.
1098 of 3292 steps (33%) done

[Sun Jul  5 22:29:59 2020]
rule get_outgroups:
    input: per_gene/EOG091G0GKH/EOG091G0GKH.ingroup.fasta
    output: per_gene/EOG091G0GKH/EOG091G0GKH.orthodb.fasta, per_gene/EOG091G0GKH/EOG091G0GKH.outgroup.fasta
    log: per_gene/EOG091G0GKH/get_outgroups.stdout.txt, per_gene/EOG091G0GKH/get_outgroups.stderr.txt
    jobid: 2691
    wildcards: BUSCO=EOG091G0GKH


        #download fastas from Orhtodb for BUSCO id
        for i in {1..5}
        do
             wget "http://www.orthodb.org/fasta?query=EOG091G0GKH&level=33208" -O per_gene/EOG091G0GKH/EOG091G0GKH.orthodb.fasta 1> per_gene/EOG091G0GKH/get_outgroups.stdout.txt 2> per_gene/EOG091G0GKH/get_outgroups.stderr.txt && break || echo -e "try again ($i)" && sleep 15
        done

	#This is quick an dirty for now and just takes the first protein if there is more than one for an outgroup taxon
        bash ../scripts/download_outgroups.sh taxids.txt per_gene/EOG091G0GKH/EOG091G0GKH.orthodb.fasta > per_gene/EOG091G0GKH/EOG091G0GKH.outgroup.fasta
        

[Sun Jul  5 22:29:59 2020]
rule get_seqs:
    input: /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ingroup.txt, /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/outgroup.txt
    output: per_gene/EOG091G05AH/EOG091G05AH.ingroup.fasta
    log: per_gene/EOG091G05AH/get_seqs.stdout.txt, per_gene/EOG091G05AH/get_seqs.stderr.txt
    jobid: 2534
    wildcards: BUSCO=EOG091G05AH
    threads: 2


	basedir=$(pwd)
        cd per_gene/EOG091G05AH
        
        bash $basedir/../scripts/fetch_seqs.sh EOG091G05AH /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ingroup.txt /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/outgroup.txt 1> ../../per_gene/EOG091G05AH/get_seqs.stdout.txt 2> ../../per_gene/EOG091G05AH/get_seqs.stderr.txt
	mv EOG091G05AH.fasta $basedir/per_gene/EOG091G05AH/EOG091G05AH.ingroup.fasta
        

[Sun Jul  5 22:29:59 2020]
rule join_groups:
    input: per_gene/EOG091G0R04/EOG091G0R04.ingroup.fasta, per_gene/EOG091G0R04/EOG091G0R04.outgroup.fasta
    output: per_gene/EOG091G0R04/EOG091G0R04.fasta
    jobid: 2238
    wildcards: BUSCO=EOG091G0R04

Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/72476f9d9a5bd0627b4d721143a21354.simg

        cat per_gene/EOG091G0R04/EOG091G0R04.ingroup.fasta per_gene/EOG091G0R04/EOG091G0R04.outgroup.fasta > per_gene/EOG091G0R04/EOG091G0R04.fasta
        
[Sun Jul  5 22:30:00 2020]
Finished job 2238.
1099 of 3292 steps (33%) done
[Sun Jul  5 22:30:01 2020]
Finished job 2691.
1100 of 3292 steps (33%) done

[Sun Jul  5 22:30:01 2020]
rule join_groups:
    input: per_gene/EOG091G0GKH/EOG091G0GKH.ingroup.fasta, per_gene/EOG091G0GKH/EOG091G0GKH.outgroup.fasta
    output: per_gene/EOG091G0GKH/EOG091G0GKH.fasta
    jobid: 2169
    wildcards: BUSCO=EOG091G0GKH


        cat per_gene/EOG091G0GKH/EOG091G0GKH.ingroup.fasta per_gene/EOG091G0GKH/EOG091G0GKH.outgroup.fasta > per_gene/EOG091G0GKH/EOG091G0GKH.fasta
        
[Sun Jul  5 22:30:01 2020]
Finished job 2169.
1101 of 3292 steps (33%) done

[Sun Jul  5 22:30:01 2020]
rule MSA:
    input: per_gene/EOG091G0GKH/EOG091G0GKH.fasta
    output: per_gene/EOG091G0GKH/EOG091G0GKH.clustalo.fasta
    log: per_gene/EOG091G0GKH/MSA.stdout.txt, per_gene/EOG091G0GKH/MSA.stderr.txt
    jobid: 1458
    wildcards: BUSCO=EOG091G0GKH
    threads: 2


        clustalo -i per_gene/EOG091G0GKH/EOG091G0GKH.fasta -o per_gene/EOG091G0GKH/EOG091G0GKH.clustalo.fasta --threads=2 1> per_gene/EOG091G0GKH/MSA.stdout.txt 2> per_gene/EOG091G0GKH/MSA.stderr.txt
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/d68c9691725a7401923680874285c430.simg
[Sun Jul  5 22:30:01 2020]
Finished job 1458.
1102 of 3292 steps (33%) done

[Sun Jul  5 22:30:01 2020]
rule score_and_cut:
    input: per_gene/EOG091G0GKH/EOG091G0GKH.clustalo.fasta
    output: per_gene/EOG091G0GKH/ALICUT_EOG091G0GKH.clustalo.fasta
    jobid: 635
    wildcards: BUSCO=EOG091G0GKH
    threads: 2


        cd per_gene/EOG091G0GKH
        Aliscore.pl -N -r 200000000000000000 -i ../../per_gene/EOG091G0GKH/EOG091G0GKH.clustalo.fasta &> aliscore.log
        ALICUT.pl -s &> alicut.log
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/63c88c27a0fa300f57066b0ef65fefcb.simg
[Sun Jul  5 22:30:12 2020]
Finished job 635.
1103 of 3292 steps (34%) done

[Sun Jul  5 22:30:12 2020]
rule MSA:
    input: per_gene/EOG091G0R04/EOG091G0R04.fasta
    output: per_gene/EOG091G0R04/EOG091G0R04.clustalo.fasta
    log: per_gene/EOG091G0R04/MSA.stdout.txt, per_gene/EOG091G0R04/MSA.stderr.txt
    jobid: 1596
    wildcards: BUSCO=EOG091G0R04
    threads: 2


        clustalo -i per_gene/EOG091G0R04/EOG091G0R04.fasta -o per_gene/EOG091G0R04/EOG091G0R04.clustalo.fasta --threads=2 1> per_gene/EOG091G0R04/MSA.stdout.txt 2> per_gene/EOG091G0R04/MSA.stderr.txt
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/d68c9691725a7401923680874285c430.simg
[Sun Jul  5 22:30:13 2020]
Finished job 1596.
1104 of 3292 steps (34%) done

[Sun Jul  5 22:30:13 2020]
rule score_and_cut:
    input: per_gene/EOG091G0R04/EOG091G0R04.clustalo.fasta
    output: per_gene/EOG091G0R04/ALICUT_EOG091G0R04.clustalo.fasta
    jobid: 773
    wildcards: BUSCO=EOG091G0R04
    threads: 2


        cd per_gene/EOG091G0R04
        Aliscore.pl -N -r 200000000000000000 -i ../../per_gene/EOG091G0R04/EOG091G0R04.clustalo.fasta &> aliscore.log
        ALICUT.pl -s &> alicut.log
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/63c88c27a0fa300f57066b0ef65fefcb.simg
[Sun Jul  5 22:30:17 2020]
Finished job 466.
1105 of 3292 steps (34%) done

[Sun Jul  5 22:30:17 2020]
rule infer_single_ML:
    input: per_gene/EOG091G046Y/EOG091G046Y.best_model, per_gene/EOG091G046Y/ALICUT_EOG091G046Y.clustalo.fasta
    output: per_gene/EOG091G046Y/EOG091G046Y.raxml.done
    log: per_gene/EOG091G046Y/infer_single_ML.stdout.txt, per_gene/EOG091G046Y/infer_single_ML.stderr.txt
    jobid: 27
    wildcards: BUSCO=EOG091G046Y
    threads: 2


        cd per_gene/EOG091G046Y
	count=$(cat ../../per_gene/EOG091G046Y/ALICUT_EOG091G046Y.clustalo.fasta | grep ">" | wc -l)
	if [ "$count" -gt 5 ]
        then
		RAxMLmodel=$(cat ../../per_gene/EOG091G046Y/EOG091G046Y.best_model | grep "Best" | cut -d ":" -f 2 | tr -d '[:space:]')
                if [ "$(ls -1 | grep "^RAxML" | wc -l)" -ne 0 ]
		then
			rm RAxML*
		fi
        	raxml -f a -T 2 -m PROTGAMMA$RAxMLmodel         	-p 12345 -x 12345 -# 100         	-s ../../per_gene/EOG091G046Y/ALICUT_EOG091G046Y.clustalo.fasta -n EOG091G046Y.clustalo.aln.ALICUT.$RAxMLmodel 		1> ../../per_gene/EOG091G046Y/infer_single_ML.stdout.txt 2> ../../per_gene/EOG091G046Y/infer_single_ML.stderr.txt
	else
		echo "fasta file per_gene/EOG091G046Y/ALICUT_EOG091G046Y.clustalo.fasta contains fewer than 5 sequences - skipped" > ../../per_gene/EOG091G046Y/infer_single_ML.stdout.txt
		touch raxml.skipped
	fi
        touch ../../per_gene/EOG091G046Y/EOG091G046Y.raxml.done
        
[Sun Jul  5 22:30:17 2020]
Finished job 2534.
1106 of 3292 steps (34%) done

[Sun Jul  5 22:30:17 2020]
rule get_outgroups:
    input: per_gene/EOG091G05AH/EOG091G05AH.ingroup.fasta
    output: per_gene/EOG091G05AH/EOG091G05AH.orthodb.fasta, per_gene/EOG091G05AH/EOG091G05AH.outgroup.fasta
    log: per_gene/EOG091G05AH/get_outgroups.stdout.txt, per_gene/EOG091G05AH/get_outgroups.stderr.txt
    jobid: 2535
    wildcards: BUSCO=EOG091G05AH


        #download fastas from Orhtodb for BUSCO id
        for i in {1..5}
        do
             wget "http://www.orthodb.org/fasta?query=EOG091G05AH&level=33208" -O per_gene/EOG091G05AH/EOG091G05AH.orthodb.fasta 1> per_gene/EOG091G05AH/get_outgroups.stdout.txt 2> per_gene/EOG091G05AH/get_outgroups.stderr.txt && break || echo -e "try again ($i)" && sleep 15
        done

	#This is quick an dirty for now and just takes the first protein if there is more than one for an outgroup taxon
        bash ../scripts/download_outgroups.sh taxids.txt per_gene/EOG091G05AH/EOG091G05AH.orthodb.fasta > per_gene/EOG091G05AH/EOG091G05AH.outgroup.fasta
        

[Sun Jul  5 22:30:17 2020]
rule remove_empty:
    input: per_gene/EOG091G0GKH/ALICUT_EOG091G0GKH.clustalo.fasta
    output: per_gene/EOG091G0GKH/empty_check.done
    jobid: 1457
    wildcards: BUSCO=EOG091G0GKH


         if [ "$(cat per_gene/EOG091G0GKH/ALICUT_EOG091G0GKH.clustalo.fasta | grep -v ">" | sed 's/-//g' | grep "^$" | wc -l)" -gt 0 ]
         then
              cp per_gene/EOG091G0GKH/ALICUT_EOG091G0GKH.clustalo.fasta per_gene/EOG091G0GKH/ALICUT_EOG091G0GKH.clustalo.fasta.backup
              bash ../scripts/remove_empty.sh per_gene/EOG091G0GKH/ALICUT_EOG091G0GKH.clustalo.fasta.backup > per_gene/EOG091G0GKH/ALICUT_EOG091G0GKH.clustalo.fasta
         fi
         touch per_gene/EOG091G0GKH/empty_check.done
         
[Sun Jul  5 22:30:17 2020]
Finished job 1457.
1107 of 3292 steps (34%) done
[33mJob counts:
	count	jobs
	1	infer_single_ML
	1[0m
[33m
        cd per_gene/EOG091G046Y
	count=$(cat ../../per_gene/EOG091G046Y/ALICUT_EOG091G046Y.clustalo.fasta | grep ">" | wc -l)
	if [ "$count" -gt 5 ]
        then
		RAxMLmodel=$(cat ../../per_gene/EOG091G046Y/EOG091G046Y.best_model | grep "Best" | cut -d ":" -f 2 | tr -d '[:space:]')
                if [ "$(ls -1 | grep "^RAxML" | wc -l)" -ne 0 ]
		then
			rm RAxML*
		fi
        	raxml -f a -T 2 -m PROTGAMMA$RAxMLmodel         	-p 12345 -x 12345 -# 100         	-s ../../per_gene/EOG091G046Y/ALICUT_EOG091G046Y.clustalo.fasta -n EOG091G046Y.clustalo.aln.ALICUT.$RAxMLmodel 		1> ../../per_gene/EOG091G046Y/infer_single_ML.stdout.txt 2> ../../per_gene/EOG091G046Y/infer_single_ML.stderr.txt
	else
		echo "fasta file per_gene/EOG091G046Y/ALICUT_EOG091G046Y.clustalo.fasta contains fewer than 5 sequences - skipped" > ../../per_gene/EOG091G046Y/infer_single_ML.stdout.txt
		touch raxml.skipped
	fi
        touch ../../per_gene/EOG091G046Y/EOG091G046Y.raxml.done
        [0m
[Sun Jul  5 22:30:17 2020]
Finished job 2535.
1108 of 3292 steps (34%) done

[Sun Jul  5 22:30:17 2020]
rule join_groups:
    input: per_gene/EOG091G05AH/EOG091G05AH.ingroup.fasta, per_gene/EOG091G05AH/EOG091G05AH.outgroup.fasta
    output: per_gene/EOG091G05AH/EOG091G05AH.fasta
    jobid: 2091
    wildcards: BUSCO=EOG091G05AH


        cat per_gene/EOG091G05AH/EOG091G05AH.ingroup.fasta per_gene/EOG091G05AH/EOG091G05AH.outgroup.fasta > per_gene/EOG091G05AH/EOG091G05AH.fasta
        
[Sun Jul  5 22:30:18 2020]
Finished job 2091.
1109 of 3292 steps (34%) done

[Sun Jul  5 22:30:18 2020]
rule MSA:
    input: per_gene/EOG091G05AH/EOG091G05AH.fasta
    output: per_gene/EOG091G05AH/EOG091G05AH.clustalo.fasta
    log: per_gene/EOG091G05AH/MSA.stdout.txt, per_gene/EOG091G05AH/MSA.stderr.txt
    jobid: 1302
    wildcards: BUSCO=EOG091G05AH
    threads: 2


        clustalo -i per_gene/EOG091G05AH/EOG091G05AH.fasta -o per_gene/EOG091G05AH/EOG091G05AH.clustalo.fasta --threads=2 1> per_gene/EOG091G05AH/MSA.stdout.txt 2> per_gene/EOG091G05AH/MSA.stderr.txt
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/d68c9691725a7401923680874285c430.simg
[Sun Jul  5 22:30:18 2020]
Finished job 1210.
1110 of 3292 steps (34%) done

[Sun Jul  5 22:30:18 2020]
rule infer_single_ML:
    input: per_gene/EOG091G0554/EOG091G0554.best_model, per_gene/EOG091G0554/ALICUT_EOG091G0554.clustalo.fasta
    output: per_gene/EOG091G0554/EOG091G0554.raxml.done
    log: per_gene/EOG091G0554/infer_single_ML.stdout.txt, per_gene/EOG091G0554/infer_single_ML.stderr.txt
    jobid: 399
    wildcards: BUSCO=EOG091G0554
    threads: 2


        cd per_gene/EOG091G0554
	count=$(cat ../../per_gene/EOG091G0554/ALICUT_EOG091G0554.clustalo.fasta | grep ">" | wc -l)
	if [ "$count" -gt 5 ]
        then
		RAxMLmodel=$(cat ../../per_gene/EOG091G0554/EOG091G0554.best_model | grep "Best" | cut -d ":" -f 2 | tr -d '[:space:]')
                if [ "$(ls -1 | grep "^RAxML" | wc -l)" -ne 0 ]
		then
			rm RAxML*
		fi
        	raxml -f a -T 2 -m PROTGAMMA$RAxMLmodel         	-p 12345 -x 12345 -# 100         	-s ../../per_gene/EOG091G0554/ALICUT_EOG091G0554.clustalo.fasta -n EOG091G0554.clustalo.aln.ALICUT.$RAxMLmodel 		1> ../../per_gene/EOG091G0554/infer_single_ML.stdout.txt 2> ../../per_gene/EOG091G0554/infer_single_ML.stderr.txt
	else
		echo "fasta file per_gene/EOG091G0554/ALICUT_EOG091G0554.clustalo.fasta contains fewer than 5 sequences - skipped" > ../../per_gene/EOG091G0554/infer_single_ML.stdout.txt
		touch raxml.skipped
	fi
        touch ../../per_gene/EOG091G0554/EOG091G0554.raxml.done
        
[33mJob counts:
	count	jobs
	1	infer_single_ML
	1[0m
[33m
        cd per_gene/EOG091G0554
	count=$(cat ../../per_gene/EOG091G0554/ALICUT_EOG091G0554.clustalo.fasta | grep ">" | wc -l)
	if [ "$count" -gt 5 ]
        then
		RAxMLmodel=$(cat ../../per_gene/EOG091G0554/EOG091G0554.best_model | grep "Best" | cut -d ":" -f 2 | tr -d '[:space:]')
                if [ "$(ls -1 | grep "^RAxML" | wc -l)" -ne 0 ]
		then
			rm RAxML*
		fi
        	raxml -f a -T 2 -m PROTGAMMA$RAxMLmodel         	-p 12345 -x 12345 -# 100         	-s ../../per_gene/EOG091G0554/ALICUT_EOG091G0554.clustalo.fasta -n EOG091G0554.clustalo.aln.ALICUT.$RAxMLmodel 		1> ../../per_gene/EOG091G0554/infer_single_ML.stdout.txt 2> ../../per_gene/EOG091G0554/infer_single_ML.stderr.txt
	else
		echo "fasta file per_gene/EOG091G0554/ALICUT_EOG091G0554.clustalo.fasta contains fewer than 5 sequences - skipped" > ../../per_gene/EOG091G0554/infer_single_ML.stdout.txt
		touch raxml.skipped
	fi
        touch ../../per_gene/EOG091G0554/EOG091G0554.raxml.done
        [0m
[Sun Jul  5 22:30:20 2020]
Finished job 1302.
1111 of 3292 steps (34%) done

[Sun Jul  5 22:30:20 2020]
rule score_and_cut:
    input: per_gene/EOG091G05AH/EOG091G05AH.clustalo.fasta
    output: per_gene/EOG091G05AH/ALICUT_EOG091G05AH.clustalo.fasta
    jobid: 479
    wildcards: BUSCO=EOG091G05AH
    threads: 2


        cd per_gene/EOG091G05AH
        Aliscore.pl -N -r 200000000000000000 -i ../../per_gene/EOG091G05AH/EOG091G05AH.clustalo.fasta &> aliscore.log
        ALICUT.pl -s &> alicut.log
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/63c88c27a0fa300f57066b0ef65fefcb.simg
[Sun Jul  5 22:30:21 2020]
Finished job 522.
1112 of 3292 steps (34%) done

[Sun Jul  5 22:30:21 2020]
rule infer_single_ML:
    input: per_gene/EOG091G07NJ/EOG091G07NJ.best_model, per_gene/EOG091G07NJ/ALICUT_EOG091G07NJ.clustalo.fasta
    output: per_gene/EOG091G07NJ/EOG091G07NJ.raxml.done
    log: per_gene/EOG091G07NJ/infer_single_ML.stdout.txt, per_gene/EOG091G07NJ/infer_single_ML.stderr.txt
    jobid: 55
    wildcards: BUSCO=EOG091G07NJ
    threads: 2


        cd per_gene/EOG091G07NJ
	count=$(cat ../../per_gene/EOG091G07NJ/ALICUT_EOG091G07NJ.clustalo.fasta | grep ">" | wc -l)
	if [ "$count" -gt 5 ]
        then
		RAxMLmodel=$(cat ../../per_gene/EOG091G07NJ/EOG091G07NJ.best_model | grep "Best" | cut -d ":" -f 2 | tr -d '[:space:]')
                if [ "$(ls -1 | grep "^RAxML" | wc -l)" -ne 0 ]
		then
			rm RAxML*
		fi
        	raxml -f a -T 2 -m PROTGAMMA$RAxMLmodel         	-p 12345 -x 12345 -# 100         	-s ../../per_gene/EOG091G07NJ/ALICUT_EOG091G07NJ.clustalo.fasta -n EOG091G07NJ.clustalo.aln.ALICUT.$RAxMLmodel 		1> ../../per_gene/EOG091G07NJ/infer_single_ML.stdout.txt 2> ../../per_gene/EOG091G07NJ/infer_single_ML.stderr.txt
	else
		echo "fasta file per_gene/EOG091G07NJ/ALICUT_EOG091G07NJ.clustalo.fasta contains fewer than 5 sequences - skipped" > ../../per_gene/EOG091G07NJ/infer_single_ML.stdout.txt
		touch raxml.skipped
	fi
        touch ../../per_gene/EOG091G07NJ/EOG091G07NJ.raxml.done
        
[33mJob counts:
	count	jobs
	1	infer_single_ML
	1[0m
[33m
        cd per_gene/EOG091G07NJ
	count=$(cat ../../per_gene/EOG091G07NJ/ALICUT_EOG091G07NJ.clustalo.fasta | grep ">" | wc -l)
	if [ "$count" -gt 5 ]
        then
		RAxMLmodel=$(cat ../../per_gene/EOG091G07NJ/EOG091G07NJ.best_model | grep "Best" | cut -d ":" -f 2 | tr -d '[:space:]')
                if [ "$(ls -1 | grep "^RAxML" | wc -l)" -ne 0 ]
		then
			rm RAxML*
		fi
        	raxml -f a -T 2 -m PROTGAMMA$RAxMLmodel         	-p 12345 -x 12345 -# 100         	-s ../../per_gene/EOG091G07NJ/ALICUT_EOG091G07NJ.clustalo.fasta -n EOG091G07NJ.clustalo.aln.ALICUT.$RAxMLmodel 		1> ../../per_gene/EOG091G07NJ/infer_single_ML.stdout.txt 2> ../../per_gene/EOG091G07NJ/infer_single_ML.stderr.txt
	else
		echo "fasta file per_gene/EOG091G07NJ/ALICUT_EOG091G07NJ.clustalo.fasta contains fewer than 5 sequences - skipped" > ../../per_gene/EOG091G07NJ/infer_single_ML.stdout.txt
		touch raxml.skipped
	fi
        touch ../../per_gene/EOG091G07NJ/EOG091G07NJ.raxml.done
        [0m
[Sun Jul  5 22:30:23 2020]
Finished job 773.
1113 of 3292 steps (34%) done

[Sun Jul  5 22:30:23 2020]
rule remove_empty:
    input: per_gene/EOG091G0R04/ALICUT_EOG091G0R04.clustalo.fasta
    output: per_gene/EOG091G0R04/empty_check.done
    jobid: 1595
    wildcards: BUSCO=EOG091G0R04


         if [ "$(cat per_gene/EOG091G0R04/ALICUT_EOG091G0R04.clustalo.fasta | grep -v ">" | sed 's/-//g' | grep "^$" | wc -l)" -gt 0 ]
         then
              cp per_gene/EOG091G0R04/ALICUT_EOG091G0R04.clustalo.fasta per_gene/EOG091G0R04/ALICUT_EOG091G0R04.clustalo.fasta.backup
              bash ../scripts/remove_empty.sh per_gene/EOG091G0R04/ALICUT_EOG091G0R04.clustalo.fasta.backup > per_gene/EOG091G0R04/ALICUT_EOG091G0R04.clustalo.fasta
         fi
         touch per_gene/EOG091G0R04/empty_check.done
         
[Sun Jul  5 22:30:23 2020]
Finished job 1595.
1114 of 3292 steps (34%) done

[Sun Jul  5 22:30:23 2020]
rule find_best_model:
    input: per_gene/EOG091G0R04/ALICUT_EOG091G0R04.clustalo.fasta, per_gene/EOG091G0R04/empty_check.done
    output: per_gene/EOG091G0R04/EOG091G0R04.best_model
    log: per_gene/EOG091G0R04/find_best_model.stderr.txt
    jobid: 772
    wildcards: BUSCO=EOG091G0R04
    threads: 2


        cd per_gene/EOG091G0R04
        if [ ! -d find_best_model ]
        then
            mkdir find_best_model
        fi
        cd find_best_model
        ln -s ../../../per_gene/EOG091G0R04/ALICUT_EOG091G0R04.clustalo.fasta EOG091G0R04.fasta
        ProteinModelSelection.pl EOG091G0R04.fasta 1> ../../../per_gene/EOG091G0R04/EOG091G0R04.best_model 2> ../../../per_gene/EOG091G0R04/find_best_model.stderr.txt
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/c0c09ee657b1e27f2c5687e0e9aa8d70.simg
[Sun Jul  5 22:30:25 2020]
Finished job 107.
1115 of 3292 steps (34%) done

[Sun Jul  5 22:30:25 2020]
rule find_best_model:
    input: per_gene/EOG091G0GKH/ALICUT_EOG091G0GKH.clustalo.fasta, per_gene/EOG091G0GKH/empty_check.done
    output: per_gene/EOG091G0GKH/EOG091G0GKH.best_model
    log: per_gene/EOG091G0GKH/find_best_model.stderr.txt
    jobid: 634
    wildcards: BUSCO=EOG091G0GKH
    threads: 2


        cd per_gene/EOG091G0GKH
        if [ ! -d find_best_model ]
        then
            mkdir find_best_model
        fi
        cd find_best_model
        ln -s ../../../per_gene/EOG091G0GKH/ALICUT_EOG091G0GKH.clustalo.fasta EOG091G0GKH.fasta
        ProteinModelSelection.pl EOG091G0GKH.fasta 1> ../../../per_gene/EOG091G0GKH/EOG091G0GKH.best_model 2> ../../../per_gene/EOG091G0GKH/find_best_model.stderr.txt
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/c0c09ee657b1e27f2c5687e0e9aa8d70.simg
[Sun Jul  5 22:30:30 2020]
Finished job 479.
1116 of 3292 steps (34%) done

[Sun Jul  5 22:30:30 2020]
rule remove_empty:
    input: per_gene/EOG091G05AH/ALICUT_EOG091G05AH.clustalo.fasta
    output: per_gene/EOG091G05AH/empty_check.done
    jobid: 1301
    wildcards: BUSCO=EOG091G05AH


         if [ "$(cat per_gene/EOG091G05AH/ALICUT_EOG091G05AH.clustalo.fasta | grep -v ">" | sed 's/-//g' | grep "^$" | wc -l)" -gt 0 ]
         then
              cp per_gene/EOG091G05AH/ALICUT_EOG091G05AH.clustalo.fasta per_gene/EOG091G05AH/ALICUT_EOG091G05AH.clustalo.fasta.backup
              bash ../scripts/remove_empty.sh per_gene/EOG091G05AH/ALICUT_EOG091G05AH.clustalo.fasta.backup > per_gene/EOG091G05AH/ALICUT_EOG091G05AH.clustalo.fasta
         fi
         touch per_gene/EOG091G05AH/empty_check.done
         
[Sun Jul  5 22:30:30 2020]
Finished job 1301.
1117 of 3292 steps (34%) done

[Sun Jul  5 22:30:30 2020]
rule find_best_model:
    input: per_gene/EOG091G05AH/ALICUT_EOG091G05AH.clustalo.fasta, per_gene/EOG091G05AH/empty_check.done
    output: per_gene/EOG091G05AH/EOG091G05AH.best_model
    log: per_gene/EOG091G05AH/find_best_model.stderr.txt
    jobid: 478
    wildcards: BUSCO=EOG091G05AH
    threads: 2


        cd per_gene/EOG091G05AH
        if [ ! -d find_best_model ]
        then
            mkdir find_best_model
        fi
        cd find_best_model
        ln -s ../../../per_gene/EOG091G05AH/ALICUT_EOG091G05AH.clustalo.fasta EOG091G05AH.fasta
        ProteinModelSelection.pl EOG091G05AH.fasta 1> ../../../per_gene/EOG091G05AH/EOG091G05AH.best_model 2> ../../../per_gene/EOG091G05AH/find_best_model.stderr.txt
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/c0c09ee657b1e27f2c5687e0e9aa8d70.simg
[Sun Jul  5 22:30:44 2020]
Finished job 377.
1118 of 3292 steps (34%) done

[Sun Jul  5 22:30:44 2020]
rule get_seqs:
    input: /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ingroup.txt, /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/outgroup.txt
    output: per_gene/EOG091G0IYB/EOG091G0IYB.ingroup.fasta
    log: per_gene/EOG091G0IYB/get_seqs.stdout.txt, per_gene/EOG091G0IYB/get_seqs.stderr.txt
    jobid: 3214
    wildcards: BUSCO=EOG091G0IYB
    threads: 2


	basedir=$(pwd)
        cd per_gene/EOG091G0IYB
        
        bash $basedir/../scripts/fetch_seqs.sh EOG091G0IYB /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ingroup.txt /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/outgroup.txt 1> ../../per_gene/EOG091G0IYB/get_seqs.stdout.txt 2> ../../per_gene/EOG091G0IYB/get_seqs.stderr.txt
	mv EOG091G0IYB.fasta $basedir/per_gene/EOG091G0IYB/EOG091G0IYB.ingroup.fasta
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/72476f9d9a5bd0627b4d721143a21354.simg
[Sun Jul  5 22:30:58 2020]
Finished job 772.
1119 of 3292 steps (34%) done

[Sun Jul  5 22:30:58 2020]
rule infer_single_ML:
    input: per_gene/EOG091G0R04/EOG091G0R04.best_model, per_gene/EOG091G0R04/ALICUT_EOG091G0R04.clustalo.fasta
    output: per_gene/EOG091G0R04/EOG091G0R04.raxml.done
    log: per_gene/EOG091G0R04/infer_single_ML.stdout.txt, per_gene/EOG091G0R04/infer_single_ML.stderr.txt
    jobid: 180
    wildcards: BUSCO=EOG091G0R04
    threads: 2


        cd per_gene/EOG091G0R04
	count=$(cat ../../per_gene/EOG091G0R04/ALICUT_EOG091G0R04.clustalo.fasta | grep ">" | wc -l)
	if [ "$count" -gt 5 ]
        then
		RAxMLmodel=$(cat ../../per_gene/EOG091G0R04/EOG091G0R04.best_model | grep "Best" | cut -d ":" -f 2 | tr -d '[:space:]')
                if [ "$(ls -1 | grep "^RAxML" | wc -l)" -ne 0 ]
		then
			rm RAxML*
		fi
        	raxml -f a -T 2 -m PROTGAMMA$RAxMLmodel         	-p 12345 -x 12345 -# 100         	-s ../../per_gene/EOG091G0R04/ALICUT_EOG091G0R04.clustalo.fasta -n EOG091G0R04.clustalo.aln.ALICUT.$RAxMLmodel 		1> ../../per_gene/EOG091G0R04/infer_single_ML.stdout.txt 2> ../../per_gene/EOG091G0R04/infer_single_ML.stderr.txt
	else
		echo "fasta file per_gene/EOG091G0R04/ALICUT_EOG091G0R04.clustalo.fasta contains fewer than 5 sequences - skipped" > ../../per_gene/EOG091G0R04/infer_single_ML.stdout.txt
		touch raxml.skipped
	fi
        touch ../../per_gene/EOG091G0R04/EOG091G0R04.raxml.done
        
[33mJob counts:
	count	jobs
	1	infer_single_ML
	1[0m
[33m
        cd per_gene/EOG091G0R04
	count=$(cat ../../per_gene/EOG091G0R04/ALICUT_EOG091G0R04.clustalo.fasta | grep ">" | wc -l)
	if [ "$count" -gt 5 ]
        then
		RAxMLmodel=$(cat ../../per_gene/EOG091G0R04/EOG091G0R04.best_model | grep "Best" | cut -d ":" -f 2 | tr -d '[:space:]')
                if [ "$(ls -1 | grep "^RAxML" | wc -l)" -ne 0 ]
		then
			rm RAxML*
		fi
        	raxml -f a -T 2 -m PROTGAMMA$RAxMLmodel         	-p 12345 -x 12345 -# 100         	-s ../../per_gene/EOG091G0R04/ALICUT_EOG091G0R04.clustalo.fasta -n EOG091G0R04.clustalo.aln.ALICUT.$RAxMLmodel 		1> ../../per_gene/EOG091G0R04/infer_single_ML.stdout.txt 2> ../../per_gene/EOG091G0R04/infer_single_ML.stderr.txt
	else
		echo "fasta file per_gene/EOG091G0R04/ALICUT_EOG091G0R04.clustalo.fasta contains fewer than 5 sequences - skipped" > ../../per_gene/EOG091G0R04/infer_single_ML.stdout.txt
		touch raxml.skipped
	fi
        touch ../../per_gene/EOG091G0R04/EOG091G0R04.raxml.done
        [0m
[Sun Jul  5 22:31:02 2020]
Finished job 634.
1120 of 3292 steps (34%) done

[Sun Jul  5 22:31:02 2020]
rule infer_single_ML:
    input: per_gene/EOG091G0GKH/EOG091G0GKH.best_model, per_gene/EOG091G0GKH/ALICUT_EOG091G0GKH.clustalo.fasta
    output: per_gene/EOG091G0GKH/EOG091G0GKH.raxml.done
    log: per_gene/EOG091G0GKH/infer_single_ML.stdout.txt, per_gene/EOG091G0GKH/infer_single_ML.stderr.txt
    jobid: 111
    wildcards: BUSCO=EOG091G0GKH
    threads: 2


        cd per_gene/EOG091G0GKH
	count=$(cat ../../per_gene/EOG091G0GKH/ALICUT_EOG091G0GKH.clustalo.fasta | grep ">" | wc -l)
	if [ "$count" -gt 5 ]
        then
		RAxMLmodel=$(cat ../../per_gene/EOG091G0GKH/EOG091G0GKH.best_model | grep "Best" | cut -d ":" -f 2 | tr -d '[:space:]')
                if [ "$(ls -1 | grep "^RAxML" | wc -l)" -ne 0 ]
		then
			rm RAxML*
		fi
        	raxml -f a -T 2 -m PROTGAMMA$RAxMLmodel         	-p 12345 -x 12345 -# 100         	-s ../../per_gene/EOG091G0GKH/ALICUT_EOG091G0GKH.clustalo.fasta -n EOG091G0GKH.clustalo.aln.ALICUT.$RAxMLmodel 		1> ../../per_gene/EOG091G0GKH/infer_single_ML.stdout.txt 2> ../../per_gene/EOG091G0GKH/infer_single_ML.stderr.txt
	else
		echo "fasta file per_gene/EOG091G0GKH/ALICUT_EOG091G0GKH.clustalo.fasta contains fewer than 5 sequences - skipped" > ../../per_gene/EOG091G0GKH/infer_single_ML.stdout.txt
		touch raxml.skipped
	fi
        touch ../../per_gene/EOG091G0GKH/EOG091G0GKH.raxml.done
        
[33mJob counts:
	count	jobs
	1	infer_single_ML
	1[0m
[33m
        cd per_gene/EOG091G0GKH
	count=$(cat ../../per_gene/EOG091G0GKH/ALICUT_EOG091G0GKH.clustalo.fasta | grep ">" | wc -l)
	if [ "$count" -gt 5 ]
        then
		RAxMLmodel=$(cat ../../per_gene/EOG091G0GKH/EOG091G0GKH.best_model | grep "Best" | cut -d ":" -f 2 | tr -d '[:space:]')
                if [ "$(ls -1 | grep "^RAxML" | wc -l)" -ne 0 ]
		then
			rm RAxML*
		fi
        	raxml -f a -T 2 -m PROTGAMMA$RAxMLmodel         	-p 12345 -x 12345 -# 100         	-s ../../per_gene/EOG091G0GKH/ALICUT_EOG091G0GKH.clustalo.fasta -n EOG091G0GKH.clustalo.aln.ALICUT.$RAxMLmodel 		1> ../../per_gene/EOG091G0GKH/infer_single_ML.stdout.txt 2> ../../per_gene/EOG091G0GKH/infer_single_ML.stderr.txt
	else
		echo "fasta file per_gene/EOG091G0GKH/ALICUT_EOG091G0GKH.clustalo.fasta contains fewer than 5 sequences - skipped" > ../../per_gene/EOG091G0GKH/infer_single_ML.stdout.txt
		touch raxml.skipped
	fi
        touch ../../per_gene/EOG091G0GKH/EOG091G0GKH.raxml.done
        [0m
[Sun Jul  5 22:31:03 2020]
Finished job 3214.
1121 of 3292 steps (34%) done

[Sun Jul  5 22:31:03 2020]
rule get_outgroups:
    input: per_gene/EOG091G0IYB/EOG091G0IYB.ingroup.fasta
    output: per_gene/EOG091G0IYB/EOG091G0IYB.orthodb.fasta, per_gene/EOG091G0IYB/EOG091G0IYB.outgroup.fasta
    log: per_gene/EOG091G0IYB/get_outgroups.stdout.txt, per_gene/EOG091G0IYB/get_outgroups.stderr.txt
    jobid: 3215
    wildcards: BUSCO=EOG091G0IYB


        #download fastas from Orhtodb for BUSCO id
        for i in {1..5}
        do
             wget "http://www.orthodb.org/fasta?query=EOG091G0IYB&level=33208" -O per_gene/EOG091G0IYB/EOG091G0IYB.orthodb.fasta 1> per_gene/EOG091G0IYB/get_outgroups.stdout.txt 2> per_gene/EOG091G0IYB/get_outgroups.stderr.txt && break || echo -e "try again ($i)" && sleep 15
        done

	#This is quick an dirty for now and just takes the first protein if there is more than one for an outgroup taxon
        bash ../scripts/download_outgroups.sh taxids.txt per_gene/EOG091G0IYB/EOG091G0IYB.orthodb.fasta > per_gene/EOG091G0IYB/EOG091G0IYB.outgroup.fasta
        
[Sun Jul  5 22:31:04 2020]
Finished job 3215.
1122 of 3292 steps (34%) done

[Sun Jul  5 22:31:04 2020]
rule join_groups:
    input: per_gene/EOG091G0IYB/EOG091G0IYB.ingroup.fasta, per_gene/EOG091G0IYB/EOG091G0IYB.outgroup.fasta
    output: per_gene/EOG091G0IYB/EOG091G0IYB.fasta
    jobid: 2431
    wildcards: BUSCO=EOG091G0IYB


        cat per_gene/EOG091G0IYB/EOG091G0IYB.ingroup.fasta per_gene/EOG091G0IYB/EOG091G0IYB.outgroup.fasta > per_gene/EOG091G0IYB/EOG091G0IYB.fasta
        
[Sun Jul  5 22:31:04 2020]
Finished job 2431.
1123 of 3292 steps (34%) done

[Sun Jul  5 22:31:04 2020]
rule MSA:
    input: per_gene/EOG091G0IYB/EOG091G0IYB.fasta
    output: per_gene/EOG091G0IYB/EOG091G0IYB.clustalo.fasta
    log: per_gene/EOG091G0IYB/MSA.stdout.txt, per_gene/EOG091G0IYB/MSA.stderr.txt
    jobid: 1982
    wildcards: BUSCO=EOG091G0IYB
    threads: 2


        clustalo -i per_gene/EOG091G0IYB/EOG091G0IYB.fasta -o per_gene/EOG091G0IYB/EOG091G0IYB.clustalo.fasta --threads=2 1> per_gene/EOG091G0IYB/MSA.stdout.txt 2> per_gene/EOG091G0IYB/MSA.stderr.txt
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/d68c9691725a7401923680874285c430.simg
[Sun Jul  5 22:31:08 2020]
Finished job 1982.
1124 of 3292 steps (34%) done

[Sun Jul  5 22:31:08 2020]
rule score_and_cut:
    input: per_gene/EOG091G0IYB/EOG091G0IYB.clustalo.fasta
    output: per_gene/EOG091G0IYB/ALICUT_EOG091G0IYB.clustalo.fasta
    jobid: 1159
    wildcards: BUSCO=EOG091G0IYB
    threads: 2


        cd per_gene/EOG091G0IYB
        Aliscore.pl -N -r 200000000000000000 -i ../../per_gene/EOG091G0IYB/EOG091G0IYB.clustalo.fasta &> aliscore.log
        ALICUT.pl -s &> alicut.log
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/63c88c27a0fa300f57066b0ef65fefcb.simg
[Sun Jul  5 22:31:18 2020]
Finished job 478.
1125 of 3292 steps (34%) done

[Sun Jul  5 22:31:18 2020]
rule infer_single_ML:
    input: per_gene/EOG091G05AH/EOG091G05AH.best_model, per_gene/EOG091G05AH/ALICUT_EOG091G05AH.clustalo.fasta
    output: per_gene/EOG091G05AH/EOG091G05AH.raxml.done
    log: per_gene/EOG091G05AH/infer_single_ML.stdout.txt, per_gene/EOG091G05AH/infer_single_ML.stderr.txt
    jobid: 33
    wildcards: BUSCO=EOG091G05AH
    threads: 2


        cd per_gene/EOG091G05AH
	count=$(cat ../../per_gene/EOG091G05AH/ALICUT_EOG091G05AH.clustalo.fasta | grep ">" | wc -l)
	if [ "$count" -gt 5 ]
        then
		RAxMLmodel=$(cat ../../per_gene/EOG091G05AH/EOG091G05AH.best_model | grep "Best" | cut -d ":" -f 2 | tr -d '[:space:]')
                if [ "$(ls -1 | grep "^RAxML" | wc -l)" -ne 0 ]
		then
			rm RAxML*
		fi
        	raxml -f a -T 2 -m PROTGAMMA$RAxMLmodel         	-p 12345 -x 12345 -# 100         	-s ../../per_gene/EOG091G05AH/ALICUT_EOG091G05AH.clustalo.fasta -n EOG091G05AH.clustalo.aln.ALICUT.$RAxMLmodel 		1> ../../per_gene/EOG091G05AH/infer_single_ML.stdout.txt 2> ../../per_gene/EOG091G05AH/infer_single_ML.stderr.txt
	else
		echo "fasta file per_gene/EOG091G05AH/ALICUT_EOG091G05AH.clustalo.fasta contains fewer than 5 sequences - skipped" > ../../per_gene/EOG091G05AH/infer_single_ML.stdout.txt
		touch raxml.skipped
	fi
        touch ../../per_gene/EOG091G05AH/EOG091G05AH.raxml.done
        
[Sun Jul  5 22:31:19 2020]
Finished job 1159.
1126 of 3292 steps (34%) done

[Sun Jul  5 22:31:19 2020]
rule remove_empty:
    input: per_gene/EOG091G0IYB/ALICUT_EOG091G0IYB.clustalo.fasta
    output: per_gene/EOG091G0IYB/empty_check.done
    jobid: 1981
    wildcards: BUSCO=EOG091G0IYB


         if [ "$(cat per_gene/EOG091G0IYB/ALICUT_EOG091G0IYB.clustalo.fasta | grep -v ">" | sed 's/-//g' | grep "^$" | wc -l)" -gt 0 ]
         then
              cp per_gene/EOG091G0IYB/ALICUT_EOG091G0IYB.clustalo.fasta per_gene/EOG091G0IYB/ALICUT_EOG091G0IYB.clustalo.fasta.backup
              bash ../scripts/remove_empty.sh per_gene/EOG091G0IYB/ALICUT_EOG091G0IYB.clustalo.fasta.backup > per_gene/EOG091G0IYB/ALICUT_EOG091G0IYB.clustalo.fasta
         fi
         touch per_gene/EOG091G0IYB/empty_check.done
         
[Sun Jul  5 22:31:36 2020]
Finished job 1981.
1127 of 3292 steps (34%) done

[Sun Jul  5 22:31:36 2020]
rule find_best_model:
    input: per_gene/EOG091G0IYB/ALICUT_EOG091G0IYB.clustalo.fasta, per_gene/EOG091G0IYB/empty_check.done
    output: per_gene/EOG091G0IYB/EOG091G0IYB.best_model
    log: per_gene/EOG091G0IYB/find_best_model.stderr.txt
    jobid: 1158
    wildcards: BUSCO=EOG091G0IYB
    threads: 2


        cd per_gene/EOG091G0IYB
        if [ ! -d find_best_model ]
        then
            mkdir find_best_model
        fi
        cd find_best_model
        ln -s ../../../per_gene/EOG091G0IYB/ALICUT_EOG091G0IYB.clustalo.fasta EOG091G0IYB.fasta
        ProteinModelSelection.pl EOG091G0IYB.fasta 1> ../../../per_gene/EOG091G0IYB/EOG091G0IYB.best_model 2> ../../../per_gene/EOG091G0IYB/find_best_model.stderr.txt
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/c0c09ee657b1e27f2c5687e0e9aa8d70.simg
[33mJob counts:
	count	jobs
	1	infer_single_ML
	1[0m
[33m
        cd per_gene/EOG091G05AH
	count=$(cat ../../per_gene/EOG091G05AH/ALICUT_EOG091G05AH.clustalo.fasta | grep ">" | wc -l)
	if [ "$count" -gt 5 ]
        then
		RAxMLmodel=$(cat ../../per_gene/EOG091G05AH/EOG091G05AH.best_model | grep "Best" | cut -d ":" -f 2 | tr -d '[:space:]')
                if [ "$(ls -1 | grep "^RAxML" | wc -l)" -ne 0 ]
		then
			rm RAxML*
		fi
        	raxml -f a -T 2 -m PROTGAMMA$RAxMLmodel         	-p 12345 -x 12345 -# 100         	-s ../../per_gene/EOG091G05AH/ALICUT_EOG091G05AH.clustalo.fasta -n EOG091G05AH.clustalo.aln.ALICUT.$RAxMLmodel 		1> ../../per_gene/EOG091G05AH/infer_single_ML.stdout.txt 2> ../../per_gene/EOG091G05AH/infer_single_ML.stderr.txt
	else
		echo "fasta file per_gene/EOG091G05AH/ALICUT_EOG091G05AH.clustalo.fasta contains fewer than 5 sequences - skipped" > ../../per_gene/EOG091G05AH/infer_single_ML.stdout.txt
		touch raxml.skipped
	fi
        touch ../../per_gene/EOG091G05AH/EOG091G05AH.raxml.done
        [0m
[Sun Jul  5 22:31:54 2020]
Finished job 348.
1128 of 3292 steps (34%) done

[Sun Jul  5 22:31:54 2020]
rule get_seqs:
    input: /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ingroup.txt, /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/outgroup.txt
    output: per_gene/EOG091G0VGJ/EOG091G0VGJ.ingroup.fasta
    log: per_gene/EOG091G0VGJ/get_seqs.stdout.txt, per_gene/EOG091G0VGJ/get_seqs.stderr.txt
    jobid: 2872
    wildcards: BUSCO=EOG091G0VGJ
    threads: 2


	basedir=$(pwd)
        cd per_gene/EOG091G0VGJ
        
        bash $basedir/../scripts/fetch_seqs.sh EOG091G0VGJ /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ingroup.txt /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/outgroup.txt 1> ../../per_gene/EOG091G0VGJ/get_seqs.stdout.txt 2> ../../per_gene/EOG091G0VGJ/get_seqs.stderr.txt
	mv EOG091G0VGJ.fasta $basedir/per_gene/EOG091G0VGJ/EOG091G0VGJ.ingroup.fasta
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/72476f9d9a5bd0627b4d721143a21354.simg
[Sun Jul  5 22:32:03 2020]
Finished job 50.
1129 of 3292 steps (34%) done

[Sun Jul  5 22:32:03 2020]
rule get_seqs:
    input: /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ingroup.txt, /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/outgroup.txt
    output: per_gene/EOG091G0C84/EOG091G0C84.ingroup.fasta
    log: per_gene/EOG091G0C84/get_seqs.stdout.txt, per_gene/EOG091G0C84/get_seqs.stderr.txt
    jobid: 2640
    wildcards: BUSCO=EOG091G0C84
    threads: 2


	basedir=$(pwd)
        cd per_gene/EOG091G0C84
        
        bash $basedir/../scripts/fetch_seqs.sh EOG091G0C84 /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ingroup.txt /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/outgroup.txt 1> ../../per_gene/EOG091G0C84/get_seqs.stdout.txt 2> ../../per_gene/EOG091G0C84/get_seqs.stderr.txt
	mv EOG091G0C84.fasta $basedir/per_gene/EOG091G0C84/EOG091G0C84.ingroup.fasta
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/72476f9d9a5bd0627b4d721143a21354.simg
[Sun Jul  5 22:32:06 2020]
Finished job 167.
1130 of 3292 steps (34%) done

[Sun Jul  5 22:32:06 2020]
rule get_seqs:
    input: /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ingroup.txt, /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/outgroup.txt
    output: per_gene/EOG091G05T4/EOG091G05T4.ingroup.fasta
    log: per_gene/EOG091G05T4/get_seqs.stdout.txt, per_gene/EOG091G05T4/get_seqs.stderr.txt
    jobid: 2954
    wildcards: BUSCO=EOG091G05T4
    threads: 2


	basedir=$(pwd)
        cd per_gene/EOG091G05T4
        
        bash $basedir/../scripts/fetch_seqs.sh EOG091G05T4 /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ingroup.txt /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/outgroup.txt 1> ../../per_gene/EOG091G05T4/get_seqs.stdout.txt 2> ../../per_gene/EOG091G05T4/get_seqs.stderr.txt
	mv EOG091G05T4.fasta $basedir/per_gene/EOG091G05T4/EOG091G05T4.ingroup.fasta
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/72476f9d9a5bd0627b4d721143a21354.simg
[Sun Jul  5 22:32:08 2020]
Finished job 2872.
1131 of 3292 steps (34%) done

[Sun Jul  5 22:32:08 2020]
rule get_outgroups:
    input: per_gene/EOG091G0VGJ/EOG091G0VGJ.ingroup.fasta
    output: per_gene/EOG091G0VGJ/EOG091G0VGJ.orthodb.fasta, per_gene/EOG091G0VGJ/EOG091G0VGJ.outgroup.fasta
    log: per_gene/EOG091G0VGJ/get_outgroups.stdout.txt, per_gene/EOG091G0VGJ/get_outgroups.stderr.txt
    jobid: 2873
    wildcards: BUSCO=EOG091G0VGJ


        #download fastas from Orhtodb for BUSCO id
        for i in {1..5}
        do
             wget "http://www.orthodb.org/fasta?query=EOG091G0VGJ&level=33208" -O per_gene/EOG091G0VGJ/EOG091G0VGJ.orthodb.fasta 1> per_gene/EOG091G0VGJ/get_outgroups.stdout.txt 2> per_gene/EOG091G0VGJ/get_outgroups.stderr.txt && break || echo -e "try again ($i)" && sleep 15
        done

	#This is quick an dirty for now and just takes the first protein if there is more than one for an outgroup taxon
        bash ../scripts/download_outgroups.sh taxids.txt per_gene/EOG091G0VGJ/EOG091G0VGJ.orthodb.fasta > per_gene/EOG091G0VGJ/EOG091G0VGJ.outgroup.fasta
        
[Sun Jul  5 22:32:09 2020]
Finished job 2873.
1132 of 3292 steps (34%) done

[Sun Jul  5 22:32:09 2020]
rule join_groups:
    input: per_gene/EOG091G0VGJ/EOG091G0VGJ.ingroup.fasta, per_gene/EOG091G0VGJ/EOG091G0VGJ.outgroup.fasta
    output: per_gene/EOG091G0VGJ/EOG091G0VGJ.fasta
    jobid: 2260
    wildcards: BUSCO=EOG091G0VGJ


        cat per_gene/EOG091G0VGJ/EOG091G0VGJ.ingroup.fasta per_gene/EOG091G0VGJ/EOG091G0VGJ.outgroup.fasta > per_gene/EOG091G0VGJ/EOG091G0VGJ.fasta
        
[Sun Jul  5 22:32:09 2020]
Finished job 2260.
1133 of 3292 steps (34%) done

[Sun Jul  5 22:32:09 2020]
rule MSA:
    input: per_gene/EOG091G0VGJ/EOG091G0VGJ.fasta
    output: per_gene/EOG091G0VGJ/EOG091G0VGJ.clustalo.fasta
    log: per_gene/EOG091G0VGJ/MSA.stdout.txt, per_gene/EOG091G0VGJ/MSA.stderr.txt
    jobid: 1640
    wildcards: BUSCO=EOG091G0VGJ
    threads: 2


        clustalo -i per_gene/EOG091G0VGJ/EOG091G0VGJ.fasta -o per_gene/EOG091G0VGJ/EOG091G0VGJ.clustalo.fasta --threads=2 1> per_gene/EOG091G0VGJ/MSA.stdout.txt 2> per_gene/EOG091G0VGJ/MSA.stderr.txt
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/d68c9691725a7401923680874285c430.simg
[Sun Jul  5 22:32:10 2020]
Finished job 1640.
1134 of 3292 steps (34%) done

[Sun Jul  5 22:32:10 2020]
rule score_and_cut:
    input: per_gene/EOG091G0VGJ/EOG091G0VGJ.clustalo.fasta
    output: per_gene/EOG091G0VGJ/ALICUT_EOG091G0VGJ.clustalo.fasta
    jobid: 817
    wildcards: BUSCO=EOG091G0VGJ
    threads: 2


        cd per_gene/EOG091G0VGJ
        Aliscore.pl -N -r 200000000000000000 -i ../../per_gene/EOG091G0VGJ/EOG091G0VGJ.clustalo.fasta &> aliscore.log
        ALICUT.pl -s &> alicut.log
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/63c88c27a0fa300f57066b0ef65fefcb.simg
[Sun Jul  5 22:32:17 2020]
Finished job 2640.
1135 of 3292 steps (34%) done

[Sun Jul  5 22:32:17 2020]
rule get_outgroups:
    input: per_gene/EOG091G0C84/EOG091G0C84.ingroup.fasta
    output: per_gene/EOG091G0C84/EOG091G0C84.orthodb.fasta, per_gene/EOG091G0C84/EOG091G0C84.outgroup.fasta
    log: per_gene/EOG091G0C84/get_outgroups.stdout.txt, per_gene/EOG091G0C84/get_outgroups.stderr.txt
    jobid: 2641
    wildcards: BUSCO=EOG091G0C84


        #download fastas from Orhtodb for BUSCO id
        for i in {1..5}
        do
             wget "http://www.orthodb.org/fasta?query=EOG091G0C84&level=33208" -O per_gene/EOG091G0C84/EOG091G0C84.orthodb.fasta 1> per_gene/EOG091G0C84/get_outgroups.stdout.txt 2> per_gene/EOG091G0C84/get_outgroups.stderr.txt && break || echo -e "try again ($i)" && sleep 15
        done

	#This is quick an dirty for now and just takes the first protein if there is more than one for an outgroup taxon
        bash ../scripts/download_outgroups.sh taxids.txt per_gene/EOG091G0C84/EOG091G0C84.orthodb.fasta > per_gene/EOG091G0C84/EOG091G0C84.outgroup.fasta
        
[Sun Jul  5 22:32:18 2020]
Finished job 2641.
1136 of 3292 steps (35%) done

[Sun Jul  5 22:32:18 2020]
rule join_groups:
    input: per_gene/EOG091G0C84/EOG091G0C84.ingroup.fasta, per_gene/EOG091G0C84/EOG091G0C84.outgroup.fasta
    output: per_gene/EOG091G0C84/EOG091G0C84.fasta
    jobid: 2144
    wildcards: BUSCO=EOG091G0C84


        cat per_gene/EOG091G0C84/EOG091G0C84.ingroup.fasta per_gene/EOG091G0C84/EOG091G0C84.outgroup.fasta > per_gene/EOG091G0C84/EOG091G0C84.fasta
        
[Sun Jul  5 22:32:18 2020]
Finished job 2144.
1137 of 3292 steps (35%) done

[Sun Jul  5 22:32:18 2020]
rule MSA:
    input: per_gene/EOG091G0C84/EOG091G0C84.fasta
    output: per_gene/EOG091G0C84/EOG091G0C84.clustalo.fasta
    log: per_gene/EOG091G0C84/MSA.stdout.txt, per_gene/EOG091G0C84/MSA.stderr.txt
    jobid: 1408
    wildcards: BUSCO=EOG091G0C84
    threads: 2


        clustalo -i per_gene/EOG091G0C84/EOG091G0C84.fasta -o per_gene/EOG091G0C84/EOG091G0C84.clustalo.fasta --threads=2 1> per_gene/EOG091G0C84/MSA.stdout.txt 2> per_gene/EOG091G0C84/MSA.stderr.txt
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/d68c9691725a7401923680874285c430.simg
[Sun Jul  5 22:32:18 2020]
Finished job 1408.
1138 of 3292 steps (35%) done

[Sun Jul  5 22:32:18 2020]
rule score_and_cut:
    input: per_gene/EOG091G0C84/EOG091G0C84.clustalo.fasta
    output: per_gene/EOG091G0C84/ALICUT_EOG091G0C84.clustalo.fasta
    jobid: 585
    wildcards: BUSCO=EOG091G0C84
    threads: 2


        cd per_gene/EOG091G0C84
        Aliscore.pl -N -r 200000000000000000 -i ../../per_gene/EOG091G0C84/EOG091G0C84.clustalo.fasta &> aliscore.log
        ALICUT.pl -s &> alicut.log
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/63c88c27a0fa300f57066b0ef65fefcb.simg
[Sun Jul  5 22:32:18 2020]
Finished job 2954.
1139 of 3292 steps (35%) done

[Sun Jul  5 22:32:18 2020]
rule get_outgroups:
    input: per_gene/EOG091G05T4/EOG091G05T4.ingroup.fasta
    output: per_gene/EOG091G05T4/EOG091G05T4.orthodb.fasta, per_gene/EOG091G05T4/EOG091G05T4.outgroup.fasta
    log: per_gene/EOG091G05T4/get_outgroups.stdout.txt, per_gene/EOG091G05T4/get_outgroups.stderr.txt
    jobid: 2955
    wildcards: BUSCO=EOG091G05T4


        #download fastas from Orhtodb for BUSCO id
        for i in {1..5}
        do
             wget "http://www.orthodb.org/fasta?query=EOG091G05T4&level=33208" -O per_gene/EOG091G05T4/EOG091G05T4.orthodb.fasta 1> per_gene/EOG091G05T4/get_outgroups.stdout.txt 2> per_gene/EOG091G05T4/get_outgroups.stderr.txt && break || echo -e "try again ($i)" && sleep 15
        done

	#This is quick an dirty for now and just takes the first protein if there is more than one for an outgroup taxon
        bash ../scripts/download_outgroups.sh taxids.txt per_gene/EOG091G05T4/EOG091G05T4.orthodb.fasta > per_gene/EOG091G05T4/EOG091G05T4.outgroup.fasta
        
[Sun Jul  5 22:32:19 2020]
Finished job 817.
1140 of 3292 steps (35%) done

[Sun Jul  5 22:32:19 2020]
rule get_seqs:
    input: /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ingroup.txt, /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/outgroup.txt
    output: per_gene/EOG091G0MY8/EOG091G0MY8.ingroup.fasta
    log: per_gene/EOG091G0MY8/get_seqs.stdout.txt, per_gene/EOG091G0MY8/get_seqs.stderr.txt
    jobid: 2776
    wildcards: BUSCO=EOG091G0MY8
    threads: 2


	basedir=$(pwd)
        cd per_gene/EOG091G0MY8
        
        bash $basedir/../scripts/fetch_seqs.sh EOG091G0MY8 /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ingroup.txt /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/outgroup.txt 1> ../../per_gene/EOG091G0MY8/get_seqs.stdout.txt 2> ../../per_gene/EOG091G0MY8/get_seqs.stderr.txt
	mv EOG091G0MY8.fasta $basedir/per_gene/EOG091G0MY8/EOG091G0MY8.ingroup.fasta
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/72476f9d9a5bd0627b4d721143a21354.simg

[Sun Jul  5 22:32:19 2020]
rule remove_empty:
    input: per_gene/EOG091G0VGJ/ALICUT_EOG091G0VGJ.clustalo.fasta
    output: per_gene/EOG091G0VGJ/empty_check.done
    jobid: 1639
    wildcards: BUSCO=EOG091G0VGJ


         if [ "$(cat per_gene/EOG091G0VGJ/ALICUT_EOG091G0VGJ.clustalo.fasta | grep -v ">" | sed 's/-//g' | grep "^$" | wc -l)" -gt 0 ]
         then
              cp per_gene/EOG091G0VGJ/ALICUT_EOG091G0VGJ.clustalo.fasta per_gene/EOG091G0VGJ/ALICUT_EOG091G0VGJ.clustalo.fasta.backup
              bash ../scripts/remove_empty.sh per_gene/EOG091G0VGJ/ALICUT_EOG091G0VGJ.clustalo.fasta.backup > per_gene/EOG091G0VGJ/ALICUT_EOG091G0VGJ.clustalo.fasta
         fi
         touch per_gene/EOG091G0VGJ/empty_check.done
         
[Sun Jul  5 22:32:19 2020]
Finished job 1639.
1141 of 3292 steps (35%) done
[Sun Jul  5 22:32:19 2020]
Finished job 2955.
1142 of 3292 steps (35%) done

[Sun Jul  5 22:32:19 2020]
rule join_groups:
    input: per_gene/EOG091G05T4/EOG091G05T4.ingroup.fasta, per_gene/EOG091G05T4/EOG091G05T4.outgroup.fasta
    output: per_gene/EOG091G05T4/EOG091G05T4.fasta
    jobid: 2301
    wildcards: BUSCO=EOG091G05T4


        cat per_gene/EOG091G05T4/EOG091G05T4.ingroup.fasta per_gene/EOG091G05T4/EOG091G05T4.outgroup.fasta > per_gene/EOG091G05T4/EOG091G05T4.fasta
        
[Sun Jul  5 22:32:19 2020]
Finished job 2301.
1143 of 3292 steps (35%) done

[Sun Jul  5 22:32:19 2020]
rule MSA:
    input: per_gene/EOG091G05T4/EOG091G05T4.fasta
    output: per_gene/EOG091G05T4/EOG091G05T4.clustalo.fasta
    log: per_gene/EOG091G05T4/MSA.stdout.txt, per_gene/EOG091G05T4/MSA.stderr.txt
    jobid: 1722
    wildcards: BUSCO=EOG091G05T4
    threads: 2


        clustalo -i per_gene/EOG091G05T4/EOG091G05T4.fasta -o per_gene/EOG091G05T4/EOG091G05T4.clustalo.fasta --threads=2 1> per_gene/EOG091G05T4/MSA.stdout.txt 2> per_gene/EOG091G05T4/MSA.stderr.txt
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/d68c9691725a7401923680874285c430.simg
[Sun Jul  5 22:32:21 2020]
Finished job 1722.
1144 of 3292 steps (35%) done

[Sun Jul  5 22:32:22 2020]
rule score_and_cut:
    input: per_gene/EOG091G05T4/EOG091G05T4.clustalo.fasta
    output: per_gene/EOG091G05T4/ALICUT_EOG091G05T4.clustalo.fasta
    jobid: 899
    wildcards: BUSCO=EOG091G05T4
    threads: 2


        cd per_gene/EOG091G05T4
        Aliscore.pl -N -r 200000000000000000 -i ../../per_gene/EOG091G05T4/EOG091G05T4.clustalo.fasta &> aliscore.log
        ALICUT.pl -s &> alicut.log
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/63c88c27a0fa300f57066b0ef65fefcb.simg
[Sun Jul  5 22:32:26 2020]
Finished job 1158.
1145 of 3292 steps (35%) done

[Sun Jul  5 22:32:26 2020]
rule infer_single_ML:
    input: per_gene/EOG091G0IYB/EOG091G0IYB.best_model, per_gene/EOG091G0IYB/ALICUT_EOG091G0IYB.clustalo.fasta
    output: per_gene/EOG091G0IYB/EOG091G0IYB.raxml.done
    log: per_gene/EOG091G0IYB/infer_single_ML.stdout.txt, per_gene/EOG091G0IYB/infer_single_ML.stderr.txt
    jobid: 373
    wildcards: BUSCO=EOG091G0IYB
    threads: 2


        cd per_gene/EOG091G0IYB
	count=$(cat ../../per_gene/EOG091G0IYB/ALICUT_EOG091G0IYB.clustalo.fasta | grep ">" | wc -l)
	if [ "$count" -gt 5 ]
        then
		RAxMLmodel=$(cat ../../per_gene/EOG091G0IYB/EOG091G0IYB.best_model | grep "Best" | cut -d ":" -f 2 | tr -d '[:space:]')
                if [ "$(ls -1 | grep "^RAxML" | wc -l)" -ne 0 ]
		then
			rm RAxML*
		fi
        	raxml -f a -T 2 -m PROTGAMMA$RAxMLmodel         	-p 12345 -x 12345 -# 100         	-s ../../per_gene/EOG091G0IYB/ALICUT_EOG091G0IYB.clustalo.fasta -n EOG091G0IYB.clustalo.aln.ALICUT.$RAxMLmodel 		1> ../../per_gene/EOG091G0IYB/infer_single_ML.stdout.txt 2> ../../per_gene/EOG091G0IYB/infer_single_ML.stderr.txt
	else
		echo "fasta file per_gene/EOG091G0IYB/ALICUT_EOG091G0IYB.clustalo.fasta contains fewer than 5 sequences - skipped" > ../../per_gene/EOG091G0IYB/infer_single_ML.stdout.txt
		touch raxml.skipped
	fi
        touch ../../per_gene/EOG091G0IYB/EOG091G0IYB.raxml.done
        
[33mJob counts:
	count	jobs
	1	infer_single_ML
	1[0m
[33m
        cd per_gene/EOG091G0IYB
	count=$(cat ../../per_gene/EOG091G0IYB/ALICUT_EOG091G0IYB.clustalo.fasta | grep ">" | wc -l)
	if [ "$count" -gt 5 ]
        then
		RAxMLmodel=$(cat ../../per_gene/EOG091G0IYB/EOG091G0IYB.best_model | grep "Best" | cut -d ":" -f 2 | tr -d '[:space:]')
                if [ "$(ls -1 | grep "^RAxML" | wc -l)" -ne 0 ]
		then
			rm RAxML*
		fi
        	raxml -f a -T 2 -m PROTGAMMA$RAxMLmodel         	-p 12345 -x 12345 -# 100         	-s ../../per_gene/EOG091G0IYB/ALICUT_EOG091G0IYB.clustalo.fasta -n EOG091G0IYB.clustalo.aln.ALICUT.$RAxMLmodel 		1> ../../per_gene/EOG091G0IYB/infer_single_ML.stdout.txt 2> ../../per_gene/EOG091G0IYB/infer_single_ML.stderr.txt
	else
		echo "fasta file per_gene/EOG091G0IYB/ALICUT_EOG091G0IYB.clustalo.fasta contains fewer than 5 sequences - skipped" > ../../per_gene/EOG091G0IYB/infer_single_ML.stdout.txt
		touch raxml.skipped
	fi
        touch ../../per_gene/EOG091G0IYB/EOG091G0IYB.raxml.done
        [0m
[Sun Jul  5 22:32:28 2020]
Finished job 585.
1146 of 3292 steps (35%) done

[Sun Jul  5 22:32:28 2020]
rule remove_empty:
    input: per_gene/EOG091G0C84/ALICUT_EOG091G0C84.clustalo.fasta
    output: per_gene/EOG091G0C84/empty_check.done
    jobid: 1407
    wildcards: BUSCO=EOG091G0C84


         if [ "$(cat per_gene/EOG091G0C84/ALICUT_EOG091G0C84.clustalo.fasta | grep -v ">" | sed 's/-//g' | grep "^$" | wc -l)" -gt 0 ]
         then
              cp per_gene/EOG091G0C84/ALICUT_EOG091G0C84.clustalo.fasta per_gene/EOG091G0C84/ALICUT_EOG091G0C84.clustalo.fasta.backup
              bash ../scripts/remove_empty.sh per_gene/EOG091G0C84/ALICUT_EOG091G0C84.clustalo.fasta.backup > per_gene/EOG091G0C84/ALICUT_EOG091G0C84.clustalo.fasta
         fi
         touch per_gene/EOG091G0C84/empty_check.done
         
[Sun Jul  5 22:32:28 2020]
Finished job 1407.
1147 of 3292 steps (35%) done

[Sun Jul  5 22:32:28 2020]
rule find_best_model:
    input: per_gene/EOG091G0C84/ALICUT_EOG091G0C84.clustalo.fasta, per_gene/EOG091G0C84/empty_check.done
    output: per_gene/EOG091G0C84/EOG091G0C84.best_model
    log: per_gene/EOG091G0C84/find_best_model.stderr.txt
    jobid: 584
    wildcards: BUSCO=EOG091G0C84
    threads: 2


        cd per_gene/EOG091G0C84
        if [ ! -d find_best_model ]
        then
            mkdir find_best_model
        fi
        cd find_best_model
        ln -s ../../../per_gene/EOG091G0C84/ALICUT_EOG091G0C84.clustalo.fasta EOG091G0C84.fasta
        ProteinModelSelection.pl EOG091G0C84.fasta 1> ../../../per_gene/EOG091G0C84/EOG091G0C84.best_model 2> ../../../per_gene/EOG091G0C84/find_best_model.stderr.txt
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/c0c09ee657b1e27f2c5687e0e9aa8d70.simg
[Sun Jul  5 22:32:32 2020]
Finished job 899.
1148 of 3292 steps (35%) done

[Sun Jul  5 22:32:32 2020]
rule remove_empty:
    input: per_gene/EOG091G05T4/ALICUT_EOG091G05T4.clustalo.fasta
    output: per_gene/EOG091G05T4/empty_check.done
    jobid: 1721
    wildcards: BUSCO=EOG091G05T4


         if [ "$(cat per_gene/EOG091G05T4/ALICUT_EOG091G05T4.clustalo.fasta | grep -v ">" | sed 's/-//g' | grep "^$" | wc -l)" -gt 0 ]
         then
              cp per_gene/EOG091G05T4/ALICUT_EOG091G05T4.clustalo.fasta per_gene/EOG091G05T4/ALICUT_EOG091G05T4.clustalo.fasta.backup
              bash ../scripts/remove_empty.sh per_gene/EOG091G05T4/ALICUT_EOG091G05T4.clustalo.fasta.backup > per_gene/EOG091G05T4/ALICUT_EOG091G05T4.clustalo.fasta
         fi
         touch per_gene/EOG091G05T4/empty_check.done
         
[Sun Jul  5 22:32:32 2020]
Finished job 1721.
1149 of 3292 steps (35%) done

[Sun Jul  5 22:32:32 2020]
rule find_best_model:
    input: per_gene/EOG091G05T4/ALICUT_EOG091G05T4.clustalo.fasta, per_gene/EOG091G05T4/empty_check.done
    output: per_gene/EOG091G05T4/EOG091G05T4.best_model
    log: per_gene/EOG091G05T4/find_best_model.stderr.txt
    jobid: 898
    wildcards: BUSCO=EOG091G05T4
    threads: 2


        cd per_gene/EOG091G05T4
        if [ ! -d find_best_model ]
        then
            mkdir find_best_model
        fi
        cd find_best_model
        ln -s ../../../per_gene/EOG091G05T4/ALICUT_EOG091G05T4.clustalo.fasta EOG091G05T4.fasta
        ProteinModelSelection.pl EOG091G05T4.fasta 1> ../../../per_gene/EOG091G05T4/EOG091G05T4.best_model 2> ../../../per_gene/EOG091G05T4/find_best_model.stderr.txt
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/c0c09ee657b1e27f2c5687e0e9aa8d70.simg
[Sun Jul  5 22:32:33 2020]
Finished job 2776.
1150 of 3292 steps (35%) done

[Sun Jul  5 22:32:33 2020]
rule get_outgroups:
    input: per_gene/EOG091G0MY8/EOG091G0MY8.ingroup.fasta
    output: per_gene/EOG091G0MY8/EOG091G0MY8.orthodb.fasta, per_gene/EOG091G0MY8/EOG091G0MY8.outgroup.fasta
    log: per_gene/EOG091G0MY8/get_outgroups.stdout.txt, per_gene/EOG091G0MY8/get_outgroups.stderr.txt
    jobid: 2777
    wildcards: BUSCO=EOG091G0MY8


        #download fastas from Orhtodb for BUSCO id
        for i in {1..5}
        do
             wget "http://www.orthodb.org/fasta?query=EOG091G0MY8&level=33208" -O per_gene/EOG091G0MY8/EOG091G0MY8.orthodb.fasta 1> per_gene/EOG091G0MY8/get_outgroups.stdout.txt 2> per_gene/EOG091G0MY8/get_outgroups.stderr.txt && break || echo -e "try again ($i)" && sleep 15
        done

	#This is quick an dirty for now and just takes the first protein if there is more than one for an outgroup taxon
        bash ../scripts/download_outgroups.sh taxids.txt per_gene/EOG091G0MY8/EOG091G0MY8.orthodb.fasta > per_gene/EOG091G0MY8/EOG091G0MY8.outgroup.fasta
        
[Sun Jul  5 22:32:34 2020]
Finished job 2777.
1151 of 3292 steps (35%) done

[Sun Jul  5 22:32:34 2020]
rule join_groups:
    input: per_gene/EOG091G0MY8/EOG091G0MY8.ingroup.fasta, per_gene/EOG091G0MY8/EOG091G0MY8.outgroup.fasta
    output: per_gene/EOG091G0MY8/EOG091G0MY8.fasta
    jobid: 2212
    wildcards: BUSCO=EOG091G0MY8


        cat per_gene/EOG091G0MY8/EOG091G0MY8.ingroup.fasta per_gene/EOG091G0MY8/EOG091G0MY8.outgroup.fasta > per_gene/EOG091G0MY8/EOG091G0MY8.fasta
        
[Sun Jul  5 22:32:34 2020]
Finished job 2212.
1152 of 3292 steps (35%) done

[Sun Jul  5 22:32:34 2020]
rule MSA:
    input: per_gene/EOG091G0MY8/EOG091G0MY8.fasta
    output: per_gene/EOG091G0MY8/EOG091G0MY8.clustalo.fasta
    log: per_gene/EOG091G0MY8/MSA.stdout.txt, per_gene/EOG091G0MY8/MSA.stderr.txt
    jobid: 1544
    wildcards: BUSCO=EOG091G0MY8
    threads: 2


        clustalo -i per_gene/EOG091G0MY8/EOG091G0MY8.fasta -o per_gene/EOG091G0MY8/EOG091G0MY8.clustalo.fasta --threads=2 1> per_gene/EOG091G0MY8/MSA.stdout.txt 2> per_gene/EOG091G0MY8/MSA.stderr.txt
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/d68c9691725a7401923680874285c430.simg
[Sun Jul  5 22:32:35 2020]
Finished job 191.
1153 of 3292 steps (35%) done

[Sun Jul  5 22:32:35 2020]
rule find_best_model:
    input: per_gene/EOG091G0VGJ/ALICUT_EOG091G0VGJ.clustalo.fasta, per_gene/EOG091G0VGJ/empty_check.done
    output: per_gene/EOG091G0VGJ/EOG091G0VGJ.best_model
    log: per_gene/EOG091G0VGJ/find_best_model.stderr.txt
    jobid: 816
    wildcards: BUSCO=EOG091G0VGJ
    threads: 2


        cd per_gene/EOG091G0VGJ
        if [ ! -d find_best_model ]
        then
            mkdir find_best_model
        fi
        cd find_best_model
        ln -s ../../../per_gene/EOG091G0VGJ/ALICUT_EOG091G0VGJ.clustalo.fasta EOG091G0VGJ.fasta
        ProteinModelSelection.pl EOG091G0VGJ.fasta 1> ../../../per_gene/EOG091G0VGJ/EOG091G0VGJ.best_model 2> ../../../per_gene/EOG091G0VGJ/find_best_model.stderr.txt
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/c0c09ee657b1e27f2c5687e0e9aa8d70.simg
[Sun Jul  5 22:32:36 2020]
Finished job 1544.
1154 of 3292 steps (35%) done

[Sun Jul  5 22:32:36 2020]
rule score_and_cut:
    input: per_gene/EOG091G0MY8/EOG091G0MY8.clustalo.fasta
    output: per_gene/EOG091G0MY8/ALICUT_EOG091G0MY8.clustalo.fasta
    jobid: 721
    wildcards: BUSCO=EOG091G0MY8
    threads: 2


        cd per_gene/EOG091G0MY8
        Aliscore.pl -N -r 200000000000000000 -i ../../per_gene/EOG091G0MY8/EOG091G0MY8.clustalo.fasta &> aliscore.log
        ALICUT.pl -s &> alicut.log
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/63c88c27a0fa300f57066b0ef65fefcb.simg
[Sun Jul  5 22:32:47 2020]
Finished job 721.
1155 of 3292 steps (35%) done

[Sun Jul  5 22:32:47 2020]
rule remove_empty:
    input: per_gene/EOG091G0MY8/ALICUT_EOG091G0MY8.clustalo.fasta
    output: per_gene/EOG091G0MY8/empty_check.done
    jobid: 1543
    wildcards: BUSCO=EOG091G0MY8


         if [ "$(cat per_gene/EOG091G0MY8/ALICUT_EOG091G0MY8.clustalo.fasta | grep -v ">" | sed 's/-//g' | grep "^$" | wc -l)" -gt 0 ]
         then
              cp per_gene/EOG091G0MY8/ALICUT_EOG091G0MY8.clustalo.fasta per_gene/EOG091G0MY8/ALICUT_EOG091G0MY8.clustalo.fasta.backup
              bash ../scripts/remove_empty.sh per_gene/EOG091G0MY8/ALICUT_EOG091G0MY8.clustalo.fasta.backup > per_gene/EOG091G0MY8/ALICUT_EOG091G0MY8.clustalo.fasta
         fi
         touch per_gene/EOG091G0MY8/empty_check.done
         
[Sun Jul  5 22:32:47 2020]
Finished job 1543.
1156 of 3292 steps (35%) done

[Sun Jul  5 22:32:47 2020]
rule find_best_model:
    input: per_gene/EOG091G0MY8/ALICUT_EOG091G0MY8.clustalo.fasta, per_gene/EOG091G0MY8/empty_check.done
    output: per_gene/EOG091G0MY8/EOG091G0MY8.best_model
    log: per_gene/EOG091G0MY8/find_best_model.stderr.txt
    jobid: 720
    wildcards: BUSCO=EOG091G0MY8
    threads: 2


        cd per_gene/EOG091G0MY8
        if [ ! -d find_best_model ]
        then
            mkdir find_best_model
        fi
        cd find_best_model
        ln -s ../../../per_gene/EOG091G0MY8/ALICUT_EOG091G0MY8.clustalo.fasta EOG091G0MY8.fasta
        ProteinModelSelection.pl EOG091G0MY8.fasta 1> ../../../per_gene/EOG091G0MY8/EOG091G0MY8.best_model 2> ../../../per_gene/EOG091G0MY8/find_best_model.stderr.txt
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/c0c09ee657b1e27f2c5687e0e9aa8d70.simg
[Sun Jul  5 22:32:53 2020]
Finished job 256.
1157 of 3292 steps (35%) done

[Sun Jul  5 22:32:53 2020]
rule get_seqs:
    input: /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ingroup.txt, /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/outgroup.txt
    output: per_gene/EOG091G0BHP/EOG091G0BHP.ingroup.fasta
    log: per_gene/EOG091G0BHP/get_seqs.stdout.txt, per_gene/EOG091G0BHP/get_seqs.stderr.txt
    jobid: 2632
    wildcards: BUSCO=EOG091G0BHP
    threads: 2


	basedir=$(pwd)
        cd per_gene/EOG091G0BHP
        
        bash $basedir/../scripts/fetch_seqs.sh EOG091G0BHP /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ingroup.txt /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/outgroup.txt 1> ../../per_gene/EOG091G0BHP/get_seqs.stdout.txt 2> ../../per_gene/EOG091G0BHP/get_seqs.stderr.txt
	mv EOG091G0BHP.fasta $basedir/per_gene/EOG091G0BHP/EOG091G0BHP.ingroup.fasta
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/72476f9d9a5bd0627b4d721143a21354.simg
[Sun Jul  5 22:33:00 2020]
Finished job 816.
1158 of 3292 steps (35%) done

[Sun Jul  5 22:33:00 2020]
rule infer_single_ML:
    input: per_gene/EOG091G0VGJ/EOG091G0VGJ.best_model, per_gene/EOG091G0VGJ/ALICUT_EOG091G0VGJ.clustalo.fasta
    output: per_gene/EOG091G0VGJ/EOG091G0VGJ.raxml.done
    log: per_gene/EOG091G0VGJ/infer_single_ML.stdout.txt, per_gene/EOG091G0VGJ/infer_single_ML.stderr.txt
    jobid: 202
    wildcards: BUSCO=EOG091G0VGJ
    threads: 2


        cd per_gene/EOG091G0VGJ
	count=$(cat ../../per_gene/EOG091G0VGJ/ALICUT_EOG091G0VGJ.clustalo.fasta | grep ">" | wc -l)
	if [ "$count" -gt 5 ]
        then
		RAxMLmodel=$(cat ../../per_gene/EOG091G0VGJ/EOG091G0VGJ.best_model | grep "Best" | cut -d ":" -f 2 | tr -d '[:space:]')
                if [ "$(ls -1 | grep "^RAxML" | wc -l)" -ne 0 ]
		then
			rm RAxML*
		fi
        	raxml -f a -T 2 -m PROTGAMMA$RAxMLmodel         	-p 12345 -x 12345 -# 100         	-s ../../per_gene/EOG091G0VGJ/ALICUT_EOG091G0VGJ.clustalo.fasta -n EOG091G0VGJ.clustalo.aln.ALICUT.$RAxMLmodel 		1> ../../per_gene/EOG091G0VGJ/infer_single_ML.stdout.txt 2> ../../per_gene/EOG091G0VGJ/infer_single_ML.stderr.txt
	else
		echo "fasta file per_gene/EOG091G0VGJ/ALICUT_EOG091G0VGJ.clustalo.fasta contains fewer than 5 sequences - skipped" > ../../per_gene/EOG091G0VGJ/infer_single_ML.stdout.txt
		touch raxml.skipped
	fi
        touch ../../per_gene/EOG091G0VGJ/EOG091G0VGJ.raxml.done
        
[33mJob counts:
	count	jobs
	1	infer_single_ML
	1[0m
[33m
        cd per_gene/EOG091G0VGJ
	count=$(cat ../../per_gene/EOG091G0VGJ/ALICUT_EOG091G0VGJ.clustalo.fasta | grep ">" | wc -l)
	if [ "$count" -gt 5 ]
        then
		RAxMLmodel=$(cat ../../per_gene/EOG091G0VGJ/EOG091G0VGJ.best_model | grep "Best" | cut -d ":" -f 2 | tr -d '[:space:]')
                if [ "$(ls -1 | grep "^RAxML" | wc -l)" -ne 0 ]
		then
			rm RAxML*
		fi
        	raxml -f a -T 2 -m PROTGAMMA$RAxMLmodel         	-p 12345 -x 12345 -# 100         	-s ../../per_gene/EOG091G0VGJ/ALICUT_EOG091G0VGJ.clustalo.fasta -n EOG091G0VGJ.clustalo.aln.ALICUT.$RAxMLmodel 		1> ../../per_gene/EOG091G0VGJ/infer_single_ML.stdout.txt 2> ../../per_gene/EOG091G0VGJ/infer_single_ML.stderr.txt
	else
		echo "fasta file per_gene/EOG091G0VGJ/ALICUT_EOG091G0VGJ.clustalo.fasta contains fewer than 5 sequences - skipped" > ../../per_gene/EOG091G0VGJ/infer_single_ML.stdout.txt
		touch raxml.skipped
	fi
        touch ../../per_gene/EOG091G0VGJ/EOG091G0VGJ.raxml.done
        [0m
[Sun Jul  5 22:33:03 2020]
Finished job 584.
1159 of 3292 steps (35%) done

[Sun Jul  5 22:33:03 2020]
rule infer_single_ML:
    input: per_gene/EOG091G0C84/EOG091G0C84.best_model, per_gene/EOG091G0C84/ALICUT_EOG091G0C84.clustalo.fasta
    output: per_gene/EOG091G0C84/EOG091G0C84.raxml.done
    log: per_gene/EOG091G0C84/infer_single_ML.stdout.txt, per_gene/EOG091G0C84/infer_single_ML.stderr.txt
    jobid: 86
    wildcards: BUSCO=EOG091G0C84
    threads: 2


        cd per_gene/EOG091G0C84
	count=$(cat ../../per_gene/EOG091G0C84/ALICUT_EOG091G0C84.clustalo.fasta | grep ">" | wc -l)
	if [ "$count" -gt 5 ]
        then
		RAxMLmodel=$(cat ../../per_gene/EOG091G0C84/EOG091G0C84.best_model | grep "Best" | cut -d ":" -f 2 | tr -d '[:space:]')
                if [ "$(ls -1 | grep "^RAxML" | wc -l)" -ne 0 ]
		then
			rm RAxML*
		fi
        	raxml -f a -T 2 -m PROTGAMMA$RAxMLmodel         	-p 12345 -x 12345 -# 100         	-s ../../per_gene/EOG091G0C84/ALICUT_EOG091G0C84.clustalo.fasta -n EOG091G0C84.clustalo.aln.ALICUT.$RAxMLmodel 		1> ../../per_gene/EOG091G0C84/infer_single_ML.stdout.txt 2> ../../per_gene/EOG091G0C84/infer_single_ML.stderr.txt
	else
		echo "fasta file per_gene/EOG091G0C84/ALICUT_EOG091G0C84.clustalo.fasta contains fewer than 5 sequences - skipped" > ../../per_gene/EOG091G0C84/infer_single_ML.stdout.txt
		touch raxml.skipped
	fi
        touch ../../per_gene/EOG091G0C84/EOG091G0C84.raxml.done
        
[33mJob counts:
	count	jobs
	1	infer_single_ML
	1[0m
[33m
        cd per_gene/EOG091G0C84
	count=$(cat ../../per_gene/EOG091G0C84/ALICUT_EOG091G0C84.clustalo.fasta | grep ">" | wc -l)
	if [ "$count" -gt 5 ]
        then
		RAxMLmodel=$(cat ../../per_gene/EOG091G0C84/EOG091G0C84.best_model | grep "Best" | cut -d ":" -f 2 | tr -d '[:space:]')
                if [ "$(ls -1 | grep "^RAxML" | wc -l)" -ne 0 ]
		then
			rm RAxML*
		fi
        	raxml -f a -T 2 -m PROTGAMMA$RAxMLmodel         	-p 12345 -x 12345 -# 100         	-s ../../per_gene/EOG091G0C84/ALICUT_EOG091G0C84.clustalo.fasta -n EOG091G0C84.clustalo.aln.ALICUT.$RAxMLmodel 		1> ../../per_gene/EOG091G0C84/infer_single_ML.stdout.txt 2> ../../per_gene/EOG091G0C84/infer_single_ML.stderr.txt
	else
		echo "fasta file per_gene/EOG091G0C84/ALICUT_EOG091G0C84.clustalo.fasta contains fewer than 5 sequences - skipped" > ../../per_gene/EOG091G0C84/infer_single_ML.stdout.txt
		touch raxml.skipped
	fi
        touch ../../per_gene/EOG091G0C84/EOG091G0C84.raxml.done
        [0m
[Sun Jul  5 22:33:04 2020]
Finished job 898.
1160 of 3292 steps (35%) done

[Sun Jul  5 22:33:04 2020]
rule infer_single_ML:
    input: per_gene/EOG091G05T4/EOG091G05T4.best_model, per_gene/EOG091G05T4/ALICUT_EOG091G05T4.clustalo.fasta
    output: per_gene/EOG091G05T4/EOG091G05T4.raxml.done
    log: per_gene/EOG091G05T4/infer_single_ML.stdout.txt, per_gene/EOG091G05T4/infer_single_ML.stderr.txt
    jobid: 243
    wildcards: BUSCO=EOG091G05T4
    threads: 2


        cd per_gene/EOG091G05T4
	count=$(cat ../../per_gene/EOG091G05T4/ALICUT_EOG091G05T4.clustalo.fasta | grep ">" | wc -l)
	if [ "$count" -gt 5 ]
        then
		RAxMLmodel=$(cat ../../per_gene/EOG091G05T4/EOG091G05T4.best_model | grep "Best" | cut -d ":" -f 2 | tr -d '[:space:]')
                if [ "$(ls -1 | grep "^RAxML" | wc -l)" -ne 0 ]
		then
			rm RAxML*
		fi
        	raxml -f a -T 2 -m PROTGAMMA$RAxMLmodel         	-p 12345 -x 12345 -# 100         	-s ../../per_gene/EOG091G05T4/ALICUT_EOG091G05T4.clustalo.fasta -n EOG091G05T4.clustalo.aln.ALICUT.$RAxMLmodel 		1> ../../per_gene/EOG091G05T4/infer_single_ML.stdout.txt 2> ../../per_gene/EOG091G05T4/infer_single_ML.stderr.txt
	else
		echo "fasta file per_gene/EOG091G05T4/ALICUT_EOG091G05T4.clustalo.fasta contains fewer than 5 sequences - skipped" > ../../per_gene/EOG091G05T4/infer_single_ML.stdout.txt
		touch raxml.skipped
	fi
        touch ../../per_gene/EOG091G05T4/EOG091G05T4.raxml.done
        
[33mJob counts:
	count	jobs
	1	infer_single_ML
	1[0m
[33m
        cd per_gene/EOG091G05T4
	count=$(cat ../../per_gene/EOG091G05T4/ALICUT_EOG091G05T4.clustalo.fasta | grep ">" | wc -l)
	if [ "$count" -gt 5 ]
        then
		RAxMLmodel=$(cat ../../per_gene/EOG091G05T4/EOG091G05T4.best_model | grep "Best" | cut -d ":" -f 2 | tr -d '[:space:]')
                if [ "$(ls -1 | grep "^RAxML" | wc -l)" -ne 0 ]
		then
			rm RAxML*
		fi
        	raxml -f a -T 2 -m PROTGAMMA$RAxMLmodel         	-p 12345 -x 12345 -# 100         	-s ../../per_gene/EOG091G05T4/ALICUT_EOG091G05T4.clustalo.fasta -n EOG091G05T4.clustalo.aln.ALICUT.$RAxMLmodel 		1> ../../per_gene/EOG091G05T4/infer_single_ML.stdout.txt 2> ../../per_gene/EOG091G05T4/infer_single_ML.stderr.txt
	else
		echo "fasta file per_gene/EOG091G05T4/ALICUT_EOG091G05T4.clustalo.fasta contains fewer than 5 sequences - skipped" > ../../per_gene/EOG091G05T4/infer_single_ML.stdout.txt
		touch raxml.skipped
	fi
        touch ../../per_gene/EOG091G05T4/EOG091G05T4.raxml.done
        [0m
[Sun Jul  5 22:33:09 2020]
Finished job 2632.
1161 of 3292 steps (35%) done

[Sun Jul  5 22:33:09 2020]
rule get_outgroups:
    input: per_gene/EOG091G0BHP/EOG091G0BHP.ingroup.fasta
    output: per_gene/EOG091G0BHP/EOG091G0BHP.orthodb.fasta, per_gene/EOG091G0BHP/EOG091G0BHP.outgroup.fasta
    log: per_gene/EOG091G0BHP/get_outgroups.stdout.txt, per_gene/EOG091G0BHP/get_outgroups.stderr.txt
    jobid: 2633
    wildcards: BUSCO=EOG091G0BHP


        #download fastas from Orhtodb for BUSCO id
        for i in {1..5}
        do
             wget "http://www.orthodb.org/fasta?query=EOG091G0BHP&level=33208" -O per_gene/EOG091G0BHP/EOG091G0BHP.orthodb.fasta 1> per_gene/EOG091G0BHP/get_outgroups.stdout.txt 2> per_gene/EOG091G0BHP/get_outgroups.stderr.txt && break || echo -e "try again ($i)" && sleep 15
        done

	#This is quick an dirty for now and just takes the first protein if there is more than one for an outgroup taxon
        bash ../scripts/download_outgroups.sh taxids.txt per_gene/EOG091G0BHP/EOG091G0BHP.orthodb.fasta > per_gene/EOG091G0BHP/EOG091G0BHP.outgroup.fasta
        
[Sun Jul  5 22:33:10 2020]
Finished job 35.
1162 of 3292 steps (35%) done

[Sun Jul  5 22:33:10 2020]
rule get_seqs:
    input: /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ingroup.txt, /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/outgroup.txt
    output: per_gene/EOG091G06U0/EOG091G06U0.ingroup.fasta
    log: per_gene/EOG091G06U0/get_seqs.stdout.txt, per_gene/EOG091G06U0/get_seqs.stderr.txt
    jobid: 2566
    wildcards: BUSCO=EOG091G06U0
    threads: 2


	basedir=$(pwd)
        cd per_gene/EOG091G06U0
        
        bash $basedir/../scripts/fetch_seqs.sh EOG091G06U0 /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ingroup.txt /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/outgroup.txt 1> ../../per_gene/EOG091G06U0/get_seqs.stdout.txt 2> ../../per_gene/EOG091G06U0/get_seqs.stderr.txt
	mv EOG091G06U0.fasta $basedir/per_gene/EOG091G06U0/EOG091G06U0.ingroup.fasta
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/72476f9d9a5bd0627b4d721143a21354.simg
[Sun Jul  5 22:33:10 2020]
Finished job 2633.
1163 of 3292 steps (35%) done

[Sun Jul  5 22:33:10 2020]
rule join_groups:
    input: per_gene/EOG091G0BHP/EOG091G0BHP.ingroup.fasta, per_gene/EOG091G0BHP/EOG091G0BHP.outgroup.fasta
    output: per_gene/EOG091G0BHP/EOG091G0BHP.fasta
    jobid: 2140
    wildcards: BUSCO=EOG091G0BHP


        cat per_gene/EOG091G0BHP/EOG091G0BHP.ingroup.fasta per_gene/EOG091G0BHP/EOG091G0BHP.outgroup.fasta > per_gene/EOG091G0BHP/EOG091G0BHP.fasta
        
[Sun Jul  5 22:33:10 2020]
Finished job 2140.
1164 of 3292 steps (35%) done

[Sun Jul  5 22:33:10 2020]
rule MSA:
    input: per_gene/EOG091G0BHP/EOG091G0BHP.fasta
    output: per_gene/EOG091G0BHP/EOG091G0BHP.clustalo.fasta
    log: per_gene/EOG091G0BHP/MSA.stdout.txt, per_gene/EOG091G0BHP/MSA.stderr.txt
    jobid: 1400
    wildcards: BUSCO=EOG091G0BHP
    threads: 2


        clustalo -i per_gene/EOG091G0BHP/EOG091G0BHP.fasta -o per_gene/EOG091G0BHP/EOG091G0BHP.clustalo.fasta --threads=2 1> per_gene/EOG091G0BHP/MSA.stdout.txt 2> per_gene/EOG091G0BHP/MSA.stderr.txt
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/d68c9691725a7401923680874285c430.simg
[Sun Jul  5 22:33:11 2020]
Finished job 1400.
1165 of 3292 steps (35%) done

[Sun Jul  5 22:33:11 2020]
rule score_and_cut:
    input: per_gene/EOG091G0BHP/EOG091G0BHP.clustalo.fasta
    output: per_gene/EOG091G0BHP/ALICUT_EOG091G0BHP.clustalo.fasta
    jobid: 577
    wildcards: BUSCO=EOG091G0BHP
    threads: 2


        cd per_gene/EOG091G0BHP
        Aliscore.pl -N -r 200000000000000000 -i ../../per_gene/EOG091G0BHP/EOG091G0BHP.clustalo.fasta &> aliscore.log
        ALICUT.pl -s &> alicut.log
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/63c88c27a0fa300f57066b0ef65fefcb.simg
[Sun Jul  5 22:33:21 2020]
Finished job 577.
1166 of 3292 steps (35%) done

[Sun Jul  5 22:33:21 2020]
rule remove_empty:
    input: per_gene/EOG091G0BHP/ALICUT_EOG091G0BHP.clustalo.fasta
    output: per_gene/EOG091G0BHP/empty_check.done
    jobid: 1399
    wildcards: BUSCO=EOG091G0BHP


         if [ "$(cat per_gene/EOG091G0BHP/ALICUT_EOG091G0BHP.clustalo.fasta | grep -v ">" | sed 's/-//g' | grep "^$" | wc -l)" -gt 0 ]
         then
              cp per_gene/EOG091G0BHP/ALICUT_EOG091G0BHP.clustalo.fasta per_gene/EOG091G0BHP/ALICUT_EOG091G0BHP.clustalo.fasta.backup
              bash ../scripts/remove_empty.sh per_gene/EOG091G0BHP/ALICUT_EOG091G0BHP.clustalo.fasta.backup > per_gene/EOG091G0BHP/ALICUT_EOG091G0BHP.clustalo.fasta
         fi
         touch per_gene/EOG091G0BHP/empty_check.done
         
[Sun Jul  5 22:33:21 2020]
Finished job 1399.
1167 of 3292 steps (35%) done

[Sun Jul  5 22:33:21 2020]
rule find_best_model:
    input: per_gene/EOG091G0BHP/ALICUT_EOG091G0BHP.clustalo.fasta, per_gene/EOG091G0BHP/empty_check.done
    output: per_gene/EOG091G0BHP/EOG091G0BHP.best_model
    log: per_gene/EOG091G0BHP/find_best_model.stderr.txt
    jobid: 576
    wildcards: BUSCO=EOG091G0BHP
    threads: 2


        cd per_gene/EOG091G0BHP
        if [ ! -d find_best_model ]
        then
            mkdir find_best_model
        fi
        cd find_best_model
        ln -s ../../../per_gene/EOG091G0BHP/ALICUT_EOG091G0BHP.clustalo.fasta EOG091G0BHP.fasta
        ProteinModelSelection.pl EOG091G0BHP.fasta 1> ../../../per_gene/EOG091G0BHP/EOG091G0BHP.best_model 2> ../../../per_gene/EOG091G0BHP/find_best_model.stderr.txt
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/c0c09ee657b1e27f2c5687e0e9aa8d70.simg
[Sun Jul  5 22:33:23 2020]
Finished job 720.
1168 of 3292 steps (35%) done

[Sun Jul  5 22:33:23 2020]
rule infer_single_ML:
    input: per_gene/EOG091G0MY8/EOG091G0MY8.best_model, per_gene/EOG091G0MY8/ALICUT_EOG091G0MY8.clustalo.fasta
    output: per_gene/EOG091G0MY8/EOG091G0MY8.raxml.done
    log: per_gene/EOG091G0MY8/infer_single_ML.stdout.txt, per_gene/EOG091G0MY8/infer_single_ML.stderr.txt
    jobid: 154
    wildcards: BUSCO=EOG091G0MY8
    threads: 2


        cd per_gene/EOG091G0MY8
	count=$(cat ../../per_gene/EOG091G0MY8/ALICUT_EOG091G0MY8.clustalo.fasta | grep ">" | wc -l)
	if [ "$count" -gt 5 ]
        then
		RAxMLmodel=$(cat ../../per_gene/EOG091G0MY8/EOG091G0MY8.best_model | grep "Best" | cut -d ":" -f 2 | tr -d '[:space:]')
                if [ "$(ls -1 | grep "^RAxML" | wc -l)" -ne 0 ]
		then
			rm RAxML*
		fi
        	raxml -f a -T 2 -m PROTGAMMA$RAxMLmodel         	-p 12345 -x 12345 -# 100         	-s ../../per_gene/EOG091G0MY8/ALICUT_EOG091G0MY8.clustalo.fasta -n EOG091G0MY8.clustalo.aln.ALICUT.$RAxMLmodel 		1> ../../per_gene/EOG091G0MY8/infer_single_ML.stdout.txt 2> ../../per_gene/EOG091G0MY8/infer_single_ML.stderr.txt
	else
		echo "fasta file per_gene/EOG091G0MY8/ALICUT_EOG091G0MY8.clustalo.fasta contains fewer than 5 sequences - skipped" > ../../per_gene/EOG091G0MY8/infer_single_ML.stdout.txt
		touch raxml.skipped
	fi
        touch ../../per_gene/EOG091G0MY8/EOG091G0MY8.raxml.done
        
[33mJob counts:
	count	jobs
	1	infer_single_ML
	1[0m
[33m
        cd per_gene/EOG091G0MY8
	count=$(cat ../../per_gene/EOG091G0MY8/ALICUT_EOG091G0MY8.clustalo.fasta | grep ">" | wc -l)
	if [ "$count" -gt 5 ]
        then
		RAxMLmodel=$(cat ../../per_gene/EOG091G0MY8/EOG091G0MY8.best_model | grep "Best" | cut -d ":" -f 2 | tr -d '[:space:]')
                if [ "$(ls -1 | grep "^RAxML" | wc -l)" -ne 0 ]
		then
			rm RAxML*
		fi
        	raxml -f a -T 2 -m PROTGAMMA$RAxMLmodel         	-p 12345 -x 12345 -# 100         	-s ../../per_gene/EOG091G0MY8/ALICUT_EOG091G0MY8.clustalo.fasta -n EOG091G0MY8.clustalo.aln.ALICUT.$RAxMLmodel 		1> ../../per_gene/EOG091G0MY8/infer_single_ML.stdout.txt 2> ../../per_gene/EOG091G0MY8/infer_single_ML.stderr.txt
	else
		echo "fasta file per_gene/EOG091G0MY8/ALICUT_EOG091G0MY8.clustalo.fasta contains fewer than 5 sequences - skipped" > ../../per_gene/EOG091G0MY8/infer_single_ML.stdout.txt
		touch raxml.skipped
	fi
        touch ../../per_gene/EOG091G0MY8/EOG091G0MY8.raxml.done
        [0m
[Sun Jul  5 22:33:24 2020]
Finished job 2566.
1169 of 3292 steps (36%) done

[Sun Jul  5 22:33:24 2020]
rule get_outgroups:
    input: per_gene/EOG091G06U0/EOG091G06U0.ingroup.fasta
    output: per_gene/EOG091G06U0/EOG091G06U0.orthodb.fasta, per_gene/EOG091G06U0/EOG091G06U0.outgroup.fasta
    log: per_gene/EOG091G06U0/get_outgroups.stdout.txt, per_gene/EOG091G06U0/get_outgroups.stderr.txt
    jobid: 2567
    wildcards: BUSCO=EOG091G06U0


        #download fastas from Orhtodb for BUSCO id
        for i in {1..5}
        do
             wget "http://www.orthodb.org/fasta?query=EOG091G06U0&level=33208" -O per_gene/EOG091G06U0/EOG091G06U0.orthodb.fasta 1> per_gene/EOG091G06U0/get_outgroups.stdout.txt 2> per_gene/EOG091G06U0/get_outgroups.stderr.txt && break || echo -e "try again ($i)" && sleep 15
        done

	#This is quick an dirty for now and just takes the first protein if there is more than one for an outgroup taxon
        bash ../scripts/download_outgroups.sh taxids.txt per_gene/EOG091G06U0/EOG091G06U0.orthodb.fasta > per_gene/EOG091G06U0/EOG091G06U0.outgroup.fasta
        
[Sun Jul  5 22:33:26 2020]
Finished job 2567.
1170 of 3292 steps (36%) done

[Sun Jul  5 22:33:26 2020]
rule join_groups:
    input: per_gene/EOG091G06U0/EOG091G06U0.ingroup.fasta, per_gene/EOG091G06U0/EOG091G06U0.outgroup.fasta
    output: per_gene/EOG091G06U0/EOG091G06U0.fasta
    jobid: 2107
    wildcards: BUSCO=EOG091G06U0


        cat per_gene/EOG091G06U0/EOG091G06U0.ingroup.fasta per_gene/EOG091G06U0/EOG091G06U0.outgroup.fasta > per_gene/EOG091G06U0/EOG091G06U0.fasta
        
[Sun Jul  5 22:33:26 2020]
Finished job 2107.
1171 of 3292 steps (36%) done

[Sun Jul  5 22:33:26 2020]
rule MSA:
    input: per_gene/EOG091G06U0/EOG091G06U0.fasta
    output: per_gene/EOG091G06U0/EOG091G06U0.clustalo.fasta
    log: per_gene/EOG091G06U0/MSA.stdout.txt, per_gene/EOG091G06U0/MSA.stderr.txt
    jobid: 1334
    wildcards: BUSCO=EOG091G06U0
    threads: 2


        clustalo -i per_gene/EOG091G06U0/EOG091G06U0.fasta -o per_gene/EOG091G06U0/EOG091G06U0.clustalo.fasta --threads=2 1> per_gene/EOG091G06U0/MSA.stdout.txt 2> per_gene/EOG091G06U0/MSA.stderr.txt
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/d68c9691725a7401923680874285c430.simg
[Sun Jul  5 22:33:27 2020]
Finished job 1334.
1172 of 3292 steps (36%) done

[Sun Jul  5 22:33:27 2020]
rule score_and_cut:
    input: per_gene/EOG091G06U0/EOG091G06U0.clustalo.fasta
    output: per_gene/EOG091G06U0/ALICUT_EOG091G06U0.clustalo.fasta
    jobid: 511
    wildcards: BUSCO=EOG091G06U0
    threads: 2


        cd per_gene/EOG091G06U0
        Aliscore.pl -N -r 200000000000000000 -i ../../per_gene/EOG091G06U0/EOG091G06U0.clustalo.fasta &> aliscore.log
        ALICUT.pl -s &> alicut.log
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/63c88c27a0fa300f57066b0ef65fefcb.simg
[Sun Jul  5 22:33:37 2020]
Finished job 511.
1173 of 3292 steps (36%) done

[Sun Jul  5 22:33:37 2020]
rule remove_empty:
    input: per_gene/EOG091G06U0/ALICUT_EOG091G06U0.clustalo.fasta
    output: per_gene/EOG091G06U0/empty_check.done
    jobid: 1333
    wildcards: BUSCO=EOG091G06U0


         if [ "$(cat per_gene/EOG091G06U0/ALICUT_EOG091G06U0.clustalo.fasta | grep -v ">" | sed 's/-//g' | grep "^$" | wc -l)" -gt 0 ]
         then
              cp per_gene/EOG091G06U0/ALICUT_EOG091G06U0.clustalo.fasta per_gene/EOG091G06U0/ALICUT_EOG091G06U0.clustalo.fasta.backup
              bash ../scripts/remove_empty.sh per_gene/EOG091G06U0/ALICUT_EOG091G06U0.clustalo.fasta.backup > per_gene/EOG091G06U0/ALICUT_EOG091G06U0.clustalo.fasta
         fi
         touch per_gene/EOG091G06U0/empty_check.done
         
[Sun Jul  5 22:33:37 2020]
Finished job 1333.
1174 of 3292 steps (36%) done

[Sun Jul  5 22:33:37 2020]
rule find_best_model:
    input: per_gene/EOG091G06U0/ALICUT_EOG091G06U0.clustalo.fasta, per_gene/EOG091G06U0/empty_check.done
    output: per_gene/EOG091G06U0/EOG091G06U0.best_model
    log: per_gene/EOG091G06U0/find_best_model.stderr.txt
    jobid: 510
    wildcards: BUSCO=EOG091G06U0
    threads: 2


        cd per_gene/EOG091G06U0
        if [ ! -d find_best_model ]
        then
            mkdir find_best_model
        fi
        cd find_best_model
        ln -s ../../../per_gene/EOG091G06U0/ALICUT_EOG091G06U0.clustalo.fasta EOG091G06U0.fasta
        ProteinModelSelection.pl EOG091G06U0.fasta 1> ../../../per_gene/EOG091G06U0/EOG091G06U0.best_model 2> ../../../per_gene/EOG091G06U0/find_best_model.stderr.txt
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/c0c09ee657b1e27f2c5687e0e9aa8d70.simg
[Sun Jul  5 22:34:03 2020]
Finished job 576.
1175 of 3292 steps (36%) done

[Sun Jul  5 22:34:03 2020]
rule infer_single_ML:
    input: per_gene/EOG091G0BHP/EOG091G0BHP.best_model, per_gene/EOG091G0BHP/ALICUT_EOG091G0BHP.clustalo.fasta
    output: per_gene/EOG091G0BHP/EOG091G0BHP.raxml.done
    log: per_gene/EOG091G0BHP/infer_single_ML.stdout.txt, per_gene/EOG091G0BHP/infer_single_ML.stderr.txt
    jobid: 82
    wildcards: BUSCO=EOG091G0BHP
    threads: 2


        cd per_gene/EOG091G0BHP
	count=$(cat ../../per_gene/EOG091G0BHP/ALICUT_EOG091G0BHP.clustalo.fasta | grep ">" | wc -l)
	if [ "$count" -gt 5 ]
        then
		RAxMLmodel=$(cat ../../per_gene/EOG091G0BHP/EOG091G0BHP.best_model | grep "Best" | cut -d ":" -f 2 | tr -d '[:space:]')
                if [ "$(ls -1 | grep "^RAxML" | wc -l)" -ne 0 ]
		then
			rm RAxML*
		fi
        	raxml -f a -T 2 -m PROTGAMMA$RAxMLmodel         	-p 12345 -x 12345 -# 100         	-s ../../per_gene/EOG091G0BHP/ALICUT_EOG091G0BHP.clustalo.fasta -n EOG091G0BHP.clustalo.aln.ALICUT.$RAxMLmodel 		1> ../../per_gene/EOG091G0BHP/infer_single_ML.stdout.txt 2> ../../per_gene/EOG091G0BHP/infer_single_ML.stderr.txt
	else
		echo "fasta file per_gene/EOG091G0BHP/ALICUT_EOG091G0BHP.clustalo.fasta contains fewer than 5 sequences - skipped" > ../../per_gene/EOG091G0BHP/infer_single_ML.stdout.txt
		touch raxml.skipped
	fi
        touch ../../per_gene/EOG091G0BHP/EOG091G0BHP.raxml.done
        
[33mJob counts:
	count	jobs
	1	infer_single_ML
	1[0m
[33m
        cd per_gene/EOG091G0BHP
	count=$(cat ../../per_gene/EOG091G0BHP/ALICUT_EOG091G0BHP.clustalo.fasta | grep ">" | wc -l)
	if [ "$count" -gt 5 ]
        then
		RAxMLmodel=$(cat ../../per_gene/EOG091G0BHP/EOG091G0BHP.best_model | grep "Best" | cut -d ":" -f 2 | tr -d '[:space:]')
                if [ "$(ls -1 | grep "^RAxML" | wc -l)" -ne 0 ]
		then
			rm RAxML*
		fi
        	raxml -f a -T 2 -m PROTGAMMA$RAxMLmodel         	-p 12345 -x 12345 -# 100         	-s ../../per_gene/EOG091G0BHP/ALICUT_EOG091G0BHP.clustalo.fasta -n EOG091G0BHP.clustalo.aln.ALICUT.$RAxMLmodel 		1> ../../per_gene/EOG091G0BHP/infer_single_ML.stdout.txt 2> ../../per_gene/EOG091G0BHP/infer_single_ML.stderr.txt
	else
		echo "fasta file per_gene/EOG091G0BHP/ALICUT_EOG091G0BHP.clustalo.fasta contains fewer than 5 sequences - skipped" > ../../per_gene/EOG091G0BHP/infer_single_ML.stdout.txt
		touch raxml.skipped
	fi
        touch ../../per_gene/EOG091G0BHP/EOG091G0BHP.raxml.done
        [0m
[Sun Jul  5 22:34:32 2020]
Finished job 510.
1176 of 3292 steps (36%) done

[Sun Jul  5 22:34:32 2020]
rule infer_single_ML:
    input: per_gene/EOG091G06U0/EOG091G06U0.best_model, per_gene/EOG091G06U0/ALICUT_EOG091G06U0.clustalo.fasta
    output: per_gene/EOG091G06U0/EOG091G06U0.raxml.done
    log: per_gene/EOG091G06U0/infer_single_ML.stdout.txt, per_gene/EOG091G06U0/infer_single_ML.stderr.txt
    jobid: 49
    wildcards: BUSCO=EOG091G06U0
    threads: 2


        cd per_gene/EOG091G06U0
	count=$(cat ../../per_gene/EOG091G06U0/ALICUT_EOG091G06U0.clustalo.fasta | grep ">" | wc -l)
	if [ "$count" -gt 5 ]
        then
		RAxMLmodel=$(cat ../../per_gene/EOG091G06U0/EOG091G06U0.best_model | grep "Best" | cut -d ":" -f 2 | tr -d '[:space:]')
                if [ "$(ls -1 | grep "^RAxML" | wc -l)" -ne 0 ]
		then
			rm RAxML*
		fi
        	raxml -f a -T 2 -m PROTGAMMA$RAxMLmodel         	-p 12345 -x 12345 -# 100         	-s ../../per_gene/EOG091G06U0/ALICUT_EOG091G06U0.clustalo.fasta -n EOG091G06U0.clustalo.aln.ALICUT.$RAxMLmodel 		1> ../../per_gene/EOG091G06U0/infer_single_ML.stdout.txt 2> ../../per_gene/EOG091G06U0/infer_single_ML.stderr.txt
	else
		echo "fasta file per_gene/EOG091G06U0/ALICUT_EOG091G06U0.clustalo.fasta contains fewer than 5 sequences - skipped" > ../../per_gene/EOG091G06U0/infer_single_ML.stdout.txt
		touch raxml.skipped
	fi
        touch ../../per_gene/EOG091G06U0/EOG091G06U0.raxml.done
        
[33mJob counts:
	count	jobs
	1	infer_single_ML
	1[0m
[33m
        cd per_gene/EOG091G06U0
	count=$(cat ../../per_gene/EOG091G06U0/ALICUT_EOG091G06U0.clustalo.fasta | grep ">" | wc -l)
	if [ "$count" -gt 5 ]
        then
		RAxMLmodel=$(cat ../../per_gene/EOG091G06U0/EOG091G06U0.best_model | grep "Best" | cut -d ":" -f 2 | tr -d '[:space:]')
                if [ "$(ls -1 | grep "^RAxML" | wc -l)" -ne 0 ]
		then
			rm RAxML*
		fi
        	raxml -f a -T 2 -m PROTGAMMA$RAxMLmodel         	-p 12345 -x 12345 -# 100         	-s ../../per_gene/EOG091G06U0/ALICUT_EOG091G06U0.clustalo.fasta -n EOG091G06U0.clustalo.aln.ALICUT.$RAxMLmodel 		1> ../../per_gene/EOG091G06U0/infer_single_ML.stdout.txt 2> ../../per_gene/EOG091G06U0/infer_single_ML.stderr.txt
	else
		echo "fasta file per_gene/EOG091G06U0/ALICUT_EOG091G06U0.clustalo.fasta contains fewer than 5 sequences - skipped" > ../../per_gene/EOG091G06U0/infer_single_ML.stdout.txt
		touch raxml.skipped
	fi
        touch ../../per_gene/EOG091G06U0/EOG091G06U0.raxml.done
        [0m
[Sun Jul  5 22:35:10 2020]
Finished job 111.
1177 of 3292 steps (36%) done

[Sun Jul  5 22:35:10 2020]
rule get_seqs:
    input: /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ingroup.txt, /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/outgroup.txt
    output: per_gene/EOG091G05IK/EOG091G05IK.ingroup.fasta
    log: per_gene/EOG091G05IK/get_seqs.stdout.txt, per_gene/EOG091G05IK/get_seqs.stderr.txt
    jobid: 3140
    wildcards: BUSCO=EOG091G05IK
    threads: 2


	basedir=$(pwd)
        cd per_gene/EOG091G05IK
        
        bash $basedir/../scripts/fetch_seqs.sh EOG091G05IK /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ingroup.txt /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/outgroup.txt 1> ../../per_gene/EOG091G05IK/get_seqs.stdout.txt 2> ../../per_gene/EOG091G05IK/get_seqs.stderr.txt
	mv EOG091G05IK.fasta $basedir/per_gene/EOG091G05IK/EOG091G05IK.ingroup.fasta
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/72476f9d9a5bd0627b4d721143a21354.simg
[Sun Jul  5 22:35:14 2020]
Finished job 41.
1178 of 3292 steps (36%) done

[Sun Jul  5 22:35:14 2020]
rule get_seqs:
    input: /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ingroup.txt, /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/outgroup.txt
    output: per_gene/EOG091G0BUD/EOG091G0BUD.ingroup.fasta
    log: per_gene/EOG091G0BUD/get_seqs.stdout.txt, per_gene/EOG091G0BUD/get_seqs.stderr.txt
    jobid: 2638
    wildcards: BUSCO=EOG091G0BUD
    threads: 2


	basedir=$(pwd)
        cd per_gene/EOG091G0BUD
        
        bash $basedir/../scripts/fetch_seqs.sh EOG091G0BUD /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ingroup.txt /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/outgroup.txt 1> ../../per_gene/EOG091G0BUD/get_seqs.stdout.txt 2> ../../per_gene/EOG091G0BUD/get_seqs.stderr.txt
	mv EOG091G0BUD.fasta $basedir/per_gene/EOG091G0BUD/EOG091G0BUD.ingroup.fasta
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/72476f9d9a5bd0627b4d721143a21354.simg
[Sun Jul  5 22:35:24 2020]
Finished job 180.
1179 of 3292 steps (36%) done

[Sun Jul  5 22:35:24 2020]
rule get_seqs:
    input: /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ingroup.txt, /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/outgroup.txt
    output: per_gene/EOG091G115J/EOG091G115J.ingroup.fasta
    log: per_gene/EOG091G115J/get_seqs.stdout.txt, per_gene/EOG091G115J/get_seqs.stderr.txt
    jobid: 3258
    wildcards: BUSCO=EOG091G115J
    threads: 2


	basedir=$(pwd)
        cd per_gene/EOG091G115J
        
        bash $basedir/../scripts/fetch_seqs.sh EOG091G115J /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ingroup.txt /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/outgroup.txt 1> ../../per_gene/EOG091G115J/get_seqs.stdout.txt 2> ../../per_gene/EOG091G115J/get_seqs.stderr.txt
	mv EOG091G115J.fasta $basedir/per_gene/EOG091G115J/EOG091G115J.ingroup.fasta
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/72476f9d9a5bd0627b4d721143a21354.simg
[Sun Jul  5 22:35:25 2020]
Finished job 3140.
1180 of 3292 steps (36%) done

[Sun Jul  5 22:35:25 2020]
rule get_outgroups:
    input: per_gene/EOG091G05IK/EOG091G05IK.ingroup.fasta
    output: per_gene/EOG091G05IK/EOG091G05IK.orthodb.fasta, per_gene/EOG091G05IK/EOG091G05IK.outgroup.fasta
    log: per_gene/EOG091G05IK/get_outgroups.stdout.txt, per_gene/EOG091G05IK/get_outgroups.stderr.txt
    jobid: 3141
    wildcards: BUSCO=EOG091G05IK


        #download fastas from Orhtodb for BUSCO id
        for i in {1..5}
        do
             wget "http://www.orthodb.org/fasta?query=EOG091G05IK&level=33208" -O per_gene/EOG091G05IK/EOG091G05IK.orthodb.fasta 1> per_gene/EOG091G05IK/get_outgroups.stdout.txt 2> per_gene/EOG091G05IK/get_outgroups.stderr.txt && break || echo -e "try again ($i)" && sleep 15
        done

	#This is quick an dirty for now and just takes the first protein if there is more than one for an outgroup taxon
        bash ../scripts/download_outgroups.sh taxids.txt per_gene/EOG091G05IK/EOG091G05IK.orthodb.fasta > per_gene/EOG091G05IK/EOG091G05IK.outgroup.fasta
        
[Sun Jul  5 22:35:27 2020]
Finished job 3141.
1181 of 3292 steps (36%) done

[Sun Jul  5 22:35:27 2020]
rule join_groups:
    input: per_gene/EOG091G05IK/EOG091G05IK.ingroup.fasta, per_gene/EOG091G05IK/EOG091G05IK.outgroup.fasta
    output: per_gene/EOG091G05IK/EOG091G05IK.fasta
    jobid: 2394
    wildcards: BUSCO=EOG091G05IK


        cat per_gene/EOG091G05IK/EOG091G05IK.ingroup.fasta per_gene/EOG091G05IK/EOG091G05IK.outgroup.fasta > per_gene/EOG091G05IK/EOG091G05IK.fasta
        
[Sun Jul  5 22:35:27 2020]
Finished job 2394.
1182 of 3292 steps (36%) done

[Sun Jul  5 22:35:27 2020]
rule MSA:
    input: per_gene/EOG091G05IK/EOG091G05IK.fasta
    output: per_gene/EOG091G05IK/EOG091G05IK.clustalo.fasta
    log: per_gene/EOG091G05IK/MSA.stdout.txt, per_gene/EOG091G05IK/MSA.stderr.txt
    jobid: 1908
    wildcards: BUSCO=EOG091G05IK
    threads: 2


        clustalo -i per_gene/EOG091G05IK/EOG091G05IK.fasta -o per_gene/EOG091G05IK/EOG091G05IK.clustalo.fasta --threads=2 1> per_gene/EOG091G05IK/MSA.stdout.txt 2> per_gene/EOG091G05IK/MSA.stderr.txt
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/d68c9691725a7401923680874285c430.simg
[Sun Jul  5 22:35:28 2020]
Finished job 2638.
1183 of 3292 steps (36%) done

[Sun Jul  5 22:35:28 2020]
rule get_outgroups:
    input: per_gene/EOG091G0BUD/EOG091G0BUD.ingroup.fasta
    output: per_gene/EOG091G0BUD/EOG091G0BUD.orthodb.fasta, per_gene/EOG091G0BUD/EOG091G0BUD.outgroup.fasta
    log: per_gene/EOG091G0BUD/get_outgroups.stdout.txt, per_gene/EOG091G0BUD/get_outgroups.stderr.txt
    jobid: 2639
    wildcards: BUSCO=EOG091G0BUD


        #download fastas from Orhtodb for BUSCO id
        for i in {1..5}
        do
             wget "http://www.orthodb.org/fasta?query=EOG091G0BUD&level=33208" -O per_gene/EOG091G0BUD/EOG091G0BUD.orthodb.fasta 1> per_gene/EOG091G0BUD/get_outgroups.stdout.txt 2> per_gene/EOG091G0BUD/get_outgroups.stderr.txt && break || echo -e "try again ($i)" && sleep 15
        done

	#This is quick an dirty for now and just takes the first protein if there is more than one for an outgroup taxon
        bash ../scripts/download_outgroups.sh taxids.txt per_gene/EOG091G0BUD/EOG091G0BUD.orthodb.fasta > per_gene/EOG091G0BUD/EOG091G0BUD.outgroup.fasta
        
[Sun Jul  5 22:35:28 2020]
Finished job 1908.
1184 of 3292 steps (36%) done

[Sun Jul  5 22:35:28 2020]
rule score_and_cut:
    input: per_gene/EOG091G05IK/EOG091G05IK.clustalo.fasta
    output: per_gene/EOG091G05IK/ALICUT_EOG091G05IK.clustalo.fasta
    jobid: 1085
    wildcards: BUSCO=EOG091G05IK
    threads: 2


        cd per_gene/EOG091G05IK
        Aliscore.pl -N -r 200000000000000000 -i ../../per_gene/EOG091G05IK/EOG091G05IK.clustalo.fasta &> aliscore.log
        ALICUT.pl -s &> alicut.log
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/63c88c27a0fa300f57066b0ef65fefcb.simg
[Sun Jul  5 22:35:29 2020]
Finished job 2639.
1185 of 3292 steps (36%) done

[Sun Jul  5 22:35:29 2020]
rule join_groups:
    input: per_gene/EOG091G0BUD/EOG091G0BUD.ingroup.fasta, per_gene/EOG091G0BUD/EOG091G0BUD.outgroup.fasta
    output: per_gene/EOG091G0BUD/EOG091G0BUD.fasta
    jobid: 2143
    wildcards: BUSCO=EOG091G0BUD


        cat per_gene/EOG091G0BUD/EOG091G0BUD.ingroup.fasta per_gene/EOG091G0BUD/EOG091G0BUD.outgroup.fasta > per_gene/EOG091G0BUD/EOG091G0BUD.fasta
        
[Sun Jul  5 22:35:29 2020]
Finished job 2143.
1186 of 3292 steps (36%) done

[Sun Jul  5 22:35:29 2020]
rule MSA:
    input: per_gene/EOG091G0BUD/EOG091G0BUD.fasta
    output: per_gene/EOG091G0BUD/EOG091G0BUD.clustalo.fasta
    log: per_gene/EOG091G0BUD/MSA.stdout.txt, per_gene/EOG091G0BUD/MSA.stderr.txt
    jobid: 1406
    wildcards: BUSCO=EOG091G0BUD
    threads: 2


        clustalo -i per_gene/EOG091G0BUD/EOG091G0BUD.fasta -o per_gene/EOG091G0BUD/EOG091G0BUD.clustalo.fasta --threads=2 1> per_gene/EOG091G0BUD/MSA.stdout.txt 2> per_gene/EOG091G0BUD/MSA.stderr.txt
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/d68c9691725a7401923680874285c430.simg
[Sun Jul  5 22:35:32 2020]
Finished job 1406.
1187 of 3292 steps (36%) done

[Sun Jul  5 22:35:32 2020]
rule score_and_cut:
    input: per_gene/EOG091G0BUD/EOG091G0BUD.clustalo.fasta
    output: per_gene/EOG091G0BUD/ALICUT_EOG091G0BUD.clustalo.fasta
    jobid: 583
    wildcards: BUSCO=EOG091G0BUD
    threads: 2


        cd per_gene/EOG091G0BUD
        Aliscore.pl -N -r 200000000000000000 -i ../../per_gene/EOG091G0BUD/EOG091G0BUD.clustalo.fasta &> aliscore.log
        ALICUT.pl -s &> alicut.log
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/63c88c27a0fa300f57066b0ef65fefcb.simg
[Sun Jul  5 22:35:38 2020]
Finished job 3258.
1188 of 3292 steps (36%) done

[Sun Jul  5 22:35:38 2020]
rule get_outgroups:
    input: per_gene/EOG091G115J/EOG091G115J.ingroup.fasta
    output: per_gene/EOG091G115J/EOG091G115J.orthodb.fasta, per_gene/EOG091G115J/EOG091G115J.outgroup.fasta
    log: per_gene/EOG091G115J/get_outgroups.stdout.txt, per_gene/EOG091G115J/get_outgroups.stderr.txt
    jobid: 3259
    wildcards: BUSCO=EOG091G115J


        #download fastas from Orhtodb for BUSCO id
        for i in {1..5}
        do
             wget "http://www.orthodb.org/fasta?query=EOG091G115J&level=33208" -O per_gene/EOG091G115J/EOG091G115J.orthodb.fasta 1> per_gene/EOG091G115J/get_outgroups.stdout.txt 2> per_gene/EOG091G115J/get_outgroups.stderr.txt && break || echo -e "try again ($i)" && sleep 15
        done

	#This is quick an dirty for now and just takes the first protein if there is more than one for an outgroup taxon
        bash ../scripts/download_outgroups.sh taxids.txt per_gene/EOG091G115J/EOG091G115J.orthodb.fasta > per_gene/EOG091G115J/EOG091G115J.outgroup.fasta
        
[Sun Jul  5 22:35:38 2020]
Finished job 3259.
1189 of 3292 steps (36%) done

[Sun Jul  5 22:35:38 2020]
rule join_groups:
    input: per_gene/EOG091G115J/EOG091G115J.ingroup.fasta, per_gene/EOG091G115J/EOG091G115J.outgroup.fasta
    output: per_gene/EOG091G115J/EOG091G115J.fasta
    jobid: 2453
    wildcards: BUSCO=EOG091G115J


        cat per_gene/EOG091G115J/EOG091G115J.ingroup.fasta per_gene/EOG091G115J/EOG091G115J.outgroup.fasta > per_gene/EOG091G115J/EOG091G115J.fasta
        
[Sun Jul  5 22:35:39 2020]
Finished job 2453.
1190 of 3292 steps (36%) done

[Sun Jul  5 22:35:39 2020]
rule MSA:
    input: per_gene/EOG091G115J/EOG091G115J.fasta
    output: per_gene/EOG091G115J/EOG091G115J.clustalo.fasta
    log: per_gene/EOG091G115J/MSA.stdout.txt, per_gene/EOG091G115J/MSA.stderr.txt
    jobid: 2026
    wildcards: BUSCO=EOG091G115J
    threads: 2


        clustalo -i per_gene/EOG091G115J/EOG091G115J.fasta -o per_gene/EOG091G115J/EOG091G115J.clustalo.fasta --threads=2 1> per_gene/EOG091G115J/MSA.stdout.txt 2> per_gene/EOG091G115J/MSA.stderr.txt
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/d68c9691725a7401923680874285c430.simg
[Sun Jul  5 22:35:39 2020]
Finished job 1085.
1191 of 3292 steps (36%) done

[Sun Jul  5 22:35:39 2020]
rule remove_empty:
    input: per_gene/EOG091G05IK/ALICUT_EOG091G05IK.clustalo.fasta
    output: per_gene/EOG091G05IK/empty_check.done
    jobid: 1907
    wildcards: BUSCO=EOG091G05IK


         if [ "$(cat per_gene/EOG091G05IK/ALICUT_EOG091G05IK.clustalo.fasta | grep -v ">" | sed 's/-//g' | grep "^$" | wc -l)" -gt 0 ]
         then
              cp per_gene/EOG091G05IK/ALICUT_EOG091G05IK.clustalo.fasta per_gene/EOG091G05IK/ALICUT_EOG091G05IK.clustalo.fasta.backup
              bash ../scripts/remove_empty.sh per_gene/EOG091G05IK/ALICUT_EOG091G05IK.clustalo.fasta.backup > per_gene/EOG091G05IK/ALICUT_EOG091G05IK.clustalo.fasta
         fi
         touch per_gene/EOG091G05IK/empty_check.done
         
[Sun Jul  5 22:35:39 2020]
Finished job 1907.
1192 of 3292 steps (36%) done

[Sun Jul  5 22:35:39 2020]
rule find_best_model:
    input: per_gene/EOG091G05IK/ALICUT_EOG091G05IK.clustalo.fasta, per_gene/EOG091G05IK/empty_check.done
    output: per_gene/EOG091G05IK/EOG091G05IK.best_model
    log: per_gene/EOG091G05IK/find_best_model.stderr.txt
    jobid: 1084
    wildcards: BUSCO=EOG091G05IK
    threads: 2


        cd per_gene/EOG091G05IK
        if [ ! -d find_best_model ]
        then
            mkdir find_best_model
        fi
        cd find_best_model
        ln -s ../../../per_gene/EOG091G05IK/ALICUT_EOG091G05IK.clustalo.fasta EOG091G05IK.fasta
        ProteinModelSelection.pl EOG091G05IK.fasta 1> ../../../per_gene/EOG091G05IK/EOG091G05IK.best_model 2> ../../../per_gene/EOG091G05IK/find_best_model.stderr.txt
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/c0c09ee657b1e27f2c5687e0e9aa8d70.simg
[Sun Jul  5 22:35:43 2020]
Finished job 583.
1193 of 3292 steps (36%) done

[Sun Jul  5 22:35:43 2020]
rule remove_empty:
    input: per_gene/EOG091G0BUD/ALICUT_EOG091G0BUD.clustalo.fasta
    output: per_gene/EOG091G0BUD/empty_check.done
    jobid: 1405
    wildcards: BUSCO=EOG091G0BUD


         if [ "$(cat per_gene/EOG091G0BUD/ALICUT_EOG091G0BUD.clustalo.fasta | grep -v ">" | sed 's/-//g' | grep "^$" | wc -l)" -gt 0 ]
         then
              cp per_gene/EOG091G0BUD/ALICUT_EOG091G0BUD.clustalo.fasta per_gene/EOG091G0BUD/ALICUT_EOG091G0BUD.clustalo.fasta.backup
              bash ../scripts/remove_empty.sh per_gene/EOG091G0BUD/ALICUT_EOG091G0BUD.clustalo.fasta.backup > per_gene/EOG091G0BUD/ALICUT_EOG091G0BUD.clustalo.fasta
         fi
         touch per_gene/EOG091G0BUD/empty_check.done
         
[Sun Jul  5 22:36:02 2020]
Finished job 202.
1194 of 3292 steps (36%) done
[Sun Jul  5 22:36:02 2020]
Finished job 55.
1195 of 3292 steps (36%) done

[Sun Jul  5 22:36:02 2020]
rule get_seqs:
    input: /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ingroup.txt, /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/outgroup.txt
    output: per_gene/EOG091G0RTZ/EOG091G0RTZ.ingroup.fasta
    log: per_gene/EOG091G0RTZ/get_seqs.stdout.txt, per_gene/EOG091G0RTZ/get_seqs.stderr.txt
    jobid: 2840
    wildcards: BUSCO=EOG091G0RTZ
    threads: 2


	basedir=$(pwd)
        cd per_gene/EOG091G0RTZ
        
        bash $basedir/../scripts/fetch_seqs.sh EOG091G0RTZ /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ingroup.txt /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/outgroup.txt 1> ../../per_gene/EOG091G0RTZ/get_seqs.stdout.txt 2> ../../per_gene/EOG091G0RTZ/get_seqs.stderr.txt
	mv EOG091G0RTZ.fasta $basedir/per_gene/EOG091G0RTZ/EOG091G0RTZ.ingroup.fasta
        

Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/72476f9d9a5bd0627b4d721143a21354.simg
[Sun Jul  5 22:36:02 2020]
rule get_seqs:
    input: /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ingroup.txt, /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/outgroup.txt
    output: per_gene/EOG091G07VQ/EOG091G07VQ.ingroup.fasta
    log: per_gene/EOG091G07VQ/get_seqs.stdout.txt, per_gene/EOG091G07VQ/get_seqs.stderr.txt
    jobid: 2584
    wildcards: BUSCO=EOG091G07VQ
    threads: 2


	basedir=$(pwd)
        cd per_gene/EOG091G07VQ
        
        bash $basedir/../scripts/fetch_seqs.sh EOG091G07VQ /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ingroup.txt /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/outgroup.txt 1> ../../per_gene/EOG091G07VQ/get_seqs.stdout.txt 2> ../../per_gene/EOG091G07VQ/get_seqs.stderr.txt
	mv EOG091G07VQ.fasta $basedir/per_gene/EOG091G07VQ/EOG091G07VQ.ingroup.fasta
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/72476f9d9a5bd0627b4d721143a21354.simg
[Sun Jul  5 22:36:02 2020]
Finished job 1405.
1196 of 3292 steps (36%) done

[Sun Jul  5 22:36:02 2020]
rule find_best_model:
    input: per_gene/EOG091G0BUD/ALICUT_EOG091G0BUD.clustalo.fasta, per_gene/EOG091G0BUD/empty_check.done
    output: per_gene/EOG091G0BUD/EOG091G0BUD.best_model
    log: per_gene/EOG091G0BUD/find_best_model.stderr.txt
    jobid: 582
    wildcards: BUSCO=EOG091G0BUD
    threads: 2


        cd per_gene/EOG091G0BUD
        if [ ! -d find_best_model ]
        then
            mkdir find_best_model
        fi
        cd find_best_model
        ln -s ../../../per_gene/EOG091G0BUD/ALICUT_EOG091G0BUD.clustalo.fasta EOG091G0BUD.fasta
        ProteinModelSelection.pl EOG091G0BUD.fasta 1> ../../../per_gene/EOG091G0BUD/EOG091G0BUD.best_model 2> ../../../per_gene/EOG091G0BUD/find_best_model.stderr.txt
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/c0c09ee657b1e27f2c5687e0e9aa8d70.simg
[Sun Jul  5 22:36:03 2020]
Finished job 2026.
1197 of 3292 steps (36%) done

[Sun Jul  5 22:36:03 2020]
rule score_and_cut:
    input: per_gene/EOG091G115J/EOG091G115J.clustalo.fasta
    output: per_gene/EOG091G115J/ALICUT_EOG091G115J.clustalo.fasta
    jobid: 1203
    wildcards: BUSCO=EOG091G115J
    threads: 2


        cd per_gene/EOG091G115J
        Aliscore.pl -N -r 200000000000000000 -i ../../per_gene/EOG091G115J/EOG091G115J.clustalo.fasta &> aliscore.log
        ALICUT.pl -s &> alicut.log
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/63c88c27a0fa300f57066b0ef65fefcb.simg
[Sun Jul  5 22:36:13 2020]
Finished job 1203.
1198 of 3292 steps (36%) done

[Sun Jul  5 22:36:13 2020]
rule remove_empty:
    input: per_gene/EOG091G115J/ALICUT_EOG091G115J.clustalo.fasta
    output: per_gene/EOG091G115J/empty_check.done
    jobid: 2025
    wildcards: BUSCO=EOG091G115J


         if [ "$(cat per_gene/EOG091G115J/ALICUT_EOG091G115J.clustalo.fasta | grep -v ">" | sed 's/-//g' | grep "^$" | wc -l)" -gt 0 ]
         then
              cp per_gene/EOG091G115J/ALICUT_EOG091G115J.clustalo.fasta per_gene/EOG091G115J/ALICUT_EOG091G115J.clustalo.fasta.backup
              bash ../scripts/remove_empty.sh per_gene/EOG091G115J/ALICUT_EOG091G115J.clustalo.fasta.backup > per_gene/EOG091G115J/ALICUT_EOG091G115J.clustalo.fasta
         fi
         touch per_gene/EOG091G115J/empty_check.done
         
[Sun Jul  5 22:36:13 2020]
Finished job 2025.
1199 of 3292 steps (36%) done

[Sun Jul  5 22:36:13 2020]
rule find_best_model:
    input: per_gene/EOG091G115J/ALICUT_EOG091G115J.clustalo.fasta, per_gene/EOG091G115J/empty_check.done
    output: per_gene/EOG091G115J/EOG091G115J.best_model
    log: per_gene/EOG091G115J/find_best_model.stderr.txt
    jobid: 1202
    wildcards: BUSCO=EOG091G115J
    threads: 2


        cd per_gene/EOG091G115J
        if [ ! -d find_best_model ]
        then
            mkdir find_best_model
        fi
        cd find_best_model
        ln -s ../../../per_gene/EOG091G115J/ALICUT_EOG091G115J.clustalo.fasta EOG091G115J.fasta
        ProteinModelSelection.pl EOG091G115J.fasta 1> ../../../per_gene/EOG091G115J/EOG091G115J.best_model 2> ../../../per_gene/EOG091G115J/find_best_model.stderr.txt
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/c0c09ee657b1e27f2c5687e0e9aa8d70.simg
[Sun Jul  5 22:36:14 2020]
Finished job 2840.
1200 of 3292 steps (36%) done

[Sun Jul  5 22:36:14 2020]
rule get_outgroups:
    input: per_gene/EOG091G0RTZ/EOG091G0RTZ.ingroup.fasta
    output: per_gene/EOG091G0RTZ/EOG091G0RTZ.orthodb.fasta, per_gene/EOG091G0RTZ/EOG091G0RTZ.outgroup.fasta
    log: per_gene/EOG091G0RTZ/get_outgroups.stdout.txt, per_gene/EOG091G0RTZ/get_outgroups.stderr.txt
    jobid: 2841
    wildcards: BUSCO=EOG091G0RTZ


        #download fastas from Orhtodb for BUSCO id
        for i in {1..5}
        do
             wget "http://www.orthodb.org/fasta?query=EOG091G0RTZ&level=33208" -O per_gene/EOG091G0RTZ/EOG091G0RTZ.orthodb.fasta 1> per_gene/EOG091G0RTZ/get_outgroups.stdout.txt 2> per_gene/EOG091G0RTZ/get_outgroups.stderr.txt && break || echo -e "try again ($i)" && sleep 15
        done

	#This is quick an dirty for now and just takes the first protein if there is more than one for an outgroup taxon
        bash ../scripts/download_outgroups.sh taxids.txt per_gene/EOG091G0RTZ/EOG091G0RTZ.orthodb.fasta > per_gene/EOG091G0RTZ/EOG091G0RTZ.outgroup.fasta
        
[Sun Jul  5 22:36:15 2020]
Finished job 2841.
1201 of 3292 steps (36%) done

[Sun Jul  5 22:36:15 2020]
rule join_groups:
    input: per_gene/EOG091G0RTZ/EOG091G0RTZ.ingroup.fasta, per_gene/EOG091G0RTZ/EOG091G0RTZ.outgroup.fasta
    output: per_gene/EOG091G0RTZ/EOG091G0RTZ.fasta
    jobid: 2244
    wildcards: BUSCO=EOG091G0RTZ


        cat per_gene/EOG091G0RTZ/EOG091G0RTZ.ingroup.fasta per_gene/EOG091G0RTZ/EOG091G0RTZ.outgroup.fasta > per_gene/EOG091G0RTZ/EOG091G0RTZ.fasta
        
[Sun Jul  5 22:36:15 2020]
Finished job 2244.
1202 of 3292 steps (37%) done

[Sun Jul  5 22:36:15 2020]
rule MSA:
    input: per_gene/EOG091G0RTZ/EOG091G0RTZ.fasta
    output: per_gene/EOG091G0RTZ/EOG091G0RTZ.clustalo.fasta
    log: per_gene/EOG091G0RTZ/MSA.stdout.txt, per_gene/EOG091G0RTZ/MSA.stderr.txt
    jobid: 1608
    wildcards: BUSCO=EOG091G0RTZ
    threads: 2


        clustalo -i per_gene/EOG091G0RTZ/EOG091G0RTZ.fasta -o per_gene/EOG091G0RTZ/EOG091G0RTZ.clustalo.fasta --threads=2 1> per_gene/EOG091G0RTZ/MSA.stdout.txt 2> per_gene/EOG091G0RTZ/MSA.stderr.txt
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/d68c9691725a7401923680874285c430.simg
[Sun Jul  5 22:36:16 2020]
Finished job 2584.
1203 of 3292 steps (37%) done

[Sun Jul  5 22:36:16 2020]
rule get_outgroups:
    input: per_gene/EOG091G07VQ/EOG091G07VQ.ingroup.fasta
    output: per_gene/EOG091G07VQ/EOG091G07VQ.orthodb.fasta, per_gene/EOG091G07VQ/EOG091G07VQ.outgroup.fasta
    log: per_gene/EOG091G07VQ/get_outgroups.stdout.txt, per_gene/EOG091G07VQ/get_outgroups.stderr.txt
    jobid: 2585
    wildcards: BUSCO=EOG091G07VQ


        #download fastas from Orhtodb for BUSCO id
        for i in {1..5}
        do
             wget "http://www.orthodb.org/fasta?query=EOG091G07VQ&level=33208" -O per_gene/EOG091G07VQ/EOG091G07VQ.orthodb.fasta 1> per_gene/EOG091G07VQ/get_outgroups.stdout.txt 2> per_gene/EOG091G07VQ/get_outgroups.stderr.txt && break || echo -e "try again ($i)" && sleep 15
        done

	#This is quick an dirty for now and just takes the first protein if there is more than one for an outgroup taxon
        bash ../scripts/download_outgroups.sh taxids.txt per_gene/EOG091G07VQ/EOG091G07VQ.orthodb.fasta > per_gene/EOG091G07VQ/EOG091G07VQ.outgroup.fasta
        
[Sun Jul  5 22:36:16 2020]
Finished job 1608.
1204 of 3292 steps (37%) done

[Sun Jul  5 22:36:16 2020]
rule score_and_cut:
    input: per_gene/EOG091G0RTZ/EOG091G0RTZ.clustalo.fasta
    output: per_gene/EOG091G0RTZ/ALICUT_EOG091G0RTZ.clustalo.fasta
    jobid: 785
    wildcards: BUSCO=EOG091G0RTZ
    threads: 2


        cd per_gene/EOG091G0RTZ
        Aliscore.pl -N -r 200000000000000000 -i ../../per_gene/EOG091G0RTZ/EOG091G0RTZ.clustalo.fasta &> aliscore.log
        ALICUT.pl -s &> alicut.log
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/63c88c27a0fa300f57066b0ef65fefcb.simg
[Sun Jul  5 22:36:17 2020]
Finished job 2585.
1205 of 3292 steps (37%) done

[Sun Jul  5 22:36:17 2020]
rule join_groups:
    input: per_gene/EOG091G07VQ/EOG091G07VQ.ingroup.fasta, per_gene/EOG091G07VQ/EOG091G07VQ.outgroup.fasta
    output: per_gene/EOG091G07VQ/EOG091G07VQ.fasta
    jobid: 2116
    wildcards: BUSCO=EOG091G07VQ


        cat per_gene/EOG091G07VQ/EOG091G07VQ.ingroup.fasta per_gene/EOG091G07VQ/EOG091G07VQ.outgroup.fasta > per_gene/EOG091G07VQ/EOG091G07VQ.fasta
        
[Sun Jul  5 22:36:17 2020]
Finished job 2116.
1206 of 3292 steps (37%) done

[Sun Jul  5 22:36:17 2020]
rule MSA:
    input: per_gene/EOG091G07VQ/EOG091G07VQ.fasta
    output: per_gene/EOG091G07VQ/EOG091G07VQ.clustalo.fasta
    log: per_gene/EOG091G07VQ/MSA.stdout.txt, per_gene/EOG091G07VQ/MSA.stderr.txt
    jobid: 1352
    wildcards: BUSCO=EOG091G07VQ
    threads: 2


        clustalo -i per_gene/EOG091G07VQ/EOG091G07VQ.fasta -o per_gene/EOG091G07VQ/EOG091G07VQ.clustalo.fasta --threads=2 1> per_gene/EOG091G07VQ/MSA.stdout.txt 2> per_gene/EOG091G07VQ/MSA.stderr.txt
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/d68c9691725a7401923680874285c430.simg
[Sun Jul  5 22:36:19 2020]
Finished job 1352.
1207 of 3292 steps (37%) done

[Sun Jul  5 22:36:19 2020]
rule score_and_cut:
    input: per_gene/EOG091G07VQ/EOG091G07VQ.clustalo.fasta
    output: per_gene/EOG091G07VQ/ALICUT_EOG091G07VQ.clustalo.fasta
    jobid: 529
    wildcards: BUSCO=EOG091G07VQ
    threads: 2


        cd per_gene/EOG091G07VQ
        Aliscore.pl -N -r 200000000000000000 -i ../../per_gene/EOG091G07VQ/EOG091G07VQ.clustalo.fasta &> aliscore.log
        ALICUT.pl -s &> alicut.log
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/63c88c27a0fa300f57066b0ef65fefcb.simg
[Sun Jul  5 22:36:25 2020]
Finished job 785.
1208 of 3292 steps (37%) done

[Sun Jul  5 22:36:25 2020]
rule remove_empty:
    input: per_gene/EOG091G0RTZ/ALICUT_EOG091G0RTZ.clustalo.fasta
    output: per_gene/EOG091G0RTZ/empty_check.done
    jobid: 1607
    wildcards: BUSCO=EOG091G0RTZ


         if [ "$(cat per_gene/EOG091G0RTZ/ALICUT_EOG091G0RTZ.clustalo.fasta | grep -v ">" | sed 's/-//g' | grep "^$" | wc -l)" -gt 0 ]
         then
              cp per_gene/EOG091G0RTZ/ALICUT_EOG091G0RTZ.clustalo.fasta per_gene/EOG091G0RTZ/ALICUT_EOG091G0RTZ.clustalo.fasta.backup
              bash ../scripts/remove_empty.sh per_gene/EOG091G0RTZ/ALICUT_EOG091G0RTZ.clustalo.fasta.backup > per_gene/EOG091G0RTZ/ALICUT_EOG091G0RTZ.clustalo.fasta
         fi
         touch per_gene/EOG091G0RTZ/empty_check.done
         
[Sun Jul  5 22:36:25 2020]
Finished job 1607.
1209 of 3292 steps (37%) done

[Sun Jul  5 22:36:25 2020]
rule find_best_model:
    input: per_gene/EOG091G0RTZ/ALICUT_EOG091G0RTZ.clustalo.fasta, per_gene/EOG091G0RTZ/empty_check.done
    output: per_gene/EOG091G0RTZ/EOG091G0RTZ.best_model
    log: per_gene/EOG091G0RTZ/find_best_model.stderr.txt
    jobid: 784
    wildcards: BUSCO=EOG091G0RTZ
    threads: 2


        cd per_gene/EOG091G0RTZ
        if [ ! -d find_best_model ]
        then
            mkdir find_best_model
        fi
        cd find_best_model
        ln -s ../../../per_gene/EOG091G0RTZ/ALICUT_EOG091G0RTZ.clustalo.fasta EOG091G0RTZ.fasta
        ProteinModelSelection.pl EOG091G0RTZ.fasta 1> ../../../per_gene/EOG091G0RTZ/EOG091G0RTZ.best_model 2> ../../../per_gene/EOG091G0RTZ/find_best_model.stderr.txt
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/c0c09ee657b1e27f2c5687e0e9aa8d70.simg
[Sun Jul  5 22:36:31 2020]
Finished job 529.
1210 of 3292 steps (37%) done

[Sun Jul  5 22:36:31 2020]
rule remove_empty:
    input: per_gene/EOG091G07VQ/ALICUT_EOG091G07VQ.clustalo.fasta
    output: per_gene/EOG091G07VQ/empty_check.done
    jobid: 1351
    wildcards: BUSCO=EOG091G07VQ


         if [ "$(cat per_gene/EOG091G07VQ/ALICUT_EOG091G07VQ.clustalo.fasta | grep -v ">" | sed 's/-//g' | grep "^$" | wc -l)" -gt 0 ]
         then
              cp per_gene/EOG091G07VQ/ALICUT_EOG091G07VQ.clustalo.fasta per_gene/EOG091G07VQ/ALICUT_EOG091G07VQ.clustalo.fasta.backup
              bash ../scripts/remove_empty.sh per_gene/EOG091G07VQ/ALICUT_EOG091G07VQ.clustalo.fasta.backup > per_gene/EOG091G07VQ/ALICUT_EOG091G07VQ.clustalo.fasta
         fi
         touch per_gene/EOG091G07VQ/empty_check.done
         
[Sun Jul  5 22:36:31 2020]
Finished job 1351.
1211 of 3292 steps (37%) done

[Sun Jul  5 22:36:31 2020]
rule find_best_model:
    input: per_gene/EOG091G07VQ/ALICUT_EOG091G07VQ.clustalo.fasta, per_gene/EOG091G07VQ/empty_check.done
    output: per_gene/EOG091G07VQ/EOG091G07VQ.best_model
    log: per_gene/EOG091G07VQ/find_best_model.stderr.txt
    jobid: 528
    wildcards: BUSCO=EOG091G07VQ
    threads: 2


        cd per_gene/EOG091G07VQ
        if [ ! -d find_best_model ]
        then
            mkdir find_best_model
        fi
        cd find_best_model
        ln -s ../../../per_gene/EOG091G07VQ/ALICUT_EOG091G07VQ.clustalo.fasta EOG091G07VQ.fasta
        ProteinModelSelection.pl EOG091G07VQ.fasta 1> ../../../per_gene/EOG091G07VQ/EOG091G07VQ.best_model 2> ../../../per_gene/EOG091G07VQ/find_best_model.stderr.txt
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/c0c09ee657b1e27f2c5687e0e9aa8d70.simg
[Sun Jul  5 22:36:33 2020]
Finished job 582.
1212 of 3292 steps (37%) done

[Sun Jul  5 22:36:33 2020]
rule infer_single_ML:
    input: per_gene/EOG091G0BUD/EOG091G0BUD.best_model, per_gene/EOG091G0BUD/ALICUT_EOG091G0BUD.clustalo.fasta
    output: per_gene/EOG091G0BUD/EOG091G0BUD.raxml.done
    log: per_gene/EOG091G0BUD/infer_single_ML.stdout.txt, per_gene/EOG091G0BUD/infer_single_ML.stderr.txt
    jobid: 85
    wildcards: BUSCO=EOG091G0BUD
    threads: 2


        cd per_gene/EOG091G0BUD
	count=$(cat ../../per_gene/EOG091G0BUD/ALICUT_EOG091G0BUD.clustalo.fasta | grep ">" | wc -l)
	if [ "$count" -gt 5 ]
        then
		RAxMLmodel=$(cat ../../per_gene/EOG091G0BUD/EOG091G0BUD.best_model | grep "Best" | cut -d ":" -f 2 | tr -d '[:space:]')
                if [ "$(ls -1 | grep "^RAxML" | wc -l)" -ne 0 ]
		then
			rm RAxML*
		fi
        	raxml -f a -T 2 -m PROTGAMMA$RAxMLmodel         	-p 12345 -x 12345 -# 100         	-s ../../per_gene/EOG091G0BUD/ALICUT_EOG091G0BUD.clustalo.fasta -n EOG091G0BUD.clustalo.aln.ALICUT.$RAxMLmodel 		1> ../../per_gene/EOG091G0BUD/infer_single_ML.stdout.txt 2> ../../per_gene/EOG091G0BUD/infer_single_ML.stderr.txt
	else
		echo "fasta file per_gene/EOG091G0BUD/ALICUT_EOG091G0BUD.clustalo.fasta contains fewer than 5 sequences - skipped" > ../../per_gene/EOG091G0BUD/infer_single_ML.stdout.txt
		touch raxml.skipped
	fi
        touch ../../per_gene/EOG091G0BUD/EOG091G0BUD.raxml.done
        
[33mJob counts:
	count	jobs
	1	infer_single_ML
	1[0m
[33m
        cd per_gene/EOG091G0BUD
	count=$(cat ../../per_gene/EOG091G0BUD/ALICUT_EOG091G0BUD.clustalo.fasta | grep ">" | wc -l)
	if [ "$count" -gt 5 ]
        then
		RAxMLmodel=$(cat ../../per_gene/EOG091G0BUD/EOG091G0BUD.best_model | grep "Best" | cut -d ":" -f 2 | tr -d '[:space:]')
                if [ "$(ls -1 | grep "^RAxML" | wc -l)" -ne 0 ]
		then
			rm RAxML*
		fi
        	raxml -f a -T 2 -m PROTGAMMA$RAxMLmodel         	-p 12345 -x 12345 -# 100         	-s ../../per_gene/EOG091G0BUD/ALICUT_EOG091G0BUD.clustalo.fasta -n EOG091G0BUD.clustalo.aln.ALICUT.$RAxMLmodel 		1> ../../per_gene/EOG091G0BUD/infer_single_ML.stdout.txt 2> ../../per_gene/EOG091G0BUD/infer_single_ML.stderr.txt
	else
		echo "fasta file per_gene/EOG091G0BUD/ALICUT_EOG091G0BUD.clustalo.fasta contains fewer than 5 sequences - skipped" > ../../per_gene/EOG091G0BUD/infer_single_ML.stdout.txt
		touch raxml.skipped
	fi
        touch ../../per_gene/EOG091G0BUD/EOG091G0BUD.raxml.done
        [0m
[Sun Jul  5 22:36:40 2020]
Finished job 1202.
1213 of 3292 steps (37%) done

[Sun Jul  5 22:36:40 2020]
rule infer_single_ML:
    input: per_gene/EOG091G115J/EOG091G115J.best_model, per_gene/EOG091G115J/ALICUT_EOG091G115J.clustalo.fasta
    output: per_gene/EOG091G115J/EOG091G115J.raxml.done
    log: per_gene/EOG091G115J/infer_single_ML.stdout.txt, per_gene/EOG091G115J/infer_single_ML.stderr.txt
    jobid: 395
    wildcards: BUSCO=EOG091G115J
    threads: 2


        cd per_gene/EOG091G115J
	count=$(cat ../../per_gene/EOG091G115J/ALICUT_EOG091G115J.clustalo.fasta | grep ">" | wc -l)
	if [ "$count" -gt 5 ]
        then
		RAxMLmodel=$(cat ../../per_gene/EOG091G115J/EOG091G115J.best_model | grep "Best" | cut -d ":" -f 2 | tr -d '[:space:]')
                if [ "$(ls -1 | grep "^RAxML" | wc -l)" -ne 0 ]
		then
			rm RAxML*
		fi
        	raxml -f a -T 2 -m PROTGAMMA$RAxMLmodel         	-p 12345 -x 12345 -# 100         	-s ../../per_gene/EOG091G115J/ALICUT_EOG091G115J.clustalo.fasta -n EOG091G115J.clustalo.aln.ALICUT.$RAxMLmodel 		1> ../../per_gene/EOG091G115J/infer_single_ML.stdout.txt 2> ../../per_gene/EOG091G115J/infer_single_ML.stderr.txt
	else
		echo "fasta file per_gene/EOG091G115J/ALICUT_EOG091G115J.clustalo.fasta contains fewer than 5 sequences - skipped" > ../../per_gene/EOG091G115J/infer_single_ML.stdout.txt
		touch raxml.skipped
	fi
        touch ../../per_gene/EOG091G115J/EOG091G115J.raxml.done
        
[33mJob counts:
	count	jobs
	1	infer_single_ML
	1[0m
[33m
        cd per_gene/EOG091G115J
	count=$(cat ../../per_gene/EOG091G115J/ALICUT_EOG091G115J.clustalo.fasta | grep ">" | wc -l)
	if [ "$count" -gt 5 ]
        then
		RAxMLmodel=$(cat ../../per_gene/EOG091G115J/EOG091G115J.best_model | grep "Best" | cut -d ":" -f 2 | tr -d '[:space:]')
                if [ "$(ls -1 | grep "^RAxML" | wc -l)" -ne 0 ]
		then
			rm RAxML*
		fi
        	raxml -f a -T 2 -m PROTGAMMA$RAxMLmodel         	-p 12345 -x 12345 -# 100         	-s ../../per_gene/EOG091G115J/ALICUT_EOG091G115J.clustalo.fasta -n EOG091G115J.clustalo.aln.ALICUT.$RAxMLmodel 		1> ../../per_gene/EOG091G115J/infer_single_ML.stdout.txt 2> ../../per_gene/EOG091G115J/infer_single_ML.stderr.txt
	else
		echo "fasta file per_gene/EOG091G115J/ALICUT_EOG091G115J.clustalo.fasta contains fewer than 5 sequences - skipped" > ../../per_gene/EOG091G115J/infer_single_ML.stdout.txt
		touch raxml.skipped
	fi
        touch ../../per_gene/EOG091G115J/EOG091G115J.raxml.done
        [0m
[Sun Jul  5 22:36:45 2020]
Finished job 1084.
1214 of 3292 steps (37%) done

[Sun Jul  5 22:36:45 2020]
rule infer_single_ML:
    input: per_gene/EOG091G05IK/EOG091G05IK.best_model, per_gene/EOG091G05IK/ALICUT_EOG091G05IK.clustalo.fasta
    output: per_gene/EOG091G05IK/EOG091G05IK.raxml.done
    log: per_gene/EOG091G05IK/infer_single_ML.stdout.txt, per_gene/EOG091G05IK/infer_single_ML.stderr.txt
    jobid: 336
    wildcards: BUSCO=EOG091G05IK
    threads: 2


        cd per_gene/EOG091G05IK
	count=$(cat ../../per_gene/EOG091G05IK/ALICUT_EOG091G05IK.clustalo.fasta | grep ">" | wc -l)
	if [ "$count" -gt 5 ]
        then
		RAxMLmodel=$(cat ../../per_gene/EOG091G05IK/EOG091G05IK.best_model | grep "Best" | cut -d ":" -f 2 | tr -d '[:space:]')
                if [ "$(ls -1 | grep "^RAxML" | wc -l)" -ne 0 ]
		then
			rm RAxML*
		fi
        	raxml -f a -T 2 -m PROTGAMMA$RAxMLmodel         	-p 12345 -x 12345 -# 100         	-s ../../per_gene/EOG091G05IK/ALICUT_EOG091G05IK.clustalo.fasta -n EOG091G05IK.clustalo.aln.ALICUT.$RAxMLmodel 		1> ../../per_gene/EOG091G05IK/infer_single_ML.stdout.txt 2> ../../per_gene/EOG091G05IK/infer_single_ML.stderr.txt
	else
		echo "fasta file per_gene/EOG091G05IK/ALICUT_EOG091G05IK.clustalo.fasta contains fewer than 5 sequences - skipped" > ../../per_gene/EOG091G05IK/infer_single_ML.stdout.txt
		touch raxml.skipped
	fi
        touch ../../per_gene/EOG091G05IK/EOG091G05IK.raxml.done
        
[33mJob counts:
	count	jobs
	1	infer_single_ML
	1[0m
[33m
        cd per_gene/EOG091G05IK
	count=$(cat ../../per_gene/EOG091G05IK/ALICUT_EOG091G05IK.clustalo.fasta | grep ">" | wc -l)
	if [ "$count" -gt 5 ]
        then
		RAxMLmodel=$(cat ../../per_gene/EOG091G05IK/EOG091G05IK.best_model | grep "Best" | cut -d ":" -f 2 | tr -d '[:space:]')
                if [ "$(ls -1 | grep "^RAxML" | wc -l)" -ne 0 ]
		then
			rm RAxML*
		fi
        	raxml -f a -T 2 -m PROTGAMMA$RAxMLmodel         	-p 12345 -x 12345 -# 100         	-s ../../per_gene/EOG091G05IK/ALICUT_EOG091G05IK.clustalo.fasta -n EOG091G05IK.clustalo.aln.ALICUT.$RAxMLmodel 		1> ../../per_gene/EOG091G05IK/infer_single_ML.stdout.txt 2> ../../per_gene/EOG091G05IK/infer_single_ML.stderr.txt
	else
		echo "fasta file per_gene/EOG091G05IK/ALICUT_EOG091G05IK.clustalo.fasta contains fewer than 5 sequences - skipped" > ../../per_gene/EOG091G05IK/infer_single_ML.stdout.txt
		touch raxml.skipped
	fi
        touch ../../per_gene/EOG091G05IK/EOG091G05IK.raxml.done
        [0m
[Sun Jul  5 22:36:49 2020]
Finished job 234.
1215 of 3292 steps (37%) done

[Sun Jul  5 22:36:49 2020]
rule get_seqs:
    input: /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ingroup.txt, /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/outgroup.txt
    output: per_gene/EOG091G0EVK/EOG091G0EVK.ingroup.fasta
    log: per_gene/EOG091G0EVK/get_seqs.stdout.txt, per_gene/EOG091G0EVK/get_seqs.stderr.txt
    jobid: 2674
    wildcards: BUSCO=EOG091G0EVK
    threads: 2


	basedir=$(pwd)
        cd per_gene/EOG091G0EVK
        
        bash $basedir/../scripts/fetch_seqs.sh EOG091G0EVK /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ingroup.txt /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/outgroup.txt 1> ../../per_gene/EOG091G0EVK/get_seqs.stdout.txt 2> ../../per_gene/EOG091G0EVK/get_seqs.stderr.txt
	mv EOG091G0EVK.fasta $basedir/per_gene/EOG091G0EVK/EOG091G0EVK.ingroup.fasta
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/72476f9d9a5bd0627b4d721143a21354.simg
[Sun Jul  5 22:36:51 2020]
Finished job 784.
1216 of 3292 steps (37%) done

[Sun Jul  5 22:36:51 2020]
rule infer_single_ML:
    input: per_gene/EOG091G0RTZ/EOG091G0RTZ.best_model, per_gene/EOG091G0RTZ/ALICUT_EOG091G0RTZ.clustalo.fasta
    output: per_gene/EOG091G0RTZ/EOG091G0RTZ.raxml.done
    log: per_gene/EOG091G0RTZ/infer_single_ML.stdout.txt, per_gene/EOG091G0RTZ/infer_single_ML.stderr.txt
    jobid: 186
    wildcards: BUSCO=EOG091G0RTZ
    threads: 2


        cd per_gene/EOG091G0RTZ
	count=$(cat ../../per_gene/EOG091G0RTZ/ALICUT_EOG091G0RTZ.clustalo.fasta | grep ">" | wc -l)
	if [ "$count" -gt 5 ]
        then
		RAxMLmodel=$(cat ../../per_gene/EOG091G0RTZ/EOG091G0RTZ.best_model | grep "Best" | cut -d ":" -f 2 | tr -d '[:space:]')
                if [ "$(ls -1 | grep "^RAxML" | wc -l)" -ne 0 ]
		then
			rm RAxML*
		fi
        	raxml -f a -T 2 -m PROTGAMMA$RAxMLmodel         	-p 12345 -x 12345 -# 100         	-s ../../per_gene/EOG091G0RTZ/ALICUT_EOG091G0RTZ.clustalo.fasta -n EOG091G0RTZ.clustalo.aln.ALICUT.$RAxMLmodel 		1> ../../per_gene/EOG091G0RTZ/infer_single_ML.stdout.txt 2> ../../per_gene/EOG091G0RTZ/infer_single_ML.stderr.txt
	else
		echo "fasta file per_gene/EOG091G0RTZ/ALICUT_EOG091G0RTZ.clustalo.fasta contains fewer than 5 sequences - skipped" > ../../per_gene/EOG091G0RTZ/infer_single_ML.stdout.txt
		touch raxml.skipped
	fi
        touch ../../per_gene/EOG091G0RTZ/EOG091G0RTZ.raxml.done
        
[33mJob counts:
	count	jobs
	1	infer_single_ML
	1[0m
[33m
        cd per_gene/EOG091G0RTZ
	count=$(cat ../../per_gene/EOG091G0RTZ/ALICUT_EOG091G0RTZ.clustalo.fasta | grep ">" | wc -l)
	if [ "$count" -gt 5 ]
        then
		RAxMLmodel=$(cat ../../per_gene/EOG091G0RTZ/EOG091G0RTZ.best_model | grep "Best" | cut -d ":" -f 2 | tr -d '[:space:]')
                if [ "$(ls -1 | grep "^RAxML" | wc -l)" -ne 0 ]
		then
			rm RAxML*
		fi
        	raxml -f a -T 2 -m PROTGAMMA$RAxMLmodel         	-p 12345 -x 12345 -# 100         	-s ../../per_gene/EOG091G0RTZ/ALICUT_EOG091G0RTZ.clustalo.fasta -n EOG091G0RTZ.clustalo.aln.ALICUT.$RAxMLmodel 		1> ../../per_gene/EOG091G0RTZ/infer_single_ML.stdout.txt 2> ../../per_gene/EOG091G0RTZ/infer_single_ML.stderr.txt
	else
		echo "fasta file per_gene/EOG091G0RTZ/ALICUT_EOG091G0RTZ.clustalo.fasta contains fewer than 5 sequences - skipped" > ../../per_gene/EOG091G0RTZ/infer_single_ML.stdout.txt
		touch raxml.skipped
	fi
        touch ../../per_gene/EOG091G0RTZ/EOG091G0RTZ.raxml.done
        [0m
[Sun Jul  5 22:36:59 2020]
Finished job 2674.
1217 of 3292 steps (37%) done

[Sun Jul  5 22:36:59 2020]
rule get_outgroups:
    input: per_gene/EOG091G0EVK/EOG091G0EVK.ingroup.fasta
    output: per_gene/EOG091G0EVK/EOG091G0EVK.orthodb.fasta, per_gene/EOG091G0EVK/EOG091G0EVK.outgroup.fasta
    log: per_gene/EOG091G0EVK/get_outgroups.stdout.txt, per_gene/EOG091G0EVK/get_outgroups.stderr.txt
    jobid: 2675
    wildcards: BUSCO=EOG091G0EVK


        #download fastas from Orhtodb for BUSCO id
        for i in {1..5}
        do
             wget "http://www.orthodb.org/fasta?query=EOG091G0EVK&level=33208" -O per_gene/EOG091G0EVK/EOG091G0EVK.orthodb.fasta 1> per_gene/EOG091G0EVK/get_outgroups.stdout.txt 2> per_gene/EOG091G0EVK/get_outgroups.stderr.txt && break || echo -e "try again ($i)" && sleep 15
        done

	#This is quick an dirty for now and just takes the first protein if there is more than one for an outgroup taxon
        bash ../scripts/download_outgroups.sh taxids.txt per_gene/EOG091G0EVK/EOG091G0EVK.orthodb.fasta > per_gene/EOG091G0EVK/EOG091G0EVK.outgroup.fasta
        
[Sun Jul  5 22:37:00 2020]
Finished job 2675.
1218 of 3292 steps (37%) done

[Sun Jul  5 22:37:00 2020]
rule join_groups:
    input: per_gene/EOG091G0EVK/EOG091G0EVK.ingroup.fasta, per_gene/EOG091G0EVK/EOG091G0EVK.outgroup.fasta
    output: per_gene/EOG091G0EVK/EOG091G0EVK.fasta
    jobid: 2161
    wildcards: BUSCO=EOG091G0EVK


        cat per_gene/EOG091G0EVK/EOG091G0EVK.ingroup.fasta per_gene/EOG091G0EVK/EOG091G0EVK.outgroup.fasta > per_gene/EOG091G0EVK/EOG091G0EVK.fasta
        
[Sun Jul  5 22:37:00 2020]
Finished job 2161.
1219 of 3292 steps (37%) done

[Sun Jul  5 22:37:00 2020]
rule MSA:
    input: per_gene/EOG091G0EVK/EOG091G0EVK.fasta
    output: per_gene/EOG091G0EVK/EOG091G0EVK.clustalo.fasta
    log: per_gene/EOG091G0EVK/MSA.stdout.txt, per_gene/EOG091G0EVK/MSA.stderr.txt
    jobid: 1442
    wildcards: BUSCO=EOG091G0EVK
    threads: 2


        clustalo -i per_gene/EOG091G0EVK/EOG091G0EVK.fasta -o per_gene/EOG091G0EVK/EOG091G0EVK.clustalo.fasta --threads=2 1> per_gene/EOG091G0EVK/MSA.stdout.txt 2> per_gene/EOG091G0EVK/MSA.stderr.txt
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/d68c9691725a7401923680874285c430.simg
[Sun Jul  5 22:37:01 2020]
Finished job 1442.
1220 of 3292 steps (37%) done

[Sun Jul  5 22:37:01 2020]
rule score_and_cut:
    input: per_gene/EOG091G0EVK/EOG091G0EVK.clustalo.fasta
    output: per_gene/EOG091G0EVK/ALICUT_EOG091G0EVK.clustalo.fasta
    jobid: 619
    wildcards: BUSCO=EOG091G0EVK
    threads: 2


        cd per_gene/EOG091G0EVK
        Aliscore.pl -N -r 200000000000000000 -i ../../per_gene/EOG091G0EVK/EOG091G0EVK.clustalo.fasta &> aliscore.log
        ALICUT.pl -s &> alicut.log
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/63c88c27a0fa300f57066b0ef65fefcb.simg
[Sun Jul  5 22:37:05 2020]
Finished job 528.
1221 of 3292 steps (37%) done

[Sun Jul  5 22:37:05 2020]
rule infer_single_ML:
    input: per_gene/EOG091G07VQ/EOG091G07VQ.best_model, per_gene/EOG091G07VQ/ALICUT_EOG091G07VQ.clustalo.fasta
    output: per_gene/EOG091G07VQ/EOG091G07VQ.raxml.done
    log: per_gene/EOG091G07VQ/infer_single_ML.stdout.txt, per_gene/EOG091G07VQ/infer_single_ML.stderr.txt
    jobid: 58
    wildcards: BUSCO=EOG091G07VQ
    threads: 2


        cd per_gene/EOG091G07VQ
	count=$(cat ../../per_gene/EOG091G07VQ/ALICUT_EOG091G07VQ.clustalo.fasta | grep ">" | wc -l)
	if [ "$count" -gt 5 ]
        then
		RAxMLmodel=$(cat ../../per_gene/EOG091G07VQ/EOG091G07VQ.best_model | grep "Best" | cut -d ":" -f 2 | tr -d '[:space:]')
                if [ "$(ls -1 | grep "^RAxML" | wc -l)" -ne 0 ]
		then
			rm RAxML*
		fi
        	raxml -f a -T 2 -m PROTGAMMA$RAxMLmodel         	-p 12345 -x 12345 -# 100         	-s ../../per_gene/EOG091G07VQ/ALICUT_EOG091G07VQ.clustalo.fasta -n EOG091G07VQ.clustalo.aln.ALICUT.$RAxMLmodel 		1> ../../per_gene/EOG091G07VQ/infer_single_ML.stdout.txt 2> ../../per_gene/EOG091G07VQ/infer_single_ML.stderr.txt
	else
		echo "fasta file per_gene/EOG091G07VQ/ALICUT_EOG091G07VQ.clustalo.fasta contains fewer than 5 sequences - skipped" > ../../per_gene/EOG091G07VQ/infer_single_ML.stdout.txt
		touch raxml.skipped
	fi
        touch ../../per_gene/EOG091G07VQ/EOG091G07VQ.raxml.done
        
[33mJob counts:
	count	jobs
	1	infer_single_ML
	1[0m
[33m
        cd per_gene/EOG091G07VQ
	count=$(cat ../../per_gene/EOG091G07VQ/ALICUT_EOG091G07VQ.clustalo.fasta | grep ">" | wc -l)
	if [ "$count" -gt 5 ]
        then
		RAxMLmodel=$(cat ../../per_gene/EOG091G07VQ/EOG091G07VQ.best_model | grep "Best" | cut -d ":" -f 2 | tr -d '[:space:]')
                if [ "$(ls -1 | grep "^RAxML" | wc -l)" -ne 0 ]
		then
			rm RAxML*
		fi
        	raxml -f a -T 2 -m PROTGAMMA$RAxMLmodel         	-p 12345 -x 12345 -# 100         	-s ../../per_gene/EOG091G07VQ/ALICUT_EOG091G07VQ.clustalo.fasta -n EOG091G07VQ.clustalo.aln.ALICUT.$RAxMLmodel 		1> ../../per_gene/EOG091G07VQ/infer_single_ML.stdout.txt 2> ../../per_gene/EOG091G07VQ/infer_single_ML.stderr.txt
	else
		echo "fasta file per_gene/EOG091G07VQ/ALICUT_EOG091G07VQ.clustalo.fasta contains fewer than 5 sequences - skipped" > ../../per_gene/EOG091G07VQ/infer_single_ML.stdout.txt
		touch raxml.skipped
	fi
        touch ../../per_gene/EOG091G07VQ/EOG091G07VQ.raxml.done
        [0m
[Sun Jul  5 22:37:12 2020]
Finished job 619.
1222 of 3292 steps (37%) done

[Sun Jul  5 22:37:13 2020]
rule remove_empty:
    input: per_gene/EOG091G0EVK/ALICUT_EOG091G0EVK.clustalo.fasta
    output: per_gene/EOG091G0EVK/empty_check.done
    jobid: 1441
    wildcards: BUSCO=EOG091G0EVK


         if [ "$(cat per_gene/EOG091G0EVK/ALICUT_EOG091G0EVK.clustalo.fasta | grep -v ">" | sed 's/-//g' | grep "^$" | wc -l)" -gt 0 ]
         then
              cp per_gene/EOG091G0EVK/ALICUT_EOG091G0EVK.clustalo.fasta per_gene/EOG091G0EVK/ALICUT_EOG091G0EVK.clustalo.fasta.backup
              bash ../scripts/remove_empty.sh per_gene/EOG091G0EVK/ALICUT_EOG091G0EVK.clustalo.fasta.backup > per_gene/EOG091G0EVK/ALICUT_EOG091G0EVK.clustalo.fasta
         fi
         touch per_gene/EOG091G0EVK/empty_check.done
         
[Sun Jul  5 22:37:13 2020]
Finished job 1441.
1223 of 3292 steps (37%) done

[Sun Jul  5 22:37:13 2020]
rule find_best_model:
    input: per_gene/EOG091G0EVK/ALICUT_EOG091G0EVK.clustalo.fasta, per_gene/EOG091G0EVK/empty_check.done
    output: per_gene/EOG091G0EVK/EOG091G0EVK.best_model
    log: per_gene/EOG091G0EVK/find_best_model.stderr.txt
    jobid: 618
    wildcards: BUSCO=EOG091G0EVK
    threads: 2


        cd per_gene/EOG091G0EVK
        if [ ! -d find_best_model ]
        then
            mkdir find_best_model
        fi
        cd find_best_model
        ln -s ../../../per_gene/EOG091G0EVK/ALICUT_EOG091G0EVK.clustalo.fasta EOG091G0EVK.fasta
        ProteinModelSelection.pl EOG091G0EVK.fasta 1> ../../../per_gene/EOG091G0EVK/EOG091G0EVK.best_model 2> ../../../per_gene/EOG091G0EVK/find_best_model.stderr.txt
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/c0c09ee657b1e27f2c5687e0e9aa8d70.simg
[Sun Jul  5 22:37:18 2020]
Finished job 27.
1224 of 3292 steps (37%) done

[Sun Jul  5 22:37:19 2020]
rule get_seqs:
    input: /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ingroup.txt, /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/outgroup.txt
    output: per_gene/EOG091G0JYQ/EOG091G0JYQ.ingroup.fasta
    log: per_gene/EOG091G0JYQ/get_seqs.stdout.txt, per_gene/EOG091G0JYQ/get_seqs.stderr.txt
    jobid: 3216
    wildcards: BUSCO=EOG091G0JYQ
    threads: 2


	basedir=$(pwd)
        cd per_gene/EOG091G0JYQ
        
        bash $basedir/../scripts/fetch_seqs.sh EOG091G0JYQ /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ingroup.txt /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/outgroup.txt 1> ../../per_gene/EOG091G0JYQ/get_seqs.stdout.txt 2> ../../per_gene/EOG091G0JYQ/get_seqs.stderr.txt
	mv EOG091G0JYQ.fasta $basedir/per_gene/EOG091G0JYQ/EOG091G0JYQ.ingroup.fasta
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/72476f9d9a5bd0627b4d721143a21354.simg
[Sun Jul  5 22:37:28 2020]
Finished job 3216.
1225 of 3292 steps (37%) done

[Sun Jul  5 22:37:28 2020]
rule get_outgroups:
    input: per_gene/EOG091G0JYQ/EOG091G0JYQ.ingroup.fasta
    output: per_gene/EOG091G0JYQ/EOG091G0JYQ.orthodb.fasta, per_gene/EOG091G0JYQ/EOG091G0JYQ.outgroup.fasta
    log: per_gene/EOG091G0JYQ/get_outgroups.stdout.txt, per_gene/EOG091G0JYQ/get_outgroups.stderr.txt
    jobid: 3217
    wildcards: BUSCO=EOG091G0JYQ


        #download fastas from Orhtodb for BUSCO id
        for i in {1..5}
        do
             wget "http://www.orthodb.org/fasta?query=EOG091G0JYQ&level=33208" -O per_gene/EOG091G0JYQ/EOG091G0JYQ.orthodb.fasta 1> per_gene/EOG091G0JYQ/get_outgroups.stdout.txt 2> per_gene/EOG091G0JYQ/get_outgroups.stderr.txt && break || echo -e "try again ($i)" && sleep 15
        done

	#This is quick an dirty for now and just takes the first protein if there is more than one for an outgroup taxon
        bash ../scripts/download_outgroups.sh taxids.txt per_gene/EOG091G0JYQ/EOG091G0JYQ.orthodb.fasta > per_gene/EOG091G0JYQ/EOG091G0JYQ.outgroup.fasta
        
[Sun Jul  5 22:37:29 2020]
Finished job 3217.
1226 of 3292 steps (37%) done

[Sun Jul  5 22:37:29 2020]
rule join_groups:
    input: per_gene/EOG091G0JYQ/EOG091G0JYQ.ingroup.fasta, per_gene/EOG091G0JYQ/EOG091G0JYQ.outgroup.fasta
    output: per_gene/EOG091G0JYQ/EOG091G0JYQ.fasta
    jobid: 2432
    wildcards: BUSCO=EOG091G0JYQ


        cat per_gene/EOG091G0JYQ/EOG091G0JYQ.ingroup.fasta per_gene/EOG091G0JYQ/EOG091G0JYQ.outgroup.fasta > per_gene/EOG091G0JYQ/EOG091G0JYQ.fasta
        
[Sun Jul  5 22:37:29 2020]
Finished job 2432.
1227 of 3292 steps (37%) done

[Sun Jul  5 22:37:29 2020]
rule MSA:
    input: per_gene/EOG091G0JYQ/EOG091G0JYQ.fasta
    output: per_gene/EOG091G0JYQ/EOG091G0JYQ.clustalo.fasta
    log: per_gene/EOG091G0JYQ/MSA.stdout.txt, per_gene/EOG091G0JYQ/MSA.stderr.txt
    jobid: 1984
    wildcards: BUSCO=EOG091G0JYQ
    threads: 2


        clustalo -i per_gene/EOG091G0JYQ/EOG091G0JYQ.fasta -o per_gene/EOG091G0JYQ/EOG091G0JYQ.clustalo.fasta --threads=2 1> per_gene/EOG091G0JYQ/MSA.stdout.txt 2> per_gene/EOG091G0JYQ/MSA.stderr.txt
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/d68c9691725a7401923680874285c430.simg
[Sun Jul  5 22:37:30 2020]
Finished job 1984.
1228 of 3292 steps (37%) done

[Sun Jul  5 22:37:30 2020]
rule score_and_cut:
    input: per_gene/EOG091G0JYQ/EOG091G0JYQ.clustalo.fasta
    output: per_gene/EOG091G0JYQ/ALICUT_EOG091G0JYQ.clustalo.fasta
    jobid: 1161
    wildcards: BUSCO=EOG091G0JYQ
    threads: 2


        cd per_gene/EOG091G0JYQ
        Aliscore.pl -N -r 200000000000000000 -i ../../per_gene/EOG091G0JYQ/EOG091G0JYQ.clustalo.fasta &> aliscore.log
        ALICUT.pl -s &> alicut.log
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/63c88c27a0fa300f57066b0ef65fefcb.simg
[Sun Jul  5 22:37:40 2020]
Finished job 1161.
1229 of 3292 steps (37%) done

[Sun Jul  5 22:37:40 2020]
rule remove_empty:
    input: per_gene/EOG091G0JYQ/ALICUT_EOG091G0JYQ.clustalo.fasta
    output: per_gene/EOG091G0JYQ/empty_check.done
    jobid: 1983
    wildcards: BUSCO=EOG091G0JYQ


         if [ "$(cat per_gene/EOG091G0JYQ/ALICUT_EOG091G0JYQ.clustalo.fasta | grep -v ">" | sed 's/-//g' | grep "^$" | wc -l)" -gt 0 ]
         then
              cp per_gene/EOG091G0JYQ/ALICUT_EOG091G0JYQ.clustalo.fasta per_gene/EOG091G0JYQ/ALICUT_EOG091G0JYQ.clustalo.fasta.backup
              bash ../scripts/remove_empty.sh per_gene/EOG091G0JYQ/ALICUT_EOG091G0JYQ.clustalo.fasta.backup > per_gene/EOG091G0JYQ/ALICUT_EOG091G0JYQ.clustalo.fasta
         fi
         touch per_gene/EOG091G0JYQ/empty_check.done
         
[Sun Jul  5 22:37:40 2020]
Finished job 1983.
1230 of 3292 steps (37%) done

[Sun Jul  5 22:37:40 2020]
rule find_best_model:
    input: per_gene/EOG091G0JYQ/ALICUT_EOG091G0JYQ.clustalo.fasta, per_gene/EOG091G0JYQ/empty_check.done
    output: per_gene/EOG091G0JYQ/EOG091G0JYQ.best_model
    log: per_gene/EOG091G0JYQ/find_best_model.stderr.txt
    jobid: 1160
    wildcards: BUSCO=EOG091G0JYQ
    threads: 2


        cd per_gene/EOG091G0JYQ
        if [ ! -d find_best_model ]
        then
            mkdir find_best_model
        fi
        cd find_best_model
        ln -s ../../../per_gene/EOG091G0JYQ/ALICUT_EOG091G0JYQ.clustalo.fasta EOG091G0JYQ.fasta
        ProteinModelSelection.pl EOG091G0JYQ.fasta 1> ../../../per_gene/EOG091G0JYQ/EOG091G0JYQ.best_model 2> ../../../per_gene/EOG091G0JYQ/find_best_model.stderr.txt
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/c0c09ee657b1e27f2c5687e0e9aa8d70.simg
[Sun Jul  5 22:37:42 2020]
Finished job 399.
1231 of 3292 steps (37%) done

[Sun Jul  5 22:37:42 2020]
rule get_seqs:
    input: /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ingroup.txt, /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/outgroup.txt
    output: per_gene/EOG091G01TH/EOG091G01TH.ingroup.fasta
    log: per_gene/EOG091G01TH/get_seqs.stdout.txt, per_gene/EOG091G01TH/get_seqs.stderr.txt
    jobid: 2486
    wildcards: BUSCO=EOG091G01TH
    threads: 2


	basedir=$(pwd)
        cd per_gene/EOG091G01TH
        
        bash $basedir/../scripts/fetch_seqs.sh EOG091G01TH /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ingroup.txt /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/outgroup.txt 1> ../../per_gene/EOG091G01TH/get_seqs.stdout.txt 2> ../../per_gene/EOG091G01TH/get_seqs.stderr.txt
	mv EOG091G01TH.fasta $basedir/per_gene/EOG091G01TH/EOG091G01TH.ingroup.fasta
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/72476f9d9a5bd0627b4d721143a21354.simg
[Sun Jul  5 22:37:42 2020]
Finished job 618.
1232 of 3292 steps (37%) done

[Sun Jul  5 22:37:42 2020]
rule infer_single_ML:
    input: per_gene/EOG091G0EVK/EOG091G0EVK.best_model, per_gene/EOG091G0EVK/ALICUT_EOG091G0EVK.clustalo.fasta
    output: per_gene/EOG091G0EVK/EOG091G0EVK.raxml.done
    log: per_gene/EOG091G0EVK/infer_single_ML.stdout.txt, per_gene/EOG091G0EVK/infer_single_ML.stderr.txt
    jobid: 103
    wildcards: BUSCO=EOG091G0EVK
    threads: 2


        cd per_gene/EOG091G0EVK
	count=$(cat ../../per_gene/EOG091G0EVK/ALICUT_EOG091G0EVK.clustalo.fasta | grep ">" | wc -l)
	if [ "$count" -gt 5 ]
        then
		RAxMLmodel=$(cat ../../per_gene/EOG091G0EVK/EOG091G0EVK.best_model | grep "Best" | cut -d ":" -f 2 | tr -d '[:space:]')
                if [ "$(ls -1 | grep "^RAxML" | wc -l)" -ne 0 ]
		then
			rm RAxML*
		fi
        	raxml -f a -T 2 -m PROTGAMMA$RAxMLmodel         	-p 12345 -x 12345 -# 100         	-s ../../per_gene/EOG091G0EVK/ALICUT_EOG091G0EVK.clustalo.fasta -n EOG091G0EVK.clustalo.aln.ALICUT.$RAxMLmodel 		1> ../../per_gene/EOG091G0EVK/infer_single_ML.stdout.txt 2> ../../per_gene/EOG091G0EVK/infer_single_ML.stderr.txt
	else
		echo "fasta file per_gene/EOG091G0EVK/ALICUT_EOG091G0EVK.clustalo.fasta contains fewer than 5 sequences - skipped" > ../../per_gene/EOG091G0EVK/infer_single_ML.stdout.txt
		touch raxml.skipped
	fi
        touch ../../per_gene/EOG091G0EVK/EOG091G0EVK.raxml.done
        
[Sun Jul  5 22:37:47 2020]
Finished job 154.
1233 of 3292 steps (37%) done

[Sun Jul  5 22:37:47 2020]
rule get_seqs:
    input: /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ingroup.txt, /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/outgroup.txt
    output: per_gene/EOG091G0L66/EOG091G0L66.ingroup.fasta
    log: per_gene/EOG091G0L66/get_seqs.stdout.txt, per_gene/EOG091G0L66/get_seqs.stderr.txt
    jobid: 2996
    wildcards: BUSCO=EOG091G0L66
    threads: 2


	basedir=$(pwd)
        cd per_gene/EOG091G0L66
        
        bash $basedir/../scripts/fetch_seqs.sh EOG091G0L66 /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ingroup.txt /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/outgroup.txt 1> ../../per_gene/EOG091G0L66/get_seqs.stdout.txt 2> ../../per_gene/EOG091G0L66/get_seqs.stderr.txt
	mv EOG091G0L66.fasta $basedir/per_gene/EOG091G0L66/EOG091G0L66.ingroup.fasta
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/72476f9d9a5bd0627b4d721143a21354.simg
[Sun Jul  5 22:38:07 2020]
Finished job 2486.
1234 of 3292 steps (37%) done

[Sun Jul  5 22:38:07 2020]
rule get_outgroups:
    input: per_gene/EOG091G01TH/EOG091G01TH.ingroup.fasta
    output: per_gene/EOG091G01TH/EOG091G01TH.orthodb.fasta, per_gene/EOG091G01TH/EOG091G01TH.outgroup.fasta
    log: per_gene/EOG091G01TH/get_outgroups.stdout.txt, per_gene/EOG091G01TH/get_outgroups.stderr.txt
    jobid: 2487
    wildcards: BUSCO=EOG091G01TH


        #download fastas from Orhtodb for BUSCO id
        for i in {1..5}
        do
             wget "http://www.orthodb.org/fasta?query=EOG091G01TH&level=33208" -O per_gene/EOG091G01TH/EOG091G01TH.orthodb.fasta 1> per_gene/EOG091G01TH/get_outgroups.stdout.txt 2> per_gene/EOG091G01TH/get_outgroups.stderr.txt && break || echo -e "try again ($i)" && sleep 15
        done

	#This is quick an dirty for now and just takes the first protein if there is more than one for an outgroup taxon
        bash ../scripts/download_outgroups.sh taxids.txt per_gene/EOG091G01TH/EOG091G01TH.orthodb.fasta > per_gene/EOG091G01TH/EOG091G01TH.outgroup.fasta
        
[Sun Jul  5 22:38:07 2020]
Finished job 2996.
1235 of 3292 steps (38%) done

[Sun Jul  5 22:38:07 2020]
rule get_outgroups:
    input: per_gene/EOG091G0L66/EOG091G0L66.ingroup.fasta
    output: per_gene/EOG091G0L66/EOG091G0L66.orthodb.fasta, per_gene/EOG091G0L66/EOG091G0L66.outgroup.fasta
    log: per_gene/EOG091G0L66/get_outgroups.stdout.txt, per_gene/EOG091G0L66/get_outgroups.stderr.txt
    jobid: 2997
    wildcards: BUSCO=EOG091G0L66


        #download fastas from Orhtodb for BUSCO id
        for i in {1..5}
        do
             wget "http://www.orthodb.org/fasta?query=EOG091G0L66&level=33208" -O per_gene/EOG091G0L66/EOG091G0L66.orthodb.fasta 1> per_gene/EOG091G0L66/get_outgroups.stdout.txt 2> per_gene/EOG091G0L66/get_outgroups.stderr.txt && break || echo -e "try again ($i)" && sleep 15
        done

	#This is quick an dirty for now and just takes the first protein if there is more than one for an outgroup taxon
        bash ../scripts/download_outgroups.sh taxids.txt per_gene/EOG091G0L66/EOG091G0L66.orthodb.fasta > per_gene/EOG091G0L66/EOG091G0L66.outgroup.fasta
        

[Sun Jul  5 22:38:07 2020]
rule get_seqs:
    input: /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ingroup.txt, /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/outgroup.txt
    output: per_gene/EOG091G0GIC/EOG091G0GIC.ingroup.fasta
    log: per_gene/EOG091G0GIC/get_seqs.stdout.txt, per_gene/EOG091G0GIC/get_seqs.stderr.txt
    jobid: 3194
    wildcards: BUSCO=EOG091G0GIC
    threads: 2


	basedir=$(pwd)
        cd per_gene/EOG091G0GIC
        
        bash $basedir/../scripts/fetch_seqs.sh EOG091G0GIC /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ingroup.txt /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/outgroup.txt 1> ../../per_gene/EOG091G0GIC/get_seqs.stdout.txt 2> ../../per_gene/EOG091G0GIC/get_seqs.stderr.txt
	mv EOG091G0GIC.fasta $basedir/per_gene/EOG091G0GIC/EOG091G0GIC.ingroup.fasta
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/72476f9d9a5bd0627b4d721143a21354.simg
[Sun Jul  5 22:38:08 2020]
Finished job 2487.
1236 of 3292 steps (38%) done

[Sun Jul  5 22:38:08 2020]
rule join_groups:
    input: per_gene/EOG091G01TH/EOG091G01TH.ingroup.fasta, per_gene/EOG091G01TH/EOG091G01TH.outgroup.fasta
    output: per_gene/EOG091G01TH/EOG091G01TH.fasta
    jobid: 2067
    wildcards: BUSCO=EOG091G01TH


        cat per_gene/EOG091G01TH/EOG091G01TH.ingroup.fasta per_gene/EOG091G01TH/EOG091G01TH.outgroup.fasta > per_gene/EOG091G01TH/EOG091G01TH.fasta
        
[Sun Jul  5 22:38:08 2020]
Finished job 2067.
1237 of 3292 steps (38%) done
[Sun Jul  5 22:38:09 2020]
Finished job 2997.
1238 of 3292 steps (38%) done

[Sun Jul  5 22:38:09 2020]
rule MSA:
    input: per_gene/EOG091G01TH/EOG091G01TH.fasta
    output: per_gene/EOG091G01TH/EOG091G01TH.clustalo.fasta
    log: per_gene/EOG091G01TH/MSA.stdout.txt, per_gene/EOG091G01TH/MSA.stderr.txt
    jobid: 1254
    wildcards: BUSCO=EOG091G01TH
    threads: 2


        clustalo -i per_gene/EOG091G01TH/EOG091G01TH.fasta -o per_gene/EOG091G01TH/EOG091G01TH.clustalo.fasta --threads=2 1> per_gene/EOG091G01TH/MSA.stdout.txt 2> per_gene/EOG091G01TH/MSA.stderr.txt
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/d68c9691725a7401923680874285c430.simg
[Sun Jul  5 22:38:10 2020]
Finished job 243.
1239 of 3292 steps (38%) done

[Sun Jul  5 22:38:10 2020]
rule join_groups:
    input: per_gene/EOG091G0L66/EOG091G0L66.ingroup.fasta, per_gene/EOG091G0L66/EOG091G0L66.outgroup.fasta
    output: per_gene/EOG091G0L66/EOG091G0L66.fasta
    jobid: 2322
    wildcards: BUSCO=EOG091G0L66


        cat per_gene/EOG091G0L66/EOG091G0L66.ingroup.fasta per_gene/EOG091G0L66/EOG091G0L66.outgroup.fasta > per_gene/EOG091G0L66/EOG091G0L66.fasta
        
[Sun Jul  5 22:38:10 2020]
Finished job 2322.
1240 of 3292 steps (38%) done

[Sun Jul  5 22:38:10 2020]
rule MSA:
    input: per_gene/EOG091G0L66/EOG091G0L66.fasta
    output: per_gene/EOG091G0L66/EOG091G0L66.clustalo.fasta
    log: per_gene/EOG091G0L66/MSA.stdout.txt, per_gene/EOG091G0L66/MSA.stderr.txt
    jobid: 1764
    wildcards: BUSCO=EOG091G0L66
    threads: 2


        clustalo -i per_gene/EOG091G0L66/EOG091G0L66.fasta -o per_gene/EOG091G0L66/EOG091G0L66.clustalo.fasta --threads=2 1> per_gene/EOG091G0L66/MSA.stdout.txt 2> per_gene/EOG091G0L66/MSA.stderr.txt
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/d68c9691725a7401923680874285c430.simg
[Sun Jul  5 22:38:11 2020]
Finished job 1764.
1241 of 3292 steps (38%) done

[Sun Jul  5 22:38:11 2020]
rule score_and_cut:
    input: per_gene/EOG091G0L66/EOG091G0L66.clustalo.fasta
    output: per_gene/EOG091G0L66/ALICUT_EOG091G0L66.clustalo.fasta
    jobid: 941
    wildcards: BUSCO=EOG091G0L66
    threads: 2


        cd per_gene/EOG091G0L66
        Aliscore.pl -N -r 200000000000000000 -i ../../per_gene/EOG091G0L66/EOG091G0L66.clustalo.fasta &> aliscore.log
        ALICUT.pl -s &> alicut.log
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/63c88c27a0fa300f57066b0ef65fefcb.simg
[33mJob counts:
	count	jobs
	1	infer_single_ML
	1[0m
[33m
        cd per_gene/EOG091G0EVK
	count=$(cat ../../per_gene/EOG091G0EVK/ALICUT_EOG091G0EVK.clustalo.fasta | grep ">" | wc -l)
	if [ "$count" -gt 5 ]
        then
		RAxMLmodel=$(cat ../../per_gene/EOG091G0EVK/EOG091G0EVK.best_model | grep "Best" | cut -d ":" -f 2 | tr -d '[:space:]')
                if [ "$(ls -1 | grep "^RAxML" | wc -l)" -ne 0 ]
		then
			rm RAxML*
		fi
        	raxml -f a -T 2 -m PROTGAMMA$RAxMLmodel         	-p 12345 -x 12345 -# 100         	-s ../../per_gene/EOG091G0EVK/ALICUT_EOG091G0EVK.clustalo.fasta -n EOG091G0EVK.clustalo.aln.ALICUT.$RAxMLmodel 		1> ../../per_gene/EOG091G0EVK/infer_single_ML.stdout.txt 2> ../../per_gene/EOG091G0EVK/infer_single_ML.stderr.txt
	else
		echo "fasta file per_gene/EOG091G0EVK/ALICUT_EOG091G0EVK.clustalo.fasta contains fewer than 5 sequences - skipped" > ../../per_gene/EOG091G0EVK/infer_single_ML.stdout.txt
		touch raxml.skipped
	fi
        touch ../../per_gene/EOG091G0EVK/EOG091G0EVK.raxml.done
        [0m
[Sun Jul  5 22:38:15 2020]
Finished job 1254.
1242 of 3292 steps (38%) done

[Sun Jul  5 22:38:15 2020]
rule score_and_cut:
    input: per_gene/EOG091G01TH/EOG091G01TH.clustalo.fasta
    output: per_gene/EOG091G01TH/ALICUT_EOG091G01TH.clustalo.fasta
    jobid: 431
    wildcards: BUSCO=EOG091G01TH
    threads: 2


        cd per_gene/EOG091G01TH
        Aliscore.pl -N -r 200000000000000000 -i ../../per_gene/EOG091G01TH/EOG091G01TH.clustalo.fasta &> aliscore.log
        ALICUT.pl -s &> alicut.log
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/63c88c27a0fa300f57066b0ef65fefcb.simg
[Sun Jul  5 22:38:21 2020]
Finished job 941.
1243 of 3292 steps (38%) done

[Sun Jul  5 22:38:21 2020]
rule remove_empty:
    input: per_gene/EOG091G0L66/ALICUT_EOG091G0L66.clustalo.fasta
    output: per_gene/EOG091G0L66/empty_check.done
    jobid: 1763
    wildcards: BUSCO=EOG091G0L66


         if [ "$(cat per_gene/EOG091G0L66/ALICUT_EOG091G0L66.clustalo.fasta | grep -v ">" | sed 's/-//g' | grep "^$" | wc -l)" -gt 0 ]
         then
              cp per_gene/EOG091G0L66/ALICUT_EOG091G0L66.clustalo.fasta per_gene/EOG091G0L66/ALICUT_EOG091G0L66.clustalo.fasta.backup
              bash ../scripts/remove_empty.sh per_gene/EOG091G0L66/ALICUT_EOG091G0L66.clustalo.fasta.backup > per_gene/EOG091G0L66/ALICUT_EOG091G0L66.clustalo.fasta
         fi
         touch per_gene/EOG091G0L66/empty_check.done
         
[Sun Jul  5 22:38:21 2020]
Finished job 1763.
1244 of 3292 steps (38%) done

[Sun Jul  5 22:38:21 2020]
rule find_best_model:
    input: per_gene/EOG091G0L66/ALICUT_EOG091G0L66.clustalo.fasta, per_gene/EOG091G0L66/empty_check.done
    output: per_gene/EOG091G0L66/EOG091G0L66.best_model
    log: per_gene/EOG091G0L66/find_best_model.stderr.txt
    jobid: 940
    wildcards: BUSCO=EOG091G0L66
    threads: 2


        cd per_gene/EOG091G0L66
        if [ ! -d find_best_model ]
        then
            mkdir find_best_model
        fi
        cd find_best_model
        ln -s ../../../per_gene/EOG091G0L66/ALICUT_EOG091G0L66.clustalo.fasta EOG091G0L66.fasta
        ProteinModelSelection.pl EOG091G0L66.fasta 1> ../../../per_gene/EOG091G0L66/EOG091G0L66.best_model 2> ../../../per_gene/EOG091G0L66/find_best_model.stderr.txt
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/c0c09ee657b1e27f2c5687e0e9aa8d70.simg
[Sun Jul  5 22:38:22 2020]
Finished job 3194.
1245 of 3292 steps (38%) done

[Sun Jul  5 22:38:22 2020]
rule get_outgroups:
    input: per_gene/EOG091G0GIC/EOG091G0GIC.ingroup.fasta
    output: per_gene/EOG091G0GIC/EOG091G0GIC.orthodb.fasta, per_gene/EOG091G0GIC/EOG091G0GIC.outgroup.fasta
    log: per_gene/EOG091G0GIC/get_outgroups.stdout.txt, per_gene/EOG091G0GIC/get_outgroups.stderr.txt
    jobid: 3195
    wildcards: BUSCO=EOG091G0GIC


        #download fastas from Orhtodb for BUSCO id
        for i in {1..5}
        do
             wget "http://www.orthodb.org/fasta?query=EOG091G0GIC&level=33208" -O per_gene/EOG091G0GIC/EOG091G0GIC.orthodb.fasta 1> per_gene/EOG091G0GIC/get_outgroups.stdout.txt 2> per_gene/EOG091G0GIC/get_outgroups.stderr.txt && break || echo -e "try again ($i)" && sleep 15
        done

	#This is quick an dirty for now and just takes the first protein if there is more than one for an outgroup taxon
        bash ../scripts/download_outgroups.sh taxids.txt per_gene/EOG091G0GIC/EOG091G0GIC.orthodb.fasta > per_gene/EOG091G0GIC/EOG091G0GIC.outgroup.fasta
        
[Sun Jul  5 22:38:23 2020]
Finished job 3195.
1246 of 3292 steps (38%) done

[Sun Jul  5 22:38:23 2020]
rule join_groups:
    input: per_gene/EOG091G0GIC/EOG091G0GIC.ingroup.fasta, per_gene/EOG091G0GIC/EOG091G0GIC.outgroup.fasta
    output: per_gene/EOG091G0GIC/EOG091G0GIC.fasta
    jobid: 2421
    wildcards: BUSCO=EOG091G0GIC


        cat per_gene/EOG091G0GIC/EOG091G0GIC.ingroup.fasta per_gene/EOG091G0GIC/EOG091G0GIC.outgroup.fasta > per_gene/EOG091G0GIC/EOG091G0GIC.fasta
        
[Sun Jul  5 22:38:24 2020]
Finished job 2421.
1247 of 3292 steps (38%) done

[Sun Jul  5 22:38:24 2020]
rule MSA:
    input: per_gene/EOG091G0GIC/EOG091G0GIC.fasta
    output: per_gene/EOG091G0GIC/EOG091G0GIC.clustalo.fasta
    log: per_gene/EOG091G0GIC/MSA.stdout.txt, per_gene/EOG091G0GIC/MSA.stderr.txt
    jobid: 1962
    wildcards: BUSCO=EOG091G0GIC
    threads: 2


        clustalo -i per_gene/EOG091G0GIC/EOG091G0GIC.fasta -o per_gene/EOG091G0GIC/EOG091G0GIC.clustalo.fasta --threads=2 1> per_gene/EOG091G0GIC/MSA.stdout.txt 2> per_gene/EOG091G0GIC/MSA.stderr.txt
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/d68c9691725a7401923680874285c430.simg
[Sun Jul  5 22:38:25 2020]
Finished job 1962.
1248 of 3292 steps (38%) done

[Sun Jul  5 22:38:25 2020]
rule score_and_cut:
    input: per_gene/EOG091G0GIC/EOG091G0GIC.clustalo.fasta
    output: per_gene/EOG091G0GIC/ALICUT_EOG091G0GIC.clustalo.fasta
    jobid: 1139
    wildcards: BUSCO=EOG091G0GIC
    threads: 2


        cd per_gene/EOG091G0GIC
        Aliscore.pl -N -r 200000000000000000 -i ../../per_gene/EOG091G0GIC/EOG091G0GIC.clustalo.fasta &> aliscore.log
        ALICUT.pl -s &> alicut.log
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/63c88c27a0fa300f57066b0ef65fefcb.simg
[Sun Jul  5 22:38:27 2020]
Finished job 1160.
1249 of 3292 steps (38%) done

[Sun Jul  5 22:38:27 2020]
rule infer_single_ML:
    input: per_gene/EOG091G0JYQ/EOG091G0JYQ.best_model, per_gene/EOG091G0JYQ/ALICUT_EOG091G0JYQ.clustalo.fasta
    output: per_gene/EOG091G0JYQ/EOG091G0JYQ.raxml.done
    log: per_gene/EOG091G0JYQ/infer_single_ML.stdout.txt, per_gene/EOG091G0JYQ/infer_single_ML.stderr.txt
    jobid: 374
    wildcards: BUSCO=EOG091G0JYQ
    threads: 2


        cd per_gene/EOG091G0JYQ
	count=$(cat ../../per_gene/EOG091G0JYQ/ALICUT_EOG091G0JYQ.clustalo.fasta | grep ">" | wc -l)
	if [ "$count" -gt 5 ]
        then
		RAxMLmodel=$(cat ../../per_gene/EOG091G0JYQ/EOG091G0JYQ.best_model | grep "Best" | cut -d ":" -f 2 | tr -d '[:space:]')
                if [ "$(ls -1 | grep "^RAxML" | wc -l)" -ne 0 ]
		then
			rm RAxML*
		fi
        	raxml -f a -T 2 -m PROTGAMMA$RAxMLmodel         	-p 12345 -x 12345 -# 100         	-s ../../per_gene/EOG091G0JYQ/ALICUT_EOG091G0JYQ.clustalo.fasta -n EOG091G0JYQ.clustalo.aln.ALICUT.$RAxMLmodel 		1> ../../per_gene/EOG091G0JYQ/infer_single_ML.stdout.txt 2> ../../per_gene/EOG091G0JYQ/infer_single_ML.stderr.txt
	else
		echo "fasta file per_gene/EOG091G0JYQ/ALICUT_EOG091G0JYQ.clustalo.fasta contains fewer than 5 sequences - skipped" > ../../per_gene/EOG091G0JYQ/infer_single_ML.stdout.txt
		touch raxml.skipped
	fi
        touch ../../per_gene/EOG091G0JYQ/EOG091G0JYQ.raxml.done
        
[33mJob counts:
	count	jobs
	1	infer_single_ML
	1[0m
[33m
        cd per_gene/EOG091G0JYQ
	count=$(cat ../../per_gene/EOG091G0JYQ/ALICUT_EOG091G0JYQ.clustalo.fasta | grep ">" | wc -l)
	if [ "$count" -gt 5 ]
        then
		RAxMLmodel=$(cat ../../per_gene/EOG091G0JYQ/EOG091G0JYQ.best_model | grep "Best" | cut -d ":" -f 2 | tr -d '[:space:]')
                if [ "$(ls -1 | grep "^RAxML" | wc -l)" -ne 0 ]
		then
			rm RAxML*
		fi
        	raxml -f a -T 2 -m PROTGAMMA$RAxMLmodel         	-p 12345 -x 12345 -# 100         	-s ../../per_gene/EOG091G0JYQ/ALICUT_EOG091G0JYQ.clustalo.fasta -n EOG091G0JYQ.clustalo.aln.ALICUT.$RAxMLmodel 		1> ../../per_gene/EOG091G0JYQ/infer_single_ML.stdout.txt 2> ../../per_gene/EOG091G0JYQ/infer_single_ML.stderr.txt
	else
		echo "fasta file per_gene/EOG091G0JYQ/ALICUT_EOG091G0JYQ.clustalo.fasta contains fewer than 5 sequences - skipped" > ../../per_gene/EOG091G0JYQ/infer_single_ML.stdout.txt
		touch raxml.skipped
	fi
        touch ../../per_gene/EOG091G0JYQ/EOG091G0JYQ.raxml.done
        [0m
[Sun Jul  5 22:38:27 2020]
Finished job 431.
1250 of 3292 steps (38%) done

[Sun Jul  5 22:38:27 2020]
rule remove_empty:
    input: per_gene/EOG091G01TH/ALICUT_EOG091G01TH.clustalo.fasta
    output: per_gene/EOG091G01TH/empty_check.done
    jobid: 1253
    wildcards: BUSCO=EOG091G01TH


         if [ "$(cat per_gene/EOG091G01TH/ALICUT_EOG091G01TH.clustalo.fasta | grep -v ">" | sed 's/-//g' | grep "^$" | wc -l)" -gt 0 ]
         then
              cp per_gene/EOG091G01TH/ALICUT_EOG091G01TH.clustalo.fasta per_gene/EOG091G01TH/ALICUT_EOG091G01TH.clustalo.fasta.backup
              bash ../scripts/remove_empty.sh per_gene/EOG091G01TH/ALICUT_EOG091G01TH.clustalo.fasta.backup > per_gene/EOG091G01TH/ALICUT_EOG091G01TH.clustalo.fasta
         fi
         touch per_gene/EOG091G01TH/empty_check.done
         
[Sun Jul  5 22:38:27 2020]
Finished job 1253.
1251 of 3292 steps (38%) done

[Sun Jul  5 22:38:27 2020]
rule find_best_model:
    input: per_gene/EOG091G01TH/ALICUT_EOG091G01TH.clustalo.fasta, per_gene/EOG091G01TH/empty_check.done
    output: per_gene/EOG091G01TH/EOG091G01TH.best_model
    log: per_gene/EOG091G01TH/find_best_model.stderr.txt
    jobid: 430
    wildcards: BUSCO=EOG091G01TH
    threads: 2


        cd per_gene/EOG091G01TH
        if [ ! -d find_best_model ]
        then
            mkdir find_best_model
        fi
        cd find_best_model
        ln -s ../../../per_gene/EOG091G01TH/ALICUT_EOG091G01TH.clustalo.fasta EOG091G01TH.fasta
        ProteinModelSelection.pl EOG091G01TH.fasta 1> ../../../per_gene/EOG091G01TH/EOG091G01TH.best_model 2> ../../../per_gene/EOG091G01TH/find_best_model.stderr.txt
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/c0c09ee657b1e27f2c5687e0e9aa8d70.simg
[Sun Jul  5 22:38:36 2020]
Finished job 1139.
1252 of 3292 steps (38%) done

[Sun Jul  5 22:38:36 2020]
rule remove_empty:
    input: per_gene/EOG091G0GIC/ALICUT_EOG091G0GIC.clustalo.fasta
    output: per_gene/EOG091G0GIC/empty_check.done
    jobid: 1961
    wildcards: BUSCO=EOG091G0GIC


         if [ "$(cat per_gene/EOG091G0GIC/ALICUT_EOG091G0GIC.clustalo.fasta | grep -v ">" | sed 's/-//g' | grep "^$" | wc -l)" -gt 0 ]
         then
              cp per_gene/EOG091G0GIC/ALICUT_EOG091G0GIC.clustalo.fasta per_gene/EOG091G0GIC/ALICUT_EOG091G0GIC.clustalo.fasta.backup
              bash ../scripts/remove_empty.sh per_gene/EOG091G0GIC/ALICUT_EOG091G0GIC.clustalo.fasta.backup > per_gene/EOG091G0GIC/ALICUT_EOG091G0GIC.clustalo.fasta
         fi
         touch per_gene/EOG091G0GIC/empty_check.done
         
[Sun Jul  5 22:38:36 2020]
Finished job 1961.
1253 of 3292 steps (38%) done

[Sun Jul  5 22:38:36 2020]
rule find_best_model:
    input: per_gene/EOG091G0GIC/ALICUT_EOG091G0GIC.clustalo.fasta, per_gene/EOG091G0GIC/empty_check.done
    output: per_gene/EOG091G0GIC/EOG091G0GIC.best_model
    log: per_gene/EOG091G0GIC/find_best_model.stderr.txt
    jobid: 1138
    wildcards: BUSCO=EOG091G0GIC
    threads: 2


        cd per_gene/EOG091G0GIC
        if [ ! -d find_best_model ]
        then
            mkdir find_best_model
        fi
        cd find_best_model
        ln -s ../../../per_gene/EOG091G0GIC/ALICUT_EOG091G0GIC.clustalo.fasta EOG091G0GIC.fasta
        ProteinModelSelection.pl EOG091G0GIC.fasta 1> ../../../per_gene/EOG091G0GIC/EOG091G0GIC.best_model 2> ../../../per_gene/EOG091G0GIC/find_best_model.stderr.txt
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/c0c09ee657b1e27f2c5687e0e9aa8d70.simg
[Sun Jul  5 22:39:01 2020]
Finished job 86.
1254 of 3292 steps (38%) done

[Sun Jul  5 22:39:01 2020]
rule get_seqs:
    input: /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ingroup.txt, /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/outgroup.txt
    output: per_gene/EOG091G03TZ/EOG091G03TZ.ingroup.fasta
    log: per_gene/EOG091G03TZ/get_seqs.stdout.txt, per_gene/EOG091G03TZ/get_seqs.stderr.txt
    jobid: 2518
    wildcards: BUSCO=EOG091G03TZ
    threads: 2


	basedir=$(pwd)
        cd per_gene/EOG091G03TZ
        
        bash $basedir/../scripts/fetch_seqs.sh EOG091G03TZ /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ingroup.txt /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/outgroup.txt 1> ../../per_gene/EOG091G03TZ/get_seqs.stdout.txt 2> ../../per_gene/EOG091G03TZ/get_seqs.stderr.txt
	mv EOG091G03TZ.fasta $basedir/per_gene/EOG091G03TZ/EOG091G03TZ.ingroup.fasta
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/72476f9d9a5bd0627b4d721143a21354.simg
[Sun Jul  5 22:39:10 2020]
Finished job 940.
1255 of 3292 steps (38%) done

[Sun Jul  5 22:39:10 2020]
rule infer_single_ML:
    input: per_gene/EOG091G0L66/EOG091G0L66.best_model, per_gene/EOG091G0L66/ALICUT_EOG091G0L66.clustalo.fasta
    output: per_gene/EOG091G0L66/EOG091G0L66.raxml.done
    log: per_gene/EOG091G0L66/infer_single_ML.stdout.txt, per_gene/EOG091G0L66/infer_single_ML.stderr.txt
    jobid: 264
    wildcards: BUSCO=EOG091G0L66
    threads: 2


        cd per_gene/EOG091G0L66
	count=$(cat ../../per_gene/EOG091G0L66/ALICUT_EOG091G0L66.clustalo.fasta | grep ">" | wc -l)
	if [ "$count" -gt 5 ]
        then
		RAxMLmodel=$(cat ../../per_gene/EOG091G0L66/EOG091G0L66.best_model | grep "Best" | cut -d ":" -f 2 | tr -d '[:space:]')
                if [ "$(ls -1 | grep "^RAxML" | wc -l)" -ne 0 ]
		then
			rm RAxML*
		fi
        	raxml -f a -T 2 -m PROTGAMMA$RAxMLmodel         	-p 12345 -x 12345 -# 100         	-s ../../per_gene/EOG091G0L66/ALICUT_EOG091G0L66.clustalo.fasta -n EOG091G0L66.clustalo.aln.ALICUT.$RAxMLmodel 		1> ../../per_gene/EOG091G0L66/infer_single_ML.stdout.txt 2> ../../per_gene/EOG091G0L66/infer_single_ML.stderr.txt
	else
		echo "fasta file per_gene/EOG091G0L66/ALICUT_EOG091G0L66.clustalo.fasta contains fewer than 5 sequences - skipped" > ../../per_gene/EOG091G0L66/infer_single_ML.stdout.txt
		touch raxml.skipped
	fi
        touch ../../per_gene/EOG091G0L66/EOG091G0L66.raxml.done
        
[33mJob counts:
	count	jobs
	1	infer_single_ML
	1[0m
[33m
        cd per_gene/EOG091G0L66
	count=$(cat ../../per_gene/EOG091G0L66/ALICUT_EOG091G0L66.clustalo.fasta | grep ">" | wc -l)
	if [ "$count" -gt 5 ]
        then
		RAxMLmodel=$(cat ../../per_gene/EOG091G0L66/EOG091G0L66.best_model | grep "Best" | cut -d ":" -f 2 | tr -d '[:space:]')
                if [ "$(ls -1 | grep "^RAxML" | wc -l)" -ne 0 ]
		then
			rm RAxML*
		fi
        	raxml -f a -T 2 -m PROTGAMMA$RAxMLmodel         	-p 12345 -x 12345 -# 100         	-s ../../per_gene/EOG091G0L66/ALICUT_EOG091G0L66.clustalo.fasta -n EOG091G0L66.clustalo.aln.ALICUT.$RAxMLmodel 		1> ../../per_gene/EOG091G0L66/infer_single_ML.stdout.txt 2> ../../per_gene/EOG091G0L66/infer_single_ML.stderr.txt
	else
		echo "fasta file per_gene/EOG091G0L66/ALICUT_EOG091G0L66.clustalo.fasta contains fewer than 5 sequences - skipped" > ../../per_gene/EOG091G0L66/infer_single_ML.stdout.txt
		touch raxml.skipped
	fi
        touch ../../per_gene/EOG091G0L66/EOG091G0L66.raxml.done
        [0m
[Sun Jul  5 22:39:15 2020]
Finished job 1138.
1256 of 3292 steps (38%) done

[Sun Jul  5 22:39:15 2020]
rule infer_single_ML:
    input: per_gene/EOG091G0GIC/EOG091G0GIC.best_model, per_gene/EOG091G0GIC/ALICUT_EOG091G0GIC.clustalo.fasta
    output: per_gene/EOG091G0GIC/EOG091G0GIC.raxml.done
    log: per_gene/EOG091G0GIC/infer_single_ML.stdout.txt, per_gene/EOG091G0GIC/infer_single_ML.stderr.txt
    jobid: 363
    wildcards: BUSCO=EOG091G0GIC
    threads: 2


        cd per_gene/EOG091G0GIC
	count=$(cat ../../per_gene/EOG091G0GIC/ALICUT_EOG091G0GIC.clustalo.fasta | grep ">" | wc -l)
	if [ "$count" -gt 5 ]
        then
		RAxMLmodel=$(cat ../../per_gene/EOG091G0GIC/EOG091G0GIC.best_model | grep "Best" | cut -d ":" -f 2 | tr -d '[:space:]')
                if [ "$(ls -1 | grep "^RAxML" | wc -l)" -ne 0 ]
		then
			rm RAxML*
		fi
        	raxml -f a -T 2 -m PROTGAMMA$RAxMLmodel         	-p 12345 -x 12345 -# 100         	-s ../../per_gene/EOG091G0GIC/ALICUT_EOG091G0GIC.clustalo.fasta -n EOG091G0GIC.clustalo.aln.ALICUT.$RAxMLmodel 		1> ../../per_gene/EOG091G0GIC/infer_single_ML.stdout.txt 2> ../../per_gene/EOG091G0GIC/infer_single_ML.stderr.txt
	else
		echo "fasta file per_gene/EOG091G0GIC/ALICUT_EOG091G0GIC.clustalo.fasta contains fewer than 5 sequences - skipped" > ../../per_gene/EOG091G0GIC/infer_single_ML.stdout.txt
		touch raxml.skipped
	fi
        touch ../../per_gene/EOG091G0GIC/EOG091G0GIC.raxml.done
        
[33mJob counts:
	count	jobs
	1	infer_single_ML
	1[0m
[33m
        cd per_gene/EOG091G0GIC
	count=$(cat ../../per_gene/EOG091G0GIC/ALICUT_EOG091G0GIC.clustalo.fasta | grep ">" | wc -l)
	if [ "$count" -gt 5 ]
        then
		RAxMLmodel=$(cat ../../per_gene/EOG091G0GIC/EOG091G0GIC.best_model | grep "Best" | cut -d ":" -f 2 | tr -d '[:space:]')
                if [ "$(ls -1 | grep "^RAxML" | wc -l)" -ne 0 ]
		then
			rm RAxML*
		fi
        	raxml -f a -T 2 -m PROTGAMMA$RAxMLmodel         	-p 12345 -x 12345 -# 100         	-s ../../per_gene/EOG091G0GIC/ALICUT_EOG091G0GIC.clustalo.fasta -n EOG091G0GIC.clustalo.aln.ALICUT.$RAxMLmodel 		1> ../../per_gene/EOG091G0GIC/infer_single_ML.stdout.txt 2> ../../per_gene/EOG091G0GIC/infer_single_ML.stderr.txt
	else
		echo "fasta file per_gene/EOG091G0GIC/ALICUT_EOG091G0GIC.clustalo.fasta contains fewer than 5 sequences - skipped" > ../../per_gene/EOG091G0GIC/infer_single_ML.stdout.txt
		touch raxml.skipped
	fi
        touch ../../per_gene/EOG091G0GIC/EOG091G0GIC.raxml.done
        [0m
[Sun Jul  5 22:39:19 2020]
Finished job 2518.
1257 of 3292 steps (38%) done

[Sun Jul  5 22:39:19 2020]
rule get_outgroups:
    input: per_gene/EOG091G03TZ/EOG091G03TZ.ingroup.fasta
    output: per_gene/EOG091G03TZ/EOG091G03TZ.orthodb.fasta, per_gene/EOG091G03TZ/EOG091G03TZ.outgroup.fasta
    log: per_gene/EOG091G03TZ/get_outgroups.stdout.txt, per_gene/EOG091G03TZ/get_outgroups.stderr.txt
    jobid: 2519
    wildcards: BUSCO=EOG091G03TZ


        #download fastas from Orhtodb for BUSCO id
        for i in {1..5}
        do
             wget "http://www.orthodb.org/fasta?query=EOG091G03TZ&level=33208" -O per_gene/EOG091G03TZ/EOG091G03TZ.orthodb.fasta 1> per_gene/EOG091G03TZ/get_outgroups.stdout.txt 2> per_gene/EOG091G03TZ/get_outgroups.stderr.txt && break || echo -e "try again ($i)" && sleep 15
        done

	#This is quick an dirty for now and just takes the first protein if there is more than one for an outgroup taxon
        bash ../scripts/download_outgroups.sh taxids.txt per_gene/EOG091G03TZ/EOG091G03TZ.orthodb.fasta > per_gene/EOG091G03TZ/EOG091G03TZ.outgroup.fasta
        
[Sun Jul  5 22:39:20 2020]
Finished job 2519.
1258 of 3292 steps (38%) done

[Sun Jul  5 22:39:20 2020]
rule join_groups:
    input: per_gene/EOG091G03TZ/EOG091G03TZ.ingroup.fasta, per_gene/EOG091G03TZ/EOG091G03TZ.outgroup.fasta
    output: per_gene/EOG091G03TZ/EOG091G03TZ.fasta
    jobid: 2083
    wildcards: BUSCO=EOG091G03TZ


        cat per_gene/EOG091G03TZ/EOG091G03TZ.ingroup.fasta per_gene/EOG091G03TZ/EOG091G03TZ.outgroup.fasta > per_gene/EOG091G03TZ/EOG091G03TZ.fasta
        
[Sun Jul  5 22:39:20 2020]
Finished job 2083.
1259 of 3292 steps (38%) done

[Sun Jul  5 22:39:20 2020]
rule MSA:
    input: per_gene/EOG091G03TZ/EOG091G03TZ.fasta
    output: per_gene/EOG091G03TZ/EOG091G03TZ.clustalo.fasta
    log: per_gene/EOG091G03TZ/MSA.stdout.txt, per_gene/EOG091G03TZ/MSA.stderr.txt
    jobid: 1286
    wildcards: BUSCO=EOG091G03TZ
    threads: 2


        clustalo -i per_gene/EOG091G03TZ/EOG091G03TZ.fasta -o per_gene/EOG091G03TZ/EOG091G03TZ.clustalo.fasta --threads=2 1> per_gene/EOG091G03TZ/MSA.stdout.txt 2> per_gene/EOG091G03TZ/MSA.stderr.txt
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/d68c9691725a7401923680874285c430.simg
[Sun Jul  5 22:39:24 2020]
Finished job 240.
1260 of 3292 steps (38%) done

[Sun Jul  5 22:39:24 2020]
rule get_seqs:
    input: /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ingroup.txt, /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/outgroup.txt
    output: per_gene/EOG091G0IZX/EOG091G0IZX.ingroup.fasta
    log: per_gene/EOG091G0IZX/get_seqs.stdout.txt, per_gene/EOG091G0IZX/get_seqs.stderr.txt
    jobid: 2720
    wildcards: BUSCO=EOG091G0IZX
    threads: 2


	basedir=$(pwd)
        cd per_gene/EOG091G0IZX
        
        bash $basedir/../scripts/fetch_seqs.sh EOG091G0IZX /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ingroup.txt /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/outgroup.txt 1> ../../per_gene/EOG091G0IZX/get_seqs.stdout.txt 2> ../../per_gene/EOG091G0IZX/get_seqs.stderr.txt
	mv EOG091G0IZX.fasta $basedir/per_gene/EOG091G0IZX/EOG091G0IZX.ingroup.fasta
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/72476f9d9a5bd0627b4d721143a21354.simg
[Sun Jul  5 22:39:24 2020]
Finished job 1286.
1261 of 3292 steps (38%) done

[Sun Jul  5 22:39:24 2020]
rule score_and_cut:
    input: per_gene/EOG091G03TZ/EOG091G03TZ.clustalo.fasta
    output: per_gene/EOG091G03TZ/ALICUT_EOG091G03TZ.clustalo.fasta
    jobid: 463
    wildcards: BUSCO=EOG091G03TZ
    threads: 2


        cd per_gene/EOG091G03TZ
        Aliscore.pl -N -r 200000000000000000 -i ../../per_gene/EOG091G03TZ/EOG091G03TZ.clustalo.fasta &> aliscore.log
        ALICUT.pl -s &> alicut.log
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/63c88c27a0fa300f57066b0ef65fefcb.simg
[Sun Jul  5 22:39:34 2020]
Finished job 430.
1262 of 3292 steps (38%) done

[Sun Jul  5 22:39:34 2020]
rule infer_single_ML:
    input: per_gene/EOG091G01TH/EOG091G01TH.best_model, per_gene/EOG091G01TH/ALICUT_EOG091G01TH.clustalo.fasta
    output: per_gene/EOG091G01TH/EOG091G01TH.raxml.done
    log: per_gene/EOG091G01TH/infer_single_ML.stdout.txt, per_gene/EOG091G01TH/infer_single_ML.stderr.txt
    jobid: 9
    wildcards: BUSCO=EOG091G01TH
    threads: 2


        cd per_gene/EOG091G01TH
	count=$(cat ../../per_gene/EOG091G01TH/ALICUT_EOG091G01TH.clustalo.fasta | grep ">" | wc -l)
	if [ "$count" -gt 5 ]
        then
		RAxMLmodel=$(cat ../../per_gene/EOG091G01TH/EOG091G01TH.best_model | grep "Best" | cut -d ":" -f 2 | tr -d '[:space:]')
                if [ "$(ls -1 | grep "^RAxML" | wc -l)" -ne 0 ]
		then
			rm RAxML*
		fi
        	raxml -f a -T 2 -m PROTGAMMA$RAxMLmodel         	-p 12345 -x 12345 -# 100         	-s ../../per_gene/EOG091G01TH/ALICUT_EOG091G01TH.clustalo.fasta -n EOG091G01TH.clustalo.aln.ALICUT.$RAxMLmodel 		1> ../../per_gene/EOG091G01TH/infer_single_ML.stdout.txt 2> ../../per_gene/EOG091G01TH/infer_single_ML.stderr.txt
	else
		echo "fasta file per_gene/EOG091G01TH/ALICUT_EOG091G01TH.clustalo.fasta contains fewer than 5 sequences - skipped" > ../../per_gene/EOG091G01TH/infer_single_ML.stdout.txt
		touch raxml.skipped
	fi
        touch ../../per_gene/EOG091G01TH/EOG091G01TH.raxml.done
        
[33mJob counts:
	count	jobs
	1	infer_single_ML
	1[0m
[33m
        cd per_gene/EOG091G01TH
	count=$(cat ../../per_gene/EOG091G01TH/ALICUT_EOG091G01TH.clustalo.fasta | grep ">" | wc -l)
	if [ "$count" -gt 5 ]
        then
		RAxMLmodel=$(cat ../../per_gene/EOG091G01TH/EOG091G01TH.best_model | grep "Best" | cut -d ":" -f 2 | tr -d '[:space:]')
                if [ "$(ls -1 | grep "^RAxML" | wc -l)" -ne 0 ]
		then
			rm RAxML*
		fi
        	raxml -f a -T 2 -m PROTGAMMA$RAxMLmodel         	-p 12345 -x 12345 -# 100         	-s ../../per_gene/EOG091G01TH/ALICUT_EOG091G01TH.clustalo.fasta -n EOG091G01TH.clustalo.aln.ALICUT.$RAxMLmodel 		1> ../../per_gene/EOG091G01TH/infer_single_ML.stdout.txt 2> ../../per_gene/EOG091G01TH/infer_single_ML.stderr.txt
	else
		echo "fasta file per_gene/EOG091G01TH/ALICUT_EOG091G01TH.clustalo.fasta contains fewer than 5 sequences - skipped" > ../../per_gene/EOG091G01TH/infer_single_ML.stdout.txt
		touch raxml.skipped
	fi
        touch ../../per_gene/EOG091G01TH/EOG091G01TH.raxml.done
        [0m
[Sun Jul  5 22:39:36 2020]
Finished job 463.
1263 of 3292 steps (38%) done

[Sun Jul  5 22:39:36 2020]
rule remove_empty:
    input: per_gene/EOG091G03TZ/ALICUT_EOG091G03TZ.clustalo.fasta
    output: per_gene/EOG091G03TZ/empty_check.done
    jobid: 1285
    wildcards: BUSCO=EOG091G03TZ


         if [ "$(cat per_gene/EOG091G03TZ/ALICUT_EOG091G03TZ.clustalo.fasta | grep -v ">" | sed 's/-//g' | grep "^$" | wc -l)" -gt 0 ]
         then
              cp per_gene/EOG091G03TZ/ALICUT_EOG091G03TZ.clustalo.fasta per_gene/EOG091G03TZ/ALICUT_EOG091G03TZ.clustalo.fasta.backup
              bash ../scripts/remove_empty.sh per_gene/EOG091G03TZ/ALICUT_EOG091G03TZ.clustalo.fasta.backup > per_gene/EOG091G03TZ/ALICUT_EOG091G03TZ.clustalo.fasta
         fi
         touch per_gene/EOG091G03TZ/empty_check.done
         
[Sun Jul  5 22:39:36 2020]
Finished job 1285.
1264 of 3292 steps (38%) done

[Sun Jul  5 22:39:36 2020]
rule find_best_model:
    input: per_gene/EOG091G03TZ/ALICUT_EOG091G03TZ.clustalo.fasta, per_gene/EOG091G03TZ/empty_check.done
    output: per_gene/EOG091G03TZ/EOG091G03TZ.best_model
    log: per_gene/EOG091G03TZ/find_best_model.stderr.txt
    jobid: 462
    wildcards: BUSCO=EOG091G03TZ
    threads: 2


        cd per_gene/EOG091G03TZ
        if [ ! -d find_best_model ]
        then
            mkdir find_best_model
        fi
        cd find_best_model
        ln -s ../../../per_gene/EOG091G03TZ/ALICUT_EOG091G03TZ.clustalo.fasta EOG091G03TZ.fasta
        ProteinModelSelection.pl EOG091G03TZ.fasta 1> ../../../per_gene/EOG091G03TZ/EOG091G03TZ.best_model 2> ../../../per_gene/EOG091G03TZ/find_best_model.stderr.txt
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/c0c09ee657b1e27f2c5687e0e9aa8d70.simg
[Sun Jul  5 22:39:37 2020]
Finished job 2720.
1265 of 3292 steps (38%) done

[Sun Jul  5 22:39:37 2020]
rule get_outgroups:
    input: per_gene/EOG091G0IZX/EOG091G0IZX.ingroup.fasta
    output: per_gene/EOG091G0IZX/EOG091G0IZX.orthodb.fasta, per_gene/EOG091G0IZX/EOG091G0IZX.outgroup.fasta
    log: per_gene/EOG091G0IZX/get_outgroups.stdout.txt, per_gene/EOG091G0IZX/get_outgroups.stderr.txt
    jobid: 2721
    wildcards: BUSCO=EOG091G0IZX


        #download fastas from Orhtodb for BUSCO id
        for i in {1..5}
        do
             wget "http://www.orthodb.org/fasta?query=EOG091G0IZX&level=33208" -O per_gene/EOG091G0IZX/EOG091G0IZX.orthodb.fasta 1> per_gene/EOG091G0IZX/get_outgroups.stdout.txt 2> per_gene/EOG091G0IZX/get_outgroups.stderr.txt && break || echo -e "try again ($i)" && sleep 15
        done

	#This is quick an dirty for now and just takes the first protein if there is more than one for an outgroup taxon
        bash ../scripts/download_outgroups.sh taxids.txt per_gene/EOG091G0IZX/EOG091G0IZX.orthodb.fasta > per_gene/EOG091G0IZX/EOG091G0IZX.outgroup.fasta
        
[Sun Jul  5 22:39:38 2020]
Finished job 2721.
1266 of 3292 steps (38%) done

[Sun Jul  5 22:39:38 2020]
rule join_groups:
    input: per_gene/EOG091G0IZX/EOG091G0IZX.ingroup.fasta, per_gene/EOG091G0IZX/EOG091G0IZX.outgroup.fasta
    output: per_gene/EOG091G0IZX/EOG091G0IZX.fasta
    jobid: 2184
    wildcards: BUSCO=EOG091G0IZX


        cat per_gene/EOG091G0IZX/EOG091G0IZX.ingroup.fasta per_gene/EOG091G0IZX/EOG091G0IZX.outgroup.fasta > per_gene/EOG091G0IZX/EOG091G0IZX.fasta
        
[Sun Jul  5 22:39:38 2020]
Finished job 2184.
1267 of 3292 steps (38%) done

[Sun Jul  5 22:39:38 2020]
rule MSA:
    input: per_gene/EOG091G0IZX/EOG091G0IZX.fasta
    output: per_gene/EOG091G0IZX/EOG091G0IZX.clustalo.fasta
    log: per_gene/EOG091G0IZX/MSA.stdout.txt, per_gene/EOG091G0IZX/MSA.stderr.txt
    jobid: 1488
    wildcards: BUSCO=EOG091G0IZX
    threads: 2


        clustalo -i per_gene/EOG091G0IZX/EOG091G0IZX.fasta -o per_gene/EOG091G0IZX/EOG091G0IZX.clustalo.fasta --threads=2 1> per_gene/EOG091G0IZX/MSA.stdout.txt 2> per_gene/EOG091G0IZX/MSA.stderr.txt
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/d68c9691725a7401923680874285c430.simg
[Sun Jul  5 22:39:39 2020]
Finished job 1488.
1268 of 3292 steps (39%) done

[Sun Jul  5 22:39:39 2020]
rule score_and_cut:
    input: per_gene/EOG091G0IZX/EOG091G0IZX.clustalo.fasta
    output: per_gene/EOG091G0IZX/ALICUT_EOG091G0IZX.clustalo.fasta
    jobid: 665
    wildcards: BUSCO=EOG091G0IZX
    threads: 2


        cd per_gene/EOG091G0IZX
        Aliscore.pl -N -r 200000000000000000 -i ../../per_gene/EOG091G0IZX/EOG091G0IZX.clustalo.fasta &> aliscore.log
        ALICUT.pl -s &> alicut.log
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/63c88c27a0fa300f57066b0ef65fefcb.simg
[Sun Jul  5 22:39:49 2020]
Finished job 665.
1269 of 3292 steps (39%) done

[Sun Jul  5 22:39:49 2020]
rule remove_empty:
    input: per_gene/EOG091G0IZX/ALICUT_EOG091G0IZX.clustalo.fasta
    output: per_gene/EOG091G0IZX/empty_check.done
    jobid: 1487
    wildcards: BUSCO=EOG091G0IZX


         if [ "$(cat per_gene/EOG091G0IZX/ALICUT_EOG091G0IZX.clustalo.fasta | grep -v ">" | sed 's/-//g' | grep "^$" | wc -l)" -gt 0 ]
         then
              cp per_gene/EOG091G0IZX/ALICUT_EOG091G0IZX.clustalo.fasta per_gene/EOG091G0IZX/ALICUT_EOG091G0IZX.clustalo.fasta.backup
              bash ../scripts/remove_empty.sh per_gene/EOG091G0IZX/ALICUT_EOG091G0IZX.clustalo.fasta.backup > per_gene/EOG091G0IZX/ALICUT_EOG091G0IZX.clustalo.fasta
         fi
         touch per_gene/EOG091G0IZX/empty_check.done
         
[Sun Jul  5 22:39:49 2020]
Finished job 1487.
1270 of 3292 steps (39%) done

[Sun Jul  5 22:39:49 2020]
rule find_best_model:
    input: per_gene/EOG091G0IZX/ALICUT_EOG091G0IZX.clustalo.fasta, per_gene/EOG091G0IZX/empty_check.done
    output: per_gene/EOG091G0IZX/EOG091G0IZX.best_model
    log: per_gene/EOG091G0IZX/find_best_model.stderr.txt
    jobid: 664
    wildcards: BUSCO=EOG091G0IZX
    threads: 2


        cd per_gene/EOG091G0IZX
        if [ ! -d find_best_model ]
        then
            mkdir find_best_model
        fi
        cd find_best_model
        ln -s ../../../per_gene/EOG091G0IZX/ALICUT_EOG091G0IZX.clustalo.fasta EOG091G0IZX.fasta
        ProteinModelSelection.pl EOG091G0IZX.fasta 1> ../../../per_gene/EOG091G0IZX/EOG091G0IZX.best_model 2> ../../../per_gene/EOG091G0IZX/find_best_model.stderr.txt
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/c0c09ee657b1e27f2c5687e0e9aa8d70.simg
[Sun Jul  5 22:40:15 2020]
Finished job 186.
1271 of 3292 steps (39%) done

[Sun Jul  5 22:40:15 2020]
rule get_seqs:
    input: /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ingroup.txt, /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/outgroup.txt
    output: per_gene/EOG091G06HP/EOG091G06HP.ingroup.fasta
    log: per_gene/EOG091G06HP/get_seqs.stdout.txt, per_gene/EOG091G06HP/get_seqs.stderr.txt
    jobid: 2556
    wildcards: BUSCO=EOG091G06HP
    threads: 2


	basedir=$(pwd)
        cd per_gene/EOG091G06HP
        
        bash $basedir/../scripts/fetch_seqs.sh EOG091G06HP /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ingroup.txt /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/outgroup.txt 1> ../../per_gene/EOG091G06HP/get_seqs.stdout.txt 2> ../../per_gene/EOG091G06HP/get_seqs.stderr.txt
	mv EOG091G06HP.fasta $basedir/per_gene/EOG091G06HP/EOG091G06HP.ingroup.fasta
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/72476f9d9a5bd0627b4d721143a21354.simg
[Sun Jul  5 22:40:17 2020]
Finished job 664.
1272 of 3292 steps (39%) done

[Sun Jul  5 22:40:17 2020]
rule infer_single_ML:
    input: per_gene/EOG091G0IZX/EOG091G0IZX.best_model, per_gene/EOG091G0IZX/ALICUT_EOG091G0IZX.clustalo.fasta
    output: per_gene/EOG091G0IZX/EOG091G0IZX.raxml.done
    log: per_gene/EOG091G0IZX/infer_single_ML.stdout.txt, per_gene/EOG091G0IZX/infer_single_ML.stderr.txt
    jobid: 126
    wildcards: BUSCO=EOG091G0IZX
    threads: 2


        cd per_gene/EOG091G0IZX
	count=$(cat ../../per_gene/EOG091G0IZX/ALICUT_EOG091G0IZX.clustalo.fasta | grep ">" | wc -l)
	if [ "$count" -gt 5 ]
        then
		RAxMLmodel=$(cat ../../per_gene/EOG091G0IZX/EOG091G0IZX.best_model | grep "Best" | cut -d ":" -f 2 | tr -d '[:space:]')
                if [ "$(ls -1 | grep "^RAxML" | wc -l)" -ne 0 ]
		then
			rm RAxML*
		fi
        	raxml -f a -T 2 -m PROTGAMMA$RAxMLmodel         	-p 12345 -x 12345 -# 100         	-s ../../per_gene/EOG091G0IZX/ALICUT_EOG091G0IZX.clustalo.fasta -n EOG091G0IZX.clustalo.aln.ALICUT.$RAxMLmodel 		1> ../../per_gene/EOG091G0IZX/infer_single_ML.stdout.txt 2> ../../per_gene/EOG091G0IZX/infer_single_ML.stderr.txt
	else
		echo "fasta file per_gene/EOG091G0IZX/ALICUT_EOG091G0IZX.clustalo.fasta contains fewer than 5 sequences - skipped" > ../../per_gene/EOG091G0IZX/infer_single_ML.stdout.txt
		touch raxml.skipped
	fi
        touch ../../per_gene/EOG091G0IZX/EOG091G0IZX.raxml.done
        
[33mJob counts:
	count	jobs
	1	infer_single_ML
	1[0m
[33m
        cd per_gene/EOG091G0IZX
	count=$(cat ../../per_gene/EOG091G0IZX/ALICUT_EOG091G0IZX.clustalo.fasta | grep ">" | wc -l)
	if [ "$count" -gt 5 ]
        then
		RAxMLmodel=$(cat ../../per_gene/EOG091G0IZX/EOG091G0IZX.best_model | grep "Best" | cut -d ":" -f 2 | tr -d '[:space:]')
                if [ "$(ls -1 | grep "^RAxML" | wc -l)" -ne 0 ]
		then
			rm RAxML*
		fi
        	raxml -f a -T 2 -m PROTGAMMA$RAxMLmodel         	-p 12345 -x 12345 -# 100         	-s ../../per_gene/EOG091G0IZX/ALICUT_EOG091G0IZX.clustalo.fasta -n EOG091G0IZX.clustalo.aln.ALICUT.$RAxMLmodel 		1> ../../per_gene/EOG091G0IZX/infer_single_ML.stdout.txt 2> ../../per_gene/EOG091G0IZX/infer_single_ML.stderr.txt
	else
		echo "fasta file per_gene/EOG091G0IZX/ALICUT_EOG091G0IZX.clustalo.fasta contains fewer than 5 sequences - skipped" > ../../per_gene/EOG091G0IZX/infer_single_ML.stdout.txt
		touch raxml.skipped
	fi
        touch ../../per_gene/EOG091G0IZX/EOG091G0IZX.raxml.done
        [0m
[Sun Jul  5 22:40:33 2020]
Finished job 2556.
1273 of 3292 steps (39%) done

[Sun Jul  5 22:40:33 2020]
rule get_outgroups:
    input: per_gene/EOG091G06HP/EOG091G06HP.ingroup.fasta
    output: per_gene/EOG091G06HP/EOG091G06HP.orthodb.fasta, per_gene/EOG091G06HP/EOG091G06HP.outgroup.fasta
    log: per_gene/EOG091G06HP/get_outgroups.stdout.txt, per_gene/EOG091G06HP/get_outgroups.stderr.txt
    jobid: 2557
    wildcards: BUSCO=EOG091G06HP


        #download fastas from Orhtodb for BUSCO id
        for i in {1..5}
        do
             wget "http://www.orthodb.org/fasta?query=EOG091G06HP&level=33208" -O per_gene/EOG091G06HP/EOG091G06HP.orthodb.fasta 1> per_gene/EOG091G06HP/get_outgroups.stdout.txt 2> per_gene/EOG091G06HP/get_outgroups.stderr.txt && break || echo -e "try again ($i)" && sleep 15
        done

	#This is quick an dirty for now and just takes the first protein if there is more than one for an outgroup taxon
        bash ../scripts/download_outgroups.sh taxids.txt per_gene/EOG091G06HP/EOG091G06HP.orthodb.fasta > per_gene/EOG091G06HP/EOG091G06HP.outgroup.fasta
        
[Sun Jul  5 22:40:34 2020]
Finished job 2557.
1274 of 3292 steps (39%) done

[Sun Jul  5 22:40:34 2020]
rule join_groups:
    input: per_gene/EOG091G06HP/EOG091G06HP.ingroup.fasta, per_gene/EOG091G06HP/EOG091G06HP.outgroup.fasta
    output: per_gene/EOG091G06HP/EOG091G06HP.fasta
    jobid: 2102
    wildcards: BUSCO=EOG091G06HP


        cat per_gene/EOG091G06HP/EOG091G06HP.ingroup.fasta per_gene/EOG091G06HP/EOG091G06HP.outgroup.fasta > per_gene/EOG091G06HP/EOG091G06HP.fasta
        
[Sun Jul  5 22:40:34 2020]
Finished job 2102.
1275 of 3292 steps (39%) done

[Sun Jul  5 22:40:34 2020]
rule MSA:
    input: per_gene/EOG091G06HP/EOG091G06HP.fasta
    output: per_gene/EOG091G06HP/EOG091G06HP.clustalo.fasta
    log: per_gene/EOG091G06HP/MSA.stdout.txt, per_gene/EOG091G06HP/MSA.stderr.txt
    jobid: 1324
    wildcards: BUSCO=EOG091G06HP
    threads: 2


        clustalo -i per_gene/EOG091G06HP/EOG091G06HP.fasta -o per_gene/EOG091G06HP/EOG091G06HP.clustalo.fasta --threads=2 1> per_gene/EOG091G06HP/MSA.stdout.txt 2> per_gene/EOG091G06HP/MSA.stderr.txt
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/d68c9691725a7401923680874285c430.simg
[Sun Jul  5 22:40:35 2020]
Finished job 1324.
1276 of 3292 steps (39%) done

[Sun Jul  5 22:40:35 2020]
rule score_and_cut:
    input: per_gene/EOG091G06HP/EOG091G06HP.clustalo.fasta
    output: per_gene/EOG091G06HP/ALICUT_EOG091G06HP.clustalo.fasta
    jobid: 501
    wildcards: BUSCO=EOG091G06HP
    threads: 2


        cd per_gene/EOG091G06HP
        Aliscore.pl -N -r 200000000000000000 -i ../../per_gene/EOG091G06HP/EOG091G06HP.clustalo.fasta &> aliscore.log
        ALICUT.pl -s &> alicut.log
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/63c88c27a0fa300f57066b0ef65fefcb.simg
[Sun Jul  5 22:40:37 2020]
Finished job 395.
1277 of 3292 steps (39%) done

[Sun Jul  5 22:40:37 2020]
rule get_seqs:
    input: /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ingroup.txt, /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/outgroup.txt
    output: per_gene/EOG091G01IW/EOG091G01IW.ingroup.fasta
    log: per_gene/EOG091G01IW/get_seqs.stdout.txt, per_gene/EOG091G01IW/get_seqs.stderr.txt
    jobid: 2484
    wildcards: BUSCO=EOG091G01IW
    threads: 2


	basedir=$(pwd)
        cd per_gene/EOG091G01IW
        
        bash $basedir/../scripts/fetch_seqs.sh EOG091G01IW /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ingroup.txt /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/outgroup.txt 1> ../../per_gene/EOG091G01IW/get_seqs.stdout.txt 2> ../../per_gene/EOG091G01IW/get_seqs.stderr.txt
	mv EOG091G01IW.fasta $basedir/per_gene/EOG091G01IW/EOG091G01IW.ingroup.fasta
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/72476f9d9a5bd0627b4d721143a21354.simg
[Sun Jul  5 22:40:38 2020]
Finished job 462.
1278 of 3292 steps (39%) done

[Sun Jul  5 22:40:38 2020]
rule infer_single_ML:
    input: per_gene/EOG091G03TZ/EOG091G03TZ.best_model, per_gene/EOG091G03TZ/ALICUT_EOG091G03TZ.clustalo.fasta
    output: per_gene/EOG091G03TZ/EOG091G03TZ.raxml.done
    log: per_gene/EOG091G03TZ/infer_single_ML.stdout.txt, per_gene/EOG091G03TZ/infer_single_ML.stderr.txt
    jobid: 25
    wildcards: BUSCO=EOG091G03TZ
    threads: 2


        cd per_gene/EOG091G03TZ
	count=$(cat ../../per_gene/EOG091G03TZ/ALICUT_EOG091G03TZ.clustalo.fasta | grep ">" | wc -l)
	if [ "$count" -gt 5 ]
        then
		RAxMLmodel=$(cat ../../per_gene/EOG091G03TZ/EOG091G03TZ.best_model | grep "Best" | cut -d ":" -f 2 | tr -d '[:space:]')
                if [ "$(ls -1 | grep "^RAxML" | wc -l)" -ne 0 ]
		then
			rm RAxML*
		fi
        	raxml -f a -T 2 -m PROTGAMMA$RAxMLmodel         	-p 12345 -x 12345 -# 100         	-s ../../per_gene/EOG091G03TZ/ALICUT_EOG091G03TZ.clustalo.fasta -n EOG091G03TZ.clustalo.aln.ALICUT.$RAxMLmodel 		1> ../../per_gene/EOG091G03TZ/infer_single_ML.stdout.txt 2> ../../per_gene/EOG091G03TZ/infer_single_ML.stderr.txt
	else
		echo "fasta file per_gene/EOG091G03TZ/ALICUT_EOG091G03TZ.clustalo.fasta contains fewer than 5 sequences - skipped" > ../../per_gene/EOG091G03TZ/infer_single_ML.stdout.txt
		touch raxml.skipped
	fi
        touch ../../per_gene/EOG091G03TZ/EOG091G03TZ.raxml.done
        
[33mJob counts:
	count	jobs
	1	infer_single_ML
	1[0m
[33m
        cd per_gene/EOG091G03TZ
	count=$(cat ../../per_gene/EOG091G03TZ/ALICUT_EOG091G03TZ.clustalo.fasta | grep ">" | wc -l)
	if [ "$count" -gt 5 ]
        then
		RAxMLmodel=$(cat ../../per_gene/EOG091G03TZ/EOG091G03TZ.best_model | grep "Best" | cut -d ":" -f 2 | tr -d '[:space:]')
                if [ "$(ls -1 | grep "^RAxML" | wc -l)" -ne 0 ]
		then
			rm RAxML*
		fi
        	raxml -f a -T 2 -m PROTGAMMA$RAxMLmodel         	-p 12345 -x 12345 -# 100         	-s ../../per_gene/EOG091G03TZ/ALICUT_EOG091G03TZ.clustalo.fasta -n EOG091G03TZ.clustalo.aln.ALICUT.$RAxMLmodel 		1> ../../per_gene/EOG091G03TZ/infer_single_ML.stdout.txt 2> ../../per_gene/EOG091G03TZ/infer_single_ML.stderr.txt
	else
		echo "fasta file per_gene/EOG091G03TZ/ALICUT_EOG091G03TZ.clustalo.fasta contains fewer than 5 sequences - skipped" > ../../per_gene/EOG091G03TZ/infer_single_ML.stdout.txt
		touch raxml.skipped
	fi
        touch ../../per_gene/EOG091G03TZ/EOG091G03TZ.raxml.done
        [0m
[Sun Jul  5 22:40:45 2020]
Finished job 501.
1279 of 3292 steps (39%) done

[Sun Jul  5 22:40:45 2020]
rule remove_empty:
    input: per_gene/EOG091G06HP/ALICUT_EOG091G06HP.clustalo.fasta
    output: per_gene/EOG091G06HP/empty_check.done
    jobid: 1323
    wildcards: BUSCO=EOG091G06HP


         if [ "$(cat per_gene/EOG091G06HP/ALICUT_EOG091G06HP.clustalo.fasta | grep -v ">" | sed 's/-//g' | grep "^$" | wc -l)" -gt 0 ]
         then
              cp per_gene/EOG091G06HP/ALICUT_EOG091G06HP.clustalo.fasta per_gene/EOG091G06HP/ALICUT_EOG091G06HP.clustalo.fasta.backup
              bash ../scripts/remove_empty.sh per_gene/EOG091G06HP/ALICUT_EOG091G06HP.clustalo.fasta.backup > per_gene/EOG091G06HP/ALICUT_EOG091G06HP.clustalo.fasta
         fi
         touch per_gene/EOG091G06HP/empty_check.done
         
[Sun Jul  5 22:40:45 2020]
Finished job 1323.
1280 of 3292 steps (39%) done

[Sun Jul  5 22:40:45 2020]
rule find_best_model:
    input: per_gene/EOG091G06HP/ALICUT_EOG091G06HP.clustalo.fasta, per_gene/EOG091G06HP/empty_check.done
    output: per_gene/EOG091G06HP/EOG091G06HP.best_model
    log: per_gene/EOG091G06HP/find_best_model.stderr.txt
    jobid: 500
    wildcards: BUSCO=EOG091G06HP
    threads: 2


        cd per_gene/EOG091G06HP
        if [ ! -d find_best_model ]
        then
            mkdir find_best_model
        fi
        cd find_best_model
        ln -s ../../../per_gene/EOG091G06HP/ALICUT_EOG091G06HP.clustalo.fasta EOG091G06HP.fasta
        ProteinModelSelection.pl EOG091G06HP.fasta 1> ../../../per_gene/EOG091G06HP/EOG091G06HP.best_model 2> ../../../per_gene/EOG091G06HP/find_best_model.stderr.txt
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/c0c09ee657b1e27f2c5687e0e9aa8d70.simg
[Sun Jul  5 22:40:48 2020]
Finished job 82.
1281 of 3292 steps (39%) done

[Sun Jul  5 22:40:48 2020]
rule get_seqs:
    input: /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ingroup.txt, /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/outgroup.txt
    output: per_gene/EOG091G01XQ/EOG091G01XQ.ingroup.fasta
    log: per_gene/EOG091G01XQ/get_seqs.stdout.txt, per_gene/EOG091G01XQ/get_seqs.stderr.txt
    jobid: 3052
    wildcards: BUSCO=EOG091G01XQ
    threads: 2


	basedir=$(pwd)
        cd per_gene/EOG091G01XQ
        
        bash $basedir/../scripts/fetch_seqs.sh EOG091G01XQ /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ingroup.txt /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/outgroup.txt 1> ../../per_gene/EOG091G01XQ/get_seqs.stdout.txt 2> ../../per_gene/EOG091G01XQ/get_seqs.stderr.txt
	mv EOG091G01XQ.fasta $basedir/per_gene/EOG091G01XQ/EOG091G01XQ.ingroup.fasta
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/72476f9d9a5bd0627b4d721143a21354.simg
[Sun Jul  5 22:40:55 2020]
Finished job 2484.
1282 of 3292 steps (39%) done

[Sun Jul  5 22:40:55 2020]
rule get_outgroups:
    input: per_gene/EOG091G01IW/EOG091G01IW.ingroup.fasta
    output: per_gene/EOG091G01IW/EOG091G01IW.orthodb.fasta, per_gene/EOG091G01IW/EOG091G01IW.outgroup.fasta
    log: per_gene/EOG091G01IW/get_outgroups.stdout.txt, per_gene/EOG091G01IW/get_outgroups.stderr.txt
    jobid: 2485
    wildcards: BUSCO=EOG091G01IW


        #download fastas from Orhtodb for BUSCO id
        for i in {1..5}
        do
             wget "http://www.orthodb.org/fasta?query=EOG091G01IW&level=33208" -O per_gene/EOG091G01IW/EOG091G01IW.orthodb.fasta 1> per_gene/EOG091G01IW/get_outgroups.stdout.txt 2> per_gene/EOG091G01IW/get_outgroups.stderr.txt && break || echo -e "try again ($i)" && sleep 15
        done

	#This is quick an dirty for now and just takes the first protein if there is more than one for an outgroup taxon
        bash ../scripts/download_outgroups.sh taxids.txt per_gene/EOG091G01IW/EOG091G01IW.orthodb.fasta > per_gene/EOG091G01IW/EOG091G01IW.outgroup.fasta
        
[Sun Jul  5 22:40:56 2020]
Finished job 2485.
1283 of 3292 steps (39%) done

[Sun Jul  5 22:40:56 2020]
rule join_groups:
    input: per_gene/EOG091G01IW/EOG091G01IW.ingroup.fasta, per_gene/EOG091G01IW/EOG091G01IW.outgroup.fasta
    output: per_gene/EOG091G01IW/EOG091G01IW.fasta
    jobid: 2066
    wildcards: BUSCO=EOG091G01IW


        cat per_gene/EOG091G01IW/EOG091G01IW.ingroup.fasta per_gene/EOG091G01IW/EOG091G01IW.outgroup.fasta > per_gene/EOG091G01IW/EOG091G01IW.fasta
        
[Sun Jul  5 22:40:56 2020]
Finished job 2066.
1284 of 3292 steps (39%) done

[Sun Jul  5 22:40:56 2020]
rule MSA:
    input: per_gene/EOG091G01IW/EOG091G01IW.fasta
    output: per_gene/EOG091G01IW/EOG091G01IW.clustalo.fasta
    log: per_gene/EOG091G01IW/MSA.stdout.txt, per_gene/EOG091G01IW/MSA.stderr.txt
    jobid: 1252
    wildcards: BUSCO=EOG091G01IW
    threads: 2


        clustalo -i per_gene/EOG091G01IW/EOG091G01IW.fasta -o per_gene/EOG091G01IW/EOG091G01IW.clustalo.fasta --threads=2 1> per_gene/EOG091G01IW/MSA.stdout.txt 2> per_gene/EOG091G01IW/MSA.stderr.txt
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/d68c9691725a7401923680874285c430.simg
[Sun Jul  5 22:41:01 2020]
Finished job 85.
1285 of 3292 steps (39%) done

[Sun Jul  5 22:41:01 2020]
rule get_seqs:
    input: /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ingroup.txt, /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/outgroup.txt
    output: per_gene/EOG091G0DXV/EOG091G0DXV.ingroup.fasta
    log: per_gene/EOG091G0DXV/get_seqs.stdout.txt, per_gene/EOG091G0DXV/get_seqs.stderr.txt
    jobid: 2662
    wildcards: BUSCO=EOG091G0DXV
    threads: 2


	basedir=$(pwd)
        cd per_gene/EOG091G0DXV
        
        bash $basedir/../scripts/fetch_seqs.sh EOG091G0DXV /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ingroup.txt /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/outgroup.txt 1> ../../per_gene/EOG091G0DXV/get_seqs.stdout.txt 2> ../../per_gene/EOG091G0DXV/get_seqs.stderr.txt
	mv EOG091G0DXV.fasta $basedir/per_gene/EOG091G0DXV/EOG091G0DXV.ingroup.fasta
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/72476f9d9a5bd0627b4d721143a21354.simg
[Sun Jul  5 22:41:02 2020]
Finished job 1252.
1286 of 3292 steps (39%) done

[Sun Jul  5 22:41:02 2020]
rule score_and_cut:
    input: per_gene/EOG091G01IW/EOG091G01IW.clustalo.fasta
    output: per_gene/EOG091G01IW/ALICUT_EOG091G01IW.clustalo.fasta
    jobid: 429
    wildcards: BUSCO=EOG091G01IW
    threads: 2


        cd per_gene/EOG091G01IW
        Aliscore.pl -N -r 200000000000000000 -i ../../per_gene/EOG091G01IW/EOG091G01IW.clustalo.fasta &> aliscore.log
        ALICUT.pl -s &> alicut.log
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/63c88c27a0fa300f57066b0ef65fefcb.simg
[Sun Jul  5 22:41:03 2020]
Finished job 3052.
1287 of 3292 steps (39%) done

[Sun Jul  5 22:41:03 2020]
rule get_outgroups:
    input: per_gene/EOG091G01XQ/EOG091G01XQ.ingroup.fasta
    output: per_gene/EOG091G01XQ/EOG091G01XQ.orthodb.fasta, per_gene/EOG091G01XQ/EOG091G01XQ.outgroup.fasta
    log: per_gene/EOG091G01XQ/get_outgroups.stdout.txt, per_gene/EOG091G01XQ/get_outgroups.stderr.txt
    jobid: 3053
    wildcards: BUSCO=EOG091G01XQ


        #download fastas from Orhtodb for BUSCO id
        for i in {1..5}
        do
             wget "http://www.orthodb.org/fasta?query=EOG091G01XQ&level=33208" -O per_gene/EOG091G01XQ/EOG091G01XQ.orthodb.fasta 1> per_gene/EOG091G01XQ/get_outgroups.stdout.txt 2> per_gene/EOG091G01XQ/get_outgroups.stderr.txt && break || echo -e "try again ($i)" && sleep 15
        done

	#This is quick an dirty for now and just takes the first protein if there is more than one for an outgroup taxon
        bash ../scripts/download_outgroups.sh taxids.txt per_gene/EOG091G01XQ/EOG091G01XQ.orthodb.fasta > per_gene/EOG091G01XQ/EOG091G01XQ.outgroup.fasta
        
[Sun Jul  5 22:41:04 2020]
Finished job 3053.
1288 of 3292 steps (39%) done

[Sun Jul  5 22:41:04 2020]
rule join_groups:
    input: per_gene/EOG091G01XQ/EOG091G01XQ.ingroup.fasta, per_gene/EOG091G01XQ/EOG091G01XQ.outgroup.fasta
    output: per_gene/EOG091G01XQ/EOG091G01XQ.fasta
    jobid: 2350
    wildcards: BUSCO=EOG091G01XQ


        cat per_gene/EOG091G01XQ/EOG091G01XQ.ingroup.fasta per_gene/EOG091G01XQ/EOG091G01XQ.outgroup.fasta > per_gene/EOG091G01XQ/EOG091G01XQ.fasta
        
[Sun Jul  5 22:41:04 2020]
Finished job 2350.
1289 of 3292 steps (39%) done

[Sun Jul  5 22:41:04 2020]
rule MSA:
    input: per_gene/EOG091G01XQ/EOG091G01XQ.fasta
    output: per_gene/EOG091G01XQ/EOG091G01XQ.clustalo.fasta
    log: per_gene/EOG091G01XQ/MSA.stdout.txt, per_gene/EOG091G01XQ/MSA.stderr.txt
    jobid: 1820
    wildcards: BUSCO=EOG091G01XQ
    threads: 2


        clustalo -i per_gene/EOG091G01XQ/EOG091G01XQ.fasta -o per_gene/EOG091G01XQ/EOG091G01XQ.clustalo.fasta --threads=2 1> per_gene/EOG091G01XQ/MSA.stdout.txt 2> per_gene/EOG091G01XQ/MSA.stderr.txt
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/d68c9691725a7401923680874285c430.simg
[Sun Jul  5 22:41:07 2020]
Finished job 1820.
1290 of 3292 steps (39%) done

[Sun Jul  5 22:41:07 2020]
rule score_and_cut:
    input: per_gene/EOG091G01XQ/EOG091G01XQ.clustalo.fasta
    output: per_gene/EOG091G01XQ/ALICUT_EOG091G01XQ.clustalo.fasta
    jobid: 997
    wildcards: BUSCO=EOG091G01XQ
    threads: 2


        cd per_gene/EOG091G01XQ
        Aliscore.pl -N -r 200000000000000000 -i ../../per_gene/EOG091G01XQ/EOG091G01XQ.clustalo.fasta &> aliscore.log
        ALICUT.pl -s &> alicut.log
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/63c88c27a0fa300f57066b0ef65fefcb.simg
[Sun Jul  5 22:41:16 2020]
Finished job 429.
1291 of 3292 steps (39%) done

[Sun Jul  5 22:41:16 2020]
rule remove_empty:
    input: per_gene/EOG091G01IW/ALICUT_EOG091G01IW.clustalo.fasta
    output: per_gene/EOG091G01IW/empty_check.done
    jobid: 1251
    wildcards: BUSCO=EOG091G01IW


         if [ "$(cat per_gene/EOG091G01IW/ALICUT_EOG091G01IW.clustalo.fasta | grep -v ">" | sed 's/-//g' | grep "^$" | wc -l)" -gt 0 ]
         then
              cp per_gene/EOG091G01IW/ALICUT_EOG091G01IW.clustalo.fasta per_gene/EOG091G01IW/ALICUT_EOG091G01IW.clustalo.fasta.backup
              bash ../scripts/remove_empty.sh per_gene/EOG091G01IW/ALICUT_EOG091G01IW.clustalo.fasta.backup > per_gene/EOG091G01IW/ALICUT_EOG091G01IW.clustalo.fasta
         fi
         touch per_gene/EOG091G01IW/empty_check.done
         
[Sun Jul  5 22:41:16 2020]
Finished job 1251.
1292 of 3292 steps (39%) done

[Sun Jul  5 22:41:16 2020]
rule find_best_model:
    input: per_gene/EOG091G01IW/ALICUT_EOG091G01IW.clustalo.fasta, per_gene/EOG091G01IW/empty_check.done
    output: per_gene/EOG091G01IW/EOG091G01IW.best_model
    log: per_gene/EOG091G01IW/find_best_model.stderr.txt
    jobid: 428
    wildcards: BUSCO=EOG091G01IW
    threads: 2


        cd per_gene/EOG091G01IW
        if [ ! -d find_best_model ]
        then
            mkdir find_best_model
        fi
        cd find_best_model
        ln -s ../../../per_gene/EOG091G01IW/ALICUT_EOG091G01IW.clustalo.fasta EOG091G01IW.fasta
        ProteinModelSelection.pl EOG091G01IW.fasta 1> ../../../per_gene/EOG091G01IW/EOG091G01IW.best_model 2> ../../../per_gene/EOG091G01IW/find_best_model.stderr.txt
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/c0c09ee657b1e27f2c5687e0e9aa8d70.simg
[Sun Jul  5 22:41:17 2020]
Finished job 997.
1293 of 3292 steps (39%) done

[Sun Jul  5 22:41:17 2020]
rule remove_empty:
    input: per_gene/EOG091G01XQ/ALICUT_EOG091G01XQ.clustalo.fasta
    output: per_gene/EOG091G01XQ/empty_check.done
    jobid: 1819
    wildcards: BUSCO=EOG091G01XQ


         if [ "$(cat per_gene/EOG091G01XQ/ALICUT_EOG091G01XQ.clustalo.fasta | grep -v ">" | sed 's/-//g' | grep "^$" | wc -l)" -gt 0 ]
         then
              cp per_gene/EOG091G01XQ/ALICUT_EOG091G01XQ.clustalo.fasta per_gene/EOG091G01XQ/ALICUT_EOG091G01XQ.clustalo.fasta.backup
              bash ../scripts/remove_empty.sh per_gene/EOG091G01XQ/ALICUT_EOG091G01XQ.clustalo.fasta.backup > per_gene/EOG091G01XQ/ALICUT_EOG091G01XQ.clustalo.fasta
         fi
         touch per_gene/EOG091G01XQ/empty_check.done
         
[Sun Jul  5 22:41:18 2020]
Finished job 1819.
1294 of 3292 steps (39%) done

[Sun Jul  5 22:41:18 2020]
rule find_best_model:
    input: per_gene/EOG091G01XQ/ALICUT_EOG091G01XQ.clustalo.fasta, per_gene/EOG091G01XQ/empty_check.done
    output: per_gene/EOG091G01XQ/EOG091G01XQ.best_model
    log: per_gene/EOG091G01XQ/find_best_model.stderr.txt
    jobid: 996
    wildcards: BUSCO=EOG091G01XQ
    threads: 2


        cd per_gene/EOG091G01XQ
        if [ ! -d find_best_model ]
        then
            mkdir find_best_model
        fi
        cd find_best_model
        ln -s ../../../per_gene/EOG091G01XQ/ALICUT_EOG091G01XQ.clustalo.fasta EOG091G01XQ.fasta
        ProteinModelSelection.pl EOG091G01XQ.fasta 1> ../../../per_gene/EOG091G01XQ/EOG091G01XQ.best_model 2> ../../../per_gene/EOG091G01XQ/find_best_model.stderr.txt
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/c0c09ee657b1e27f2c5687e0e9aa8d70.simg
[Sun Jul  5 22:41:19 2020]
Finished job 2662.
1295 of 3292 steps (39%) done

[Sun Jul  5 22:41:19 2020]
rule get_outgroups:
    input: per_gene/EOG091G0DXV/EOG091G0DXV.ingroup.fasta
    output: per_gene/EOG091G0DXV/EOG091G0DXV.orthodb.fasta, per_gene/EOG091G0DXV/EOG091G0DXV.outgroup.fasta
    log: per_gene/EOG091G0DXV/get_outgroups.stdout.txt, per_gene/EOG091G0DXV/get_outgroups.stderr.txt
    jobid: 2663
    wildcards: BUSCO=EOG091G0DXV


        #download fastas from Orhtodb for BUSCO id
        for i in {1..5}
        do
             wget "http://www.orthodb.org/fasta?query=EOG091G0DXV&level=33208" -O per_gene/EOG091G0DXV/EOG091G0DXV.orthodb.fasta 1> per_gene/EOG091G0DXV/get_outgroups.stdout.txt 2> per_gene/EOG091G0DXV/get_outgroups.stderr.txt && break || echo -e "try again ($i)" && sleep 15
        done

	#This is quick an dirty for now and just takes the first protein if there is more than one for an outgroup taxon
        bash ../scripts/download_outgroups.sh taxids.txt per_gene/EOG091G0DXV/EOG091G0DXV.orthodb.fasta > per_gene/EOG091G0DXV/EOG091G0DXV.outgroup.fasta
        
[Sun Jul  5 22:41:20 2020]
Finished job 2663.
1296 of 3292 steps (39%) done

[Sun Jul  5 22:41:20 2020]
rule join_groups:
    input: per_gene/EOG091G0DXV/EOG091G0DXV.ingroup.fasta, per_gene/EOG091G0DXV/EOG091G0DXV.outgroup.fasta
    output: per_gene/EOG091G0DXV/EOG091G0DXV.fasta
    jobid: 2155
    wildcards: BUSCO=EOG091G0DXV


        cat per_gene/EOG091G0DXV/EOG091G0DXV.ingroup.fasta per_gene/EOG091G0DXV/EOG091G0DXV.outgroup.fasta > per_gene/EOG091G0DXV/EOG091G0DXV.fasta
        
[Sun Jul  5 22:41:20 2020]
Finished job 2155.
1297 of 3292 steps (39%) done

[Sun Jul  5 22:41:20 2020]
rule MSA:
    input: per_gene/EOG091G0DXV/EOG091G0DXV.fasta
    output: per_gene/EOG091G0DXV/EOG091G0DXV.clustalo.fasta
    log: per_gene/EOG091G0DXV/MSA.stdout.txt, per_gene/EOG091G0DXV/MSA.stderr.txt
    jobid: 1430
    wildcards: BUSCO=EOG091G0DXV
    threads: 2


        clustalo -i per_gene/EOG091G0DXV/EOG091G0DXV.fasta -o per_gene/EOG091G0DXV/EOG091G0DXV.clustalo.fasta --threads=2 1> per_gene/EOG091G0DXV/MSA.stdout.txt 2> per_gene/EOG091G0DXV/MSA.stderr.txt
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/d68c9691725a7401923680874285c430.simg
[Sun Jul  5 22:41:22 2020]
Finished job 1430.
1298 of 3292 steps (39%) done

[Sun Jul  5 22:41:22 2020]
rule score_and_cut:
    input: per_gene/EOG091G0DXV/EOG091G0DXV.clustalo.fasta
    output: per_gene/EOG091G0DXV/ALICUT_EOG091G0DXV.clustalo.fasta
    jobid: 607
    wildcards: BUSCO=EOG091G0DXV
    threads: 2


        cd per_gene/EOG091G0DXV
        Aliscore.pl -N -r 200000000000000000 -i ../../per_gene/EOG091G0DXV/EOG091G0DXV.clustalo.fasta &> aliscore.log
        ALICUT.pl -s &> alicut.log
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/63c88c27a0fa300f57066b0ef65fefcb.simg
[Sun Jul  5 22:41:27 2020]
Finished job 500.
1299 of 3292 steps (39%) done

[Sun Jul  5 22:41:27 2020]
rule infer_single_ML:
    input: per_gene/EOG091G06HP/EOG091G06HP.best_model, per_gene/EOG091G06HP/ALICUT_EOG091G06HP.clustalo.fasta
    output: per_gene/EOG091G06HP/EOG091G06HP.raxml.done
    log: per_gene/EOG091G06HP/infer_single_ML.stdout.txt, per_gene/EOG091G06HP/infer_single_ML.stderr.txt
    jobid: 44
    wildcards: BUSCO=EOG091G06HP
    threads: 2


        cd per_gene/EOG091G06HP
	count=$(cat ../../per_gene/EOG091G06HP/ALICUT_EOG091G06HP.clustalo.fasta | grep ">" | wc -l)
	if [ "$count" -gt 5 ]
        then
		RAxMLmodel=$(cat ../../per_gene/EOG091G06HP/EOG091G06HP.best_model | grep "Best" | cut -d ":" -f 2 | tr -d '[:space:]')
                if [ "$(ls -1 | grep "^RAxML" | wc -l)" -ne 0 ]
		then
			rm RAxML*
		fi
        	raxml -f a -T 2 -m PROTGAMMA$RAxMLmodel         	-p 12345 -x 12345 -# 100         	-s ../../per_gene/EOG091G06HP/ALICUT_EOG091G06HP.clustalo.fasta -n EOG091G06HP.clustalo.aln.ALICUT.$RAxMLmodel 		1> ../../per_gene/EOG091G06HP/infer_single_ML.stdout.txt 2> ../../per_gene/EOG091G06HP/infer_single_ML.stderr.txt
	else
		echo "fasta file per_gene/EOG091G06HP/ALICUT_EOG091G06HP.clustalo.fasta contains fewer than 5 sequences - skipped" > ../../per_gene/EOG091G06HP/infer_single_ML.stdout.txt
		touch raxml.skipped
	fi
        touch ../../per_gene/EOG091G06HP/EOG091G06HP.raxml.done
        
[33mJob counts:
	count	jobs
	1	infer_single_ML
	1[0m
[33m
        cd per_gene/EOG091G06HP
	count=$(cat ../../per_gene/EOG091G06HP/ALICUT_EOG091G06HP.clustalo.fasta | grep ">" | wc -l)
	if [ "$count" -gt 5 ]
        then
		RAxMLmodel=$(cat ../../per_gene/EOG091G06HP/EOG091G06HP.best_model | grep "Best" | cut -d ":" -f 2 | tr -d '[:space:]')
                if [ "$(ls -1 | grep "^RAxML" | wc -l)" -ne 0 ]
		then
			rm RAxML*
		fi
        	raxml -f a -T 2 -m PROTGAMMA$RAxMLmodel         	-p 12345 -x 12345 -# 100         	-s ../../per_gene/EOG091G06HP/ALICUT_EOG091G06HP.clustalo.fasta -n EOG091G06HP.clustalo.aln.ALICUT.$RAxMLmodel 		1> ../../per_gene/EOG091G06HP/infer_single_ML.stdout.txt 2> ../../per_gene/EOG091G06HP/infer_single_ML.stderr.txt
	else
		echo "fasta file per_gene/EOG091G06HP/ALICUT_EOG091G06HP.clustalo.fasta contains fewer than 5 sequences - skipped" > ../../per_gene/EOG091G06HP/infer_single_ML.stdout.txt
		touch raxml.skipped
	fi
        touch ../../per_gene/EOG091G06HP/EOG091G06HP.raxml.done
        [0m
[Sun Jul  5 22:41:32 2020]
Finished job 607.
1300 of 3292 steps (39%) done

[Sun Jul  5 22:41:32 2020]
rule remove_empty:
    input: per_gene/EOG091G0DXV/ALICUT_EOG091G0DXV.clustalo.fasta
    output: per_gene/EOG091G0DXV/empty_check.done
    jobid: 1429
    wildcards: BUSCO=EOG091G0DXV


         if [ "$(cat per_gene/EOG091G0DXV/ALICUT_EOG091G0DXV.clustalo.fasta | grep -v ">" | sed 's/-//g' | grep "^$" | wc -l)" -gt 0 ]
         then
              cp per_gene/EOG091G0DXV/ALICUT_EOG091G0DXV.clustalo.fasta per_gene/EOG091G0DXV/ALICUT_EOG091G0DXV.clustalo.fasta.backup
              bash ../scripts/remove_empty.sh per_gene/EOG091G0DXV/ALICUT_EOG091G0DXV.clustalo.fasta.backup > per_gene/EOG091G0DXV/ALICUT_EOG091G0DXV.clustalo.fasta
         fi
         touch per_gene/EOG091G0DXV/empty_check.done
         
[Sun Jul  5 22:41:32 2020]
Finished job 1429.
1301 of 3292 steps (40%) done

[Sun Jul  5 22:41:32 2020]
rule find_best_model:
    input: per_gene/EOG091G0DXV/ALICUT_EOG091G0DXV.clustalo.fasta, per_gene/EOG091G0DXV/empty_check.done
    output: per_gene/EOG091G0DXV/EOG091G0DXV.best_model
    log: per_gene/EOG091G0DXV/find_best_model.stderr.txt
    jobid: 606
    wildcards: BUSCO=EOG091G0DXV
    threads: 2


        cd per_gene/EOG091G0DXV
        if [ ! -d find_best_model ]
        then
            mkdir find_best_model
        fi
        cd find_best_model
        ln -s ../../../per_gene/EOG091G0DXV/ALICUT_EOG091G0DXV.clustalo.fasta EOG091G0DXV.fasta
        ProteinModelSelection.pl EOG091G0DXV.fasta 1> ../../../per_gene/EOG091G0DXV/EOG091G0DXV.best_model 2> ../../../per_gene/EOG091G0DXV/find_best_model.stderr.txt
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/c0c09ee657b1e27f2c5687e0e9aa8d70.simg
[Sun Jul  5 22:41:52 2020]
Finished job 33.
1302 of 3292 steps (40%) done

[Sun Jul  5 22:41:52 2020]
rule get_seqs:
    input: /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ingroup.txt, /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/outgroup.txt
    output: per_gene/EOG091G0ZLI/EOG091G0ZLI.ingroup.fasta
    log: per_gene/EOG091G0ZLI/get_seqs.stdout.txt, per_gene/EOG091G0ZLI/get_seqs.stderr.txt
    jobid: 2906
    wildcards: BUSCO=EOG091G0ZLI
    threads: 2


	basedir=$(pwd)
        cd per_gene/EOG091G0ZLI
        
        bash $basedir/../scripts/fetch_seqs.sh EOG091G0ZLI /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ingroup.txt /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/outgroup.txt 1> ../../per_gene/EOG091G0ZLI/get_seqs.stdout.txt 2> ../../per_gene/EOG091G0ZLI/get_seqs.stderr.txt
	mv EOG091G0ZLI.fasta $basedir/per_gene/EOG091G0ZLI/EOG091G0ZLI.ingroup.fasta
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/72476f9d9a5bd0627b4d721143a21354.simg
[Sun Jul  5 22:42:07 2020]
Finished job 2906.
1303 of 3292 steps (40%) done

[Sun Jul  5 22:42:07 2020]
rule get_outgroups:
    input: per_gene/EOG091G0ZLI/EOG091G0ZLI.ingroup.fasta
    output: per_gene/EOG091G0ZLI/EOG091G0ZLI.orthodb.fasta, per_gene/EOG091G0ZLI/EOG091G0ZLI.outgroup.fasta
    log: per_gene/EOG091G0ZLI/get_outgroups.stdout.txt, per_gene/EOG091G0ZLI/get_outgroups.stderr.txt
    jobid: 2907
    wildcards: BUSCO=EOG091G0ZLI


        #download fastas from Orhtodb for BUSCO id
        for i in {1..5}
        do
             wget "http://www.orthodb.org/fasta?query=EOG091G0ZLI&level=33208" -O per_gene/EOG091G0ZLI/EOG091G0ZLI.orthodb.fasta 1> per_gene/EOG091G0ZLI/get_outgroups.stdout.txt 2> per_gene/EOG091G0ZLI/get_outgroups.stderr.txt && break || echo -e "try again ($i)" && sleep 15
        done

	#This is quick an dirty for now and just takes the first protein if there is more than one for an outgroup taxon
        bash ../scripts/download_outgroups.sh taxids.txt per_gene/EOG091G0ZLI/EOG091G0ZLI.orthodb.fasta > per_gene/EOG091G0ZLI/EOG091G0ZLI.outgroup.fasta
        
[Sun Jul  5 22:42:08 2020]
Finished job 2907.
1304 of 3292 steps (40%) done

[Sun Jul  5 22:42:08 2020]
rule join_groups:
    input: per_gene/EOG091G0ZLI/EOG091G0ZLI.ingroup.fasta, per_gene/EOG091G0ZLI/EOG091G0ZLI.outgroup.fasta
    output: per_gene/EOG091G0ZLI/EOG091G0ZLI.fasta
    jobid: 2277
    wildcards: BUSCO=EOG091G0ZLI


        cat per_gene/EOG091G0ZLI/EOG091G0ZLI.ingroup.fasta per_gene/EOG091G0ZLI/EOG091G0ZLI.outgroup.fasta > per_gene/EOG091G0ZLI/EOG091G0ZLI.fasta
        
[Sun Jul  5 22:42:08 2020]
Finished job 2277.
1305 of 3292 steps (40%) done

[Sun Jul  5 22:42:08 2020]
rule MSA:
    input: per_gene/EOG091G0ZLI/EOG091G0ZLI.fasta
    output: per_gene/EOG091G0ZLI/EOG091G0ZLI.clustalo.fasta
    log: per_gene/EOG091G0ZLI/MSA.stdout.txt, per_gene/EOG091G0ZLI/MSA.stderr.txt
    jobid: 1674
    wildcards: BUSCO=EOG091G0ZLI
    threads: 2


        clustalo -i per_gene/EOG091G0ZLI/EOG091G0ZLI.fasta -o per_gene/EOG091G0ZLI/EOG091G0ZLI.clustalo.fasta --threads=2 1> per_gene/EOG091G0ZLI/MSA.stdout.txt 2> per_gene/EOG091G0ZLI/MSA.stderr.txt
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/d68c9691725a7401923680874285c430.simg
[Sun Jul  5 22:42:09 2020]
Finished job 1674.
1306 of 3292 steps (40%) done

[Sun Jul  5 22:42:09 2020]
rule score_and_cut:
    input: per_gene/EOG091G0ZLI/EOG091G0ZLI.clustalo.fasta
    output: per_gene/EOG091G0ZLI/ALICUT_EOG091G0ZLI.clustalo.fasta
    jobid: 851
    wildcards: BUSCO=EOG091G0ZLI
    threads: 2


        cd per_gene/EOG091G0ZLI
        Aliscore.pl -N -r 200000000000000000 -i ../../per_gene/EOG091G0ZLI/EOG091G0ZLI.clustalo.fasta &> aliscore.log
        ALICUT.pl -s &> alicut.log
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/63c88c27a0fa300f57066b0ef65fefcb.simg
[Sun Jul  5 22:42:18 2020]
Finished job 851.
1307 of 3292 steps (40%) done

[Sun Jul  5 22:42:18 2020]
rule remove_empty:
    input: per_gene/EOG091G0ZLI/ALICUT_EOG091G0ZLI.clustalo.fasta
    output: per_gene/EOG091G0ZLI/empty_check.done
    jobid: 1673
    wildcards: BUSCO=EOG091G0ZLI


         if [ "$(cat per_gene/EOG091G0ZLI/ALICUT_EOG091G0ZLI.clustalo.fasta | grep -v ">" | sed 's/-//g' | grep "^$" | wc -l)" -gt 0 ]
         then
              cp per_gene/EOG091G0ZLI/ALICUT_EOG091G0ZLI.clustalo.fasta per_gene/EOG091G0ZLI/ALICUT_EOG091G0ZLI.clustalo.fasta.backup
              bash ../scripts/remove_empty.sh per_gene/EOG091G0ZLI/ALICUT_EOG091G0ZLI.clustalo.fasta.backup > per_gene/EOG091G0ZLI/ALICUT_EOG091G0ZLI.clustalo.fasta
         fi
         touch per_gene/EOG091G0ZLI/empty_check.done
         
[Sun Jul  5 22:42:18 2020]
Finished job 1673.
1308 of 3292 steps (40%) done

[Sun Jul  5 22:42:18 2020]
rule find_best_model:
    input: per_gene/EOG091G0ZLI/ALICUT_EOG091G0ZLI.clustalo.fasta, per_gene/EOG091G0ZLI/empty_check.done
    output: per_gene/EOG091G0ZLI/EOG091G0ZLI.best_model
    log: per_gene/EOG091G0ZLI/find_best_model.stderr.txt
    jobid: 850
    wildcards: BUSCO=EOG091G0ZLI
    threads: 2


        cd per_gene/EOG091G0ZLI
        if [ ! -d find_best_model ]
        then
            mkdir find_best_model
        fi
        cd find_best_model
        ln -s ../../../per_gene/EOG091G0ZLI/ALICUT_EOG091G0ZLI.clustalo.fasta EOG091G0ZLI.fasta
        ProteinModelSelection.pl EOG091G0ZLI.fasta 1> ../../../per_gene/EOG091G0ZLI/EOG091G0ZLI.best_model 2> ../../../per_gene/EOG091G0ZLI/find_best_model.stderr.txt
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/c0c09ee657b1e27f2c5687e0e9aa8d70.simg
[Sun Jul  5 22:42:27 2020]
Finished job 606.
1309 of 3292 steps (40%) done

[Sun Jul  5 22:42:27 2020]
rule infer_single_ML:
    input: per_gene/EOG091G0DXV/EOG091G0DXV.best_model, per_gene/EOG091G0DXV/ALICUT_EOG091G0DXV.clustalo.fasta
    output: per_gene/EOG091G0DXV/EOG091G0DXV.raxml.done
    log: per_gene/EOG091G0DXV/infer_single_ML.stdout.txt, per_gene/EOG091G0DXV/infer_single_ML.stderr.txt
    jobid: 97
    wildcards: BUSCO=EOG091G0DXV
    threads: 2


        cd per_gene/EOG091G0DXV
	count=$(cat ../../per_gene/EOG091G0DXV/ALICUT_EOG091G0DXV.clustalo.fasta | grep ">" | wc -l)
	if [ "$count" -gt 5 ]
        then
		RAxMLmodel=$(cat ../../per_gene/EOG091G0DXV/EOG091G0DXV.best_model | grep "Best" | cut -d ":" -f 2 | tr -d '[:space:]')
                if [ "$(ls -1 | grep "^RAxML" | wc -l)" -ne 0 ]
		then
			rm RAxML*
		fi
        	raxml -f a -T 2 -m PROTGAMMA$RAxMLmodel         	-p 12345 -x 12345 -# 100         	-s ../../per_gene/EOG091G0DXV/ALICUT_EOG091G0DXV.clustalo.fasta -n EOG091G0DXV.clustalo.aln.ALICUT.$RAxMLmodel 		1> ../../per_gene/EOG091G0DXV/infer_single_ML.stdout.txt 2> ../../per_gene/EOG091G0DXV/infer_single_ML.stderr.txt
	else
		echo "fasta file per_gene/EOG091G0DXV/ALICUT_EOG091G0DXV.clustalo.fasta contains fewer than 5 sequences - skipped" > ../../per_gene/EOG091G0DXV/infer_single_ML.stdout.txt
		touch raxml.skipped
	fi
        touch ../../per_gene/EOG091G0DXV/EOG091G0DXV.raxml.done
        
[33mJob counts:
	count	jobs
	1	infer_single_ML
	1[0m
[33m
        cd per_gene/EOG091G0DXV
	count=$(cat ../../per_gene/EOG091G0DXV/ALICUT_EOG091G0DXV.clustalo.fasta | grep ">" | wc -l)
	if [ "$count" -gt 5 ]
        then
		RAxMLmodel=$(cat ../../per_gene/EOG091G0DXV/EOG091G0DXV.best_model | grep "Best" | cut -d ":" -f 2 | tr -d '[:space:]')
                if [ "$(ls -1 | grep "^RAxML" | wc -l)" -ne 0 ]
		then
			rm RAxML*
		fi
        	raxml -f a -T 2 -m PROTGAMMA$RAxMLmodel         	-p 12345 -x 12345 -# 100         	-s ../../per_gene/EOG091G0DXV/ALICUT_EOG091G0DXV.clustalo.fasta -n EOG091G0DXV.clustalo.aln.ALICUT.$RAxMLmodel 		1> ../../per_gene/EOG091G0DXV/infer_single_ML.stdout.txt 2> ../../per_gene/EOG091G0DXV/infer_single_ML.stderr.txt
	else
		echo "fasta file per_gene/EOG091G0DXV/ALICUT_EOG091G0DXV.clustalo.fasta contains fewer than 5 sequences - skipped" > ../../per_gene/EOG091G0DXV/infer_single_ML.stdout.txt
		touch raxml.skipped
	fi
        touch ../../per_gene/EOG091G0DXV/EOG091G0DXV.raxml.done
        [0m
[Sun Jul  5 22:42:33 2020]
Finished job 996.
1310 of 3292 steps (40%) done

[Sun Jul  5 22:42:33 2020]
rule infer_single_ML:
    input: per_gene/EOG091G01XQ/EOG091G01XQ.best_model, per_gene/EOG091G01XQ/ALICUT_EOG091G01XQ.clustalo.fasta
    output: per_gene/EOG091G01XQ/EOG091G01XQ.raxml.done
    log: per_gene/EOG091G01XQ/infer_single_ML.stdout.txt, per_gene/EOG091G01XQ/infer_single_ML.stderr.txt
    jobid: 292
    wildcards: BUSCO=EOG091G01XQ
    threads: 2


        cd per_gene/EOG091G01XQ
	count=$(cat ../../per_gene/EOG091G01XQ/ALICUT_EOG091G01XQ.clustalo.fasta | grep ">" | wc -l)
	if [ "$count" -gt 5 ]
        then
		RAxMLmodel=$(cat ../../per_gene/EOG091G01XQ/EOG091G01XQ.best_model | grep "Best" | cut -d ":" -f 2 | tr -d '[:space:]')
                if [ "$(ls -1 | grep "^RAxML" | wc -l)" -ne 0 ]
		then
			rm RAxML*
		fi
        	raxml -f a -T 2 -m PROTGAMMA$RAxMLmodel         	-p 12345 -x 12345 -# 100         	-s ../../per_gene/EOG091G01XQ/ALICUT_EOG091G01XQ.clustalo.fasta -n EOG091G01XQ.clustalo.aln.ALICUT.$RAxMLmodel 		1> ../../per_gene/EOG091G01XQ/infer_single_ML.stdout.txt 2> ../../per_gene/EOG091G01XQ/infer_single_ML.stderr.txt
	else
		echo "fasta file per_gene/EOG091G01XQ/ALICUT_EOG091G01XQ.clustalo.fasta contains fewer than 5 sequences - skipped" > ../../per_gene/EOG091G01XQ/infer_single_ML.stdout.txt
		touch raxml.skipped
	fi
        touch ../../per_gene/EOG091G01XQ/EOG091G01XQ.raxml.done
        
[33mJob counts:
	count	jobs
	1	infer_single_ML
	1[0m
[33m
        cd per_gene/EOG091G01XQ
	count=$(cat ../../per_gene/EOG091G01XQ/ALICUT_EOG091G01XQ.clustalo.fasta | grep ">" | wc -l)
	if [ "$count" -gt 5 ]
        then
		RAxMLmodel=$(cat ../../per_gene/EOG091G01XQ/EOG091G01XQ.best_model | grep "Best" | cut -d ":" -f 2 | tr -d '[:space:]')
                if [ "$(ls -1 | grep "^RAxML" | wc -l)" -ne 0 ]
		then
			rm RAxML*
		fi
        	raxml -f a -T 2 -m PROTGAMMA$RAxMLmodel         	-p 12345 -x 12345 -# 100         	-s ../../per_gene/EOG091G01XQ/ALICUT_EOG091G01XQ.clustalo.fasta -n EOG091G01XQ.clustalo.aln.ALICUT.$RAxMLmodel 		1> ../../per_gene/EOG091G01XQ/infer_single_ML.stdout.txt 2> ../../per_gene/EOG091G01XQ/infer_single_ML.stderr.txt
	else
		echo "fasta file per_gene/EOG091G01XQ/ALICUT_EOG091G01XQ.clustalo.fasta contains fewer than 5 sequences - skipped" > ../../per_gene/EOG091G01XQ/infer_single_ML.stdout.txt
		touch raxml.skipped
	fi
        touch ../../per_gene/EOG091G01XQ/EOG091G01XQ.raxml.done
        [0m
[Sun Jul  5 22:42:37 2020]
Finished job 428.
1311 of 3292 steps (40%) done

[Sun Jul  5 22:42:37 2020]
rule infer_single_ML:
    input: per_gene/EOG091G01IW/EOG091G01IW.best_model, per_gene/EOG091G01IW/ALICUT_EOG091G01IW.clustalo.fasta
    output: per_gene/EOG091G01IW/EOG091G01IW.raxml.done
    log: per_gene/EOG091G01IW/infer_single_ML.stdout.txt, per_gene/EOG091G01IW/infer_single_ML.stderr.txt
    jobid: 8
    wildcards: BUSCO=EOG091G01IW
    threads: 2


        cd per_gene/EOG091G01IW
	count=$(cat ../../per_gene/EOG091G01IW/ALICUT_EOG091G01IW.clustalo.fasta | grep ">" | wc -l)
	if [ "$count" -gt 5 ]
        then
		RAxMLmodel=$(cat ../../per_gene/EOG091G01IW/EOG091G01IW.best_model | grep "Best" | cut -d ":" -f 2 | tr -d '[:space:]')
                if [ "$(ls -1 | grep "^RAxML" | wc -l)" -ne 0 ]
		then
			rm RAxML*
		fi
        	raxml -f a -T 2 -m PROTGAMMA$RAxMLmodel         	-p 12345 -x 12345 -# 100         	-s ../../per_gene/EOG091G01IW/ALICUT_EOG091G01IW.clustalo.fasta -n EOG091G01IW.clustalo.aln.ALICUT.$RAxMLmodel 		1> ../../per_gene/EOG091G01IW/infer_single_ML.stdout.txt 2> ../../per_gene/EOG091G01IW/infer_single_ML.stderr.txt
	else
		echo "fasta file per_gene/EOG091G01IW/ALICUT_EOG091G01IW.clustalo.fasta contains fewer than 5 sequences - skipped" > ../../per_gene/EOG091G01IW/infer_single_ML.stdout.txt
		touch raxml.skipped
	fi
        touch ../../per_gene/EOG091G01IW/EOG091G01IW.raxml.done
        
[33mJob counts:
	count	jobs
	1	infer_single_ML
	1[0m
[33m
        cd per_gene/EOG091G01IW
	count=$(cat ../../per_gene/EOG091G01IW/ALICUT_EOG091G01IW.clustalo.fasta | grep ">" | wc -l)
	if [ "$count" -gt 5 ]
        then
		RAxMLmodel=$(cat ../../per_gene/EOG091G01IW/EOG091G01IW.best_model | grep "Best" | cut -d ":" -f 2 | tr -d '[:space:]')
                if [ "$(ls -1 | grep "^RAxML" | wc -l)" -ne 0 ]
		then
			rm RAxML*
		fi
        	raxml -f a -T 2 -m PROTGAMMA$RAxMLmodel         	-p 12345 -x 12345 -# 100         	-s ../../per_gene/EOG091G01IW/ALICUT_EOG091G01IW.clustalo.fasta -n EOG091G01IW.clustalo.aln.ALICUT.$RAxMLmodel 		1> ../../per_gene/EOG091G01IW/infer_single_ML.stdout.txt 2> ../../per_gene/EOG091G01IW/infer_single_ML.stderr.txt
	else
		echo "fasta file per_gene/EOG091G01IW/ALICUT_EOG091G01IW.clustalo.fasta contains fewer than 5 sequences - skipped" > ../../per_gene/EOG091G01IW/infer_single_ML.stdout.txt
		touch raxml.skipped
	fi
        touch ../../per_gene/EOG091G01IW/EOG091G01IW.raxml.done
        [0m
[Sun Jul  5 22:42:48 2020]
Finished job 850.
1312 of 3292 steps (40%) done

[Sun Jul  5 22:42:48 2020]
rule infer_single_ML:
    input: per_gene/EOG091G0ZLI/EOG091G0ZLI.best_model, per_gene/EOG091G0ZLI/ALICUT_EOG091G0ZLI.clustalo.fasta
    output: per_gene/EOG091G0ZLI/EOG091G0ZLI.raxml.done
    log: per_gene/EOG091G0ZLI/infer_single_ML.stdout.txt, per_gene/EOG091G0ZLI/infer_single_ML.stderr.txt
    jobid: 219
    wildcards: BUSCO=EOG091G0ZLI
    threads: 2


        cd per_gene/EOG091G0ZLI
	count=$(cat ../../per_gene/EOG091G0ZLI/ALICUT_EOG091G0ZLI.clustalo.fasta | grep ">" | wc -l)
	if [ "$count" -gt 5 ]
        then
		RAxMLmodel=$(cat ../../per_gene/EOG091G0ZLI/EOG091G0ZLI.best_model | grep "Best" | cut -d ":" -f 2 | tr -d '[:space:]')
                if [ "$(ls -1 | grep "^RAxML" | wc -l)" -ne 0 ]
		then
			rm RAxML*
		fi
        	raxml -f a -T 2 -m PROTGAMMA$RAxMLmodel         	-p 12345 -x 12345 -# 100         	-s ../../per_gene/EOG091G0ZLI/ALICUT_EOG091G0ZLI.clustalo.fasta -n EOG091G0ZLI.clustalo.aln.ALICUT.$RAxMLmodel 		1> ../../per_gene/EOG091G0ZLI/infer_single_ML.stdout.txt 2> ../../per_gene/EOG091G0ZLI/infer_single_ML.stderr.txt
	else
		echo "fasta file per_gene/EOG091G0ZLI/ALICUT_EOG091G0ZLI.clustalo.fasta contains fewer than 5 sequences - skipped" > ../../per_gene/EOG091G0ZLI/infer_single_ML.stdout.txt
		touch raxml.skipped
	fi
        touch ../../per_gene/EOG091G0ZLI/EOG091G0ZLI.raxml.done
        
[33mJob counts:
	count	jobs
	1	infer_single_ML
	1[0m
[33m
        cd per_gene/EOG091G0ZLI
	count=$(cat ../../per_gene/EOG091G0ZLI/ALICUT_EOG091G0ZLI.clustalo.fasta | grep ">" | wc -l)
	if [ "$count" -gt 5 ]
        then
		RAxMLmodel=$(cat ../../per_gene/EOG091G0ZLI/EOG091G0ZLI.best_model | grep "Best" | cut -d ":" -f 2 | tr -d '[:space:]')
                if [ "$(ls -1 | grep "^RAxML" | wc -l)" -ne 0 ]
		then
			rm RAxML*
		fi
        	raxml -f a -T 2 -m PROTGAMMA$RAxMLmodel         	-p 12345 -x 12345 -# 100         	-s ../../per_gene/EOG091G0ZLI/ALICUT_EOG091G0ZLI.clustalo.fasta -n EOG091G0ZLI.clustalo.aln.ALICUT.$RAxMLmodel 		1> ../../per_gene/EOG091G0ZLI/infer_single_ML.stdout.txt 2> ../../per_gene/EOG091G0ZLI/infer_single_ML.stderr.txt
	else
		echo "fasta file per_gene/EOG091G0ZLI/ALICUT_EOG091G0ZLI.clustalo.fasta contains fewer than 5 sequences - skipped" > ../../per_gene/EOG091G0ZLI/infer_single_ML.stdout.txt
		touch raxml.skipped
	fi
        touch ../../per_gene/EOG091G0ZLI/EOG091G0ZLI.raxml.done
        [0m
[Sun Jul  5 22:43:36 2020]
Finished job 58.
1313 of 3292 steps (40%) done
[Sun Jul  5 22:43:36 2020]
Finished job 374.
1314 of 3292 steps (40%) done

[Sun Jul  5 22:43:36 2020]
rule get_seqs:
    input: /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ingroup.txt, /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/outgroup.txt
    output: per_gene/EOG091G0ILS/EOG091G0ILS.ingroup.fasta
    log: per_gene/EOG091G0ILS/get_seqs.stdout.txt, per_gene/EOG091G0ILS/get_seqs.stderr.txt
    jobid: 3094
    wildcards: BUSCO=EOG091G0ILS
    threads: 2


	basedir=$(pwd)
        cd per_gene/EOG091G0ILS
        
        bash $basedir/../scripts/fetch_seqs.sh EOG091G0ILS /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ingroup.txt /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/outgroup.txt 1> ../../per_gene/EOG091G0ILS/get_seqs.stdout.txt 2> ../../per_gene/EOG091G0ILS/get_seqs.stderr.txt
	mv EOG091G0ILS.fasta $basedir/per_gene/EOG091G0ILS/EOG091G0ILS.ingroup.fasta
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/72476f9d9a5bd0627b4d721143a21354.simg

[Sun Jul  5 22:43:36 2020]
rule get_seqs:
    input: /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ingroup.txt, /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/outgroup.txt
    output: per_gene/EOG091G0P5N/EOG091G0P5N.ingroup.fasta
    log: per_gene/EOG091G0P5N/get_seqs.stdout.txt, per_gene/EOG091G0P5N/get_seqs.stderr.txt
    jobid: 3102
    wildcards: BUSCO=EOG091G0P5N
    threads: 2


	basedir=$(pwd)
        cd per_gene/EOG091G0P5N
        
        bash $basedir/../scripts/fetch_seqs.sh EOG091G0P5N /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ingroup.txt /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/outgroup.txt 1> ../../per_gene/EOG091G0P5N/get_seqs.stdout.txt 2> ../../per_gene/EOG091G0P5N/get_seqs.stderr.txt
	mv EOG091G0P5N.fasta $basedir/per_gene/EOG091G0P5N/EOG091G0P5N.ingroup.fasta
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/72476f9d9a5bd0627b4d721143a21354.simg
[Sun Jul  5 22:43:40 2020]
Finished job 363.
1315 of 3292 steps (40%) done

[Sun Jul  5 22:43:40 2020]
rule get_seqs:
    input: /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ingroup.txt, /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/outgroup.txt
    output: per_gene/EOG091G0A19/EOG091G0A19.ingroup.fasta
    log: per_gene/EOG091G0A19/get_seqs.stdout.txt, per_gene/EOG091G0A19/get_seqs.stderr.txt
    jobid: 2612
    wildcards: BUSCO=EOG091G0A19
    threads: 2


	basedir=$(pwd)
        cd per_gene/EOG091G0A19
        
        bash $basedir/../scripts/fetch_seqs.sh EOG091G0A19 /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ingroup.txt /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/outgroup.txt 1> ../../per_gene/EOG091G0A19/get_seqs.stdout.txt 2> ../../per_gene/EOG091G0A19/get_seqs.stderr.txt
	mv EOG091G0A19.fasta $basedir/per_gene/EOG091G0A19/EOG091G0A19.ingroup.fasta
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/72476f9d9a5bd0627b4d721143a21354.simg
[Sun Jul  5 22:43:50 2020]
Finished job 373.
1316 of 3292 steps (40%) done

[Sun Jul  5 22:43:50 2020]
rule get_seqs:
    input: /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ingroup.txt, /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/outgroup.txt
    output: per_gene/EOG091G03JF/EOG091G03JF.ingroup.fasta
    log: per_gene/EOG091G03JF/get_seqs.stdout.txt, per_gene/EOG091G03JF/get_seqs.stderr.txt
    jobid: 2510
    wildcards: BUSCO=EOG091G03JF
    threads: 2


	basedir=$(pwd)
        cd per_gene/EOG091G03JF
        
        bash $basedir/../scripts/fetch_seqs.sh EOG091G03JF /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ingroup.txt /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/outgroup.txt 1> ../../per_gene/EOG091G03JF/get_seqs.stdout.txt 2> ../../per_gene/EOG091G03JF/get_seqs.stderr.txt
	mv EOG091G03JF.fasta $basedir/per_gene/EOG091G03JF/EOG091G03JF.ingroup.fasta
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/72476f9d9a5bd0627b4d721143a21354.simg
[Sun Jul  5 22:43:50 2020]
Finished job 3094.
1317 of 3292 steps (40%) done

[Sun Jul  5 22:43:50 2020]
rule get_outgroups:
    input: per_gene/EOG091G0ILS/EOG091G0ILS.ingroup.fasta
    output: per_gene/EOG091G0ILS/EOG091G0ILS.orthodb.fasta, per_gene/EOG091G0ILS/EOG091G0ILS.outgroup.fasta
    log: per_gene/EOG091G0ILS/get_outgroups.stdout.txt, per_gene/EOG091G0ILS/get_outgroups.stderr.txt
    jobid: 3095
    wildcards: BUSCO=EOG091G0ILS


        #download fastas from Orhtodb for BUSCO id
        for i in {1..5}
        do
             wget "http://www.orthodb.org/fasta?query=EOG091G0ILS&level=33208" -O per_gene/EOG091G0ILS/EOG091G0ILS.orthodb.fasta 1> per_gene/EOG091G0ILS/get_outgroups.stdout.txt 2> per_gene/EOG091G0ILS/get_outgroups.stderr.txt && break || echo -e "try again ($i)" && sleep 15
        done

	#This is quick an dirty for now and just takes the first protein if there is more than one for an outgroup taxon
        bash ../scripts/download_outgroups.sh taxids.txt per_gene/EOG091G0ILS/EOG091G0ILS.orthodb.fasta > per_gene/EOG091G0ILS/EOG091G0ILS.outgroup.fasta
        
[Sun Jul  5 22:43:51 2020]
Finished job 3102.
1318 of 3292 steps (40%) done

[Sun Jul  5 22:43:51 2020]
rule get_outgroups:
    input: per_gene/EOG091G0P5N/EOG091G0P5N.ingroup.fasta
    output: per_gene/EOG091G0P5N/EOG091G0P5N.orthodb.fasta, per_gene/EOG091G0P5N/EOG091G0P5N.outgroup.fasta
    log: per_gene/EOG091G0P5N/get_outgroups.stdout.txt, per_gene/EOG091G0P5N/get_outgroups.stderr.txt
    jobid: 3103
    wildcards: BUSCO=EOG091G0P5N


        #download fastas from Orhtodb for BUSCO id
        for i in {1..5}
        do
             wget "http://www.orthodb.org/fasta?query=EOG091G0P5N&level=33208" -O per_gene/EOG091G0P5N/EOG091G0P5N.orthodb.fasta 1> per_gene/EOG091G0P5N/get_outgroups.stdout.txt 2> per_gene/EOG091G0P5N/get_outgroups.stderr.txt && break || echo -e "try again ($i)" && sleep 15
        done

	#This is quick an dirty for now and just takes the first protein if there is more than one for an outgroup taxon
        bash ../scripts/download_outgroups.sh taxids.txt per_gene/EOG091G0P5N/EOG091G0P5N.orthodb.fasta > per_gene/EOG091G0P5N/EOG091G0P5N.outgroup.fasta
        

[Sun Jul  5 22:43:51 2020]
rule get_seqs:
    input: /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ingroup.txt, /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/outgroup.txt
    output: per_gene/EOG091G07KL/EOG091G07KL.ingroup.fasta
    log: per_gene/EOG091G07KL/get_seqs.stdout.txt, per_gene/EOG091G07KL/get_seqs.stderr.txt
    jobid: 3072
    wildcards: BUSCO=EOG091G07KL
    threads: 2


	basedir=$(pwd)
        cd per_gene/EOG091G07KL
        
        bash $basedir/../scripts/fetch_seqs.sh EOG091G07KL /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ingroup.txt /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/outgroup.txt 1> ../../per_gene/EOG091G07KL/get_seqs.stdout.txt 2> ../../per_gene/EOG091G07KL/get_seqs.stderr.txt
	mv EOG091G07KL.fasta $basedir/per_gene/EOG091G07KL/EOG091G07KL.ingroup.fasta
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/72476f9d9a5bd0627b4d721143a21354.simg
[Sun Jul  5 22:43:51 2020]
Finished job 3095.
1319 of 3292 steps (40%) done

[Sun Jul  5 22:43:51 2020]
rule join_groups:
    input: per_gene/EOG091G0ILS/EOG091G0ILS.ingroup.fasta, per_gene/EOG091G0ILS/EOG091G0ILS.outgroup.fasta
    output: per_gene/EOG091G0ILS/EOG091G0ILS.fasta
    jobid: 2371
    wildcards: BUSCO=EOG091G0ILS


        cat per_gene/EOG091G0ILS/EOG091G0ILS.ingroup.fasta per_gene/EOG091G0ILS/EOG091G0ILS.outgroup.fasta > per_gene/EOG091G0ILS/EOG091G0ILS.fasta
        
[Sun Jul  5 22:43:51 2020]
Finished job 2371.
1320 of 3292 steps (40%) done
[Sun Jul  5 22:43:52 2020]
Finished job 3103.
1321 of 3292 steps (40%) done

[Sun Jul  5 22:43:52 2020]
rule MSA:
    input: per_gene/EOG091G0ILS/EOG091G0ILS.fasta
    output: per_gene/EOG091G0ILS/EOG091G0ILS.clustalo.fasta
    log: per_gene/EOG091G0ILS/MSA.stdout.txt, per_gene/EOG091G0ILS/MSA.stderr.txt
    jobid: 1862
    wildcards: BUSCO=EOG091G0ILS
    threads: 2


        clustalo -i per_gene/EOG091G0ILS/EOG091G0ILS.fasta -o per_gene/EOG091G0ILS/EOG091G0ILS.clustalo.fasta --threads=2 1> per_gene/EOG091G0ILS/MSA.stdout.txt 2> per_gene/EOG091G0ILS/MSA.stderr.txt
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/d68c9691725a7401923680874285c430.simg
[Sun Jul  5 22:43:53 2020]
Finished job 1862.
1322 of 3292 steps (40%) done

[Sun Jul  5 22:43:53 2020]
rule score_and_cut:
    input: per_gene/EOG091G0ILS/EOG091G0ILS.clustalo.fasta
    output: per_gene/EOG091G0ILS/ALICUT_EOG091G0ILS.clustalo.fasta
    jobid: 1039
    wildcards: BUSCO=EOG091G0ILS
    threads: 2


        cd per_gene/EOG091G0ILS
        Aliscore.pl -N -r 200000000000000000 -i ../../per_gene/EOG091G0ILS/EOG091G0ILS.clustalo.fasta &> aliscore.log
        ALICUT.pl -s &> alicut.log
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/63c88c27a0fa300f57066b0ef65fefcb.simg
[Sun Jul  5 22:43:54 2020]
Finished job 126.
1323 of 3292 steps (40%) done

[Sun Jul  5 22:43:54 2020]
rule join_groups:
    input: per_gene/EOG091G0P5N/EOG091G0P5N.ingroup.fasta, per_gene/EOG091G0P5N/EOG091G0P5N.outgroup.fasta
    output: per_gene/EOG091G0P5N/EOG091G0P5N.fasta
    jobid: 2375
    wildcards: BUSCO=EOG091G0P5N


        cat per_gene/EOG091G0P5N/EOG091G0P5N.ingroup.fasta per_gene/EOG091G0P5N/EOG091G0P5N.outgroup.fasta > per_gene/EOG091G0P5N/EOG091G0P5N.fasta
        
[Sun Jul  5 22:43:54 2020]
Finished job 2375.
1324 of 3292 steps (40%) done

[Sun Jul  5 22:43:54 2020]
rule MSA:
    input: per_gene/EOG091G0P5N/EOG091G0P5N.fasta
    output: per_gene/EOG091G0P5N/EOG091G0P5N.clustalo.fasta
    log: per_gene/EOG091G0P5N/MSA.stdout.txt, per_gene/EOG091G0P5N/MSA.stderr.txt
    jobid: 1870
    wildcards: BUSCO=EOG091G0P5N
    threads: 2


        clustalo -i per_gene/EOG091G0P5N/EOG091G0P5N.fasta -o per_gene/EOG091G0P5N/EOG091G0P5N.clustalo.fasta --threads=2 1> per_gene/EOG091G0P5N/MSA.stdout.txt 2> per_gene/EOG091G0P5N/MSA.stderr.txt
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/d68c9691725a7401923680874285c430.simg
[Sun Jul  5 22:43:54 2020]
Finished job 2612.
1325 of 3292 steps (40%) done

[Sun Jul  5 22:43:54 2020]
rule get_outgroups:
    input: per_gene/EOG091G0A19/EOG091G0A19.ingroup.fasta
    output: per_gene/EOG091G0A19/EOG091G0A19.orthodb.fasta, per_gene/EOG091G0A19/EOG091G0A19.outgroup.fasta
    log: per_gene/EOG091G0A19/get_outgroups.stdout.txt, per_gene/EOG091G0A19/get_outgroups.stderr.txt
    jobid: 2613
    wildcards: BUSCO=EOG091G0A19


        #download fastas from Orhtodb for BUSCO id
        for i in {1..5}
        do
             wget "http://www.orthodb.org/fasta?query=EOG091G0A19&level=33208" -O per_gene/EOG091G0A19/EOG091G0A19.orthodb.fasta 1> per_gene/EOG091G0A19/get_outgroups.stdout.txt 2> per_gene/EOG091G0A19/get_outgroups.stderr.txt && break || echo -e "try again ($i)" && sleep 15
        done

	#This is quick an dirty for now and just takes the first protein if there is more than one for an outgroup taxon
        bash ../scripts/download_outgroups.sh taxids.txt per_gene/EOG091G0A19/EOG091G0A19.orthodb.fasta > per_gene/EOG091G0A19/EOG091G0A19.outgroup.fasta
        
[Sun Jul  5 22:43:55 2020]
Finished job 1870.
1326 of 3292 steps (40%) done

[Sun Jul  5 22:43:55 2020]
rule score_and_cut:
    input: per_gene/EOG091G0P5N/EOG091G0P5N.clustalo.fasta
    output: per_gene/EOG091G0P5N/ALICUT_EOG091G0P5N.clustalo.fasta
    jobid: 1047
    wildcards: BUSCO=EOG091G0P5N
    threads: 2


        cd per_gene/EOG091G0P5N
        Aliscore.pl -N -r 200000000000000000 -i ../../per_gene/EOG091G0P5N/EOG091G0P5N.clustalo.fasta &> aliscore.log
        ALICUT.pl -s &> alicut.log
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/63c88c27a0fa300f57066b0ef65fefcb.simg
[Sun Jul  5 22:43:55 2020]
Finished job 2613.
1327 of 3292 steps (40%) done

[Sun Jul  5 22:43:55 2020]
rule join_groups:
    input: per_gene/EOG091G0A19/EOG091G0A19.ingroup.fasta, per_gene/EOG091G0A19/EOG091G0A19.outgroup.fasta
    output: per_gene/EOG091G0A19/EOG091G0A19.fasta
    jobid: 2130
    wildcards: BUSCO=EOG091G0A19


        cat per_gene/EOG091G0A19/EOG091G0A19.ingroup.fasta per_gene/EOG091G0A19/EOG091G0A19.outgroup.fasta > per_gene/EOG091G0A19/EOG091G0A19.fasta
        
[Sun Jul  5 22:43:56 2020]
Finished job 2130.
1328 of 3292 steps (40%) done

[Sun Jul  5 22:43:56 2020]
rule MSA:
    input: per_gene/EOG091G0A19/EOG091G0A19.fasta
    output: per_gene/EOG091G0A19/EOG091G0A19.clustalo.fasta
    log: per_gene/EOG091G0A19/MSA.stdout.txt, per_gene/EOG091G0A19/MSA.stderr.txt
    jobid: 1380
    wildcards: BUSCO=EOG091G0A19
    threads: 2


        clustalo -i per_gene/EOG091G0A19/EOG091G0A19.fasta -o per_gene/EOG091G0A19/EOG091G0A19.clustalo.fasta --threads=2 1> per_gene/EOG091G0A19/MSA.stdout.txt 2> per_gene/EOG091G0A19/MSA.stderr.txt
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/d68c9691725a7401923680874285c430.simg
[Sun Jul  5 22:43:59 2020]
Finished job 1380.
1329 of 3292 steps (40%) done

[Sun Jul  5 22:43:59 2020]
rule score_and_cut:
    input: per_gene/EOG091G0A19/EOG091G0A19.clustalo.fasta
    output: per_gene/EOG091G0A19/ALICUT_EOG091G0A19.clustalo.fasta
    jobid: 557
    wildcards: BUSCO=EOG091G0A19
    threads: 2


        cd per_gene/EOG091G0A19
        Aliscore.pl -N -r 200000000000000000 -i ../../per_gene/EOG091G0A19/EOG091G0A19.clustalo.fasta &> aliscore.log
        ALICUT.pl -s &> alicut.log
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/63c88c27a0fa300f57066b0ef65fefcb.simg
[Sun Jul  5 22:44:03 2020]
Finished job 1039.
1330 of 3292 steps (40%) done

[Sun Jul  5 22:44:03 2020]
rule remove_empty:
    input: per_gene/EOG091G0ILS/ALICUT_EOG091G0ILS.clustalo.fasta
    output: per_gene/EOG091G0ILS/empty_check.done
    jobid: 1861
    wildcards: BUSCO=EOG091G0ILS


         if [ "$(cat per_gene/EOG091G0ILS/ALICUT_EOG091G0ILS.clustalo.fasta | grep -v ">" | sed 's/-//g' | grep "^$" | wc -l)" -gt 0 ]
         then
              cp per_gene/EOG091G0ILS/ALICUT_EOG091G0ILS.clustalo.fasta per_gene/EOG091G0ILS/ALICUT_EOG091G0ILS.clustalo.fasta.backup
              bash ../scripts/remove_empty.sh per_gene/EOG091G0ILS/ALICUT_EOG091G0ILS.clustalo.fasta.backup > per_gene/EOG091G0ILS/ALICUT_EOG091G0ILS.clustalo.fasta
         fi
         touch per_gene/EOG091G0ILS/empty_check.done
         
[Sun Jul  5 22:44:03 2020]
Finished job 1861.
1331 of 3292 steps (40%) done

[Sun Jul  5 22:44:03 2020]
rule find_best_model:
    input: per_gene/EOG091G0ILS/ALICUT_EOG091G0ILS.clustalo.fasta, per_gene/EOG091G0ILS/empty_check.done
    output: per_gene/EOG091G0ILS/EOG091G0ILS.best_model
    log: per_gene/EOG091G0ILS/find_best_model.stderr.txt
    jobid: 1038
    wildcards: BUSCO=EOG091G0ILS
    threads: 2


        cd per_gene/EOG091G0ILS
        if [ ! -d find_best_model ]
        then
            mkdir find_best_model
        fi
        cd find_best_model
        ln -s ../../../per_gene/EOG091G0ILS/ALICUT_EOG091G0ILS.clustalo.fasta EOG091G0ILS.fasta
        ProteinModelSelection.pl EOG091G0ILS.fasta 1> ../../../per_gene/EOG091G0ILS/EOG091G0ILS.best_model 2> ../../../per_gene/EOG091G0ILS/find_best_model.stderr.txt
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/c0c09ee657b1e27f2c5687e0e9aa8d70.simg
[Sun Jul  5 22:44:04 2020]
Finished job 1047.
1332 of 3292 steps (40%) done

[Sun Jul  5 22:44:04 2020]
rule remove_empty:
    input: per_gene/EOG091G0P5N/ALICUT_EOG091G0P5N.clustalo.fasta
    output: per_gene/EOG091G0P5N/empty_check.done
    jobid: 1869
    wildcards: BUSCO=EOG091G0P5N


         if [ "$(cat per_gene/EOG091G0P5N/ALICUT_EOG091G0P5N.clustalo.fasta | grep -v ">" | sed 's/-//g' | grep "^$" | wc -l)" -gt 0 ]
         then
              cp per_gene/EOG091G0P5N/ALICUT_EOG091G0P5N.clustalo.fasta per_gene/EOG091G0P5N/ALICUT_EOG091G0P5N.clustalo.fasta.backup
              bash ../scripts/remove_empty.sh per_gene/EOG091G0P5N/ALICUT_EOG091G0P5N.clustalo.fasta.backup > per_gene/EOG091G0P5N/ALICUT_EOG091G0P5N.clustalo.fasta
         fi
         touch per_gene/EOG091G0P5N/empty_check.done
         
[Sun Jul  5 22:44:04 2020]
Finished job 1869.
1333 of 3292 steps (40%) done

[Sun Jul  5 22:44:04 2020]
rule find_best_model:
    input: per_gene/EOG091G0P5N/ALICUT_EOG091G0P5N.clustalo.fasta, per_gene/EOG091G0P5N/empty_check.done
    output: per_gene/EOG091G0P5N/EOG091G0P5N.best_model
    log: per_gene/EOG091G0P5N/find_best_model.stderr.txt
    jobid: 1046
    wildcards: BUSCO=EOG091G0P5N
    threads: 2


        cd per_gene/EOG091G0P5N
        if [ ! -d find_best_model ]
        then
            mkdir find_best_model
        fi
        cd find_best_model
        ln -s ../../../per_gene/EOG091G0P5N/ALICUT_EOG091G0P5N.clustalo.fasta EOG091G0P5N.fasta
        ProteinModelSelection.pl EOG091G0P5N.fasta 1> ../../../per_gene/EOG091G0P5N/EOG091G0P5N.best_model 2> ../../../per_gene/EOG091G0P5N/find_best_model.stderr.txt
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/c0c09ee657b1e27f2c5687e0e9aa8d70.simg
[Sun Jul  5 22:44:05 2020]
Finished job 2510.
1334 of 3292 steps (41%) done

[Sun Jul  5 22:44:05 2020]
rule get_outgroups:
    input: per_gene/EOG091G03JF/EOG091G03JF.ingroup.fasta
    output: per_gene/EOG091G03JF/EOG091G03JF.orthodb.fasta, per_gene/EOG091G03JF/EOG091G03JF.outgroup.fasta
    log: per_gene/EOG091G03JF/get_outgroups.stdout.txt, per_gene/EOG091G03JF/get_outgroups.stderr.txt
    jobid: 2511
    wildcards: BUSCO=EOG091G03JF


        #download fastas from Orhtodb for BUSCO id
        for i in {1..5}
        do
             wget "http://www.orthodb.org/fasta?query=EOG091G03JF&level=33208" -O per_gene/EOG091G03JF/EOG091G03JF.orthodb.fasta 1> per_gene/EOG091G03JF/get_outgroups.stdout.txt 2> per_gene/EOG091G03JF/get_outgroups.stderr.txt && break || echo -e "try again ($i)" && sleep 15
        done

	#This is quick an dirty for now and just takes the first protein if there is more than one for an outgroup taxon
        bash ../scripts/download_outgroups.sh taxids.txt per_gene/EOG091G03JF/EOG091G03JF.orthodb.fasta > per_gene/EOG091G03JF/EOG091G03JF.outgroup.fasta
        
[Sun Jul  5 22:44:06 2020]
Finished job 2511.
1335 of 3292 steps (41%) done

[Sun Jul  5 22:44:06 2020]
rule join_groups:
    input: per_gene/EOG091G03JF/EOG091G03JF.ingroup.fasta, per_gene/EOG091G03JF/EOG091G03JF.outgroup.fasta
    output: per_gene/EOG091G03JF/EOG091G03JF.fasta
    jobid: 2079
    wildcards: BUSCO=EOG091G03JF


        cat per_gene/EOG091G03JF/EOG091G03JF.ingroup.fasta per_gene/EOG091G03JF/EOG091G03JF.outgroup.fasta > per_gene/EOG091G03JF/EOG091G03JF.fasta
        
[Sun Jul  5 22:44:06 2020]
Finished job 2079.
1336 of 3292 steps (41%) done

[Sun Jul  5 22:44:06 2020]
rule MSA:
    input: per_gene/EOG091G03JF/EOG091G03JF.fasta
    output: per_gene/EOG091G03JF/EOG091G03JF.clustalo.fasta
    log: per_gene/EOG091G03JF/MSA.stdout.txt, per_gene/EOG091G03JF/MSA.stderr.txt
    jobid: 1278
    wildcards: BUSCO=EOG091G03JF
    threads: 2


        clustalo -i per_gene/EOG091G03JF/EOG091G03JF.fasta -o per_gene/EOG091G03JF/EOG091G03JF.clustalo.fasta --threads=2 1> per_gene/EOG091G03JF/MSA.stdout.txt 2> per_gene/EOG091G03JF/MSA.stderr.txt
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/d68c9691725a7401923680874285c430.simg
[Sun Jul  5 22:44:06 2020]
Finished job 336.
1337 of 3292 steps (41%) done

[Sun Jul  5 22:44:06 2020]
rule get_seqs:
    input: /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ingroup.txt, /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/outgroup.txt
    output: per_gene/EOG091G184V/EOG091G184V.ingroup.fasta
    log: per_gene/EOG091G184V/get_seqs.stdout.txt, per_gene/EOG091G184V/get_seqs.stderr.txt
    jobid: 3046
    wildcards: BUSCO=EOG091G184V
    threads: 2


	basedir=$(pwd)
        cd per_gene/EOG091G184V
        
        bash $basedir/../scripts/fetch_seqs.sh EOG091G184V /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ingroup.txt /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/outgroup.txt 1> ../../per_gene/EOG091G184V/get_seqs.stdout.txt 2> ../../per_gene/EOG091G184V/get_seqs.stderr.txt
	mv EOG091G184V.fasta $basedir/per_gene/EOG091G184V/EOG091G184V.ingroup.fasta
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/72476f9d9a5bd0627b4d721143a21354.simg
[Sun Jul  5 22:44:06 2020]
Finished job 3072.
1338 of 3292 steps (41%) done

[Sun Jul  5 22:44:06 2020]
rule get_outgroups:
    input: per_gene/EOG091G07KL/EOG091G07KL.ingroup.fasta
    output: per_gene/EOG091G07KL/EOG091G07KL.orthodb.fasta, per_gene/EOG091G07KL/EOG091G07KL.outgroup.fasta
    log: per_gene/EOG091G07KL/get_outgroups.stdout.txt, per_gene/EOG091G07KL/get_outgroups.stderr.txt
    jobid: 3073
    wildcards: BUSCO=EOG091G07KL


        #download fastas from Orhtodb for BUSCO id
        for i in {1..5}
        do
             wget "http://www.orthodb.org/fasta?query=EOG091G07KL&level=33208" -O per_gene/EOG091G07KL/EOG091G07KL.orthodb.fasta 1> per_gene/EOG091G07KL/get_outgroups.stdout.txt 2> per_gene/EOG091G07KL/get_outgroups.stderr.txt && break || echo -e "try again ($i)" && sleep 15
        done

	#This is quick an dirty for now and just takes the first protein if there is more than one for an outgroup taxon
        bash ../scripts/download_outgroups.sh taxids.txt per_gene/EOG091G07KL/EOG091G07KL.orthodb.fasta > per_gene/EOG091G07KL/EOG091G07KL.outgroup.fasta
        
[Sun Jul  5 22:44:07 2020]
Finished job 3073.
1339 of 3292 steps (41%) done

[Sun Jul  5 22:44:07 2020]
rule join_groups:
    input: per_gene/EOG091G07KL/EOG091G07KL.ingroup.fasta, per_gene/EOG091G07KL/EOG091G07KL.outgroup.fasta
    output: per_gene/EOG091G07KL/EOG091G07KL.fasta
    jobid: 2360
    wildcards: BUSCO=EOG091G07KL


        cat per_gene/EOG091G07KL/EOG091G07KL.ingroup.fasta per_gene/EOG091G07KL/EOG091G07KL.outgroup.fasta > per_gene/EOG091G07KL/EOG091G07KL.fasta
        
[Sun Jul  5 22:44:07 2020]
Finished job 2360.
1340 of 3292 steps (41%) done

[Sun Jul  5 22:44:07 2020]
rule MSA:
    input: per_gene/EOG091G07KL/EOG091G07KL.fasta
    output: per_gene/EOG091G07KL/EOG091G07KL.clustalo.fasta
    log: per_gene/EOG091G07KL/MSA.stdout.txt, per_gene/EOG091G07KL/MSA.stderr.txt
    jobid: 1840
    wildcards: BUSCO=EOG091G07KL
    threads: 2


        clustalo -i per_gene/EOG091G07KL/EOG091G07KL.fasta -o per_gene/EOG091G07KL/EOG091G07KL.clustalo.fasta --threads=2 1> per_gene/EOG091G07KL/MSA.stdout.txt 2> per_gene/EOG091G07KL/MSA.stderr.txt
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/d68c9691725a7401923680874285c430.simg
[Sun Jul  5 22:44:09 2020]
Finished job 557.
1341 of 3292 steps (41%) done

[Sun Jul  5 22:44:09 2020]
rule remove_empty:
    input: per_gene/EOG091G0A19/ALICUT_EOG091G0A19.clustalo.fasta
    output: per_gene/EOG091G0A19/empty_check.done
    jobid: 1379
    wildcards: BUSCO=EOG091G0A19


         if [ "$(cat per_gene/EOG091G0A19/ALICUT_EOG091G0A19.clustalo.fasta | grep -v ">" | sed 's/-//g' | grep "^$" | wc -l)" -gt 0 ]
         then
              cp per_gene/EOG091G0A19/ALICUT_EOG091G0A19.clustalo.fasta per_gene/EOG091G0A19/ALICUT_EOG091G0A19.clustalo.fasta.backup
              bash ../scripts/remove_empty.sh per_gene/EOG091G0A19/ALICUT_EOG091G0A19.clustalo.fasta.backup > per_gene/EOG091G0A19/ALICUT_EOG091G0A19.clustalo.fasta
         fi
         touch per_gene/EOG091G0A19/empty_check.done
         
[Sun Jul  5 22:44:11 2020]
Finished job 1278.
1342 of 3292 steps (41%) done
[Sun Jul  5 22:44:11 2020]
Finished job 1840.
1343 of 3292 steps (41%) done
[Sun Jul  5 22:44:11 2020]
Finished job 1379.
1344 of 3292 steps (41%) done

[Sun Jul  5 22:44:11 2020]
rule find_best_model:
    input: per_gene/EOG091G0A19/ALICUT_EOG091G0A19.clustalo.fasta, per_gene/EOG091G0A19/empty_check.done
    output: per_gene/EOG091G0A19/EOG091G0A19.best_model
    log: per_gene/EOG091G0A19/find_best_model.stderr.txt
    jobid: 556
    wildcards: BUSCO=EOG091G0A19
    threads: 2


        cd per_gene/EOG091G0A19
        if [ ! -d find_best_model ]
        then
            mkdir find_best_model
        fi
        cd find_best_model
        ln -s ../../../per_gene/EOG091G0A19/ALICUT_EOG091G0A19.clustalo.fasta EOG091G0A19.fasta
        ProteinModelSelection.pl EOG091G0A19.fasta 1> ../../../per_gene/EOG091G0A19/EOG091G0A19.best_model 2> ../../../per_gene/EOG091G0A19/find_best_model.stderr.txt
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/c0c09ee657b1e27f2c5687e0e9aa8d70.simg

[Sun Jul  5 22:44:11 2020]
rule score_and_cut:
    input: per_gene/EOG091G07KL/EOG091G07KL.clustalo.fasta
    output: per_gene/EOG091G07KL/ALICUT_EOG091G07KL.clustalo.fasta
    jobid: 1017
    wildcards: BUSCO=EOG091G07KL
    threads: 2


        cd per_gene/EOG091G07KL
        Aliscore.pl -N -r 200000000000000000 -i ../../per_gene/EOG091G07KL/EOG091G07KL.clustalo.fasta &> aliscore.log
        ALICUT.pl -s &> alicut.log
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/63c88c27a0fa300f57066b0ef65fefcb.simg

[Sun Jul  5 22:44:11 2020]
rule score_and_cut:
    input: per_gene/EOG091G03JF/EOG091G03JF.clustalo.fasta
    output: per_gene/EOG091G03JF/ALICUT_EOG091G03JF.clustalo.fasta
    jobid: 455
    wildcards: BUSCO=EOG091G03JF
    threads: 2


        cd per_gene/EOG091G03JF
        Aliscore.pl -N -r 200000000000000000 -i ../../per_gene/EOG091G03JF/EOG091G03JF.clustalo.fasta &> aliscore.log
        ALICUT.pl -s &> alicut.log
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/63c88c27a0fa300f57066b0ef65fefcb.simg
[Sun Jul  5 22:44:17 2020]
Finished job 103.
1345 of 3292 steps (41%) done

[Sun Jul  5 22:44:17 2020]
rule get_seqs:
    input: /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ingroup.txt, /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/outgroup.txt
    output: per_gene/EOG091G0MRS/EOG091G0MRS.ingroup.fasta
    log: per_gene/EOG091G0MRS/get_seqs.stdout.txt, per_gene/EOG091G0MRS/get_seqs.stderr.txt
    jobid: 3002
    wildcards: BUSCO=EOG091G0MRS
    threads: 2


	basedir=$(pwd)
        cd per_gene/EOG091G0MRS
        
        bash $basedir/../scripts/fetch_seqs.sh EOG091G0MRS /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ingroup.txt /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/outgroup.txt 1> ../../per_gene/EOG091G0MRS/get_seqs.stdout.txt 2> ../../per_gene/EOG091G0MRS/get_seqs.stderr.txt
	mv EOG091G0MRS.fasta $basedir/per_gene/EOG091G0MRS/EOG091G0MRS.ingroup.fasta
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/72476f9d9a5bd0627b4d721143a21354.simg
[Sun Jul  5 22:44:21 2020]
Finished job 455.
1346 of 3292 steps (41%) done

[Sun Jul  5 22:44:21 2020]
rule remove_empty:
    input: per_gene/EOG091G03JF/ALICUT_EOG091G03JF.clustalo.fasta
    output: per_gene/EOG091G03JF/empty_check.done
    jobid: 1277
    wildcards: BUSCO=EOG091G03JF


         if [ "$(cat per_gene/EOG091G03JF/ALICUT_EOG091G03JF.clustalo.fasta | grep -v ">" | sed 's/-//g' | grep "^$" | wc -l)" -gt 0 ]
         then
              cp per_gene/EOG091G03JF/ALICUT_EOG091G03JF.clustalo.fasta per_gene/EOG091G03JF/ALICUT_EOG091G03JF.clustalo.fasta.backup
              bash ../scripts/remove_empty.sh per_gene/EOG091G03JF/ALICUT_EOG091G03JF.clustalo.fasta.backup > per_gene/EOG091G03JF/ALICUT_EOG091G03JF.clustalo.fasta
         fi
         touch per_gene/EOG091G03JF/empty_check.done
         
[Sun Jul  5 22:44:21 2020]
Finished job 1277.
1347 of 3292 steps (41%) done

[Sun Jul  5 22:44:21 2020]
rule find_best_model:
    input: per_gene/EOG091G03JF/ALICUT_EOG091G03JF.clustalo.fasta, per_gene/EOG091G03JF/empty_check.done
    output: per_gene/EOG091G03JF/EOG091G03JF.best_model
    log: per_gene/EOG091G03JF/find_best_model.stderr.txt
    jobid: 454
    wildcards: BUSCO=EOG091G03JF
    threads: 2


        cd per_gene/EOG091G03JF
        if [ ! -d find_best_model ]
        then
            mkdir find_best_model
        fi
        cd find_best_model
        ln -s ../../../per_gene/EOG091G03JF/ALICUT_EOG091G03JF.clustalo.fasta EOG091G03JF.fasta
        ProteinModelSelection.pl EOG091G03JF.fasta 1> ../../../per_gene/EOG091G03JF/EOG091G03JF.best_model 2> ../../../per_gene/EOG091G03JF/find_best_model.stderr.txt
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/c0c09ee657b1e27f2c5687e0e9aa8d70.simg
[Sun Jul  5 22:44:22 2020]
Finished job 1017.
1348 of 3292 steps (41%) done

[Sun Jul  5 22:44:22 2020]
rule remove_empty:
    input: per_gene/EOG091G07KL/ALICUT_EOG091G07KL.clustalo.fasta
    output: per_gene/EOG091G07KL/empty_check.done
    jobid: 1839
    wildcards: BUSCO=EOG091G07KL


         if [ "$(cat per_gene/EOG091G07KL/ALICUT_EOG091G07KL.clustalo.fasta | grep -v ">" | sed 's/-//g' | grep "^$" | wc -l)" -gt 0 ]
         then
              cp per_gene/EOG091G07KL/ALICUT_EOG091G07KL.clustalo.fasta per_gene/EOG091G07KL/ALICUT_EOG091G07KL.clustalo.fasta.backup
              bash ../scripts/remove_empty.sh per_gene/EOG091G07KL/ALICUT_EOG091G07KL.clustalo.fasta.backup > per_gene/EOG091G07KL/ALICUT_EOG091G07KL.clustalo.fasta
         fi
         touch per_gene/EOG091G07KL/empty_check.done
         
[Sun Jul  5 22:44:22 2020]
Finished job 1839.
1349 of 3292 steps (41%) done

[Sun Jul  5 22:44:22 2020]
rule find_best_model:
    input: per_gene/EOG091G07KL/ALICUT_EOG091G07KL.clustalo.fasta, per_gene/EOG091G07KL/empty_check.done
    output: per_gene/EOG091G07KL/EOG091G07KL.best_model
    log: per_gene/EOG091G07KL/find_best_model.stderr.txt
    jobid: 1016
    wildcards: BUSCO=EOG091G07KL
    threads: 2


        cd per_gene/EOG091G07KL
        if [ ! -d find_best_model ]
        then
            mkdir find_best_model
        fi
        cd find_best_model
        ln -s ../../../per_gene/EOG091G07KL/ALICUT_EOG091G07KL.clustalo.fasta EOG091G07KL.fasta
        ProteinModelSelection.pl EOG091G07KL.fasta 1> ../../../per_gene/EOG091G07KL/EOG091G07KL.best_model 2> ../../../per_gene/EOG091G07KL/find_best_model.stderr.txt
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/c0c09ee657b1e27f2c5687e0e9aa8d70.simg
[Sun Jul  5 22:44:22 2020]
Finished job 3046.
1350 of 3292 steps (41%) done

[Sun Jul  5 22:44:22 2020]
rule get_outgroups:
    input: per_gene/EOG091G184V/EOG091G184V.ingroup.fasta
    output: per_gene/EOG091G184V/EOG091G184V.orthodb.fasta, per_gene/EOG091G184V/EOG091G184V.outgroup.fasta
    log: per_gene/EOG091G184V/get_outgroups.stdout.txt, per_gene/EOG091G184V/get_outgroups.stderr.txt
    jobid: 3047
    wildcards: BUSCO=EOG091G184V


        #download fastas from Orhtodb for BUSCO id
        for i in {1..5}
        do
             wget "http://www.orthodb.org/fasta?query=EOG091G184V&level=33208" -O per_gene/EOG091G184V/EOG091G184V.orthodb.fasta 1> per_gene/EOG091G184V/get_outgroups.stdout.txt 2> per_gene/EOG091G184V/get_outgroups.stderr.txt && break || echo -e "try again ($i)" && sleep 15
        done

	#This is quick an dirty for now and just takes the first protein if there is more than one for an outgroup taxon
        bash ../scripts/download_outgroups.sh taxids.txt per_gene/EOG091G184V/EOG091G184V.orthodb.fasta > per_gene/EOG091G184V/EOG091G184V.outgroup.fasta
        
[Sun Jul  5 22:44:23 2020]
Finished job 3047.
1351 of 3292 steps (41%) done

[Sun Jul  5 22:44:23 2020]
rule join_groups:
    input: per_gene/EOG091G184V/EOG091G184V.ingroup.fasta, per_gene/EOG091G184V/EOG091G184V.outgroup.fasta
    output: per_gene/EOG091G184V/EOG091G184V.fasta
    jobid: 2347
    wildcards: BUSCO=EOG091G184V


        cat per_gene/EOG091G184V/EOG091G184V.ingroup.fasta per_gene/EOG091G184V/EOG091G184V.outgroup.fasta > per_gene/EOG091G184V/EOG091G184V.fasta
        
[Sun Jul  5 22:44:23 2020]
Finished job 2347.
1352 of 3292 steps (41%) done

[Sun Jul  5 22:44:23 2020]
rule MSA:
    input: per_gene/EOG091G184V/EOG091G184V.fasta
    output: per_gene/EOG091G184V/EOG091G184V.clustalo.fasta
    log: per_gene/EOG091G184V/MSA.stdout.txt, per_gene/EOG091G184V/MSA.stderr.txt
    jobid: 1814
    wildcards: BUSCO=EOG091G184V
    threads: 2


        clustalo -i per_gene/EOG091G184V/EOG091G184V.fasta -o per_gene/EOG091G184V/EOG091G184V.clustalo.fasta --threads=2 1> per_gene/EOG091G184V/MSA.stdout.txt 2> per_gene/EOG091G184V/MSA.stderr.txt
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/d68c9691725a7401923680874285c430.simg
[Sun Jul  5 22:44:24 2020]
Finished job 1814.
1353 of 3292 steps (41%) done

[Sun Jul  5 22:44:24 2020]
rule score_and_cut:
    input: per_gene/EOG091G184V/EOG091G184V.clustalo.fasta
    output: per_gene/EOG091G184V/ALICUT_EOG091G184V.clustalo.fasta
    jobid: 991
    wildcards: BUSCO=EOG091G184V
    threads: 2


        cd per_gene/EOG091G184V
        Aliscore.pl -N -r 200000000000000000 -i ../../per_gene/EOG091G184V/EOG091G184V.clustalo.fasta &> aliscore.log
        ALICUT.pl -s &> alicut.log
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/63c88c27a0fa300f57066b0ef65fefcb.simg
[Sun Jul  5 22:44:30 2020]
Finished job 3002.
1354 of 3292 steps (41%) done

[Sun Jul  5 22:44:30 2020]
rule get_outgroups:
    input: per_gene/EOG091G0MRS/EOG091G0MRS.ingroup.fasta
    output: per_gene/EOG091G0MRS/EOG091G0MRS.orthodb.fasta, per_gene/EOG091G0MRS/EOG091G0MRS.outgroup.fasta
    log: per_gene/EOG091G0MRS/get_outgroups.stdout.txt, per_gene/EOG091G0MRS/get_outgroups.stderr.txt
    jobid: 3003
    wildcards: BUSCO=EOG091G0MRS


        #download fastas from Orhtodb for BUSCO id
        for i in {1..5}
        do
             wget "http://www.orthodb.org/fasta?query=EOG091G0MRS&level=33208" -O per_gene/EOG091G0MRS/EOG091G0MRS.orthodb.fasta 1> per_gene/EOG091G0MRS/get_outgroups.stdout.txt 2> per_gene/EOG091G0MRS/get_outgroups.stderr.txt && break || echo -e "try again ($i)" && sleep 15
        done

	#This is quick an dirty for now and just takes the first protein if there is more than one for an outgroup taxon
        bash ../scripts/download_outgroups.sh taxids.txt per_gene/EOG091G0MRS/EOG091G0MRS.orthodb.fasta > per_gene/EOG091G0MRS/EOG091G0MRS.outgroup.fasta
        
[Sun Jul  5 22:44:31 2020]
Finished job 3003.
1355 of 3292 steps (41%) done

[Sun Jul  5 22:44:31 2020]
rule join_groups:
    input: per_gene/EOG091G0MRS/EOG091G0MRS.ingroup.fasta, per_gene/EOG091G0MRS/EOG091G0MRS.outgroup.fasta
    output: per_gene/EOG091G0MRS/EOG091G0MRS.fasta
    jobid: 2325
    wildcards: BUSCO=EOG091G0MRS


        cat per_gene/EOG091G0MRS/EOG091G0MRS.ingroup.fasta per_gene/EOG091G0MRS/EOG091G0MRS.outgroup.fasta > per_gene/EOG091G0MRS/EOG091G0MRS.fasta
        
[Sun Jul  5 22:44:31 2020]
Finished job 2325.
1356 of 3292 steps (41%) done

[Sun Jul  5 22:44:31 2020]
rule MSA:
    input: per_gene/EOG091G0MRS/EOG091G0MRS.fasta
    output: per_gene/EOG091G0MRS/EOG091G0MRS.clustalo.fasta
    log: per_gene/EOG091G0MRS/MSA.stdout.txt, per_gene/EOG091G0MRS/MSA.stderr.txt
    jobid: 1770
    wildcards: BUSCO=EOG091G0MRS
    threads: 2


        clustalo -i per_gene/EOG091G0MRS/EOG091G0MRS.fasta -o per_gene/EOG091G0MRS/EOG091G0MRS.clustalo.fasta --threads=2 1> per_gene/EOG091G0MRS/MSA.stdout.txt 2> per_gene/EOG091G0MRS/MSA.stderr.txt
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/d68c9691725a7401923680874285c430.simg
[Sun Jul  5 22:44:31 2020]
Finished job 1770.
1357 of 3292 steps (41%) done

[Sun Jul  5 22:44:31 2020]
rule score_and_cut:
    input: per_gene/EOG091G0MRS/EOG091G0MRS.clustalo.fasta
    output: per_gene/EOG091G0MRS/ALICUT_EOG091G0MRS.clustalo.fasta
    jobid: 947
    wildcards: BUSCO=EOG091G0MRS
    threads: 2


        cd per_gene/EOG091G0MRS
        Aliscore.pl -N -r 200000000000000000 -i ../../per_gene/EOG091G0MRS/EOG091G0MRS.clustalo.fasta &> aliscore.log
        ALICUT.pl -s &> alicut.log
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/63c88c27a0fa300f57066b0ef65fefcb.simg
[Sun Jul  5 22:44:31 2020]
Finished job 1038.
1358 of 3292 steps (41%) done

[Sun Jul  5 22:44:31 2020]
rule infer_single_ML:
    input: per_gene/EOG091G0ILS/EOG091G0ILS.best_model, per_gene/EOG091G0ILS/ALICUT_EOG091G0ILS.clustalo.fasta
    output: per_gene/EOG091G0ILS/EOG091G0ILS.raxml.done
    log: per_gene/EOG091G0ILS/infer_single_ML.stdout.txt, per_gene/EOG091G0ILS/infer_single_ML.stderr.txt
    jobid: 313
    wildcards: BUSCO=EOG091G0ILS
    threads: 2


        cd per_gene/EOG091G0ILS
	count=$(cat ../../per_gene/EOG091G0ILS/ALICUT_EOG091G0ILS.clustalo.fasta | grep ">" | wc -l)
	if [ "$count" -gt 5 ]
        then
		RAxMLmodel=$(cat ../../per_gene/EOG091G0ILS/EOG091G0ILS.best_model | grep "Best" | cut -d ":" -f 2 | tr -d '[:space:]')
                if [ "$(ls -1 | grep "^RAxML" | wc -l)" -ne 0 ]
		then
			rm RAxML*
		fi
        	raxml -f a -T 2 -m PROTGAMMA$RAxMLmodel         	-p 12345 -x 12345 -# 100         	-s ../../per_gene/EOG091G0ILS/ALICUT_EOG091G0ILS.clustalo.fasta -n EOG091G0ILS.clustalo.aln.ALICUT.$RAxMLmodel 		1> ../../per_gene/EOG091G0ILS/infer_single_ML.stdout.txt 2> ../../per_gene/EOG091G0ILS/infer_single_ML.stderr.txt
	else
		echo "fasta file per_gene/EOG091G0ILS/ALICUT_EOG091G0ILS.clustalo.fasta contains fewer than 5 sequences - skipped" > ../../per_gene/EOG091G0ILS/infer_single_ML.stdout.txt
		touch raxml.skipped
	fi
        touch ../../per_gene/EOG091G0ILS/EOG091G0ILS.raxml.done
        
[33mJob counts:
	count	jobs
	1	infer_single_ML
	1[0m
[33m
        cd per_gene/EOG091G0ILS
	count=$(cat ../../per_gene/EOG091G0ILS/ALICUT_EOG091G0ILS.clustalo.fasta | grep ">" | wc -l)
	if [ "$count" -gt 5 ]
        then
		RAxMLmodel=$(cat ../../per_gene/EOG091G0ILS/EOG091G0ILS.best_model | grep "Best" | cut -d ":" -f 2 | tr -d '[:space:]')
                if [ "$(ls -1 | grep "^RAxML" | wc -l)" -ne 0 ]
		then
			rm RAxML*
		fi
        	raxml -f a -T 2 -m PROTGAMMA$RAxMLmodel         	-p 12345 -x 12345 -# 100         	-s ../../per_gene/EOG091G0ILS/ALICUT_EOG091G0ILS.clustalo.fasta -n EOG091G0ILS.clustalo.aln.ALICUT.$RAxMLmodel 		1> ../../per_gene/EOG091G0ILS/infer_single_ML.stdout.txt 2> ../../per_gene/EOG091G0ILS/infer_single_ML.stderr.txt
	else
		echo "fasta file per_gene/EOG091G0ILS/ALICUT_EOG091G0ILS.clustalo.fasta contains fewer than 5 sequences - skipped" > ../../per_gene/EOG091G0ILS/infer_single_ML.stdout.txt
		touch raxml.skipped
	fi
        touch ../../per_gene/EOG091G0ILS/EOG091G0ILS.raxml.done
        [0m
[Sun Jul  5 22:44:34 2020]
Finished job 991.
1359 of 3292 steps (41%) done

[Sun Jul  5 22:44:34 2020]
rule remove_empty:
    input: per_gene/EOG091G184V/ALICUT_EOG091G184V.clustalo.fasta
    output: per_gene/EOG091G184V/empty_check.done
    jobid: 1813
    wildcards: BUSCO=EOG091G184V


         if [ "$(cat per_gene/EOG091G184V/ALICUT_EOG091G184V.clustalo.fasta | grep -v ">" | sed 's/-//g' | grep "^$" | wc -l)" -gt 0 ]
         then
              cp per_gene/EOG091G184V/ALICUT_EOG091G184V.clustalo.fasta per_gene/EOG091G184V/ALICUT_EOG091G184V.clustalo.fasta.backup
              bash ../scripts/remove_empty.sh per_gene/EOG091G184V/ALICUT_EOG091G184V.clustalo.fasta.backup > per_gene/EOG091G184V/ALICUT_EOG091G184V.clustalo.fasta
         fi
         touch per_gene/EOG091G184V/empty_check.done
         
[Sun Jul  5 22:44:34 2020]
Finished job 1813.
1360 of 3292 steps (41%) done

[Sun Jul  5 22:44:34 2020]
rule find_best_model:
    input: per_gene/EOG091G184V/ALICUT_EOG091G184V.clustalo.fasta, per_gene/EOG091G184V/empty_check.done
    output: per_gene/EOG091G184V/EOG091G184V.best_model
    log: per_gene/EOG091G184V/find_best_model.stderr.txt
    jobid: 990
    wildcards: BUSCO=EOG091G184V
    threads: 2


        cd per_gene/EOG091G184V
        if [ ! -d find_best_model ]
        then
            mkdir find_best_model
        fi
        cd find_best_model
        ln -s ../../../per_gene/EOG091G184V/ALICUT_EOG091G184V.clustalo.fasta EOG091G184V.fasta
        ProteinModelSelection.pl EOG091G184V.fasta 1> ../../../per_gene/EOG091G184V/EOG091G184V.best_model 2> ../../../per_gene/EOG091G184V/find_best_model.stderr.txt
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/c0c09ee657b1e27f2c5687e0e9aa8d70.simg
[Sun Jul  5 22:44:38 2020]
Finished job 49.
1361 of 3292 steps (41%) done

[Sun Jul  5 22:44:38 2020]
rule get_seqs:
    input: /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ingroup.txt, /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/outgroup.txt
    output: per_gene/EOG091G0QGZ/EOG091G0QGZ.ingroup.fasta
    log: per_gene/EOG091G0QGZ/get_seqs.stdout.txt, per_gene/EOG091G0QGZ/get_seqs.stderr.txt
    jobid: 2810
    wildcards: BUSCO=EOG091G0QGZ
    threads: 2


	basedir=$(pwd)
        cd per_gene/EOG091G0QGZ
        
        bash $basedir/../scripts/fetch_seqs.sh EOG091G0QGZ /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ingroup.txt /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/outgroup.txt 1> ../../per_gene/EOG091G0QGZ/get_seqs.stdout.txt 2> ../../per_gene/EOG091G0QGZ/get_seqs.stderr.txt
	mv EOG091G0QGZ.fasta $basedir/per_gene/EOG091G0QGZ/EOG091G0QGZ.ingroup.fasta
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/72476f9d9a5bd0627b4d721143a21354.simg
[Sun Jul  5 22:44:41 2020]
Finished job 947.
1362 of 3292 steps (41%) done

[Sun Jul  5 22:44:41 2020]
rule remove_empty:
    input: per_gene/EOG091G0MRS/ALICUT_EOG091G0MRS.clustalo.fasta
    output: per_gene/EOG091G0MRS/empty_check.done
    jobid: 1769
    wildcards: BUSCO=EOG091G0MRS


         if [ "$(cat per_gene/EOG091G0MRS/ALICUT_EOG091G0MRS.clustalo.fasta | grep -v ">" | sed 's/-//g' | grep "^$" | wc -l)" -gt 0 ]
         then
              cp per_gene/EOG091G0MRS/ALICUT_EOG091G0MRS.clustalo.fasta per_gene/EOG091G0MRS/ALICUT_EOG091G0MRS.clustalo.fasta.backup
              bash ../scripts/remove_empty.sh per_gene/EOG091G0MRS/ALICUT_EOG091G0MRS.clustalo.fasta.backup > per_gene/EOG091G0MRS/ALICUT_EOG091G0MRS.clustalo.fasta
         fi
         touch per_gene/EOG091G0MRS/empty_check.done
         
[Sun Jul  5 22:44:41 2020]
Finished job 1769.
1363 of 3292 steps (41%) done

[Sun Jul  5 22:44:41 2020]
rule find_best_model:
    input: per_gene/EOG091G0MRS/ALICUT_EOG091G0MRS.clustalo.fasta, per_gene/EOG091G0MRS/empty_check.done
    output: per_gene/EOG091G0MRS/EOG091G0MRS.best_model
    log: per_gene/EOG091G0MRS/find_best_model.stderr.txt
    jobid: 946
    wildcards: BUSCO=EOG091G0MRS
    threads: 2


        cd per_gene/EOG091G0MRS
        if [ ! -d find_best_model ]
        then
            mkdir find_best_model
        fi
        cd find_best_model
        ln -s ../../../per_gene/EOG091G0MRS/ALICUT_EOG091G0MRS.clustalo.fasta EOG091G0MRS.fasta
        ProteinModelSelection.pl EOG091G0MRS.fasta 1> ../../../per_gene/EOG091G0MRS/EOG091G0MRS.best_model 2> ../../../per_gene/EOG091G0MRS/find_best_model.stderr.txt
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/c0c09ee657b1e27f2c5687e0e9aa8d70.simg
[Sun Jul  5 22:44:46 2020]
Finished job 1046.
1364 of 3292 steps (41%) done

[Sun Jul  5 22:44:46 2020]
rule infer_single_ML:
    input: per_gene/EOG091G0P5N/EOG091G0P5N.best_model, per_gene/EOG091G0P5N/ALICUT_EOG091G0P5N.clustalo.fasta
    output: per_gene/EOG091G0P5N/EOG091G0P5N.raxml.done
    log: per_gene/EOG091G0P5N/infer_single_ML.stdout.txt, per_gene/EOG091G0P5N/infer_single_ML.stderr.txt
    jobid: 317
    wildcards: BUSCO=EOG091G0P5N
    threads: 2


        cd per_gene/EOG091G0P5N
	count=$(cat ../../per_gene/EOG091G0P5N/ALICUT_EOG091G0P5N.clustalo.fasta | grep ">" | wc -l)
	if [ "$count" -gt 5 ]
        then
		RAxMLmodel=$(cat ../../per_gene/EOG091G0P5N/EOG091G0P5N.best_model | grep "Best" | cut -d ":" -f 2 | tr -d '[:space:]')
                if [ "$(ls -1 | grep "^RAxML" | wc -l)" -ne 0 ]
		then
			rm RAxML*
		fi
        	raxml -f a -T 2 -m PROTGAMMA$RAxMLmodel         	-p 12345 -x 12345 -# 100         	-s ../../per_gene/EOG091G0P5N/ALICUT_EOG091G0P5N.clustalo.fasta -n EOG091G0P5N.clustalo.aln.ALICUT.$RAxMLmodel 		1> ../../per_gene/EOG091G0P5N/infer_single_ML.stdout.txt 2> ../../per_gene/EOG091G0P5N/infer_single_ML.stderr.txt
	else
		echo "fasta file per_gene/EOG091G0P5N/ALICUT_EOG091G0P5N.clustalo.fasta contains fewer than 5 sequences - skipped" > ../../per_gene/EOG091G0P5N/infer_single_ML.stdout.txt
		touch raxml.skipped
	fi
        touch ../../per_gene/EOG091G0P5N/EOG091G0P5N.raxml.done
        
[33mJob counts:
	count	jobs
	1	infer_single_ML
	1[0m
[33m
        cd per_gene/EOG091G0P5N
	count=$(cat ../../per_gene/EOG091G0P5N/ALICUT_EOG091G0P5N.clustalo.fasta | grep ">" | wc -l)
	if [ "$count" -gt 5 ]
        then
		RAxMLmodel=$(cat ../../per_gene/EOG091G0P5N/EOG091G0P5N.best_model | grep "Best" | cut -d ":" -f 2 | tr -d '[:space:]')
                if [ "$(ls -1 | grep "^RAxML" | wc -l)" -ne 0 ]
		then
			rm RAxML*
		fi
        	raxml -f a -T 2 -m PROTGAMMA$RAxMLmodel         	-p 12345 -x 12345 -# 100         	-s ../../per_gene/EOG091G0P5N/ALICUT_EOG091G0P5N.clustalo.fasta -n EOG091G0P5N.clustalo.aln.ALICUT.$RAxMLmodel 		1> ../../per_gene/EOG091G0P5N/infer_single_ML.stdout.txt 2> ../../per_gene/EOG091G0P5N/infer_single_ML.stderr.txt
	else
		echo "fasta file per_gene/EOG091G0P5N/ALICUT_EOG091G0P5N.clustalo.fasta contains fewer than 5 sequences - skipped" > ../../per_gene/EOG091G0P5N/infer_single_ML.stdout.txt
		touch raxml.skipped
	fi
        touch ../../per_gene/EOG091G0P5N/EOG091G0P5N.raxml.done
        [0m
[Sun Jul  5 22:44:48 2020]
Finished job 556.
1365 of 3292 steps (41%) done

[Sun Jul  5 22:44:48 2020]
rule infer_single_ML:
    input: per_gene/EOG091G0A19/EOG091G0A19.best_model, per_gene/EOG091G0A19/ALICUT_EOG091G0A19.clustalo.fasta
    output: per_gene/EOG091G0A19/EOG091G0A19.raxml.done
    log: per_gene/EOG091G0A19/infer_single_ML.stdout.txt, per_gene/EOG091G0A19/infer_single_ML.stderr.txt
    jobid: 72
    wildcards: BUSCO=EOG091G0A19
    threads: 2


        cd per_gene/EOG091G0A19
	count=$(cat ../../per_gene/EOG091G0A19/ALICUT_EOG091G0A19.clustalo.fasta | grep ">" | wc -l)
	if [ "$count" -gt 5 ]
        then
		RAxMLmodel=$(cat ../../per_gene/EOG091G0A19/EOG091G0A19.best_model | grep "Best" | cut -d ":" -f 2 | tr -d '[:space:]')
                if [ "$(ls -1 | grep "^RAxML" | wc -l)" -ne 0 ]
		then
			rm RAxML*
		fi
        	raxml -f a -T 2 -m PROTGAMMA$RAxMLmodel         	-p 12345 -x 12345 -# 100         	-s ../../per_gene/EOG091G0A19/ALICUT_EOG091G0A19.clustalo.fasta -n EOG091G0A19.clustalo.aln.ALICUT.$RAxMLmodel 		1> ../../per_gene/EOG091G0A19/infer_single_ML.stdout.txt 2> ../../per_gene/EOG091G0A19/infer_single_ML.stderr.txt
	else
		echo "fasta file per_gene/EOG091G0A19/ALICUT_EOG091G0A19.clustalo.fasta contains fewer than 5 sequences - skipped" > ../../per_gene/EOG091G0A19/infer_single_ML.stdout.txt
		touch raxml.skipped
	fi
        touch ../../per_gene/EOG091G0A19/EOG091G0A19.raxml.done
        
[33mJob counts:
	count	jobs
	1	infer_single_ML
	1[0m
[33m
        cd per_gene/EOG091G0A19
	count=$(cat ../../per_gene/EOG091G0A19/ALICUT_EOG091G0A19.clustalo.fasta | grep ">" | wc -l)
	if [ "$count" -gt 5 ]
        then
		RAxMLmodel=$(cat ../../per_gene/EOG091G0A19/EOG091G0A19.best_model | grep "Best" | cut -d ":" -f 2 | tr -d '[:space:]')
                if [ "$(ls -1 | grep "^RAxML" | wc -l)" -ne 0 ]
		then
			rm RAxML*
		fi
        	raxml -f a -T 2 -m PROTGAMMA$RAxMLmodel         	-p 12345 -x 12345 -# 100         	-s ../../per_gene/EOG091G0A19/ALICUT_EOG091G0A19.clustalo.fasta -n EOG091G0A19.clustalo.aln.ALICUT.$RAxMLmodel 		1> ../../per_gene/EOG091G0A19/infer_single_ML.stdout.txt 2> ../../per_gene/EOG091G0A19/infer_single_ML.stderr.txt
	else
		echo "fasta file per_gene/EOG091G0A19/ALICUT_EOG091G0A19.clustalo.fasta contains fewer than 5 sequences - skipped" > ../../per_gene/EOG091G0A19/infer_single_ML.stdout.txt
		touch raxml.skipped
	fi
        touch ../../per_gene/EOG091G0A19/EOG091G0A19.raxml.done
        [0m
[Sun Jul  5 22:44:58 2020]
Finished job 2810.
1366 of 3292 steps (41%) done

[Sun Jul  5 22:44:58 2020]
rule get_outgroups:
    input: per_gene/EOG091G0QGZ/EOG091G0QGZ.ingroup.fasta
    output: per_gene/EOG091G0QGZ/EOG091G0QGZ.orthodb.fasta, per_gene/EOG091G0QGZ/EOG091G0QGZ.outgroup.fasta
    log: per_gene/EOG091G0QGZ/get_outgroups.stdout.txt, per_gene/EOG091G0QGZ/get_outgroups.stderr.txt
    jobid: 2811
    wildcards: BUSCO=EOG091G0QGZ


        #download fastas from Orhtodb for BUSCO id
        for i in {1..5}
        do
             wget "http://www.orthodb.org/fasta?query=EOG091G0QGZ&level=33208" -O per_gene/EOG091G0QGZ/EOG091G0QGZ.orthodb.fasta 1> per_gene/EOG091G0QGZ/get_outgroups.stdout.txt 2> per_gene/EOG091G0QGZ/get_outgroups.stderr.txt && break || echo -e "try again ($i)" && sleep 15
        done

	#This is quick an dirty for now and just takes the first protein if there is more than one for an outgroup taxon
        bash ../scripts/download_outgroups.sh taxids.txt per_gene/EOG091G0QGZ/EOG091G0QGZ.orthodb.fasta > per_gene/EOG091G0QGZ/EOG091G0QGZ.outgroup.fasta
        
[Sun Jul  5 22:44:59 2020]
Finished job 2811.
1367 of 3292 steps (42%) done

[Sun Jul  5 22:44:59 2020]
rule join_groups:
    input: per_gene/EOG091G0QGZ/EOG091G0QGZ.ingroup.fasta, per_gene/EOG091G0QGZ/EOG091G0QGZ.outgroup.fasta
    output: per_gene/EOG091G0QGZ/EOG091G0QGZ.fasta
    jobid: 2229
    wildcards: BUSCO=EOG091G0QGZ


        cat per_gene/EOG091G0QGZ/EOG091G0QGZ.ingroup.fasta per_gene/EOG091G0QGZ/EOG091G0QGZ.outgroup.fasta > per_gene/EOG091G0QGZ/EOG091G0QGZ.fasta
        
[Sun Jul  5 22:44:59 2020]
Finished job 2229.
1368 of 3292 steps (42%) done

[Sun Jul  5 22:44:59 2020]
rule MSA:
    input: per_gene/EOG091G0QGZ/EOG091G0QGZ.fasta
    output: per_gene/EOG091G0QGZ/EOG091G0QGZ.clustalo.fasta
    log: per_gene/EOG091G0QGZ/MSA.stdout.txt, per_gene/EOG091G0QGZ/MSA.stderr.txt
    jobid: 1578
    wildcards: BUSCO=EOG091G0QGZ
    threads: 2


        clustalo -i per_gene/EOG091G0QGZ/EOG091G0QGZ.fasta -o per_gene/EOG091G0QGZ/EOG091G0QGZ.clustalo.fasta --threads=2 1> per_gene/EOG091G0QGZ/MSA.stdout.txt 2> per_gene/EOG091G0QGZ/MSA.stderr.txt
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/d68c9691725a7401923680874285c430.simg
[Sun Jul  5 22:44:59 2020]
Finished job 1578.
1369 of 3292 steps (42%) done

[Sun Jul  5 22:44:59 2020]
rule score_and_cut:
    input: per_gene/EOG091G0QGZ/EOG091G0QGZ.clustalo.fasta
    output: per_gene/EOG091G0QGZ/ALICUT_EOG091G0QGZ.clustalo.fasta
    jobid: 755
    wildcards: BUSCO=EOG091G0QGZ
    threads: 2


        cd per_gene/EOG091G0QGZ
        Aliscore.pl -N -r 200000000000000000 -i ../../per_gene/EOG091G0QGZ/EOG091G0QGZ.clustalo.fasta &> aliscore.log
        ALICUT.pl -s &> alicut.log
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/63c88c27a0fa300f57066b0ef65fefcb.simg
[Sun Jul  5 22:45:05 2020]
Finished job 990.
1370 of 3292 steps (42%) done

[Sun Jul  5 22:45:05 2020]
rule infer_single_ML:
    input: per_gene/EOG091G184V/EOG091G184V.best_model, per_gene/EOG091G184V/ALICUT_EOG091G184V.clustalo.fasta
    output: per_gene/EOG091G184V/EOG091G184V.raxml.done
    log: per_gene/EOG091G184V/infer_single_ML.stdout.txt, per_gene/EOG091G184V/infer_single_ML.stderr.txt
    jobid: 289
    wildcards: BUSCO=EOG091G184V
    threads: 2


        cd per_gene/EOG091G184V
	count=$(cat ../../per_gene/EOG091G184V/ALICUT_EOG091G184V.clustalo.fasta | grep ">" | wc -l)
	if [ "$count" -gt 5 ]
        then
		RAxMLmodel=$(cat ../../per_gene/EOG091G184V/EOG091G184V.best_model | grep "Best" | cut -d ":" -f 2 | tr -d '[:space:]')
                if [ "$(ls -1 | grep "^RAxML" | wc -l)" -ne 0 ]
		then
			rm RAxML*
		fi
        	raxml -f a -T 2 -m PROTGAMMA$RAxMLmodel         	-p 12345 -x 12345 -# 100         	-s ../../per_gene/EOG091G184V/ALICUT_EOG091G184V.clustalo.fasta -n EOG091G184V.clustalo.aln.ALICUT.$RAxMLmodel 		1> ../../per_gene/EOG091G184V/infer_single_ML.stdout.txt 2> ../../per_gene/EOG091G184V/infer_single_ML.stderr.txt
	else
		echo "fasta file per_gene/EOG091G184V/ALICUT_EOG091G184V.clustalo.fasta contains fewer than 5 sequences - skipped" > ../../per_gene/EOG091G184V/infer_single_ML.stdout.txt
		touch raxml.skipped
	fi
        touch ../../per_gene/EOG091G184V/EOG091G184V.raxml.done
        
[33mJob counts:
	count	jobs
	1	infer_single_ML
	1[0m
[33m
        cd per_gene/EOG091G184V
	count=$(cat ../../per_gene/EOG091G184V/ALICUT_EOG091G184V.clustalo.fasta | grep ">" | wc -l)
	if [ "$count" -gt 5 ]
        then
		RAxMLmodel=$(cat ../../per_gene/EOG091G184V/EOG091G184V.best_model | grep "Best" | cut -d ":" -f 2 | tr -d '[:space:]')
                if [ "$(ls -1 | grep "^RAxML" | wc -l)" -ne 0 ]
		then
			rm RAxML*
		fi
        	raxml -f a -T 2 -m PROTGAMMA$RAxMLmodel         	-p 12345 -x 12345 -# 100         	-s ../../per_gene/EOG091G184V/ALICUT_EOG091G184V.clustalo.fasta -n EOG091G184V.clustalo.aln.ALICUT.$RAxMLmodel 		1> ../../per_gene/EOG091G184V/infer_single_ML.stdout.txt 2> ../../per_gene/EOG091G184V/infer_single_ML.stderr.txt
	else
		echo "fasta file per_gene/EOG091G184V/ALICUT_EOG091G184V.clustalo.fasta contains fewer than 5 sequences - skipped" > ../../per_gene/EOG091G184V/infer_single_ML.stdout.txt
		touch raxml.skipped
	fi
        touch ../../per_gene/EOG091G184V/EOG091G184V.raxml.done
        [0m
[Sun Jul  5 22:45:09 2020]
Finished job 755.
1371 of 3292 steps (42%) done

[Sun Jul  5 22:45:09 2020]
rule remove_empty:
    input: per_gene/EOG091G0QGZ/ALICUT_EOG091G0QGZ.clustalo.fasta
    output: per_gene/EOG091G0QGZ/empty_check.done
    jobid: 1577
    wildcards: BUSCO=EOG091G0QGZ


         if [ "$(cat per_gene/EOG091G0QGZ/ALICUT_EOG091G0QGZ.clustalo.fasta | grep -v ">" | sed 's/-//g' | grep "^$" | wc -l)" -gt 0 ]
         then
              cp per_gene/EOG091G0QGZ/ALICUT_EOG091G0QGZ.clustalo.fasta per_gene/EOG091G0QGZ/ALICUT_EOG091G0QGZ.clustalo.fasta.backup
              bash ../scripts/remove_empty.sh per_gene/EOG091G0QGZ/ALICUT_EOG091G0QGZ.clustalo.fasta.backup > per_gene/EOG091G0QGZ/ALICUT_EOG091G0QGZ.clustalo.fasta
         fi
         touch per_gene/EOG091G0QGZ/empty_check.done
         
[Sun Jul  5 22:45:09 2020]
Finished job 1577.
1372 of 3292 steps (42%) done

[Sun Jul  5 22:45:09 2020]
rule find_best_model:
    input: per_gene/EOG091G0QGZ/ALICUT_EOG091G0QGZ.clustalo.fasta, per_gene/EOG091G0QGZ/empty_check.done
    output: per_gene/EOG091G0QGZ/EOG091G0QGZ.best_model
    log: per_gene/EOG091G0QGZ/find_best_model.stderr.txt
    jobid: 754
    wildcards: BUSCO=EOG091G0QGZ
    threads: 2


        cd per_gene/EOG091G0QGZ
        if [ ! -d find_best_model ]
        then
            mkdir find_best_model
        fi
        cd find_best_model
        ln -s ../../../per_gene/EOG091G0QGZ/ALICUT_EOG091G0QGZ.clustalo.fasta EOG091G0QGZ.fasta
        ProteinModelSelection.pl EOG091G0QGZ.fasta 1> ../../../per_gene/EOG091G0QGZ/EOG091G0QGZ.best_model 2> ../../../per_gene/EOG091G0QGZ/find_best_model.stderr.txt
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/c0c09ee657b1e27f2c5687e0e9aa8d70.simg
[Sun Jul  5 22:45:09 2020]
Finished job 1016.
1373 of 3292 steps (42%) done

[Sun Jul  5 22:45:09 2020]
rule infer_single_ML:
    input: per_gene/EOG091G07KL/EOG091G07KL.best_model, per_gene/EOG091G07KL/ALICUT_EOG091G07KL.clustalo.fasta
    output: per_gene/EOG091G07KL/EOG091G07KL.raxml.done
    log: per_gene/EOG091G07KL/infer_single_ML.stdout.txt, per_gene/EOG091G07KL/infer_single_ML.stderr.txt
    jobid: 302
    wildcards: BUSCO=EOG091G07KL
    threads: 2


        cd per_gene/EOG091G07KL
	count=$(cat ../../per_gene/EOG091G07KL/ALICUT_EOG091G07KL.clustalo.fasta | grep ">" | wc -l)
	if [ "$count" -gt 5 ]
        then
		RAxMLmodel=$(cat ../../per_gene/EOG091G07KL/EOG091G07KL.best_model | grep "Best" | cut -d ":" -f 2 | tr -d '[:space:]')
                if [ "$(ls -1 | grep "^RAxML" | wc -l)" -ne 0 ]
		then
			rm RAxML*
		fi
        	raxml -f a -T 2 -m PROTGAMMA$RAxMLmodel         	-p 12345 -x 12345 -# 100         	-s ../../per_gene/EOG091G07KL/ALICUT_EOG091G07KL.clustalo.fasta -n EOG091G07KL.clustalo.aln.ALICUT.$RAxMLmodel 		1> ../../per_gene/EOG091G07KL/infer_single_ML.stdout.txt 2> ../../per_gene/EOG091G07KL/infer_single_ML.stderr.txt
	else
		echo "fasta file per_gene/EOG091G07KL/ALICUT_EOG091G07KL.clustalo.fasta contains fewer than 5 sequences - skipped" > ../../per_gene/EOG091G07KL/infer_single_ML.stdout.txt
		touch raxml.skipped
	fi
        touch ../../per_gene/EOG091G07KL/EOG091G07KL.raxml.done
        
[33mJob counts:
	count	jobs
	1	infer_single_ML
	1[0m
[33m
        cd per_gene/EOG091G07KL
	count=$(cat ../../per_gene/EOG091G07KL/ALICUT_EOG091G07KL.clustalo.fasta | grep ">" | wc -l)
	if [ "$count" -gt 5 ]
        then
		RAxMLmodel=$(cat ../../per_gene/EOG091G07KL/EOG091G07KL.best_model | grep "Best" | cut -d ":" -f 2 | tr -d '[:space:]')
                if [ "$(ls -1 | grep "^RAxML" | wc -l)" -ne 0 ]
		then
			rm RAxML*
		fi
        	raxml -f a -T 2 -m PROTGAMMA$RAxMLmodel         	-p 12345 -x 12345 -# 100         	-s ../../per_gene/EOG091G07KL/ALICUT_EOG091G07KL.clustalo.fasta -n EOG091G07KL.clustalo.aln.ALICUT.$RAxMLmodel 		1> ../../per_gene/EOG091G07KL/infer_single_ML.stdout.txt 2> ../../per_gene/EOG091G07KL/infer_single_ML.stderr.txt
	else
		echo "fasta file per_gene/EOG091G07KL/ALICUT_EOG091G07KL.clustalo.fasta contains fewer than 5 sequences - skipped" > ../../per_gene/EOG091G07KL/infer_single_ML.stdout.txt
		touch raxml.skipped
	fi
        touch ../../per_gene/EOG091G07KL/EOG091G07KL.raxml.done
        [0m
[Sun Jul  5 22:45:10 2020]
Finished job 946.
1374 of 3292 steps (42%) done

[Sun Jul  5 22:45:10 2020]
rule infer_single_ML:
    input: per_gene/EOG091G0MRS/EOG091G0MRS.best_model, per_gene/EOG091G0MRS/ALICUT_EOG091G0MRS.clustalo.fasta
    output: per_gene/EOG091G0MRS/EOG091G0MRS.raxml.done
    log: per_gene/EOG091G0MRS/infer_single_ML.stdout.txt, per_gene/EOG091G0MRS/infer_single_ML.stderr.txt
    jobid: 267
    wildcards: BUSCO=EOG091G0MRS
    threads: 2


        cd per_gene/EOG091G0MRS
	count=$(cat ../../per_gene/EOG091G0MRS/ALICUT_EOG091G0MRS.clustalo.fasta | grep ">" | wc -l)
	if [ "$count" -gt 5 ]
        then
		RAxMLmodel=$(cat ../../per_gene/EOG091G0MRS/EOG091G0MRS.best_model | grep "Best" | cut -d ":" -f 2 | tr -d '[:space:]')
                if [ "$(ls -1 | grep "^RAxML" | wc -l)" -ne 0 ]
		then
			rm RAxML*
		fi
        	raxml -f a -T 2 -m PROTGAMMA$RAxMLmodel         	-p 12345 -x 12345 -# 100         	-s ../../per_gene/EOG091G0MRS/ALICUT_EOG091G0MRS.clustalo.fasta -n EOG091G0MRS.clustalo.aln.ALICUT.$RAxMLmodel 		1> ../../per_gene/EOG091G0MRS/infer_single_ML.stdout.txt 2> ../../per_gene/EOG091G0MRS/infer_single_ML.stderr.txt
	else
		echo "fasta file per_gene/EOG091G0MRS/ALICUT_EOG091G0MRS.clustalo.fasta contains fewer than 5 sequences - skipped" > ../../per_gene/EOG091G0MRS/infer_single_ML.stdout.txt
		touch raxml.skipped
	fi
        touch ../../per_gene/EOG091G0MRS/EOG091G0MRS.raxml.done
        
[33mJob counts:
	count	jobs
	1	infer_single_ML
	1[0m
[33m
        cd per_gene/EOG091G0MRS
	count=$(cat ../../per_gene/EOG091G0MRS/ALICUT_EOG091G0MRS.clustalo.fasta | grep ">" | wc -l)
	if [ "$count" -gt 5 ]
        then
		RAxMLmodel=$(cat ../../per_gene/EOG091G0MRS/EOG091G0MRS.best_model | grep "Best" | cut -d ":" -f 2 | tr -d '[:space:]')
                if [ "$(ls -1 | grep "^RAxML" | wc -l)" -ne 0 ]
		then
			rm RAxML*
		fi
        	raxml -f a -T 2 -m PROTGAMMA$RAxMLmodel         	-p 12345 -x 12345 -# 100         	-s ../../per_gene/EOG091G0MRS/ALICUT_EOG091G0MRS.clustalo.fasta -n EOG091G0MRS.clustalo.aln.ALICUT.$RAxMLmodel 		1> ../../per_gene/EOG091G0MRS/infer_single_ML.stdout.txt 2> ../../per_gene/EOG091G0MRS/infer_single_ML.stderr.txt
	else
		echo "fasta file per_gene/EOG091G0MRS/ALICUT_EOG091G0MRS.clustalo.fasta contains fewer than 5 sequences - skipped" > ../../per_gene/EOG091G0MRS/infer_single_ML.stdout.txt
		touch raxml.skipped
	fi
        touch ../../per_gene/EOG091G0MRS/EOG091G0MRS.raxml.done
        [0m
[Sun Jul  5 22:45:23 2020]
Finished job 454.
1375 of 3292 steps (42%) done

[Sun Jul  5 22:45:23 2020]
rule infer_single_ML:
    input: per_gene/EOG091G03JF/EOG091G03JF.best_model, per_gene/EOG091G03JF/ALICUT_EOG091G03JF.clustalo.fasta
    output: per_gene/EOG091G03JF/EOG091G03JF.raxml.done
    log: per_gene/EOG091G03JF/infer_single_ML.stdout.txt, per_gene/EOG091G03JF/infer_single_ML.stderr.txt
    jobid: 21
    wildcards: BUSCO=EOG091G03JF
    threads: 2


        cd per_gene/EOG091G03JF
	count=$(cat ../../per_gene/EOG091G03JF/ALICUT_EOG091G03JF.clustalo.fasta | grep ">" | wc -l)
	if [ "$count" -gt 5 ]
        then
		RAxMLmodel=$(cat ../../per_gene/EOG091G03JF/EOG091G03JF.best_model | grep "Best" | cut -d ":" -f 2 | tr -d '[:space:]')
                if [ "$(ls -1 | grep "^RAxML" | wc -l)" -ne 0 ]
		then
			rm RAxML*
		fi
        	raxml -f a -T 2 -m PROTGAMMA$RAxMLmodel         	-p 12345 -x 12345 -# 100         	-s ../../per_gene/EOG091G03JF/ALICUT_EOG091G03JF.clustalo.fasta -n EOG091G03JF.clustalo.aln.ALICUT.$RAxMLmodel 		1> ../../per_gene/EOG091G03JF/infer_single_ML.stdout.txt 2> ../../per_gene/EOG091G03JF/infer_single_ML.stderr.txt
	else
		echo "fasta file per_gene/EOG091G03JF/ALICUT_EOG091G03JF.clustalo.fasta contains fewer than 5 sequences - skipped" > ../../per_gene/EOG091G03JF/infer_single_ML.stdout.txt
		touch raxml.skipped
	fi
        touch ../../per_gene/EOG091G03JF/EOG091G03JF.raxml.done
        
[33mJob counts:
	count	jobs
	1	infer_single_ML
	1[0m
[33m
        cd per_gene/EOG091G03JF
	count=$(cat ../../per_gene/EOG091G03JF/ALICUT_EOG091G03JF.clustalo.fasta | grep ">" | wc -l)
	if [ "$count" -gt 5 ]
        then
		RAxMLmodel=$(cat ../../per_gene/EOG091G03JF/EOG091G03JF.best_model | grep "Best" | cut -d ":" -f 2 | tr -d '[:space:]')
                if [ "$(ls -1 | grep "^RAxML" | wc -l)" -ne 0 ]
		then
			rm RAxML*
		fi
        	raxml -f a -T 2 -m PROTGAMMA$RAxMLmodel         	-p 12345 -x 12345 -# 100         	-s ../../per_gene/EOG091G03JF/ALICUT_EOG091G03JF.clustalo.fasta -n EOG091G03JF.clustalo.aln.ALICUT.$RAxMLmodel 		1> ../../per_gene/EOG091G03JF/infer_single_ML.stdout.txt 2> ../../per_gene/EOG091G03JF/infer_single_ML.stderr.txt
	else
		echo "fasta file per_gene/EOG091G03JF/ALICUT_EOG091G03JF.clustalo.fasta contains fewer than 5 sequences - skipped" > ../../per_gene/EOG091G03JF/infer_single_ML.stdout.txt
		touch raxml.skipped
	fi
        touch ../../per_gene/EOG091G03JF/EOG091G03JF.raxml.done
        [0m
[Sun Jul  5 22:45:25 2020]
Finished job 219.
1376 of 3292 steps (42%) done

[Sun Jul  5 22:45:25 2020]
rule get_seqs:
    input: /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ingroup.txt, /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/outgroup.txt
    output: per_gene/EOG091G0KVW/EOG091G0KVW.ingroup.fasta
    log: per_gene/EOG091G0KVW/get_seqs.stdout.txt, per_gene/EOG091G0KVW/get_seqs.stderr.txt
    jobid: 2744
    wildcards: BUSCO=EOG091G0KVW
    threads: 2


	basedir=$(pwd)
        cd per_gene/EOG091G0KVW
        
        bash $basedir/../scripts/fetch_seqs.sh EOG091G0KVW /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ingroup.txt /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/outgroup.txt 1> ../../per_gene/EOG091G0KVW/get_seqs.stdout.txt 2> ../../per_gene/EOG091G0KVW/get_seqs.stderr.txt
	mv EOG091G0KVW.fasta $basedir/per_gene/EOG091G0KVW/EOG091G0KVW.ingroup.fasta
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/72476f9d9a5bd0627b4d721143a21354.simg
[Sun Jul  5 22:45:39 2020]
Finished job 2744.
1377 of 3292 steps (42%) done
[Sun Jul  5 22:45:39 2020]
Finished job 754.
1378 of 3292 steps (42%) done

[Sun Jul  5 22:45:39 2020]
rule get_outgroups:
    input: per_gene/EOG091G0KVW/EOG091G0KVW.ingroup.fasta
    output: per_gene/EOG091G0KVW/EOG091G0KVW.orthodb.fasta, per_gene/EOG091G0KVW/EOG091G0KVW.outgroup.fasta
    log: per_gene/EOG091G0KVW/get_outgroups.stdout.txt, per_gene/EOG091G0KVW/get_outgroups.stderr.txt
    jobid: 2745
    wildcards: BUSCO=EOG091G0KVW


        #download fastas from Orhtodb for BUSCO id
        for i in {1..5}
        do
             wget "http://www.orthodb.org/fasta?query=EOG091G0KVW&level=33208" -O per_gene/EOG091G0KVW/EOG091G0KVW.orthodb.fasta 1> per_gene/EOG091G0KVW/get_outgroups.stdout.txt 2> per_gene/EOG091G0KVW/get_outgroups.stderr.txt && break || echo -e "try again ($i)" && sleep 15
        done

	#This is quick an dirty for now and just takes the first protein if there is more than one for an outgroup taxon
        bash ../scripts/download_outgroups.sh taxids.txt per_gene/EOG091G0KVW/EOG091G0KVW.orthodb.fasta > per_gene/EOG091G0KVW/EOG091G0KVW.outgroup.fasta
        

[Sun Jul  5 22:45:39 2020]
rule infer_single_ML:
    input: per_gene/EOG091G0QGZ/EOG091G0QGZ.best_model, per_gene/EOG091G0QGZ/ALICUT_EOG091G0QGZ.clustalo.fasta
    output: per_gene/EOG091G0QGZ/EOG091G0QGZ.raxml.done
    log: per_gene/EOG091G0QGZ/infer_single_ML.stdout.txt, per_gene/EOG091G0QGZ/infer_single_ML.stderr.txt
    jobid: 171
    wildcards: BUSCO=EOG091G0QGZ
    threads: 2


        cd per_gene/EOG091G0QGZ
	count=$(cat ../../per_gene/EOG091G0QGZ/ALICUT_EOG091G0QGZ.clustalo.fasta | grep ">" | wc -l)
	if [ "$count" -gt 5 ]
        then
		RAxMLmodel=$(cat ../../per_gene/EOG091G0QGZ/EOG091G0QGZ.best_model | grep "Best" | cut -d ":" -f 2 | tr -d '[:space:]')
                if [ "$(ls -1 | grep "^RAxML" | wc -l)" -ne 0 ]
		then
			rm RAxML*
		fi
        	raxml -f a -T 2 -m PROTGAMMA$RAxMLmodel         	-p 12345 -x 12345 -# 100         	-s ../../per_gene/EOG091G0QGZ/ALICUT_EOG091G0QGZ.clustalo.fasta -n EOG091G0QGZ.clustalo.aln.ALICUT.$RAxMLmodel 		1> ../../per_gene/EOG091G0QGZ/infer_single_ML.stdout.txt 2> ../../per_gene/EOG091G0QGZ/infer_single_ML.stderr.txt
	else
		echo "fasta file per_gene/EOG091G0QGZ/ALICUT_EOG091G0QGZ.clustalo.fasta contains fewer than 5 sequences - skipped" > ../../per_gene/EOG091G0QGZ/infer_single_ML.stdout.txt
		touch raxml.skipped
	fi
        touch ../../per_gene/EOG091G0QGZ/EOG091G0QGZ.raxml.done
        
[33mJob counts:
	count	jobs
	1	infer_single_ML
	1[0m
[33m
        cd per_gene/EOG091G0QGZ
	count=$(cat ../../per_gene/EOG091G0QGZ/ALICUT_EOG091G0QGZ.clustalo.fasta | grep ">" | wc -l)
	if [ "$count" -gt 5 ]
        then
		RAxMLmodel=$(cat ../../per_gene/EOG091G0QGZ/EOG091G0QGZ.best_model | grep "Best" | cut -d ":" -f 2 | tr -d '[:space:]')
                if [ "$(ls -1 | grep "^RAxML" | wc -l)" -ne 0 ]
		then
			rm RAxML*
		fi
        	raxml -f a -T 2 -m PROTGAMMA$RAxMLmodel         	-p 12345 -x 12345 -# 100         	-s ../../per_gene/EOG091G0QGZ/ALICUT_EOG091G0QGZ.clustalo.fasta -n EOG091G0QGZ.clustalo.aln.ALICUT.$RAxMLmodel 		1> ../../per_gene/EOG091G0QGZ/infer_single_ML.stdout.txt 2> ../../per_gene/EOG091G0QGZ/infer_single_ML.stderr.txt
	else
		echo "fasta file per_gene/EOG091G0QGZ/ALICUT_EOG091G0QGZ.clustalo.fasta contains fewer than 5 sequences - skipped" > ../../per_gene/EOG091G0QGZ/infer_single_ML.stdout.txt
		touch raxml.skipped
	fi
        touch ../../per_gene/EOG091G0QGZ/EOG091G0QGZ.raxml.done
        [0m
[Sun Jul  5 22:45:41 2020]
Finished job 2745.
1379 of 3292 steps (42%) done

[Sun Jul  5 22:45:41 2020]
rule join_groups:
    input: per_gene/EOG091G0KVW/EOG091G0KVW.ingroup.fasta, per_gene/EOG091G0KVW/EOG091G0KVW.outgroup.fasta
    output: per_gene/EOG091G0KVW/EOG091G0KVW.fasta
    jobid: 2196
    wildcards: BUSCO=EOG091G0KVW


        cat per_gene/EOG091G0KVW/EOG091G0KVW.ingroup.fasta per_gene/EOG091G0KVW/EOG091G0KVW.outgroup.fasta > per_gene/EOG091G0KVW/EOG091G0KVW.fasta
        
[Sun Jul  5 22:45:41 2020]
Finished job 2196.
1380 of 3292 steps (42%) done

[Sun Jul  5 22:45:41 2020]
rule MSA:
    input: per_gene/EOG091G0KVW/EOG091G0KVW.fasta
    output: per_gene/EOG091G0KVW/EOG091G0KVW.clustalo.fasta
    log: per_gene/EOG091G0KVW/MSA.stdout.txt, per_gene/EOG091G0KVW/MSA.stderr.txt
    jobid: 1512
    wildcards: BUSCO=EOG091G0KVW
    threads: 2


        clustalo -i per_gene/EOG091G0KVW/EOG091G0KVW.fasta -o per_gene/EOG091G0KVW/EOG091G0KVW.clustalo.fasta --threads=2 1> per_gene/EOG091G0KVW/MSA.stdout.txt 2> per_gene/EOG091G0KVW/MSA.stderr.txt
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/d68c9691725a7401923680874285c430.simg
[Sun Jul  5 22:45:41 2020]
Finished job 1512.
1381 of 3292 steps (42%) done

[Sun Jul  5 22:45:41 2020]
rule score_and_cut:
    input: per_gene/EOG091G0KVW/EOG091G0KVW.clustalo.fasta
    output: per_gene/EOG091G0KVW/ALICUT_EOG091G0KVW.clustalo.fasta
    jobid: 689
    wildcards: BUSCO=EOG091G0KVW
    threads: 2


        cd per_gene/EOG091G0KVW
        Aliscore.pl -N -r 200000000000000000 -i ../../per_gene/EOG091G0KVW/EOG091G0KVW.clustalo.fasta &> aliscore.log
        ALICUT.pl -s &> alicut.log
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/63c88c27a0fa300f57066b0ef65fefcb.simg
[Sun Jul  5 22:45:52 2020]
Finished job 689.
1382 of 3292 steps (42%) done

[Sun Jul  5 22:45:52 2020]
rule remove_empty:
    input: per_gene/EOG091G0KVW/ALICUT_EOG091G0KVW.clustalo.fasta
    output: per_gene/EOG091G0KVW/empty_check.done
    jobid: 1511
    wildcards: BUSCO=EOG091G0KVW


         if [ "$(cat per_gene/EOG091G0KVW/ALICUT_EOG091G0KVW.clustalo.fasta | grep -v ">" | sed 's/-//g' | grep "^$" | wc -l)" -gt 0 ]
         then
              cp per_gene/EOG091G0KVW/ALICUT_EOG091G0KVW.clustalo.fasta per_gene/EOG091G0KVW/ALICUT_EOG091G0KVW.clustalo.fasta.backup
              bash ../scripts/remove_empty.sh per_gene/EOG091G0KVW/ALICUT_EOG091G0KVW.clustalo.fasta.backup > per_gene/EOG091G0KVW/ALICUT_EOG091G0KVW.clustalo.fasta
         fi
         touch per_gene/EOG091G0KVW/empty_check.done
         
[Sun Jul  5 22:45:52 2020]
Finished job 1511.
1383 of 3292 steps (42%) done

[Sun Jul  5 22:45:52 2020]
rule find_best_model:
    input: per_gene/EOG091G0KVW/ALICUT_EOG091G0KVW.clustalo.fasta, per_gene/EOG091G0KVW/empty_check.done
    output: per_gene/EOG091G0KVW/EOG091G0KVW.best_model
    log: per_gene/EOG091G0KVW/find_best_model.stderr.txt
    jobid: 688
    wildcards: BUSCO=EOG091G0KVW
    threads: 2


        cd per_gene/EOG091G0KVW
        if [ ! -d find_best_model ]
        then
            mkdir find_best_model
        fi
        cd find_best_model
        ln -s ../../../per_gene/EOG091G0KVW/ALICUT_EOG091G0KVW.clustalo.fasta EOG091G0KVW.fasta
        ProteinModelSelection.pl EOG091G0KVW.fasta 1> ../../../per_gene/EOG091G0KVW/EOG091G0KVW.best_model 2> ../../../per_gene/EOG091G0KVW/find_best_model.stderr.txt
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/c0c09ee657b1e27f2c5687e0e9aa8d70.simg
[Sun Jul  5 22:46:28 2020]
Finished job 264.
1384 of 3292 steps (42%) done

[Sun Jul  5 22:46:28 2020]
rule get_seqs:
    input: /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ingroup.txt, /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/outgroup.txt
    output: per_gene/EOG091G114S/EOG091G114S.ingroup.fasta
    log: per_gene/EOG091G114S/get_seqs.stdout.txt, per_gene/EOG091G114S/get_seqs.stderr.txt
    jobid: 2918
    wildcards: BUSCO=EOG091G114S
    threads: 2


	basedir=$(pwd)
        cd per_gene/EOG091G114S
        
        bash $basedir/../scripts/fetch_seqs.sh EOG091G114S /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ingroup.txt /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/outgroup.txt 1> ../../per_gene/EOG091G114S/get_seqs.stdout.txt 2> ../../per_gene/EOG091G114S/get_seqs.stderr.txt
	mv EOG091G114S.fasta $basedir/per_gene/EOG091G114S/EOG091G114S.ingroup.fasta
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/72476f9d9a5bd0627b4d721143a21354.simg
[Sun Jul  5 22:46:33 2020]
Finished job 688.
1385 of 3292 steps (42%) done

[Sun Jul  5 22:46:33 2020]
rule infer_single_ML:
    input: per_gene/EOG091G0KVW/EOG091G0KVW.best_model, per_gene/EOG091G0KVW/ALICUT_EOG091G0KVW.clustalo.fasta
    output: per_gene/EOG091G0KVW/EOG091G0KVW.raxml.done
    log: per_gene/EOG091G0KVW/infer_single_ML.stdout.txt, per_gene/EOG091G0KVW/infer_single_ML.stderr.txt
    jobid: 138
    wildcards: BUSCO=EOG091G0KVW
    threads: 2


        cd per_gene/EOG091G0KVW
	count=$(cat ../../per_gene/EOG091G0KVW/ALICUT_EOG091G0KVW.clustalo.fasta | grep ">" | wc -l)
	if [ "$count" -gt 5 ]
        then
		RAxMLmodel=$(cat ../../per_gene/EOG091G0KVW/EOG091G0KVW.best_model | grep "Best" | cut -d ":" -f 2 | tr -d '[:space:]')
                if [ "$(ls -1 | grep "^RAxML" | wc -l)" -ne 0 ]
		then
			rm RAxML*
		fi
        	raxml -f a -T 2 -m PROTGAMMA$RAxMLmodel         	-p 12345 -x 12345 -# 100         	-s ../../per_gene/EOG091G0KVW/ALICUT_EOG091G0KVW.clustalo.fasta -n EOG091G0KVW.clustalo.aln.ALICUT.$RAxMLmodel 		1> ../../per_gene/EOG091G0KVW/infer_single_ML.stdout.txt 2> ../../per_gene/EOG091G0KVW/infer_single_ML.stderr.txt
	else
		echo "fasta file per_gene/EOG091G0KVW/ALICUT_EOG091G0KVW.clustalo.fasta contains fewer than 5 sequences - skipped" > ../../per_gene/EOG091G0KVW/infer_single_ML.stdout.txt
		touch raxml.skipped
	fi
        touch ../../per_gene/EOG091G0KVW/EOG091G0KVW.raxml.done
        
[33mJob counts:
	count	jobs
	1	infer_single_ML
	1[0m
[33m
        cd per_gene/EOG091G0KVW
	count=$(cat ../../per_gene/EOG091G0KVW/ALICUT_EOG091G0KVW.clustalo.fasta | grep ">" | wc -l)
	if [ "$count" -gt 5 ]
        then
		RAxMLmodel=$(cat ../../per_gene/EOG091G0KVW/EOG091G0KVW.best_model | grep "Best" | cut -d ":" -f 2 | tr -d '[:space:]')
                if [ "$(ls -1 | grep "^RAxML" | wc -l)" -ne 0 ]
		then
			rm RAxML*
		fi
        	raxml -f a -T 2 -m PROTGAMMA$RAxMLmodel         	-p 12345 -x 12345 -# 100         	-s ../../per_gene/EOG091G0KVW/ALICUT_EOG091G0KVW.clustalo.fasta -n EOG091G0KVW.clustalo.aln.ALICUT.$RAxMLmodel 		1> ../../per_gene/EOG091G0KVW/infer_single_ML.stdout.txt 2> ../../per_gene/EOG091G0KVW/infer_single_ML.stderr.txt
	else
		echo "fasta file per_gene/EOG091G0KVW/ALICUT_EOG091G0KVW.clustalo.fasta contains fewer than 5 sequences - skipped" > ../../per_gene/EOG091G0KVW/infer_single_ML.stdout.txt
		touch raxml.skipped
	fi
        touch ../../per_gene/EOG091G0KVW/EOG091G0KVW.raxml.done
        [0m
[Sun Jul  5 22:46:39 2020]
Finished job 313.
1386 of 3292 steps (42%) done

[Sun Jul  5 22:46:39 2020]
rule get_seqs:
    input: /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ingroup.txt, /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/outgroup.txt
    output: per_gene/EOG091G02NH/EOG091G02NH.ingroup.fasta
    log: per_gene/EOG091G02NH/get_seqs.stdout.txt, per_gene/EOG091G02NH/get_seqs.stderr.txt
    jobid: 3118
    wildcards: BUSCO=EOG091G02NH
    threads: 2


	basedir=$(pwd)
        cd per_gene/EOG091G02NH
        
        bash $basedir/../scripts/fetch_seqs.sh EOG091G02NH /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ingroup.txt /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/outgroup.txt 1> ../../per_gene/EOG091G02NH/get_seqs.stdout.txt 2> ../../per_gene/EOG091G02NH/get_seqs.stderr.txt
	mv EOG091G02NH.fasta $basedir/per_gene/EOG091G02NH/EOG091G02NH.ingroup.fasta
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/72476f9d9a5bd0627b4d721143a21354.simg
[Sun Jul  5 22:46:50 2020]
Finished job 2918.
1387 of 3292 steps (42%) done

[Sun Jul  5 22:46:50 2020]
rule get_outgroups:
    input: per_gene/EOG091G114S/EOG091G114S.ingroup.fasta
    output: per_gene/EOG091G114S/EOG091G114S.orthodb.fasta, per_gene/EOG091G114S/EOG091G114S.outgroup.fasta
    log: per_gene/EOG091G114S/get_outgroups.stdout.txt, per_gene/EOG091G114S/get_outgroups.stderr.txt
    jobid: 2919
    wildcards: BUSCO=EOG091G114S


        #download fastas from Orhtodb for BUSCO id
        for i in {1..5}
        do
             wget "http://www.orthodb.org/fasta?query=EOG091G114S&level=33208" -O per_gene/EOG091G114S/EOG091G114S.orthodb.fasta 1> per_gene/EOG091G114S/get_outgroups.stdout.txt 2> per_gene/EOG091G114S/get_outgroups.stderr.txt && break || echo -e "try again ($i)" && sleep 15
        done

	#This is quick an dirty for now and just takes the first protein if there is more than one for an outgroup taxon
        bash ../scripts/download_outgroups.sh taxids.txt per_gene/EOG091G114S/EOG091G114S.orthodb.fasta > per_gene/EOG091G114S/EOG091G114S.outgroup.fasta
        
[Sun Jul  5 22:46:51 2020]
Finished job 2919.
1388 of 3292 steps (42%) done

[Sun Jul  5 22:46:51 2020]
rule join_groups:
    input: per_gene/EOG091G114S/EOG091G114S.ingroup.fasta, per_gene/EOG091G114S/EOG091G114S.outgroup.fasta
    output: per_gene/EOG091G114S/EOG091G114S.fasta
    jobid: 2283
    wildcards: BUSCO=EOG091G114S


        cat per_gene/EOG091G114S/EOG091G114S.ingroup.fasta per_gene/EOG091G114S/EOG091G114S.outgroup.fasta > per_gene/EOG091G114S/EOG091G114S.fasta
        
[Sun Jul  5 22:46:51 2020]
Finished job 2283.
1389 of 3292 steps (42%) done

[Sun Jul  5 22:46:51 2020]
rule MSA:
    input: per_gene/EOG091G114S/EOG091G114S.fasta
    output: per_gene/EOG091G114S/EOG091G114S.clustalo.fasta
    log: per_gene/EOG091G114S/MSA.stdout.txt, per_gene/EOG091G114S/MSA.stderr.txt
    jobid: 1686
    wildcards: BUSCO=EOG091G114S
    threads: 2


        clustalo -i per_gene/EOG091G114S/EOG091G114S.fasta -o per_gene/EOG091G114S/EOG091G114S.clustalo.fasta --threads=2 1> per_gene/EOG091G114S/MSA.stdout.txt 2> per_gene/EOG091G114S/MSA.stderr.txt
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/d68c9691725a7401923680874285c430.simg
[Sun Jul  5 22:46:51 2020]
Finished job 1686.
1390 of 3292 steps (42%) done

[Sun Jul  5 22:46:51 2020]
rule score_and_cut:
    input: per_gene/EOG091G114S/EOG091G114S.clustalo.fasta
    output: per_gene/EOG091G114S/ALICUT_EOG091G114S.clustalo.fasta
    jobid: 863
    wildcards: BUSCO=EOG091G114S
    threads: 2


        cd per_gene/EOG091G114S
        Aliscore.pl -N -r 200000000000000000 -i ../../per_gene/EOG091G114S/EOG091G114S.clustalo.fasta &> aliscore.log
        ALICUT.pl -s &> alicut.log
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/63c88c27a0fa300f57066b0ef65fefcb.simg
[Sun Jul  5 22:46:56 2020]
Finished job 3118.
1391 of 3292 steps (42%) done

[Sun Jul  5 22:46:56 2020]
rule get_outgroups:
    input: per_gene/EOG091G02NH/EOG091G02NH.ingroup.fasta
    output: per_gene/EOG091G02NH/EOG091G02NH.orthodb.fasta, per_gene/EOG091G02NH/EOG091G02NH.outgroup.fasta
    log: per_gene/EOG091G02NH/get_outgroups.stdout.txt, per_gene/EOG091G02NH/get_outgroups.stderr.txt
    jobid: 3119
    wildcards: BUSCO=EOG091G02NH


        #download fastas from Orhtodb for BUSCO id
        for i in {1..5}
        do
             wget "http://www.orthodb.org/fasta?query=EOG091G02NH&level=33208" -O per_gene/EOG091G02NH/EOG091G02NH.orthodb.fasta 1> per_gene/EOG091G02NH/get_outgroups.stdout.txt 2> per_gene/EOG091G02NH/get_outgroups.stderr.txt && break || echo -e "try again ($i)" && sleep 15
        done

	#This is quick an dirty for now and just takes the first protein if there is more than one for an outgroup taxon
        bash ../scripts/download_outgroups.sh taxids.txt per_gene/EOG091G02NH/EOG091G02NH.orthodb.fasta > per_gene/EOG091G02NH/EOG091G02NH.outgroup.fasta
        
[Sun Jul  5 22:46:57 2020]
Finished job 3119.
1392 of 3292 steps (42%) done

[Sun Jul  5 22:46:57 2020]
rule join_groups:
    input: per_gene/EOG091G02NH/EOG091G02NH.ingroup.fasta, per_gene/EOG091G02NH/EOG091G02NH.outgroup.fasta
    output: per_gene/EOG091G02NH/EOG091G02NH.fasta
    jobid: 2383
    wildcards: BUSCO=EOG091G02NH


        cat per_gene/EOG091G02NH/EOG091G02NH.ingroup.fasta per_gene/EOG091G02NH/EOG091G02NH.outgroup.fasta > per_gene/EOG091G02NH/EOG091G02NH.fasta
        
[Sun Jul  5 22:46:57 2020]
Finished job 2383.
1393 of 3292 steps (42%) done

[Sun Jul  5 22:46:57 2020]
rule MSA:
    input: per_gene/EOG091G02NH/EOG091G02NH.fasta
    output: per_gene/EOG091G02NH/EOG091G02NH.clustalo.fasta
    log: per_gene/EOG091G02NH/MSA.stdout.txt, per_gene/EOG091G02NH/MSA.stderr.txt
    jobid: 1886
    wildcards: BUSCO=EOG091G02NH
    threads: 2


        clustalo -i per_gene/EOG091G02NH/EOG091G02NH.fasta -o per_gene/EOG091G02NH/EOG091G02NH.clustalo.fasta --threads=2 1> per_gene/EOG091G02NH/MSA.stdout.txt 2> per_gene/EOG091G02NH/MSA.stderr.txt
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/d68c9691725a7401923680874285c430.simg
[Sun Jul  5 22:47:02 2020]
Finished job 863.
1394 of 3292 steps (42%) done

[Sun Jul  5 22:47:02 2020]
rule remove_empty:
    input: per_gene/EOG091G114S/ALICUT_EOG091G114S.clustalo.fasta
    output: per_gene/EOG091G114S/empty_check.done
    jobid: 1685
    wildcards: BUSCO=EOG091G114S


         if [ "$(cat per_gene/EOG091G114S/ALICUT_EOG091G114S.clustalo.fasta | grep -v ">" | sed 's/-//g' | grep "^$" | wc -l)" -gt 0 ]
         then
              cp per_gene/EOG091G114S/ALICUT_EOG091G114S.clustalo.fasta per_gene/EOG091G114S/ALICUT_EOG091G114S.clustalo.fasta.backup
              bash ../scripts/remove_empty.sh per_gene/EOG091G114S/ALICUT_EOG091G114S.clustalo.fasta.backup > per_gene/EOG091G114S/ALICUT_EOG091G114S.clustalo.fasta
         fi
         touch per_gene/EOG091G114S/empty_check.done
         
[Sun Jul  5 22:47:02 2020]
Finished job 1685.
1395 of 3292 steps (42%) done

[Sun Jul  5 22:47:02 2020]
rule find_best_model:
    input: per_gene/EOG091G114S/ALICUT_EOG091G114S.clustalo.fasta, per_gene/EOG091G114S/empty_check.done
    output: per_gene/EOG091G114S/EOG091G114S.best_model
    log: per_gene/EOG091G114S/find_best_model.stderr.txt
    jobid: 862
    wildcards: BUSCO=EOG091G114S
    threads: 2


        cd per_gene/EOG091G114S
        if [ ! -d find_best_model ]
        then
            mkdir find_best_model
        fi
        cd find_best_model
        ln -s ../../../per_gene/EOG091G114S/ALICUT_EOG091G114S.clustalo.fasta EOG091G114S.fasta
        ProteinModelSelection.pl EOG091G114S.fasta 1> ../../../per_gene/EOG091G114S/EOG091G114S.best_model 2> ../../../per_gene/EOG091G114S/find_best_model.stderr.txt
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/c0c09ee657b1e27f2c5687e0e9aa8d70.simg
[Sun Jul  5 22:47:02 2020]
Finished job 1886.
1396 of 3292 steps (42%) done

[Sun Jul  5 22:47:02 2020]
rule score_and_cut:
    input: per_gene/EOG091G02NH/EOG091G02NH.clustalo.fasta
    output: per_gene/EOG091G02NH/ALICUT_EOG091G02NH.clustalo.fasta
    jobid: 1063
    wildcards: BUSCO=EOG091G02NH
    threads: 2


        cd per_gene/EOG091G02NH
        Aliscore.pl -N -r 200000000000000000 -i ../../per_gene/EOG091G02NH/EOG091G02NH.clustalo.fasta &> aliscore.log
        ALICUT.pl -s &> alicut.log
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/63c88c27a0fa300f57066b0ef65fefcb.simg
[Sun Jul  5 22:47:13 2020]
Finished job 1063.
1397 of 3292 steps (42%) done

[Sun Jul  5 22:47:13 2020]
rule remove_empty:
    input: per_gene/EOG091G02NH/ALICUT_EOG091G02NH.clustalo.fasta
    output: per_gene/EOG091G02NH/empty_check.done
    jobid: 1885
    wildcards: BUSCO=EOG091G02NH


         if [ "$(cat per_gene/EOG091G02NH/ALICUT_EOG091G02NH.clustalo.fasta | grep -v ">" | sed 's/-//g' | grep "^$" | wc -l)" -gt 0 ]
         then
              cp per_gene/EOG091G02NH/ALICUT_EOG091G02NH.clustalo.fasta per_gene/EOG091G02NH/ALICUT_EOG091G02NH.clustalo.fasta.backup
              bash ../scripts/remove_empty.sh per_gene/EOG091G02NH/ALICUT_EOG091G02NH.clustalo.fasta.backup > per_gene/EOG091G02NH/ALICUT_EOG091G02NH.clustalo.fasta
         fi
         touch per_gene/EOG091G02NH/empty_check.done
         
[Sun Jul  5 22:47:14 2020]
Finished job 1885.
1398 of 3292 steps (42%) done

[Sun Jul  5 22:47:14 2020]
rule find_best_model:
    input: per_gene/EOG091G02NH/ALICUT_EOG091G02NH.clustalo.fasta, per_gene/EOG091G02NH/empty_check.done
    output: per_gene/EOG091G02NH/EOG091G02NH.best_model
    log: per_gene/EOG091G02NH/find_best_model.stderr.txt
    jobid: 1062
    wildcards: BUSCO=EOG091G02NH
    threads: 2


        cd per_gene/EOG091G02NH
        if [ ! -d find_best_model ]
        then
            mkdir find_best_model
        fi
        cd find_best_model
        ln -s ../../../per_gene/EOG091G02NH/ALICUT_EOG091G02NH.clustalo.fasta EOG091G02NH.fasta
        ProteinModelSelection.pl EOG091G02NH.fasta 1> ../../../per_gene/EOG091G02NH/EOG091G02NH.best_model 2> ../../../per_gene/EOG091G02NH/find_best_model.stderr.txt
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/c0c09ee657b1e27f2c5687e0e9aa8d70.simg
[Sun Jul  5 22:47:27 2020]
Finished job 862.
1399 of 3292 steps (42%) done

[Sun Jul  5 22:47:27 2020]
rule infer_single_ML:
    input: per_gene/EOG091G114S/EOG091G114S.best_model, per_gene/EOG091G114S/ALICUT_EOG091G114S.clustalo.fasta
    output: per_gene/EOG091G114S/EOG091G114S.raxml.done
    log: per_gene/EOG091G114S/infer_single_ML.stdout.txt, per_gene/EOG091G114S/infer_single_ML.stderr.txt
    jobid: 225
    wildcards: BUSCO=EOG091G114S
    threads: 2


        cd per_gene/EOG091G114S
	count=$(cat ../../per_gene/EOG091G114S/ALICUT_EOG091G114S.clustalo.fasta | grep ">" | wc -l)
	if [ "$count" -gt 5 ]
        then
		RAxMLmodel=$(cat ../../per_gene/EOG091G114S/EOG091G114S.best_model | grep "Best" | cut -d ":" -f 2 | tr -d '[:space:]')
                if [ "$(ls -1 | grep "^RAxML" | wc -l)" -ne 0 ]
		then
			rm RAxML*
		fi
        	raxml -f a -T 2 -m PROTGAMMA$RAxMLmodel         	-p 12345 -x 12345 -# 100         	-s ../../per_gene/EOG091G114S/ALICUT_EOG091G114S.clustalo.fasta -n EOG091G114S.clustalo.aln.ALICUT.$RAxMLmodel 		1> ../../per_gene/EOG091G114S/infer_single_ML.stdout.txt 2> ../../per_gene/EOG091G114S/infer_single_ML.stderr.txt
	else
		echo "fasta file per_gene/EOG091G114S/ALICUT_EOG091G114S.clustalo.fasta contains fewer than 5 sequences - skipped" > ../../per_gene/EOG091G114S/infer_single_ML.stdout.txt
		touch raxml.skipped
	fi
        touch ../../per_gene/EOG091G114S/EOG091G114S.raxml.done
        
[33mJob counts:
	count	jobs
	1	infer_single_ML
	1[0m
[33m
        cd per_gene/EOG091G114S
	count=$(cat ../../per_gene/EOG091G114S/ALICUT_EOG091G114S.clustalo.fasta | grep ">" | wc -l)
	if [ "$count" -gt 5 ]
        then
		RAxMLmodel=$(cat ../../per_gene/EOG091G114S/EOG091G114S.best_model | grep "Best" | cut -d ":" -f 2 | tr -d '[:space:]')
                if [ "$(ls -1 | grep "^RAxML" | wc -l)" -ne 0 ]
		then
			rm RAxML*
		fi
        	raxml -f a -T 2 -m PROTGAMMA$RAxMLmodel         	-p 12345 -x 12345 -# 100         	-s ../../per_gene/EOG091G114S/ALICUT_EOG091G114S.clustalo.fasta -n EOG091G114S.clustalo.aln.ALICUT.$RAxMLmodel 		1> ../../per_gene/EOG091G114S/infer_single_ML.stdout.txt 2> ../../per_gene/EOG091G114S/infer_single_ML.stderr.txt
	else
		echo "fasta file per_gene/EOG091G114S/ALICUT_EOG091G114S.clustalo.fasta contains fewer than 5 sequences - skipped" > ../../per_gene/EOG091G114S/infer_single_ML.stdout.txt
		touch raxml.skipped
	fi
        touch ../../per_gene/EOG091G114S/EOG091G114S.raxml.done
        [0m
[Sun Jul  5 22:47:54 2020]
Finished job 1062.
1400 of 3292 steps (43%) done

[Sun Jul  5 22:47:54 2020]
rule infer_single_ML:
    input: per_gene/EOG091G02NH/EOG091G02NH.best_model, per_gene/EOG091G02NH/ALICUT_EOG091G02NH.clustalo.fasta
    output: per_gene/EOG091G02NH/EOG091G02NH.raxml.done
    log: per_gene/EOG091G02NH/infer_single_ML.stdout.txt, per_gene/EOG091G02NH/infer_single_ML.stderr.txt
    jobid: 325
    wildcards: BUSCO=EOG091G02NH
    threads: 2


        cd per_gene/EOG091G02NH
	count=$(cat ../../per_gene/EOG091G02NH/ALICUT_EOG091G02NH.clustalo.fasta | grep ">" | wc -l)
	if [ "$count" -gt 5 ]
        then
		RAxMLmodel=$(cat ../../per_gene/EOG091G02NH/EOG091G02NH.best_model | grep "Best" | cut -d ":" -f 2 | tr -d '[:space:]')
                if [ "$(ls -1 | grep "^RAxML" | wc -l)" -ne 0 ]
		then
			rm RAxML*
		fi
        	raxml -f a -T 2 -m PROTGAMMA$RAxMLmodel         	-p 12345 -x 12345 -# 100         	-s ../../per_gene/EOG091G02NH/ALICUT_EOG091G02NH.clustalo.fasta -n EOG091G02NH.clustalo.aln.ALICUT.$RAxMLmodel 		1> ../../per_gene/EOG091G02NH/infer_single_ML.stdout.txt 2> ../../per_gene/EOG091G02NH/infer_single_ML.stderr.txt
	else
		echo "fasta file per_gene/EOG091G02NH/ALICUT_EOG091G02NH.clustalo.fasta contains fewer than 5 sequences - skipped" > ../../per_gene/EOG091G02NH/infer_single_ML.stdout.txt
		touch raxml.skipped
	fi
        touch ../../per_gene/EOG091G02NH/EOG091G02NH.raxml.done
        
[Sun Jul  5 22:48:18 2020]
Finished job 289.
1401 of 3292 steps (43%) done

[Sun Jul  5 22:48:18 2020]
rule get_seqs:
    input: /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ingroup.txt, /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/outgroup.txt
    output: per_gene/EOG091G0SRZ/EOG091G0SRZ.ingroup.fasta
    log: per_gene/EOG091G0SRZ/get_seqs.stdout.txt, per_gene/EOG091G0SRZ/get_seqs.stderr.txt
    jobid: 2846
    wildcards: BUSCO=EOG091G0SRZ
    threads: 2


	basedir=$(pwd)
        cd per_gene/EOG091G0SRZ
        
        bash $basedir/../scripts/fetch_seqs.sh EOG091G0SRZ /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ingroup.txt /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/outgroup.txt 1> ../../per_gene/EOG091G0SRZ/get_seqs.stdout.txt 2> ../../per_gene/EOG091G0SRZ/get_seqs.stderr.txt
	mv EOG091G0SRZ.fasta $basedir/per_gene/EOG091G0SRZ/EOG091G0SRZ.ingroup.fasta
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/72476f9d9a5bd0627b4d721143a21354.simg
[33mJob counts:
	count	jobs
	1	infer_single_ML
	1[0m
[33m
        cd per_gene/EOG091G02NH
	count=$(cat ../../per_gene/EOG091G02NH/ALICUT_EOG091G02NH.clustalo.fasta | grep ">" | wc -l)
	if [ "$count" -gt 5 ]
        then
		RAxMLmodel=$(cat ../../per_gene/EOG091G02NH/EOG091G02NH.best_model | grep "Best" | cut -d ":" -f 2 | tr -d '[:space:]')
                if [ "$(ls -1 | grep "^RAxML" | wc -l)" -ne 0 ]
		then
			rm RAxML*
		fi
        	raxml -f a -T 2 -m PROTGAMMA$RAxMLmodel         	-p 12345 -x 12345 -# 100         	-s ../../per_gene/EOG091G02NH/ALICUT_EOG091G02NH.clustalo.fasta -n EOG091G02NH.clustalo.aln.ALICUT.$RAxMLmodel 		1> ../../per_gene/EOG091G02NH/infer_single_ML.stdout.txt 2> ../../per_gene/EOG091G02NH/infer_single_ML.stderr.txt
	else
		echo "fasta file per_gene/EOG091G02NH/ALICUT_EOG091G02NH.clustalo.fasta contains fewer than 5 sequences - skipped" > ../../per_gene/EOG091G02NH/infer_single_ML.stdout.txt
		touch raxml.skipped
	fi
        touch ../../per_gene/EOG091G02NH/EOG091G02NH.raxml.done
        [0m
[Sun Jul  5 22:48:36 2020]
Finished job 2846.
1402 of 3292 steps (43%) done

[Sun Jul  5 22:48:36 2020]
rule get_outgroups:
    input: per_gene/EOG091G0SRZ/EOG091G0SRZ.ingroup.fasta
    output: per_gene/EOG091G0SRZ/EOG091G0SRZ.orthodb.fasta, per_gene/EOG091G0SRZ/EOG091G0SRZ.outgroup.fasta
    log: per_gene/EOG091G0SRZ/get_outgroups.stdout.txt, per_gene/EOG091G0SRZ/get_outgroups.stderr.txt
    jobid: 2847
    wildcards: BUSCO=EOG091G0SRZ


        #download fastas from Orhtodb for BUSCO id
        for i in {1..5}
        do
             wget "http://www.orthodb.org/fasta?query=EOG091G0SRZ&level=33208" -O per_gene/EOG091G0SRZ/EOG091G0SRZ.orthodb.fasta 1> per_gene/EOG091G0SRZ/get_outgroups.stdout.txt 2> per_gene/EOG091G0SRZ/get_outgroups.stderr.txt && break || echo -e "try again ($i)" && sleep 15
        done

	#This is quick an dirty for now and just takes the first protein if there is more than one for an outgroup taxon
        bash ../scripts/download_outgroups.sh taxids.txt per_gene/EOG091G0SRZ/EOG091G0SRZ.orthodb.fasta > per_gene/EOG091G0SRZ/EOG091G0SRZ.outgroup.fasta
        
[Sun Jul  5 22:48:36 2020]
Finished job 44.
1403 of 3292 steps (43%) done

[Sun Jul  5 22:48:36 2020]
rule get_seqs:
    input: /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ingroup.txt, /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/outgroup.txt
    output: per_gene/EOG091G0CF7/EOG091G0CF7.ingroup.fasta
    log: per_gene/EOG091G0CF7/get_seqs.stdout.txt, per_gene/EOG091G0CF7/get_seqs.stderr.txt
    jobid: 3084
    wildcards: BUSCO=EOG091G0CF7
    threads: 2


	basedir=$(pwd)
        cd per_gene/EOG091G0CF7
        
        bash $basedir/../scripts/fetch_seqs.sh EOG091G0CF7 /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ingroup.txt /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/outgroup.txt 1> ../../per_gene/EOG091G0CF7/get_seqs.stdout.txt 2> ../../per_gene/EOG091G0CF7/get_seqs.stderr.txt
	mv EOG091G0CF7.fasta $basedir/per_gene/EOG091G0CF7/EOG091G0CF7.ingroup.fasta
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/72476f9d9a5bd0627b4d721143a21354.simg
[Sun Jul  5 22:48:37 2020]
Finished job 2847.
1404 of 3292 steps (43%) done

[Sun Jul  5 22:48:37 2020]
rule join_groups:
    input: per_gene/EOG091G0SRZ/EOG091G0SRZ.ingroup.fasta, per_gene/EOG091G0SRZ/EOG091G0SRZ.outgroup.fasta
    output: per_gene/EOG091G0SRZ/EOG091G0SRZ.fasta
    jobid: 2247
    wildcards: BUSCO=EOG091G0SRZ


        cat per_gene/EOG091G0SRZ/EOG091G0SRZ.ingroup.fasta per_gene/EOG091G0SRZ/EOG091G0SRZ.outgroup.fasta > per_gene/EOG091G0SRZ/EOG091G0SRZ.fasta
        
[Sun Jul  5 22:48:37 2020]
Finished job 2247.
1405 of 3292 steps (43%) done

[Sun Jul  5 22:48:37 2020]
rule MSA:
    input: per_gene/EOG091G0SRZ/EOG091G0SRZ.fasta
    output: per_gene/EOG091G0SRZ/EOG091G0SRZ.clustalo.fasta
    log: per_gene/EOG091G0SRZ/MSA.stdout.txt, per_gene/EOG091G0SRZ/MSA.stderr.txt
    jobid: 1614
    wildcards: BUSCO=EOG091G0SRZ
    threads: 2


        clustalo -i per_gene/EOG091G0SRZ/EOG091G0SRZ.fasta -o per_gene/EOG091G0SRZ/EOG091G0SRZ.clustalo.fasta --threads=2 1> per_gene/EOG091G0SRZ/MSA.stdout.txt 2> per_gene/EOG091G0SRZ/MSA.stderr.txt
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/d68c9691725a7401923680874285c430.simg
[Sun Jul  5 22:48:38 2020]
Finished job 1614.
1406 of 3292 steps (43%) done

[Sun Jul  5 22:48:38 2020]
rule score_and_cut:
    input: per_gene/EOG091G0SRZ/EOG091G0SRZ.clustalo.fasta
    output: per_gene/EOG091G0SRZ/ALICUT_EOG091G0SRZ.clustalo.fasta
    jobid: 791
    wildcards: BUSCO=EOG091G0SRZ
    threads: 2


        cd per_gene/EOG091G0SRZ
        Aliscore.pl -N -r 200000000000000000 -i ../../per_gene/EOG091G0SRZ/EOG091G0SRZ.clustalo.fasta &> aliscore.log
        ALICUT.pl -s &> alicut.log
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/63c88c27a0fa300f57066b0ef65fefcb.simg
[Sun Jul  5 22:48:48 2020]
Finished job 791.
1407 of 3292 steps (43%) done

[Sun Jul  5 22:48:48 2020]
rule remove_empty:
    input: per_gene/EOG091G0SRZ/ALICUT_EOG091G0SRZ.clustalo.fasta
    output: per_gene/EOG091G0SRZ/empty_check.done
    jobid: 1613
    wildcards: BUSCO=EOG091G0SRZ


         if [ "$(cat per_gene/EOG091G0SRZ/ALICUT_EOG091G0SRZ.clustalo.fasta | grep -v ">" | sed 's/-//g' | grep "^$" | wc -l)" -gt 0 ]
         then
              cp per_gene/EOG091G0SRZ/ALICUT_EOG091G0SRZ.clustalo.fasta per_gene/EOG091G0SRZ/ALICUT_EOG091G0SRZ.clustalo.fasta.backup
              bash ../scripts/remove_empty.sh per_gene/EOG091G0SRZ/ALICUT_EOG091G0SRZ.clustalo.fasta.backup > per_gene/EOG091G0SRZ/ALICUT_EOG091G0SRZ.clustalo.fasta
         fi
         touch per_gene/EOG091G0SRZ/empty_check.done
         
[Sun Jul  5 22:48:48 2020]
Finished job 1613.
1408 of 3292 steps (43%) done

[Sun Jul  5 22:48:48 2020]
rule find_best_model:
    input: per_gene/EOG091G0SRZ/ALICUT_EOG091G0SRZ.clustalo.fasta, per_gene/EOG091G0SRZ/empty_check.done
    output: per_gene/EOG091G0SRZ/EOG091G0SRZ.best_model
    log: per_gene/EOG091G0SRZ/find_best_model.stderr.txt
    jobid: 790
    wildcards: BUSCO=EOG091G0SRZ
    threads: 2


        cd per_gene/EOG091G0SRZ
        if [ ! -d find_best_model ]
        then
            mkdir find_best_model
        fi
        cd find_best_model
        ln -s ../../../per_gene/EOG091G0SRZ/ALICUT_EOG091G0SRZ.clustalo.fasta EOG091G0SRZ.fasta
        ProteinModelSelection.pl EOG091G0SRZ.fasta 1> ../../../per_gene/EOG091G0SRZ/EOG091G0SRZ.best_model 2> ../../../per_gene/EOG091G0SRZ/find_best_model.stderr.txt
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/c0c09ee657b1e27f2c5687e0e9aa8d70.simg
[Sun Jul  5 22:48:51 2020]
Finished job 3084.
1409 of 3292 steps (43%) done

[Sun Jul  5 22:48:51 2020]
rule get_outgroups:
    input: per_gene/EOG091G0CF7/EOG091G0CF7.ingroup.fasta
    output: per_gene/EOG091G0CF7/EOG091G0CF7.orthodb.fasta, per_gene/EOG091G0CF7/EOG091G0CF7.outgroup.fasta
    log: per_gene/EOG091G0CF7/get_outgroups.stdout.txt, per_gene/EOG091G0CF7/get_outgroups.stderr.txt
    jobid: 3085
    wildcards: BUSCO=EOG091G0CF7


        #download fastas from Orhtodb for BUSCO id
        for i in {1..5}
        do
             wget "http://www.orthodb.org/fasta?query=EOG091G0CF7&level=33208" -O per_gene/EOG091G0CF7/EOG091G0CF7.orthodb.fasta 1> per_gene/EOG091G0CF7/get_outgroups.stdout.txt 2> per_gene/EOG091G0CF7/get_outgroups.stderr.txt && break || echo -e "try again ($i)" && sleep 15
        done

	#This is quick an dirty for now and just takes the first protein if there is more than one for an outgroup taxon
        bash ../scripts/download_outgroups.sh taxids.txt per_gene/EOG091G0CF7/EOG091G0CF7.orthodb.fasta > per_gene/EOG091G0CF7/EOG091G0CF7.outgroup.fasta
        
[Sun Jul  5 22:48:52 2020]
Finished job 3085.
1410 of 3292 steps (43%) done

[Sun Jul  5 22:48:52 2020]
rule join_groups:
    input: per_gene/EOG091G0CF7/EOG091G0CF7.ingroup.fasta, per_gene/EOG091G0CF7/EOG091G0CF7.outgroup.fasta
    output: per_gene/EOG091G0CF7/EOG091G0CF7.fasta
    jobid: 2366
    wildcards: BUSCO=EOG091G0CF7


        cat per_gene/EOG091G0CF7/EOG091G0CF7.ingroup.fasta per_gene/EOG091G0CF7/EOG091G0CF7.outgroup.fasta > per_gene/EOG091G0CF7/EOG091G0CF7.fasta
        
[Sun Jul  5 22:48:52 2020]
Finished job 2366.
1411 of 3292 steps (43%) done

[Sun Jul  5 22:48:52 2020]
rule MSA:
    input: per_gene/EOG091G0CF7/EOG091G0CF7.fasta
    output: per_gene/EOG091G0CF7/EOG091G0CF7.clustalo.fasta
    log: per_gene/EOG091G0CF7/MSA.stdout.txt, per_gene/EOG091G0CF7/MSA.stderr.txt
    jobid: 1852
    wildcards: BUSCO=EOG091G0CF7
    threads: 2


        clustalo -i per_gene/EOG091G0CF7/EOG091G0CF7.fasta -o per_gene/EOG091G0CF7/EOG091G0CF7.clustalo.fasta --threads=2 1> per_gene/EOG091G0CF7/MSA.stdout.txt 2> per_gene/EOG091G0CF7/MSA.stderr.txt
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/d68c9691725a7401923680874285c430.simg
[Sun Jul  5 22:48:53 2020]
Finished job 1852.
1412 of 3292 steps (43%) done

[Sun Jul  5 22:48:53 2020]
rule score_and_cut:
    input: per_gene/EOG091G0CF7/EOG091G0CF7.clustalo.fasta
    output: per_gene/EOG091G0CF7/ALICUT_EOG091G0CF7.clustalo.fasta
    jobid: 1029
    wildcards: BUSCO=EOG091G0CF7
    threads: 2


        cd per_gene/EOG091G0CF7
        Aliscore.pl -N -r 200000000000000000 -i ../../per_gene/EOG091G0CF7/EOG091G0CF7.clustalo.fasta &> aliscore.log
        ALICUT.pl -s &> alicut.log
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/63c88c27a0fa300f57066b0ef65fefcb.simg
[Sun Jul  5 22:49:03 2020]
Finished job 1029.
1413 of 3292 steps (43%) done

[Sun Jul  5 22:49:03 2020]
rule remove_empty:
    input: per_gene/EOG091G0CF7/ALICUT_EOG091G0CF7.clustalo.fasta
    output: per_gene/EOG091G0CF7/empty_check.done
    jobid: 1851
    wildcards: BUSCO=EOG091G0CF7


         if [ "$(cat per_gene/EOG091G0CF7/ALICUT_EOG091G0CF7.clustalo.fasta | grep -v ">" | sed 's/-//g' | grep "^$" | wc -l)" -gt 0 ]
         then
              cp per_gene/EOG091G0CF7/ALICUT_EOG091G0CF7.clustalo.fasta per_gene/EOG091G0CF7/ALICUT_EOG091G0CF7.clustalo.fasta.backup
              bash ../scripts/remove_empty.sh per_gene/EOG091G0CF7/ALICUT_EOG091G0CF7.clustalo.fasta.backup > per_gene/EOG091G0CF7/ALICUT_EOG091G0CF7.clustalo.fasta
         fi
         touch per_gene/EOG091G0CF7/empty_check.done
         
[Sun Jul  5 22:49:04 2020]
Finished job 1851.
1414 of 3292 steps (43%) done

[Sun Jul  5 22:49:04 2020]
rule find_best_model:
    input: per_gene/EOG091G0CF7/ALICUT_EOG091G0CF7.clustalo.fasta, per_gene/EOG091G0CF7/empty_check.done
    output: per_gene/EOG091G0CF7/EOG091G0CF7.best_model
    log: per_gene/EOG091G0CF7/find_best_model.stderr.txt
    jobid: 1028
    wildcards: BUSCO=EOG091G0CF7
    threads: 2


        cd per_gene/EOG091G0CF7
        if [ ! -d find_best_model ]
        then
            mkdir find_best_model
        fi
        cd find_best_model
        ln -s ../../../per_gene/EOG091G0CF7/ALICUT_EOG091G0CF7.clustalo.fasta EOG091G0CF7.fasta
        ProteinModelSelection.pl EOG091G0CF7.fasta 1> ../../../per_gene/EOG091G0CF7/EOG091G0CF7.best_model 2> ../../../per_gene/EOG091G0CF7/find_best_model.stderr.txt
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/c0c09ee657b1e27f2c5687e0e9aa8d70.simg
[Sun Jul  5 22:49:06 2020]
Finished job 267.
1415 of 3292 steps (43%) done

[Sun Jul  5 22:49:06 2020]
rule get_seqs:
    input: /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ingroup.txt, /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/outgroup.txt
    output: per_gene/EOG091G0IUT/EOG091G0IUT.ingroup.fasta
    log: per_gene/EOG091G0IUT/get_seqs.stdout.txt, per_gene/EOG091G0IUT/get_seqs.stderr.txt
    jobid: 3212
    wildcards: BUSCO=EOG091G0IUT
    threads: 2


	basedir=$(pwd)
        cd per_gene/EOG091G0IUT
        
        bash $basedir/../scripts/fetch_seqs.sh EOG091G0IUT /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ingroup.txt /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/outgroup.txt 1> ../../per_gene/EOG091G0IUT/get_seqs.stdout.txt 2> ../../per_gene/EOG091G0IUT/get_seqs.stderr.txt
	mv EOG091G0IUT.fasta $basedir/per_gene/EOG091G0IUT/EOG091G0IUT.ingroup.fasta
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/72476f9d9a5bd0627b4d721143a21354.simg
[Sun Jul  5 22:49:20 2020]
Finished job 790.
1416 of 3292 steps (43%) done

[Sun Jul  5 22:49:20 2020]
rule infer_single_ML:
    input: per_gene/EOG091G0SRZ/EOG091G0SRZ.best_model, per_gene/EOG091G0SRZ/ALICUT_EOG091G0SRZ.clustalo.fasta
    output: per_gene/EOG091G0SRZ/EOG091G0SRZ.raxml.done
    log: per_gene/EOG091G0SRZ/infer_single_ML.stdout.txt, per_gene/EOG091G0SRZ/infer_single_ML.stderr.txt
    jobid: 189
    wildcards: BUSCO=EOG091G0SRZ
    threads: 2


        cd per_gene/EOG091G0SRZ
	count=$(cat ../../per_gene/EOG091G0SRZ/ALICUT_EOG091G0SRZ.clustalo.fasta | grep ">" | wc -l)
	if [ "$count" -gt 5 ]
        then
		RAxMLmodel=$(cat ../../per_gene/EOG091G0SRZ/EOG091G0SRZ.best_model | grep "Best" | cut -d ":" -f 2 | tr -d '[:space:]')
                if [ "$(ls -1 | grep "^RAxML" | wc -l)" -ne 0 ]
		then
			rm RAxML*
		fi
        	raxml -f a -T 2 -m PROTGAMMA$RAxMLmodel         	-p 12345 -x 12345 -# 100         	-s ../../per_gene/EOG091G0SRZ/ALICUT_EOG091G0SRZ.clustalo.fasta -n EOG091G0SRZ.clustalo.aln.ALICUT.$RAxMLmodel 		1> ../../per_gene/EOG091G0SRZ/infer_single_ML.stdout.txt 2> ../../per_gene/EOG091G0SRZ/infer_single_ML.stderr.txt
	else
		echo "fasta file per_gene/EOG091G0SRZ/ALICUT_EOG091G0SRZ.clustalo.fasta contains fewer than 5 sequences - skipped" > ../../per_gene/EOG091G0SRZ/infer_single_ML.stdout.txt
		touch raxml.skipped
	fi
        touch ../../per_gene/EOG091G0SRZ/EOG091G0SRZ.raxml.done
        
[33mJob counts:
	count	jobs
	1	infer_single_ML
	1[0m
[33m
        cd per_gene/EOG091G0SRZ
	count=$(cat ../../per_gene/EOG091G0SRZ/ALICUT_EOG091G0SRZ.clustalo.fasta | grep ">" | wc -l)
	if [ "$count" -gt 5 ]
        then
		RAxMLmodel=$(cat ../../per_gene/EOG091G0SRZ/EOG091G0SRZ.best_model | grep "Best" | cut -d ":" -f 2 | tr -d '[:space:]')
                if [ "$(ls -1 | grep "^RAxML" | wc -l)" -ne 0 ]
		then
			rm RAxML*
		fi
        	raxml -f a -T 2 -m PROTGAMMA$RAxMLmodel         	-p 12345 -x 12345 -# 100         	-s ../../per_gene/EOG091G0SRZ/ALICUT_EOG091G0SRZ.clustalo.fasta -n EOG091G0SRZ.clustalo.aln.ALICUT.$RAxMLmodel 		1> ../../per_gene/EOG091G0SRZ/infer_single_ML.stdout.txt 2> ../../per_gene/EOG091G0SRZ/infer_single_ML.stderr.txt
	else
		echo "fasta file per_gene/EOG091G0SRZ/ALICUT_EOG091G0SRZ.clustalo.fasta contains fewer than 5 sequences - skipped" > ../../per_gene/EOG091G0SRZ/infer_single_ML.stdout.txt
		touch raxml.skipped
	fi
        touch ../../per_gene/EOG091G0SRZ/EOG091G0SRZ.raxml.done
        [0m
[Sun Jul  5 22:49:24 2020]
Finished job 3212.
1417 of 3292 steps (43%) done

[Sun Jul  5 22:49:24 2020]
rule get_outgroups:
    input: per_gene/EOG091G0IUT/EOG091G0IUT.ingroup.fasta
    output: per_gene/EOG091G0IUT/EOG091G0IUT.orthodb.fasta, per_gene/EOG091G0IUT/EOG091G0IUT.outgroup.fasta
    log: per_gene/EOG091G0IUT/get_outgroups.stdout.txt, per_gene/EOG091G0IUT/get_outgroups.stderr.txt
    jobid: 3213
    wildcards: BUSCO=EOG091G0IUT


        #download fastas from Orhtodb for BUSCO id
        for i in {1..5}
        do
             wget "http://www.orthodb.org/fasta?query=EOG091G0IUT&level=33208" -O per_gene/EOG091G0IUT/EOG091G0IUT.orthodb.fasta 1> per_gene/EOG091G0IUT/get_outgroups.stdout.txt 2> per_gene/EOG091G0IUT/get_outgroups.stderr.txt && break || echo -e "try again ($i)" && sleep 15
        done

	#This is quick an dirty for now and just takes the first protein if there is more than one for an outgroup taxon
        bash ../scripts/download_outgroups.sh taxids.txt per_gene/EOG091G0IUT/EOG091G0IUT.orthodb.fasta > per_gene/EOG091G0IUT/EOG091G0IUT.outgroup.fasta
        
[Sun Jul  5 22:49:26 2020]
Finished job 3213.
1418 of 3292 steps (43%) done

[Sun Jul  5 22:49:26 2020]
rule join_groups:
    input: per_gene/EOG091G0IUT/EOG091G0IUT.ingroup.fasta, per_gene/EOG091G0IUT/EOG091G0IUT.outgroup.fasta
    output: per_gene/EOG091G0IUT/EOG091G0IUT.fasta
    jobid: 2430
    wildcards: BUSCO=EOG091G0IUT


        cat per_gene/EOG091G0IUT/EOG091G0IUT.ingroup.fasta per_gene/EOG091G0IUT/EOG091G0IUT.outgroup.fasta > per_gene/EOG091G0IUT/EOG091G0IUT.fasta
        
[Sun Jul  5 22:49:26 2020]
Finished job 2430.
1419 of 3292 steps (43%) done

[Sun Jul  5 22:49:26 2020]
rule MSA:
    input: per_gene/EOG091G0IUT/EOG091G0IUT.fasta
    output: per_gene/EOG091G0IUT/EOG091G0IUT.clustalo.fasta
    log: per_gene/EOG091G0IUT/MSA.stdout.txt, per_gene/EOG091G0IUT/MSA.stderr.txt
    jobid: 1980
    wildcards: BUSCO=EOG091G0IUT
    threads: 2


        clustalo -i per_gene/EOG091G0IUT/EOG091G0IUT.fasta -o per_gene/EOG091G0IUT/EOG091G0IUT.clustalo.fasta --threads=2 1> per_gene/EOG091G0IUT/MSA.stdout.txt 2> per_gene/EOG091G0IUT/MSA.stderr.txt
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/d68c9691725a7401923680874285c430.simg
[Sun Jul  5 22:49:27 2020]
Finished job 1980.
1420 of 3292 steps (43%) done

[Sun Jul  5 22:49:27 2020]
rule score_and_cut:
    input: per_gene/EOG091G0IUT/EOG091G0IUT.clustalo.fasta
    output: per_gene/EOG091G0IUT/ALICUT_EOG091G0IUT.clustalo.fasta
    jobid: 1157
    wildcards: BUSCO=EOG091G0IUT
    threads: 2


        cd per_gene/EOG091G0IUT
        Aliscore.pl -N -r 200000000000000000 -i ../../per_gene/EOG091G0IUT/EOG091G0IUT.clustalo.fasta &> aliscore.log
        ALICUT.pl -s &> alicut.log
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/63c88c27a0fa300f57066b0ef65fefcb.simg
[Sun Jul  5 22:49:37 2020]
Finished job 1157.
1421 of 3292 steps (43%) done

[Sun Jul  5 22:49:37 2020]
rule remove_empty:
    input: per_gene/EOG091G0IUT/ALICUT_EOG091G0IUT.clustalo.fasta
    output: per_gene/EOG091G0IUT/empty_check.done
    jobid: 1979
    wildcards: BUSCO=EOG091G0IUT


         if [ "$(cat per_gene/EOG091G0IUT/ALICUT_EOG091G0IUT.clustalo.fasta | grep -v ">" | sed 's/-//g' | grep "^$" | wc -l)" -gt 0 ]
         then
              cp per_gene/EOG091G0IUT/ALICUT_EOG091G0IUT.clustalo.fasta per_gene/EOG091G0IUT/ALICUT_EOG091G0IUT.clustalo.fasta.backup
              bash ../scripts/remove_empty.sh per_gene/EOG091G0IUT/ALICUT_EOG091G0IUT.clustalo.fasta.backup > per_gene/EOG091G0IUT/ALICUT_EOG091G0IUT.clustalo.fasta
         fi
         touch per_gene/EOG091G0IUT/empty_check.done
         
[Sun Jul  5 22:49:37 2020]
Finished job 1979.
1422 of 3292 steps (43%) done

[Sun Jul  5 22:49:37 2020]
rule find_best_model:
    input: per_gene/EOG091G0IUT/ALICUT_EOG091G0IUT.clustalo.fasta, per_gene/EOG091G0IUT/empty_check.done
    output: per_gene/EOG091G0IUT/EOG091G0IUT.best_model
    log: per_gene/EOG091G0IUT/find_best_model.stderr.txt
    jobid: 1156
    wildcards: BUSCO=EOG091G0IUT
    threads: 2


        cd per_gene/EOG091G0IUT
        if [ ! -d find_best_model ]
        then
            mkdir find_best_model
        fi
        cd find_best_model
        ln -s ../../../per_gene/EOG091G0IUT/ALICUT_EOG091G0IUT.clustalo.fasta EOG091G0IUT.fasta
        ProteinModelSelection.pl EOG091G0IUT.fasta 1> ../../../per_gene/EOG091G0IUT/EOG091G0IUT.best_model 2> ../../../per_gene/EOG091G0IUT/find_best_model.stderr.txt
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/c0c09ee657b1e27f2c5687e0e9aa8d70.simg
[Sun Jul  5 22:49:44 2020]
Finished job 1028.
1423 of 3292 steps (43%) done

[Sun Jul  5 22:49:44 2020]
rule infer_single_ML:
    input: per_gene/EOG091G0CF7/EOG091G0CF7.best_model, per_gene/EOG091G0CF7/ALICUT_EOG091G0CF7.clustalo.fasta
    output: per_gene/EOG091G0CF7/EOG091G0CF7.raxml.done
    log: per_gene/EOG091G0CF7/infer_single_ML.stdout.txt, per_gene/EOG091G0CF7/infer_single_ML.stderr.txt
    jobid: 308
    wildcards: BUSCO=EOG091G0CF7
    threads: 2


        cd per_gene/EOG091G0CF7
	count=$(cat ../../per_gene/EOG091G0CF7/ALICUT_EOG091G0CF7.clustalo.fasta | grep ">" | wc -l)
	if [ "$count" -gt 5 ]
        then
		RAxMLmodel=$(cat ../../per_gene/EOG091G0CF7/EOG091G0CF7.best_model | grep "Best" | cut -d ":" -f 2 | tr -d '[:space:]')
                if [ "$(ls -1 | grep "^RAxML" | wc -l)" -ne 0 ]
		then
			rm RAxML*
		fi
        	raxml -f a -T 2 -m PROTGAMMA$RAxMLmodel         	-p 12345 -x 12345 -# 100         	-s ../../per_gene/EOG091G0CF7/ALICUT_EOG091G0CF7.clustalo.fasta -n EOG091G0CF7.clustalo.aln.ALICUT.$RAxMLmodel 		1> ../../per_gene/EOG091G0CF7/infer_single_ML.stdout.txt 2> ../../per_gene/EOG091G0CF7/infer_single_ML.stderr.txt
	else
		echo "fasta file per_gene/EOG091G0CF7/ALICUT_EOG091G0CF7.clustalo.fasta contains fewer than 5 sequences - skipped" > ../../per_gene/EOG091G0CF7/infer_single_ML.stdout.txt
		touch raxml.skipped
	fi
        touch ../../per_gene/EOG091G0CF7/EOG091G0CF7.raxml.done
        
[33mJob counts:
	count	jobs
	1	infer_single_ML
	1[0m
[33m
        cd per_gene/EOG091G0CF7
	count=$(cat ../../per_gene/EOG091G0CF7/ALICUT_EOG091G0CF7.clustalo.fasta | grep ">" | wc -l)
	if [ "$count" -gt 5 ]
        then
		RAxMLmodel=$(cat ../../per_gene/EOG091G0CF7/EOG091G0CF7.best_model | grep "Best" | cut -d ":" -f 2 | tr -d '[:space:]')
                if [ "$(ls -1 | grep "^RAxML" | wc -l)" -ne 0 ]
		then
			rm RAxML*
		fi
        	raxml -f a -T 2 -m PROTGAMMA$RAxMLmodel         	-p 12345 -x 12345 -# 100         	-s ../../per_gene/EOG091G0CF7/ALICUT_EOG091G0CF7.clustalo.fasta -n EOG091G0CF7.clustalo.aln.ALICUT.$RAxMLmodel 		1> ../../per_gene/EOG091G0CF7/infer_single_ML.stdout.txt 2> ../../per_gene/EOG091G0CF7/infer_single_ML.stderr.txt
	else
		echo "fasta file per_gene/EOG091G0CF7/ALICUT_EOG091G0CF7.clustalo.fasta contains fewer than 5 sequences - skipped" > ../../per_gene/EOG091G0CF7/infer_single_ML.stdout.txt
		touch raxml.skipped
	fi
        touch ../../per_gene/EOG091G0CF7/EOG091G0CF7.raxml.done
        [0m
[Sun Jul  5 22:49:47 2020]
Finished job 97.
1424 of 3292 steps (43%) done

[Sun Jul  5 22:49:47 2020]
rule get_seqs:
    input: /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ingroup.txt, /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/outgroup.txt
    output: per_gene/EOG091G075F/EOG091G075F.ingroup.fasta
    log: per_gene/EOG091G075F/get_seqs.stdout.txt, per_gene/EOG091G075F/get_seqs.stderr.txt
    jobid: 2574
    wildcards: BUSCO=EOG091G075F
    threads: 2


	basedir=$(pwd)
        cd per_gene/EOG091G075F
        
        bash $basedir/../scripts/fetch_seqs.sh EOG091G075F /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ingroup.txt /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/outgroup.txt 1> ../../per_gene/EOG091G075F/get_seqs.stdout.txt 2> ../../per_gene/EOG091G075F/get_seqs.stderr.txt
	mv EOG091G075F.fasta $basedir/per_gene/EOG091G075F/EOG091G075F.ingroup.fasta
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/72476f9d9a5bd0627b4d721143a21354.simg
[Sun Jul  5 22:49:49 2020]
Finished job 171.
1425 of 3292 steps (43%) done

[Sun Jul  5 22:49:49 2020]
rule get_seqs:
    input: /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ingroup.txt, /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/outgroup.txt
    output: per_gene/EOG091G040G/EOG091G040G.ingroup.fasta
    log: per_gene/EOG091G040G/get_seqs.stdout.txt, per_gene/EOG091G040G/get_seqs.stderr.txt
    jobid: 2520
    wildcards: BUSCO=EOG091G040G
    threads: 2


	basedir=$(pwd)
        cd per_gene/EOG091G040G
        
        bash $basedir/../scripts/fetch_seqs.sh EOG091G040G /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ingroup.txt /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/outgroup.txt 1> ../../per_gene/EOG091G040G/get_seqs.stdout.txt 2> ../../per_gene/EOG091G040G/get_seqs.stderr.txt
	mv EOG091G040G.fasta $basedir/per_gene/EOG091G040G/EOG091G040G.ingroup.fasta
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/72476f9d9a5bd0627b4d721143a21354.simg
[Sun Jul  5 22:49:49 2020]
Finished job 72.
1426 of 3292 steps (43%) done

[Sun Jul  5 22:49:49 2020]
rule get_seqs:
    input: /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ingroup.txt, /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/outgroup.txt
    output: per_gene/EOG091G0RT1/EOG091G0RT1.ingroup.fasta
    log: per_gene/EOG091G0RT1/get_seqs.stdout.txt, per_gene/EOG091G0RT1/get_seqs.stderr.txt
    jobid: 3250
    wildcards: BUSCO=EOG091G0RT1
    threads: 2


	basedir=$(pwd)
        cd per_gene/EOG091G0RT1
        
        bash $basedir/../scripts/fetch_seqs.sh EOG091G0RT1 /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ingroup.txt /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/outgroup.txt 1> ../../per_gene/EOG091G0RT1/get_seqs.stdout.txt 2> ../../per_gene/EOG091G0RT1/get_seqs.stderr.txt
	mv EOG091G0RT1.fasta $basedir/per_gene/EOG091G0RT1/EOG091G0RT1.ingroup.fasta
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/72476f9d9a5bd0627b4d721143a21354.simg
[Sun Jul  5 22:50:00 2020]
Finished job 2574.
1427 of 3292 steps (43%) done

[Sun Jul  5 22:50:00 2020]
rule get_outgroups:
    input: per_gene/EOG091G075F/EOG091G075F.ingroup.fasta
    output: per_gene/EOG091G075F/EOG091G075F.orthodb.fasta, per_gene/EOG091G075F/EOG091G075F.outgroup.fasta
    log: per_gene/EOG091G075F/get_outgroups.stdout.txt, per_gene/EOG091G075F/get_outgroups.stderr.txt
    jobid: 2575
    wildcards: BUSCO=EOG091G075F


        #download fastas from Orhtodb for BUSCO id
        for i in {1..5}
        do
             wget "http://www.orthodb.org/fasta?query=EOG091G075F&level=33208" -O per_gene/EOG091G075F/EOG091G075F.orthodb.fasta 1> per_gene/EOG091G075F/get_outgroups.stdout.txt 2> per_gene/EOG091G075F/get_outgroups.stderr.txt && break || echo -e "try again ($i)" && sleep 15
        done

	#This is quick an dirty for now and just takes the first protein if there is more than one for an outgroup taxon
        bash ../scripts/download_outgroups.sh taxids.txt per_gene/EOG091G075F/EOG091G075F.orthodb.fasta > per_gene/EOG091G075F/EOG091G075F.outgroup.fasta
        
[Sun Jul  5 22:50:01 2020]
Finished job 2575.
1428 of 3292 steps (43%) done

[Sun Jul  5 22:50:01 2020]
rule join_groups:
    input: per_gene/EOG091G075F/EOG091G075F.ingroup.fasta, per_gene/EOG091G075F/EOG091G075F.outgroup.fasta
    output: per_gene/EOG091G075F/EOG091G075F.fasta
    jobid: 2111
    wildcards: BUSCO=EOG091G075F


        cat per_gene/EOG091G075F/EOG091G075F.ingroup.fasta per_gene/EOG091G075F/EOG091G075F.outgroup.fasta > per_gene/EOG091G075F/EOG091G075F.fasta
        
[Sun Jul  5 22:50:01 2020]
Finished job 2111.
1429 of 3292 steps (43%) done

[Sun Jul  5 22:50:01 2020]
rule MSA:
    input: per_gene/EOG091G075F/EOG091G075F.fasta
    output: per_gene/EOG091G075F/EOG091G075F.clustalo.fasta
    log: per_gene/EOG091G075F/MSA.stdout.txt, per_gene/EOG091G075F/MSA.stderr.txt
    jobid: 1342
    wildcards: BUSCO=EOG091G075F
    threads: 2


        clustalo -i per_gene/EOG091G075F/EOG091G075F.fasta -o per_gene/EOG091G075F/EOG091G075F.clustalo.fasta --threads=2 1> per_gene/EOG091G075F/MSA.stdout.txt 2> per_gene/EOG091G075F/MSA.stderr.txt
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/d68c9691725a7401923680874285c430.simg
[Sun Jul  5 22:50:02 2020]
Finished job 2520.
1430 of 3292 steps (43%) done

[Sun Jul  5 22:50:02 2020]
rule get_outgroups:
    input: per_gene/EOG091G040G/EOG091G040G.ingroup.fasta
    output: per_gene/EOG091G040G/EOG091G040G.orthodb.fasta, per_gene/EOG091G040G/EOG091G040G.outgroup.fasta
    log: per_gene/EOG091G040G/get_outgroups.stdout.txt, per_gene/EOG091G040G/get_outgroups.stderr.txt
    jobid: 2521
    wildcards: BUSCO=EOG091G040G


        #download fastas from Orhtodb for BUSCO id
        for i in {1..5}
        do
             wget "http://www.orthodb.org/fasta?query=EOG091G040G&level=33208" -O per_gene/EOG091G040G/EOG091G040G.orthodb.fasta 1> per_gene/EOG091G040G/get_outgroups.stdout.txt 2> per_gene/EOG091G040G/get_outgroups.stderr.txt && break || echo -e "try again ($i)" && sleep 15
        done

	#This is quick an dirty for now and just takes the first protein if there is more than one for an outgroup taxon
        bash ../scripts/download_outgroups.sh taxids.txt per_gene/EOG091G040G/EOG091G040G.orthodb.fasta > per_gene/EOG091G040G/EOG091G040G.outgroup.fasta
        
[Sun Jul  5 22:50:02 2020]
Finished job 3250.
1431 of 3292 steps (43%) done

[Sun Jul  5 22:50:02 2020]
rule get_outgroups:
    input: per_gene/EOG091G0RT1/EOG091G0RT1.ingroup.fasta
    output: per_gene/EOG091G0RT1/EOG091G0RT1.orthodb.fasta, per_gene/EOG091G0RT1/EOG091G0RT1.outgroup.fasta
    log: per_gene/EOG091G0RT1/get_outgroups.stdout.txt, per_gene/EOG091G0RT1/get_outgroups.stderr.txt
    jobid: 3251
    wildcards: BUSCO=EOG091G0RT1


        #download fastas from Orhtodb for BUSCO id
        for i in {1..5}
        do
             wget "http://www.orthodb.org/fasta?query=EOG091G0RT1&level=33208" -O per_gene/EOG091G0RT1/EOG091G0RT1.orthodb.fasta 1> per_gene/EOG091G0RT1/get_outgroups.stdout.txt 2> per_gene/EOG091G0RT1/get_outgroups.stderr.txt && break || echo -e "try again ($i)" && sleep 15
        done

	#This is quick an dirty for now and just takes the first protein if there is more than one for an outgroup taxon
        bash ../scripts/download_outgroups.sh taxids.txt per_gene/EOG091G0RT1/EOG091G0RT1.orthodb.fasta > per_gene/EOG091G0RT1/EOG091G0RT1.outgroup.fasta
        

[Sun Jul  5 22:50:02 2020]
rule get_seqs:
    input: /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ingroup.txt, /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/outgroup.txt
    output: per_gene/EOG091G107U/EOG091G107U.ingroup.fasta
    log: per_gene/EOG091G107U/get_seqs.stdout.txt, per_gene/EOG091G107U/get_seqs.stderr.txt
    jobid: 3040
    wildcards: BUSCO=EOG091G107U
    threads: 2


	basedir=$(pwd)
        cd per_gene/EOG091G107U
        
        bash $basedir/../scripts/fetch_seqs.sh EOG091G107U /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ingroup.txt /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/outgroup.txt 1> ../../per_gene/EOG091G107U/get_seqs.stdout.txt 2> ../../per_gene/EOG091G107U/get_seqs.stderr.txt
	mv EOG091G107U.fasta $basedir/per_gene/EOG091G107U/EOG091G107U.ingroup.fasta
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/72476f9d9a5bd0627b4d721143a21354.simg
[Sun Jul  5 22:50:03 2020]
Finished job 1342.
1432 of 3292 steps (43%) done

[Sun Jul  5 22:50:03 2020]
rule score_and_cut:
    input: per_gene/EOG091G075F/EOG091G075F.clustalo.fasta
    output: per_gene/EOG091G075F/ALICUT_EOG091G075F.clustalo.fasta
    jobid: 519
    wildcards: BUSCO=EOG091G075F
    threads: 2


        cd per_gene/EOG091G075F
        Aliscore.pl -N -r 200000000000000000 -i ../../per_gene/EOG091G075F/EOG091G075F.clustalo.fasta &> aliscore.log
        ALICUT.pl -s &> alicut.log
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/63c88c27a0fa300f57066b0ef65fefcb.simg
[Sun Jul  5 22:50:03 2020]
Finished job 2521.
1433 of 3292 steps (44%) done

[Sun Jul  5 22:50:03 2020]
rule join_groups:
    input: per_gene/EOG091G040G/EOG091G040G.ingroup.fasta, per_gene/EOG091G040G/EOG091G040G.outgroup.fasta
    output: per_gene/EOG091G040G/EOG091G040G.fasta
    jobid: 2084
    wildcards: BUSCO=EOG091G040G


        cat per_gene/EOG091G040G/EOG091G040G.ingroup.fasta per_gene/EOG091G040G/EOG091G040G.outgroup.fasta > per_gene/EOG091G040G/EOG091G040G.fasta
        
[Sun Jul  5 22:50:03 2020]
Finished job 2084.
1434 of 3292 steps (44%) done
[Sun Jul  5 22:50:04 2020]
Finished job 3251.
1435 of 3292 steps (44%) done

[Sun Jul  5 22:50:04 2020]
rule MSA:
    input: per_gene/EOG091G040G/EOG091G040G.fasta
    output: per_gene/EOG091G040G/EOG091G040G.clustalo.fasta
    log: per_gene/EOG091G040G/MSA.stdout.txt, per_gene/EOG091G040G/MSA.stderr.txt
    jobid: 1288
    wildcards: BUSCO=EOG091G040G
    threads: 2


        clustalo -i per_gene/EOG091G040G/EOG091G040G.fasta -o per_gene/EOG091G040G/EOG091G040G.clustalo.fasta --threads=2 1> per_gene/EOG091G040G/MSA.stdout.txt 2> per_gene/EOG091G040G/MSA.stderr.txt
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/d68c9691725a7401923680874285c430.simg
[Sun Jul  5 22:50:06 2020]
Finished job 225.
1436 of 3292 steps (44%) done

[Sun Jul  5 22:50:06 2020]
rule join_groups:
    input: per_gene/EOG091G0RT1/EOG091G0RT1.ingroup.fasta, per_gene/EOG091G0RT1/EOG091G0RT1.outgroup.fasta
    output: per_gene/EOG091G0RT1/EOG091G0RT1.fasta
    jobid: 2449
    wildcards: BUSCO=EOG091G0RT1


        cat per_gene/EOG091G0RT1/EOG091G0RT1.ingroup.fasta per_gene/EOG091G0RT1/EOG091G0RT1.outgroup.fasta > per_gene/EOG091G0RT1/EOG091G0RT1.fasta
        
[Sun Jul  5 22:50:06 2020]
Finished job 2449.
1437 of 3292 steps (44%) done

[Sun Jul  5 22:50:06 2020]
rule MSA:
    input: per_gene/EOG091G0RT1/EOG091G0RT1.fasta
    output: per_gene/EOG091G0RT1/EOG091G0RT1.clustalo.fasta
    log: per_gene/EOG091G0RT1/MSA.stdout.txt, per_gene/EOG091G0RT1/MSA.stderr.txt
    jobid: 2018
    wildcards: BUSCO=EOG091G0RT1
    threads: 2


        clustalo -i per_gene/EOG091G0RT1/EOG091G0RT1.fasta -o per_gene/EOG091G0RT1/EOG091G0RT1.clustalo.fasta --threads=2 1> per_gene/EOG091G0RT1/MSA.stdout.txt 2> per_gene/EOG091G0RT1/MSA.stderr.txt
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/d68c9691725a7401923680874285c430.simg
[Sun Jul  5 22:50:06 2020]
Finished job 1288.
1438 of 3292 steps (44%) done

[Sun Jul  5 22:50:06 2020]
rule score_and_cut:
    input: per_gene/EOG091G040G/EOG091G040G.clustalo.fasta
    output: per_gene/EOG091G040G/ALICUT_EOG091G040G.clustalo.fasta
    jobid: 465
    wildcards: BUSCO=EOG091G040G
    threads: 2


        cd per_gene/EOG091G040G
        Aliscore.pl -N -r 200000000000000000 -i ../../per_gene/EOG091G040G/EOG091G040G.clustalo.fasta &> aliscore.log
        ALICUT.pl -s &> alicut.log
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/63c88c27a0fa300f57066b0ef65fefcb.simg
[Sun Jul  5 22:50:07 2020]
Finished job 2018.
1439 of 3292 steps (44%) done

[Sun Jul  5 22:50:07 2020]
rule score_and_cut:
    input: per_gene/EOG091G0RT1/EOG091G0RT1.clustalo.fasta
    output: per_gene/EOG091G0RT1/ALICUT_EOG091G0RT1.clustalo.fasta
    jobid: 1195
    wildcards: BUSCO=EOG091G0RT1
    threads: 2


        cd per_gene/EOG091G0RT1
        Aliscore.pl -N -r 200000000000000000 -i ../../per_gene/EOG091G0RT1/EOG091G0RT1.clustalo.fasta &> aliscore.log
        ALICUT.pl -s &> alicut.log
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/63c88c27a0fa300f57066b0ef65fefcb.simg
[Sun Jul  5 22:50:07 2020]
Finished job 1156.
1440 of 3292 steps (44%) done

[Sun Jul  5 22:50:08 2020]
rule infer_single_ML:
    input: per_gene/EOG091G0IUT/EOG091G0IUT.best_model, per_gene/EOG091G0IUT/ALICUT_EOG091G0IUT.clustalo.fasta
    output: per_gene/EOG091G0IUT/EOG091G0IUT.raxml.done
    log: per_gene/EOG091G0IUT/infer_single_ML.stdout.txt, per_gene/EOG091G0IUT/infer_single_ML.stderr.txt
    jobid: 372
    wildcards: BUSCO=EOG091G0IUT
    threads: 2


        cd per_gene/EOG091G0IUT
	count=$(cat ../../per_gene/EOG091G0IUT/ALICUT_EOG091G0IUT.clustalo.fasta | grep ">" | wc -l)
	if [ "$count" -gt 5 ]
        then
		RAxMLmodel=$(cat ../../per_gene/EOG091G0IUT/EOG091G0IUT.best_model | grep "Best" | cut -d ":" -f 2 | tr -d '[:space:]')
                if [ "$(ls -1 | grep "^RAxML" | wc -l)" -ne 0 ]
		then
			rm RAxML*
		fi
        	raxml -f a -T 2 -m PROTGAMMA$RAxMLmodel         	-p 12345 -x 12345 -# 100         	-s ../../per_gene/EOG091G0IUT/ALICUT_EOG091G0IUT.clustalo.fasta -n EOG091G0IUT.clustalo.aln.ALICUT.$RAxMLmodel 		1> ../../per_gene/EOG091G0IUT/infer_single_ML.stdout.txt 2> ../../per_gene/EOG091G0IUT/infer_single_ML.stderr.txt
	else
		echo "fasta file per_gene/EOG091G0IUT/ALICUT_EOG091G0IUT.clustalo.fasta contains fewer than 5 sequences - skipped" > ../../per_gene/EOG091G0IUT/infer_single_ML.stdout.txt
		touch raxml.skipped
	fi
        touch ../../per_gene/EOG091G0IUT/EOG091G0IUT.raxml.done
        
[33mJob counts:
	count	jobs
	1	infer_single_ML
	1[0m
[33m
        cd per_gene/EOG091G0IUT
	count=$(cat ../../per_gene/EOG091G0IUT/ALICUT_EOG091G0IUT.clustalo.fasta | grep ">" | wc -l)
	if [ "$count" -gt 5 ]
        then
		RAxMLmodel=$(cat ../../per_gene/EOG091G0IUT/EOG091G0IUT.best_model | grep "Best" | cut -d ":" -f 2 | tr -d '[:space:]')
                if [ "$(ls -1 | grep "^RAxML" | wc -l)" -ne 0 ]
		then
			rm RAxML*
		fi
        	raxml -f a -T 2 -m PROTGAMMA$RAxMLmodel         	-p 12345 -x 12345 -# 100         	-s ../../per_gene/EOG091G0IUT/ALICUT_EOG091G0IUT.clustalo.fasta -n EOG091G0IUT.clustalo.aln.ALICUT.$RAxMLmodel 		1> ../../per_gene/EOG091G0IUT/infer_single_ML.stdout.txt 2> ../../per_gene/EOG091G0IUT/infer_single_ML.stderr.txt
	else
		echo "fasta file per_gene/EOG091G0IUT/ALICUT_EOG091G0IUT.clustalo.fasta contains fewer than 5 sequences - skipped" > ../../per_gene/EOG091G0IUT/infer_single_ML.stdout.txt
		touch raxml.skipped
	fi
        touch ../../per_gene/EOG091G0IUT/EOG091G0IUT.raxml.done
        [0m
[Sun Jul  5 22:50:09 2020]
Finished job 317.
1441 of 3292 steps (44%) done

[Sun Jul  5 22:50:09 2020]
rule get_seqs:
    input: /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ingroup.txt, /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/outgroup.txt
    output: per_gene/EOG091G03RW/EOG091G03RW.ingroup.fasta
    log: per_gene/EOG091G03RW/get_seqs.stdout.txt, per_gene/EOG091G03RW/get_seqs.stderr.txt
    jobid: 2516
    wildcards: BUSCO=EOG091G03RW
    threads: 2


	basedir=$(pwd)
        cd per_gene/EOG091G03RW
        
        bash $basedir/../scripts/fetch_seqs.sh EOG091G03RW /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ingroup.txt /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/outgroup.txt 1> ../../per_gene/EOG091G03RW/get_seqs.stdout.txt 2> ../../per_gene/EOG091G03RW/get_seqs.stderr.txt
	mv EOG091G03RW.fasta $basedir/per_gene/EOG091G03RW/EOG091G03RW.ingroup.fasta
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/72476f9d9a5bd0627b4d721143a21354.simg
[Sun Jul  5 22:50:13 2020]
Finished job 519.
1442 of 3292 steps (44%) done

[Sun Jul  5 22:50:13 2020]
rule remove_empty:
    input: per_gene/EOG091G075F/ALICUT_EOG091G075F.clustalo.fasta
    output: per_gene/EOG091G075F/empty_check.done
    jobid: 1341
    wildcards: BUSCO=EOG091G075F


         if [ "$(cat per_gene/EOG091G075F/ALICUT_EOG091G075F.clustalo.fasta | grep -v ">" | sed 's/-//g' | grep "^$" | wc -l)" -gt 0 ]
         then
              cp per_gene/EOG091G075F/ALICUT_EOG091G075F.clustalo.fasta per_gene/EOG091G075F/ALICUT_EOG091G075F.clustalo.fasta.backup
              bash ../scripts/remove_empty.sh per_gene/EOG091G075F/ALICUT_EOG091G075F.clustalo.fasta.backup > per_gene/EOG091G075F/ALICUT_EOG091G075F.clustalo.fasta
         fi
         touch per_gene/EOG091G075F/empty_check.done
         
[Sun Jul  5 22:50:13 2020]
Finished job 1341.
1443 of 3292 steps (44%) done

[Sun Jul  5 22:50:13 2020]
rule find_best_model:
    input: per_gene/EOG091G075F/ALICUT_EOG091G075F.clustalo.fasta, per_gene/EOG091G075F/empty_check.done
    output: per_gene/EOG091G075F/EOG091G075F.best_model
    log: per_gene/EOG091G075F/find_best_model.stderr.txt
    jobid: 518
    wildcards: BUSCO=EOG091G075F
    threads: 2


        cd per_gene/EOG091G075F
        if [ ! -d find_best_model ]
        then
            mkdir find_best_model
        fi
        cd find_best_model
        ln -s ../../../per_gene/EOG091G075F/ALICUT_EOG091G075F.clustalo.fasta EOG091G075F.fasta
        ProteinModelSelection.pl EOG091G075F.fasta 1> ../../../per_gene/EOG091G075F/EOG091G075F.best_model 2> ../../../per_gene/EOG091G075F/find_best_model.stderr.txt
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/c0c09ee657b1e27f2c5687e0e9aa8d70.simg
[Sun Jul  5 22:50:17 2020]
Finished job 1195.
1444 of 3292 steps (44%) done

[Sun Jul  5 22:50:17 2020]
rule remove_empty:
    input: per_gene/EOG091G0RT1/ALICUT_EOG091G0RT1.clustalo.fasta
    output: per_gene/EOG091G0RT1/empty_check.done
    jobid: 2017
    wildcards: BUSCO=EOG091G0RT1


         if [ "$(cat per_gene/EOG091G0RT1/ALICUT_EOG091G0RT1.clustalo.fasta | grep -v ">" | sed 's/-//g' | grep "^$" | wc -l)" -gt 0 ]
         then
              cp per_gene/EOG091G0RT1/ALICUT_EOG091G0RT1.clustalo.fasta per_gene/EOG091G0RT1/ALICUT_EOG091G0RT1.clustalo.fasta.backup
              bash ../scripts/remove_empty.sh per_gene/EOG091G0RT1/ALICUT_EOG091G0RT1.clustalo.fasta.backup > per_gene/EOG091G0RT1/ALICUT_EOG091G0RT1.clustalo.fasta
         fi
         touch per_gene/EOG091G0RT1/empty_check.done
         
[Sun Jul  5 22:50:17 2020]
Finished job 2017.
1445 of 3292 steps (44%) done

[Sun Jul  5 22:50:17 2020]
rule find_best_model:
    input: per_gene/EOG091G0RT1/ALICUT_EOG091G0RT1.clustalo.fasta, per_gene/EOG091G0RT1/empty_check.done
    output: per_gene/EOG091G0RT1/EOG091G0RT1.best_model
    log: per_gene/EOG091G0RT1/find_best_model.stderr.txt
    jobid: 1194
    wildcards: BUSCO=EOG091G0RT1
    threads: 2


        cd per_gene/EOG091G0RT1
        if [ ! -d find_best_model ]
        then
            mkdir find_best_model
        fi
        cd find_best_model
        ln -s ../../../per_gene/EOG091G0RT1/ALICUT_EOG091G0RT1.clustalo.fasta EOG091G0RT1.fasta
        ProteinModelSelection.pl EOG091G0RT1.fasta 1> ../../../per_gene/EOG091G0RT1/EOG091G0RT1.best_model 2> ../../../per_gene/EOG091G0RT1/find_best_model.stderr.txt
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/c0c09ee657b1e27f2c5687e0e9aa8d70.simg
[Sun Jul  5 22:50:17 2020]
Finished job 465.
1446 of 3292 steps (44%) done

[Sun Jul  5 22:50:17 2020]
rule remove_empty:
    input: per_gene/EOG091G040G/ALICUT_EOG091G040G.clustalo.fasta
    output: per_gene/EOG091G040G/empty_check.done
    jobid: 1287
    wildcards: BUSCO=EOG091G040G


         if [ "$(cat per_gene/EOG091G040G/ALICUT_EOG091G040G.clustalo.fasta | grep -v ">" | sed 's/-//g' | grep "^$" | wc -l)" -gt 0 ]
         then
              cp per_gene/EOG091G040G/ALICUT_EOG091G040G.clustalo.fasta per_gene/EOG091G040G/ALICUT_EOG091G040G.clustalo.fasta.backup
              bash ../scripts/remove_empty.sh per_gene/EOG091G040G/ALICUT_EOG091G040G.clustalo.fasta.backup > per_gene/EOG091G040G/ALICUT_EOG091G040G.clustalo.fasta
         fi
         touch per_gene/EOG091G040G/empty_check.done
         
[Sun Jul  5 22:50:17 2020]
Finished job 1287.
1447 of 3292 steps (44%) done

[Sun Jul  5 22:50:17 2020]
rule find_best_model:
    input: per_gene/EOG091G040G/ALICUT_EOG091G040G.clustalo.fasta, per_gene/EOG091G040G/empty_check.done
    output: per_gene/EOG091G040G/EOG091G040G.best_model
    log: per_gene/EOG091G040G/find_best_model.stderr.txt
    jobid: 464
    wildcards: BUSCO=EOG091G040G
    threads: 2


        cd per_gene/EOG091G040G
        if [ ! -d find_best_model ]
        then
            mkdir find_best_model
        fi
        cd find_best_model
        ln -s ../../../per_gene/EOG091G040G/ALICUT_EOG091G040G.clustalo.fasta EOG091G040G.fasta
        ProteinModelSelection.pl EOG091G040G.fasta 1> ../../../per_gene/EOG091G040G/EOG091G040G.best_model 2> ../../../per_gene/EOG091G040G/find_best_model.stderr.txt
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/c0c09ee657b1e27f2c5687e0e9aa8d70.simg
[Sun Jul  5 22:50:19 2020]
Finished job 3040.
1448 of 3292 steps (44%) done

[Sun Jul  5 22:50:19 2020]
rule get_outgroups:
    input: per_gene/EOG091G107U/EOG091G107U.ingroup.fasta
    output: per_gene/EOG091G107U/EOG091G107U.orthodb.fasta, per_gene/EOG091G107U/EOG091G107U.outgroup.fasta
    log: per_gene/EOG091G107U/get_outgroups.stdout.txt, per_gene/EOG091G107U/get_outgroups.stderr.txt
    jobid: 3041
    wildcards: BUSCO=EOG091G107U


        #download fastas from Orhtodb for BUSCO id
        for i in {1..5}
        do
             wget "http://www.orthodb.org/fasta?query=EOG091G107U&level=33208" -O per_gene/EOG091G107U/EOG091G107U.orthodb.fasta 1> per_gene/EOG091G107U/get_outgroups.stdout.txt 2> per_gene/EOG091G107U/get_outgroups.stderr.txt && break || echo -e "try again ($i)" && sleep 15
        done

	#This is quick an dirty for now and just takes the first protein if there is more than one for an outgroup taxon
        bash ../scripts/download_outgroups.sh taxids.txt per_gene/EOG091G107U/EOG091G107U.orthodb.fasta > per_gene/EOG091G107U/EOG091G107U.outgroup.fasta
        
[Sun Jul  5 22:50:20 2020]
Finished job 3041.
1449 of 3292 steps (44%) done

[Sun Jul  5 22:50:20 2020]
rule join_groups:
    input: per_gene/EOG091G107U/EOG091G107U.ingroup.fasta, per_gene/EOG091G107U/EOG091G107U.outgroup.fasta
    output: per_gene/EOG091G107U/EOG091G107U.fasta
    jobid: 2344
    wildcards: BUSCO=EOG091G107U


        cat per_gene/EOG091G107U/EOG091G107U.ingroup.fasta per_gene/EOG091G107U/EOG091G107U.outgroup.fasta > per_gene/EOG091G107U/EOG091G107U.fasta
        
[Sun Jul  5 22:50:20 2020]
Finished job 2344.
1450 of 3292 steps (44%) done

[Sun Jul  5 22:50:20 2020]
rule MSA:
    input: per_gene/EOG091G107U/EOG091G107U.fasta
    output: per_gene/EOG091G107U/EOG091G107U.clustalo.fasta
    log: per_gene/EOG091G107U/MSA.stdout.txt, per_gene/EOG091G107U/MSA.stderr.txt
    jobid: 1808
    wildcards: BUSCO=EOG091G107U
    threads: 2


        clustalo -i per_gene/EOG091G107U/EOG091G107U.fasta -o per_gene/EOG091G107U/EOG091G107U.clustalo.fasta --threads=2 1> per_gene/EOG091G107U/MSA.stdout.txt 2> per_gene/EOG091G107U/MSA.stderr.txt
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/d68c9691725a7401923680874285c430.simg
[Sun Jul  5 22:50:20 2020]
Finished job 1808.
1451 of 3292 steps (44%) done

[Sun Jul  5 22:50:20 2020]
rule score_and_cut:
    input: per_gene/EOG091G107U/EOG091G107U.clustalo.fasta
    output: per_gene/EOG091G107U/ALICUT_EOG091G107U.clustalo.fasta
    jobid: 985
    wildcards: BUSCO=EOG091G107U
    threads: 2


        cd per_gene/EOG091G107U
        Aliscore.pl -N -r 200000000000000000 -i ../../per_gene/EOG091G107U/EOG091G107U.clustalo.fasta &> aliscore.log
        ALICUT.pl -s &> alicut.log
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/63c88c27a0fa300f57066b0ef65fefcb.simg
[Sun Jul  5 22:50:25 2020]
Finished job 2516.
1452 of 3292 steps (44%) done

[Sun Jul  5 22:50:25 2020]
rule get_outgroups:
    input: per_gene/EOG091G03RW/EOG091G03RW.ingroup.fasta
    output: per_gene/EOG091G03RW/EOG091G03RW.orthodb.fasta, per_gene/EOG091G03RW/EOG091G03RW.outgroup.fasta
    log: per_gene/EOG091G03RW/get_outgroups.stdout.txt, per_gene/EOG091G03RW/get_outgroups.stderr.txt
    jobid: 2517
    wildcards: BUSCO=EOG091G03RW


        #download fastas from Orhtodb for BUSCO id
        for i in {1..5}
        do
             wget "http://www.orthodb.org/fasta?query=EOG091G03RW&level=33208" -O per_gene/EOG091G03RW/EOG091G03RW.orthodb.fasta 1> per_gene/EOG091G03RW/get_outgroups.stdout.txt 2> per_gene/EOG091G03RW/get_outgroups.stderr.txt && break || echo -e "try again ($i)" && sleep 15
        done

	#This is quick an dirty for now and just takes the first protein if there is more than one for an outgroup taxon
        bash ../scripts/download_outgroups.sh taxids.txt per_gene/EOG091G03RW/EOG091G03RW.orthodb.fasta > per_gene/EOG091G03RW/EOG091G03RW.outgroup.fasta
        
[Sun Jul  5 22:50:26 2020]
Finished job 2517.
1453 of 3292 steps (44%) done

[Sun Jul  5 22:50:26 2020]
rule join_groups:
    input: per_gene/EOG091G03RW/EOG091G03RW.ingroup.fasta, per_gene/EOG091G03RW/EOG091G03RW.outgroup.fasta
    output: per_gene/EOG091G03RW/EOG091G03RW.fasta
    jobid: 2082
    wildcards: BUSCO=EOG091G03RW


        cat per_gene/EOG091G03RW/EOG091G03RW.ingroup.fasta per_gene/EOG091G03RW/EOG091G03RW.outgroup.fasta > per_gene/EOG091G03RW/EOG091G03RW.fasta
        
[Sun Jul  5 22:50:26 2020]
Finished job 2082.
1454 of 3292 steps (44%) done

[Sun Jul  5 22:50:26 2020]
rule MSA:
    input: per_gene/EOG091G03RW/EOG091G03RW.fasta
    output: per_gene/EOG091G03RW/EOG091G03RW.clustalo.fasta
    log: per_gene/EOG091G03RW/MSA.stdout.txt, per_gene/EOG091G03RW/MSA.stderr.txt
    jobid: 1284
    wildcards: BUSCO=EOG091G03RW
    threads: 2


        clustalo -i per_gene/EOG091G03RW/EOG091G03RW.fasta -o per_gene/EOG091G03RW/EOG091G03RW.clustalo.fasta --threads=2 1> per_gene/EOG091G03RW/MSA.stdout.txt 2> per_gene/EOG091G03RW/MSA.stderr.txt
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/d68c9691725a7401923680874285c430.simg
[Sun Jul  5 22:50:29 2020]
Finished job 1284.
1455 of 3292 steps (44%) done

[Sun Jul  5 22:50:29 2020]
rule score_and_cut:
    input: per_gene/EOG091G03RW/EOG091G03RW.clustalo.fasta
    output: per_gene/EOG091G03RW/ALICUT_EOG091G03RW.clustalo.fasta
    jobid: 461
    wildcards: BUSCO=EOG091G03RW
    threads: 2


        cd per_gene/EOG091G03RW
        Aliscore.pl -N -r 200000000000000000 -i ../../per_gene/EOG091G03RW/EOG091G03RW.clustalo.fasta &> aliscore.log
        ALICUT.pl -s &> alicut.log
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/63c88c27a0fa300f57066b0ef65fefcb.simg
[Sun Jul  5 22:50:29 2020]
Finished job 985.
1456 of 3292 steps (44%) done

[Sun Jul  5 22:50:29 2020]
rule remove_empty:
    input: per_gene/EOG091G107U/ALICUT_EOG091G107U.clustalo.fasta
    output: per_gene/EOG091G107U/empty_check.done
    jobid: 1807
    wildcards: BUSCO=EOG091G107U


         if [ "$(cat per_gene/EOG091G107U/ALICUT_EOG091G107U.clustalo.fasta | grep -v ">" | sed 's/-//g' | grep "^$" | wc -l)" -gt 0 ]
         then
              cp per_gene/EOG091G107U/ALICUT_EOG091G107U.clustalo.fasta per_gene/EOG091G107U/ALICUT_EOG091G107U.clustalo.fasta.backup
              bash ../scripts/remove_empty.sh per_gene/EOG091G107U/ALICUT_EOG091G107U.clustalo.fasta.backup > per_gene/EOG091G107U/ALICUT_EOG091G107U.clustalo.fasta
         fi
         touch per_gene/EOG091G107U/empty_check.done
         
[Sun Jul  5 22:50:29 2020]
Finished job 1807.
1457 of 3292 steps (44%) done

[Sun Jul  5 22:50:29 2020]
rule find_best_model:
    input: per_gene/EOG091G107U/ALICUT_EOG091G107U.clustalo.fasta, per_gene/EOG091G107U/empty_check.done
    output: per_gene/EOG091G107U/EOG091G107U.best_model
    log: per_gene/EOG091G107U/find_best_model.stderr.txt
    jobid: 984
    wildcards: BUSCO=EOG091G107U
    threads: 2


        cd per_gene/EOG091G107U
        if [ ! -d find_best_model ]
        then
            mkdir find_best_model
        fi
        cd find_best_model
        ln -s ../../../per_gene/EOG091G107U/ALICUT_EOG091G107U.clustalo.fasta EOG091G107U.fasta
        ProteinModelSelection.pl EOG091G107U.fasta 1> ../../../per_gene/EOG091G107U/EOG091G107U.best_model 2> ../../../per_gene/EOG091G107U/find_best_model.stderr.txt
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/c0c09ee657b1e27f2c5687e0e9aa8d70.simg
[Sun Jul  5 22:50:38 2020]
Finished job 9.
1458 of 3292 steps (44%) done

[Sun Jul  5 22:50:38 2020]
rule get_seqs:
    input: /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ingroup.txt, /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/outgroup.txt
    output: per_gene/EOG091G15N9/EOG091G15N9.ingroup.fasta
    log: per_gene/EOG091G15N9/get_seqs.stdout.txt, per_gene/EOG091G15N9/get_seqs.stderr.txt
    jobid: 2934
    wildcards: BUSCO=EOG091G15N9
    threads: 2


	basedir=$(pwd)
        cd per_gene/EOG091G15N9
        
        bash $basedir/../scripts/fetch_seqs.sh EOG091G15N9 /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ingroup.txt /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/outgroup.txt 1> ../../per_gene/EOG091G15N9/get_seqs.stdout.txt 2> ../../per_gene/EOG091G15N9/get_seqs.stderr.txt
	mv EOG091G15N9.fasta $basedir/per_gene/EOG091G15N9/EOG091G15N9.ingroup.fasta
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/72476f9d9a5bd0627b4d721143a21354.simg
[Sun Jul  5 22:50:39 2020]
Finished job 461.
1459 of 3292 steps (44%) done

[Sun Jul  5 22:50:39 2020]
rule remove_empty:
    input: per_gene/EOG091G03RW/ALICUT_EOG091G03RW.clustalo.fasta
    output: per_gene/EOG091G03RW/empty_check.done
    jobid: 1283
    wildcards: BUSCO=EOG091G03RW


         if [ "$(cat per_gene/EOG091G03RW/ALICUT_EOG091G03RW.clustalo.fasta | grep -v ">" | sed 's/-//g' | grep "^$" | wc -l)" -gt 0 ]
         then
              cp per_gene/EOG091G03RW/ALICUT_EOG091G03RW.clustalo.fasta per_gene/EOG091G03RW/ALICUT_EOG091G03RW.clustalo.fasta.backup
              bash ../scripts/remove_empty.sh per_gene/EOG091G03RW/ALICUT_EOG091G03RW.clustalo.fasta.backup > per_gene/EOG091G03RW/ALICUT_EOG091G03RW.clustalo.fasta
         fi
         touch per_gene/EOG091G03RW/empty_check.done
         
[Sun Jul  5 22:50:39 2020]
Finished job 1283.
1460 of 3292 steps (44%) done

[Sun Jul  5 22:50:39 2020]
rule find_best_model:
    input: per_gene/EOG091G03RW/ALICUT_EOG091G03RW.clustalo.fasta, per_gene/EOG091G03RW/empty_check.done
    output: per_gene/EOG091G03RW/EOG091G03RW.best_model
    log: per_gene/EOG091G03RW/find_best_model.stderr.txt
    jobid: 460
    wildcards: BUSCO=EOG091G03RW
    threads: 2


        cd per_gene/EOG091G03RW
        if [ ! -d find_best_model ]
        then
            mkdir find_best_model
        fi
        cd find_best_model
        ln -s ../../../per_gene/EOG091G03RW/ALICUT_EOG091G03RW.clustalo.fasta EOG091G03RW.fasta
        ProteinModelSelection.pl EOG091G03RW.fasta 1> ../../../per_gene/EOG091G03RW/EOG091G03RW.best_model 2> ../../../per_gene/EOG091G03RW/find_best_model.stderr.txt
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/c0c09ee657b1e27f2c5687e0e9aa8d70.simg
[Sun Jul  5 22:50:46 2020]
Finished job 518.
1461 of 3292 steps (44%) done

[Sun Jul  5 22:50:46 2020]
rule infer_single_ML:
    input: per_gene/EOG091G075F/EOG091G075F.best_model, per_gene/EOG091G075F/ALICUT_EOG091G075F.clustalo.fasta
    output: per_gene/EOG091G075F/EOG091G075F.raxml.done
    log: per_gene/EOG091G075F/infer_single_ML.stdout.txt, per_gene/EOG091G075F/infer_single_ML.stderr.txt
    jobid: 53
    wildcards: BUSCO=EOG091G075F
    threads: 2


        cd per_gene/EOG091G075F
	count=$(cat ../../per_gene/EOG091G075F/ALICUT_EOG091G075F.clustalo.fasta | grep ">" | wc -l)
	if [ "$count" -gt 5 ]
        then
		RAxMLmodel=$(cat ../../per_gene/EOG091G075F/EOG091G075F.best_model | grep "Best" | cut -d ":" -f 2 | tr -d '[:space:]')
                if [ "$(ls -1 | grep "^RAxML" | wc -l)" -ne 0 ]
		then
			rm RAxML*
		fi
        	raxml -f a -T 2 -m PROTGAMMA$RAxMLmodel         	-p 12345 -x 12345 -# 100         	-s ../../per_gene/EOG091G075F/ALICUT_EOG091G075F.clustalo.fasta -n EOG091G075F.clustalo.aln.ALICUT.$RAxMLmodel 		1> ../../per_gene/EOG091G075F/infer_single_ML.stdout.txt 2> ../../per_gene/EOG091G075F/infer_single_ML.stderr.txt
	else
		echo "fasta file per_gene/EOG091G075F/ALICUT_EOG091G075F.clustalo.fasta contains fewer than 5 sequences - skipped" > ../../per_gene/EOG091G075F/infer_single_ML.stdout.txt
		touch raxml.skipped
	fi
        touch ../../per_gene/EOG091G075F/EOG091G075F.raxml.done
        
[33mJob counts:
	count	jobs
	1	infer_single_ML
	1[0m
[33m
        cd per_gene/EOG091G075F
	count=$(cat ../../per_gene/EOG091G075F/ALICUT_EOG091G075F.clustalo.fasta | grep ">" | wc -l)
	if [ "$count" -gt 5 ]
        then
		RAxMLmodel=$(cat ../../per_gene/EOG091G075F/EOG091G075F.best_model | grep "Best" | cut -d ":" -f 2 | tr -d '[:space:]')
                if [ "$(ls -1 | grep "^RAxML" | wc -l)" -ne 0 ]
		then
			rm RAxML*
		fi
        	raxml -f a -T 2 -m PROTGAMMA$RAxMLmodel         	-p 12345 -x 12345 -# 100         	-s ../../per_gene/EOG091G075F/ALICUT_EOG091G075F.clustalo.fasta -n EOG091G075F.clustalo.aln.ALICUT.$RAxMLmodel 		1> ../../per_gene/EOG091G075F/infer_single_ML.stdout.txt 2> ../../per_gene/EOG091G075F/infer_single_ML.stderr.txt
	else
		echo "fasta file per_gene/EOG091G075F/ALICUT_EOG091G075F.clustalo.fasta contains fewer than 5 sequences - skipped" > ../../per_gene/EOG091G075F/infer_single_ML.stdout.txt
		touch raxml.skipped
	fi
        touch ../../per_gene/EOG091G075F/EOG091G075F.raxml.done
        [0m
[Sun Jul  5 22:50:54 2020]
Finished job 2934.
1462 of 3292 steps (44%) done

[Sun Jul  5 22:50:54 2020]
rule get_outgroups:
    input: per_gene/EOG091G15N9/EOG091G15N9.ingroup.fasta
    output: per_gene/EOG091G15N9/EOG091G15N9.orthodb.fasta, per_gene/EOG091G15N9/EOG091G15N9.outgroup.fasta
    log: per_gene/EOG091G15N9/get_outgroups.stdout.txt, per_gene/EOG091G15N9/get_outgroups.stderr.txt
    jobid: 2935
    wildcards: BUSCO=EOG091G15N9


        #download fastas from Orhtodb for BUSCO id
        for i in {1..5}
        do
             wget "http://www.orthodb.org/fasta?query=EOG091G15N9&level=33208" -O per_gene/EOG091G15N9/EOG091G15N9.orthodb.fasta 1> per_gene/EOG091G15N9/get_outgroups.stdout.txt 2> per_gene/EOG091G15N9/get_outgroups.stderr.txt && break || echo -e "try again ($i)" && sleep 15
        done

	#This is quick an dirty for now and just takes the first protein if there is more than one for an outgroup taxon
        bash ../scripts/download_outgroups.sh taxids.txt per_gene/EOG091G15N9/EOG091G15N9.orthodb.fasta > per_gene/EOG091G15N9/EOG091G15N9.outgroup.fasta
        
[Sun Jul  5 22:50:56 2020]
Finished job 2935.
1463 of 3292 steps (44%) done

[Sun Jul  5 22:50:56 2020]
rule join_groups:
    input: per_gene/EOG091G15N9/EOG091G15N9.ingroup.fasta, per_gene/EOG091G15N9/EOG091G15N9.outgroup.fasta
    output: per_gene/EOG091G15N9/EOG091G15N9.fasta
    jobid: 2291
    wildcards: BUSCO=EOG091G15N9


        cat per_gene/EOG091G15N9/EOG091G15N9.ingroup.fasta per_gene/EOG091G15N9/EOG091G15N9.outgroup.fasta > per_gene/EOG091G15N9/EOG091G15N9.fasta
        
[Sun Jul  5 22:50:56 2020]
Finished job 2291.
1464 of 3292 steps (44%) done

[Sun Jul  5 22:50:56 2020]
rule MSA:
    input: per_gene/EOG091G15N9/EOG091G15N9.fasta
    output: per_gene/EOG091G15N9/EOG091G15N9.clustalo.fasta
    log: per_gene/EOG091G15N9/MSA.stdout.txt, per_gene/EOG091G15N9/MSA.stderr.txt
    jobid: 1702
    wildcards: BUSCO=EOG091G15N9
    threads: 2


        clustalo -i per_gene/EOG091G15N9/EOG091G15N9.fasta -o per_gene/EOG091G15N9/EOG091G15N9.clustalo.fasta --threads=2 1> per_gene/EOG091G15N9/MSA.stdout.txt 2> per_gene/EOG091G15N9/MSA.stderr.txt
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/d68c9691725a7401923680874285c430.simg
[Sun Jul  5 22:50:56 2020]
Finished job 984.
1465 of 3292 steps (45%) done

[Sun Jul  5 22:50:56 2020]
rule infer_single_ML:
    input: per_gene/EOG091G107U/EOG091G107U.best_model, per_gene/EOG091G107U/ALICUT_EOG091G107U.clustalo.fasta
    output: per_gene/EOG091G107U/EOG091G107U.raxml.done
    log: per_gene/EOG091G107U/infer_single_ML.stdout.txt, per_gene/EOG091G107U/infer_single_ML.stderr.txt
    jobid: 286
    wildcards: BUSCO=EOG091G107U
    threads: 2


        cd per_gene/EOG091G107U
	count=$(cat ../../per_gene/EOG091G107U/ALICUT_EOG091G107U.clustalo.fasta | grep ">" | wc -l)
	if [ "$count" -gt 5 ]
        then
		RAxMLmodel=$(cat ../../per_gene/EOG091G107U/EOG091G107U.best_model | grep "Best" | cut -d ":" -f 2 | tr -d '[:space:]')
                if [ "$(ls -1 | grep "^RAxML" | wc -l)" -ne 0 ]
		then
			rm RAxML*
		fi
        	raxml -f a -T 2 -m PROTGAMMA$RAxMLmodel         	-p 12345 -x 12345 -# 100         	-s ../../per_gene/EOG091G107U/ALICUT_EOG091G107U.clustalo.fasta -n EOG091G107U.clustalo.aln.ALICUT.$RAxMLmodel 		1> ../../per_gene/EOG091G107U/infer_single_ML.stdout.txt 2> ../../per_gene/EOG091G107U/infer_single_ML.stderr.txt
	else
		echo "fasta file per_gene/EOG091G107U/ALICUT_EOG091G107U.clustalo.fasta contains fewer than 5 sequences - skipped" > ../../per_gene/EOG091G107U/infer_single_ML.stdout.txt
		touch raxml.skipped
	fi
        touch ../../per_gene/EOG091G107U/EOG091G107U.raxml.done
        
[Sun Jul  5 22:50:56 2020]
Finished job 1702.
1466 of 3292 steps (45%) done

[Sun Jul  5 22:50:56 2020]
rule score_and_cut:
    input: per_gene/EOG091G15N9/EOG091G15N9.clustalo.fasta
    output: per_gene/EOG091G15N9/ALICUT_EOG091G15N9.clustalo.fasta
    jobid: 879
    wildcards: BUSCO=EOG091G15N9
    threads: 2


        cd per_gene/EOG091G15N9
        Aliscore.pl -N -r 200000000000000000 -i ../../per_gene/EOG091G15N9/EOG091G15N9.clustalo.fasta &> aliscore.log
        ALICUT.pl -s &> alicut.log
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/63c88c27a0fa300f57066b0ef65fefcb.simg
[33mJob counts:
	count	jobs
	1	infer_single_ML
	1[0m
[33m
        cd per_gene/EOG091G107U
	count=$(cat ../../per_gene/EOG091G107U/ALICUT_EOG091G107U.clustalo.fasta | grep ">" | wc -l)
	if [ "$count" -gt 5 ]
        then
		RAxMLmodel=$(cat ../../per_gene/EOG091G107U/EOG091G107U.best_model | grep "Best" | cut -d ":" -f 2 | tr -d '[:space:]')
                if [ "$(ls -1 | grep "^RAxML" | wc -l)" -ne 0 ]
		then
			rm RAxML*
		fi
        	raxml -f a -T 2 -m PROTGAMMA$RAxMLmodel         	-p 12345 -x 12345 -# 100         	-s ../../per_gene/EOG091G107U/ALICUT_EOG091G107U.clustalo.fasta -n EOG091G107U.clustalo.aln.ALICUT.$RAxMLmodel 		1> ../../per_gene/EOG091G107U/infer_single_ML.stdout.txt 2> ../../per_gene/EOG091G107U/infer_single_ML.stderr.txt
	else
		echo "fasta file per_gene/EOG091G107U/ALICUT_EOG091G107U.clustalo.fasta contains fewer than 5 sequences - skipped" > ../../per_gene/EOG091G107U/infer_single_ML.stdout.txt
		touch raxml.skipped
	fi
        touch ../../per_gene/EOG091G107U/EOG091G107U.raxml.done
        [0m
[Sun Jul  5 22:50:57 2020]
Finished job 1194.
1467 of 3292 steps (45%) done

[Sun Jul  5 22:50:57 2020]
rule infer_single_ML:
    input: per_gene/EOG091G0RT1/EOG091G0RT1.best_model, per_gene/EOG091G0RT1/ALICUT_EOG091G0RT1.clustalo.fasta
    output: per_gene/EOG091G0RT1/EOG091G0RT1.raxml.done
    log: per_gene/EOG091G0RT1/infer_single_ML.stdout.txt, per_gene/EOG091G0RT1/infer_single_ML.stderr.txt
    jobid: 391
    wildcards: BUSCO=EOG091G0RT1
    threads: 2


        cd per_gene/EOG091G0RT1
	count=$(cat ../../per_gene/EOG091G0RT1/ALICUT_EOG091G0RT1.clustalo.fasta | grep ">" | wc -l)
	if [ "$count" -gt 5 ]
        then
		RAxMLmodel=$(cat ../../per_gene/EOG091G0RT1/EOG091G0RT1.best_model | grep "Best" | cut -d ":" -f 2 | tr -d '[:space:]')
                if [ "$(ls -1 | grep "^RAxML" | wc -l)" -ne 0 ]
		then
			rm RAxML*
		fi
        	raxml -f a -T 2 -m PROTGAMMA$RAxMLmodel         	-p 12345 -x 12345 -# 100         	-s ../../per_gene/EOG091G0RT1/ALICUT_EOG091G0RT1.clustalo.fasta -n EOG091G0RT1.clustalo.aln.ALICUT.$RAxMLmodel 		1> ../../per_gene/EOG091G0RT1/infer_single_ML.stdout.txt 2> ../../per_gene/EOG091G0RT1/infer_single_ML.stderr.txt
	else
		echo "fasta file per_gene/EOG091G0RT1/ALICUT_EOG091G0RT1.clustalo.fasta contains fewer than 5 sequences - skipped" > ../../per_gene/EOG091G0RT1/infer_single_ML.stdout.txt
		touch raxml.skipped
	fi
        touch ../../per_gene/EOG091G0RT1/EOG091G0RT1.raxml.done
        
[33mJob counts:
	count	jobs
	1	infer_single_ML
	1[0m
[33m
        cd per_gene/EOG091G0RT1
	count=$(cat ../../per_gene/EOG091G0RT1/ALICUT_EOG091G0RT1.clustalo.fasta | grep ">" | wc -l)
	if [ "$count" -gt 5 ]
        then
		RAxMLmodel=$(cat ../../per_gene/EOG091G0RT1/EOG091G0RT1.best_model | grep "Best" | cut -d ":" -f 2 | tr -d '[:space:]')
                if [ "$(ls -1 | grep "^RAxML" | wc -l)" -ne 0 ]
		then
			rm RAxML*
		fi
        	raxml -f a -T 2 -m PROTGAMMA$RAxMLmodel         	-p 12345 -x 12345 -# 100         	-s ../../per_gene/EOG091G0RT1/ALICUT_EOG091G0RT1.clustalo.fasta -n EOG091G0RT1.clustalo.aln.ALICUT.$RAxMLmodel 		1> ../../per_gene/EOG091G0RT1/infer_single_ML.stdout.txt 2> ../../per_gene/EOG091G0RT1/infer_single_ML.stderr.txt
	else
		echo "fasta file per_gene/EOG091G0RT1/ALICUT_EOG091G0RT1.clustalo.fasta contains fewer than 5 sequences - skipped" > ../../per_gene/EOG091G0RT1/infer_single_ML.stdout.txt
		touch raxml.skipped
	fi
        touch ../../per_gene/EOG091G0RT1/EOG091G0RT1.raxml.done
        [0m
[Sun Jul  5 22:51:06 2020]
Finished job 879.
1468 of 3292 steps (45%) done

[Sun Jul  5 22:51:06 2020]
rule remove_empty:
    input: per_gene/EOG091G15N9/ALICUT_EOG091G15N9.clustalo.fasta
    output: per_gene/EOG091G15N9/empty_check.done
    jobid: 1701
    wildcards: BUSCO=EOG091G15N9


         if [ "$(cat per_gene/EOG091G15N9/ALICUT_EOG091G15N9.clustalo.fasta | grep -v ">" | sed 's/-//g' | grep "^$" | wc -l)" -gt 0 ]
         then
              cp per_gene/EOG091G15N9/ALICUT_EOG091G15N9.clustalo.fasta per_gene/EOG091G15N9/ALICUT_EOG091G15N9.clustalo.fasta.backup
              bash ../scripts/remove_empty.sh per_gene/EOG091G15N9/ALICUT_EOG091G15N9.clustalo.fasta.backup > per_gene/EOG091G15N9/ALICUT_EOG091G15N9.clustalo.fasta
         fi
         touch per_gene/EOG091G15N9/empty_check.done
         
[Sun Jul  5 22:51:13 2020]
Finished job 464.
1469 of 3292 steps (45%) done

[Sun Jul  5 22:51:13 2020]
rule infer_single_ML:
    input: per_gene/EOG091G040G/EOG091G040G.best_model, per_gene/EOG091G040G/ALICUT_EOG091G040G.clustalo.fasta
    output: per_gene/EOG091G040G/EOG091G040G.raxml.done
    log: per_gene/EOG091G040G/infer_single_ML.stdout.txt, per_gene/EOG091G040G/infer_single_ML.stderr.txt
    jobid: 26
    wildcards: BUSCO=EOG091G040G
    threads: 2


        cd per_gene/EOG091G040G
	count=$(cat ../../per_gene/EOG091G040G/ALICUT_EOG091G040G.clustalo.fasta | grep ">" | wc -l)
	if [ "$count" -gt 5 ]
        then
		RAxMLmodel=$(cat ../../per_gene/EOG091G040G/EOG091G040G.best_model | grep "Best" | cut -d ":" -f 2 | tr -d '[:space:]')
                if [ "$(ls -1 | grep "^RAxML" | wc -l)" -ne 0 ]
		then
			rm RAxML*
		fi
        	raxml -f a -T 2 -m PROTGAMMA$RAxMLmodel         	-p 12345 -x 12345 -# 100         	-s ../../per_gene/EOG091G040G/ALICUT_EOG091G040G.clustalo.fasta -n EOG091G040G.clustalo.aln.ALICUT.$RAxMLmodel 		1> ../../per_gene/EOG091G040G/infer_single_ML.stdout.txt 2> ../../per_gene/EOG091G040G/infer_single_ML.stderr.txt
	else
		echo "fasta file per_gene/EOG091G040G/ALICUT_EOG091G040G.clustalo.fasta contains fewer than 5 sequences - skipped" > ../../per_gene/EOG091G040G/infer_single_ML.stdout.txt
		touch raxml.skipped
	fi
        touch ../../per_gene/EOG091G040G/EOG091G040G.raxml.done
        
[Sun Jul  5 22:51:20 2020]
Finished job 460.
1470 of 3292 steps (45%) done

[Sun Jul  5 22:51:20 2020]
rule infer_single_ML:
    input: per_gene/EOG091G03RW/EOG091G03RW.best_model, per_gene/EOG091G03RW/ALICUT_EOG091G03RW.clustalo.fasta
    output: per_gene/EOG091G03RW/EOG091G03RW.raxml.done
    log: per_gene/EOG091G03RW/infer_single_ML.stdout.txt, per_gene/EOG091G03RW/infer_single_ML.stderr.txt
    jobid: 24
    wildcards: BUSCO=EOG091G03RW
    threads: 2


        cd per_gene/EOG091G03RW
	count=$(cat ../../per_gene/EOG091G03RW/ALICUT_EOG091G03RW.clustalo.fasta | grep ">" | wc -l)
	if [ "$count" -gt 5 ]
        then
		RAxMLmodel=$(cat ../../per_gene/EOG091G03RW/EOG091G03RW.best_model | grep "Best" | cut -d ":" -f 2 | tr -d '[:space:]')
                if [ "$(ls -1 | grep "^RAxML" | wc -l)" -ne 0 ]
		then
			rm RAxML*
		fi
        	raxml -f a -T 2 -m PROTGAMMA$RAxMLmodel         	-p 12345 -x 12345 -# 100         	-s ../../per_gene/EOG091G03RW/ALICUT_EOG091G03RW.clustalo.fasta -n EOG091G03RW.clustalo.aln.ALICUT.$RAxMLmodel 		1> ../../per_gene/EOG091G03RW/infer_single_ML.stdout.txt 2> ../../per_gene/EOG091G03RW/infer_single_ML.stderr.txt
	else
		echo "fasta file per_gene/EOG091G03RW/ALICUT_EOG091G03RW.clustalo.fasta contains fewer than 5 sequences - skipped" > ../../per_gene/EOG091G03RW/infer_single_ML.stdout.txt
		touch raxml.skipped
	fi
        touch ../../per_gene/EOG091G03RW/EOG091G03RW.raxml.done
        
[Sun Jul  5 22:51:38 2020]
Finished job 1701.
1471 of 3292 steps (45%) done

[Sun Jul  5 22:51:38 2020]
rule find_best_model:
    input: per_gene/EOG091G15N9/ALICUT_EOG091G15N9.clustalo.fasta, per_gene/EOG091G15N9/empty_check.done
    output: per_gene/EOG091G15N9/EOG091G15N9.best_model
    log: per_gene/EOG091G15N9/find_best_model.stderr.txt
    jobid: 878
    wildcards: BUSCO=EOG091G15N9
    threads: 2


        cd per_gene/EOG091G15N9
        if [ ! -d find_best_model ]
        then
            mkdir find_best_model
        fi
        cd find_best_model
        ln -s ../../../per_gene/EOG091G15N9/ALICUT_EOG091G15N9.clustalo.fasta EOG091G15N9.fasta
        ProteinModelSelection.pl EOG091G15N9.fasta 1> ../../../per_gene/EOG091G15N9/EOG091G15N9.best_model 2> ../../../per_gene/EOG091G15N9/find_best_model.stderr.txt
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/c0c09ee657b1e27f2c5687e0e9aa8d70.simg
[33mJob counts:
	count	jobs
	1	infer_single_ML
	1[0m
[33m
        cd per_gene/EOG091G03RW
	count=$(cat ../../per_gene/EOG091G03RW/ALICUT_EOG091G03RW.clustalo.fasta | grep ">" | wc -l)
	if [ "$count" -gt 5 ]
        then
		RAxMLmodel=$(cat ../../per_gene/EOG091G03RW/EOG091G03RW.best_model | grep "Best" | cut -d ":" -f 2 | tr -d '[:space:]')
                if [ "$(ls -1 | grep "^RAxML" | wc -l)" -ne 0 ]
		then
			rm RAxML*
		fi
        	raxml -f a -T 2 -m PROTGAMMA$RAxMLmodel         	-p 12345 -x 12345 -# 100         	-s ../../per_gene/EOG091G03RW/ALICUT_EOG091G03RW.clustalo.fasta -n EOG091G03RW.clustalo.aln.ALICUT.$RAxMLmodel 		1> ../../per_gene/EOG091G03RW/infer_single_ML.stdout.txt 2> ../../per_gene/EOG091G03RW/infer_single_ML.stderr.txt
	else
		echo "fasta file per_gene/EOG091G03RW/ALICUT_EOG091G03RW.clustalo.fasta contains fewer than 5 sequences - skipped" > ../../per_gene/EOG091G03RW/infer_single_ML.stdout.txt
		touch raxml.skipped
	fi
        touch ../../per_gene/EOG091G03RW/EOG091G03RW.raxml.done
        [0m
[33mJob counts:
	count	jobs
	1	infer_single_ML
	1[0m
[33m
        cd per_gene/EOG091G040G
	count=$(cat ../../per_gene/EOG091G040G/ALICUT_EOG091G040G.clustalo.fasta | grep ">" | wc -l)
	if [ "$count" -gt 5 ]
        then
		RAxMLmodel=$(cat ../../per_gene/EOG091G040G/EOG091G040G.best_model | grep "Best" | cut -d ":" -f 2 | tr -d '[:space:]')
                if [ "$(ls -1 | grep "^RAxML" | wc -l)" -ne 0 ]
		then
			rm RAxML*
		fi
        	raxml -f a -T 2 -m PROTGAMMA$RAxMLmodel         	-p 12345 -x 12345 -# 100         	-s ../../per_gene/EOG091G040G/ALICUT_EOG091G040G.clustalo.fasta -n EOG091G040G.clustalo.aln.ALICUT.$RAxMLmodel 		1> ../../per_gene/EOG091G040G/infer_single_ML.stdout.txt 2> ../../per_gene/EOG091G040G/infer_single_ML.stderr.txt
	else
		echo "fasta file per_gene/EOG091G040G/ALICUT_EOG091G040G.clustalo.fasta contains fewer than 5 sequences - skipped" > ../../per_gene/EOG091G040G/infer_single_ML.stdout.txt
		touch raxml.skipped
	fi
        touch ../../per_gene/EOG091G040G/EOG091G040G.raxml.done
        [0m
[Sun Jul  5 22:51:45 2020]
Finished job 25.
1472 of 3292 steps (45%) done

[Sun Jul  5 22:51:45 2020]
rule get_seqs:
    input: /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ingroup.txt, /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/outgroup.txt
    output: per_gene/EOG091G0W2D/EOG091G0W2D.ingroup.fasta
    log: per_gene/EOG091G0W2D/get_seqs.stdout.txt, per_gene/EOG091G0W2D/get_seqs.stderr.txt
    jobid: 3254
    wildcards: BUSCO=EOG091G0W2D
    threads: 2


	basedir=$(pwd)
        cd per_gene/EOG091G0W2D
        
        bash $basedir/../scripts/fetch_seqs.sh EOG091G0W2D /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ingroup.txt /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/outgroup.txt 1> ../../per_gene/EOG091G0W2D/get_seqs.stdout.txt 2> ../../per_gene/EOG091G0W2D/get_seqs.stderr.txt
	mv EOG091G0W2D.fasta $basedir/per_gene/EOG091G0W2D/EOG091G0W2D.ingroup.fasta
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/72476f9d9a5bd0627b4d721143a21354.simg
[Sun Jul  5 22:51:57 2020]
Finished job 878.
1473 of 3292 steps (45%) done

[Sun Jul  5 22:51:57 2020]
rule infer_single_ML:
    input: per_gene/EOG091G15N9/EOG091G15N9.best_model, per_gene/EOG091G15N9/ALICUT_EOG091G15N9.clustalo.fasta
    output: per_gene/EOG091G15N9/EOG091G15N9.raxml.done
    log: per_gene/EOG091G15N9/infer_single_ML.stdout.txt, per_gene/EOG091G15N9/infer_single_ML.stderr.txt
    jobid: 233
    wildcards: BUSCO=EOG091G15N9
    threads: 2


        cd per_gene/EOG091G15N9
	count=$(cat ../../per_gene/EOG091G15N9/ALICUT_EOG091G15N9.clustalo.fasta | grep ">" | wc -l)
	if [ "$count" -gt 5 ]
        then
		RAxMLmodel=$(cat ../../per_gene/EOG091G15N9/EOG091G15N9.best_model | grep "Best" | cut -d ":" -f 2 | tr -d '[:space:]')
                if [ "$(ls -1 | grep "^RAxML" | wc -l)" -ne 0 ]
		then
			rm RAxML*
		fi
        	raxml -f a -T 2 -m PROTGAMMA$RAxMLmodel         	-p 12345 -x 12345 -# 100         	-s ../../per_gene/EOG091G15N9/ALICUT_EOG091G15N9.clustalo.fasta -n EOG091G15N9.clustalo.aln.ALICUT.$RAxMLmodel 		1> ../../per_gene/EOG091G15N9/infer_single_ML.stdout.txt 2> ../../per_gene/EOG091G15N9/infer_single_ML.stderr.txt
	else
		echo "fasta file per_gene/EOG091G15N9/ALICUT_EOG091G15N9.clustalo.fasta contains fewer than 5 sequences - skipped" > ../../per_gene/EOG091G15N9/infer_single_ML.stdout.txt
		touch raxml.skipped
	fi
        touch ../../per_gene/EOG091G15N9/EOG091G15N9.raxml.done
        
[Sun Jul  5 22:51:57 2020]
Finished job 3254.
1474 of 3292 steps (45%) done

[Sun Jul  5 22:51:57 2020]
rule get_outgroups:
    input: per_gene/EOG091G0W2D/EOG091G0W2D.ingroup.fasta
    output: per_gene/EOG091G0W2D/EOG091G0W2D.orthodb.fasta, per_gene/EOG091G0W2D/EOG091G0W2D.outgroup.fasta
    log: per_gene/EOG091G0W2D/get_outgroups.stdout.txt, per_gene/EOG091G0W2D/get_outgroups.stderr.txt
    jobid: 3255
    wildcards: BUSCO=EOG091G0W2D


        #download fastas from Orhtodb for BUSCO id
        for i in {1..5}
        do
             wget "http://www.orthodb.org/fasta?query=EOG091G0W2D&level=33208" -O per_gene/EOG091G0W2D/EOG091G0W2D.orthodb.fasta 1> per_gene/EOG091G0W2D/get_outgroups.stdout.txt 2> per_gene/EOG091G0W2D/get_outgroups.stderr.txt && break || echo -e "try again ($i)" && sleep 15
        done

	#This is quick an dirty for now and just takes the first protein if there is more than one for an outgroup taxon
        bash ../scripts/download_outgroups.sh taxids.txt per_gene/EOG091G0W2D/EOG091G0W2D.orthodb.fasta > per_gene/EOG091G0W2D/EOG091G0W2D.outgroup.fasta
        
[Sun Jul  5 22:51:58 2020]
Finished job 3255.
1475 of 3292 steps (45%) done

[Sun Jul  5 22:51:58 2020]
rule join_groups:
    input: per_gene/EOG091G0W2D/EOG091G0W2D.ingroup.fasta, per_gene/EOG091G0W2D/EOG091G0W2D.outgroup.fasta
    output: per_gene/EOG091G0W2D/EOG091G0W2D.fasta
    jobid: 2451
    wildcards: BUSCO=EOG091G0W2D


        cat per_gene/EOG091G0W2D/EOG091G0W2D.ingroup.fasta per_gene/EOG091G0W2D/EOG091G0W2D.outgroup.fasta > per_gene/EOG091G0W2D/EOG091G0W2D.fasta
        
[Sun Jul  5 22:51:58 2020]
Finished job 2451.
1476 of 3292 steps (45%) done

[Sun Jul  5 22:51:58 2020]
rule MSA:
    input: per_gene/EOG091G0W2D/EOG091G0W2D.fasta
    output: per_gene/EOG091G0W2D/EOG091G0W2D.clustalo.fasta
    log: per_gene/EOG091G0W2D/MSA.stdout.txt, per_gene/EOG091G0W2D/MSA.stderr.txt
    jobid: 2022
    wildcards: BUSCO=EOG091G0W2D
    threads: 2


        clustalo -i per_gene/EOG091G0W2D/EOG091G0W2D.fasta -o per_gene/EOG091G0W2D/EOG091G0W2D.clustalo.fasta --threads=2 1> per_gene/EOG091G0W2D/MSA.stdout.txt 2> per_gene/EOG091G0W2D/MSA.stderr.txt
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/d68c9691725a7401923680874285c430.simg
[Sun Jul  5 22:51:59 2020]
Finished job 2022.
1477 of 3292 steps (45%) done

[Sun Jul  5 22:51:59 2020]
rule score_and_cut:
    input: per_gene/EOG091G0W2D/EOG091G0W2D.clustalo.fasta
    output: per_gene/EOG091G0W2D/ALICUT_EOG091G0W2D.clustalo.fasta
    jobid: 1199
    wildcards: BUSCO=EOG091G0W2D
    threads: 2


        cd per_gene/EOG091G0W2D
        Aliscore.pl -N -r 200000000000000000 -i ../../per_gene/EOG091G0W2D/EOG091G0W2D.clustalo.fasta &> aliscore.log
        ALICUT.pl -s &> alicut.log
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/63c88c27a0fa300f57066b0ef65fefcb.simg
[33mJob counts:
	count	jobs
	1	infer_single_ML
	1[0m
[33m
        cd per_gene/EOG091G15N9
	count=$(cat ../../per_gene/EOG091G15N9/ALICUT_EOG091G15N9.clustalo.fasta | grep ">" | wc -l)
	if [ "$count" -gt 5 ]
        then
		RAxMLmodel=$(cat ../../per_gene/EOG091G15N9/EOG091G15N9.best_model | grep "Best" | cut -d ":" -f 2 | tr -d '[:space:]')
                if [ "$(ls -1 | grep "^RAxML" | wc -l)" -ne 0 ]
		then
			rm RAxML*
		fi
        	raxml -f a -T 2 -m PROTGAMMA$RAxMLmodel         	-p 12345 -x 12345 -# 100         	-s ../../per_gene/EOG091G15N9/ALICUT_EOG091G15N9.clustalo.fasta -n EOG091G15N9.clustalo.aln.ALICUT.$RAxMLmodel 		1> ../../per_gene/EOG091G15N9/infer_single_ML.stdout.txt 2> ../../per_gene/EOG091G15N9/infer_single_ML.stderr.txt
	else
		echo "fasta file per_gene/EOG091G15N9/ALICUT_EOG091G15N9.clustalo.fasta contains fewer than 5 sequences - skipped" > ../../per_gene/EOG091G15N9/infer_single_ML.stdout.txt
		touch raxml.skipped
	fi
        touch ../../per_gene/EOG091G15N9/EOG091G15N9.raxml.done
        [0m
[Sun Jul  5 22:52:08 2020]
Finished job 1199.
1478 of 3292 steps (45%) done

[Sun Jul  5 22:52:08 2020]
rule remove_empty:
    input: per_gene/EOG091G0W2D/ALICUT_EOG091G0W2D.clustalo.fasta
    output: per_gene/EOG091G0W2D/empty_check.done
    jobid: 2021
    wildcards: BUSCO=EOG091G0W2D


         if [ "$(cat per_gene/EOG091G0W2D/ALICUT_EOG091G0W2D.clustalo.fasta | grep -v ">" | sed 's/-//g' | grep "^$" | wc -l)" -gt 0 ]
         then
              cp per_gene/EOG091G0W2D/ALICUT_EOG091G0W2D.clustalo.fasta per_gene/EOG091G0W2D/ALICUT_EOG091G0W2D.clustalo.fasta.backup
              bash ../scripts/remove_empty.sh per_gene/EOG091G0W2D/ALICUT_EOG091G0W2D.clustalo.fasta.backup > per_gene/EOG091G0W2D/ALICUT_EOG091G0W2D.clustalo.fasta
         fi
         touch per_gene/EOG091G0W2D/empty_check.done
         
[Sun Jul  5 22:52:08 2020]
Finished job 2021.
1479 of 3292 steps (45%) done

[Sun Jul  5 22:52:08 2020]
rule find_best_model:
    input: per_gene/EOG091G0W2D/ALICUT_EOG091G0W2D.clustalo.fasta, per_gene/EOG091G0W2D/empty_check.done
    output: per_gene/EOG091G0W2D/EOG091G0W2D.best_model
    log: per_gene/EOG091G0W2D/find_best_model.stderr.txt
    jobid: 1198
    wildcards: BUSCO=EOG091G0W2D
    threads: 2


        cd per_gene/EOG091G0W2D
        if [ ! -d find_best_model ]
        then
            mkdir find_best_model
        fi
        cd find_best_model
        ln -s ../../../per_gene/EOG091G0W2D/ALICUT_EOG091G0W2D.clustalo.fasta EOG091G0W2D.fasta
        ProteinModelSelection.pl EOG091G0W2D.fasta 1> ../../../per_gene/EOG091G0W2D/EOG091G0W2D.best_model 2> ../../../per_gene/EOG091G0W2D/find_best_model.stderr.txt
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/c0c09ee657b1e27f2c5687e0e9aa8d70.simg
[Sun Jul  5 22:52:37 2020]
Finished job 1198.
1480 of 3292 steps (45%) done

[Sun Jul  5 22:52:37 2020]
rule infer_single_ML:
    input: per_gene/EOG091G0W2D/EOG091G0W2D.best_model, per_gene/EOG091G0W2D/ALICUT_EOG091G0W2D.clustalo.fasta
    output: per_gene/EOG091G0W2D/EOG091G0W2D.raxml.done
    log: per_gene/EOG091G0W2D/infer_single_ML.stdout.txt, per_gene/EOG091G0W2D/infer_single_ML.stderr.txt
    jobid: 393
    wildcards: BUSCO=EOG091G0W2D
    threads: 2


        cd per_gene/EOG091G0W2D
	count=$(cat ../../per_gene/EOG091G0W2D/ALICUT_EOG091G0W2D.clustalo.fasta | grep ">" | wc -l)
	if [ "$count" -gt 5 ]
        then
		RAxMLmodel=$(cat ../../per_gene/EOG091G0W2D/EOG091G0W2D.best_model | grep "Best" | cut -d ":" -f 2 | tr -d '[:space:]')
                if [ "$(ls -1 | grep "^RAxML" | wc -l)" -ne 0 ]
		then
			rm RAxML*
		fi
        	raxml -f a -T 2 -m PROTGAMMA$RAxMLmodel         	-p 12345 -x 12345 -# 100         	-s ../../per_gene/EOG091G0W2D/ALICUT_EOG091G0W2D.clustalo.fasta -n EOG091G0W2D.clustalo.aln.ALICUT.$RAxMLmodel 		1> ../../per_gene/EOG091G0W2D/infer_single_ML.stdout.txt 2> ../../per_gene/EOG091G0W2D/infer_single_ML.stderr.txt
	else
		echo "fasta file per_gene/EOG091G0W2D/ALICUT_EOG091G0W2D.clustalo.fasta contains fewer than 5 sequences - skipped" > ../../per_gene/EOG091G0W2D/infer_single_ML.stdout.txt
		touch raxml.skipped
	fi
        touch ../../per_gene/EOG091G0W2D/EOG091G0W2D.raxml.done
        
[33mJob counts:
	count	jobs
	1	infer_single_ML
	1[0m
[33m
        cd per_gene/EOG091G0W2D
	count=$(cat ../../per_gene/EOG091G0W2D/ALICUT_EOG091G0W2D.clustalo.fasta | grep ">" | wc -l)
	if [ "$count" -gt 5 ]
        then
		RAxMLmodel=$(cat ../../per_gene/EOG091G0W2D/EOG091G0W2D.best_model | grep "Best" | cut -d ":" -f 2 | tr -d '[:space:]')
                if [ "$(ls -1 | grep "^RAxML" | wc -l)" -ne 0 ]
		then
			rm RAxML*
		fi
        	raxml -f a -T 2 -m PROTGAMMA$RAxMLmodel         	-p 12345 -x 12345 -# 100         	-s ../../per_gene/EOG091G0W2D/ALICUT_EOG091G0W2D.clustalo.fasta -n EOG091G0W2D.clustalo.aln.ALICUT.$RAxMLmodel 		1> ../../per_gene/EOG091G0W2D/infer_single_ML.stdout.txt 2> ../../per_gene/EOG091G0W2D/infer_single_ML.stderr.txt
	else
		echo "fasta file per_gene/EOG091G0W2D/ALICUT_EOG091G0W2D.clustalo.fasta contains fewer than 5 sequences - skipped" > ../../per_gene/EOG091G0W2D/infer_single_ML.stdout.txt
		touch raxml.skipped
	fi
        touch ../../per_gene/EOG091G0W2D/EOG091G0W2D.raxml.done
        [0m
[Sun Jul  5 22:53:38 2020]
Finished job 286.
1481 of 3292 steps (45%) done

[Sun Jul  5 22:53:38 2020]
rule get_seqs:
    input: /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ingroup.txt, /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/outgroup.txt
    output: per_gene/EOG091G0HXI/EOG091G0HXI.ingroup.fasta
    log: per_gene/EOG091G0HXI/get_seqs.stdout.txt, per_gene/EOG091G0HXI/get_seqs.stderr.txt
    jobid: 2706
    wildcards: BUSCO=EOG091G0HXI
    threads: 2


	basedir=$(pwd)
        cd per_gene/EOG091G0HXI
        
        bash $basedir/../scripts/fetch_seqs.sh EOG091G0HXI /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ingroup.txt /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/outgroup.txt 1> ../../per_gene/EOG091G0HXI/get_seqs.stdout.txt 2> ../../per_gene/EOG091G0HXI/get_seqs.stderr.txt
	mv EOG091G0HXI.fasta $basedir/per_gene/EOG091G0HXI/EOG091G0HXI.ingroup.fasta
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/72476f9d9a5bd0627b4d721143a21354.simg
[Sun Jul  5 22:53:50 2020]
Finished job 189.
1482 of 3292 steps (45%) done

[Sun Jul  5 22:53:50 2020]
rule get_seqs:
    input: /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ingroup.txt, /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/outgroup.txt
    output: per_gene/EOG091G113O/EOG091G113O.ingroup.fasta
    log: per_gene/EOG091G113O/get_seqs.stdout.txt, per_gene/EOG091G113O/get_seqs.stderr.txt
    jobid: 2916
    wildcards: BUSCO=EOG091G113O
    threads: 2


	basedir=$(pwd)
        cd per_gene/EOG091G113O
        
        bash $basedir/../scripts/fetch_seqs.sh EOG091G113O /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ingroup.txt /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/outgroup.txt 1> ../../per_gene/EOG091G113O/get_seqs.stdout.txt 2> ../../per_gene/EOG091G113O/get_seqs.stderr.txt
	mv EOG091G113O.fasta $basedir/per_gene/EOG091G113O/EOG091G113O.ingroup.fasta
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/72476f9d9a5bd0627b4d721143a21354.simg
[Sun Jul  5 22:53:54 2020]
Finished job 2706.
1483 of 3292 steps (45%) done

[Sun Jul  5 22:53:54 2020]
rule get_outgroups:
    input: per_gene/EOG091G0HXI/EOG091G0HXI.ingroup.fasta
    output: per_gene/EOG091G0HXI/EOG091G0HXI.orthodb.fasta, per_gene/EOG091G0HXI/EOG091G0HXI.outgroup.fasta
    log: per_gene/EOG091G0HXI/get_outgroups.stdout.txt, per_gene/EOG091G0HXI/get_outgroups.stderr.txt
    jobid: 2707
    wildcards: BUSCO=EOG091G0HXI


        #download fastas from Orhtodb for BUSCO id
        for i in {1..5}
        do
             wget "http://www.orthodb.org/fasta?query=EOG091G0HXI&level=33208" -O per_gene/EOG091G0HXI/EOG091G0HXI.orthodb.fasta 1> per_gene/EOG091G0HXI/get_outgroups.stdout.txt 2> per_gene/EOG091G0HXI/get_outgroups.stderr.txt && break || echo -e "try again ($i)" && sleep 15
        done

	#This is quick an dirty for now and just takes the first protein if there is more than one for an outgroup taxon
        bash ../scripts/download_outgroups.sh taxids.txt per_gene/EOG091G0HXI/EOG091G0HXI.orthodb.fasta > per_gene/EOG091G0HXI/EOG091G0HXI.outgroup.fasta
        
[Sun Jul  5 22:53:55 2020]
Finished job 2707.
1484 of 3292 steps (45%) done

[Sun Jul  5 22:53:55 2020]
rule join_groups:
    input: per_gene/EOG091G0HXI/EOG091G0HXI.ingroup.fasta, per_gene/EOG091G0HXI/EOG091G0HXI.outgroup.fasta
    output: per_gene/EOG091G0HXI/EOG091G0HXI.fasta
    jobid: 2177
    wildcards: BUSCO=EOG091G0HXI


        cat per_gene/EOG091G0HXI/EOG091G0HXI.ingroup.fasta per_gene/EOG091G0HXI/EOG091G0HXI.outgroup.fasta > per_gene/EOG091G0HXI/EOG091G0HXI.fasta
        
[Sun Jul  5 22:53:55 2020]
Finished job 2177.
1485 of 3292 steps (45%) done

[Sun Jul  5 22:53:55 2020]
rule MSA:
    input: per_gene/EOG091G0HXI/EOG091G0HXI.fasta
    output: per_gene/EOG091G0HXI/EOG091G0HXI.clustalo.fasta
    log: per_gene/EOG091G0HXI/MSA.stdout.txt, per_gene/EOG091G0HXI/MSA.stderr.txt
    jobid: 1474
    wildcards: BUSCO=EOG091G0HXI
    threads: 2


        clustalo -i per_gene/EOG091G0HXI/EOG091G0HXI.fasta -o per_gene/EOG091G0HXI/EOG091G0HXI.clustalo.fasta --threads=2 1> per_gene/EOG091G0HXI/MSA.stdout.txt 2> per_gene/EOG091G0HXI/MSA.stderr.txt
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/d68c9691725a7401923680874285c430.simg
[Sun Jul  5 22:53:56 2020]
Finished job 1474.
1486 of 3292 steps (45%) done

[Sun Jul  5 22:53:56 2020]
rule score_and_cut:
    input: per_gene/EOG091G0HXI/EOG091G0HXI.clustalo.fasta
    output: per_gene/EOG091G0HXI/ALICUT_EOG091G0HXI.clustalo.fasta
    jobid: 651
    wildcards: BUSCO=EOG091G0HXI
    threads: 2


        cd per_gene/EOG091G0HXI
        Aliscore.pl -N -r 200000000000000000 -i ../../per_gene/EOG091G0HXI/EOG091G0HXI.clustalo.fasta &> aliscore.log
        ALICUT.pl -s &> alicut.log
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/63c88c27a0fa300f57066b0ef65fefcb.simg
[Sun Jul  5 22:54:07 2020]
Finished job 651.
1487 of 3292 steps (45%) done

[Sun Jul  5 22:54:07 2020]
rule remove_empty:
    input: per_gene/EOG091G0HXI/ALICUT_EOG091G0HXI.clustalo.fasta
    output: per_gene/EOG091G0HXI/empty_check.done
    jobid: 1473
    wildcards: BUSCO=EOG091G0HXI


         if [ "$(cat per_gene/EOG091G0HXI/ALICUT_EOG091G0HXI.clustalo.fasta | grep -v ">" | sed 's/-//g' | grep "^$" | wc -l)" -gt 0 ]
         then
              cp per_gene/EOG091G0HXI/ALICUT_EOG091G0HXI.clustalo.fasta per_gene/EOG091G0HXI/ALICUT_EOG091G0HXI.clustalo.fasta.backup
              bash ../scripts/remove_empty.sh per_gene/EOG091G0HXI/ALICUT_EOG091G0HXI.clustalo.fasta.backup > per_gene/EOG091G0HXI/ALICUT_EOG091G0HXI.clustalo.fasta
         fi
         touch per_gene/EOG091G0HXI/empty_check.done
         
[Sun Jul  5 22:54:07 2020]
Finished job 1473.
1488 of 3292 steps (45%) done

[Sun Jul  5 22:54:07 2020]
rule find_best_model:
    input: per_gene/EOG091G0HXI/ALICUT_EOG091G0HXI.clustalo.fasta, per_gene/EOG091G0HXI/empty_check.done
    output: per_gene/EOG091G0HXI/EOG091G0HXI.best_model
    log: per_gene/EOG091G0HXI/find_best_model.stderr.txt
    jobid: 650
    wildcards: BUSCO=EOG091G0HXI
    threads: 2


        cd per_gene/EOG091G0HXI
        if [ ! -d find_best_model ]
        then
            mkdir find_best_model
        fi
        cd find_best_model
        ln -s ../../../per_gene/EOG091G0HXI/ALICUT_EOG091G0HXI.clustalo.fasta EOG091G0HXI.fasta
        ProteinModelSelection.pl EOG091G0HXI.fasta 1> ../../../per_gene/EOG091G0HXI/EOG091G0HXI.best_model 2> ../../../per_gene/EOG091G0HXI/find_best_model.stderr.txt
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/c0c09ee657b1e27f2c5687e0e9aa8d70.simg
[Sun Jul  5 22:54:07 2020]
Finished job 2916.
1489 of 3292 steps (45%) done

[Sun Jul  5 22:54:07 2020]
rule get_outgroups:
    input: per_gene/EOG091G113O/EOG091G113O.ingroup.fasta
    output: per_gene/EOG091G113O/EOG091G113O.orthodb.fasta, per_gene/EOG091G113O/EOG091G113O.outgroup.fasta
    log: per_gene/EOG091G113O/get_outgroups.stdout.txt, per_gene/EOG091G113O/get_outgroups.stderr.txt
    jobid: 2917
    wildcards: BUSCO=EOG091G113O


        #download fastas from Orhtodb for BUSCO id
        for i in {1..5}
        do
             wget "http://www.orthodb.org/fasta?query=EOG091G113O&level=33208" -O per_gene/EOG091G113O/EOG091G113O.orthodb.fasta 1> per_gene/EOG091G113O/get_outgroups.stdout.txt 2> per_gene/EOG091G113O/get_outgroups.stderr.txt && break || echo -e "try again ($i)" && sleep 15
        done

	#This is quick an dirty for now and just takes the first protein if there is more than one for an outgroup taxon
        bash ../scripts/download_outgroups.sh taxids.txt per_gene/EOG091G113O/EOG091G113O.orthodb.fasta > per_gene/EOG091G113O/EOG091G113O.outgroup.fasta
        
[Sun Jul  5 22:54:08 2020]
Finished job 2917.
1490 of 3292 steps (45%) done

[Sun Jul  5 22:54:08 2020]
rule join_groups:
    input: per_gene/EOG091G113O/EOG091G113O.ingroup.fasta, per_gene/EOG091G113O/EOG091G113O.outgroup.fasta
    output: per_gene/EOG091G113O/EOG091G113O.fasta
    jobid: 2282
    wildcards: BUSCO=EOG091G113O


        cat per_gene/EOG091G113O/EOG091G113O.ingroup.fasta per_gene/EOG091G113O/EOG091G113O.outgroup.fasta > per_gene/EOG091G113O/EOG091G113O.fasta
        
[Sun Jul  5 22:54:08 2020]
Finished job 2282.
1491 of 3292 steps (45%) done

[Sun Jul  5 22:54:08 2020]
rule MSA:
    input: per_gene/EOG091G113O/EOG091G113O.fasta
    output: per_gene/EOG091G113O/EOG091G113O.clustalo.fasta
    log: per_gene/EOG091G113O/MSA.stdout.txt, per_gene/EOG091G113O/MSA.stderr.txt
    jobid: 1684
    wildcards: BUSCO=EOG091G113O
    threads: 2


        clustalo -i per_gene/EOG091G113O/EOG091G113O.fasta -o per_gene/EOG091G113O/EOG091G113O.clustalo.fasta --threads=2 1> per_gene/EOG091G113O/MSA.stdout.txt 2> per_gene/EOG091G113O/MSA.stderr.txt
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/d68c9691725a7401923680874285c430.simg
[Sun Jul  5 22:54:08 2020]
Finished job 1684.
1492 of 3292 steps (45%) done

[Sun Jul  5 22:54:08 2020]
rule score_and_cut:
    input: per_gene/EOG091G113O/EOG091G113O.clustalo.fasta
    output: per_gene/EOG091G113O/ALICUT_EOG091G113O.clustalo.fasta
    jobid: 861
    wildcards: BUSCO=EOG091G113O
    threads: 2


        cd per_gene/EOG091G113O
        Aliscore.pl -N -r 200000000000000000 -i ../../per_gene/EOG091G113O/EOG091G113O.clustalo.fasta &> aliscore.log
        ALICUT.pl -s &> alicut.log
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/63c88c27a0fa300f57066b0ef65fefcb.simg
[Sun Jul  5 22:54:18 2020]
Finished job 861.
1493 of 3292 steps (45%) done

[Sun Jul  5 22:54:18 2020]
rule remove_empty:
    input: per_gene/EOG091G113O/ALICUT_EOG091G113O.clustalo.fasta
    output: per_gene/EOG091G113O/empty_check.done
    jobid: 1683
    wildcards: BUSCO=EOG091G113O


         if [ "$(cat per_gene/EOG091G113O/ALICUT_EOG091G113O.clustalo.fasta | grep -v ">" | sed 's/-//g' | grep "^$" | wc -l)" -gt 0 ]
         then
              cp per_gene/EOG091G113O/ALICUT_EOG091G113O.clustalo.fasta per_gene/EOG091G113O/ALICUT_EOG091G113O.clustalo.fasta.backup
              bash ../scripts/remove_empty.sh per_gene/EOG091G113O/ALICUT_EOG091G113O.clustalo.fasta.backup > per_gene/EOG091G113O/ALICUT_EOG091G113O.clustalo.fasta
         fi
         touch per_gene/EOG091G113O/empty_check.done
         
[Sun Jul  5 22:54:18 2020]
Finished job 1683.
1494 of 3292 steps (45%) done

[Sun Jul  5 22:54:18 2020]
rule find_best_model:
    input: per_gene/EOG091G113O/ALICUT_EOG091G113O.clustalo.fasta, per_gene/EOG091G113O/empty_check.done
    output: per_gene/EOG091G113O/EOG091G113O.best_model
    log: per_gene/EOG091G113O/find_best_model.stderr.txt
    jobid: 860
    wildcards: BUSCO=EOG091G113O
    threads: 2


        cd per_gene/EOG091G113O
        if [ ! -d find_best_model ]
        then
            mkdir find_best_model
        fi
        cd find_best_model
        ln -s ../../../per_gene/EOG091G113O/ALICUT_EOG091G113O.clustalo.fasta EOG091G113O.fasta
        ProteinModelSelection.pl EOG091G113O.fasta 1> ../../../per_gene/EOG091G113O/EOG091G113O.best_model 2> ../../../per_gene/EOG091G113O/find_best_model.stderr.txt
        
[Sun Jul  5 22:54:18 2020]
Finished job 233.
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/c0c09ee657b1e27f2c5687e0e9aa8d70.simg
1495 of 3292 steps (45%) done

[Sun Jul  5 22:54:18 2020]
rule get_seqs:
    input: /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ingroup.txt, /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/outgroup.txt
    output: per_gene/EOG091G0SBR/EOG091G0SBR.ingroup.fasta
    log: per_gene/EOG091G0SBR/get_seqs.stdout.txt, per_gene/EOG091G0SBR/get_seqs.stderr.txt
    jobid: 2844
    wildcards: BUSCO=EOG091G0SBR
    threads: 2


	basedir=$(pwd)
        cd per_gene/EOG091G0SBR
        
        bash $basedir/../scripts/fetch_seqs.sh EOG091G0SBR /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ingroup.txt /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/outgroup.txt 1> ../../per_gene/EOG091G0SBR/get_seqs.stdout.txt 2> ../../per_gene/EOG091G0SBR/get_seqs.stderr.txt
	mv EOG091G0SBR.fasta $basedir/per_gene/EOG091G0SBR/EOG091G0SBR.ingroup.fasta
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/72476f9d9a5bd0627b4d721143a21354.simg
[Sun Jul  5 22:54:31 2020]
Finished job 302.
1496 of 3292 steps (45%) done

[Sun Jul  5 22:54:31 2020]
rule get_seqs:
    input: /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ingroup.txt, /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/outgroup.txt
    output: per_gene/EOG091G073F/EOG091G073F.ingroup.fasta
    log: per_gene/EOG091G073F/get_seqs.stdout.txt, per_gene/EOG091G073F/get_seqs.stderr.txt
    jobid: 2570
    wildcards: BUSCO=EOG091G073F
    threads: 2


	basedir=$(pwd)
        cd per_gene/EOG091G073F
        
        bash $basedir/../scripts/fetch_seqs.sh EOG091G073F /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ingroup.txt /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/outgroup.txt 1> ../../per_gene/EOG091G073F/get_seqs.stdout.txt 2> ../../per_gene/EOG091G073F/get_seqs.stderr.txt
	mv EOG091G073F.fasta $basedir/per_gene/EOG091G073F/EOG091G073F.ingroup.fasta
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/72476f9d9a5bd0627b4d721143a21354.simg
[Sun Jul  5 22:54:36 2020]
Finished job 2844.
1497 of 3292 steps (45%) done

[Sun Jul  5 22:54:36 2020]
rule get_outgroups:
    input: per_gene/EOG091G0SBR/EOG091G0SBR.ingroup.fasta
    output: per_gene/EOG091G0SBR/EOG091G0SBR.orthodb.fasta, per_gene/EOG091G0SBR/EOG091G0SBR.outgroup.fasta
    log: per_gene/EOG091G0SBR/get_outgroups.stdout.txt, per_gene/EOG091G0SBR/get_outgroups.stderr.txt
    jobid: 2845
    wildcards: BUSCO=EOG091G0SBR


        #download fastas from Orhtodb for BUSCO id
        for i in {1..5}
        do
             wget "http://www.orthodb.org/fasta?query=EOG091G0SBR&level=33208" -O per_gene/EOG091G0SBR/EOG091G0SBR.orthodb.fasta 1> per_gene/EOG091G0SBR/get_outgroups.stdout.txt 2> per_gene/EOG091G0SBR/get_outgroups.stderr.txt && break || echo -e "try again ($i)" && sleep 15
        done

	#This is quick an dirty for now and just takes the first protein if there is more than one for an outgroup taxon
        bash ../scripts/download_outgroups.sh taxids.txt per_gene/EOG091G0SBR/EOG091G0SBR.orthodb.fasta > per_gene/EOG091G0SBR/EOG091G0SBR.outgroup.fasta
        
[Sun Jul  5 22:54:37 2020]
Finished job 2845.
1498 of 3292 steps (46%) done

[Sun Jul  5 22:54:37 2020]
rule join_groups:
    input: per_gene/EOG091G0SBR/EOG091G0SBR.ingroup.fasta, per_gene/EOG091G0SBR/EOG091G0SBR.outgroup.fasta
    output: per_gene/EOG091G0SBR/EOG091G0SBR.fasta
    jobid: 2246
    wildcards: BUSCO=EOG091G0SBR


        cat per_gene/EOG091G0SBR/EOG091G0SBR.ingroup.fasta per_gene/EOG091G0SBR/EOG091G0SBR.outgroup.fasta > per_gene/EOG091G0SBR/EOG091G0SBR.fasta
        
[Sun Jul  5 22:54:37 2020]
Finished job 2246.
1499 of 3292 steps (46%) done

[Sun Jul  5 22:54:37 2020]
rule MSA:
    input: per_gene/EOG091G0SBR/EOG091G0SBR.fasta
    output: per_gene/EOG091G0SBR/EOG091G0SBR.clustalo.fasta
    log: per_gene/EOG091G0SBR/MSA.stdout.txt, per_gene/EOG091G0SBR/MSA.stderr.txt
    jobid: 1612
    wildcards: BUSCO=EOG091G0SBR
    threads: 2


        clustalo -i per_gene/EOG091G0SBR/EOG091G0SBR.fasta -o per_gene/EOG091G0SBR/EOG091G0SBR.clustalo.fasta --threads=2 1> per_gene/EOG091G0SBR/MSA.stdout.txt 2> per_gene/EOG091G0SBR/MSA.stderr.txt
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/d68c9691725a7401923680874285c430.simg
[Sun Jul  5 22:54:37 2020]
Finished job 1612.
1500 of 3292 steps (46%) done

[Sun Jul  5 22:54:37 2020]
rule score_and_cut:
    input: per_gene/EOG091G0SBR/EOG091G0SBR.clustalo.fasta
    output: per_gene/EOG091G0SBR/ALICUT_EOG091G0SBR.clustalo.fasta
    jobid: 789
    wildcards: BUSCO=EOG091G0SBR
    threads: 2


        cd per_gene/EOG091G0SBR
        Aliscore.pl -N -r 200000000000000000 -i ../../per_gene/EOG091G0SBR/EOG091G0SBR.clustalo.fasta &> aliscore.log
        ALICUT.pl -s &> alicut.log
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/63c88c27a0fa300f57066b0ef65fefcb.simg
[Sun Jul  5 22:54:42 2020]
Finished job 650.
1501 of 3292 steps (46%) done

[Sun Jul  5 22:54:42 2020]
rule infer_single_ML:
    input: per_gene/EOG091G0HXI/EOG091G0HXI.best_model, per_gene/EOG091G0HXI/ALICUT_EOG091G0HXI.clustalo.fasta
    output: per_gene/EOG091G0HXI/EOG091G0HXI.raxml.done
    log: per_gene/EOG091G0HXI/infer_single_ML.stdout.txt, per_gene/EOG091G0HXI/infer_single_ML.stderr.txt
    jobid: 119
    wildcards: BUSCO=EOG091G0HXI
    threads: 2


        cd per_gene/EOG091G0HXI
	count=$(cat ../../per_gene/EOG091G0HXI/ALICUT_EOG091G0HXI.clustalo.fasta | grep ">" | wc -l)
	if [ "$count" -gt 5 ]
        then
		RAxMLmodel=$(cat ../../per_gene/EOG091G0HXI/EOG091G0HXI.best_model | grep "Best" | cut -d ":" -f 2 | tr -d '[:space:]')
                if [ "$(ls -1 | grep "^RAxML" | wc -l)" -ne 0 ]
		then
			rm RAxML*
		fi
        	raxml -f a -T 2 -m PROTGAMMA$RAxMLmodel         	-p 12345 -x 12345 -# 100         	-s ../../per_gene/EOG091G0HXI/ALICUT_EOG091G0HXI.clustalo.fasta -n EOG091G0HXI.clustalo.aln.ALICUT.$RAxMLmodel 		1> ../../per_gene/EOG091G0HXI/infer_single_ML.stdout.txt 2> ../../per_gene/EOG091G0HXI/infer_single_ML.stderr.txt
	else
		echo "fasta file per_gene/EOG091G0HXI/ALICUT_EOG091G0HXI.clustalo.fasta contains fewer than 5 sequences - skipped" > ../../per_gene/EOG091G0HXI/infer_single_ML.stdout.txt
		touch raxml.skipped
	fi
        touch ../../per_gene/EOG091G0HXI/EOG091G0HXI.raxml.done
        
[33mJob counts:
	count	jobs
	1	infer_single_ML
	1[0m
[33m
        cd per_gene/EOG091G0HXI
	count=$(cat ../../per_gene/EOG091G0HXI/ALICUT_EOG091G0HXI.clustalo.fasta | grep ">" | wc -l)
	if [ "$count" -gt 5 ]
        then
		RAxMLmodel=$(cat ../../per_gene/EOG091G0HXI/EOG091G0HXI.best_model | grep "Best" | cut -d ":" -f 2 | tr -d '[:space:]')
                if [ "$(ls -1 | grep "^RAxML" | wc -l)" -ne 0 ]
		then
			rm RAxML*
		fi
        	raxml -f a -T 2 -m PROTGAMMA$RAxMLmodel         	-p 12345 -x 12345 -# 100         	-s ../../per_gene/EOG091G0HXI/ALICUT_EOG091G0HXI.clustalo.fasta -n EOG091G0HXI.clustalo.aln.ALICUT.$RAxMLmodel 		1> ../../per_gene/EOG091G0HXI/infer_single_ML.stdout.txt 2> ../../per_gene/EOG091G0HXI/infer_single_ML.stderr.txt
	else
		echo "fasta file per_gene/EOG091G0HXI/ALICUT_EOG091G0HXI.clustalo.fasta contains fewer than 5 sequences - skipped" > ../../per_gene/EOG091G0HXI/infer_single_ML.stdout.txt
		touch raxml.skipped
	fi
        touch ../../per_gene/EOG091G0HXI/EOG091G0HXI.raxml.done
        [0m
[Sun Jul  5 22:54:46 2020]
Finished job 2570.
1502 of 3292 steps (46%) done
[Sun Jul  5 22:54:46 2020]
Finished job 860.
1503 of 3292 steps (46%) done

[Sun Jul  5 22:54:46 2020]
rule get_outgroups:
    input: per_gene/EOG091G073F/EOG091G073F.ingroup.fasta
    output: per_gene/EOG091G073F/EOG091G073F.orthodb.fasta, per_gene/EOG091G073F/EOG091G073F.outgroup.fasta
    log: per_gene/EOG091G073F/get_outgroups.stdout.txt, per_gene/EOG091G073F/get_outgroups.stderr.txt
    jobid: 2571
    wildcards: BUSCO=EOG091G073F


        #download fastas from Orhtodb for BUSCO id
        for i in {1..5}
        do
             wget "http://www.orthodb.org/fasta?query=EOG091G073F&level=33208" -O per_gene/EOG091G073F/EOG091G073F.orthodb.fasta 1> per_gene/EOG091G073F/get_outgroups.stdout.txt 2> per_gene/EOG091G073F/get_outgroups.stderr.txt && break || echo -e "try again ($i)" && sleep 15
        done

	#This is quick an dirty for now and just takes the first protein if there is more than one for an outgroup taxon
        bash ../scripts/download_outgroups.sh taxids.txt per_gene/EOG091G073F/EOG091G073F.orthodb.fasta > per_gene/EOG091G073F/EOG091G073F.outgroup.fasta
        

[Sun Jul  5 22:54:46 2020]
rule infer_single_ML:
    input: per_gene/EOG091G113O/EOG091G113O.best_model, per_gene/EOG091G113O/ALICUT_EOG091G113O.clustalo.fasta
    output: per_gene/EOG091G113O/EOG091G113O.raxml.done
    log: per_gene/EOG091G113O/infer_single_ML.stdout.txt, per_gene/EOG091G113O/infer_single_ML.stderr.txt
    jobid: 224
    wildcards: BUSCO=EOG091G113O
    threads: 2


        cd per_gene/EOG091G113O
	count=$(cat ../../per_gene/EOG091G113O/ALICUT_EOG091G113O.clustalo.fasta | grep ">" | wc -l)
	if [ "$count" -gt 5 ]
        then
		RAxMLmodel=$(cat ../../per_gene/EOG091G113O/EOG091G113O.best_model | grep "Best" | cut -d ":" -f 2 | tr -d '[:space:]')
                if [ "$(ls -1 | grep "^RAxML" | wc -l)" -ne 0 ]
		then
			rm RAxML*
		fi
        	raxml -f a -T 2 -m PROTGAMMA$RAxMLmodel         	-p 12345 -x 12345 -# 100         	-s ../../per_gene/EOG091G113O/ALICUT_EOG091G113O.clustalo.fasta -n EOG091G113O.clustalo.aln.ALICUT.$RAxMLmodel 		1> ../../per_gene/EOG091G113O/infer_single_ML.stdout.txt 2> ../../per_gene/EOG091G113O/infer_single_ML.stderr.txt
	else
		echo "fasta file per_gene/EOG091G113O/ALICUT_EOG091G113O.clustalo.fasta contains fewer than 5 sequences - skipped" > ../../per_gene/EOG091G113O/infer_single_ML.stdout.txt
		touch raxml.skipped
	fi
        touch ../../per_gene/EOG091G113O/EOG091G113O.raxml.done
        
[Sun Jul  5 22:54:47 2020]
Finished job 2571.
1504 of 3292 steps (46%) done
[Sun Jul  5 22:54:47 2020]
Finished job 789.
1505 of 3292 steps (46%) done

[Sun Jul  5 22:54:47 2020]
rule get_seqs:
    input: /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ingroup.txt, /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/outgroup.txt
    output: per_gene/EOG091G0MP6/EOG091G0MP6.ingroup.fasta
    log: per_gene/EOG091G0MP6/get_seqs.stdout.txt, per_gene/EOG091G0MP6/get_seqs.stderr.txt
    jobid: 2768
    wildcards: BUSCO=EOG091G0MP6
    threads: 2


	basedir=$(pwd)
        cd per_gene/EOG091G0MP6
        
        bash $basedir/../scripts/fetch_seqs.sh EOG091G0MP6 /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ingroup.txt /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/outgroup.txt 1> ../../per_gene/EOG091G0MP6/get_seqs.stdout.txt 2> ../../per_gene/EOG091G0MP6/get_seqs.stderr.txt
	mv EOG091G0MP6.fasta $basedir/per_gene/EOG091G0MP6/EOG091G0MP6.ingroup.fasta
        

[Sun Jul  5 22:54:47 2020]
rule remove_empty:
    input: per_gene/EOG091G0SBR/ALICUT_EOG091G0SBR.clustalo.fasta
    output: per_gene/EOG091G0SBR/empty_check.done
    jobid: 1611
    wildcards: BUSCO=EOG091G0SBR


         if [ "$(cat per_gene/EOG091G0SBR/ALICUT_EOG091G0SBR.clustalo.fasta | grep -v ">" | sed 's/-//g' | grep "^$" | wc -l)" -gt 0 ]
         then
              cp per_gene/EOG091G0SBR/ALICUT_EOG091G0SBR.clustalo.fasta per_gene/EOG091G0SBR/ALICUT_EOG091G0SBR.clustalo.fasta.backup
              bash ../scripts/remove_empty.sh per_gene/EOG091G0SBR/ALICUT_EOG091G0SBR.clustalo.fasta.backup > per_gene/EOG091G0SBR/ALICUT_EOG091G0SBR.clustalo.fasta
         fi
         touch per_gene/EOG091G0SBR/empty_check.done
         
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/72476f9d9a5bd0627b4d721143a21354.simg

[Sun Jul  5 22:54:47 2020]
rule join_groups:
    input: per_gene/EOG091G073F/EOG091G073F.ingroup.fasta, per_gene/EOG091G073F/EOG091G073F.outgroup.fasta
    output: per_gene/EOG091G073F/EOG091G073F.fasta
    jobid: 2109
    wildcards: BUSCO=EOG091G073F


        cat per_gene/EOG091G073F/EOG091G073F.ingroup.fasta per_gene/EOG091G073F/EOG091G073F.outgroup.fasta > per_gene/EOG091G073F/EOG091G073F.fasta
        
[Sun Jul  5 22:54:47 2020]
Finished job 1611.
1506 of 3292 steps (46%) done
[Sun Jul  5 22:54:47 2020]
Finished job 2109.
1507 of 3292 steps (46%) done

[Sun Jul  5 22:54:47 2020]
rule MSA:
    input: per_gene/EOG091G073F/EOG091G073F.fasta
    output: per_gene/EOG091G073F/EOG091G073F.clustalo.fasta
    log: per_gene/EOG091G073F/MSA.stdout.txt, per_gene/EOG091G073F/MSA.stderr.txt
    jobid: 1338
    wildcards: BUSCO=EOG091G073F
    threads: 2


        clustalo -i per_gene/EOG091G073F/EOG091G073F.fasta -o per_gene/EOG091G073F/EOG091G073F.clustalo.fasta --threads=2 1> per_gene/EOG091G073F/MSA.stdout.txt 2> per_gene/EOG091G073F/MSA.stderr.txt
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/d68c9691725a7401923680874285c430.simg
[33mJob counts:
	count	jobs
	1	infer_single_ML
	1[0m
[33m
        cd per_gene/EOG091G113O
	count=$(cat ../../per_gene/EOG091G113O/ALICUT_EOG091G113O.clustalo.fasta | grep ">" | wc -l)
	if [ "$count" -gt 5 ]
        then
		RAxMLmodel=$(cat ../../per_gene/EOG091G113O/EOG091G113O.best_model | grep "Best" | cut -d ":" -f 2 | tr -d '[:space:]')
                if [ "$(ls -1 | grep "^RAxML" | wc -l)" -ne 0 ]
		then
			rm RAxML*
		fi
        	raxml -f a -T 2 -m PROTGAMMA$RAxMLmodel         	-p 12345 -x 12345 -# 100         	-s ../../per_gene/EOG091G113O/ALICUT_EOG091G113O.clustalo.fasta -n EOG091G113O.clustalo.aln.ALICUT.$RAxMLmodel 		1> ../../per_gene/EOG091G113O/infer_single_ML.stdout.txt 2> ../../per_gene/EOG091G113O/infer_single_ML.stderr.txt
	else
		echo "fasta file per_gene/EOG091G113O/ALICUT_EOG091G113O.clustalo.fasta contains fewer than 5 sequences - skipped" > ../../per_gene/EOG091G113O/infer_single_ML.stdout.txt
		touch raxml.skipped
	fi
        touch ../../per_gene/EOG091G113O/EOG091G113O.raxml.done
        [0m
[Sun Jul  5 22:54:48 2020]
Finished job 1338.
1508 of 3292 steps (46%) done

[Sun Jul  5 22:54:48 2020]
rule score_and_cut:
    input: per_gene/EOG091G073F/EOG091G073F.clustalo.fasta
    output: per_gene/EOG091G073F/ALICUT_EOG091G073F.clustalo.fasta
    jobid: 515
    wildcards: BUSCO=EOG091G073F
    threads: 2


        cd per_gene/EOG091G073F
        Aliscore.pl -N -r 200000000000000000 -i ../../per_gene/EOG091G073F/EOG091G073F.clustalo.fasta &> aliscore.log
        ALICUT.pl -s &> alicut.log
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/63c88c27a0fa300f57066b0ef65fefcb.simg
[Sun Jul  5 22:54:52 2020]
Finished job 325.
1509 of 3292 steps (46%) done

[Sun Jul  5 22:54:52 2020]
rule find_best_model:
    input: per_gene/EOG091G0SBR/ALICUT_EOG091G0SBR.clustalo.fasta, per_gene/EOG091G0SBR/empty_check.done
    output: per_gene/EOG091G0SBR/EOG091G0SBR.best_model
    log: per_gene/EOG091G0SBR/find_best_model.stderr.txt
    jobid: 788
    wildcards: BUSCO=EOG091G0SBR
    threads: 2


        cd per_gene/EOG091G0SBR
        if [ ! -d find_best_model ]
        then
            mkdir find_best_model
        fi
        cd find_best_model
        ln -s ../../../per_gene/EOG091G0SBR/ALICUT_EOG091G0SBR.clustalo.fasta EOG091G0SBR.fasta
        ProteinModelSelection.pl EOG091G0SBR.fasta 1> ../../../per_gene/EOG091G0SBR/EOG091G0SBR.best_model 2> ../../../per_gene/EOG091G0SBR/find_best_model.stderr.txt
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/c0c09ee657b1e27f2c5687e0e9aa8d70.simg
[Sun Jul  5 22:54:59 2020]
Finished job 515.
1510 of 3292 steps (46%) done

[Sun Jul  5 22:54:59 2020]
rule remove_empty:
    input: per_gene/EOG091G073F/ALICUT_EOG091G073F.clustalo.fasta
    output: per_gene/EOG091G073F/empty_check.done
    jobid: 1337
    wildcards: BUSCO=EOG091G073F


         if [ "$(cat per_gene/EOG091G073F/ALICUT_EOG091G073F.clustalo.fasta | grep -v ">" | sed 's/-//g' | grep "^$" | wc -l)" -gt 0 ]
         then
              cp per_gene/EOG091G073F/ALICUT_EOG091G073F.clustalo.fasta per_gene/EOG091G073F/ALICUT_EOG091G073F.clustalo.fasta.backup
              bash ../scripts/remove_empty.sh per_gene/EOG091G073F/ALICUT_EOG091G073F.clustalo.fasta.backup > per_gene/EOG091G073F/ALICUT_EOG091G073F.clustalo.fasta
         fi
         touch per_gene/EOG091G073F/empty_check.done
         
[Sun Jul  5 22:54:59 2020]
Finished job 1337.
1511 of 3292 steps (46%) done

[Sun Jul  5 22:54:59 2020]
rule find_best_model:
    input: per_gene/EOG091G073F/ALICUT_EOG091G073F.clustalo.fasta, per_gene/EOG091G073F/empty_check.done
    output: per_gene/EOG091G073F/EOG091G073F.best_model
    log: per_gene/EOG091G073F/find_best_model.stderr.txt
    jobid: 514
    wildcards: BUSCO=EOG091G073F
    threads: 2


        cd per_gene/EOG091G073F
        if [ ! -d find_best_model ]
        then
            mkdir find_best_model
        fi
        cd find_best_model
        ln -s ../../../per_gene/EOG091G073F/ALICUT_EOG091G073F.clustalo.fasta EOG091G073F.fasta
        ProteinModelSelection.pl EOG091G073F.fasta 1> ../../../per_gene/EOG091G073F/EOG091G073F.best_model 2> ../../../per_gene/EOG091G073F/find_best_model.stderr.txt
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/c0c09ee657b1e27f2c5687e0e9aa8d70.simg
[Sun Jul  5 22:55:03 2020]
Finished job 2768.
1512 of 3292 steps (46%) done

[Sun Jul  5 22:55:03 2020]
rule get_outgroups:
    input: per_gene/EOG091G0MP6/EOG091G0MP6.ingroup.fasta
    output: per_gene/EOG091G0MP6/EOG091G0MP6.orthodb.fasta, per_gene/EOG091G0MP6/EOG091G0MP6.outgroup.fasta
    log: per_gene/EOG091G0MP6/get_outgroups.stdout.txt, per_gene/EOG091G0MP6/get_outgroups.stderr.txt
    jobid: 2769
    wildcards: BUSCO=EOG091G0MP6


        #download fastas from Orhtodb for BUSCO id
        for i in {1..5}
        do
             wget "http://www.orthodb.org/fasta?query=EOG091G0MP6&level=33208" -O per_gene/EOG091G0MP6/EOG091G0MP6.orthodb.fasta 1> per_gene/EOG091G0MP6/get_outgroups.stdout.txt 2> per_gene/EOG091G0MP6/get_outgroups.stderr.txt && break || echo -e "try again ($i)" && sleep 15
        done

	#This is quick an dirty for now and just takes the first protein if there is more than one for an outgroup taxon
        bash ../scripts/download_outgroups.sh taxids.txt per_gene/EOG091G0MP6/EOG091G0MP6.orthodb.fasta > per_gene/EOG091G0MP6/EOG091G0MP6.outgroup.fasta
        
[Sun Jul  5 22:55:04 2020]
Finished job 2769.
1513 of 3292 steps (46%) done

[Sun Jul  5 22:55:04 2020]
rule join_groups:
    input: per_gene/EOG091G0MP6/EOG091G0MP6.ingroup.fasta, per_gene/EOG091G0MP6/EOG091G0MP6.outgroup.fasta
    output: per_gene/EOG091G0MP6/EOG091G0MP6.fasta
    jobid: 2208
    wildcards: BUSCO=EOG091G0MP6


        cat per_gene/EOG091G0MP6/EOG091G0MP6.ingroup.fasta per_gene/EOG091G0MP6/EOG091G0MP6.outgroup.fasta > per_gene/EOG091G0MP6/EOG091G0MP6.fasta
        
[Sun Jul  5 22:55:05 2020]
Finished job 2208.
1514 of 3292 steps (46%) done

[Sun Jul  5 22:55:05 2020]
rule MSA:
    input: per_gene/EOG091G0MP6/EOG091G0MP6.fasta
    output: per_gene/EOG091G0MP6/EOG091G0MP6.clustalo.fasta
    log: per_gene/EOG091G0MP6/MSA.stdout.txt, per_gene/EOG091G0MP6/MSA.stderr.txt
    jobid: 1536
    wildcards: BUSCO=EOG091G0MP6
    threads: 2


        clustalo -i per_gene/EOG091G0MP6/EOG091G0MP6.fasta -o per_gene/EOG091G0MP6/EOG091G0MP6.clustalo.fasta --threads=2 1> per_gene/EOG091G0MP6/MSA.stdout.txt 2> per_gene/EOG091G0MP6/MSA.stderr.txt
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/d68c9691725a7401923680874285c430.simg
[Sun Jul  5 22:55:05 2020]
Finished job 138.
1515 of 3292 steps (46%) done

[Sun Jul  5 22:55:05 2020]
rule get_seqs:
    input: /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ingroup.txt, /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/outgroup.txt
    output: per_gene/EOG091G0UE6/EOG091G0UE6.ingroup.fasta
    log: per_gene/EOG091G0UE6/get_seqs.stdout.txt, per_gene/EOG091G0UE6/get_seqs.stderr.txt
    jobid: 3030
    wildcards: BUSCO=EOG091G0UE6
    threads: 2


	basedir=$(pwd)
        cd per_gene/EOG091G0UE6
        
        bash $basedir/../scripts/fetch_seqs.sh EOG091G0UE6 /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ingroup.txt /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/outgroup.txt 1> ../../per_gene/EOG091G0UE6/get_seqs.stdout.txt 2> ../../per_gene/EOG091G0UE6/get_seqs.stderr.txt
	mv EOG091G0UE6.fasta $basedir/per_gene/EOG091G0UE6/EOG091G0UE6.ingroup.fasta
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/72476f9d9a5bd0627b4d721143a21354.simg
[Sun Jul  5 22:55:05 2020]
Finished job 1536.
1516 of 3292 steps (46%) done

[Sun Jul  5 22:55:05 2020]
rule score_and_cut:
    input: per_gene/EOG091G0MP6/EOG091G0MP6.clustalo.fasta
    output: per_gene/EOG091G0MP6/ALICUT_EOG091G0MP6.clustalo.fasta
    jobid: 713
    wildcards: BUSCO=EOG091G0MP6
    threads: 2


        cd per_gene/EOG091G0MP6
        Aliscore.pl -N -r 200000000000000000 -i ../../per_gene/EOG091G0MP6/EOG091G0MP6.clustalo.fasta &> aliscore.log
        ALICUT.pl -s &> alicut.log
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/63c88c27a0fa300f57066b0ef65fefcb.simg
[Sun Jul  5 22:55:11 2020]
Finished job 372.
1517 of 3292 steps (46%) done

[Sun Jul  5 22:55:11 2020]
rule get_seqs:
    input: /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ingroup.txt, /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/outgroup.txt
    output: per_gene/EOG091G0LZ0/EOG091G0LZ0.ingroup.fasta
    log: per_gene/EOG091G0LZ0/get_seqs.stdout.txt, per_gene/EOG091G0LZ0/get_seqs.stderr.txt
    jobid: 2754
    wildcards: BUSCO=EOG091G0LZ0
    threads: 2


	basedir=$(pwd)
        cd per_gene/EOG091G0LZ0
        
        bash $basedir/../scripts/fetch_seqs.sh EOG091G0LZ0 /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ingroup.txt /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/outgroup.txt 1> ../../per_gene/EOG091G0LZ0/get_seqs.stdout.txt 2> ../../per_gene/EOG091G0LZ0/get_seqs.stderr.txt
	mv EOG091G0LZ0.fasta $basedir/per_gene/EOG091G0LZ0/EOG091G0LZ0.ingroup.fasta
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/72476f9d9a5bd0627b4d721143a21354.simg
[Sun Jul  5 22:55:15 2020]
Finished job 53.
1518 of 3292 steps (46%) done

[Sun Jul  5 22:55:15 2020]
rule get_seqs:
    input: /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ingroup.txt, /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/outgroup.txt
    output: per_gene/EOG091G0HSB/EOG091G0HSB.ingroup.fasta
    log: per_gene/EOG091G0HSB/get_seqs.stdout.txt, per_gene/EOG091G0HSB/get_seqs.stderr.txt
    jobid: 3198
    wildcards: BUSCO=EOG091G0HSB
    threads: 2


	basedir=$(pwd)
        cd per_gene/EOG091G0HSB
        
        bash $basedir/../scripts/fetch_seqs.sh EOG091G0HSB /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ingroup.txt /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/outgroup.txt 1> ../../per_gene/EOG091G0HSB/get_seqs.stdout.txt 2> ../../per_gene/EOG091G0HSB/get_seqs.stderr.txt
	mv EOG091G0HSB.fasta $basedir/per_gene/EOG091G0HSB/EOG091G0HSB.ingroup.fasta
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/72476f9d9a5bd0627b4d721143a21354.simg
[Sun Jul  5 22:55:15 2020]
Finished job 713.
1519 of 3292 steps (46%) done

[Sun Jul  5 22:55:15 2020]
rule remove_empty:
    input: per_gene/EOG091G0MP6/ALICUT_EOG091G0MP6.clustalo.fasta
    output: per_gene/EOG091G0MP6/empty_check.done
    jobid: 1535
    wildcards: BUSCO=EOG091G0MP6


         if [ "$(cat per_gene/EOG091G0MP6/ALICUT_EOG091G0MP6.clustalo.fasta | grep -v ">" | sed 's/-//g' | grep "^$" | wc -l)" -gt 0 ]
         then
              cp per_gene/EOG091G0MP6/ALICUT_EOG091G0MP6.clustalo.fasta per_gene/EOG091G0MP6/ALICUT_EOG091G0MP6.clustalo.fasta.backup
              bash ../scripts/remove_empty.sh per_gene/EOG091G0MP6/ALICUT_EOG091G0MP6.clustalo.fasta.backup > per_gene/EOG091G0MP6/ALICUT_EOG091G0MP6.clustalo.fasta
         fi
         touch per_gene/EOG091G0MP6/empty_check.done
         
[Sun Jul  5 22:55:15 2020]
Finished job 1535.
1520 of 3292 steps (46%) done

[Sun Jul  5 22:55:15 2020]
rule find_best_model:
    input: per_gene/EOG091G0MP6/ALICUT_EOG091G0MP6.clustalo.fasta, per_gene/EOG091G0MP6/empty_check.done
    output: per_gene/EOG091G0MP6/EOG091G0MP6.best_model
    log: per_gene/EOG091G0MP6/find_best_model.stderr.txt
    jobid: 712
    wildcards: BUSCO=EOG091G0MP6
    threads: 2


        cd per_gene/EOG091G0MP6
        if [ ! -d find_best_model ]
        then
            mkdir find_best_model
        fi
        cd find_best_model
        ln -s ../../../per_gene/EOG091G0MP6/ALICUT_EOG091G0MP6.clustalo.fasta EOG091G0MP6.fasta
        ProteinModelSelection.pl EOG091G0MP6.fasta 1> ../../../per_gene/EOG091G0MP6/EOG091G0MP6.best_model 2> ../../../per_gene/EOG091G0MP6/find_best_model.stderr.txt
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/c0c09ee657b1e27f2c5687e0e9aa8d70.simg
[Sun Jul  5 22:55:19 2020]
Finished job 3030.
1521 of 3292 steps (46%) done

[Sun Jul  5 22:55:19 2020]
rule get_outgroups:
    input: per_gene/EOG091G0UE6/EOG091G0UE6.ingroup.fasta
    output: per_gene/EOG091G0UE6/EOG091G0UE6.orthodb.fasta, per_gene/EOG091G0UE6/EOG091G0UE6.outgroup.fasta
    log: per_gene/EOG091G0UE6/get_outgroups.stdout.txt, per_gene/EOG091G0UE6/get_outgroups.stderr.txt
    jobid: 3031
    wildcards: BUSCO=EOG091G0UE6


        #download fastas from Orhtodb for BUSCO id
        for i in {1..5}
        do
             wget "http://www.orthodb.org/fasta?query=EOG091G0UE6&level=33208" -O per_gene/EOG091G0UE6/EOG091G0UE6.orthodb.fasta 1> per_gene/EOG091G0UE6/get_outgroups.stdout.txt 2> per_gene/EOG091G0UE6/get_outgroups.stderr.txt && break || echo -e "try again ($i)" && sleep 15
        done

	#This is quick an dirty for now and just takes the first protein if there is more than one for an outgroup taxon
        bash ../scripts/download_outgroups.sh taxids.txt per_gene/EOG091G0UE6/EOG091G0UE6.orthodb.fasta > per_gene/EOG091G0UE6/EOG091G0UE6.outgroup.fasta
        
[Sun Jul  5 22:55:20 2020]
Finished job 3031.
1522 of 3292 steps (46%) done

[Sun Jul  5 22:55:20 2020]
rule join_groups:
    input: per_gene/EOG091G0UE6/EOG091G0UE6.ingroup.fasta, per_gene/EOG091G0UE6/EOG091G0UE6.outgroup.fasta
    output: per_gene/EOG091G0UE6/EOG091G0UE6.fasta
    jobid: 2339
    wildcards: BUSCO=EOG091G0UE6


        cat per_gene/EOG091G0UE6/EOG091G0UE6.ingroup.fasta per_gene/EOG091G0UE6/EOG091G0UE6.outgroup.fasta > per_gene/EOG091G0UE6/EOG091G0UE6.fasta
        
[Sun Jul  5 22:55:20 2020]
Finished job 2339.
1523 of 3292 steps (46%) done

[Sun Jul  5 22:55:20 2020]
rule MSA:
    input: per_gene/EOG091G0UE6/EOG091G0UE6.fasta
    output: per_gene/EOG091G0UE6/EOG091G0UE6.clustalo.fasta
    log: per_gene/EOG091G0UE6/MSA.stdout.txt, per_gene/EOG091G0UE6/MSA.stderr.txt
    jobid: 1798
    wildcards: BUSCO=EOG091G0UE6
    threads: 2


        clustalo -i per_gene/EOG091G0UE6/EOG091G0UE6.fasta -o per_gene/EOG091G0UE6/EOG091G0UE6.clustalo.fasta --threads=2 1> per_gene/EOG091G0UE6/MSA.stdout.txt 2> per_gene/EOG091G0UE6/MSA.stderr.txt
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/d68c9691725a7401923680874285c430.simg
[Sun Jul  5 22:55:21 2020]
Finished job 1798.
1524 of 3292 steps (46%) done

[Sun Jul  5 22:55:21 2020]
rule score_and_cut:
    input: per_gene/EOG091G0UE6/EOG091G0UE6.clustalo.fasta
    output: per_gene/EOG091G0UE6/ALICUT_EOG091G0UE6.clustalo.fasta
    jobid: 975
    wildcards: BUSCO=EOG091G0UE6
    threads: 2


        cd per_gene/EOG091G0UE6
        Aliscore.pl -N -r 200000000000000000 -i ../../per_gene/EOG091G0UE6/EOG091G0UE6.clustalo.fasta &> aliscore.log
        ALICUT.pl -s &> alicut.log
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/63c88c27a0fa300f57066b0ef65fefcb.simg
[Sun Jul  5 22:55:22 2020]
Finished job 21.
1525 of 3292 steps (46%) done

[Sun Jul  5 22:55:22 2020]
rule get_seqs:
    input: /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ingroup.txt, /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/outgroup.txt
    output: per_gene/EOG091G0TRW/EOG091G0TRW.ingroup.fasta
    log: per_gene/EOG091G0TRW/get_seqs.stdout.txt, per_gene/EOG091G0TRW/get_seqs.stderr.txt
    jobid: 2854
    wildcards: BUSCO=EOG091G0TRW
    threads: 2


	basedir=$(pwd)
        cd per_gene/EOG091G0TRW
        
        bash $basedir/../scripts/fetch_seqs.sh EOG091G0TRW /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ingroup.txt /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/outgroup.txt 1> ../../per_gene/EOG091G0TRW/get_seqs.stdout.txt 2> ../../per_gene/EOG091G0TRW/get_seqs.stderr.txt
	mv EOG091G0TRW.fasta $basedir/per_gene/EOG091G0TRW/EOG091G0TRW.ingroup.fasta
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/72476f9d9a5bd0627b4d721143a21354.simg
[Sun Jul  5 22:55:23 2020]
Finished job 788.
1526 of 3292 steps (46%) done

[Sun Jul  5 22:55:23 2020]
rule infer_single_ML:
    input: per_gene/EOG091G0SBR/EOG091G0SBR.best_model, per_gene/EOG091G0SBR/ALICUT_EOG091G0SBR.clustalo.fasta
    output: per_gene/EOG091G0SBR/EOG091G0SBR.raxml.done
    log: per_gene/EOG091G0SBR/infer_single_ML.stdout.txt, per_gene/EOG091G0SBR/infer_single_ML.stderr.txt
    jobid: 188
    wildcards: BUSCO=EOG091G0SBR
    threads: 2


        cd per_gene/EOG091G0SBR
	count=$(cat ../../per_gene/EOG091G0SBR/ALICUT_EOG091G0SBR.clustalo.fasta | grep ">" | wc -l)
	if [ "$count" -gt 5 ]
        then
		RAxMLmodel=$(cat ../../per_gene/EOG091G0SBR/EOG091G0SBR.best_model | grep "Best" | cut -d ":" -f 2 | tr -d '[:space:]')
                if [ "$(ls -1 | grep "^RAxML" | wc -l)" -ne 0 ]
		then
			rm RAxML*
		fi
        	raxml -f a -T 2 -m PROTGAMMA$RAxMLmodel         	-p 12345 -x 12345 -# 100         	-s ../../per_gene/EOG091G0SBR/ALICUT_EOG091G0SBR.clustalo.fasta -n EOG091G0SBR.clustalo.aln.ALICUT.$RAxMLmodel 		1> ../../per_gene/EOG091G0SBR/infer_single_ML.stdout.txt 2> ../../per_gene/EOG091G0SBR/infer_single_ML.stderr.txt
	else
		echo "fasta file per_gene/EOG091G0SBR/ALICUT_EOG091G0SBR.clustalo.fasta contains fewer than 5 sequences - skipped" > ../../per_gene/EOG091G0SBR/infer_single_ML.stdout.txt
		touch raxml.skipped
	fi
        touch ../../per_gene/EOG091G0SBR/EOG091G0SBR.raxml.done
        
[33mJob counts:
	count	jobs
	1	infer_single_ML
	1[0m
[33m
        cd per_gene/EOG091G0SBR
	count=$(cat ../../per_gene/EOG091G0SBR/ALICUT_EOG091G0SBR.clustalo.fasta | grep ">" | wc -l)
	if [ "$count" -gt 5 ]
        then
		RAxMLmodel=$(cat ../../per_gene/EOG091G0SBR/EOG091G0SBR.best_model | grep "Best" | cut -d ":" -f 2 | tr -d '[:space:]')
                if [ "$(ls -1 | grep "^RAxML" | wc -l)" -ne 0 ]
		then
			rm RAxML*
		fi
        	raxml -f a -T 2 -m PROTGAMMA$RAxMLmodel         	-p 12345 -x 12345 -# 100         	-s ../../per_gene/EOG091G0SBR/ALICUT_EOG091G0SBR.clustalo.fasta -n EOG091G0SBR.clustalo.aln.ALICUT.$RAxMLmodel 		1> ../../per_gene/EOG091G0SBR/infer_single_ML.stdout.txt 2> ../../per_gene/EOG091G0SBR/infer_single_ML.stderr.txt
	else
		echo "fasta file per_gene/EOG091G0SBR/ALICUT_EOG091G0SBR.clustalo.fasta contains fewer than 5 sequences - skipped" > ../../per_gene/EOG091G0SBR/infer_single_ML.stdout.txt
		touch raxml.skipped
	fi
        touch ../../per_gene/EOG091G0SBR/EOG091G0SBR.raxml.done
        [0m
[Sun Jul  5 22:55:26 2020]
Finished job 2754.
1527 of 3292 steps (46%) done

[Sun Jul  5 22:55:26 2020]
rule get_outgroups:
    input: per_gene/EOG091G0LZ0/EOG091G0LZ0.ingroup.fasta
    output: per_gene/EOG091G0LZ0/EOG091G0LZ0.orthodb.fasta, per_gene/EOG091G0LZ0/EOG091G0LZ0.outgroup.fasta
    log: per_gene/EOG091G0LZ0/get_outgroups.stdout.txt, per_gene/EOG091G0LZ0/get_outgroups.stderr.txt
    jobid: 2755
    wildcards: BUSCO=EOG091G0LZ0


        #download fastas from Orhtodb for BUSCO id
        for i in {1..5}
        do
             wget "http://www.orthodb.org/fasta?query=EOG091G0LZ0&level=33208" -O per_gene/EOG091G0LZ0/EOG091G0LZ0.orthodb.fasta 1> per_gene/EOG091G0LZ0/get_outgroups.stdout.txt 2> per_gene/EOG091G0LZ0/get_outgroups.stderr.txt && break || echo -e "try again ($i)" && sleep 15
        done

	#This is quick an dirty for now and just takes the first protein if there is more than one for an outgroup taxon
        bash ../scripts/download_outgroups.sh taxids.txt per_gene/EOG091G0LZ0/EOG091G0LZ0.orthodb.fasta > per_gene/EOG091G0LZ0/EOG091G0LZ0.outgroup.fasta
        
[Sun Jul  5 22:55:26 2020]
Finished job 2755.
1528 of 3292 steps (46%) done

[Sun Jul  5 22:55:26 2020]
rule join_groups:
    input: per_gene/EOG091G0LZ0/EOG091G0LZ0.ingroup.fasta, per_gene/EOG091G0LZ0/EOG091G0LZ0.outgroup.fasta
    output: per_gene/EOG091G0LZ0/EOG091G0LZ0.fasta
    jobid: 2201
    wildcards: BUSCO=EOG091G0LZ0


        cat per_gene/EOG091G0LZ0/EOG091G0LZ0.ingroup.fasta per_gene/EOG091G0LZ0/EOG091G0LZ0.outgroup.fasta > per_gene/EOG091G0LZ0/EOG091G0LZ0.fasta
        
[Sun Jul  5 22:55:26 2020]
Finished job 2201.
1529 of 3292 steps (46%) done

[Sun Jul  5 22:55:26 2020]
rule MSA:
    input: per_gene/EOG091G0LZ0/EOG091G0LZ0.fasta
    output: per_gene/EOG091G0LZ0/EOG091G0LZ0.clustalo.fasta
    log: per_gene/EOG091G0LZ0/MSA.stdout.txt, per_gene/EOG091G0LZ0/MSA.stderr.txt
    jobid: 1522
    wildcards: BUSCO=EOG091G0LZ0
    threads: 2


        clustalo -i per_gene/EOG091G0LZ0/EOG091G0LZ0.fasta -o per_gene/EOG091G0LZ0/EOG091G0LZ0.clustalo.fasta --threads=2 1> per_gene/EOG091G0LZ0/MSA.stdout.txt 2> per_gene/EOG091G0LZ0/MSA.stderr.txt
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/d68c9691725a7401923680874285c430.simg
[Sun Jul  5 22:55:27 2020]
Finished job 1522.
1530 of 3292 steps (46%) done

[Sun Jul  5 22:55:27 2020]
rule score_and_cut:
    input: per_gene/EOG091G0LZ0/EOG091G0LZ0.clustalo.fasta
    output: per_gene/EOG091G0LZ0/ALICUT_EOG091G0LZ0.clustalo.fasta
    jobid: 699
    wildcards: BUSCO=EOG091G0LZ0
    threads: 2


        cd per_gene/EOG091G0LZ0
        Aliscore.pl -N -r 200000000000000000 -i ../../per_gene/EOG091G0LZ0/EOG091G0LZ0.clustalo.fasta &> aliscore.log
        ALICUT.pl -s &> alicut.log
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/63c88c27a0fa300f57066b0ef65fefcb.simg
[Sun Jul  5 22:55:29 2020]
Finished job 3198.
1531 of 3292 steps (47%) done

[Sun Jul  5 22:55:29 2020]
rule get_outgroups:
    input: per_gene/EOG091G0HSB/EOG091G0HSB.ingroup.fasta
    output: per_gene/EOG091G0HSB/EOG091G0HSB.orthodb.fasta, per_gene/EOG091G0HSB/EOG091G0HSB.outgroup.fasta
    log: per_gene/EOG091G0HSB/get_outgroups.stdout.txt, per_gene/EOG091G0HSB/get_outgroups.stderr.txt
    jobid: 3199
    wildcards: BUSCO=EOG091G0HSB


        #download fastas from Orhtodb for BUSCO id
        for i in {1..5}
        do
             wget "http://www.orthodb.org/fasta?query=EOG091G0HSB&level=33208" -O per_gene/EOG091G0HSB/EOG091G0HSB.orthodb.fasta 1> per_gene/EOG091G0HSB/get_outgroups.stdout.txt 2> per_gene/EOG091G0HSB/get_outgroups.stderr.txt && break || echo -e "try again ($i)" && sleep 15
        done

	#This is quick an dirty for now and just takes the first protein if there is more than one for an outgroup taxon
        bash ../scripts/download_outgroups.sh taxids.txt per_gene/EOG091G0HSB/EOG091G0HSB.orthodb.fasta > per_gene/EOG091G0HSB/EOG091G0HSB.outgroup.fasta
        
[Sun Jul  5 22:55:29 2020]
Finished job 975.
1532 of 3292 steps (47%) done

[Sun Jul  5 22:55:29 2020]
rule get_seqs:
    input: /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ingroup.txt, /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/outgroup.txt
    output: per_gene/EOG091G0BKZ/EOG091G0BKZ.ingroup.fasta
    log: per_gene/EOG091G0BKZ/get_seqs.stdout.txt, per_gene/EOG091G0BKZ/get_seqs.stderr.txt
    jobid: 2636
    wildcards: BUSCO=EOG091G0BKZ
    threads: 2


	basedir=$(pwd)
        cd per_gene/EOG091G0BKZ
        
        bash $basedir/../scripts/fetch_seqs.sh EOG091G0BKZ /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ingroup.txt /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/outgroup.txt 1> ../../per_gene/EOG091G0BKZ/get_seqs.stdout.txt 2> ../../per_gene/EOG091G0BKZ/get_seqs.stderr.txt
	mv EOG091G0BKZ.fasta $basedir/per_gene/EOG091G0BKZ/EOG091G0BKZ.ingroup.fasta
        

[Sun Jul  5 22:55:29 2020]
rule remove_empty:
    input: per_gene/EOG091G0UE6/ALICUT_EOG091G0UE6.clustalo.fasta
    output: per_gene/EOG091G0UE6/empty_check.done
    jobid: 1797
    wildcards: BUSCO=EOG091G0UE6


         if [ "$(cat per_gene/EOG091G0UE6/ALICUT_EOG091G0UE6.clustalo.fasta | grep -v ">" | sed 's/-//g' | grep "^$" | wc -l)" -gt 0 ]
         then
              cp per_gene/EOG091G0UE6/ALICUT_EOG091G0UE6.clustalo.fasta per_gene/EOG091G0UE6/ALICUT_EOG091G0UE6.clustalo.fasta.backup
              bash ../scripts/remove_empty.sh per_gene/EOG091G0UE6/ALICUT_EOG091G0UE6.clustalo.fasta.backup > per_gene/EOG091G0UE6/ALICUT_EOG091G0UE6.clustalo.fasta
         fi
         touch per_gene/EOG091G0UE6/empty_check.done
         
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/72476f9d9a5bd0627b4d721143a21354.simg
[Sun Jul  5 22:55:29 2020]
Finished job 1797.
1533 of 3292 steps (47%) done
[Sun Jul  5 22:55:30 2020]
Finished job 3199.
1534 of 3292 steps (47%) done

[Sun Jul  5 22:55:30 2020]
rule join_groups:
    input: per_gene/EOG091G0HSB/EOG091G0HSB.ingroup.fasta, per_gene/EOG091G0HSB/EOG091G0HSB.outgroup.fasta
    output: per_gene/EOG091G0HSB/EOG091G0HSB.fasta
    jobid: 2423
    wildcards: BUSCO=EOG091G0HSB


        cat per_gene/EOG091G0HSB/EOG091G0HSB.ingroup.fasta per_gene/EOG091G0HSB/EOG091G0HSB.outgroup.fasta > per_gene/EOG091G0HSB/EOG091G0HSB.fasta
        
[Sun Jul  5 22:55:30 2020]
Finished job 2423.
1535 of 3292 steps (47%) done

[Sun Jul  5 22:55:30 2020]
rule MSA:
    input: per_gene/EOG091G0HSB/EOG091G0HSB.fasta
    output: per_gene/EOG091G0HSB/EOG091G0HSB.clustalo.fasta
    log: per_gene/EOG091G0HSB/MSA.stdout.txt, per_gene/EOG091G0HSB/MSA.stderr.txt
    jobid: 1966
    wildcards: BUSCO=EOG091G0HSB
    threads: 2


        clustalo -i per_gene/EOG091G0HSB/EOG091G0HSB.fasta -o per_gene/EOG091G0HSB/EOG091G0HSB.clustalo.fasta --threads=2 1> per_gene/EOG091G0HSB/MSA.stdout.txt 2> per_gene/EOG091G0HSB/MSA.stderr.txt
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/d68c9691725a7401923680874285c430.simg
[Sun Jul  5 22:55:31 2020]
Finished job 1966.
1536 of 3292 steps (47%) done

[Sun Jul  5 22:55:31 2020]
rule score_and_cut:
    input: per_gene/EOG091G0HSB/EOG091G0HSB.clustalo.fasta
    output: per_gene/EOG091G0HSB/ALICUT_EOG091G0HSB.clustalo.fasta
    jobid: 1143
    wildcards: BUSCO=EOG091G0HSB
    threads: 2


        cd per_gene/EOG091G0HSB
        Aliscore.pl -N -r 200000000000000000 -i ../../per_gene/EOG091G0HSB/EOG091G0HSB.clustalo.fasta &> aliscore.log
        ALICUT.pl -s &> alicut.log
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/63c88c27a0fa300f57066b0ef65fefcb.simg
[Sun Jul  5 22:55:36 2020]
Finished job 699.
1537 of 3292 steps (47%) done

[Sun Jul  5 22:55:36 2020]
rule remove_empty:
    input: per_gene/EOG091G0LZ0/ALICUT_EOG091G0LZ0.clustalo.fasta
    output: per_gene/EOG091G0LZ0/empty_check.done
    jobid: 1521
    wildcards: BUSCO=EOG091G0LZ0


         if [ "$(cat per_gene/EOG091G0LZ0/ALICUT_EOG091G0LZ0.clustalo.fasta | grep -v ">" | sed 's/-//g' | grep "^$" | wc -l)" -gt 0 ]
         then
              cp per_gene/EOG091G0LZ0/ALICUT_EOG091G0LZ0.clustalo.fasta per_gene/EOG091G0LZ0/ALICUT_EOG091G0LZ0.clustalo.fasta.backup
              bash ../scripts/remove_empty.sh per_gene/EOG091G0LZ0/ALICUT_EOG091G0LZ0.clustalo.fasta.backup > per_gene/EOG091G0LZ0/ALICUT_EOG091G0LZ0.clustalo.fasta
         fi
         touch per_gene/EOG091G0LZ0/empty_check.done
         
[Sun Jul  5 22:55:36 2020]
Finished job 1521.
1538 of 3292 steps (47%) done

[Sun Jul  5 22:55:36 2020]
rule find_best_model:
    input: per_gene/EOG091G0LZ0/ALICUT_EOG091G0LZ0.clustalo.fasta, per_gene/EOG091G0LZ0/empty_check.done
    output: per_gene/EOG091G0LZ0/EOG091G0LZ0.best_model
    log: per_gene/EOG091G0LZ0/find_best_model.stderr.txt
    jobid: 698
    wildcards: BUSCO=EOG091G0LZ0
    threads: 2


        cd per_gene/EOG091G0LZ0
        if [ ! -d find_best_model ]
        then
            mkdir find_best_model
        fi
        cd find_best_model
        ln -s ../../../per_gene/EOG091G0LZ0/ALICUT_EOG091G0LZ0.clustalo.fasta EOG091G0LZ0.fasta
        ProteinModelSelection.pl EOG091G0LZ0.fasta 1> ../../../per_gene/EOG091G0LZ0/EOG091G0LZ0.best_model 2> ../../../per_gene/EOG091G0LZ0/find_best_model.stderr.txt
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/c0c09ee657b1e27f2c5687e0e9aa8d70.simg
[Sun Jul  5 22:55:38 2020]
Finished job 2854.
1539 of 3292 steps (47%) done

[Sun Jul  5 22:55:38 2020]
rule get_outgroups:
    input: per_gene/EOG091G0TRW/EOG091G0TRW.ingroup.fasta
    output: per_gene/EOG091G0TRW/EOG091G0TRW.orthodb.fasta, per_gene/EOG091G0TRW/EOG091G0TRW.outgroup.fasta
    log: per_gene/EOG091G0TRW/get_outgroups.stdout.txt, per_gene/EOG091G0TRW/get_outgroups.stderr.txt
    jobid: 2855
    wildcards: BUSCO=EOG091G0TRW


        #download fastas from Orhtodb for BUSCO id
        for i in {1..5}
        do
             wget "http://www.orthodb.org/fasta?query=EOG091G0TRW&level=33208" -O per_gene/EOG091G0TRW/EOG091G0TRW.orthodb.fasta 1> per_gene/EOG091G0TRW/get_outgroups.stdout.txt 2> per_gene/EOG091G0TRW/get_outgroups.stderr.txt && break || echo -e "try again ($i)" && sleep 15
        done

	#This is quick an dirty for now and just takes the first protein if there is more than one for an outgroup taxon
        bash ../scripts/download_outgroups.sh taxids.txt per_gene/EOG091G0TRW/EOG091G0TRW.orthodb.fasta > per_gene/EOG091G0TRW/EOG091G0TRW.outgroup.fasta
        
[Sun Jul  5 22:55:38 2020]
Finished job 2855.
1540 of 3292 steps (47%) done

[Sun Jul  5 22:55:38 2020]
rule join_groups:
    input: per_gene/EOG091G0TRW/EOG091G0TRW.ingroup.fasta, per_gene/EOG091G0TRW/EOG091G0TRW.outgroup.fasta
    output: per_gene/EOG091G0TRW/EOG091G0TRW.fasta
    jobid: 2251
    wildcards: BUSCO=EOG091G0TRW


        cat per_gene/EOG091G0TRW/EOG091G0TRW.ingroup.fasta per_gene/EOG091G0TRW/EOG091G0TRW.outgroup.fasta > per_gene/EOG091G0TRW/EOG091G0TRW.fasta
        
[Sun Jul  5 22:55:39 2020]
Finished job 2251.
1541 of 3292 steps (47%) done

[Sun Jul  5 22:55:39 2020]
rule MSA:
    input: per_gene/EOG091G0TRW/EOG091G0TRW.fasta
    output: per_gene/EOG091G0TRW/EOG091G0TRW.clustalo.fasta
    log: per_gene/EOG091G0TRW/MSA.stdout.txt, per_gene/EOG091G0TRW/MSA.stderr.txt
    jobid: 1622
    wildcards: BUSCO=EOG091G0TRW
    threads: 2


        clustalo -i per_gene/EOG091G0TRW/EOG091G0TRW.fasta -o per_gene/EOG091G0TRW/EOG091G0TRW.clustalo.fasta --threads=2 1> per_gene/EOG091G0TRW/MSA.stdout.txt 2> per_gene/EOG091G0TRW/MSA.stderr.txt
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/d68c9691725a7401923680874285c430.simg
[Sun Jul  5 22:55:39 2020]
Finished job 1622.
1542 of 3292 steps (47%) done

[Sun Jul  5 22:55:39 2020]
rule score_and_cut:
    input: per_gene/EOG091G0TRW/EOG091G0TRW.clustalo.fasta
    output: per_gene/EOG091G0TRW/ALICUT_EOG091G0TRW.clustalo.fasta
    jobid: 799
    wildcards: BUSCO=EOG091G0TRW
    threads: 2


        cd per_gene/EOG091G0TRW
        Aliscore.pl -N -r 200000000000000000 -i ../../per_gene/EOG091G0TRW/EOG091G0TRW.clustalo.fasta &> aliscore.log
        ALICUT.pl -s &> alicut.log
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/63c88c27a0fa300f57066b0ef65fefcb.simg
[Sun Jul  5 22:55:41 2020]
Finished job 1143.
1543 of 3292 steps (47%) done

[Sun Jul  5 22:55:41 2020]
rule remove_empty:
    input: per_gene/EOG091G0HSB/ALICUT_EOG091G0HSB.clustalo.fasta
    output: per_gene/EOG091G0HSB/empty_check.done
    jobid: 1965
    wildcards: BUSCO=EOG091G0HSB


         if [ "$(cat per_gene/EOG091G0HSB/ALICUT_EOG091G0HSB.clustalo.fasta | grep -v ">" | sed 's/-//g' | grep "^$" | wc -l)" -gt 0 ]
         then
              cp per_gene/EOG091G0HSB/ALICUT_EOG091G0HSB.clustalo.fasta per_gene/EOG091G0HSB/ALICUT_EOG091G0HSB.clustalo.fasta.backup
              bash ../scripts/remove_empty.sh per_gene/EOG091G0HSB/ALICUT_EOG091G0HSB.clustalo.fasta.backup > per_gene/EOG091G0HSB/ALICUT_EOG091G0HSB.clustalo.fasta
         fi
         touch per_gene/EOG091G0HSB/empty_check.done
         
[Sun Jul  5 22:55:41 2020]
Finished job 1965.
1544 of 3292 steps (47%) done

[Sun Jul  5 22:55:41 2020]
rule find_best_model:
    input: per_gene/EOG091G0HSB/ALICUT_EOG091G0HSB.clustalo.fasta, per_gene/EOG091G0HSB/empty_check.done
    output: per_gene/EOG091G0HSB/EOG091G0HSB.best_model
    log: per_gene/EOG091G0HSB/find_best_model.stderr.txt
    jobid: 1142
    wildcards: BUSCO=EOG091G0HSB
    threads: 2


        cd per_gene/EOG091G0HSB
        if [ ! -d find_best_model ]
        then
            mkdir find_best_model
        fi
        cd find_best_model
        ln -s ../../../per_gene/EOG091G0HSB/ALICUT_EOG091G0HSB.clustalo.fasta EOG091G0HSB.fasta
        ProteinModelSelection.pl EOG091G0HSB.fasta 1> ../../../per_gene/EOG091G0HSB/EOG091G0HSB.best_model 2> ../../../per_gene/EOG091G0HSB/find_best_model.stderr.txt
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/c0c09ee657b1e27f2c5687e0e9aa8d70.simg
[Sun Jul  5 22:55:42 2020]
Finished job 514.
1545 of 3292 steps (47%) done

[Sun Jul  5 22:55:42 2020]
rule infer_single_ML:
    input: per_gene/EOG091G073F/EOG091G073F.best_model, per_gene/EOG091G073F/ALICUT_EOG091G073F.clustalo.fasta
    output: per_gene/EOG091G073F/EOG091G073F.raxml.done
    log: per_gene/EOG091G073F/infer_single_ML.stdout.txt, per_gene/EOG091G073F/infer_single_ML.stderr.txt
    jobid: 51
    wildcards: BUSCO=EOG091G073F
    threads: 2


        cd per_gene/EOG091G073F
	count=$(cat ../../per_gene/EOG091G073F/ALICUT_EOG091G073F.clustalo.fasta | grep ">" | wc -l)
	if [ "$count" -gt 5 ]
        then
		RAxMLmodel=$(cat ../../per_gene/EOG091G073F/EOG091G073F.best_model | grep "Best" | cut -d ":" -f 2 | tr -d '[:space:]')
                if [ "$(ls -1 | grep "^RAxML" | wc -l)" -ne 0 ]
		then
			rm RAxML*
		fi
        	raxml -f a -T 2 -m PROTGAMMA$RAxMLmodel         	-p 12345 -x 12345 -# 100         	-s ../../per_gene/EOG091G073F/ALICUT_EOG091G073F.clustalo.fasta -n EOG091G073F.clustalo.aln.ALICUT.$RAxMLmodel 		1> ../../per_gene/EOG091G073F/infer_single_ML.stdout.txt 2> ../../per_gene/EOG091G073F/infer_single_ML.stderr.txt
	else
		echo "fasta file per_gene/EOG091G073F/ALICUT_EOG091G073F.clustalo.fasta contains fewer than 5 sequences - skipped" > ../../per_gene/EOG091G073F/infer_single_ML.stdout.txt
		touch raxml.skipped
	fi
        touch ../../per_gene/EOG091G073F/EOG091G073F.raxml.done
        
[Sun Jul  5 22:55:45 2020]
Finished job 2636.
1546 of 3292 steps (47%) done

[Sun Jul  5 22:55:45 2020]
rule get_outgroups:
    input: per_gene/EOG091G0BKZ/EOG091G0BKZ.ingroup.fasta
    output: per_gene/EOG091G0BKZ/EOG091G0BKZ.orthodb.fasta, per_gene/EOG091G0BKZ/EOG091G0BKZ.outgroup.fasta
    log: per_gene/EOG091G0BKZ/get_outgroups.stdout.txt, per_gene/EOG091G0BKZ/get_outgroups.stderr.txt
    jobid: 2637
    wildcards: BUSCO=EOG091G0BKZ


        #download fastas from Orhtodb for BUSCO id
        for i in {1..5}
        do
             wget "http://www.orthodb.org/fasta?query=EOG091G0BKZ&level=33208" -O per_gene/EOG091G0BKZ/EOG091G0BKZ.orthodb.fasta 1> per_gene/EOG091G0BKZ/get_outgroups.stdout.txt 2> per_gene/EOG091G0BKZ/get_outgroups.stderr.txt && break || echo -e "try again ($i)" && sleep 15
        done

	#This is quick an dirty for now and just takes the first protein if there is more than one for an outgroup taxon
        bash ../scripts/download_outgroups.sh taxids.txt per_gene/EOG091G0BKZ/EOG091G0BKZ.orthodb.fasta > per_gene/EOG091G0BKZ/EOG091G0BKZ.outgroup.fasta
        
[33mJob counts:
	count	jobs
	1	infer_single_ML
	1[0m
[33m
        cd per_gene/EOG091G073F
	count=$(cat ../../per_gene/EOG091G073F/ALICUT_EOG091G073F.clustalo.fasta | grep ">" | wc -l)
	if [ "$count" -gt 5 ]
        then
		RAxMLmodel=$(cat ../../per_gene/EOG091G073F/EOG091G073F.best_model | grep "Best" | cut -d ":" -f 2 | tr -d '[:space:]')
                if [ "$(ls -1 | grep "^RAxML" | wc -l)" -ne 0 ]
		then
			rm RAxML*
		fi
        	raxml -f a -T 2 -m PROTGAMMA$RAxMLmodel         	-p 12345 -x 12345 -# 100         	-s ../../per_gene/EOG091G073F/ALICUT_EOG091G073F.clustalo.fasta -n EOG091G073F.clustalo.aln.ALICUT.$RAxMLmodel 		1> ../../per_gene/EOG091G073F/infer_single_ML.stdout.txt 2> ../../per_gene/EOG091G073F/infer_single_ML.stderr.txt
	else
		echo "fasta file per_gene/EOG091G073F/ALICUT_EOG091G073F.clustalo.fasta contains fewer than 5 sequences - skipped" > ../../per_gene/EOG091G073F/infer_single_ML.stdout.txt
		touch raxml.skipped
	fi
        touch ../../per_gene/EOG091G073F/EOG091G073F.raxml.done
        [0m
[Sun Jul  5 22:55:45 2020]
Finished job 2637.
1547 of 3292 steps (47%) done

[Sun Jul  5 22:55:45 2020]
rule join_groups:
    input: per_gene/EOG091G0BKZ/EOG091G0BKZ.ingroup.fasta, per_gene/EOG091G0BKZ/EOG091G0BKZ.outgroup.fasta
    output: per_gene/EOG091G0BKZ/EOG091G0BKZ.fasta
    jobid: 2142
    wildcards: BUSCO=EOG091G0BKZ


        cat per_gene/EOG091G0BKZ/EOG091G0BKZ.ingroup.fasta per_gene/EOG091G0BKZ/EOG091G0BKZ.outgroup.fasta > per_gene/EOG091G0BKZ/EOG091G0BKZ.fasta
        
[Sun Jul  5 22:55:45 2020]
Finished job 2142.
1548 of 3292 steps (47%) done

[Sun Jul  5 22:55:45 2020]
rule MSA:
    input: per_gene/EOG091G0BKZ/EOG091G0BKZ.fasta
    output: per_gene/EOG091G0BKZ/EOG091G0BKZ.clustalo.fasta
    log: per_gene/EOG091G0BKZ/MSA.stdout.txt, per_gene/EOG091G0BKZ/MSA.stderr.txt
    jobid: 1404
    wildcards: BUSCO=EOG091G0BKZ
    threads: 2


        clustalo -i per_gene/EOG091G0BKZ/EOG091G0BKZ.fasta -o per_gene/EOG091G0BKZ/EOG091G0BKZ.clustalo.fasta --threads=2 1> per_gene/EOG091G0BKZ/MSA.stdout.txt 2> per_gene/EOG091G0BKZ/MSA.stderr.txt
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/d68c9691725a7401923680874285c430.simg
[Sun Jul  5 22:55:46 2020]
Finished job 712.
1549 of 3292 steps (47%) done

[Sun Jul  5 22:55:46 2020]
rule infer_single_ML:
    input: per_gene/EOG091G0MP6/EOG091G0MP6.best_model, per_gene/EOG091G0MP6/ALICUT_EOG091G0MP6.clustalo.fasta
    output: per_gene/EOG091G0MP6/EOG091G0MP6.raxml.done
    log: per_gene/EOG091G0MP6/infer_single_ML.stdout.txt, per_gene/EOG091G0MP6/infer_single_ML.stderr.txt
    jobid: 150
    wildcards: BUSCO=EOG091G0MP6
    threads: 2


        cd per_gene/EOG091G0MP6
	count=$(cat ../../per_gene/EOG091G0MP6/ALICUT_EOG091G0MP6.clustalo.fasta | grep ">" | wc -l)
	if [ "$count" -gt 5 ]
        then
		RAxMLmodel=$(cat ../../per_gene/EOG091G0MP6/EOG091G0MP6.best_model | grep "Best" | cut -d ":" -f 2 | tr -d '[:space:]')
                if [ "$(ls -1 | grep "^RAxML" | wc -l)" -ne 0 ]
		then
			rm RAxML*
		fi
        	raxml -f a -T 2 -m PROTGAMMA$RAxMLmodel         	-p 12345 -x 12345 -# 100         	-s ../../per_gene/EOG091G0MP6/ALICUT_EOG091G0MP6.clustalo.fasta -n EOG091G0MP6.clustalo.aln.ALICUT.$RAxMLmodel 		1> ../../per_gene/EOG091G0MP6/infer_single_ML.stdout.txt 2> ../../per_gene/EOG091G0MP6/infer_single_ML.stderr.txt
	else
		echo "fasta file per_gene/EOG091G0MP6/ALICUT_EOG091G0MP6.clustalo.fasta contains fewer than 5 sequences - skipped" > ../../per_gene/EOG091G0MP6/infer_single_ML.stdout.txt
		touch raxml.skipped
	fi
        touch ../../per_gene/EOG091G0MP6/EOG091G0MP6.raxml.done
        
[33mJob counts:
	count	jobs
	1	infer_single_ML
	1[0m
[33m
        cd per_gene/EOG091G0MP6
	count=$(cat ../../per_gene/EOG091G0MP6/ALICUT_EOG091G0MP6.clustalo.fasta | grep ">" | wc -l)
	if [ "$count" -gt 5 ]
        then
		RAxMLmodel=$(cat ../../per_gene/EOG091G0MP6/EOG091G0MP6.best_model | grep "Best" | cut -d ":" -f 2 | tr -d '[:space:]')
                if [ "$(ls -1 | grep "^RAxML" | wc -l)" -ne 0 ]
		then
			rm RAxML*
		fi
        	raxml -f a -T 2 -m PROTGAMMA$RAxMLmodel         	-p 12345 -x 12345 -# 100         	-s ../../per_gene/EOG091G0MP6/ALICUT_EOG091G0MP6.clustalo.fasta -n EOG091G0MP6.clustalo.aln.ALICUT.$RAxMLmodel 		1> ../../per_gene/EOG091G0MP6/infer_single_ML.stdout.txt 2> ../../per_gene/EOG091G0MP6/infer_single_ML.stderr.txt
	else
		echo "fasta file per_gene/EOG091G0MP6/ALICUT_EOG091G0MP6.clustalo.fasta contains fewer than 5 sequences - skipped" > ../../per_gene/EOG091G0MP6/infer_single_ML.stdout.txt
		touch raxml.skipped
	fi
        touch ../../per_gene/EOG091G0MP6/EOG091G0MP6.raxml.done
        [0m
[Sun Jul  5 22:55:48 2020]
Finished job 1404.
1550 of 3292 steps (47%) done

[Sun Jul  5 22:55:48 2020]
rule score_and_cut:
    input: per_gene/EOG091G0BKZ/EOG091G0BKZ.clustalo.fasta
    output: per_gene/EOG091G0BKZ/ALICUT_EOG091G0BKZ.clustalo.fasta
    jobid: 581
    wildcards: BUSCO=EOG091G0BKZ
    threads: 2


        cd per_gene/EOG091G0BKZ
        Aliscore.pl -N -r 200000000000000000 -i ../../per_gene/EOG091G0BKZ/EOG091G0BKZ.clustalo.fasta &> aliscore.log
        ALICUT.pl -s &> alicut.log
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/63c88c27a0fa300f57066b0ef65fefcb.simg
[Sun Jul  5 22:55:52 2020]
Finished job 799.
1551 of 3292 steps (47%) done

[Sun Jul  5 22:55:52 2020]
rule remove_empty:
    input: per_gene/EOG091G0TRW/ALICUT_EOG091G0TRW.clustalo.fasta
    output: per_gene/EOG091G0TRW/empty_check.done
    jobid: 1621
    wildcards: BUSCO=EOG091G0TRW


         if [ "$(cat per_gene/EOG091G0TRW/ALICUT_EOG091G0TRW.clustalo.fasta | grep -v ">" | sed 's/-//g' | grep "^$" | wc -l)" -gt 0 ]
         then
              cp per_gene/EOG091G0TRW/ALICUT_EOG091G0TRW.clustalo.fasta per_gene/EOG091G0TRW/ALICUT_EOG091G0TRW.clustalo.fasta.backup
              bash ../scripts/remove_empty.sh per_gene/EOG091G0TRW/ALICUT_EOG091G0TRW.clustalo.fasta.backup > per_gene/EOG091G0TRW/ALICUT_EOG091G0TRW.clustalo.fasta
         fi
         touch per_gene/EOG091G0TRW/empty_check.done
         
[Sun Jul  5 22:55:52 2020]
Finished job 1621.
1552 of 3292 steps (47%) done

[Sun Jul  5 22:55:52 2020]
rule find_best_model:
    input: per_gene/EOG091G0TRW/ALICUT_EOG091G0TRW.clustalo.fasta, per_gene/EOG091G0TRW/empty_check.done
    output: per_gene/EOG091G0TRW/EOG091G0TRW.best_model
    log: per_gene/EOG091G0TRW/find_best_model.stderr.txt
    jobid: 798
    wildcards: BUSCO=EOG091G0TRW
    threads: 2


        cd per_gene/EOG091G0TRW
        if [ ! -d find_best_model ]
        then
            mkdir find_best_model
        fi
        cd find_best_model
        ln -s ../../../per_gene/EOG091G0TRW/ALICUT_EOG091G0TRW.clustalo.fasta EOG091G0TRW.fasta
        ProteinModelSelection.pl EOG091G0TRW.fasta 1> ../../../per_gene/EOG091G0TRW/EOG091G0TRW.best_model 2> ../../../per_gene/EOG091G0TRW/find_best_model.stderr.txt
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/c0c09ee657b1e27f2c5687e0e9aa8d70.simg
[Sun Jul  5 22:56:04 2020]
Finished job 698.
1553 of 3292 steps (47%) done

[Sun Jul  5 22:56:04 2020]
rule infer_single_ML:
    input: per_gene/EOG091G0LZ0/EOG091G0LZ0.best_model, per_gene/EOG091G0LZ0/ALICUT_EOG091G0LZ0.clustalo.fasta
    output: per_gene/EOG091G0LZ0/EOG091G0LZ0.raxml.done
    log: per_gene/EOG091G0LZ0/infer_single_ML.stdout.txt, per_gene/EOG091G0LZ0/infer_single_ML.stderr.txt
    jobid: 143
    wildcards: BUSCO=EOG091G0LZ0
    threads: 2


        cd per_gene/EOG091G0LZ0
	count=$(cat ../../per_gene/EOG091G0LZ0/ALICUT_EOG091G0LZ0.clustalo.fasta | grep ">" | wc -l)
	if [ "$count" -gt 5 ]
        then
		RAxMLmodel=$(cat ../../per_gene/EOG091G0LZ0/EOG091G0LZ0.best_model | grep "Best" | cut -d ":" -f 2 | tr -d '[:space:]')
                if [ "$(ls -1 | grep "^RAxML" | wc -l)" -ne 0 ]
		then
			rm RAxML*
		fi
        	raxml -f a -T 2 -m PROTGAMMA$RAxMLmodel         	-p 12345 -x 12345 -# 100         	-s ../../per_gene/EOG091G0LZ0/ALICUT_EOG091G0LZ0.clustalo.fasta -n EOG091G0LZ0.clustalo.aln.ALICUT.$RAxMLmodel 		1> ../../per_gene/EOG091G0LZ0/infer_single_ML.stdout.txt 2> ../../per_gene/EOG091G0LZ0/infer_single_ML.stderr.txt
	else
		echo "fasta file per_gene/EOG091G0LZ0/ALICUT_EOG091G0LZ0.clustalo.fasta contains fewer than 5 sequences - skipped" > ../../per_gene/EOG091G0LZ0/infer_single_ML.stdout.txt
		touch raxml.skipped
	fi
        touch ../../per_gene/EOG091G0LZ0/EOG091G0LZ0.raxml.done
        
[Sun Jul  5 22:56:04 2020]
Finished job 581.
1554 of 3292 steps (47%) done

[Sun Jul  5 22:56:04 2020]
rule remove_empty:
    input: per_gene/EOG091G0BKZ/ALICUT_EOG091G0BKZ.clustalo.fasta
    output: per_gene/EOG091G0BKZ/empty_check.done
    jobid: 1403
    wildcards: BUSCO=EOG091G0BKZ


         if [ "$(cat per_gene/EOG091G0BKZ/ALICUT_EOG091G0BKZ.clustalo.fasta | grep -v ">" | sed 's/-//g' | grep "^$" | wc -l)" -gt 0 ]
         then
              cp per_gene/EOG091G0BKZ/ALICUT_EOG091G0BKZ.clustalo.fasta per_gene/EOG091G0BKZ/ALICUT_EOG091G0BKZ.clustalo.fasta.backup
              bash ../scripts/remove_empty.sh per_gene/EOG091G0BKZ/ALICUT_EOG091G0BKZ.clustalo.fasta.backup > per_gene/EOG091G0BKZ/ALICUT_EOG091G0BKZ.clustalo.fasta
         fi
         touch per_gene/EOG091G0BKZ/empty_check.done
         
[Sun Jul  5 22:56:04 2020]
Finished job 1403.
1555 of 3292 steps (47%) done

[Sun Jul  5 22:56:04 2020]
rule find_best_model:
    input: per_gene/EOG091G0BKZ/ALICUT_EOG091G0BKZ.clustalo.fasta, per_gene/EOG091G0BKZ/empty_check.done
    output: per_gene/EOG091G0BKZ/EOG091G0BKZ.best_model
    log: per_gene/EOG091G0BKZ/find_best_model.stderr.txt
    jobid: 580
    wildcards: BUSCO=EOG091G0BKZ
    threads: 2


        cd per_gene/EOG091G0BKZ
        if [ ! -d find_best_model ]
        then
            mkdir find_best_model
        fi
        cd find_best_model
        ln -s ../../../per_gene/EOG091G0BKZ/ALICUT_EOG091G0BKZ.clustalo.fasta EOG091G0BKZ.fasta
        ProteinModelSelection.pl EOG091G0BKZ.fasta 1> ../../../per_gene/EOG091G0BKZ/EOG091G0BKZ.best_model 2> ../../../per_gene/EOG091G0BKZ/find_best_model.stderr.txt
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/c0c09ee657b1e27f2c5687e0e9aa8d70.simg
[33mJob counts:
	count	jobs
	1	infer_single_ML
	1[0m
[33m
        cd per_gene/EOG091G0LZ0
	count=$(cat ../../per_gene/EOG091G0LZ0/ALICUT_EOG091G0LZ0.clustalo.fasta | grep ">" | wc -l)
	if [ "$count" -gt 5 ]
        then
		RAxMLmodel=$(cat ../../per_gene/EOG091G0LZ0/EOG091G0LZ0.best_model | grep "Best" | cut -d ":" -f 2 | tr -d '[:space:]')
                if [ "$(ls -1 | grep "^RAxML" | wc -l)" -ne 0 ]
		then
			rm RAxML*
		fi
        	raxml -f a -T 2 -m PROTGAMMA$RAxMLmodel         	-p 12345 -x 12345 -# 100         	-s ../../per_gene/EOG091G0LZ0/ALICUT_EOG091G0LZ0.clustalo.fasta -n EOG091G0LZ0.clustalo.aln.ALICUT.$RAxMLmodel 		1> ../../per_gene/EOG091G0LZ0/infer_single_ML.stdout.txt 2> ../../per_gene/EOG091G0LZ0/infer_single_ML.stderr.txt
	else
		echo "fasta file per_gene/EOG091G0LZ0/ALICUT_EOG091G0LZ0.clustalo.fasta contains fewer than 5 sequences - skipped" > ../../per_gene/EOG091G0LZ0/infer_single_ML.stdout.txt
		touch raxml.skipped
	fi
        touch ../../per_gene/EOG091G0LZ0/EOG091G0LZ0.raxml.done
        [0m
[Sun Jul  5 22:56:09 2020]
Finished job 1142.
1556 of 3292 steps (47%) done

[Sun Jul  5 22:56:09 2020]
rule infer_single_ML:
    input: per_gene/EOG091G0HSB/EOG091G0HSB.best_model, per_gene/EOG091G0HSB/ALICUT_EOG091G0HSB.clustalo.fasta
    output: per_gene/EOG091G0HSB/EOG091G0HSB.raxml.done
    log: per_gene/EOG091G0HSB/infer_single_ML.stdout.txt, per_gene/EOG091G0HSB/infer_single_ML.stderr.txt
    jobid: 365
    wildcards: BUSCO=EOG091G0HSB
    threads: 2


        cd per_gene/EOG091G0HSB
	count=$(cat ../../per_gene/EOG091G0HSB/ALICUT_EOG091G0HSB.clustalo.fasta | grep ">" | wc -l)
	if [ "$count" -gt 5 ]
        then
		RAxMLmodel=$(cat ../../per_gene/EOG091G0HSB/EOG091G0HSB.best_model | grep "Best" | cut -d ":" -f 2 | tr -d '[:space:]')
                if [ "$(ls -1 | grep "^RAxML" | wc -l)" -ne 0 ]
		then
			rm RAxML*
		fi
        	raxml -f a -T 2 -m PROTGAMMA$RAxMLmodel         	-p 12345 -x 12345 -# 100         	-s ../../per_gene/EOG091G0HSB/ALICUT_EOG091G0HSB.clustalo.fasta -n EOG091G0HSB.clustalo.aln.ALICUT.$RAxMLmodel 		1> ../../per_gene/EOG091G0HSB/infer_single_ML.stdout.txt 2> ../../per_gene/EOG091G0HSB/infer_single_ML.stderr.txt
	else
		echo "fasta file per_gene/EOG091G0HSB/ALICUT_EOG091G0HSB.clustalo.fasta contains fewer than 5 sequences - skipped" > ../../per_gene/EOG091G0HSB/infer_single_ML.stdout.txt
		touch raxml.skipped
	fi
        touch ../../per_gene/EOG091G0HSB/EOG091G0HSB.raxml.done
        
[33mJob counts:
	count	jobs
	1	infer_single_ML
	1[0m
[33m
        cd per_gene/EOG091G0HSB
	count=$(cat ../../per_gene/EOG091G0HSB/ALICUT_EOG091G0HSB.clustalo.fasta | grep ">" | wc -l)
	if [ "$count" -gt 5 ]
        then
		RAxMLmodel=$(cat ../../per_gene/EOG091G0HSB/EOG091G0HSB.best_model | grep "Best" | cut -d ":" -f 2 | tr -d '[:space:]')
                if [ "$(ls -1 | grep "^RAxML" | wc -l)" -ne 0 ]
		then
			rm RAxML*
		fi
        	raxml -f a -T 2 -m PROTGAMMA$RAxMLmodel         	-p 12345 -x 12345 -# 100         	-s ../../per_gene/EOG091G0HSB/ALICUT_EOG091G0HSB.clustalo.fasta -n EOG091G0HSB.clustalo.aln.ALICUT.$RAxMLmodel 		1> ../../per_gene/EOG091G0HSB/infer_single_ML.stdout.txt 2> ../../per_gene/EOG091G0HSB/infer_single_ML.stderr.txt
	else
		echo "fasta file per_gene/EOG091G0HSB/ALICUT_EOG091G0HSB.clustalo.fasta contains fewer than 5 sequences - skipped" > ../../per_gene/EOG091G0HSB/infer_single_ML.stdout.txt
		touch raxml.skipped
	fi
        touch ../../per_gene/EOG091G0HSB/EOG091G0HSB.raxml.done
        [0m
[Sun Jul  5 22:56:14 2020]
Finished job 393.
1557 of 3292 steps (47%) done

[Sun Jul  5 22:56:14 2020]
rule find_best_model:
    input: per_gene/EOG091G0UE6/ALICUT_EOG091G0UE6.clustalo.fasta, per_gene/EOG091G0UE6/empty_check.done
    output: per_gene/EOG091G0UE6/EOG091G0UE6.best_model
    log: per_gene/EOG091G0UE6/find_best_model.stderr.txt
    jobid: 974
    wildcards: BUSCO=EOG091G0UE6
    threads: 2


        cd per_gene/EOG091G0UE6
        if [ ! -d find_best_model ]
        then
            mkdir find_best_model
        fi
        cd find_best_model
        ln -s ../../../per_gene/EOG091G0UE6/ALICUT_EOG091G0UE6.clustalo.fasta EOG091G0UE6.fasta
        ProteinModelSelection.pl EOG091G0UE6.fasta 1> ../../../per_gene/EOG091G0UE6/EOG091G0UE6.best_model 2> ../../../per_gene/EOG091G0UE6/find_best_model.stderr.txt
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/c0c09ee657b1e27f2c5687e0e9aa8d70.simg
[Sun Jul  5 22:56:18 2020]
Finished job 391.
1558 of 3292 steps (47%) done

[Sun Jul  5 22:56:18 2020]
rule get_seqs:
    input: /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ingroup.txt, /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/outgroup.txt
    output: per_gene/EOG091G0PNO/EOG091G0PNO.ingroup.fasta
    log: per_gene/EOG091G0PNO/get_seqs.stdout.txt, per_gene/EOG091G0PNO/get_seqs.stderr.txt
    jobid: 2806
    wildcards: BUSCO=EOG091G0PNO
    threads: 2


	basedir=$(pwd)
        cd per_gene/EOG091G0PNO
        
        bash $basedir/../scripts/fetch_seqs.sh EOG091G0PNO /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ingroup.txt /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/outgroup.txt 1> ../../per_gene/EOG091G0PNO/get_seqs.stdout.txt 2> ../../per_gene/EOG091G0PNO/get_seqs.stderr.txt
	mv EOG091G0PNO.fasta $basedir/per_gene/EOG091G0PNO/EOG091G0PNO.ingroup.fasta
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/72476f9d9a5bd0627b4d721143a21354.simg
[Sun Jul  5 22:56:19 2020]
Finished job 798.
1559 of 3292 steps (47%) done

[Sun Jul  5 22:56:19 2020]
rule infer_single_ML:
    input: per_gene/EOG091G0TRW/EOG091G0TRW.best_model, per_gene/EOG091G0TRW/ALICUT_EOG091G0TRW.clustalo.fasta
    output: per_gene/EOG091G0TRW/EOG091G0TRW.raxml.done
    log: per_gene/EOG091G0TRW/infer_single_ML.stdout.txt, per_gene/EOG091G0TRW/infer_single_ML.stderr.txt
    jobid: 193
    wildcards: BUSCO=EOG091G0TRW
    threads: 2


        cd per_gene/EOG091G0TRW
	count=$(cat ../../per_gene/EOG091G0TRW/ALICUT_EOG091G0TRW.clustalo.fasta | grep ">" | wc -l)
	if [ "$count" -gt 5 ]
        then
		RAxMLmodel=$(cat ../../per_gene/EOG091G0TRW/EOG091G0TRW.best_model | grep "Best" | cut -d ":" -f 2 | tr -d '[:space:]')
                if [ "$(ls -1 | grep "^RAxML" | wc -l)" -ne 0 ]
		then
			rm RAxML*
		fi
        	raxml -f a -T 2 -m PROTGAMMA$RAxMLmodel         	-p 12345 -x 12345 -# 100         	-s ../../per_gene/EOG091G0TRW/ALICUT_EOG091G0TRW.clustalo.fasta -n EOG091G0TRW.clustalo.aln.ALICUT.$RAxMLmodel 		1> ../../per_gene/EOG091G0TRW/infer_single_ML.stdout.txt 2> ../../per_gene/EOG091G0TRW/infer_single_ML.stderr.txt
	else
		echo "fasta file per_gene/EOG091G0TRW/ALICUT_EOG091G0TRW.clustalo.fasta contains fewer than 5 sequences - skipped" > ../../per_gene/EOG091G0TRW/infer_single_ML.stdout.txt
		touch raxml.skipped
	fi
        touch ../../per_gene/EOG091G0TRW/EOG091G0TRW.raxml.done
        
[33mJob counts:
	count	jobs
	1	infer_single_ML
	1[0m
[33m
        cd per_gene/EOG091G0TRW
	count=$(cat ../../per_gene/EOG091G0TRW/ALICUT_EOG091G0TRW.clustalo.fasta | grep ">" | wc -l)
	if [ "$count" -gt 5 ]
        then
		RAxMLmodel=$(cat ../../per_gene/EOG091G0TRW/EOG091G0TRW.best_model | grep "Best" | cut -d ":" -f 2 | tr -d '[:space:]')
                if [ "$(ls -1 | grep "^RAxML" | wc -l)" -ne 0 ]
		then
			rm RAxML*
		fi
        	raxml -f a -T 2 -m PROTGAMMA$RAxMLmodel         	-p 12345 -x 12345 -# 100         	-s ../../per_gene/EOG091G0TRW/ALICUT_EOG091G0TRW.clustalo.fasta -n EOG091G0TRW.clustalo.aln.ALICUT.$RAxMLmodel 		1> ../../per_gene/EOG091G0TRW/infer_single_ML.stdout.txt 2> ../../per_gene/EOG091G0TRW/infer_single_ML.stderr.txt
	else
		echo "fasta file per_gene/EOG091G0TRW/ALICUT_EOG091G0TRW.clustalo.fasta contains fewer than 5 sequences - skipped" > ../../per_gene/EOG091G0TRW/infer_single_ML.stdout.txt
		touch raxml.skipped
	fi
        touch ../../per_gene/EOG091G0TRW/EOG091G0TRW.raxml.done
        [0m
[Sun Jul  5 22:56:31 2020]
Finished job 2806.
1560 of 3292 steps (47%) done

[Sun Jul  5 22:56:31 2020]
rule get_outgroups:
    input: per_gene/EOG091G0PNO/EOG091G0PNO.ingroup.fasta
    output: per_gene/EOG091G0PNO/EOG091G0PNO.orthodb.fasta, per_gene/EOG091G0PNO/EOG091G0PNO.outgroup.fasta
    log: per_gene/EOG091G0PNO/get_outgroups.stdout.txt, per_gene/EOG091G0PNO/get_outgroups.stderr.txt
    jobid: 2807
    wildcards: BUSCO=EOG091G0PNO


        #download fastas from Orhtodb for BUSCO id
        for i in {1..5}
        do
             wget "http://www.orthodb.org/fasta?query=EOG091G0PNO&level=33208" -O per_gene/EOG091G0PNO/EOG091G0PNO.orthodb.fasta 1> per_gene/EOG091G0PNO/get_outgroups.stdout.txt 2> per_gene/EOG091G0PNO/get_outgroups.stderr.txt && break || echo -e "try again ($i)" && sleep 15
        done

	#This is quick an dirty for now and just takes the first protein if there is more than one for an outgroup taxon
        bash ../scripts/download_outgroups.sh taxids.txt per_gene/EOG091G0PNO/EOG091G0PNO.orthodb.fasta > per_gene/EOG091G0PNO/EOG091G0PNO.outgroup.fasta
        
[Sun Jul  5 22:56:31 2020]
Finished job 2807.
1561 of 3292 steps (47%) done

[Sun Jul  5 22:56:31 2020]
rule join_groups:
    input: per_gene/EOG091G0PNO/EOG091G0PNO.ingroup.fasta, per_gene/EOG091G0PNO/EOG091G0PNO.outgroup.fasta
    output: per_gene/EOG091G0PNO/EOG091G0PNO.fasta
    jobid: 2227
    wildcards: BUSCO=EOG091G0PNO


        cat per_gene/EOG091G0PNO/EOG091G0PNO.ingroup.fasta per_gene/EOG091G0PNO/EOG091G0PNO.outgroup.fasta > per_gene/EOG091G0PNO/EOG091G0PNO.fasta
        
[Sun Jul  5 22:56:31 2020]
Finished job 2227.
1562 of 3292 steps (47%) done

[Sun Jul  5 22:56:31 2020]
rule MSA:
    input: per_gene/EOG091G0PNO/EOG091G0PNO.fasta
    output: per_gene/EOG091G0PNO/EOG091G0PNO.clustalo.fasta
    log: per_gene/EOG091G0PNO/MSA.stdout.txt, per_gene/EOG091G0PNO/MSA.stderr.txt
    jobid: 1574
    wildcards: BUSCO=EOG091G0PNO
    threads: 2


        clustalo -i per_gene/EOG091G0PNO/EOG091G0PNO.fasta -o per_gene/EOG091G0PNO/EOG091G0PNO.clustalo.fasta --threads=2 1> per_gene/EOG091G0PNO/MSA.stdout.txt 2> per_gene/EOG091G0PNO/MSA.stderr.txt
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/d68c9691725a7401923680874285c430.simg
[Sun Jul  5 22:56:32 2020]
Finished job 1574.
1563 of 3292 steps (47%) done

[Sun Jul  5 22:56:32 2020]
rule score_and_cut:
    input: per_gene/EOG091G0PNO/EOG091G0PNO.clustalo.fasta
    output: per_gene/EOG091G0PNO/ALICUT_EOG091G0PNO.clustalo.fasta
    jobid: 751
    wildcards: BUSCO=EOG091G0PNO
    threads: 2


        cd per_gene/EOG091G0PNO
        Aliscore.pl -N -r 200000000000000000 -i ../../per_gene/EOG091G0PNO/EOG091G0PNO.clustalo.fasta &> aliscore.log
        ALICUT.pl -s &> alicut.log
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/63c88c27a0fa300f57066b0ef65fefcb.simg
[Sun Jul  5 22:56:36 2020]
Finished job 974.
1564 of 3292 steps (48%) done

[Sun Jul  5 22:56:36 2020]
rule infer_single_ML:
    input: per_gene/EOG091G0UE6/EOG091G0UE6.best_model, per_gene/EOG091G0UE6/ALICUT_EOG091G0UE6.clustalo.fasta
    output: per_gene/EOG091G0UE6/EOG091G0UE6.raxml.done
    log: per_gene/EOG091G0UE6/infer_single_ML.stdout.txt, per_gene/EOG091G0UE6/infer_single_ML.stderr.txt
    jobid: 281
    wildcards: BUSCO=EOG091G0UE6
    threads: 2


        cd per_gene/EOG091G0UE6
	count=$(cat ../../per_gene/EOG091G0UE6/ALICUT_EOG091G0UE6.clustalo.fasta | grep ">" | wc -l)
	if [ "$count" -gt 5 ]
        then
		RAxMLmodel=$(cat ../../per_gene/EOG091G0UE6/EOG091G0UE6.best_model | grep "Best" | cut -d ":" -f 2 | tr -d '[:space:]')
                if [ "$(ls -1 | grep "^RAxML" | wc -l)" -ne 0 ]
		then
			rm RAxML*
		fi
        	raxml -f a -T 2 -m PROTGAMMA$RAxMLmodel         	-p 12345 -x 12345 -# 100         	-s ../../per_gene/EOG091G0UE6/ALICUT_EOG091G0UE6.clustalo.fasta -n EOG091G0UE6.clustalo.aln.ALICUT.$RAxMLmodel 		1> ../../per_gene/EOG091G0UE6/infer_single_ML.stdout.txt 2> ../../per_gene/EOG091G0UE6/infer_single_ML.stderr.txt
	else
		echo "fasta file per_gene/EOG091G0UE6/ALICUT_EOG091G0UE6.clustalo.fasta contains fewer than 5 sequences - skipped" > ../../per_gene/EOG091G0UE6/infer_single_ML.stdout.txt
		touch raxml.skipped
	fi
        touch ../../per_gene/EOG091G0UE6/EOG091G0UE6.raxml.done
        
[33mJob counts:
	count	jobs
	1	infer_single_ML
	1[0m
[33m
        cd per_gene/EOG091G0UE6
	count=$(cat ../../per_gene/EOG091G0UE6/ALICUT_EOG091G0UE6.clustalo.fasta | grep ">" | wc -l)
	if [ "$count" -gt 5 ]
        then
		RAxMLmodel=$(cat ../../per_gene/EOG091G0UE6/EOG091G0UE6.best_model | grep "Best" | cut -d ":" -f 2 | tr -d '[:space:]')
                if [ "$(ls -1 | grep "^RAxML" | wc -l)" -ne 0 ]
		then
			rm RAxML*
		fi
        	raxml -f a -T 2 -m PROTGAMMA$RAxMLmodel         	-p 12345 -x 12345 -# 100         	-s ../../per_gene/EOG091G0UE6/ALICUT_EOG091G0UE6.clustalo.fasta -n EOG091G0UE6.clustalo.aln.ALICUT.$RAxMLmodel 		1> ../../per_gene/EOG091G0UE6/infer_single_ML.stdout.txt 2> ../../per_gene/EOG091G0UE6/infer_single_ML.stderr.txt
	else
		echo "fasta file per_gene/EOG091G0UE6/ALICUT_EOG091G0UE6.clustalo.fasta contains fewer than 5 sequences - skipped" > ../../per_gene/EOG091G0UE6/infer_single_ML.stdout.txt
		touch raxml.skipped
	fi
        touch ../../per_gene/EOG091G0UE6/EOG091G0UE6.raxml.done
        [0m
[Sun Jul  5 22:56:39 2020]
Finished job 308.
1565 of 3292 steps (48%) done

[Sun Jul  5 22:56:39 2020]
rule get_seqs:
    input: /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ingroup.txt, /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/outgroup.txt
    output: per_gene/EOG091G02O6/EOG091G02O6.ingroup.fasta
    log: per_gene/EOG091G02O6/get_seqs.stdout.txt, per_gene/EOG091G02O6/get_seqs.stderr.txt
    jobid: 3120
    wildcards: BUSCO=EOG091G02O6
    threads: 2


	basedir=$(pwd)
        cd per_gene/EOG091G02O6
        
        bash $basedir/../scripts/fetch_seqs.sh EOG091G02O6 /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ingroup.txt /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/outgroup.txt 1> ../../per_gene/EOG091G02O6/get_seqs.stdout.txt 2> ../../per_gene/EOG091G02O6/get_seqs.stderr.txt
	mv EOG091G02O6.fasta $basedir/per_gene/EOG091G02O6/EOG091G02O6.ingroup.fasta
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/72476f9d9a5bd0627b4d721143a21354.simg
[Sun Jul  5 22:56:43 2020]
Finished job 751.
1566 of 3292 steps (48%) done

[Sun Jul  5 22:56:43 2020]
rule remove_empty:
    input: per_gene/EOG091G0PNO/ALICUT_EOG091G0PNO.clustalo.fasta
    output: per_gene/EOG091G0PNO/empty_check.done
    jobid: 1573
    wildcards: BUSCO=EOG091G0PNO


         if [ "$(cat per_gene/EOG091G0PNO/ALICUT_EOG091G0PNO.clustalo.fasta | grep -v ">" | sed 's/-//g' | grep "^$" | wc -l)" -gt 0 ]
         then
              cp per_gene/EOG091G0PNO/ALICUT_EOG091G0PNO.clustalo.fasta per_gene/EOG091G0PNO/ALICUT_EOG091G0PNO.clustalo.fasta.backup
              bash ../scripts/remove_empty.sh per_gene/EOG091G0PNO/ALICUT_EOG091G0PNO.clustalo.fasta.backup > per_gene/EOG091G0PNO/ALICUT_EOG091G0PNO.clustalo.fasta
         fi
         touch per_gene/EOG091G0PNO/empty_check.done
         
[Sun Jul  5 22:56:43 2020]
Finished job 1573.
1567 of 3292 steps (48%) done

[Sun Jul  5 22:56:43 2020]
rule find_best_model:
    input: per_gene/EOG091G0PNO/ALICUT_EOG091G0PNO.clustalo.fasta, per_gene/EOG091G0PNO/empty_check.done
    output: per_gene/EOG091G0PNO/EOG091G0PNO.best_model
    log: per_gene/EOG091G0PNO/find_best_model.stderr.txt
    jobid: 750
    wildcards: BUSCO=EOG091G0PNO
    threads: 2


        cd per_gene/EOG091G0PNO
        if [ ! -d find_best_model ]
        then
            mkdir find_best_model
        fi
        cd find_best_model
        ln -s ../../../per_gene/EOG091G0PNO/ALICUT_EOG091G0PNO.clustalo.fasta EOG091G0PNO.fasta
        ProteinModelSelection.pl EOG091G0PNO.fasta 1> ../../../per_gene/EOG091G0PNO/EOG091G0PNO.best_model 2> ../../../per_gene/EOG091G0PNO/find_best_model.stderr.txt
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/c0c09ee657b1e27f2c5687e0e9aa8d70.simg
[Sun Jul  5 22:56:43 2020]
Finished job 580.
1568 of 3292 steps (48%) done

[Sun Jul  5 22:56:43 2020]
rule infer_single_ML:
    input: per_gene/EOG091G0BKZ/EOG091G0BKZ.best_model, per_gene/EOG091G0BKZ/ALICUT_EOG091G0BKZ.clustalo.fasta
    output: per_gene/EOG091G0BKZ/EOG091G0BKZ.raxml.done
    log: per_gene/EOG091G0BKZ/infer_single_ML.stdout.txt, per_gene/EOG091G0BKZ/infer_single_ML.stderr.txt
    jobid: 84
    wildcards: BUSCO=EOG091G0BKZ
    threads: 2


        cd per_gene/EOG091G0BKZ
	count=$(cat ../../per_gene/EOG091G0BKZ/ALICUT_EOG091G0BKZ.clustalo.fasta | grep ">" | wc -l)
	if [ "$count" -gt 5 ]
        then
		RAxMLmodel=$(cat ../../per_gene/EOG091G0BKZ/EOG091G0BKZ.best_model | grep "Best" | cut -d ":" -f 2 | tr -d '[:space:]')
                if [ "$(ls -1 | grep "^RAxML" | wc -l)" -ne 0 ]
		then
			rm RAxML*
		fi
        	raxml -f a -T 2 -m PROTGAMMA$RAxMLmodel         	-p 12345 -x 12345 -# 100         	-s ../../per_gene/EOG091G0BKZ/ALICUT_EOG091G0BKZ.clustalo.fasta -n EOG091G0BKZ.clustalo.aln.ALICUT.$RAxMLmodel 		1> ../../per_gene/EOG091G0BKZ/infer_single_ML.stdout.txt 2> ../../per_gene/EOG091G0BKZ/infer_single_ML.stderr.txt
	else
		echo "fasta file per_gene/EOG091G0BKZ/ALICUT_EOG091G0BKZ.clustalo.fasta contains fewer than 5 sequences - skipped" > ../../per_gene/EOG091G0BKZ/infer_single_ML.stdout.txt
		touch raxml.skipped
	fi
        touch ../../per_gene/EOG091G0BKZ/EOG091G0BKZ.raxml.done
        
[33mJob counts:
	count	jobs
	1	infer_single_ML
	1[0m
[33m
        cd per_gene/EOG091G0BKZ
	count=$(cat ../../per_gene/EOG091G0BKZ/ALICUT_EOG091G0BKZ.clustalo.fasta | grep ">" | wc -l)
	if [ "$count" -gt 5 ]
        then
		RAxMLmodel=$(cat ../../per_gene/EOG091G0BKZ/EOG091G0BKZ.best_model | grep "Best" | cut -d ":" -f 2 | tr -d '[:space:]')
                if [ "$(ls -1 | grep "^RAxML" | wc -l)" -ne 0 ]
		then
			rm RAxML*
		fi
        	raxml -f a -T 2 -m PROTGAMMA$RAxMLmodel         	-p 12345 -x 12345 -# 100         	-s ../../per_gene/EOG091G0BKZ/ALICUT_EOG091G0BKZ.clustalo.fasta -n EOG091G0BKZ.clustalo.aln.ALICUT.$RAxMLmodel 		1> ../../per_gene/EOG091G0BKZ/infer_single_ML.stdout.txt 2> ../../per_gene/EOG091G0BKZ/infer_single_ML.stderr.txt
	else
		echo "fasta file per_gene/EOG091G0BKZ/ALICUT_EOG091G0BKZ.clustalo.fasta contains fewer than 5 sequences - skipped" > ../../per_gene/EOG091G0BKZ/infer_single_ML.stdout.txt
		touch raxml.skipped
	fi
        touch ../../per_gene/EOG091G0BKZ/EOG091G0BKZ.raxml.done
        [0m
[Sun Jul  5 22:56:54 2020]
Finished job 3120.
1569 of 3292 steps (48%) done

[Sun Jul  5 22:56:55 2020]
rule get_outgroups:
    input: per_gene/EOG091G02O6/EOG091G02O6.ingroup.fasta
    output: per_gene/EOG091G02O6/EOG091G02O6.orthodb.fasta, per_gene/EOG091G02O6/EOG091G02O6.outgroup.fasta
    log: per_gene/EOG091G02O6/get_outgroups.stdout.txt, per_gene/EOG091G02O6/get_outgroups.stderr.txt
    jobid: 3121
    wildcards: BUSCO=EOG091G02O6


        #download fastas from Orhtodb for BUSCO id
        for i in {1..5}
        do
             wget "http://www.orthodb.org/fasta?query=EOG091G02O6&level=33208" -O per_gene/EOG091G02O6/EOG091G02O6.orthodb.fasta 1> per_gene/EOG091G02O6/get_outgroups.stdout.txt 2> per_gene/EOG091G02O6/get_outgroups.stderr.txt && break || echo -e "try again ($i)" && sleep 15
        done

	#This is quick an dirty for now and just takes the first protein if there is more than one for an outgroup taxon
        bash ../scripts/download_outgroups.sh taxids.txt per_gene/EOG091G02O6/EOG091G02O6.orthodb.fasta > per_gene/EOG091G02O6/EOG091G02O6.outgroup.fasta
        
[Sun Jul  5 22:56:55 2020]
Finished job 3121.
1570 of 3292 steps (48%) done

[Sun Jul  5 22:56:56 2020]
rule join_groups:
    input: per_gene/EOG091G02O6/EOG091G02O6.ingroup.fasta, per_gene/EOG091G02O6/EOG091G02O6.outgroup.fasta
    output: per_gene/EOG091G02O6/EOG091G02O6.fasta
    jobid: 2384
    wildcards: BUSCO=EOG091G02O6


        cat per_gene/EOG091G02O6/EOG091G02O6.ingroup.fasta per_gene/EOG091G02O6/EOG091G02O6.outgroup.fasta > per_gene/EOG091G02O6/EOG091G02O6.fasta
        
[Sun Jul  5 22:56:56 2020]
Finished job 2384.
1571 of 3292 steps (48%) done

[Sun Jul  5 22:56:56 2020]
rule MSA:
    input: per_gene/EOG091G02O6/EOG091G02O6.fasta
    output: per_gene/EOG091G02O6/EOG091G02O6.clustalo.fasta
    log: per_gene/EOG091G02O6/MSA.stdout.txt, per_gene/EOG091G02O6/MSA.stderr.txt
    jobid: 1888
    wildcards: BUSCO=EOG091G02O6
    threads: 2


        clustalo -i per_gene/EOG091G02O6/EOG091G02O6.fasta -o per_gene/EOG091G02O6/EOG091G02O6.clustalo.fasta --threads=2 1> per_gene/EOG091G02O6/MSA.stdout.txt 2> per_gene/EOG091G02O6/MSA.stderr.txt
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/d68c9691725a7401923680874285c430.simg
[Sun Jul  5 22:56:59 2020]
Finished job 1888.
1572 of 3292 steps (48%) done

[Sun Jul  5 22:56:59 2020]
rule score_and_cut:
    input: per_gene/EOG091G02O6/EOG091G02O6.clustalo.fasta
    output: per_gene/EOG091G02O6/ALICUT_EOG091G02O6.clustalo.fasta
    jobid: 1065
    wildcards: BUSCO=EOG091G02O6
    threads: 2


        cd per_gene/EOG091G02O6
        Aliscore.pl -N -r 200000000000000000 -i ../../per_gene/EOG091G02O6/EOG091G02O6.clustalo.fasta &> aliscore.log
        ALICUT.pl -s &> alicut.log
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/63c88c27a0fa300f57066b0ef65fefcb.simg
[Sun Jul  5 22:57:10 2020]
Finished job 1065.
1573 of 3292 steps (48%) done

[Sun Jul  5 22:57:10 2020]
rule remove_empty:
    input: per_gene/EOG091G02O6/ALICUT_EOG091G02O6.clustalo.fasta
    output: per_gene/EOG091G02O6/empty_check.done
    jobid: 1887
    wildcards: BUSCO=EOG091G02O6


         if [ "$(cat per_gene/EOG091G02O6/ALICUT_EOG091G02O6.clustalo.fasta | grep -v ">" | sed 's/-//g' | grep "^$" | wc -l)" -gt 0 ]
         then
              cp per_gene/EOG091G02O6/ALICUT_EOG091G02O6.clustalo.fasta per_gene/EOG091G02O6/ALICUT_EOG091G02O6.clustalo.fasta.backup
              bash ../scripts/remove_empty.sh per_gene/EOG091G02O6/ALICUT_EOG091G02O6.clustalo.fasta.backup > per_gene/EOG091G02O6/ALICUT_EOG091G02O6.clustalo.fasta
         fi
         touch per_gene/EOG091G02O6/empty_check.done
         
[Sun Jul  5 22:57:10 2020]
Finished job 1887.
1574 of 3292 steps (48%) done

[Sun Jul  5 22:57:10 2020]
rule find_best_model:
    input: per_gene/EOG091G02O6/ALICUT_EOG091G02O6.clustalo.fasta, per_gene/EOG091G02O6/empty_check.done
    output: per_gene/EOG091G02O6/EOG091G02O6.best_model
    log: per_gene/EOG091G02O6/find_best_model.stderr.txt
    jobid: 1064
    wildcards: BUSCO=EOG091G02O6
    threads: 2


        cd per_gene/EOG091G02O6
        if [ ! -d find_best_model ]
        then
            mkdir find_best_model
        fi
        cd find_best_model
        ln -s ../../../per_gene/EOG091G02O6/ALICUT_EOG091G02O6.clustalo.fasta EOG091G02O6.fasta
        ProteinModelSelection.pl EOG091G02O6.fasta 1> ../../../per_gene/EOG091G02O6/EOG091G02O6.best_model 2> ../../../per_gene/EOG091G02O6/find_best_model.stderr.txt
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/c0c09ee657b1e27f2c5687e0e9aa8d70.simg
[Sun Jul  5 22:57:11 2020]
Finished job 750.
1575 of 3292 steps (48%) done

[Sun Jul  5 22:57:11 2020]
rule infer_single_ML:
    input: per_gene/EOG091G0PNO/EOG091G0PNO.best_model, per_gene/EOG091G0PNO/ALICUT_EOG091G0PNO.clustalo.fasta
    output: per_gene/EOG091G0PNO/EOG091G0PNO.raxml.done
    log: per_gene/EOG091G0PNO/infer_single_ML.stdout.txt, per_gene/EOG091G0PNO/infer_single_ML.stderr.txt
    jobid: 169
    wildcards: BUSCO=EOG091G0PNO
    threads: 2


        cd per_gene/EOG091G0PNO
	count=$(cat ../../per_gene/EOG091G0PNO/ALICUT_EOG091G0PNO.clustalo.fasta | grep ">" | wc -l)
	if [ "$count" -gt 5 ]
        then
		RAxMLmodel=$(cat ../../per_gene/EOG091G0PNO/EOG091G0PNO.best_model | grep "Best" | cut -d ":" -f 2 | tr -d '[:space:]')
                if [ "$(ls -1 | grep "^RAxML" | wc -l)" -ne 0 ]
		then
			rm RAxML*
		fi
        	raxml -f a -T 2 -m PROTGAMMA$RAxMLmodel         	-p 12345 -x 12345 -# 100         	-s ../../per_gene/EOG091G0PNO/ALICUT_EOG091G0PNO.clustalo.fasta -n EOG091G0PNO.clustalo.aln.ALICUT.$RAxMLmodel 		1> ../../per_gene/EOG091G0PNO/infer_single_ML.stdout.txt 2> ../../per_gene/EOG091G0PNO/infer_single_ML.stderr.txt
	else
		echo "fasta file per_gene/EOG091G0PNO/ALICUT_EOG091G0PNO.clustalo.fasta contains fewer than 5 sequences - skipped" > ../../per_gene/EOG091G0PNO/infer_single_ML.stdout.txt
		touch raxml.skipped
	fi
        touch ../../per_gene/EOG091G0PNO/EOG091G0PNO.raxml.done
        
[33mJob counts:
	count	jobs
	1	infer_single_ML
	1[0m
[33m
        cd per_gene/EOG091G0PNO
	count=$(cat ../../per_gene/EOG091G0PNO/ALICUT_EOG091G0PNO.clustalo.fasta | grep ">" | wc -l)
	if [ "$count" -gt 5 ]
        then
		RAxMLmodel=$(cat ../../per_gene/EOG091G0PNO/EOG091G0PNO.best_model | grep "Best" | cut -d ":" -f 2 | tr -d '[:space:]')
                if [ "$(ls -1 | grep "^RAxML" | wc -l)" -ne 0 ]
		then
			rm RAxML*
		fi
        	raxml -f a -T 2 -m PROTGAMMA$RAxMLmodel         	-p 12345 -x 12345 -# 100         	-s ../../per_gene/EOG091G0PNO/ALICUT_EOG091G0PNO.clustalo.fasta -n EOG091G0PNO.clustalo.aln.ALICUT.$RAxMLmodel 		1> ../../per_gene/EOG091G0PNO/infer_single_ML.stdout.txt 2> ../../per_gene/EOG091G0PNO/infer_single_ML.stderr.txt
	else
		echo "fasta file per_gene/EOG091G0PNO/ALICUT_EOG091G0PNO.clustalo.fasta contains fewer than 5 sequences - skipped" > ../../per_gene/EOG091G0PNO/infer_single_ML.stdout.txt
		touch raxml.skipped
	fi
        touch ../../per_gene/EOG091G0PNO/EOG091G0PNO.raxml.done
        [0m
[Sun Jul  5 22:57:43 2020]
Finished job 1064.
1576 of 3292 steps (48%) done

[Sun Jul  5 22:57:43 2020]
rule infer_single_ML:
    input: per_gene/EOG091G02O6/EOG091G02O6.best_model, per_gene/EOG091G02O6/ALICUT_EOG091G02O6.clustalo.fasta
    output: per_gene/EOG091G02O6/EOG091G02O6.raxml.done
    log: per_gene/EOG091G02O6/infer_single_ML.stdout.txt, per_gene/EOG091G02O6/infer_single_ML.stderr.txt
    jobid: 326
    wildcards: BUSCO=EOG091G02O6
    threads: 2


        cd per_gene/EOG091G02O6
	count=$(cat ../../per_gene/EOG091G02O6/ALICUT_EOG091G02O6.clustalo.fasta | grep ">" | wc -l)
	if [ "$count" -gt 5 ]
        then
		RAxMLmodel=$(cat ../../per_gene/EOG091G02O6/EOG091G02O6.best_model | grep "Best" | cut -d ":" -f 2 | tr -d '[:space:]')
                if [ "$(ls -1 | grep "^RAxML" | wc -l)" -ne 0 ]
		then
			rm RAxML*
		fi
        	raxml -f a -T 2 -m PROTGAMMA$RAxMLmodel         	-p 12345 -x 12345 -# 100         	-s ../../per_gene/EOG091G02O6/ALICUT_EOG091G02O6.clustalo.fasta -n EOG091G02O6.clustalo.aln.ALICUT.$RAxMLmodel 		1> ../../per_gene/EOG091G02O6/infer_single_ML.stdout.txt 2> ../../per_gene/EOG091G02O6/infer_single_ML.stderr.txt
	else
		echo "fasta file per_gene/EOG091G02O6/ALICUT_EOG091G02O6.clustalo.fasta contains fewer than 5 sequences - skipped" > ../../per_gene/EOG091G02O6/infer_single_ML.stdout.txt
		touch raxml.skipped
	fi
        touch ../../per_gene/EOG091G02O6/EOG091G02O6.raxml.done
        
[33mJob counts:
	count	jobs
	1	infer_single_ML
	1[0m
[33m
        cd per_gene/EOG091G02O6
	count=$(cat ../../per_gene/EOG091G02O6/ALICUT_EOG091G02O6.clustalo.fasta | grep ">" | wc -l)
	if [ "$count" -gt 5 ]
        then
		RAxMLmodel=$(cat ../../per_gene/EOG091G02O6/EOG091G02O6.best_model | grep "Best" | cut -d ":" -f 2 | tr -d '[:space:]')
                if [ "$(ls -1 | grep "^RAxML" | wc -l)" -ne 0 ]
		then
			rm RAxML*
		fi
        	raxml -f a -T 2 -m PROTGAMMA$RAxMLmodel         	-p 12345 -x 12345 -# 100         	-s ../../per_gene/EOG091G02O6/ALICUT_EOG091G02O6.clustalo.fasta -n EOG091G02O6.clustalo.aln.ALICUT.$RAxMLmodel 		1> ../../per_gene/EOG091G02O6/infer_single_ML.stdout.txt 2> ../../per_gene/EOG091G02O6/infer_single_ML.stderr.txt
	else
		echo "fasta file per_gene/EOG091G02O6/ALICUT_EOG091G02O6.clustalo.fasta contains fewer than 5 sequences - skipped" > ../../per_gene/EOG091G02O6/infer_single_ML.stdout.txt
		touch raxml.skipped
	fi
        touch ../../per_gene/EOG091G02O6/EOG091G02O6.raxml.done
        [0m
[Sun Jul  5 22:57:51 2020]
Finished job 292.
1577 of 3292 steps (48%) done

[Sun Jul  5 22:57:51 2020]
rule get_seqs:
    input: /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ingroup.txt, /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/outgroup.txt
    output: per_gene/EOG091G0CZX/EOG091G0CZX.ingroup.fasta
    log: per_gene/EOG091G0CZX/get_seqs.stdout.txt, per_gene/EOG091G0CZX/get_seqs.stderr.txt
    jobid: 2654
    wildcards: BUSCO=EOG091G0CZX
    threads: 2


	basedir=$(pwd)
        cd per_gene/EOG091G0CZX
        
        bash $basedir/../scripts/fetch_seqs.sh EOG091G0CZX /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ingroup.txt /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/outgroup.txt 1> ../../per_gene/EOG091G0CZX/get_seqs.stdout.txt 2> ../../per_gene/EOG091G0CZX/get_seqs.stderr.txt
	mv EOG091G0CZX.fasta $basedir/per_gene/EOG091G0CZX/EOG091G0CZX.ingroup.fasta
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/72476f9d9a5bd0627b4d721143a21354.simg
[Sun Jul  5 22:58:06 2020]
Finished job 2654.
1578 of 3292 steps (48%) done

[Sun Jul  5 22:58:06 2020]
rule get_outgroups:
    input: per_gene/EOG091G0CZX/EOG091G0CZX.ingroup.fasta
    output: per_gene/EOG091G0CZX/EOG091G0CZX.orthodb.fasta, per_gene/EOG091G0CZX/EOG091G0CZX.outgroup.fasta
    log: per_gene/EOG091G0CZX/get_outgroups.stdout.txt, per_gene/EOG091G0CZX/get_outgroups.stderr.txt
    jobid: 2655
    wildcards: BUSCO=EOG091G0CZX


        #download fastas from Orhtodb for BUSCO id
        for i in {1..5}
        do
             wget "http://www.orthodb.org/fasta?query=EOG091G0CZX&level=33208" -O per_gene/EOG091G0CZX/EOG091G0CZX.orthodb.fasta 1> per_gene/EOG091G0CZX/get_outgroups.stdout.txt 2> per_gene/EOG091G0CZX/get_outgroups.stderr.txt && break || echo -e "try again ($i)" && sleep 15
        done

	#This is quick an dirty for now and just takes the first protein if there is more than one for an outgroup taxon
        bash ../scripts/download_outgroups.sh taxids.txt per_gene/EOG091G0CZX/EOG091G0CZX.orthodb.fasta > per_gene/EOG091G0CZX/EOG091G0CZX.outgroup.fasta
        
[Sun Jul  5 22:58:07 2020]
Finished job 2655.
1579 of 3292 steps (48%) done

[Sun Jul  5 22:58:07 2020]
rule join_groups:
    input: per_gene/EOG091G0CZX/EOG091G0CZX.ingroup.fasta, per_gene/EOG091G0CZX/EOG091G0CZX.outgroup.fasta
    output: per_gene/EOG091G0CZX/EOG091G0CZX.fasta
    jobid: 2151
    wildcards: BUSCO=EOG091G0CZX


        cat per_gene/EOG091G0CZX/EOG091G0CZX.ingroup.fasta per_gene/EOG091G0CZX/EOG091G0CZX.outgroup.fasta > per_gene/EOG091G0CZX/EOG091G0CZX.fasta
        
[Sun Jul  5 22:58:07 2020]
Finished job 2151.
1580 of 3292 steps (48%) done

[Sun Jul  5 22:58:07 2020]
rule MSA:
    input: per_gene/EOG091G0CZX/EOG091G0CZX.fasta
    output: per_gene/EOG091G0CZX/EOG091G0CZX.clustalo.fasta
    log: per_gene/EOG091G0CZX/MSA.stdout.txt, per_gene/EOG091G0CZX/MSA.stderr.txt
    jobid: 1422
    wildcards: BUSCO=EOG091G0CZX
    threads: 2


        clustalo -i per_gene/EOG091G0CZX/EOG091G0CZX.fasta -o per_gene/EOG091G0CZX/EOG091G0CZX.clustalo.fasta --threads=2 1> per_gene/EOG091G0CZX/MSA.stdout.txt 2> per_gene/EOG091G0CZX/MSA.stderr.txt
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/d68c9691725a7401923680874285c430.simg
[Sun Jul  5 22:58:08 2020]
Finished job 1422.
1581 of 3292 steps (48%) done

[Sun Jul  5 22:58:09 2020]
rule score_and_cut:
    input: per_gene/EOG091G0CZX/EOG091G0CZX.clustalo.fasta
    output: per_gene/EOG091G0CZX/ALICUT_EOG091G0CZX.clustalo.fasta
    jobid: 599
    wildcards: BUSCO=EOG091G0CZX
    threads: 2


        cd per_gene/EOG091G0CZX
        Aliscore.pl -N -r 200000000000000000 -i ../../per_gene/EOG091G0CZX/EOG091G0CZX.clustalo.fasta &> aliscore.log
        ALICUT.pl -s &> alicut.log
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/63c88c27a0fa300f57066b0ef65fefcb.simg
[Sun Jul  5 22:58:18 2020]
Finished job 599.
1582 of 3292 steps (48%) done

[Sun Jul  5 22:58:18 2020]
rule remove_empty:
    input: per_gene/EOG091G0CZX/ALICUT_EOG091G0CZX.clustalo.fasta
    output: per_gene/EOG091G0CZX/empty_check.done
    jobid: 1421
    wildcards: BUSCO=EOG091G0CZX


         if [ "$(cat per_gene/EOG091G0CZX/ALICUT_EOG091G0CZX.clustalo.fasta | grep -v ">" | sed 's/-//g' | grep "^$" | wc -l)" -gt 0 ]
         then
              cp per_gene/EOG091G0CZX/ALICUT_EOG091G0CZX.clustalo.fasta per_gene/EOG091G0CZX/ALICUT_EOG091G0CZX.clustalo.fasta.backup
              bash ../scripts/remove_empty.sh per_gene/EOG091G0CZX/ALICUT_EOG091G0CZX.clustalo.fasta.backup > per_gene/EOG091G0CZX/ALICUT_EOG091G0CZX.clustalo.fasta
         fi
         touch per_gene/EOG091G0CZX/empty_check.done
         
[Sun Jul  5 22:58:19 2020]
Finished job 1421.
1583 of 3292 steps (48%) done

[Sun Jul  5 22:58:19 2020]
rule find_best_model:
    input: per_gene/EOG091G0CZX/ALICUT_EOG091G0CZX.clustalo.fasta, per_gene/EOG091G0CZX/empty_check.done
    output: per_gene/EOG091G0CZX/EOG091G0CZX.best_model
    log: per_gene/EOG091G0CZX/find_best_model.stderr.txt
    jobid: 598
    wildcards: BUSCO=EOG091G0CZX
    threads: 2


        cd per_gene/EOG091G0CZX
        if [ ! -d find_best_model ]
        then
            mkdir find_best_model
        fi
        cd find_best_model
        ln -s ../../../per_gene/EOG091G0CZX/ALICUT_EOG091G0CZX.clustalo.fasta EOG091G0CZX.fasta
        ProteinModelSelection.pl EOG091G0CZX.fasta 1> ../../../per_gene/EOG091G0CZX/EOG091G0CZX.best_model 2> ../../../per_gene/EOG091G0CZX/find_best_model.stderr.txt
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/c0c09ee657b1e27f2c5687e0e9aa8d70.simg
[Sun Jul  5 22:58:28 2020]
Finished job 224.
1584 of 3292 steps (48%) done

[Sun Jul  5 22:58:28 2020]
rule get_seqs:
    input: /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ingroup.txt, /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/outgroup.txt
    output: per_gene/EOG091G0RHX/EOG091G0RHX.ingroup.fasta
    log: per_gene/EOG091G0RHX/get_seqs.stdout.txt, per_gene/EOG091G0RHX/get_seqs.stderr.txt
    jobid: 2834
    wildcards: BUSCO=EOG091G0RHX
    threads: 2


	basedir=$(pwd)
        cd per_gene/EOG091G0RHX
        
        bash $basedir/../scripts/fetch_seqs.sh EOG091G0RHX /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ingroup.txt /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/outgroup.txt 1> ../../per_gene/EOG091G0RHX/get_seqs.stdout.txt 2> ../../per_gene/EOG091G0RHX/get_seqs.stderr.txt
	mv EOG091G0RHX.fasta $basedir/per_gene/EOG091G0RHX/EOG091G0RHX.ingroup.fasta
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/72476f9d9a5bd0627b4d721143a21354.simg
[Sun Jul  5 22:58:43 2020]
Finished job 2834.
1585 of 3292 steps (48%) done

[Sun Jul  5 22:58:43 2020]
rule get_outgroups:
    input: per_gene/EOG091G0RHX/EOG091G0RHX.ingroup.fasta
    output: per_gene/EOG091G0RHX/EOG091G0RHX.orthodb.fasta, per_gene/EOG091G0RHX/EOG091G0RHX.outgroup.fasta
    log: per_gene/EOG091G0RHX/get_outgroups.stdout.txt, per_gene/EOG091G0RHX/get_outgroups.stderr.txt
    jobid: 2835
    wildcards: BUSCO=EOG091G0RHX


        #download fastas from Orhtodb for BUSCO id
        for i in {1..5}
        do
             wget "http://www.orthodb.org/fasta?query=EOG091G0RHX&level=33208" -O per_gene/EOG091G0RHX/EOG091G0RHX.orthodb.fasta 1> per_gene/EOG091G0RHX/get_outgroups.stdout.txt 2> per_gene/EOG091G0RHX/get_outgroups.stderr.txt && break || echo -e "try again ($i)" && sleep 15
        done

	#This is quick an dirty for now and just takes the first protein if there is more than one for an outgroup taxon
        bash ../scripts/download_outgroups.sh taxids.txt per_gene/EOG091G0RHX/EOG091G0RHX.orthodb.fasta > per_gene/EOG091G0RHX/EOG091G0RHX.outgroup.fasta
        
[Sun Jul  5 22:58:45 2020]
Finished job 2835.
1586 of 3292 steps (48%) done

[Sun Jul  5 22:58:45 2020]
rule join_groups:
    input: per_gene/EOG091G0RHX/EOG091G0RHX.ingroup.fasta, per_gene/EOG091G0RHX/EOG091G0RHX.outgroup.fasta
    output: per_gene/EOG091G0RHX/EOG091G0RHX.fasta
    jobid: 2241
    wildcards: BUSCO=EOG091G0RHX


        cat per_gene/EOG091G0RHX/EOG091G0RHX.ingroup.fasta per_gene/EOG091G0RHX/EOG091G0RHX.outgroup.fasta > per_gene/EOG091G0RHX/EOG091G0RHX.fasta
        
[Sun Jul  5 22:58:45 2020]
Finished job 2241.
1587 of 3292 steps (48%) done

[Sun Jul  5 22:58:45 2020]
rule MSA:
    input: per_gene/EOG091G0RHX/EOG091G0RHX.fasta
    output: per_gene/EOG091G0RHX/EOG091G0RHX.clustalo.fasta
    log: per_gene/EOG091G0RHX/MSA.stdout.txt, per_gene/EOG091G0RHX/MSA.stderr.txt
    jobid: 1602
    wildcards: BUSCO=EOG091G0RHX
    threads: 2


        clustalo -i per_gene/EOG091G0RHX/EOG091G0RHX.fasta -o per_gene/EOG091G0RHX/EOG091G0RHX.clustalo.fasta --threads=2 1> per_gene/EOG091G0RHX/MSA.stdout.txt 2> per_gene/EOG091G0RHX/MSA.stderr.txt
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/d68c9691725a7401923680874285c430.simg
[Sun Jul  5 22:58:45 2020]
Finished job 1602.
1588 of 3292 steps (48%) done

[Sun Jul  5 22:58:45 2020]
rule score_and_cut:
    input: per_gene/EOG091G0RHX/EOG091G0RHX.clustalo.fasta
    output: per_gene/EOG091G0RHX/ALICUT_EOG091G0RHX.clustalo.fasta
    jobid: 779
    wildcards: BUSCO=EOG091G0RHX
    threads: 2


        cd per_gene/EOG091G0RHX
        Aliscore.pl -N -r 200000000000000000 -i ../../per_gene/EOG091G0RHX/EOG091G0RHX.clustalo.fasta &> aliscore.log
        ALICUT.pl -s &> alicut.log
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/63c88c27a0fa300f57066b0ef65fefcb.simg
[Sun Jul  5 22:58:55 2020]
Finished job 779.
1589 of 3292 steps (48%) done

[Sun Jul  5 22:58:55 2020]
rule remove_empty:
    input: per_gene/EOG091G0RHX/ALICUT_EOG091G0RHX.clustalo.fasta
    output: per_gene/EOG091G0RHX/empty_check.done
    jobid: 1601
    wildcards: BUSCO=EOG091G0RHX


         if [ "$(cat per_gene/EOG091G0RHX/ALICUT_EOG091G0RHX.clustalo.fasta | grep -v ">" | sed 's/-//g' | grep "^$" | wc -l)" -gt 0 ]
         then
              cp per_gene/EOG091G0RHX/ALICUT_EOG091G0RHX.clustalo.fasta per_gene/EOG091G0RHX/ALICUT_EOG091G0RHX.clustalo.fasta.backup
              bash ../scripts/remove_empty.sh per_gene/EOG091G0RHX/ALICUT_EOG091G0RHX.clustalo.fasta.backup > per_gene/EOG091G0RHX/ALICUT_EOG091G0RHX.clustalo.fasta
         fi
         touch per_gene/EOG091G0RHX/empty_check.done
         
[Sun Jul  5 22:58:55 2020]
Finished job 598.
1590 of 3292 steps (48%) done

[Sun Jul  5 22:58:55 2020]
rule infer_single_ML:
    input: per_gene/EOG091G0CZX/EOG091G0CZX.best_model, per_gene/EOG091G0CZX/ALICUT_EOG091G0CZX.clustalo.fasta
    output: per_gene/EOG091G0CZX/EOG091G0CZX.raxml.done
    log: per_gene/EOG091G0CZX/infer_single_ML.stdout.txt, per_gene/EOG091G0CZX/infer_single_ML.stderr.txt
    jobid: 93
    wildcards: BUSCO=EOG091G0CZX
    threads: 2


        cd per_gene/EOG091G0CZX
	count=$(cat ../../per_gene/EOG091G0CZX/ALICUT_EOG091G0CZX.clustalo.fasta | grep ">" | wc -l)
	if [ "$count" -gt 5 ]
        then
		RAxMLmodel=$(cat ../../per_gene/EOG091G0CZX/EOG091G0CZX.best_model | grep "Best" | cut -d ":" -f 2 | tr -d '[:space:]')
                if [ "$(ls -1 | grep "^RAxML" | wc -l)" -ne 0 ]
		then
			rm RAxML*
		fi
        	raxml -f a -T 2 -m PROTGAMMA$RAxMLmodel         	-p 12345 -x 12345 -# 100         	-s ../../per_gene/EOG091G0CZX/ALICUT_EOG091G0CZX.clustalo.fasta -n EOG091G0CZX.clustalo.aln.ALICUT.$RAxMLmodel 		1> ../../per_gene/EOG091G0CZX/infer_single_ML.stdout.txt 2> ../../per_gene/EOG091G0CZX/infer_single_ML.stderr.txt
	else
		echo "fasta file per_gene/EOG091G0CZX/ALICUT_EOG091G0CZX.clustalo.fasta contains fewer than 5 sequences - skipped" > ../../per_gene/EOG091G0CZX/infer_single_ML.stdout.txt
		touch raxml.skipped
	fi
        touch ../../per_gene/EOG091G0CZX/EOG091G0CZX.raxml.done
        
[Sun Jul  5 22:58:55 2020]
Finished job 1601.
1591 of 3292 steps (48%) done

[Sun Jul  5 22:58:55 2020]
rule find_best_model:
    input: per_gene/EOG091G0RHX/ALICUT_EOG091G0RHX.clustalo.fasta, per_gene/EOG091G0RHX/empty_check.done
    output: per_gene/EOG091G0RHX/EOG091G0RHX.best_model
    log: per_gene/EOG091G0RHX/find_best_model.stderr.txt
    jobid: 778
    wildcards: BUSCO=EOG091G0RHX
    threads: 2


        cd per_gene/EOG091G0RHX
        if [ ! -d find_best_model ]
        then
            mkdir find_best_model
        fi
        cd find_best_model
        ln -s ../../../per_gene/EOG091G0RHX/ALICUT_EOG091G0RHX.clustalo.fasta EOG091G0RHX.fasta
        ProteinModelSelection.pl EOG091G0RHX.fasta 1> ../../../per_gene/EOG091G0RHX/EOG091G0RHX.best_model 2> ../../../per_gene/EOG091G0RHX/find_best_model.stderr.txt
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/c0c09ee657b1e27f2c5687e0e9aa8d70.simg
[33mJob counts:
	count	jobs
	1	infer_single_ML
	1[0m
[33m
        cd per_gene/EOG091G0CZX
	count=$(cat ../../per_gene/EOG091G0CZX/ALICUT_EOG091G0CZX.clustalo.fasta | grep ">" | wc -l)
	if [ "$count" -gt 5 ]
        then
		RAxMLmodel=$(cat ../../per_gene/EOG091G0CZX/EOG091G0CZX.best_model | grep "Best" | cut -d ":" -f 2 | tr -d '[:space:]')
                if [ "$(ls -1 | grep "^RAxML" | wc -l)" -ne 0 ]
		then
			rm RAxML*
		fi
        	raxml -f a -T 2 -m PROTGAMMA$RAxMLmodel         	-p 12345 -x 12345 -# 100         	-s ../../per_gene/EOG091G0CZX/ALICUT_EOG091G0CZX.clustalo.fasta -n EOG091G0CZX.clustalo.aln.ALICUT.$RAxMLmodel 		1> ../../per_gene/EOG091G0CZX/infer_single_ML.stdout.txt 2> ../../per_gene/EOG091G0CZX/infer_single_ML.stderr.txt
	else
		echo "fasta file per_gene/EOG091G0CZX/ALICUT_EOG091G0CZX.clustalo.fasta contains fewer than 5 sequences - skipped" > ../../per_gene/EOG091G0CZX/infer_single_ML.stdout.txt
		touch raxml.skipped
	fi
        touch ../../per_gene/EOG091G0CZX/EOG091G0CZX.raxml.done
        [0m
[Sun Jul  5 22:59:03 2020]
Finished job 24.
1592 of 3292 steps (48%) done

[Sun Jul  5 22:59:03 2020]
rule get_seqs:
    input: /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ingroup.txt, /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/outgroup.txt
    output: per_gene/EOG091G03PD/EOG091G03PD.ingroup.fasta
    log: per_gene/EOG091G03PD/get_seqs.stdout.txt, per_gene/EOG091G03PD/get_seqs.stderr.txt
    jobid: 2514
    wildcards: BUSCO=EOG091G03PD
    threads: 2


	basedir=$(pwd)
        cd per_gene/EOG091G03PD
        
        bash $basedir/../scripts/fetch_seqs.sh EOG091G03PD /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ingroup.txt /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/outgroup.txt 1> ../../per_gene/EOG091G03PD/get_seqs.stdout.txt 2> ../../per_gene/EOG091G03PD/get_seqs.stderr.txt
	mv EOG091G03PD.fasta $basedir/per_gene/EOG091G03PD/EOG091G03PD.ingroup.fasta
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/72476f9d9a5bd0627b4d721143a21354.simg
[Sun Jul  5 22:59:16 2020]
Finished job 119.
1593 of 3292 steps (48%) done

[Sun Jul  5 22:59:16 2020]
rule get_seqs:
    input: /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ingroup.txt, /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/outgroup.txt
    output: per_gene/EOG091G0Y09/EOG091G0Y09.ingroup.fasta
    log: per_gene/EOG091G0Y09/get_seqs.stdout.txt, per_gene/EOG091G0Y09/get_seqs.stderr.txt
    jobid: 2896
    wildcards: BUSCO=EOG091G0Y09
    threads: 2


	basedir=$(pwd)
        cd per_gene/EOG091G0Y09
        
        bash $basedir/../scripts/fetch_seqs.sh EOG091G0Y09 /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ingroup.txt /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/outgroup.txt 1> ../../per_gene/EOG091G0Y09/get_seqs.stdout.txt 2> ../../per_gene/EOG091G0Y09/get_seqs.stderr.txt
	mv EOG091G0Y09.fasta $basedir/per_gene/EOG091G0Y09/EOG091G0Y09.ingroup.fasta
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/72476f9d9a5bd0627b4d721143a21354.simg
[Sun Jul  5 22:59:18 2020]
Finished job 2514.
1594 of 3292 steps (48%) done

[Sun Jul  5 22:59:18 2020]
rule get_outgroups:
    input: per_gene/EOG091G03PD/EOG091G03PD.ingroup.fasta
    output: per_gene/EOG091G03PD/EOG091G03PD.orthodb.fasta, per_gene/EOG091G03PD/EOG091G03PD.outgroup.fasta
    log: per_gene/EOG091G03PD/get_outgroups.stdout.txt, per_gene/EOG091G03PD/get_outgroups.stderr.txt
    jobid: 2515
    wildcards: BUSCO=EOG091G03PD


        #download fastas from Orhtodb for BUSCO id
        for i in {1..5}
        do
             wget "http://www.orthodb.org/fasta?query=EOG091G03PD&level=33208" -O per_gene/EOG091G03PD/EOG091G03PD.orthodb.fasta 1> per_gene/EOG091G03PD/get_outgroups.stdout.txt 2> per_gene/EOG091G03PD/get_outgroups.stderr.txt && break || echo -e "try again ($i)" && sleep 15
        done

	#This is quick an dirty for now and just takes the first protein if there is more than one for an outgroup taxon
        bash ../scripts/download_outgroups.sh taxids.txt per_gene/EOG091G03PD/EOG091G03PD.orthodb.fasta > per_gene/EOG091G03PD/EOG091G03PD.outgroup.fasta
        
[Sun Jul  5 22:59:19 2020]
Finished job 2515.
1595 of 3292 steps (48%) done

[Sun Jul  5 22:59:19 2020]
rule join_groups:
    input: per_gene/EOG091G03PD/EOG091G03PD.ingroup.fasta, per_gene/EOG091G03PD/EOG091G03PD.outgroup.fasta
    output: per_gene/EOG091G03PD/EOG091G03PD.fasta
    jobid: 2081
    wildcards: BUSCO=EOG091G03PD


        cat per_gene/EOG091G03PD/EOG091G03PD.ingroup.fasta per_gene/EOG091G03PD/EOG091G03PD.outgroup.fasta > per_gene/EOG091G03PD/EOG091G03PD.fasta
        
[Sun Jul  5 22:59:19 2020]
Finished job 2081.
1596 of 3292 steps (48%) done

[Sun Jul  5 22:59:19 2020]
rule MSA:
    input: per_gene/EOG091G03PD/EOG091G03PD.fasta
    output: per_gene/EOG091G03PD/EOG091G03PD.clustalo.fasta
    log: per_gene/EOG091G03PD/MSA.stdout.txt, per_gene/EOG091G03PD/MSA.stderr.txt
    jobid: 1282
    wildcards: BUSCO=EOG091G03PD
    threads: 2


        clustalo -i per_gene/EOG091G03PD/EOG091G03PD.fasta -o per_gene/EOG091G03PD/EOG091G03PD.clustalo.fasta --threads=2 1> per_gene/EOG091G03PD/MSA.stdout.txt 2> per_gene/EOG091G03PD/MSA.stderr.txt
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/d68c9691725a7401923680874285c430.simg
[Sun Jul  5 22:59:21 2020]
Finished job 778.
1597 of 3292 steps (49%) done

[Sun Jul  5 22:59:21 2020]
rule infer_single_ML:
    input: per_gene/EOG091G0RHX/EOG091G0RHX.best_model, per_gene/EOG091G0RHX/ALICUT_EOG091G0RHX.clustalo.fasta
    output: per_gene/EOG091G0RHX/EOG091G0RHX.raxml.done
    log: per_gene/EOG091G0RHX/infer_single_ML.stdout.txt, per_gene/EOG091G0RHX/infer_single_ML.stderr.txt
    jobid: 183
    wildcards: BUSCO=EOG091G0RHX
    threads: 2


        cd per_gene/EOG091G0RHX
	count=$(cat ../../per_gene/EOG091G0RHX/ALICUT_EOG091G0RHX.clustalo.fasta | grep ">" | wc -l)
	if [ "$count" -gt 5 ]
        then
		RAxMLmodel=$(cat ../../per_gene/EOG091G0RHX/EOG091G0RHX.best_model | grep "Best" | cut -d ":" -f 2 | tr -d '[:space:]')
                if [ "$(ls -1 | grep "^RAxML" | wc -l)" -ne 0 ]
		then
			rm RAxML*
		fi
        	raxml -f a -T 2 -m PROTGAMMA$RAxMLmodel         	-p 12345 -x 12345 -# 100         	-s ../../per_gene/EOG091G0RHX/ALICUT_EOG091G0RHX.clustalo.fasta -n EOG091G0RHX.clustalo.aln.ALICUT.$RAxMLmodel 		1> ../../per_gene/EOG091G0RHX/infer_single_ML.stdout.txt 2> ../../per_gene/EOG091G0RHX/infer_single_ML.stderr.txt
	else
		echo "fasta file per_gene/EOG091G0RHX/ALICUT_EOG091G0RHX.clustalo.fasta contains fewer than 5 sequences - skipped" > ../../per_gene/EOG091G0RHX/infer_single_ML.stdout.txt
		touch raxml.skipped
	fi
        touch ../../per_gene/EOG091G0RHX/EOG091G0RHX.raxml.done
        
[Sun Jul  5 22:59:21 2020]
Finished job 1282.
1598 of 3292 steps (49%) done

[Sun Jul  5 22:59:21 2020]
rule score_and_cut:
    input: per_gene/EOG091G03PD/EOG091G03PD.clustalo.fasta
    output: per_gene/EOG091G03PD/ALICUT_EOG091G03PD.clustalo.fasta
    jobid: 459
    wildcards: BUSCO=EOG091G03PD
    threads: 2


        cd per_gene/EOG091G03PD
        Aliscore.pl -N -r 200000000000000000 -i ../../per_gene/EOG091G03PD/EOG091G03PD.clustalo.fasta &> aliscore.log
        ALICUT.pl -s &> alicut.log
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/63c88c27a0fa300f57066b0ef65fefcb.simg
[33mJob counts:
	count	jobs
	1	infer_single_ML
	1[0m
[33m
        cd per_gene/EOG091G0RHX
	count=$(cat ../../per_gene/EOG091G0RHX/ALICUT_EOG091G0RHX.clustalo.fasta | grep ">" | wc -l)
	if [ "$count" -gt 5 ]
        then
		RAxMLmodel=$(cat ../../per_gene/EOG091G0RHX/EOG091G0RHX.best_model | grep "Best" | cut -d ":" -f 2 | tr -d '[:space:]')
                if [ "$(ls -1 | grep "^RAxML" | wc -l)" -ne 0 ]
		then
			rm RAxML*
		fi
        	raxml -f a -T 2 -m PROTGAMMA$RAxMLmodel         	-p 12345 -x 12345 -# 100         	-s ../../per_gene/EOG091G0RHX/ALICUT_EOG091G0RHX.clustalo.fasta -n EOG091G0RHX.clustalo.aln.ALICUT.$RAxMLmodel 		1> ../../per_gene/EOG091G0RHX/infer_single_ML.stdout.txt 2> ../../per_gene/EOG091G0RHX/infer_single_ML.stderr.txt
	else
		echo "fasta file per_gene/EOG091G0RHX/ALICUT_EOG091G0RHX.clustalo.fasta contains fewer than 5 sequences - skipped" > ../../per_gene/EOG091G0RHX/infer_single_ML.stdout.txt
		touch raxml.skipped
	fi
        touch ../../per_gene/EOG091G0RHX/EOG091G0RHX.raxml.done
        [0m
[Sun Jul  5 22:59:29 2020]
Finished job 2896.
1599 of 3292 steps (49%) done

[Sun Jul  5 22:59:29 2020]
rule get_outgroups:
    input: per_gene/EOG091G0Y09/EOG091G0Y09.ingroup.fasta
    output: per_gene/EOG091G0Y09/EOG091G0Y09.orthodb.fasta, per_gene/EOG091G0Y09/EOG091G0Y09.outgroup.fasta
    log: per_gene/EOG091G0Y09/get_outgroups.stdout.txt, per_gene/EOG091G0Y09/get_outgroups.stderr.txt
    jobid: 2897
    wildcards: BUSCO=EOG091G0Y09


        #download fastas from Orhtodb for BUSCO id
        for i in {1..5}
        do
             wget "http://www.orthodb.org/fasta?query=EOG091G0Y09&level=33208" -O per_gene/EOG091G0Y09/EOG091G0Y09.orthodb.fasta 1> per_gene/EOG091G0Y09/get_outgroups.stdout.txt 2> per_gene/EOG091G0Y09/get_outgroups.stderr.txt && break || echo -e "try again ($i)" && sleep 15
        done

	#This is quick an dirty for now and just takes the first protein if there is more than one for an outgroup taxon
        bash ../scripts/download_outgroups.sh taxids.txt per_gene/EOG091G0Y09/EOG091G0Y09.orthodb.fasta > per_gene/EOG091G0Y09/EOG091G0Y09.outgroup.fasta
        
[Sun Jul  5 22:59:30 2020]
Finished job 2897.
1600 of 3292 steps (49%) done

[Sun Jul  5 22:59:30 2020]
rule join_groups:
    input: per_gene/EOG091G0Y09/EOG091G0Y09.ingroup.fasta, per_gene/EOG091G0Y09/EOG091G0Y09.outgroup.fasta
    output: per_gene/EOG091G0Y09/EOG091G0Y09.fasta
    jobid: 2272
    wildcards: BUSCO=EOG091G0Y09


        cat per_gene/EOG091G0Y09/EOG091G0Y09.ingroup.fasta per_gene/EOG091G0Y09/EOG091G0Y09.outgroup.fasta > per_gene/EOG091G0Y09/EOG091G0Y09.fasta
        
[Sun Jul  5 22:59:30 2020]
Finished job 2272.
1601 of 3292 steps (49%) done

[Sun Jul  5 22:59:30 2020]
rule MSA:
    input: per_gene/EOG091G0Y09/EOG091G0Y09.fasta
    output: per_gene/EOG091G0Y09/EOG091G0Y09.clustalo.fasta
    log: per_gene/EOG091G0Y09/MSA.stdout.txt, per_gene/EOG091G0Y09/MSA.stderr.txt
    jobid: 1664
    wildcards: BUSCO=EOG091G0Y09
    threads: 2


        clustalo -i per_gene/EOG091G0Y09/EOG091G0Y09.fasta -o per_gene/EOG091G0Y09/EOG091G0Y09.clustalo.fasta --threads=2 1> per_gene/EOG091G0Y09/MSA.stdout.txt 2> per_gene/EOG091G0Y09/MSA.stderr.txt
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/d68c9691725a7401923680874285c430.simg
[Sun Jul  5 22:59:31 2020]
Finished job 459.
1602 of 3292 steps (49%) done

[Sun Jul  5 22:59:31 2020]
rule remove_empty:
    input: per_gene/EOG091G03PD/ALICUT_EOG091G03PD.clustalo.fasta
    output: per_gene/EOG091G03PD/empty_check.done
    jobid: 1281
    wildcards: BUSCO=EOG091G03PD


         if [ "$(cat per_gene/EOG091G03PD/ALICUT_EOG091G03PD.clustalo.fasta | grep -v ">" | sed 's/-//g' | grep "^$" | wc -l)" -gt 0 ]
         then
              cp per_gene/EOG091G03PD/ALICUT_EOG091G03PD.clustalo.fasta per_gene/EOG091G03PD/ALICUT_EOG091G03PD.clustalo.fasta.backup
              bash ../scripts/remove_empty.sh per_gene/EOG091G03PD/ALICUT_EOG091G03PD.clustalo.fasta.backup > per_gene/EOG091G03PD/ALICUT_EOG091G03PD.clustalo.fasta
         fi
         touch per_gene/EOG091G03PD/empty_check.done
         
[Sun Jul  5 22:59:31 2020]
Finished job 1281.
1603 of 3292 steps (49%) done

[Sun Jul  5 22:59:31 2020]
rule find_best_model:
    input: per_gene/EOG091G03PD/ALICUT_EOG091G03PD.clustalo.fasta, per_gene/EOG091G03PD/empty_check.done
    output: per_gene/EOG091G03PD/EOG091G03PD.best_model
    log: per_gene/EOG091G03PD/find_best_model.stderr.txt
    jobid: 458
    wildcards: BUSCO=EOG091G03PD
    threads: 2


        cd per_gene/EOG091G03PD
        if [ ! -d find_best_model ]
        then
            mkdir find_best_model
        fi
        cd find_best_model
        ln -s ../../../per_gene/EOG091G03PD/ALICUT_EOG091G03PD.clustalo.fasta EOG091G03PD.fasta
        ProteinModelSelection.pl EOG091G03PD.fasta 1> ../../../per_gene/EOG091G03PD/EOG091G03PD.best_model 2> ../../../per_gene/EOG091G03PD/find_best_model.stderr.txt
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/c0c09ee657b1e27f2c5687e0e9aa8d70.simg
[Sun Jul  5 22:59:31 2020]
Finished job 1664.
1604 of 3292 steps (49%) done

[Sun Jul  5 22:59:31 2020]
rule score_and_cut:
    input: per_gene/EOG091G0Y09/EOG091G0Y09.clustalo.fasta
    output: per_gene/EOG091G0Y09/ALICUT_EOG091G0Y09.clustalo.fasta
    jobid: 841
    wildcards: BUSCO=EOG091G0Y09
    threads: 2


        cd per_gene/EOG091G0Y09
        Aliscore.pl -N -r 200000000000000000 -i ../../per_gene/EOG091G0Y09/EOG091G0Y09.clustalo.fasta &> aliscore.log
        ALICUT.pl -s &> alicut.log
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/63c88c27a0fa300f57066b0ef65fefcb.simg
[Sun Jul  5 22:59:38 2020]
Finished job 281.
1605 of 3292 steps (49%) done

[Sun Jul  5 22:59:38 2020]
rule get_seqs:
    input: /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ingroup.txt, /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/outgroup.txt
    output: per_gene/EOG091G06EF/EOG091G06EF.ingroup.fasta
    log: per_gene/EOG091G06EF/get_seqs.stdout.txt, per_gene/EOG091G06EF/get_seqs.stderr.txt
    jobid: 2958
    wildcards: BUSCO=EOG091G06EF
    threads: 2


	basedir=$(pwd)
        cd per_gene/EOG091G06EF
        
        bash $basedir/../scripts/fetch_seqs.sh EOG091G06EF /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ingroup.txt /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/outgroup.txt 1> ../../per_gene/EOG091G06EF/get_seqs.stdout.txt 2> ../../per_gene/EOG091G06EF/get_seqs.stderr.txt
	mv EOG091G06EF.fasta $basedir/per_gene/EOG091G06EF/EOG091G06EF.ingroup.fasta
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/72476f9d9a5bd0627b4d721143a21354.simg
[Sun Jul  5 22:59:41 2020]
Finished job 841.
1606 of 3292 steps (49%) done

[Sun Jul  5 22:59:41 2020]
rule remove_empty:
    input: per_gene/EOG091G0Y09/ALICUT_EOG091G0Y09.clustalo.fasta
    output: per_gene/EOG091G0Y09/empty_check.done
    jobid: 1663
    wildcards: BUSCO=EOG091G0Y09


         if [ "$(cat per_gene/EOG091G0Y09/ALICUT_EOG091G0Y09.clustalo.fasta | grep -v ">" | sed 's/-//g' | grep "^$" | wc -l)" -gt 0 ]
         then
              cp per_gene/EOG091G0Y09/ALICUT_EOG091G0Y09.clustalo.fasta per_gene/EOG091G0Y09/ALICUT_EOG091G0Y09.clustalo.fasta.backup
              bash ../scripts/remove_empty.sh per_gene/EOG091G0Y09/ALICUT_EOG091G0Y09.clustalo.fasta.backup > per_gene/EOG091G0Y09/ALICUT_EOG091G0Y09.clustalo.fasta
         fi
         touch per_gene/EOG091G0Y09/empty_check.done
         
[Sun Jul  5 22:59:41 2020]
Finished job 1663.
1607 of 3292 steps (49%) done

[Sun Jul  5 22:59:41 2020]
rule find_best_model:
    input: per_gene/EOG091G0Y09/ALICUT_EOG091G0Y09.clustalo.fasta, per_gene/EOG091G0Y09/empty_check.done
    output: per_gene/EOG091G0Y09/EOG091G0Y09.best_model
    log: per_gene/EOG091G0Y09/find_best_model.stderr.txt
    jobid: 840
    wildcards: BUSCO=EOG091G0Y09
    threads: 2


        cd per_gene/EOG091G0Y09
        if [ ! -d find_best_model ]
        then
            mkdir find_best_model
        fi
        cd find_best_model
        ln -s ../../../per_gene/EOG091G0Y09/ALICUT_EOG091G0Y09.clustalo.fasta EOG091G0Y09.fasta
        ProteinModelSelection.pl EOG091G0Y09.fasta 1> ../../../per_gene/EOG091G0Y09/EOG091G0Y09.best_model 2> ../../../per_gene/EOG091G0Y09/find_best_model.stderr.txt
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/c0c09ee657b1e27f2c5687e0e9aa8d70.simg
[Sun Jul  5 22:59:51 2020]
Finished job 2958.
1608 of 3292 steps (49%) done

[Sun Jul  5 22:59:51 2020]
rule get_outgroups:
    input: per_gene/EOG091G06EF/EOG091G06EF.ingroup.fasta
    output: per_gene/EOG091G06EF/EOG091G06EF.orthodb.fasta, per_gene/EOG091G06EF/EOG091G06EF.outgroup.fasta
    log: per_gene/EOG091G06EF/get_outgroups.stdout.txt, per_gene/EOG091G06EF/get_outgroups.stderr.txt
    jobid: 2959
    wildcards: BUSCO=EOG091G06EF


        #download fastas from Orhtodb for BUSCO id
        for i in {1..5}
        do
             wget "http://www.orthodb.org/fasta?query=EOG091G06EF&level=33208" -O per_gene/EOG091G06EF/EOG091G06EF.orthodb.fasta 1> per_gene/EOG091G06EF/get_outgroups.stdout.txt 2> per_gene/EOG091G06EF/get_outgroups.stderr.txt && break || echo -e "try again ($i)" && sleep 15
        done

	#This is quick an dirty for now and just takes the first protein if there is more than one for an outgroup taxon
        bash ../scripts/download_outgroups.sh taxids.txt per_gene/EOG091G06EF/EOG091G06EF.orthodb.fasta > per_gene/EOG091G06EF/EOG091G06EF.outgroup.fasta
        
[Sun Jul  5 22:59:52 2020]
Finished job 2959.
1609 of 3292 steps (49%) done

[Sun Jul  5 22:59:52 2020]
rule join_groups:
    input: per_gene/EOG091G06EF/EOG091G06EF.ingroup.fasta, per_gene/EOG091G06EF/EOG091G06EF.outgroup.fasta
    output: per_gene/EOG091G06EF/EOG091G06EF.fasta
    jobid: 2303
    wildcards: BUSCO=EOG091G06EF


        cat per_gene/EOG091G06EF/EOG091G06EF.ingroup.fasta per_gene/EOG091G06EF/EOG091G06EF.outgroup.fasta > per_gene/EOG091G06EF/EOG091G06EF.fasta
        
[Sun Jul  5 22:59:52 2020]
Finished job 2303.
1610 of 3292 steps (49%) done

[Sun Jul  5 22:59:52 2020]
rule MSA:
    input: per_gene/EOG091G06EF/EOG091G06EF.fasta
    output: per_gene/EOG091G06EF/EOG091G06EF.clustalo.fasta
    log: per_gene/EOG091G06EF/MSA.stdout.txt, per_gene/EOG091G06EF/MSA.stderr.txt
    jobid: 1726
    wildcards: BUSCO=EOG091G06EF
    threads: 2


        clustalo -i per_gene/EOG091G06EF/EOG091G06EF.fasta -o per_gene/EOG091G06EF/EOG091G06EF.clustalo.fasta --threads=2 1> per_gene/EOG091G06EF/MSA.stdout.txt 2> per_gene/EOG091G06EF/MSA.stderr.txt
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/d68c9691725a7401923680874285c430.simg
[Sun Jul  5 22:59:58 2020]
Finished job 1726.
1611 of 3292 steps (49%) done

[Sun Jul  5 22:59:58 2020]
rule score_and_cut:
    input: per_gene/EOG091G06EF/EOG091G06EF.clustalo.fasta
    output: per_gene/EOG091G06EF/ALICUT_EOG091G06EF.clustalo.fasta
    jobid: 903
    wildcards: BUSCO=EOG091G06EF
    threads: 2


        cd per_gene/EOG091G06EF
        Aliscore.pl -N -r 200000000000000000 -i ../../per_gene/EOG091G06EF/EOG091G06EF.clustalo.fasta &> aliscore.log
        ALICUT.pl -s &> alicut.log
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/63c88c27a0fa300f57066b0ef65fefcb.simg
[Sun Jul  5 23:00:01 2020]
Finished job 188.
1612 of 3292 steps (49%) done

[Sun Jul  5 23:00:01 2020]
rule get_seqs:
    input: /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ingroup.txt, /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/outgroup.txt
    output: per_gene/EOG091G0IDP/EOG091G0IDP.ingroup.fasta
    log: per_gene/EOG091G0IDP/get_seqs.stdout.txt, per_gene/EOG091G0IDP/get_seqs.stderr.txt
    jobid: 2710
    wildcards: BUSCO=EOG091G0IDP
    threads: 2


	basedir=$(pwd)
        cd per_gene/EOG091G0IDP
        
        bash $basedir/../scripts/fetch_seqs.sh EOG091G0IDP /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ingroup.txt /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/outgroup.txt 1> ../../per_gene/EOG091G0IDP/get_seqs.stdout.txt 2> ../../per_gene/EOG091G0IDP/get_seqs.stderr.txt
	mv EOG091G0IDP.fasta $basedir/per_gene/EOG091G0IDP/EOG091G0IDP.ingroup.fasta
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/72476f9d9a5bd0627b4d721143a21354.simg
[Sun Jul  5 23:00:06 2020]
Finished job 840.
1613 of 3292 steps (49%) done

[Sun Jul  5 23:00:06 2020]
rule infer_single_ML:
    input: per_gene/EOG091G0Y09/EOG091G0Y09.best_model, per_gene/EOG091G0Y09/ALICUT_EOG091G0Y09.clustalo.fasta
    output: per_gene/EOG091G0Y09/EOG091G0Y09.raxml.done
    log: per_gene/EOG091G0Y09/infer_single_ML.stdout.txt, per_gene/EOG091G0Y09/infer_single_ML.stderr.txt
    jobid: 214
    wildcards: BUSCO=EOG091G0Y09
    threads: 2


        cd per_gene/EOG091G0Y09
	count=$(cat ../../per_gene/EOG091G0Y09/ALICUT_EOG091G0Y09.clustalo.fasta | grep ">" | wc -l)
	if [ "$count" -gt 5 ]
        then
		RAxMLmodel=$(cat ../../per_gene/EOG091G0Y09/EOG091G0Y09.best_model | grep "Best" | cut -d ":" -f 2 | tr -d '[:space:]')
                if [ "$(ls -1 | grep "^RAxML" | wc -l)" -ne 0 ]
		then
			rm RAxML*
		fi
        	raxml -f a -T 2 -m PROTGAMMA$RAxMLmodel         	-p 12345 -x 12345 -# 100         	-s ../../per_gene/EOG091G0Y09/ALICUT_EOG091G0Y09.clustalo.fasta -n EOG091G0Y09.clustalo.aln.ALICUT.$RAxMLmodel 		1> ../../per_gene/EOG091G0Y09/infer_single_ML.stdout.txt 2> ../../per_gene/EOG091G0Y09/infer_single_ML.stderr.txt
	else
		echo "fasta file per_gene/EOG091G0Y09/ALICUT_EOG091G0Y09.clustalo.fasta contains fewer than 5 sequences - skipped" > ../../per_gene/EOG091G0Y09/infer_single_ML.stdout.txt
		touch raxml.skipped
	fi
        touch ../../per_gene/EOG091G0Y09/EOG091G0Y09.raxml.done
        
[33mJob counts:
	count	jobs
	1	infer_single_ML
	1[0m
[33m
        cd per_gene/EOG091G0Y09
	count=$(cat ../../per_gene/EOG091G0Y09/ALICUT_EOG091G0Y09.clustalo.fasta | grep ">" | wc -l)
	if [ "$count" -gt 5 ]
        then
		RAxMLmodel=$(cat ../../per_gene/EOG091G0Y09/EOG091G0Y09.best_model | grep "Best" | cut -d ":" -f 2 | tr -d '[:space:]')
                if [ "$(ls -1 | grep "^RAxML" | wc -l)" -ne 0 ]
		then
			rm RAxML*
		fi
        	raxml -f a -T 2 -m PROTGAMMA$RAxMLmodel         	-p 12345 -x 12345 -# 100         	-s ../../per_gene/EOG091G0Y09/ALICUT_EOG091G0Y09.clustalo.fasta -n EOG091G0Y09.clustalo.aln.ALICUT.$RAxMLmodel 		1> ../../per_gene/EOG091G0Y09/infer_single_ML.stdout.txt 2> ../../per_gene/EOG091G0Y09/infer_single_ML.stderr.txt
	else
		echo "fasta file per_gene/EOG091G0Y09/ALICUT_EOG091G0Y09.clustalo.fasta contains fewer than 5 sequences - skipped" > ../../per_gene/EOG091G0Y09/infer_single_ML.stdout.txt
		touch raxml.skipped
	fi
        touch ../../per_gene/EOG091G0Y09/EOG091G0Y09.raxml.done
        [0m
[Sun Jul  5 23:00:13 2020]
Finished job 2710.
1614 of 3292 steps (49%) done

[Sun Jul  5 23:00:13 2020]
rule get_outgroups:
    input: per_gene/EOG091G0IDP/EOG091G0IDP.ingroup.fasta
    output: per_gene/EOG091G0IDP/EOG091G0IDP.orthodb.fasta, per_gene/EOG091G0IDP/EOG091G0IDP.outgroup.fasta
    log: per_gene/EOG091G0IDP/get_outgroups.stdout.txt, per_gene/EOG091G0IDP/get_outgroups.stderr.txt
    jobid: 2711
    wildcards: BUSCO=EOG091G0IDP


        #download fastas from Orhtodb for BUSCO id
        for i in {1..5}
        do
             wget "http://www.orthodb.org/fasta?query=EOG091G0IDP&level=33208" -O per_gene/EOG091G0IDP/EOG091G0IDP.orthodb.fasta 1> per_gene/EOG091G0IDP/get_outgroups.stdout.txt 2> per_gene/EOG091G0IDP/get_outgroups.stderr.txt && break || echo -e "try again ($i)" && sleep 15
        done

	#This is quick an dirty for now and just takes the first protein if there is more than one for an outgroup taxon
        bash ../scripts/download_outgroups.sh taxids.txt per_gene/EOG091G0IDP/EOG091G0IDP.orthodb.fasta > per_gene/EOG091G0IDP/EOG091G0IDP.outgroup.fasta
        
[Sun Jul  5 23:00:13 2020]
Finished job 2711.
1615 of 3292 steps (49%) done

[Sun Jul  5 23:00:13 2020]
rule join_groups:
    input: per_gene/EOG091G0IDP/EOG091G0IDP.ingroup.fasta, per_gene/EOG091G0IDP/EOG091G0IDP.outgroup.fasta
    output: per_gene/EOG091G0IDP/EOG091G0IDP.fasta
    jobid: 2179
    wildcards: BUSCO=EOG091G0IDP


        cat per_gene/EOG091G0IDP/EOG091G0IDP.ingroup.fasta per_gene/EOG091G0IDP/EOG091G0IDP.outgroup.fasta > per_gene/EOG091G0IDP/EOG091G0IDP.fasta
        
[Sun Jul  5 23:00:14 2020]
Finished job 2179.
1616 of 3292 steps (49%) done

[Sun Jul  5 23:00:14 2020]
rule MSA:
    input: per_gene/EOG091G0IDP/EOG091G0IDP.fasta
    output: per_gene/EOG091G0IDP/EOG091G0IDP.clustalo.fasta
    log: per_gene/EOG091G0IDP/MSA.stdout.txt, per_gene/EOG091G0IDP/MSA.stderr.txt
    jobid: 1478
    wildcards: BUSCO=EOG091G0IDP
    threads: 2


        clustalo -i per_gene/EOG091G0IDP/EOG091G0IDP.fasta -o per_gene/EOG091G0IDP/EOG091G0IDP.clustalo.fasta --threads=2 1> per_gene/EOG091G0IDP/MSA.stdout.txt 2> per_gene/EOG091G0IDP/MSA.stderr.txt
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/d68c9691725a7401923680874285c430.simg
[Sun Jul  5 23:00:14 2020]
Finished job 1478.
1617 of 3292 steps (49%) done

[Sun Jul  5 23:00:14 2020]
rule score_and_cut:
    input: per_gene/EOG091G0IDP/EOG091G0IDP.clustalo.fasta
    output: per_gene/EOG091G0IDP/ALICUT_EOG091G0IDP.clustalo.fasta
    jobid: 655
    wildcards: BUSCO=EOG091G0IDP
    threads: 2


        cd per_gene/EOG091G0IDP
        Aliscore.pl -N -r 200000000000000000 -i ../../per_gene/EOG091G0IDP/EOG091G0IDP.clustalo.fasta &> aliscore.log
        ALICUT.pl -s &> alicut.log
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/63c88c27a0fa300f57066b0ef65fefcb.simg
[Sun Jul  5 23:00:15 2020]
Finished job 903.
1618 of 3292 steps (49%) done

[Sun Jul  5 23:00:15 2020]
rule remove_empty:
    input: per_gene/EOG091G06EF/ALICUT_EOG091G06EF.clustalo.fasta
    output: per_gene/EOG091G06EF/empty_check.done
    jobid: 1725
    wildcards: BUSCO=EOG091G06EF


         if [ "$(cat per_gene/EOG091G06EF/ALICUT_EOG091G06EF.clustalo.fasta | grep -v ">" | sed 's/-//g' | grep "^$" | wc -l)" -gt 0 ]
         then
              cp per_gene/EOG091G06EF/ALICUT_EOG091G06EF.clustalo.fasta per_gene/EOG091G06EF/ALICUT_EOG091G06EF.clustalo.fasta.backup
              bash ../scripts/remove_empty.sh per_gene/EOG091G06EF/ALICUT_EOG091G06EF.clustalo.fasta.backup > per_gene/EOG091G06EF/ALICUT_EOG091G06EF.clustalo.fasta
         fi
         touch per_gene/EOG091G06EF/empty_check.done
         
[Sun Jul  5 23:00:15 2020]
Finished job 1725.
1619 of 3292 steps (49%) done

[Sun Jul  5 23:00:15 2020]
rule find_best_model:
    input: per_gene/EOG091G06EF/ALICUT_EOG091G06EF.clustalo.fasta, per_gene/EOG091G06EF/empty_check.done
    output: per_gene/EOG091G06EF/EOG091G06EF.best_model
    log: per_gene/EOG091G06EF/find_best_model.stderr.txt
    jobid: 902
    wildcards: BUSCO=EOG091G06EF
    threads: 2


        cd per_gene/EOG091G06EF
        if [ ! -d find_best_model ]
        then
            mkdir find_best_model
        fi
        cd find_best_model
        ln -s ../../../per_gene/EOG091G06EF/ALICUT_EOG091G06EF.clustalo.fasta EOG091G06EF.fasta
        ProteinModelSelection.pl EOG091G06EF.fasta 1> ../../../per_gene/EOG091G06EF/EOG091G06EF.best_model 2> ../../../per_gene/EOG091G06EF/find_best_model.stderr.txt
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/c0c09ee657b1e27f2c5687e0e9aa8d70.simg
[Sun Jul  5 23:00:18 2020]
Finished job 458.
1620 of 3292 steps (49%) done

[Sun Jul  5 23:00:18 2020]
rule infer_single_ML:
    input: per_gene/EOG091G03PD/EOG091G03PD.best_model, per_gene/EOG091G03PD/ALICUT_EOG091G03PD.clustalo.fasta
    output: per_gene/EOG091G03PD/EOG091G03PD.raxml.done
    log: per_gene/EOG091G03PD/infer_single_ML.stdout.txt, per_gene/EOG091G03PD/infer_single_ML.stderr.txt
    jobid: 23
    wildcards: BUSCO=EOG091G03PD
    threads: 2


        cd per_gene/EOG091G03PD
	count=$(cat ../../per_gene/EOG091G03PD/ALICUT_EOG091G03PD.clustalo.fasta | grep ">" | wc -l)
	if [ "$count" -gt 5 ]
        then
		RAxMLmodel=$(cat ../../per_gene/EOG091G03PD/EOG091G03PD.best_model | grep "Best" | cut -d ":" -f 2 | tr -d '[:space:]')
                if [ "$(ls -1 | grep "^RAxML" | wc -l)" -ne 0 ]
		then
			rm RAxML*
		fi
        	raxml -f a -T 2 -m PROTGAMMA$RAxMLmodel         	-p 12345 -x 12345 -# 100         	-s ../../per_gene/EOG091G03PD/ALICUT_EOG091G03PD.clustalo.fasta -n EOG091G03PD.clustalo.aln.ALICUT.$RAxMLmodel 		1> ../../per_gene/EOG091G03PD/infer_single_ML.stdout.txt 2> ../../per_gene/EOG091G03PD/infer_single_ML.stderr.txt
	else
		echo "fasta file per_gene/EOG091G03PD/ALICUT_EOG091G03PD.clustalo.fasta contains fewer than 5 sequences - skipped" > ../../per_gene/EOG091G03PD/infer_single_ML.stdout.txt
		touch raxml.skipped
	fi
        touch ../../per_gene/EOG091G03PD/EOG091G03PD.raxml.done
        
[33mJob counts:
	count	jobs
	1	infer_single_ML
	1[0m
[33m
        cd per_gene/EOG091G03PD
	count=$(cat ../../per_gene/EOG091G03PD/ALICUT_EOG091G03PD.clustalo.fasta | grep ">" | wc -l)
	if [ "$count" -gt 5 ]
        then
		RAxMLmodel=$(cat ../../per_gene/EOG091G03PD/EOG091G03PD.best_model | grep "Best" | cut -d ":" -f 2 | tr -d '[:space:]')
                if [ "$(ls -1 | grep "^RAxML" | wc -l)" -ne 0 ]
		then
			rm RAxML*
		fi
        	raxml -f a -T 2 -m PROTGAMMA$RAxMLmodel         	-p 12345 -x 12345 -# 100         	-s ../../per_gene/EOG091G03PD/ALICUT_EOG091G03PD.clustalo.fasta -n EOG091G03PD.clustalo.aln.ALICUT.$RAxMLmodel 		1> ../../per_gene/EOG091G03PD/infer_single_ML.stdout.txt 2> ../../per_gene/EOG091G03PD/infer_single_ML.stderr.txt
	else
		echo "fasta file per_gene/EOG091G03PD/ALICUT_EOG091G03PD.clustalo.fasta contains fewer than 5 sequences - skipped" > ../../per_gene/EOG091G03PD/infer_single_ML.stdout.txt
		touch raxml.skipped
	fi
        touch ../../per_gene/EOG091G03PD/EOG091G03PD.raxml.done
        [0m
[Sun Jul  5 23:00:24 2020]
Finished job 655.
1621 of 3292 steps (49%) done

[Sun Jul  5 23:00:24 2020]
rule remove_empty:
    input: per_gene/EOG091G0IDP/ALICUT_EOG091G0IDP.clustalo.fasta
    output: per_gene/EOG091G0IDP/empty_check.done
    jobid: 1477
    wildcards: BUSCO=EOG091G0IDP


         if [ "$(cat per_gene/EOG091G0IDP/ALICUT_EOG091G0IDP.clustalo.fasta | grep -v ">" | sed 's/-//g' | grep "^$" | wc -l)" -gt 0 ]
         then
              cp per_gene/EOG091G0IDP/ALICUT_EOG091G0IDP.clustalo.fasta per_gene/EOG091G0IDP/ALICUT_EOG091G0IDP.clustalo.fasta.backup
              bash ../scripts/remove_empty.sh per_gene/EOG091G0IDP/ALICUT_EOG091G0IDP.clustalo.fasta.backup > per_gene/EOG091G0IDP/ALICUT_EOG091G0IDP.clustalo.fasta
         fi
         touch per_gene/EOG091G0IDP/empty_check.done
         
[Sun Jul  5 23:00:24 2020]
Finished job 1477.
1622 of 3292 steps (49%) done

[Sun Jul  5 23:00:24 2020]
rule find_best_model:
    input: per_gene/EOG091G0IDP/ALICUT_EOG091G0IDP.clustalo.fasta, per_gene/EOG091G0IDP/empty_check.done
    output: per_gene/EOG091G0IDP/EOG091G0IDP.best_model
    log: per_gene/EOG091G0IDP/find_best_model.stderr.txt
    jobid: 654
    wildcards: BUSCO=EOG091G0IDP
    threads: 2


        cd per_gene/EOG091G0IDP
        if [ ! -d find_best_model ]
        then
            mkdir find_best_model
        fi
        cd find_best_model
        ln -s ../../../per_gene/EOG091G0IDP/ALICUT_EOG091G0IDP.clustalo.fasta EOG091G0IDP.fasta
        ProteinModelSelection.pl EOG091G0IDP.fasta 1> ../../../per_gene/EOG091G0IDP/EOG091G0IDP.best_model 2> ../../../per_gene/EOG091G0IDP/find_best_model.stderr.txt
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/c0c09ee657b1e27f2c5687e0e9aa8d70.simg
[Sun Jul  5 23:00:38 2020]
Finished job 365.
1623 of 3292 steps (49%) done

[Sun Jul  5 23:00:38 2020]
rule get_seqs:
    input: /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ingroup.txt, /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/outgroup.txt
    output: per_gene/EOG091G0NK3/EOG091G0NK3.ingroup.fasta
    log: per_gene/EOG091G0NK3/get_seqs.stdout.txt, per_gene/EOG091G0NK3/get_seqs.stderr.txt
    jobid: 2784
    wildcards: BUSCO=EOG091G0NK3
    threads: 2


	basedir=$(pwd)
        cd per_gene/EOG091G0NK3
        
        bash $basedir/../scripts/fetch_seqs.sh EOG091G0NK3 /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ingroup.txt /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/outgroup.txt 1> ../../per_gene/EOG091G0NK3/get_seqs.stdout.txt 2> ../../per_gene/EOG091G0NK3/get_seqs.stderr.txt
	mv EOG091G0NK3.fasta $basedir/per_gene/EOG091G0NK3/EOG091G0NK3.ingroup.fasta
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/72476f9d9a5bd0627b4d721143a21354.simg
[Sun Jul  5 23:00:48 2020]
Finished job 902.
1624 of 3292 steps (49%) done

[Sun Jul  5 23:00:48 2020]
rule infer_single_ML:
    input: per_gene/EOG091G06EF/EOG091G06EF.best_model, per_gene/EOG091G06EF/ALICUT_EOG091G06EF.clustalo.fasta
    output: per_gene/EOG091G06EF/EOG091G06EF.raxml.done
    log: per_gene/EOG091G06EF/infer_single_ML.stdout.txt, per_gene/EOG091G06EF/infer_single_ML.stderr.txt
    jobid: 245
    wildcards: BUSCO=EOG091G06EF
    threads: 2


        cd per_gene/EOG091G06EF
	count=$(cat ../../per_gene/EOG091G06EF/ALICUT_EOG091G06EF.clustalo.fasta | grep ">" | wc -l)
	if [ "$count" -gt 5 ]
        then
		RAxMLmodel=$(cat ../../per_gene/EOG091G06EF/EOG091G06EF.best_model | grep "Best" | cut -d ":" -f 2 | tr -d '[:space:]')
                if [ "$(ls -1 | grep "^RAxML" | wc -l)" -ne 0 ]
		then
			rm RAxML*
		fi
        	raxml -f a -T 2 -m PROTGAMMA$RAxMLmodel         	-p 12345 -x 12345 -# 100         	-s ../../per_gene/EOG091G06EF/ALICUT_EOG091G06EF.clustalo.fasta -n EOG091G06EF.clustalo.aln.ALICUT.$RAxMLmodel 		1> ../../per_gene/EOG091G06EF/infer_single_ML.stdout.txt 2> ../../per_gene/EOG091G06EF/infer_single_ML.stderr.txt
	else
		echo "fasta file per_gene/EOG091G06EF/ALICUT_EOG091G06EF.clustalo.fasta contains fewer than 5 sequences - skipped" > ../../per_gene/EOG091G06EF/infer_single_ML.stdout.txt
		touch raxml.skipped
	fi
        touch ../../per_gene/EOG091G06EF/EOG091G06EF.raxml.done
        
[Sun Jul  5 23:00:50 2020]
Finished job 654.
1625 of 3292 steps (49%) done

[Sun Jul  5 23:00:50 2020]
rule infer_single_ML:
    input: per_gene/EOG091G0IDP/EOG091G0IDP.best_model, per_gene/EOG091G0IDP/ALICUT_EOG091G0IDP.clustalo.fasta
    output: per_gene/EOG091G0IDP/EOG091G0IDP.raxml.done
    log: per_gene/EOG091G0IDP/infer_single_ML.stdout.txt, per_gene/EOG091G0IDP/infer_single_ML.stderr.txt
    jobid: 121
    wildcards: BUSCO=EOG091G0IDP
    threads: 2


        cd per_gene/EOG091G0IDP
	count=$(cat ../../per_gene/EOG091G0IDP/ALICUT_EOG091G0IDP.clustalo.fasta | grep ">" | wc -l)
	if [ "$count" -gt 5 ]
        then
		RAxMLmodel=$(cat ../../per_gene/EOG091G0IDP/EOG091G0IDP.best_model | grep "Best" | cut -d ":" -f 2 | tr -d '[:space:]')
                if [ "$(ls -1 | grep "^RAxML" | wc -l)" -ne 0 ]
		then
			rm RAxML*
		fi
        	raxml -f a -T 2 -m PROTGAMMA$RAxMLmodel         	-p 12345 -x 12345 -# 100         	-s ../../per_gene/EOG091G0IDP/ALICUT_EOG091G0IDP.clustalo.fasta -n EOG091G0IDP.clustalo.aln.ALICUT.$RAxMLmodel 		1> ../../per_gene/EOG091G0IDP/infer_single_ML.stdout.txt 2> ../../per_gene/EOG091G0IDP/infer_single_ML.stderr.txt
	else
		echo "fasta file per_gene/EOG091G0IDP/ALICUT_EOG091G0IDP.clustalo.fasta contains fewer than 5 sequences - skipped" > ../../per_gene/EOG091G0IDP/infer_single_ML.stdout.txt
		touch raxml.skipped
	fi
        touch ../../per_gene/EOG091G0IDP/EOG091G0IDP.raxml.done
        
[Sun Jul  5 23:00:51 2020]
Finished job 2784.
1626 of 3292 steps (49%) done

[Sun Jul  5 23:00:51 2020]
rule get_outgroups:
    input: per_gene/EOG091G0NK3/EOG091G0NK3.ingroup.fasta
    output: per_gene/EOG091G0NK3/EOG091G0NK3.orthodb.fasta, per_gene/EOG091G0NK3/EOG091G0NK3.outgroup.fasta
    log: per_gene/EOG091G0NK3/get_outgroups.stdout.txt, per_gene/EOG091G0NK3/get_outgroups.stderr.txt
    jobid: 2785
    wildcards: BUSCO=EOG091G0NK3


        #download fastas from Orhtodb for BUSCO id
        for i in {1..5}
        do
             wget "http://www.orthodb.org/fasta?query=EOG091G0NK3&level=33208" -O per_gene/EOG091G0NK3/EOG091G0NK3.orthodb.fasta 1> per_gene/EOG091G0NK3/get_outgroups.stdout.txt 2> per_gene/EOG091G0NK3/get_outgroups.stderr.txt && break || echo -e "try again ($i)" && sleep 15
        done

	#This is quick an dirty for now and just takes the first protein if there is more than one for an outgroup taxon
        bash ../scripts/download_outgroups.sh taxids.txt per_gene/EOG091G0NK3/EOG091G0NK3.orthodb.fasta > per_gene/EOG091G0NK3/EOG091G0NK3.outgroup.fasta
        
[33mJob counts:
	count	jobs
	1	infer_single_ML
	1[0m
[33m
        cd per_gene/EOG091G06EF
	count=$(cat ../../per_gene/EOG091G06EF/ALICUT_EOG091G06EF.clustalo.fasta | grep ">" | wc -l)
	if [ "$count" -gt 5 ]
        then
		RAxMLmodel=$(cat ../../per_gene/EOG091G06EF/EOG091G06EF.best_model | grep "Best" | cut -d ":" -f 2 | tr -d '[:space:]')
                if [ "$(ls -1 | grep "^RAxML" | wc -l)" -ne 0 ]
		then
			rm RAxML*
		fi
        	raxml -f a -T 2 -m PROTGAMMA$RAxMLmodel         	-p 12345 -x 12345 -# 100         	-s ../../per_gene/EOG091G06EF/ALICUT_EOG091G06EF.clustalo.fasta -n EOG091G06EF.clustalo.aln.ALICUT.$RAxMLmodel 		1> ../../per_gene/EOG091G06EF/infer_single_ML.stdout.txt 2> ../../per_gene/EOG091G06EF/infer_single_ML.stderr.txt
	else
		echo "fasta file per_gene/EOG091G06EF/ALICUT_EOG091G06EF.clustalo.fasta contains fewer than 5 sequences - skipped" > ../../per_gene/EOG091G06EF/infer_single_ML.stdout.txt
		touch raxml.skipped
	fi
        touch ../../per_gene/EOG091G06EF/EOG091G06EF.raxml.done
        [0m
[33mJob counts:
	count	jobs
	1	infer_single_ML
	1[0m
[33m
        cd per_gene/EOG091G0IDP
	count=$(cat ../../per_gene/EOG091G0IDP/ALICUT_EOG091G0IDP.clustalo.fasta | grep ">" | wc -l)
	if [ "$count" -gt 5 ]
        then
		RAxMLmodel=$(cat ../../per_gene/EOG091G0IDP/EOG091G0IDP.best_model | grep "Best" | cut -d ":" -f 2 | tr -d '[:space:]')
                if [ "$(ls -1 | grep "^RAxML" | wc -l)" -ne 0 ]
		then
			rm RAxML*
		fi
        	raxml -f a -T 2 -m PROTGAMMA$RAxMLmodel         	-p 12345 -x 12345 -# 100         	-s ../../per_gene/EOG091G0IDP/ALICUT_EOG091G0IDP.clustalo.fasta -n EOG091G0IDP.clustalo.aln.ALICUT.$RAxMLmodel 		1> ../../per_gene/EOG091G0IDP/infer_single_ML.stdout.txt 2> ../../per_gene/EOG091G0IDP/infer_single_ML.stderr.txt
	else
		echo "fasta file per_gene/EOG091G0IDP/ALICUT_EOG091G0IDP.clustalo.fasta contains fewer than 5 sequences - skipped" > ../../per_gene/EOG091G0IDP/infer_single_ML.stdout.txt
		touch raxml.skipped
	fi
        touch ../../per_gene/EOG091G0IDP/EOG091G0IDP.raxml.done
        [0m
[Sun Jul  5 23:00:52 2020]
Finished job 2785.
1627 of 3292 steps (49%) done

[Sun Jul  5 23:00:52 2020]
rule join_groups:
    input: per_gene/EOG091G0NK3/EOG091G0NK3.ingroup.fasta, per_gene/EOG091G0NK3/EOG091G0NK3.outgroup.fasta
    output: per_gene/EOG091G0NK3/EOG091G0NK3.fasta
    jobid: 2216
    wildcards: BUSCO=EOG091G0NK3


        cat per_gene/EOG091G0NK3/EOG091G0NK3.ingroup.fasta per_gene/EOG091G0NK3/EOG091G0NK3.outgroup.fasta > per_gene/EOG091G0NK3/EOG091G0NK3.fasta
        
[Sun Jul  5 23:00:52 2020]
Finished job 2216.
1628 of 3292 steps (49%) done

[Sun Jul  5 23:00:52 2020]
rule MSA:
    input: per_gene/EOG091G0NK3/EOG091G0NK3.fasta
    output: per_gene/EOG091G0NK3/EOG091G0NK3.clustalo.fasta
    log: per_gene/EOG091G0NK3/MSA.stdout.txt, per_gene/EOG091G0NK3/MSA.stderr.txt
    jobid: 1552
    wildcards: BUSCO=EOG091G0NK3
    threads: 2


        clustalo -i per_gene/EOG091G0NK3/EOG091G0NK3.fasta -o per_gene/EOG091G0NK3/EOG091G0NK3.clustalo.fasta --threads=2 1> per_gene/EOG091G0NK3/MSA.stdout.txt 2> per_gene/EOG091G0NK3/MSA.stderr.txt
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/d68c9691725a7401923680874285c430.simg
[Sun Jul  5 23:00:53 2020]
Finished job 1552.
1629 of 3292 steps (49%) done

[Sun Jul  5 23:00:53 2020]
rule score_and_cut:
    input: per_gene/EOG091G0NK3/EOG091G0NK3.clustalo.fasta
    output: per_gene/EOG091G0NK3/ALICUT_EOG091G0NK3.clustalo.fasta
    jobid: 729
    wildcards: BUSCO=EOG091G0NK3
    threads: 2


        cd per_gene/EOG091G0NK3
        Aliscore.pl -N -r 200000000000000000 -i ../../per_gene/EOG091G0NK3/EOG091G0NK3.clustalo.fasta &> aliscore.log
        ALICUT.pl -s &> alicut.log
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/63c88c27a0fa300f57066b0ef65fefcb.simg
[Sun Jul  5 23:01:03 2020]
Finished job 729.
1630 of 3292 steps (50%) done

[Sun Jul  5 23:01:03 2020]
rule remove_empty:
    input: per_gene/EOG091G0NK3/ALICUT_EOG091G0NK3.clustalo.fasta
    output: per_gene/EOG091G0NK3/empty_check.done
    jobid: 1551
    wildcards: BUSCO=EOG091G0NK3


         if [ "$(cat per_gene/EOG091G0NK3/ALICUT_EOG091G0NK3.clustalo.fasta | grep -v ">" | sed 's/-//g' | grep "^$" | wc -l)" -gt 0 ]
         then
              cp per_gene/EOG091G0NK3/ALICUT_EOG091G0NK3.clustalo.fasta per_gene/EOG091G0NK3/ALICUT_EOG091G0NK3.clustalo.fasta.backup
              bash ../scripts/remove_empty.sh per_gene/EOG091G0NK3/ALICUT_EOG091G0NK3.clustalo.fasta.backup > per_gene/EOG091G0NK3/ALICUT_EOG091G0NK3.clustalo.fasta
         fi
         touch per_gene/EOG091G0NK3/empty_check.done
         
[Sun Jul  5 23:01:03 2020]
Finished job 1551.
1631 of 3292 steps (50%) done

[Sun Jul  5 23:01:03 2020]
rule find_best_model:
    input: per_gene/EOG091G0NK3/ALICUT_EOG091G0NK3.clustalo.fasta, per_gene/EOG091G0NK3/empty_check.done
    output: per_gene/EOG091G0NK3/EOG091G0NK3.best_model
    log: per_gene/EOG091G0NK3/find_best_model.stderr.txt
    jobid: 728
    wildcards: BUSCO=EOG091G0NK3
    threads: 2


        cd per_gene/EOG091G0NK3
        if [ ! -d find_best_model ]
        then
            mkdir find_best_model
        fi
        cd find_best_model
        ln -s ../../../per_gene/EOG091G0NK3/ALICUT_EOG091G0NK3.clustalo.fasta EOG091G0NK3.fasta
        ProteinModelSelection.pl EOG091G0NK3.fasta 1> ../../../per_gene/EOG091G0NK3/EOG091G0NK3.best_model 2> ../../../per_gene/EOG091G0NK3/find_best_model.stderr.txt
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/c0c09ee657b1e27f2c5687e0e9aa8d70.simg
[Sun Jul  5 23:01:11 2020]
Finished job 143.
1632 of 3292 steps (50%) done

[Sun Jul  5 23:01:11 2020]
rule get_seqs:
    input: /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ingroup.txt, /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/outgroup.txt
    output: per_gene/EOG091G0OHF/EOG091G0OHF.ingroup.fasta
    log: per_gene/EOG091G0OHF/get_seqs.stdout.txt, per_gene/EOG091G0OHF/get_seqs.stderr.txt
    jobid: 2796
    wildcards: BUSCO=EOG091G0OHF
    threads: 2


	basedir=$(pwd)
        cd per_gene/EOG091G0OHF
        
        bash $basedir/../scripts/fetch_seqs.sh EOG091G0OHF /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ingroup.txt /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/outgroup.txt 1> ../../per_gene/EOG091G0OHF/get_seqs.stdout.txt 2> ../../per_gene/EOG091G0OHF/get_seqs.stderr.txt
	mv EOG091G0OHF.fasta $basedir/per_gene/EOG091G0OHF/EOG091G0OHF.ingroup.fasta
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/72476f9d9a5bd0627b4d721143a21354.simg
[Sun Jul  5 23:01:13 2020]
Finished job 193.
1633 of 3292 steps (50%) done

[Sun Jul  5 23:01:13 2020]
rule get_seqs:
    input: /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ingroup.txt, /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/outgroup.txt
    output: per_gene/EOG091G1817/EOG091G1817.ingroup.fasta
    log: per_gene/EOG091G1817/get_seqs.stdout.txt, per_gene/EOG091G1817/get_seqs.stderr.txt
    jobid: 2938
    wildcards: BUSCO=EOG091G1817
    threads: 2


	basedir=$(pwd)
        cd per_gene/EOG091G1817
        
        bash $basedir/../scripts/fetch_seqs.sh EOG091G1817 /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ingroup.txt /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/outgroup.txt 1> ../../per_gene/EOG091G1817/get_seqs.stdout.txt 2> ../../per_gene/EOG091G1817/get_seqs.stderr.txt
	mv EOG091G1817.fasta $basedir/per_gene/EOG091G1817/EOG091G1817.ingroup.fasta
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/72476f9d9a5bd0627b4d721143a21354.simg
[Sun Jul  5 23:01:15 2020]
Finished job 150.
1634 of 3292 steps (50%) done

[Sun Jul  5 23:01:15 2020]
rule get_seqs:
    input: /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ingroup.txt, /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/outgroup.txt
    output: per_gene/EOG091G06P4/EOG091G06P4.ingroup.fasta
    log: per_gene/EOG091G06P4/get_seqs.stdout.txt, per_gene/EOG091G06P4/get_seqs.stderr.txt
    jobid: 3066
    wildcards: BUSCO=EOG091G06P4
    threads: 2


	basedir=$(pwd)
        cd per_gene/EOG091G06P4
        
        bash $basedir/../scripts/fetch_seqs.sh EOG091G06P4 /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ingroup.txt /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/outgroup.txt 1> ../../per_gene/EOG091G06P4/get_seqs.stdout.txt 2> ../../per_gene/EOG091G06P4/get_seqs.stderr.txt
	mv EOG091G06P4.fasta $basedir/per_gene/EOG091G06P4/EOG091G06P4.ingroup.fasta
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/72476f9d9a5bd0627b4d721143a21354.simg
[Sun Jul  5 23:01:22 2020]
Finished job 2796.
1635 of 3292 steps (50%) done

[Sun Jul  5 23:01:22 2020]
rule get_outgroups:
    input: per_gene/EOG091G0OHF/EOG091G0OHF.ingroup.fasta
    output: per_gene/EOG091G0OHF/EOG091G0OHF.orthodb.fasta, per_gene/EOG091G0OHF/EOG091G0OHF.outgroup.fasta
    log: per_gene/EOG091G0OHF/get_outgroups.stdout.txt, per_gene/EOG091G0OHF/get_outgroups.stderr.txt
    jobid: 2797
    wildcards: BUSCO=EOG091G0OHF


        #download fastas from Orhtodb for BUSCO id
        for i in {1..5}
        do
             wget "http://www.orthodb.org/fasta?query=EOG091G0OHF&level=33208" -O per_gene/EOG091G0OHF/EOG091G0OHF.orthodb.fasta 1> per_gene/EOG091G0OHF/get_outgroups.stdout.txt 2> per_gene/EOG091G0OHF/get_outgroups.stderr.txt && break || echo -e "try again ($i)" && sleep 15
        done

	#This is quick an dirty for now and just takes the first protein if there is more than one for an outgroup taxon
        bash ../scripts/download_outgroups.sh taxids.txt per_gene/EOG091G0OHF/EOG091G0OHF.orthodb.fasta > per_gene/EOG091G0OHF/EOG091G0OHF.outgroup.fasta
        
[Sun Jul  5 23:01:23 2020]
Finished job 2797.
1636 of 3292 steps (50%) done

[Sun Jul  5 23:01:23 2020]
rule join_groups:
    input: per_gene/EOG091G0OHF/EOG091G0OHF.ingroup.fasta, per_gene/EOG091G0OHF/EOG091G0OHF.outgroup.fasta
    output: per_gene/EOG091G0OHF/EOG091G0OHF.fasta
    jobid: 2222
    wildcards: BUSCO=EOG091G0OHF


        cat per_gene/EOG091G0OHF/EOG091G0OHF.ingroup.fasta per_gene/EOG091G0OHF/EOG091G0OHF.outgroup.fasta > per_gene/EOG091G0OHF/EOG091G0OHF.fasta
        
[Sun Jul  5 23:01:23 2020]
Finished job 2222.
1637 of 3292 steps (50%) done

[Sun Jul  5 23:01:23 2020]
rule MSA:
    input: per_gene/EOG091G0OHF/EOG091G0OHF.fasta
    output: per_gene/EOG091G0OHF/EOG091G0OHF.clustalo.fasta
    log: per_gene/EOG091G0OHF/MSA.stdout.txt, per_gene/EOG091G0OHF/MSA.stderr.txt
    jobid: 1564
    wildcards: BUSCO=EOG091G0OHF
    threads: 2


        clustalo -i per_gene/EOG091G0OHF/EOG091G0OHF.fasta -o per_gene/EOG091G0OHF/EOG091G0OHF.clustalo.fasta --threads=2 1> per_gene/EOG091G0OHF/MSA.stdout.txt 2> per_gene/EOG091G0OHF/MSA.stderr.txt
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/d68c9691725a7401923680874285c430.simg
[Sun Jul  5 23:01:25 2020]
Finished job 2938.
1638 of 3292 steps (50%) done

[Sun Jul  5 23:01:25 2020]
rule get_outgroups:
    input: per_gene/EOG091G1817/EOG091G1817.ingroup.fasta
    output: per_gene/EOG091G1817/EOG091G1817.orthodb.fasta, per_gene/EOG091G1817/EOG091G1817.outgroup.fasta
    log: per_gene/EOG091G1817/get_outgroups.stdout.txt, per_gene/EOG091G1817/get_outgroups.stderr.txt
    jobid: 2939
    wildcards: BUSCO=EOG091G1817


        #download fastas from Orhtodb for BUSCO id
        for i in {1..5}
        do
             wget "http://www.orthodb.org/fasta?query=EOG091G1817&level=33208" -O per_gene/EOG091G1817/EOG091G1817.orthodb.fasta 1> per_gene/EOG091G1817/get_outgroups.stdout.txt 2> per_gene/EOG091G1817/get_outgroups.stderr.txt && break || echo -e "try again ($i)" && sleep 15
        done

	#This is quick an dirty for now and just takes the first protein if there is more than one for an outgroup taxon
        bash ../scripts/download_outgroups.sh taxids.txt per_gene/EOG091G1817/EOG091G1817.orthodb.fasta > per_gene/EOG091G1817/EOG091G1817.outgroup.fasta
        
[Sun Jul  5 23:01:26 2020]
Finished job 2939.
1639 of 3292 steps (50%) done

[Sun Jul  5 23:01:26 2020]
rule join_groups:
    input: per_gene/EOG091G1817/EOG091G1817.ingroup.fasta, per_gene/EOG091G1817/EOG091G1817.outgroup.fasta
    output: per_gene/EOG091G1817/EOG091G1817.fasta
    jobid: 2293
    wildcards: BUSCO=EOG091G1817


        cat per_gene/EOG091G1817/EOG091G1817.ingroup.fasta per_gene/EOG091G1817/EOG091G1817.outgroup.fasta > per_gene/EOG091G1817/EOG091G1817.fasta
        
[Sun Jul  5 23:01:26 2020]
Finished job 2293.
1640 of 3292 steps (50%) done

[Sun Jul  5 23:01:26 2020]
rule MSA:
    input: per_gene/EOG091G1817/EOG091G1817.fasta
    output: per_gene/EOG091G1817/EOG091G1817.clustalo.fasta
    log: per_gene/EOG091G1817/MSA.stdout.txt, per_gene/EOG091G1817/MSA.stderr.txt
    jobid: 1706
    wildcards: BUSCO=EOG091G1817
    threads: 2


        clustalo -i per_gene/EOG091G1817/EOG091G1817.fasta -o per_gene/EOG091G1817/EOG091G1817.clustalo.fasta --threads=2 1> per_gene/EOG091G1817/MSA.stdout.txt 2> per_gene/EOG091G1817/MSA.stderr.txt
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/d68c9691725a7401923680874285c430.simg
[Sun Jul  5 23:01:27 2020]
Finished job 3066.
1641 of 3292 steps (50%) done

[Sun Jul  5 23:01:27 2020]
rule get_outgroups:
    input: per_gene/EOG091G06P4/EOG091G06P4.ingroup.fasta
    output: per_gene/EOG091G06P4/EOG091G06P4.orthodb.fasta, per_gene/EOG091G06P4/EOG091G06P4.outgroup.fasta
    log: per_gene/EOG091G06P4/get_outgroups.stdout.txt, per_gene/EOG091G06P4/get_outgroups.stderr.txt
    jobid: 3067
    wildcards: BUSCO=EOG091G06P4


        #download fastas from Orhtodb for BUSCO id
        for i in {1..5}
        do
             wget "http://www.orthodb.org/fasta?query=EOG091G06P4&level=33208" -O per_gene/EOG091G06P4/EOG091G06P4.orthodb.fasta 1> per_gene/EOG091G06P4/get_outgroups.stdout.txt 2> per_gene/EOG091G06P4/get_outgroups.stderr.txt && break || echo -e "try again ($i)" && sleep 15
        done

	#This is quick an dirty for now and just takes the first protein if there is more than one for an outgroup taxon
        bash ../scripts/download_outgroups.sh taxids.txt per_gene/EOG091G06P4/EOG091G06P4.orthodb.fasta > per_gene/EOG091G06P4/EOG091G06P4.outgroup.fasta
        
[Sun Jul  5 23:01:27 2020]
Finished job 1564.
1642 of 3292 steps (50%) done

[Sun Jul  5 23:01:27 2020]
rule score_and_cut:
    input: per_gene/EOG091G0OHF/EOG091G0OHF.clustalo.fasta
    output: per_gene/EOG091G0OHF/ALICUT_EOG091G0OHF.clustalo.fasta
    jobid: 741
    wildcards: BUSCO=EOG091G0OHF
    threads: 2


        cd per_gene/EOG091G0OHF
        Aliscore.pl -N -r 200000000000000000 -i ../../per_gene/EOG091G0OHF/EOG091G0OHF.clustalo.fasta &> aliscore.log
        ALICUT.pl -s &> alicut.log
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/63c88c27a0fa300f57066b0ef65fefcb.simg
[Sun Jul  5 23:01:28 2020]
Finished job 3067.
1643 of 3292 steps (50%) done

[Sun Jul  5 23:01:28 2020]
rule join_groups:
    input: per_gene/EOG091G06P4/EOG091G06P4.ingroup.fasta, per_gene/EOG091G06P4/EOG091G06P4.outgroup.fasta
    output: per_gene/EOG091G06P4/EOG091G06P4.fasta
    jobid: 2357
    wildcards: BUSCO=EOG091G06P4


        cat per_gene/EOG091G06P4/EOG091G06P4.ingroup.fasta per_gene/EOG091G06P4/EOG091G06P4.outgroup.fasta > per_gene/EOG091G06P4/EOG091G06P4.fasta
        
[Sun Jul  5 23:01:28 2020]
Finished job 2357.
1644 of 3292 steps (50%) done

[Sun Jul  5 23:01:28 2020]
rule MSA:
    input: per_gene/EOG091G06P4/EOG091G06P4.fasta
    output: per_gene/EOG091G06P4/EOG091G06P4.clustalo.fasta
    log: per_gene/EOG091G06P4/MSA.stdout.txt, per_gene/EOG091G06P4/MSA.stderr.txt
    jobid: 1834
    wildcards: BUSCO=EOG091G06P4
    threads: 2


        clustalo -i per_gene/EOG091G06P4/EOG091G06P4.fasta -o per_gene/EOG091G06P4/EOG091G06P4.clustalo.fasta --threads=2 1> per_gene/EOG091G06P4/MSA.stdout.txt 2> per_gene/EOG091G06P4/MSA.stderr.txt
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/d68c9691725a7401923680874285c430.simg
[Sun Jul  5 23:01:29 2020]
Finished job 1706.
1645 of 3292 steps (50%) done

[Sun Jul  5 23:01:29 2020]
rule score_and_cut:
    input: per_gene/EOG091G1817/EOG091G1817.clustalo.fasta
    output: per_gene/EOG091G1817/ALICUT_EOG091G1817.clustalo.fasta
    jobid: 883
    wildcards: BUSCO=EOG091G1817
    threads: 2


        cd per_gene/EOG091G1817
        Aliscore.pl -N -r 200000000000000000 -i ../../per_gene/EOG091G1817/EOG091G1817.clustalo.fasta &> aliscore.log
        ALICUT.pl -s &> alicut.log
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/63c88c27a0fa300f57066b0ef65fefcb.simg
[Sun Jul  5 23:01:30 2020]
Finished job 728.
1646 of 3292 steps (50%) done

[Sun Jul  5 23:01:30 2020]
rule infer_single_ML:
    input: per_gene/EOG091G0NK3/EOG091G0NK3.best_model, per_gene/EOG091G0NK3/ALICUT_EOG091G0NK3.clustalo.fasta
    output: per_gene/EOG091G0NK3/EOG091G0NK3.raxml.done
    log: per_gene/EOG091G0NK3/infer_single_ML.stdout.txt, per_gene/EOG091G0NK3/infer_single_ML.stderr.txt
    jobid: 158
    wildcards: BUSCO=EOG091G0NK3
    threads: 2


        cd per_gene/EOG091G0NK3
	count=$(cat ../../per_gene/EOG091G0NK3/ALICUT_EOG091G0NK3.clustalo.fasta | grep ">" | wc -l)
	if [ "$count" -gt 5 ]
        then
		RAxMLmodel=$(cat ../../per_gene/EOG091G0NK3/EOG091G0NK3.best_model | grep "Best" | cut -d ":" -f 2 | tr -d '[:space:]')
                if [ "$(ls -1 | grep "^RAxML" | wc -l)" -ne 0 ]
		then
			rm RAxML*
		fi
        	raxml -f a -T 2 -m PROTGAMMA$RAxMLmodel         	-p 12345 -x 12345 -# 100         	-s ../../per_gene/EOG091G0NK3/ALICUT_EOG091G0NK3.clustalo.fasta -n EOG091G0NK3.clustalo.aln.ALICUT.$RAxMLmodel 		1> ../../per_gene/EOG091G0NK3/infer_single_ML.stdout.txt 2> ../../per_gene/EOG091G0NK3/infer_single_ML.stderr.txt
	else
		echo "fasta file per_gene/EOG091G0NK3/ALICUT_EOG091G0NK3.clustalo.fasta contains fewer than 5 sequences - skipped" > ../../per_gene/EOG091G0NK3/infer_single_ML.stdout.txt
		touch raxml.skipped
	fi
        touch ../../per_gene/EOG091G0NK3/EOG091G0NK3.raxml.done
        
[Sun Jul  5 23:01:30 2020]
Finished job 169.
1647 of 3292 steps (50%) done

[Sun Jul  5 23:01:30 2020]
rule get_seqs:
    input: /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ingroup.txt, /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/outgroup.txt
    output: per_gene/EOG091G1422/EOG091G1422.ingroup.fasta
    log: per_gene/EOG091G1422/get_seqs.stdout.txt, per_gene/EOG091G1422/get_seqs.stderr.txt
    jobid: 3262
    wildcards: BUSCO=EOG091G1422
    threads: 2


	basedir=$(pwd)
        cd per_gene/EOG091G1422
        
        bash $basedir/../scripts/fetch_seqs.sh EOG091G1422 /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ingroup.txt /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/outgroup.txt 1> ../../per_gene/EOG091G1422/get_seqs.stdout.txt 2> ../../per_gene/EOG091G1422/get_seqs.stderr.txt
	mv EOG091G1422.fasta $basedir/per_gene/EOG091G1422/EOG091G1422.ingroup.fasta
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/72476f9d9a5bd0627b4d721143a21354.simg
[Sun Jul  5 23:01:30 2020]
Finished job 1834.
1648 of 3292 steps (50%) done

[Sun Jul  5 23:01:30 2020]
rule score_and_cut:
    input: per_gene/EOG091G06P4/EOG091G06P4.clustalo.fasta
    output: per_gene/EOG091G06P4/ALICUT_EOG091G06P4.clustalo.fasta
    jobid: 1011
    wildcards: BUSCO=EOG091G06P4
    threads: 2


        cd per_gene/EOG091G06P4
        Aliscore.pl -N -r 200000000000000000 -i ../../per_gene/EOG091G06P4/EOG091G06P4.clustalo.fasta &> aliscore.log
        ALICUT.pl -s &> alicut.log
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/63c88c27a0fa300f57066b0ef65fefcb.simg
[33mJob counts:
	count	jobs
	1	infer_single_ML
	1[0m
[33m
        cd per_gene/EOG091G0NK3
	count=$(cat ../../per_gene/EOG091G0NK3/ALICUT_EOG091G0NK3.clustalo.fasta | grep ">" | wc -l)
	if [ "$count" -gt 5 ]
        then
		RAxMLmodel=$(cat ../../per_gene/EOG091G0NK3/EOG091G0NK3.best_model | grep "Best" | cut -d ":" -f 2 | tr -d '[:space:]')
                if [ "$(ls -1 | grep "^RAxML" | wc -l)" -ne 0 ]
		then
			rm RAxML*
		fi
        	raxml -f a -T 2 -m PROTGAMMA$RAxMLmodel         	-p 12345 -x 12345 -# 100         	-s ../../per_gene/EOG091G0NK3/ALICUT_EOG091G0NK3.clustalo.fasta -n EOG091G0NK3.clustalo.aln.ALICUT.$RAxMLmodel 		1> ../../per_gene/EOG091G0NK3/infer_single_ML.stdout.txt 2> ../../per_gene/EOG091G0NK3/infer_single_ML.stderr.txt
	else
		echo "fasta file per_gene/EOG091G0NK3/ALICUT_EOG091G0NK3.clustalo.fasta contains fewer than 5 sequences - skipped" > ../../per_gene/EOG091G0NK3/infer_single_ML.stdout.txt
		touch raxml.skipped
	fi
        touch ../../per_gene/EOG091G0NK3/EOG091G0NK3.raxml.done
        [0m
[Sun Jul  5 23:01:38 2020]
Finished job 741.
1649 of 3292 steps (50%) done

[Sun Jul  5 23:01:38 2020]
rule remove_empty:
    input: per_gene/EOG091G0OHF/ALICUT_EOG091G0OHF.clustalo.fasta
    output: per_gene/EOG091G0OHF/empty_check.done
    jobid: 1563
    wildcards: BUSCO=EOG091G0OHF


         if [ "$(cat per_gene/EOG091G0OHF/ALICUT_EOG091G0OHF.clustalo.fasta | grep -v ">" | sed 's/-//g' | grep "^$" | wc -l)" -gt 0 ]
         then
              cp per_gene/EOG091G0OHF/ALICUT_EOG091G0OHF.clustalo.fasta per_gene/EOG091G0OHF/ALICUT_EOG091G0OHF.clustalo.fasta.backup
              bash ../scripts/remove_empty.sh per_gene/EOG091G0OHF/ALICUT_EOG091G0OHF.clustalo.fasta.backup > per_gene/EOG091G0OHF/ALICUT_EOG091G0OHF.clustalo.fasta
         fi
         touch per_gene/EOG091G0OHF/empty_check.done
         
[Sun Jul  5 23:01:38 2020]
Finished job 1563.
1650 of 3292 steps (50%) done
[Sun Jul  5 23:01:38 2020]
Finished job 883.
1651 of 3292 steps (50%) done

[Sun Jul  5 23:01:38 2020]
rule remove_empty:
    input: per_gene/EOG091G1817/ALICUT_EOG091G1817.clustalo.fasta
    output: per_gene/EOG091G1817/empty_check.done
    jobid: 1705
    wildcards: BUSCO=EOG091G1817


         if [ "$(cat per_gene/EOG091G1817/ALICUT_EOG091G1817.clustalo.fasta | grep -v ">" | sed 's/-//g' | grep "^$" | wc -l)" -gt 0 ]
         then
              cp per_gene/EOG091G1817/ALICUT_EOG091G1817.clustalo.fasta per_gene/EOG091G1817/ALICUT_EOG091G1817.clustalo.fasta.backup
              bash ../scripts/remove_empty.sh per_gene/EOG091G1817/ALICUT_EOG091G1817.clustalo.fasta.backup > per_gene/EOG091G1817/ALICUT_EOG091G1817.clustalo.fasta
         fi
         touch per_gene/EOG091G1817/empty_check.done
         

[Sun Jul  5 23:01:38 2020]
rule find_best_model:
    input: per_gene/EOG091G0OHF/ALICUT_EOG091G0OHF.clustalo.fasta, per_gene/EOG091G0OHF/empty_check.done
    output: per_gene/EOG091G0OHF/EOG091G0OHF.best_model
    log: per_gene/EOG091G0OHF/find_best_model.stderr.txt
    jobid: 740
    wildcards: BUSCO=EOG091G0OHF
    threads: 2


        cd per_gene/EOG091G0OHF
        if [ ! -d find_best_model ]
        then
            mkdir find_best_model
        fi
        cd find_best_model
        ln -s ../../../per_gene/EOG091G0OHF/ALICUT_EOG091G0OHF.clustalo.fasta EOG091G0OHF.fasta
        ProteinModelSelection.pl EOG091G0OHF.fasta 1> ../../../per_gene/EOG091G0OHF/EOG091G0OHF.best_model 2> ../../../per_gene/EOG091G0OHF/find_best_model.stderr.txt
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/c0c09ee657b1e27f2c5687e0e9aa8d70.simg
[Sun Jul  5 23:01:39 2020]
Finished job 1705.
1652 of 3292 steps (50%) done

[Sun Jul  5 23:01:39 2020]
rule find_best_model:
    input: per_gene/EOG091G1817/ALICUT_EOG091G1817.clustalo.fasta, per_gene/EOG091G1817/empty_check.done
    output: per_gene/EOG091G1817/EOG091G1817.best_model
    log: per_gene/EOG091G1817/find_best_model.stderr.txt
    jobid: 882
    wildcards: BUSCO=EOG091G1817
    threads: 2


        cd per_gene/EOG091G1817
        if [ ! -d find_best_model ]
        then
            mkdir find_best_model
        fi
        cd find_best_model
        ln -s ../../../per_gene/EOG091G1817/ALICUT_EOG091G1817.clustalo.fasta EOG091G1817.fasta
        ProteinModelSelection.pl EOG091G1817.fasta 1> ../../../per_gene/EOG091G1817/EOG091G1817.best_model 2> ../../../per_gene/EOG091G1817/find_best_model.stderr.txt
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/c0c09ee657b1e27f2c5687e0e9aa8d70.simg
[Sun Jul  5 23:01:41 2020]
Finished job 1011.
1653 of 3292 steps (50%) done

[Sun Jul  5 23:01:41 2020]
rule remove_empty:
    input: per_gene/EOG091G06P4/ALICUT_EOG091G06P4.clustalo.fasta
    output: per_gene/EOG091G06P4/empty_check.done
    jobid: 1833
    wildcards: BUSCO=EOG091G06P4


         if [ "$(cat per_gene/EOG091G06P4/ALICUT_EOG091G06P4.clustalo.fasta | grep -v ">" | sed 's/-//g' | grep "^$" | wc -l)" -gt 0 ]
         then
              cp per_gene/EOG091G06P4/ALICUT_EOG091G06P4.clustalo.fasta per_gene/EOG091G06P4/ALICUT_EOG091G06P4.clustalo.fasta.backup
              bash ../scripts/remove_empty.sh per_gene/EOG091G06P4/ALICUT_EOG091G06P4.clustalo.fasta.backup > per_gene/EOG091G06P4/ALICUT_EOG091G06P4.clustalo.fasta
         fi
         touch per_gene/EOG091G06P4/empty_check.done
         
[Sun Jul  5 23:01:41 2020]
Finished job 1833.
1654 of 3292 steps (50%) done
[Sun Jul  5 23:01:41 2020]
Finished job 3262.
1655 of 3292 steps (50%) done

[Sun Jul  5 23:01:41 2020]
rule get_outgroups:
    input: per_gene/EOG091G1422/EOG091G1422.ingroup.fasta
    output: per_gene/EOG091G1422/EOG091G1422.orthodb.fasta, per_gene/EOG091G1422/EOG091G1422.outgroup.fasta
    log: per_gene/EOG091G1422/get_outgroups.stdout.txt, per_gene/EOG091G1422/get_outgroups.stderr.txt
    jobid: 3263
    wildcards: BUSCO=EOG091G1422


        #download fastas from Orhtodb for BUSCO id
        for i in {1..5}
        do
             wget "http://www.orthodb.org/fasta?query=EOG091G1422&level=33208" -O per_gene/EOG091G1422/EOG091G1422.orthodb.fasta 1> per_gene/EOG091G1422/get_outgroups.stdout.txt 2> per_gene/EOG091G1422/get_outgroups.stderr.txt && break || echo -e "try again ($i)" && sleep 15
        done

	#This is quick an dirty for now and just takes the first protein if there is more than one for an outgroup taxon
        bash ../scripts/download_outgroups.sh taxids.txt per_gene/EOG091G1422/EOG091G1422.orthodb.fasta > per_gene/EOG091G1422/EOG091G1422.outgroup.fasta
        

[Sun Jul  5 23:01:41 2020]
rule find_best_model:
    input: per_gene/EOG091G06P4/ALICUT_EOG091G06P4.clustalo.fasta, per_gene/EOG091G06P4/empty_check.done
    output: per_gene/EOG091G06P4/EOG091G06P4.best_model
    log: per_gene/EOG091G06P4/find_best_model.stderr.txt
    jobid: 1010
    wildcards: BUSCO=EOG091G06P4
    threads: 2


        cd per_gene/EOG091G06P4
        if [ ! -d find_best_model ]
        then
            mkdir find_best_model
        fi
        cd find_best_model
        ln -s ../../../per_gene/EOG091G06P4/ALICUT_EOG091G06P4.clustalo.fasta EOG091G06P4.fasta
        ProteinModelSelection.pl EOG091G06P4.fasta 1> ../../../per_gene/EOG091G06P4/EOG091G06P4.best_model 2> ../../../per_gene/EOG091G06P4/find_best_model.stderr.txt
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/c0c09ee657b1e27f2c5687e0e9aa8d70.simg
[Sun Jul  5 23:01:42 2020]
Finished job 3263.
1656 of 3292 steps (50%) done

[Sun Jul  5 23:01:42 2020]
rule join_groups:
    input: per_gene/EOG091G1422/EOG091G1422.ingroup.fasta, per_gene/EOG091G1422/EOG091G1422.outgroup.fasta
    output: per_gene/EOG091G1422/EOG091G1422.fasta
    jobid: 2455
    wildcards: BUSCO=EOG091G1422


        cat per_gene/EOG091G1422/EOG091G1422.ingroup.fasta per_gene/EOG091G1422/EOG091G1422.outgroup.fasta > per_gene/EOG091G1422/EOG091G1422.fasta
        
[Sun Jul  5 23:01:42 2020]
Finished job 2455.
1657 of 3292 steps (50%) done

[Sun Jul  5 23:01:42 2020]
rule MSA:
    input: per_gene/EOG091G1422/EOG091G1422.fasta
    output: per_gene/EOG091G1422/EOG091G1422.clustalo.fasta
    log: per_gene/EOG091G1422/MSA.stdout.txt, per_gene/EOG091G1422/MSA.stderr.txt
    jobid: 2030
    wildcards: BUSCO=EOG091G1422
    threads: 2


        clustalo -i per_gene/EOG091G1422/EOG091G1422.fasta -o per_gene/EOG091G1422/EOG091G1422.clustalo.fasta --threads=2 1> per_gene/EOG091G1422/MSA.stdout.txt 2> per_gene/EOG091G1422/MSA.stderr.txt
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/d68c9691725a7401923680874285c430.simg
[Sun Jul  5 23:01:43 2020]
Finished job 2030.
1658 of 3292 steps (50%) done

[Sun Jul  5 23:01:43 2020]
rule score_and_cut:
    input: per_gene/EOG091G1422/EOG091G1422.clustalo.fasta
    output: per_gene/EOG091G1422/ALICUT_EOG091G1422.clustalo.fasta
    jobid: 1207
    wildcards: BUSCO=EOG091G1422
    threads: 2


        cd per_gene/EOG091G1422
        Aliscore.pl -N -r 200000000000000000 -i ../../per_gene/EOG091G1422/EOG091G1422.clustalo.fasta &> aliscore.log
        ALICUT.pl -s &> alicut.log
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/63c88c27a0fa300f57066b0ef65fefcb.simg
[Sun Jul  5 23:01:53 2020]
Finished job 1207.
1659 of 3292 steps (50%) done

[Sun Jul  5 23:01:53 2020]
rule remove_empty:
    input: per_gene/EOG091G1422/ALICUT_EOG091G1422.clustalo.fasta
    output: per_gene/EOG091G1422/empty_check.done
    jobid: 2029
    wildcards: BUSCO=EOG091G1422


         if [ "$(cat per_gene/EOG091G1422/ALICUT_EOG091G1422.clustalo.fasta | grep -v ">" | sed 's/-//g' | grep "^$" | wc -l)" -gt 0 ]
         then
              cp per_gene/EOG091G1422/ALICUT_EOG091G1422.clustalo.fasta per_gene/EOG091G1422/ALICUT_EOG091G1422.clustalo.fasta.backup
              bash ../scripts/remove_empty.sh per_gene/EOG091G1422/ALICUT_EOG091G1422.clustalo.fasta.backup > per_gene/EOG091G1422/ALICUT_EOG091G1422.clustalo.fasta
         fi
         touch per_gene/EOG091G1422/empty_check.done
         
[Sun Jul  5 23:01:53 2020]
Finished job 2029.
1660 of 3292 steps (50%) done

[Sun Jul  5 23:01:53 2020]
rule find_best_model:
    input: per_gene/EOG091G1422/ALICUT_EOG091G1422.clustalo.fasta, per_gene/EOG091G1422/empty_check.done
    output: per_gene/EOG091G1422/EOG091G1422.best_model
    log: per_gene/EOG091G1422/find_best_model.stderr.txt
    jobid: 1206
    wildcards: BUSCO=EOG091G1422
    threads: 2


        cd per_gene/EOG091G1422
        if [ ! -d find_best_model ]
        then
            mkdir find_best_model
        fi
        cd find_best_model
        ln -s ../../../per_gene/EOG091G1422/ALICUT_EOG091G1422.clustalo.fasta EOG091G1422.fasta
        ProteinModelSelection.pl EOG091G1422.fasta 1> ../../../per_gene/EOG091G1422/EOG091G1422.best_model 2> ../../../per_gene/EOG091G1422/find_best_model.stderr.txt
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/c0c09ee657b1e27f2c5687e0e9aa8d70.simg
[Sun Jul  5 23:01:53 2020]
Finished job 8.
1661 of 3292 steps (50%) done

[Sun Jul  5 23:01:53 2020]
rule get_seqs:
    input: /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ingroup.txt, /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/outgroup.txt
    output: per_gene/EOG091G0JI0/EOG091G0JI0.ingroup.fasta
    log: per_gene/EOG091G0JI0/get_seqs.stdout.txt, per_gene/EOG091G0JI0/get_seqs.stderr.txt
    jobid: 3274
    wildcards: BUSCO=EOG091G0JI0
    threads: 2


	basedir=$(pwd)
        cd per_gene/EOG091G0JI0
        
        bash $basedir/../scripts/fetch_seqs.sh EOG091G0JI0 /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ingroup.txt /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/outgroup.txt 1> ../../per_gene/EOG091G0JI0/get_seqs.stdout.txt 2> ../../per_gene/EOG091G0JI0/get_seqs.stderr.txt
	mv EOG091G0JI0.fasta $basedir/per_gene/EOG091G0JI0/EOG091G0JI0.ingroup.fasta
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/72476f9d9a5bd0627b4d721143a21354.simg
[Sun Jul  5 23:02:05 2020]
Finished job 3274.
1662 of 3292 steps (50%) done

[Sun Jul  5 23:02:05 2020]
rule get_outgroups:
    input: per_gene/EOG091G0JI0/EOG091G0JI0.ingroup.fasta
    output: per_gene/EOG091G0JI0/EOG091G0JI0.orthodb.fasta, per_gene/EOG091G0JI0/EOG091G0JI0.outgroup.fasta
    log: per_gene/EOG091G0JI0/get_outgroups.stdout.txt, per_gene/EOG091G0JI0/get_outgroups.stderr.txt
    jobid: 3275
    wildcards: BUSCO=EOG091G0JI0


        #download fastas from Orhtodb for BUSCO id
        for i in {1..5}
        do
             wget "http://www.orthodb.org/fasta?query=EOG091G0JI0&level=33208" -O per_gene/EOG091G0JI0/EOG091G0JI0.orthodb.fasta 1> per_gene/EOG091G0JI0/get_outgroups.stdout.txt 2> per_gene/EOG091G0JI0/get_outgroups.stderr.txt && break || echo -e "try again ($i)" && sleep 15
        done

	#This is quick an dirty for now and just takes the first protein if there is more than one for an outgroup taxon
        bash ../scripts/download_outgroups.sh taxids.txt per_gene/EOG091G0JI0/EOG091G0JI0.orthodb.fasta > per_gene/EOG091G0JI0/EOG091G0JI0.outgroup.fasta
        
[Sun Jul  5 23:02:06 2020]
Finished job 3275.
1663 of 3292 steps (51%) done

[Sun Jul  5 23:02:06 2020]
rule join_groups:
    input: per_gene/EOG091G0JI0/EOG091G0JI0.ingroup.fasta, per_gene/EOG091G0JI0/EOG091G0JI0.outgroup.fasta
    output: per_gene/EOG091G0JI0/EOG091G0JI0.fasta
    jobid: 2461
    wildcards: BUSCO=EOG091G0JI0


        cat per_gene/EOG091G0JI0/EOG091G0JI0.ingroup.fasta per_gene/EOG091G0JI0/EOG091G0JI0.outgroup.fasta > per_gene/EOG091G0JI0/EOG091G0JI0.fasta
        
[Sun Jul  5 23:02:06 2020]
Finished job 2461.
1664 of 3292 steps (51%) done

[Sun Jul  5 23:02:06 2020]
rule MSA:
    input: per_gene/EOG091G0JI0/EOG091G0JI0.fasta
    output: per_gene/EOG091G0JI0/EOG091G0JI0.clustalo.fasta
    log: per_gene/EOG091G0JI0/MSA.stdout.txt, per_gene/EOG091G0JI0/MSA.stderr.txt
    jobid: 2042
    wildcards: BUSCO=EOG091G0JI0
    threads: 2


        clustalo -i per_gene/EOG091G0JI0/EOG091G0JI0.fasta -o per_gene/EOG091G0JI0/EOG091G0JI0.clustalo.fasta --threads=2 1> per_gene/EOG091G0JI0/MSA.stdout.txt 2> per_gene/EOG091G0JI0/MSA.stderr.txt
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/d68c9691725a7401923680874285c430.simg
[Sun Jul  5 23:02:07 2020]
Finished job 2042.
1665 of 3292 steps (51%) done

[Sun Jul  5 23:02:07 2020]
rule score_and_cut:
    input: per_gene/EOG091G0JI0/EOG091G0JI0.clustalo.fasta
    output: per_gene/EOG091G0JI0/ALICUT_EOG091G0JI0.clustalo.fasta
    jobid: 1219
    wildcards: BUSCO=EOG091G0JI0
    threads: 2


        cd per_gene/EOG091G0JI0
        Aliscore.pl -N -r 200000000000000000 -i ../../per_gene/EOG091G0JI0/EOG091G0JI0.clustalo.fasta &> aliscore.log
        ALICUT.pl -s &> alicut.log
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/63c88c27a0fa300f57066b0ef65fefcb.simg
[Sun Jul  5 23:02:12 2020]
Finished job 882.
1666 of 3292 steps (51%) done

[Sun Jul  5 23:02:12 2020]
rule infer_single_ML:
    input: per_gene/EOG091G1817/EOG091G1817.best_model, per_gene/EOG091G1817/ALICUT_EOG091G1817.clustalo.fasta
    output: per_gene/EOG091G1817/EOG091G1817.raxml.done
    log: per_gene/EOG091G1817/infer_single_ML.stdout.txt, per_gene/EOG091G1817/infer_single_ML.stderr.txt
    jobid: 235
    wildcards: BUSCO=EOG091G1817
    threads: 2


        cd per_gene/EOG091G1817
	count=$(cat ../../per_gene/EOG091G1817/ALICUT_EOG091G1817.clustalo.fasta | grep ">" | wc -l)
	if [ "$count" -gt 5 ]
        then
		RAxMLmodel=$(cat ../../per_gene/EOG091G1817/EOG091G1817.best_model | grep "Best" | cut -d ":" -f 2 | tr -d '[:space:]')
                if [ "$(ls -1 | grep "^RAxML" | wc -l)" -ne 0 ]
		then
			rm RAxML*
		fi
        	raxml -f a -T 2 -m PROTGAMMA$RAxMLmodel         	-p 12345 -x 12345 -# 100         	-s ../../per_gene/EOG091G1817/ALICUT_EOG091G1817.clustalo.fasta -n EOG091G1817.clustalo.aln.ALICUT.$RAxMLmodel 		1> ../../per_gene/EOG091G1817/infer_single_ML.stdout.txt 2> ../../per_gene/EOG091G1817/infer_single_ML.stderr.txt
	else
		echo "fasta file per_gene/EOG091G1817/ALICUT_EOG091G1817.clustalo.fasta contains fewer than 5 sequences - skipped" > ../../per_gene/EOG091G1817/infer_single_ML.stdout.txt
		touch raxml.skipped
	fi
        touch ../../per_gene/EOG091G1817/EOG091G1817.raxml.done
        
[33mJob counts:
	count	jobs
	1	infer_single_ML
	1[0m
[33m
        cd per_gene/EOG091G1817
	count=$(cat ../../per_gene/EOG091G1817/ALICUT_EOG091G1817.clustalo.fasta | grep ">" | wc -l)
	if [ "$count" -gt 5 ]
        then
		RAxMLmodel=$(cat ../../per_gene/EOG091G1817/EOG091G1817.best_model | grep "Best" | cut -d ":" -f 2 | tr -d '[:space:]')
                if [ "$(ls -1 | grep "^RAxML" | wc -l)" -ne 0 ]
		then
			rm RAxML*
		fi
        	raxml -f a -T 2 -m PROTGAMMA$RAxMLmodel         	-p 12345 -x 12345 -# 100         	-s ../../per_gene/EOG091G1817/ALICUT_EOG091G1817.clustalo.fasta -n EOG091G1817.clustalo.aln.ALICUT.$RAxMLmodel 		1> ../../per_gene/EOG091G1817/infer_single_ML.stdout.txt 2> ../../per_gene/EOG091G1817/infer_single_ML.stderr.txt
	else
		echo "fasta file per_gene/EOG091G1817/ALICUT_EOG091G1817.clustalo.fasta contains fewer than 5 sequences - skipped" > ../../per_gene/EOG091G1817/infer_single_ML.stdout.txt
		touch raxml.skipped
	fi
        touch ../../per_gene/EOG091G1817/EOG091G1817.raxml.done
        [0m
[Sun Jul  5 23:02:13 2020]
Finished job 1010.
1667 of 3292 steps (51%) done

[Sun Jul  5 23:02:13 2020]
rule infer_single_ML:
    input: per_gene/EOG091G06P4/EOG091G06P4.best_model, per_gene/EOG091G06P4/ALICUT_EOG091G06P4.clustalo.fasta
    output: per_gene/EOG091G06P4/EOG091G06P4.raxml.done
    log: per_gene/EOG091G06P4/infer_single_ML.stdout.txt, per_gene/EOG091G06P4/infer_single_ML.stderr.txt
    jobid: 299
    wildcards: BUSCO=EOG091G06P4
    threads: 2


        cd per_gene/EOG091G06P4
	count=$(cat ../../per_gene/EOG091G06P4/ALICUT_EOG091G06P4.clustalo.fasta | grep ">" | wc -l)
	if [ "$count" -gt 5 ]
        then
		RAxMLmodel=$(cat ../../per_gene/EOG091G06P4/EOG091G06P4.best_model | grep "Best" | cut -d ":" -f 2 | tr -d '[:space:]')
                if [ "$(ls -1 | grep "^RAxML" | wc -l)" -ne 0 ]
		then
			rm RAxML*
		fi
        	raxml -f a -T 2 -m PROTGAMMA$RAxMLmodel         	-p 12345 -x 12345 -# 100         	-s ../../per_gene/EOG091G06P4/ALICUT_EOG091G06P4.clustalo.fasta -n EOG091G06P4.clustalo.aln.ALICUT.$RAxMLmodel 		1> ../../per_gene/EOG091G06P4/infer_single_ML.stdout.txt 2> ../../per_gene/EOG091G06P4/infer_single_ML.stderr.txt
	else
		echo "fasta file per_gene/EOG091G06P4/ALICUT_EOG091G06P4.clustalo.fasta contains fewer than 5 sequences - skipped" > ../../per_gene/EOG091G06P4/infer_single_ML.stdout.txt
		touch raxml.skipped
	fi
        touch ../../per_gene/EOG091G06P4/EOG091G06P4.raxml.done
        
[33mJob counts:
	count	jobs
	1	infer_single_ML
	1[0m
[33m
        cd per_gene/EOG091G06P4
	count=$(cat ../../per_gene/EOG091G06P4/ALICUT_EOG091G06P4.clustalo.fasta | grep ">" | wc -l)
	if [ "$count" -gt 5 ]
        then
		RAxMLmodel=$(cat ../../per_gene/EOG091G06P4/EOG091G06P4.best_model | grep "Best" | cut -d ":" -f 2 | tr -d '[:space:]')
                if [ "$(ls -1 | grep "^RAxML" | wc -l)" -ne 0 ]
		then
			rm RAxML*
		fi
        	raxml -f a -T 2 -m PROTGAMMA$RAxMLmodel         	-p 12345 -x 12345 -# 100         	-s ../../per_gene/EOG091G06P4/ALICUT_EOG091G06P4.clustalo.fasta -n EOG091G06P4.clustalo.aln.ALICUT.$RAxMLmodel 		1> ../../per_gene/EOG091G06P4/infer_single_ML.stdout.txt 2> ../../per_gene/EOG091G06P4/infer_single_ML.stderr.txt
	else
		echo "fasta file per_gene/EOG091G06P4/ALICUT_EOG091G06P4.clustalo.fasta contains fewer than 5 sequences - skipped" > ../../per_gene/EOG091G06P4/infer_single_ML.stdout.txt
		touch raxml.skipped
	fi
        touch ../../per_gene/EOG091G06P4/EOG091G06P4.raxml.done
        [0m
[Sun Jul  5 23:02:14 2020]
Finished job 1206.
1668 of 3292 steps (51%) done

[Sun Jul  5 23:02:14 2020]
rule infer_single_ML:
    input: per_gene/EOG091G1422/EOG091G1422.best_model, per_gene/EOG091G1422/ALICUT_EOG091G1422.clustalo.fasta
    output: per_gene/EOG091G1422/EOG091G1422.raxml.done
    log: per_gene/EOG091G1422/infer_single_ML.stdout.txt, per_gene/EOG091G1422/infer_single_ML.stderr.txt
    jobid: 397
    wildcards: BUSCO=EOG091G1422
    threads: 2


        cd per_gene/EOG091G1422
	count=$(cat ../../per_gene/EOG091G1422/ALICUT_EOG091G1422.clustalo.fasta | grep ">" | wc -l)
	if [ "$count" -gt 5 ]
        then
		RAxMLmodel=$(cat ../../per_gene/EOG091G1422/EOG091G1422.best_model | grep "Best" | cut -d ":" -f 2 | tr -d '[:space:]')
                if [ "$(ls -1 | grep "^RAxML" | wc -l)" -ne 0 ]
		then
			rm RAxML*
		fi
        	raxml -f a -T 2 -m PROTGAMMA$RAxMLmodel         	-p 12345 -x 12345 -# 100         	-s ../../per_gene/EOG091G1422/ALICUT_EOG091G1422.clustalo.fasta -n EOG091G1422.clustalo.aln.ALICUT.$RAxMLmodel 		1> ../../per_gene/EOG091G1422/infer_single_ML.stdout.txt 2> ../../per_gene/EOG091G1422/infer_single_ML.stderr.txt
	else
		echo "fasta file per_gene/EOG091G1422/ALICUT_EOG091G1422.clustalo.fasta contains fewer than 5 sequences - skipped" > ../../per_gene/EOG091G1422/infer_single_ML.stdout.txt
		touch raxml.skipped
	fi
        touch ../../per_gene/EOG091G1422/EOG091G1422.raxml.done
        
[33mJob counts:
	count	jobs
	1	infer_single_ML
	1[0m
[33m
        cd per_gene/EOG091G1422
	count=$(cat ../../per_gene/EOG091G1422/ALICUT_EOG091G1422.clustalo.fasta | grep ">" | wc -l)
	if [ "$count" -gt 5 ]
        then
		RAxMLmodel=$(cat ../../per_gene/EOG091G1422/EOG091G1422.best_model | grep "Best" | cut -d ":" -f 2 | tr -d '[:space:]')
                if [ "$(ls -1 | grep "^RAxML" | wc -l)" -ne 0 ]
		then
			rm RAxML*
		fi
        	raxml -f a -T 2 -m PROTGAMMA$RAxMLmodel         	-p 12345 -x 12345 -# 100         	-s ../../per_gene/EOG091G1422/ALICUT_EOG091G1422.clustalo.fasta -n EOG091G1422.clustalo.aln.ALICUT.$RAxMLmodel 		1> ../../per_gene/EOG091G1422/infer_single_ML.stdout.txt 2> ../../per_gene/EOG091G1422/infer_single_ML.stderr.txt
	else
		echo "fasta file per_gene/EOG091G1422/ALICUT_EOG091G1422.clustalo.fasta contains fewer than 5 sequences - skipped" > ../../per_gene/EOG091G1422/infer_single_ML.stdout.txt
		touch raxml.skipped
	fi
        touch ../../per_gene/EOG091G1422/EOG091G1422.raxml.done
        [0m
[Sun Jul  5 23:02:16 2020]
Finished job 183.
1669 of 3292 steps (51%) done

[Sun Jul  5 23:02:16 2020]
rule get_seqs:
    input: /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ingroup.txt, /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/outgroup.txt
    output: per_gene/EOG091G0KSQ/EOG091G0KSQ.ingroup.fasta
    log: per_gene/EOG091G0KSQ/get_seqs.stdout.txt, per_gene/EOG091G0KSQ/get_seqs.stderr.txt
    jobid: 2994
    wildcards: BUSCO=EOG091G0KSQ
    threads: 2


	basedir=$(pwd)
        cd per_gene/EOG091G0KSQ
        
        bash $basedir/../scripts/fetch_seqs.sh EOG091G0KSQ /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ingroup.txt /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/outgroup.txt 1> ../../per_gene/EOG091G0KSQ/get_seqs.stdout.txt 2> ../../per_gene/EOG091G0KSQ/get_seqs.stderr.txt
	mv EOG091G0KSQ.fasta $basedir/per_gene/EOG091G0KSQ/EOG091G0KSQ.ingroup.fasta
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/72476f9d9a5bd0627b4d721143a21354.simg
[Sun Jul  5 23:02:17 2020]
Finished job 1219.
1670 of 3292 steps (51%) done

[Sun Jul  5 23:02:17 2020]
rule remove_empty:
    input: per_gene/EOG091G0JI0/ALICUT_EOG091G0JI0.clustalo.fasta
    output: per_gene/EOG091G0JI0/empty_check.done
    jobid: 2041
    wildcards: BUSCO=EOG091G0JI0


         if [ "$(cat per_gene/EOG091G0JI0/ALICUT_EOG091G0JI0.clustalo.fasta | grep -v ">" | sed 's/-//g' | grep "^$" | wc -l)" -gt 0 ]
         then
              cp per_gene/EOG091G0JI0/ALICUT_EOG091G0JI0.clustalo.fasta per_gene/EOG091G0JI0/ALICUT_EOG091G0JI0.clustalo.fasta.backup
              bash ../scripts/remove_empty.sh per_gene/EOG091G0JI0/ALICUT_EOG091G0JI0.clustalo.fasta.backup > per_gene/EOG091G0JI0/ALICUT_EOG091G0JI0.clustalo.fasta
         fi
         touch per_gene/EOG091G0JI0/empty_check.done
         
[Sun Jul  5 23:02:18 2020]
Finished job 2041.
1671 of 3292 steps (51%) done

[Sun Jul  5 23:02:18 2020]
rule find_best_model:
    input: per_gene/EOG091G0JI0/ALICUT_EOG091G0JI0.clustalo.fasta, per_gene/EOG091G0JI0/empty_check.done
    output: per_gene/EOG091G0JI0/EOG091G0JI0.best_model
    log: per_gene/EOG091G0JI0/find_best_model.stderr.txt
    jobid: 1218
    wildcards: BUSCO=EOG091G0JI0
    threads: 2


        cd per_gene/EOG091G0JI0
        if [ ! -d find_best_model ]
        then
            mkdir find_best_model
        fi
        cd find_best_model
        ln -s ../../../per_gene/EOG091G0JI0/ALICUT_EOG091G0JI0.clustalo.fasta EOG091G0JI0.fasta
        ProteinModelSelection.pl EOG091G0JI0.fasta 1> ../../../per_gene/EOG091G0JI0/EOG091G0JI0.best_model 2> ../../../per_gene/EOG091G0JI0/find_best_model.stderr.txt
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/c0c09ee657b1e27f2c5687e0e9aa8d70.simg
[Sun Jul  5 23:02:29 2020]
Finished job 2994.
1672 of 3292 steps (51%) done

[Sun Jul  5 23:02:29 2020]
rule get_outgroups:
    input: per_gene/EOG091G0KSQ/EOG091G0KSQ.ingroup.fasta
    output: per_gene/EOG091G0KSQ/EOG091G0KSQ.orthodb.fasta, per_gene/EOG091G0KSQ/EOG091G0KSQ.outgroup.fasta
    log: per_gene/EOG091G0KSQ/get_outgroups.stdout.txt, per_gene/EOG091G0KSQ/get_outgroups.stderr.txt
    jobid: 2995
    wildcards: BUSCO=EOG091G0KSQ


        #download fastas from Orhtodb for BUSCO id
        for i in {1..5}
        do
             wget "http://www.orthodb.org/fasta?query=EOG091G0KSQ&level=33208" -O per_gene/EOG091G0KSQ/EOG091G0KSQ.orthodb.fasta 1> per_gene/EOG091G0KSQ/get_outgroups.stdout.txt 2> per_gene/EOG091G0KSQ/get_outgroups.stderr.txt && break || echo -e "try again ($i)" && sleep 15
        done

	#This is quick an dirty for now and just takes the first protein if there is more than one for an outgroup taxon
        bash ../scripts/download_outgroups.sh taxids.txt per_gene/EOG091G0KSQ/EOG091G0KSQ.orthodb.fasta > per_gene/EOG091G0KSQ/EOG091G0KSQ.outgroup.fasta
        
[Sun Jul  5 23:02:30 2020]
Finished job 2995.
1673 of 3292 steps (51%) done

[Sun Jul  5 23:02:30 2020]
rule join_groups:
    input: per_gene/EOG091G0KSQ/EOG091G0KSQ.ingroup.fasta, per_gene/EOG091G0KSQ/EOG091G0KSQ.outgroup.fasta
    output: per_gene/EOG091G0KSQ/EOG091G0KSQ.fasta
    jobid: 2321
    wildcards: BUSCO=EOG091G0KSQ


        cat per_gene/EOG091G0KSQ/EOG091G0KSQ.ingroup.fasta per_gene/EOG091G0KSQ/EOG091G0KSQ.outgroup.fasta > per_gene/EOG091G0KSQ/EOG091G0KSQ.fasta
        
[Sun Jul  5 23:02:30 2020]
Finished job 2321.
1674 of 3292 steps (51%) done

[Sun Jul  5 23:02:30 2020]
rule MSA:
    input: per_gene/EOG091G0KSQ/EOG091G0KSQ.fasta
    output: per_gene/EOG091G0KSQ/EOG091G0KSQ.clustalo.fasta
    log: per_gene/EOG091G0KSQ/MSA.stdout.txt, per_gene/EOG091G0KSQ/MSA.stderr.txt
    jobid: 1762
    wildcards: BUSCO=EOG091G0KSQ
    threads: 2


        clustalo -i per_gene/EOG091G0KSQ/EOG091G0KSQ.fasta -o per_gene/EOG091G0KSQ/EOG091G0KSQ.clustalo.fasta --threads=2 1> per_gene/EOG091G0KSQ/MSA.stdout.txt 2> per_gene/EOG091G0KSQ/MSA.stderr.txt
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/d68c9691725a7401923680874285c430.simg
[Sun Jul  5 23:02:31 2020]
Finished job 740.
1675 of 3292 steps (51%) done

[Sun Jul  5 23:02:31 2020]
rule infer_single_ML:
    input: per_gene/EOG091G0OHF/EOG091G0OHF.best_model, per_gene/EOG091G0OHF/ALICUT_EOG091G0OHF.clustalo.fasta
    output: per_gene/EOG091G0OHF/EOG091G0OHF.raxml.done
    log: per_gene/EOG091G0OHF/infer_single_ML.stdout.txt, per_gene/EOG091G0OHF/infer_single_ML.stderr.txt
    jobid: 164
    wildcards: BUSCO=EOG091G0OHF
    threads: 2


        cd per_gene/EOG091G0OHF
	count=$(cat ../../per_gene/EOG091G0OHF/ALICUT_EOG091G0OHF.clustalo.fasta | grep ">" | wc -l)
	if [ "$count" -gt 5 ]
        then
		RAxMLmodel=$(cat ../../per_gene/EOG091G0OHF/EOG091G0OHF.best_model | grep "Best" | cut -d ":" -f 2 | tr -d '[:space:]')
                if [ "$(ls -1 | grep "^RAxML" | wc -l)" -ne 0 ]
		then
			rm RAxML*
		fi
        	raxml -f a -T 2 -m PROTGAMMA$RAxMLmodel         	-p 12345 -x 12345 -# 100         	-s ../../per_gene/EOG091G0OHF/ALICUT_EOG091G0OHF.clustalo.fasta -n EOG091G0OHF.clustalo.aln.ALICUT.$RAxMLmodel 		1> ../../per_gene/EOG091G0OHF/infer_single_ML.stdout.txt 2> ../../per_gene/EOG091G0OHF/infer_single_ML.stderr.txt
	else
		echo "fasta file per_gene/EOG091G0OHF/ALICUT_EOG091G0OHF.clustalo.fasta contains fewer than 5 sequences - skipped" > ../../per_gene/EOG091G0OHF/infer_single_ML.stdout.txt
		touch raxml.skipped
	fi
        touch ../../per_gene/EOG091G0OHF/EOG091G0OHF.raxml.done
        
[Sun Jul  5 23:02:31 2020]
Finished job 1762.
1676 of 3292 steps (51%) done

[Sun Jul  5 23:02:31 2020]
rule score_and_cut:
    input: per_gene/EOG091G0KSQ/EOG091G0KSQ.clustalo.fasta
    output: per_gene/EOG091G0KSQ/ALICUT_EOG091G0KSQ.clustalo.fasta
    jobid: 939
    wildcards: BUSCO=EOG091G0KSQ
    threads: 2


        cd per_gene/EOG091G0KSQ
        Aliscore.pl -N -r 200000000000000000 -i ../../per_gene/EOG091G0KSQ/EOG091G0KSQ.clustalo.fasta &> aliscore.log
        ALICUT.pl -s &> alicut.log
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/63c88c27a0fa300f57066b0ef65fefcb.simg
[33mJob counts:
	count	jobs
	1	infer_single_ML
	1[0m
[33m
        cd per_gene/EOG091G0OHF
	count=$(cat ../../per_gene/EOG091G0OHF/ALICUT_EOG091G0OHF.clustalo.fasta | grep ">" | wc -l)
	if [ "$count" -gt 5 ]
        then
		RAxMLmodel=$(cat ../../per_gene/EOG091G0OHF/EOG091G0OHF.best_model | grep "Best" | cut -d ":" -f 2 | tr -d '[:space:]')
                if [ "$(ls -1 | grep "^RAxML" | wc -l)" -ne 0 ]
		then
			rm RAxML*
		fi
        	raxml -f a -T 2 -m PROTGAMMA$RAxMLmodel         	-p 12345 -x 12345 -# 100         	-s ../../per_gene/EOG091G0OHF/ALICUT_EOG091G0OHF.clustalo.fasta -n EOG091G0OHF.clustalo.aln.ALICUT.$RAxMLmodel 		1> ../../per_gene/EOG091G0OHF/infer_single_ML.stdout.txt 2> ../../per_gene/EOG091G0OHF/infer_single_ML.stderr.txt
	else
		echo "fasta file per_gene/EOG091G0OHF/ALICUT_EOG091G0OHF.clustalo.fasta contains fewer than 5 sequences - skipped" > ../../per_gene/EOG091G0OHF/infer_single_ML.stdout.txt
		touch raxml.skipped
	fi
        touch ../../per_gene/EOG091G0OHF/EOG091G0OHF.raxml.done
        [0m
[Sun Jul  5 23:02:42 2020]
Finished job 939.
1677 of 3292 steps (51%) done

[Sun Jul  5 23:02:42 2020]
rule remove_empty:
    input: per_gene/EOG091G0KSQ/ALICUT_EOG091G0KSQ.clustalo.fasta
    output: per_gene/EOG091G0KSQ/empty_check.done
    jobid: 1761
    wildcards: BUSCO=EOG091G0KSQ


         if [ "$(cat per_gene/EOG091G0KSQ/ALICUT_EOG091G0KSQ.clustalo.fasta | grep -v ">" | sed 's/-//g' | grep "^$" | wc -l)" -gt 0 ]
         then
              cp per_gene/EOG091G0KSQ/ALICUT_EOG091G0KSQ.clustalo.fasta per_gene/EOG091G0KSQ/ALICUT_EOG091G0KSQ.clustalo.fasta.backup
              bash ../scripts/remove_empty.sh per_gene/EOG091G0KSQ/ALICUT_EOG091G0KSQ.clustalo.fasta.backup > per_gene/EOG091G0KSQ/ALICUT_EOG091G0KSQ.clustalo.fasta
         fi
         touch per_gene/EOG091G0KSQ/empty_check.done
         
[Sun Jul  5 23:02:42 2020]
Finished job 1761.
1678 of 3292 steps (51%) done

[Sun Jul  5 23:02:42 2020]
rule find_best_model:
    input: per_gene/EOG091G0KSQ/ALICUT_EOG091G0KSQ.clustalo.fasta, per_gene/EOG091G0KSQ/empty_check.done
    output: per_gene/EOG091G0KSQ/EOG091G0KSQ.best_model
    log: per_gene/EOG091G0KSQ/find_best_model.stderr.txt
    jobid: 938
    wildcards: BUSCO=EOG091G0KSQ
    threads: 2


        cd per_gene/EOG091G0KSQ
        if [ ! -d find_best_model ]
        then
            mkdir find_best_model
        fi
        cd find_best_model
        ln -s ../../../per_gene/EOG091G0KSQ/ALICUT_EOG091G0KSQ.clustalo.fasta EOG091G0KSQ.fasta
        ProteinModelSelection.pl EOG091G0KSQ.fasta 1> ../../../per_gene/EOG091G0KSQ/EOG091G0KSQ.best_model 2> ../../../per_gene/EOG091G0KSQ/find_best_model.stderr.txt
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/c0c09ee657b1e27f2c5687e0e9aa8d70.simg
[Sun Jul  5 23:02:44 2020]
Finished job 1218.
1679 of 3292 steps (51%) done

[Sun Jul  5 23:02:44 2020]
rule infer_single_ML:
    input: per_gene/EOG091G0JI0/EOG091G0JI0.best_model, per_gene/EOG091G0JI0/ALICUT_EOG091G0JI0.clustalo.fasta
    output: per_gene/EOG091G0JI0/EOG091G0JI0.raxml.done
    log: per_gene/EOG091G0JI0/infer_single_ML.stdout.txt, per_gene/EOG091G0JI0/infer_single_ML.stderr.txt
    jobid: 403
    wildcards: BUSCO=EOG091G0JI0
    threads: 2


        cd per_gene/EOG091G0JI0
	count=$(cat ../../per_gene/EOG091G0JI0/ALICUT_EOG091G0JI0.clustalo.fasta | grep ">" | wc -l)
	if [ "$count" -gt 5 ]
        then
		RAxMLmodel=$(cat ../../per_gene/EOG091G0JI0/EOG091G0JI0.best_model | grep "Best" | cut -d ":" -f 2 | tr -d '[:space:]')
                if [ "$(ls -1 | grep "^RAxML" | wc -l)" -ne 0 ]
		then
			rm RAxML*
		fi
        	raxml -f a -T 2 -m PROTGAMMA$RAxMLmodel         	-p 12345 -x 12345 -# 100         	-s ../../per_gene/EOG091G0JI0/ALICUT_EOG091G0JI0.clustalo.fasta -n EOG091G0JI0.clustalo.aln.ALICUT.$RAxMLmodel 		1> ../../per_gene/EOG091G0JI0/infer_single_ML.stdout.txt 2> ../../per_gene/EOG091G0JI0/infer_single_ML.stderr.txt
	else
		echo "fasta file per_gene/EOG091G0JI0/ALICUT_EOG091G0JI0.clustalo.fasta contains fewer than 5 sequences - skipped" > ../../per_gene/EOG091G0JI0/infer_single_ML.stdout.txt
		touch raxml.skipped
	fi
        touch ../../per_gene/EOG091G0JI0/EOG091G0JI0.raxml.done
        
[33mJob counts:
	count	jobs
	1	infer_single_ML
	1[0m
[33m
        cd per_gene/EOG091G0JI0
	count=$(cat ../../per_gene/EOG091G0JI0/ALICUT_EOG091G0JI0.clustalo.fasta | grep ">" | wc -l)
	if [ "$count" -gt 5 ]
        then
		RAxMLmodel=$(cat ../../per_gene/EOG091G0JI0/EOG091G0JI0.best_model | grep "Best" | cut -d ":" -f 2 | tr -d '[:space:]')
                if [ "$(ls -1 | grep "^RAxML" | wc -l)" -ne 0 ]
		then
			rm RAxML*
		fi
        	raxml -f a -T 2 -m PROTGAMMA$RAxMLmodel         	-p 12345 -x 12345 -# 100         	-s ../../per_gene/EOG091G0JI0/ALICUT_EOG091G0JI0.clustalo.fasta -n EOG091G0JI0.clustalo.aln.ALICUT.$RAxMLmodel 		1> ../../per_gene/EOG091G0JI0/infer_single_ML.stdout.txt 2> ../../per_gene/EOG091G0JI0/infer_single_ML.stderr.txt
	else
		echo "fasta file per_gene/EOG091G0JI0/ALICUT_EOG091G0JI0.clustalo.fasta contains fewer than 5 sequences - skipped" > ../../per_gene/EOG091G0JI0/infer_single_ML.stdout.txt
		touch raxml.skipped
	fi
        touch ../../per_gene/EOG091G0JI0/EOG091G0JI0.raxml.done
        [0m
[Sun Jul  5 23:03:07 2020]
Finished job 938.
1680 of 3292 steps (51%) done

[Sun Jul  5 23:03:07 2020]
rule infer_single_ML:
    input: per_gene/EOG091G0KSQ/EOG091G0KSQ.best_model, per_gene/EOG091G0KSQ/ALICUT_EOG091G0KSQ.clustalo.fasta
    output: per_gene/EOG091G0KSQ/EOG091G0KSQ.raxml.done
    log: per_gene/EOG091G0KSQ/infer_single_ML.stdout.txt, per_gene/EOG091G0KSQ/infer_single_ML.stderr.txt
    jobid: 263
    wildcards: BUSCO=EOG091G0KSQ
    threads: 2


        cd per_gene/EOG091G0KSQ
	count=$(cat ../../per_gene/EOG091G0KSQ/ALICUT_EOG091G0KSQ.clustalo.fasta | grep ">" | wc -l)
	if [ "$count" -gt 5 ]
        then
		RAxMLmodel=$(cat ../../per_gene/EOG091G0KSQ/EOG091G0KSQ.best_model | grep "Best" | cut -d ":" -f 2 | tr -d '[:space:]')
                if [ "$(ls -1 | grep "^RAxML" | wc -l)" -ne 0 ]
		then
			rm RAxML*
		fi
        	raxml -f a -T 2 -m PROTGAMMA$RAxMLmodel         	-p 12345 -x 12345 -# 100         	-s ../../per_gene/EOG091G0KSQ/ALICUT_EOG091G0KSQ.clustalo.fasta -n EOG091G0KSQ.clustalo.aln.ALICUT.$RAxMLmodel 		1> ../../per_gene/EOG091G0KSQ/infer_single_ML.stdout.txt 2> ../../per_gene/EOG091G0KSQ/infer_single_ML.stderr.txt
	else
		echo "fasta file per_gene/EOG091G0KSQ/ALICUT_EOG091G0KSQ.clustalo.fasta contains fewer than 5 sequences - skipped" > ../../per_gene/EOG091G0KSQ/infer_single_ML.stdout.txt
		touch raxml.skipped
	fi
        touch ../../per_gene/EOG091G0KSQ/EOG091G0KSQ.raxml.done
        
[33mJob counts:
	count	jobs
	1	infer_single_ML
	1[0m
[33m
        cd per_gene/EOG091G0KSQ
	count=$(cat ../../per_gene/EOG091G0KSQ/ALICUT_EOG091G0KSQ.clustalo.fasta | grep ">" | wc -l)
	if [ "$count" -gt 5 ]
        then
		RAxMLmodel=$(cat ../../per_gene/EOG091G0KSQ/EOG091G0KSQ.best_model | grep "Best" | cut -d ":" -f 2 | tr -d '[:space:]')
                if [ "$(ls -1 | grep "^RAxML" | wc -l)" -ne 0 ]
		then
			rm RAxML*
		fi
        	raxml -f a -T 2 -m PROTGAMMA$RAxMLmodel         	-p 12345 -x 12345 -# 100         	-s ../../per_gene/EOG091G0KSQ/ALICUT_EOG091G0KSQ.clustalo.fasta -n EOG091G0KSQ.clustalo.aln.ALICUT.$RAxMLmodel 		1> ../../per_gene/EOG091G0KSQ/infer_single_ML.stdout.txt 2> ../../per_gene/EOG091G0KSQ/infer_single_ML.stderr.txt
	else
		echo "fasta file per_gene/EOG091G0KSQ/ALICUT_EOG091G0KSQ.clustalo.fasta contains fewer than 5 sequences - skipped" > ../../per_gene/EOG091G0KSQ/infer_single_ML.stdout.txt
		touch raxml.skipped
	fi
        touch ../../per_gene/EOG091G0KSQ/EOG091G0KSQ.raxml.done
        [0m
[Sun Jul  5 23:03:42 2020]
Finished job 26.
1681 of 3292 steps (51%) done

[Sun Jul  5 23:03:42 2020]
rule get_seqs:
    input: /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ingroup.txt, /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/outgroup.txt
    output: per_gene/EOG091G0FTU/EOG091G0FTU.ingroup.fasta
    log: per_gene/EOG091G0FTU/get_seqs.stdout.txt, per_gene/EOG091G0FTU/get_seqs.stderr.txt
    jobid: 2982
    wildcards: BUSCO=EOG091G0FTU
    threads: 2


	basedir=$(pwd)
        cd per_gene/EOG091G0FTU
        
        bash $basedir/../scripts/fetch_seqs.sh EOG091G0FTU /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ingroup.txt /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/outgroup.txt 1> ../../per_gene/EOG091G0FTU/get_seqs.stdout.txt 2> ../../per_gene/EOG091G0FTU/get_seqs.stderr.txt
	mv EOG091G0FTU.fasta $basedir/per_gene/EOG091G0FTU/EOG091G0FTU.ingroup.fasta
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/72476f9d9a5bd0627b4d721143a21354.simg
[Sun Jul  5 23:03:53 2020]
Finished job 2982.
1682 of 3292 steps (51%) done

[Sun Jul  5 23:03:53 2020]
rule get_outgroups:
    input: per_gene/EOG091G0FTU/EOG091G0FTU.ingroup.fasta
    output: per_gene/EOG091G0FTU/EOG091G0FTU.orthodb.fasta, per_gene/EOG091G0FTU/EOG091G0FTU.outgroup.fasta
    log: per_gene/EOG091G0FTU/get_outgroups.stdout.txt, per_gene/EOG091G0FTU/get_outgroups.stderr.txt
    jobid: 2983
    wildcards: BUSCO=EOG091G0FTU


        #download fastas from Orhtodb for BUSCO id
        for i in {1..5}
        do
             wget "http://www.orthodb.org/fasta?query=EOG091G0FTU&level=33208" -O per_gene/EOG091G0FTU/EOG091G0FTU.orthodb.fasta 1> per_gene/EOG091G0FTU/get_outgroups.stdout.txt 2> per_gene/EOG091G0FTU/get_outgroups.stderr.txt && break || echo -e "try again ($i)" && sleep 15
        done

	#This is quick an dirty for now and just takes the first protein if there is more than one for an outgroup taxon
        bash ../scripts/download_outgroups.sh taxids.txt per_gene/EOG091G0FTU/EOG091G0FTU.orthodb.fasta > per_gene/EOG091G0FTU/EOG091G0FTU.outgroup.fasta
        
[Sun Jul  5 23:03:54 2020]
Finished job 2983.
1683 of 3292 steps (51%) done

[Sun Jul  5 23:03:54 2020]
rule join_groups:
    input: per_gene/EOG091G0FTU/EOG091G0FTU.ingroup.fasta, per_gene/EOG091G0FTU/EOG091G0FTU.outgroup.fasta
    output: per_gene/EOG091G0FTU/EOG091G0FTU.fasta
    jobid: 2315
    wildcards: BUSCO=EOG091G0FTU


        cat per_gene/EOG091G0FTU/EOG091G0FTU.ingroup.fasta per_gene/EOG091G0FTU/EOG091G0FTU.outgroup.fasta > per_gene/EOG091G0FTU/EOG091G0FTU.fasta
        
[Sun Jul  5 23:03:55 2020]
Finished job 2315.
1684 of 3292 steps (51%) done

[Sun Jul  5 23:03:55 2020]
rule MSA:
    input: per_gene/EOG091G0FTU/EOG091G0FTU.fasta
    output: per_gene/EOG091G0FTU/EOG091G0FTU.clustalo.fasta
    log: per_gene/EOG091G0FTU/MSA.stdout.txt, per_gene/EOG091G0FTU/MSA.stderr.txt
    jobid: 1750
    wildcards: BUSCO=EOG091G0FTU
    threads: 2


        clustalo -i per_gene/EOG091G0FTU/EOG091G0FTU.fasta -o per_gene/EOG091G0FTU/EOG091G0FTU.clustalo.fasta --threads=2 1> per_gene/EOG091G0FTU/MSA.stdout.txt 2> per_gene/EOG091G0FTU/MSA.stderr.txt
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/d68c9691725a7401923680874285c430.simg
[Sun Jul  5 23:03:55 2020]
Finished job 1750.
1685 of 3292 steps (51%) done

[Sun Jul  5 23:03:55 2020]
rule score_and_cut:
    input: per_gene/EOG091G0FTU/EOG091G0FTU.clustalo.fasta
    output: per_gene/EOG091G0FTU/ALICUT_EOG091G0FTU.clustalo.fasta
    jobid: 927
    wildcards: BUSCO=EOG091G0FTU
    threads: 2


        cd per_gene/EOG091G0FTU
        Aliscore.pl -N -r 200000000000000000 -i ../../per_gene/EOG091G0FTU/EOG091G0FTU.clustalo.fasta &> aliscore.log
        ALICUT.pl -s &> alicut.log
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/63c88c27a0fa300f57066b0ef65fefcb.simg
[Sun Jul  5 23:04:05 2020]
Finished job 927.
1686 of 3292 steps (51%) done

[Sun Jul  5 23:04:05 2020]
rule remove_empty:
    input: per_gene/EOG091G0FTU/ALICUT_EOG091G0FTU.clustalo.fasta
    output: per_gene/EOG091G0FTU/empty_check.done
    jobid: 1749
    wildcards: BUSCO=EOG091G0FTU


         if [ "$(cat per_gene/EOG091G0FTU/ALICUT_EOG091G0FTU.clustalo.fasta | grep -v ">" | sed 's/-//g' | grep "^$" | wc -l)" -gt 0 ]
         then
              cp per_gene/EOG091G0FTU/ALICUT_EOG091G0FTU.clustalo.fasta per_gene/EOG091G0FTU/ALICUT_EOG091G0FTU.clustalo.fasta.backup
              bash ../scripts/remove_empty.sh per_gene/EOG091G0FTU/ALICUT_EOG091G0FTU.clustalo.fasta.backup > per_gene/EOG091G0FTU/ALICUT_EOG091G0FTU.clustalo.fasta
         fi
         touch per_gene/EOG091G0FTU/empty_check.done
         
[Sun Jul  5 23:04:05 2020]
Finished job 1749.
1687 of 3292 steps (51%) done

[Sun Jul  5 23:04:05 2020]
rule find_best_model:
    input: per_gene/EOG091G0FTU/ALICUT_EOG091G0FTU.clustalo.fasta, per_gene/EOG091G0FTU/empty_check.done
    output: per_gene/EOG091G0FTU/EOG091G0FTU.best_model
    log: per_gene/EOG091G0FTU/find_best_model.stderr.txt
    jobid: 926
    wildcards: BUSCO=EOG091G0FTU
    threads: 2


        cd per_gene/EOG091G0FTU
        if [ ! -d find_best_model ]
        then
            mkdir find_best_model
        fi
        cd find_best_model
        ln -s ../../../per_gene/EOG091G0FTU/ALICUT_EOG091G0FTU.clustalo.fasta EOG091G0FTU.fasta
        ProteinModelSelection.pl EOG091G0FTU.fasta 1> ../../../per_gene/EOG091G0FTU/EOG091G0FTU.best_model 2> ../../../per_gene/EOG091G0FTU/find_best_model.stderr.txt
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/c0c09ee657b1e27f2c5687e0e9aa8d70.simg
[Sun Jul  5 23:04:14 2020]
Finished job 84.
1688 of 3292 steps (51%) done

[Sun Jul  5 23:04:14 2020]
rule get_seqs:
    input: /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ingroup.txt, /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/outgroup.txt
    output: per_gene/EOG091G0AQA/EOG091G0AQA.ingroup.fasta
    log: per_gene/EOG091G0AQA/get_seqs.stdout.txt, per_gene/EOG091G0AQA/get_seqs.stderr.txt
    jobid: 2626
    wildcards: BUSCO=EOG091G0AQA
    threads: 2


	basedir=$(pwd)
        cd per_gene/EOG091G0AQA
        
        bash $basedir/../scripts/fetch_seqs.sh EOG091G0AQA /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ingroup.txt /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/outgroup.txt 1> ../../per_gene/EOG091G0AQA/get_seqs.stdout.txt 2> ../../per_gene/EOG091G0AQA/get_seqs.stderr.txt
	mv EOG091G0AQA.fasta $basedir/per_gene/EOG091G0AQA/EOG091G0AQA.ingroup.fasta
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/72476f9d9a5bd0627b4d721143a21354.simg
[Sun Jul  5 23:04:26 2020]
Finished job 2626.
1689 of 3292 steps (51%) done

[Sun Jul  5 23:04:26 2020]
rule get_outgroups:
    input: per_gene/EOG091G0AQA/EOG091G0AQA.ingroup.fasta
    output: per_gene/EOG091G0AQA/EOG091G0AQA.orthodb.fasta, per_gene/EOG091G0AQA/EOG091G0AQA.outgroup.fasta
    log: per_gene/EOG091G0AQA/get_outgroups.stdout.txt, per_gene/EOG091G0AQA/get_outgroups.stderr.txt
    jobid: 2627
    wildcards: BUSCO=EOG091G0AQA


        #download fastas from Orhtodb for BUSCO id
        for i in {1..5}
        do
             wget "http://www.orthodb.org/fasta?query=EOG091G0AQA&level=33208" -O per_gene/EOG091G0AQA/EOG091G0AQA.orthodb.fasta 1> per_gene/EOG091G0AQA/get_outgroups.stdout.txt 2> per_gene/EOG091G0AQA/get_outgroups.stderr.txt && break || echo -e "try again ($i)" && sleep 15
        done

	#This is quick an dirty for now and just takes the first protein if there is more than one for an outgroup taxon
        bash ../scripts/download_outgroups.sh taxids.txt per_gene/EOG091G0AQA/EOG091G0AQA.orthodb.fasta > per_gene/EOG091G0AQA/EOG091G0AQA.outgroup.fasta
        
[Sun Jul  5 23:04:27 2020]
Finished job 2627.
1690 of 3292 steps (51%) done

[Sun Jul  5 23:04:27 2020]
rule join_groups:
    input: per_gene/EOG091G0AQA/EOG091G0AQA.ingroup.fasta, per_gene/EOG091G0AQA/EOG091G0AQA.outgroup.fasta
    output: per_gene/EOG091G0AQA/EOG091G0AQA.fasta
    jobid: 2137
    wildcards: BUSCO=EOG091G0AQA


        cat per_gene/EOG091G0AQA/EOG091G0AQA.ingroup.fasta per_gene/EOG091G0AQA/EOG091G0AQA.outgroup.fasta > per_gene/EOG091G0AQA/EOG091G0AQA.fasta
        
[Sun Jul  5 23:04:27 2020]
Finished job 2137.
1691 of 3292 steps (51%) done

[Sun Jul  5 23:04:27 2020]
rule MSA:
    input: per_gene/EOG091G0AQA/EOG091G0AQA.fasta
    output: per_gene/EOG091G0AQA/EOG091G0AQA.clustalo.fasta
    log: per_gene/EOG091G0AQA/MSA.stdout.txt, per_gene/EOG091G0AQA/MSA.stderr.txt
    jobid: 1394
    wildcards: BUSCO=EOG091G0AQA
    threads: 2


        clustalo -i per_gene/EOG091G0AQA/EOG091G0AQA.fasta -o per_gene/EOG091G0AQA/EOG091G0AQA.clustalo.fasta --threads=2 1> per_gene/EOG091G0AQA/MSA.stdout.txt 2> per_gene/EOG091G0AQA/MSA.stderr.txt
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/d68c9691725a7401923680874285c430.simg
[Sun Jul  5 23:04:29 2020]
Finished job 1394.
1692 of 3292 steps (51%) done

[Sun Jul  5 23:04:29 2020]
rule score_and_cut:
    input: per_gene/EOG091G0AQA/EOG091G0AQA.clustalo.fasta
    output: per_gene/EOG091G0AQA/ALICUT_EOG091G0AQA.clustalo.fasta
    jobid: 571
    wildcards: BUSCO=EOG091G0AQA
    threads: 2


        cd per_gene/EOG091G0AQA
        Aliscore.pl -N -r 200000000000000000 -i ../../per_gene/EOG091G0AQA/EOG091G0AQA.clustalo.fasta &> aliscore.log
        ALICUT.pl -s &> alicut.log
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/63c88c27a0fa300f57066b0ef65fefcb.simg
[Sun Jul  5 23:04:33 2020]
Finished job 51.
1693 of 3292 steps (51%) done

[Sun Jul  5 23:04:33 2020]
rule get_seqs:
    input: /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ingroup.txt, /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/outgroup.txt
    output: per_gene/EOG091G01GC/EOG091G01GC.ingroup.fasta
    log: per_gene/EOG091G01GC/get_seqs.stdout.txt, per_gene/EOG091G01GC/get_seqs.stderr.txt
    jobid: 3108
    wildcards: BUSCO=EOG091G01GC
    threads: 2


	basedir=$(pwd)
        cd per_gene/EOG091G01GC
        
        bash $basedir/../scripts/fetch_seqs.sh EOG091G01GC /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ingroup.txt /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/outgroup.txt 1> ../../per_gene/EOG091G01GC/get_seqs.stdout.txt 2> ../../per_gene/EOG091G01GC/get_seqs.stderr.txt
	mv EOG091G01GC.fasta $basedir/per_gene/EOG091G01GC/EOG091G01GC.ingroup.fasta
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/72476f9d9a5bd0627b4d721143a21354.simg
[Sun Jul  5 23:04:37 2020]
Finished job 926.
1694 of 3292 steps (51%) done

[Sun Jul  5 23:04:37 2020]
rule infer_single_ML:
    input: per_gene/EOG091G0FTU/EOG091G0FTU.best_model, per_gene/EOG091G0FTU/ALICUT_EOG091G0FTU.clustalo.fasta
    output: per_gene/EOG091G0FTU/EOG091G0FTU.raxml.done
    log: per_gene/EOG091G0FTU/infer_single_ML.stdout.txt, per_gene/EOG091G0FTU/infer_single_ML.stderr.txt
    jobid: 257
    wildcards: BUSCO=EOG091G0FTU
    threads: 2


        cd per_gene/EOG091G0FTU
	count=$(cat ../../per_gene/EOG091G0FTU/ALICUT_EOG091G0FTU.clustalo.fasta | grep ">" | wc -l)
	if [ "$count" -gt 5 ]
        then
		RAxMLmodel=$(cat ../../per_gene/EOG091G0FTU/EOG091G0FTU.best_model | grep "Best" | cut -d ":" -f 2 | tr -d '[:space:]')
                if [ "$(ls -1 | grep "^RAxML" | wc -l)" -ne 0 ]
		then
			rm RAxML*
		fi
        	raxml -f a -T 2 -m PROTGAMMA$RAxMLmodel         	-p 12345 -x 12345 -# 100         	-s ../../per_gene/EOG091G0FTU/ALICUT_EOG091G0FTU.clustalo.fasta -n EOG091G0FTU.clustalo.aln.ALICUT.$RAxMLmodel 		1> ../../per_gene/EOG091G0FTU/infer_single_ML.stdout.txt 2> ../../per_gene/EOG091G0FTU/infer_single_ML.stderr.txt
	else
		echo "fasta file per_gene/EOG091G0FTU/ALICUT_EOG091G0FTU.clustalo.fasta contains fewer than 5 sequences - skipped" > ../../per_gene/EOG091G0FTU/infer_single_ML.stdout.txt
		touch raxml.skipped
	fi
        touch ../../per_gene/EOG091G0FTU/EOG091G0FTU.raxml.done
        
[Sun Jul  5 23:04:40 2020]
Finished job 571.
1695 of 3292 steps (51%) done

[Sun Jul  5 23:04:40 2020]
rule remove_empty:
    input: per_gene/EOG091G0AQA/ALICUT_EOG091G0AQA.clustalo.fasta
    output: per_gene/EOG091G0AQA/empty_check.done
    jobid: 1393
    wildcards: BUSCO=EOG091G0AQA


         if [ "$(cat per_gene/EOG091G0AQA/ALICUT_EOG091G0AQA.clustalo.fasta | grep -v ">" | sed 's/-//g' | grep "^$" | wc -l)" -gt 0 ]
         then
              cp per_gene/EOG091G0AQA/ALICUT_EOG091G0AQA.clustalo.fasta per_gene/EOG091G0AQA/ALICUT_EOG091G0AQA.clustalo.fasta.backup
              bash ../scripts/remove_empty.sh per_gene/EOG091G0AQA/ALICUT_EOG091G0AQA.clustalo.fasta.backup > per_gene/EOG091G0AQA/ALICUT_EOG091G0AQA.clustalo.fasta
         fi
         touch per_gene/EOG091G0AQA/empty_check.done
         
[Sun Jul  5 23:04:40 2020]
Finished job 1393.
1696 of 3292 steps (52%) done

[Sun Jul  5 23:04:40 2020]
rule find_best_model:
    input: per_gene/EOG091G0AQA/ALICUT_EOG091G0AQA.clustalo.fasta, per_gene/EOG091G0AQA/empty_check.done
    output: per_gene/EOG091G0AQA/EOG091G0AQA.best_model
    log: per_gene/EOG091G0AQA/find_best_model.stderr.txt
    jobid: 570
    wildcards: BUSCO=EOG091G0AQA
    threads: 2


        cd per_gene/EOG091G0AQA
        if [ ! -d find_best_model ]
        then
            mkdir find_best_model
        fi
        cd find_best_model
        ln -s ../../../per_gene/EOG091G0AQA/ALICUT_EOG091G0AQA.clustalo.fasta EOG091G0AQA.fasta
        ProteinModelSelection.pl EOG091G0AQA.fasta 1> ../../../per_gene/EOG091G0AQA/EOG091G0AQA.best_model 2> ../../../per_gene/EOG091G0AQA/find_best_model.stderr.txt
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/c0c09ee657b1e27f2c5687e0e9aa8d70.simg
[Sun Jul  5 23:04:46 2020]
Finished job 3108.
1697 of 3292 steps (52%) done

[Sun Jul  5 23:04:46 2020]
rule get_outgroups:
    input: per_gene/EOG091G01GC/EOG091G01GC.ingroup.fasta
    output: per_gene/EOG091G01GC/EOG091G01GC.orthodb.fasta, per_gene/EOG091G01GC/EOG091G01GC.outgroup.fasta
    log: per_gene/EOG091G01GC/get_outgroups.stdout.txt, per_gene/EOG091G01GC/get_outgroups.stderr.txt
    jobid: 3109
    wildcards: BUSCO=EOG091G01GC


        #download fastas from Orhtodb for BUSCO id
        for i in {1..5}
        do
             wget "http://www.orthodb.org/fasta?query=EOG091G01GC&level=33208" -O per_gene/EOG091G01GC/EOG091G01GC.orthodb.fasta 1> per_gene/EOG091G01GC/get_outgroups.stdout.txt 2> per_gene/EOG091G01GC/get_outgroups.stderr.txt && break || echo -e "try again ($i)" && sleep 15
        done

	#This is quick an dirty for now and just takes the first protein if there is more than one for an outgroup taxon
        bash ../scripts/download_outgroups.sh taxids.txt per_gene/EOG091G01GC/EOG091G01GC.orthodb.fasta > per_gene/EOG091G01GC/EOG091G01GC.outgroup.fasta
        
[Sun Jul  5 23:04:47 2020]
Finished job 3109.
1698 of 3292 steps (52%) done

[Sun Jul  5 23:04:47 2020]
rule join_groups:
    input: per_gene/EOG091G01GC/EOG091G01GC.ingroup.fasta, per_gene/EOG091G01GC/EOG091G01GC.outgroup.fasta
    output: per_gene/EOG091G01GC/EOG091G01GC.fasta
    jobid: 2378
    wildcards: BUSCO=EOG091G01GC


        cat per_gene/EOG091G01GC/EOG091G01GC.ingroup.fasta per_gene/EOG091G01GC/EOG091G01GC.outgroup.fasta > per_gene/EOG091G01GC/EOG091G01GC.fasta
        
[Sun Jul  5 23:04:47 2020]
Finished job 2378.
1699 of 3292 steps (52%) done

[Sun Jul  5 23:04:47 2020]
rule MSA:
    input: per_gene/EOG091G01GC/EOG091G01GC.fasta
    output: per_gene/EOG091G01GC/EOG091G01GC.clustalo.fasta
    log: per_gene/EOG091G01GC/MSA.stdout.txt, per_gene/EOG091G01GC/MSA.stderr.txt
    jobid: 1876
    wildcards: BUSCO=EOG091G01GC
    threads: 2


        clustalo -i per_gene/EOG091G01GC/EOG091G01GC.fasta -o per_gene/EOG091G01GC/EOG091G01GC.clustalo.fasta --threads=2 1> per_gene/EOG091G01GC/MSA.stdout.txt 2> per_gene/EOG091G01GC/MSA.stderr.txt
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/d68c9691725a7401923680874285c430.simg
[Sun Jul  5 23:04:51 2020]
Finished job 1876.
1700 of 3292 steps (52%) done

[Sun Jul  5 23:04:51 2020]
rule score_and_cut:
    input: per_gene/EOG091G01GC/EOG091G01GC.clustalo.fasta
    output: per_gene/EOG091G01GC/ALICUT_EOG091G01GC.clustalo.fasta
    jobid: 1053
    wildcards: BUSCO=EOG091G01GC
    threads: 2


        cd per_gene/EOG091G01GC
        Aliscore.pl -N -r 200000000000000000 -i ../../per_gene/EOG091G01GC/EOG091G01GC.clustalo.fasta &> aliscore.log
        ALICUT.pl -s &> alicut.log
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/63c88c27a0fa300f57066b0ef65fefcb.simg
[33mJob counts:
	count	jobs
	1	infer_single_ML
	1[0m
[33m
        cd per_gene/EOG091G0FTU
	count=$(cat ../../per_gene/EOG091G0FTU/ALICUT_EOG091G0FTU.clustalo.fasta | grep ">" | wc -l)
	if [ "$count" -gt 5 ]
        then
		RAxMLmodel=$(cat ../../per_gene/EOG091G0FTU/EOG091G0FTU.best_model | grep "Best" | cut -d ":" -f 2 | tr -d '[:space:]')
                if [ "$(ls -1 | grep "^RAxML" | wc -l)" -ne 0 ]
		then
			rm RAxML*
		fi
        	raxml -f a -T 2 -m PROTGAMMA$RAxMLmodel         	-p 12345 -x 12345 -# 100         	-s ../../per_gene/EOG091G0FTU/ALICUT_EOG091G0FTU.clustalo.fasta -n EOG091G0FTU.clustalo.aln.ALICUT.$RAxMLmodel 		1> ../../per_gene/EOG091G0FTU/infer_single_ML.stdout.txt 2> ../../per_gene/EOG091G0FTU/infer_single_ML.stderr.txt
	else
		echo "fasta file per_gene/EOG091G0FTU/ALICUT_EOG091G0FTU.clustalo.fasta contains fewer than 5 sequences - skipped" > ../../per_gene/EOG091G0FTU/infer_single_ML.stdout.txt
		touch raxml.skipped
	fi
        touch ../../per_gene/EOG091G0FTU/EOG091G0FTU.raxml.done
        [0m
[Sun Jul  5 23:05:02 2020]
Finished job 1053.
1701 of 3292 steps (52%) done

[Sun Jul  5 23:05:02 2020]
rule remove_empty:
    input: per_gene/EOG091G01GC/ALICUT_EOG091G01GC.clustalo.fasta
    output: per_gene/EOG091G01GC/empty_check.done
    jobid: 1875
    wildcards: BUSCO=EOG091G01GC


         if [ "$(cat per_gene/EOG091G01GC/ALICUT_EOG091G01GC.clustalo.fasta | grep -v ">" | sed 's/-//g' | grep "^$" | wc -l)" -gt 0 ]
         then
              cp per_gene/EOG091G01GC/ALICUT_EOG091G01GC.clustalo.fasta per_gene/EOG091G01GC/ALICUT_EOG091G01GC.clustalo.fasta.backup
              bash ../scripts/remove_empty.sh per_gene/EOG091G01GC/ALICUT_EOG091G01GC.clustalo.fasta.backup > per_gene/EOG091G01GC/ALICUT_EOG091G01GC.clustalo.fasta
         fi
         touch per_gene/EOG091G01GC/empty_check.done
         
[Sun Jul  5 23:05:02 2020]
Finished job 1875.
1702 of 3292 steps (52%) done

[Sun Jul  5 23:05:02 2020]
rule find_best_model:
    input: per_gene/EOG091G01GC/ALICUT_EOG091G01GC.clustalo.fasta, per_gene/EOG091G01GC/empty_check.done
    output: per_gene/EOG091G01GC/EOG091G01GC.best_model
    log: per_gene/EOG091G01GC/find_best_model.stderr.txt
    jobid: 1052
    wildcards: BUSCO=EOG091G01GC
    threads: 2


        cd per_gene/EOG091G01GC
        if [ ! -d find_best_model ]
        then
            mkdir find_best_model
        fi
        cd find_best_model
        ln -s ../../../per_gene/EOG091G01GC/ALICUT_EOG091G01GC.clustalo.fasta EOG091G01GC.fasta
        ProteinModelSelection.pl EOG091G01GC.fasta 1> ../../../per_gene/EOG091G01GC/EOG091G01GC.best_model 2> ../../../per_gene/EOG091G01GC/find_best_model.stderr.txt
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/c0c09ee657b1e27f2c5687e0e9aa8d70.simg
[Sun Jul  5 23:05:02 2020]
Finished job 397.
1703 of 3292 steps (52%) done

[Sun Jul  5 23:05:02 2020]
rule get_seqs:
    input: /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ingroup.txt, /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/outgroup.txt
    output: per_gene/EOG091G0IQ7/EOG091G0IQ7.ingroup.fasta
    log: per_gene/EOG091G0IQ7/get_seqs.stdout.txt, per_gene/EOG091G0IQ7/get_seqs.stderr.txt
    jobid: 2716
    wildcards: BUSCO=EOG091G0IQ7
    threads: 2


	basedir=$(pwd)
        cd per_gene/EOG091G0IQ7
        
        bash $basedir/../scripts/fetch_seqs.sh EOG091G0IQ7 /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ingroup.txt /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/outgroup.txt 1> ../../per_gene/EOG091G0IQ7/get_seqs.stdout.txt 2> ../../per_gene/EOG091G0IQ7/get_seqs.stderr.txt
	mv EOG091G0IQ7.fasta $basedir/per_gene/EOG091G0IQ7/EOG091G0IQ7.ingroup.fasta
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/72476f9d9a5bd0627b4d721143a21354.simg
[Sun Jul  5 23:05:03 2020]
Finished job 121.
1704 of 3292 steps (52%) done

[Sun Jul  5 23:05:03 2020]
rule get_seqs:
    input: /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ingroup.txt, /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/outgroup.txt
    output: per_gene/EOG091G0CEK/EOG091G0CEK.ingroup.fasta
    log: per_gene/EOG091G0CEK/get_seqs.stdout.txt, per_gene/EOG091G0CEK/get_seqs.stderr.txt
    jobid: 3182
    wildcards: BUSCO=EOG091G0CEK
    threads: 2


	basedir=$(pwd)
        cd per_gene/EOG091G0CEK
        
        bash $basedir/../scripts/fetch_seqs.sh EOG091G0CEK /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ingroup.txt /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/outgroup.txt 1> ../../per_gene/EOG091G0CEK/get_seqs.stdout.txt 2> ../../per_gene/EOG091G0CEK/get_seqs.stderr.txt
	mv EOG091G0CEK.fasta $basedir/per_gene/EOG091G0CEK/EOG091G0CEK.ingroup.fasta
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/72476f9d9a5bd0627b4d721143a21354.simg
[Sun Jul  5 23:05:08 2020]
Finished job 570.
1705 of 3292 steps (52%) done

[Sun Jul  5 23:05:08 2020]
rule infer_single_ML:
    input: per_gene/EOG091G0AQA/EOG091G0AQA.best_model, per_gene/EOG091G0AQA/ALICUT_EOG091G0AQA.clustalo.fasta
    output: per_gene/EOG091G0AQA/EOG091G0AQA.raxml.done
    log: per_gene/EOG091G0AQA/infer_single_ML.stdout.txt, per_gene/EOG091G0AQA/infer_single_ML.stderr.txt
    jobid: 79
    wildcards: BUSCO=EOG091G0AQA
    threads: 2


        cd per_gene/EOG091G0AQA
	count=$(cat ../../per_gene/EOG091G0AQA/ALICUT_EOG091G0AQA.clustalo.fasta | grep ">" | wc -l)
	if [ "$count" -gt 5 ]
        then
		RAxMLmodel=$(cat ../../per_gene/EOG091G0AQA/EOG091G0AQA.best_model | grep "Best" | cut -d ":" -f 2 | tr -d '[:space:]')
                if [ "$(ls -1 | grep "^RAxML" | wc -l)" -ne 0 ]
		then
			rm RAxML*
		fi
        	raxml -f a -T 2 -m PROTGAMMA$RAxMLmodel         	-p 12345 -x 12345 -# 100         	-s ../../per_gene/EOG091G0AQA/ALICUT_EOG091G0AQA.clustalo.fasta -n EOG091G0AQA.clustalo.aln.ALICUT.$RAxMLmodel 		1> ../../per_gene/EOG091G0AQA/infer_single_ML.stdout.txt 2> ../../per_gene/EOG091G0AQA/infer_single_ML.stderr.txt
	else
		echo "fasta file per_gene/EOG091G0AQA/ALICUT_EOG091G0AQA.clustalo.fasta contains fewer than 5 sequences - skipped" > ../../per_gene/EOG091G0AQA/infer_single_ML.stdout.txt
		touch raxml.skipped
	fi
        touch ../../per_gene/EOG091G0AQA/EOG091G0AQA.raxml.done
        
[Sun Jul  5 23:05:08 2020]
Finished job 326.
1706 of 3292 steps (52%) done

[Sun Jul  5 23:05:09 2020]
rule get_seqs:
    input: /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ingroup.txt, /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/outgroup.txt
    output: per_gene/EOG091G0QIP/EOG091G0QIP.ingroup.fasta
    log: per_gene/EOG091G0QIP/get_seqs.stdout.txt, per_gene/EOG091G0QIP/get_seqs.stderr.txt
    jobid: 2812
    wildcards: BUSCO=EOG091G0QIP
    threads: 2


	basedir=$(pwd)
        cd per_gene/EOG091G0QIP
        
        bash $basedir/../scripts/fetch_seqs.sh EOG091G0QIP /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ingroup.txt /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/outgroup.txt 1> ../../per_gene/EOG091G0QIP/get_seqs.stdout.txt 2> ../../per_gene/EOG091G0QIP/get_seqs.stderr.txt
	mv EOG091G0QIP.fasta $basedir/per_gene/EOG091G0QIP/EOG091G0QIP.ingroup.fasta
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/72476f9d9a5bd0627b4d721143a21354.simg
[33mJob counts:
	count	jobs
	1	infer_single_ML
	1[0m
[33m
        cd per_gene/EOG091G0AQA
	count=$(cat ../../per_gene/EOG091G0AQA/ALICUT_EOG091G0AQA.clustalo.fasta | grep ">" | wc -l)
	if [ "$count" -gt 5 ]
        then
		RAxMLmodel=$(cat ../../per_gene/EOG091G0AQA/EOG091G0AQA.best_model | grep "Best" | cut -d ":" -f 2 | tr -d '[:space:]')
                if [ "$(ls -1 | grep "^RAxML" | wc -l)" -ne 0 ]
		then
			rm RAxML*
		fi
        	raxml -f a -T 2 -m PROTGAMMA$RAxMLmodel         	-p 12345 -x 12345 -# 100         	-s ../../per_gene/EOG091G0AQA/ALICUT_EOG091G0AQA.clustalo.fasta -n EOG091G0AQA.clustalo.aln.ALICUT.$RAxMLmodel 		1> ../../per_gene/EOG091G0AQA/infer_single_ML.stdout.txt 2> ../../per_gene/EOG091G0AQA/infer_single_ML.stderr.txt
	else
		echo "fasta file per_gene/EOG091G0AQA/ALICUT_EOG091G0AQA.clustalo.fasta contains fewer than 5 sequences - skipped" > ../../per_gene/EOG091G0AQA/infer_single_ML.stdout.txt
		touch raxml.skipped
	fi
        touch ../../per_gene/EOG091G0AQA/EOG091G0AQA.raxml.done
        [0m
[Sun Jul  5 23:05:14 2020]
Finished job 3182.
1707 of 3292 steps (52%) done

[Sun Jul  5 23:05:14 2020]
rule get_outgroups:
    input: per_gene/EOG091G0CEK/EOG091G0CEK.ingroup.fasta
    output: per_gene/EOG091G0CEK/EOG091G0CEK.orthodb.fasta, per_gene/EOG091G0CEK/EOG091G0CEK.outgroup.fasta
    log: per_gene/EOG091G0CEK/get_outgroups.stdout.txt, per_gene/EOG091G0CEK/get_outgroups.stderr.txt
    jobid: 3183
    wildcards: BUSCO=EOG091G0CEK


        #download fastas from Orhtodb for BUSCO id
        for i in {1..5}
        do
             wget "http://www.orthodb.org/fasta?query=EOG091G0CEK&level=33208" -O per_gene/EOG091G0CEK/EOG091G0CEK.orthodb.fasta 1> per_gene/EOG091G0CEK/get_outgroups.stdout.txt 2> per_gene/EOG091G0CEK/get_outgroups.stderr.txt && break || echo -e "try again ($i)" && sleep 15
        done

	#This is quick an dirty for now and just takes the first protein if there is more than one for an outgroup taxon
        bash ../scripts/download_outgroups.sh taxids.txt per_gene/EOG091G0CEK/EOG091G0CEK.orthodb.fasta > per_gene/EOG091G0CEK/EOG091G0CEK.outgroup.fasta
        
[Sun Jul  5 23:05:14 2020]
Finished job 2716.
1708 of 3292 steps (52%) done

[Sun Jul  5 23:05:14 2020]
rule get_seqs:
    input: /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ingroup.txt, /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/outgroup.txt
    output: per_gene/EOG091G1A1V/EOG091G1A1V.ingroup.fasta
    log: per_gene/EOG091G1A1V/get_seqs.stdout.txt, per_gene/EOG091G1A1V/get_seqs.stderr.txt
    jobid: 2942
    wildcards: BUSCO=EOG091G1A1V
    threads: 2


	basedir=$(pwd)
        cd per_gene/EOG091G1A1V
        
        bash $basedir/../scripts/fetch_seqs.sh EOG091G1A1V /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ingroup.txt /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/outgroup.txt 1> ../../per_gene/EOG091G1A1V/get_seqs.stdout.txt 2> ../../per_gene/EOG091G1A1V/get_seqs.stderr.txt
	mv EOG091G1A1V.fasta $basedir/per_gene/EOG091G1A1V/EOG091G1A1V.ingroup.fasta
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/72476f9d9a5bd0627b4d721143a21354.simg

[Sun Jul  5 23:05:14 2020]
rule get_outgroups:
    input: per_gene/EOG091G0IQ7/EOG091G0IQ7.ingroup.fasta
    output: per_gene/EOG091G0IQ7/EOG091G0IQ7.orthodb.fasta, per_gene/EOG091G0IQ7/EOG091G0IQ7.outgroup.fasta
    log: per_gene/EOG091G0IQ7/get_outgroups.stdout.txt, per_gene/EOG091G0IQ7/get_outgroups.stderr.txt
    jobid: 2717
    wildcards: BUSCO=EOG091G0IQ7


        #download fastas from Orhtodb for BUSCO id
        for i in {1..5}
        do
             wget "http://www.orthodb.org/fasta?query=EOG091G0IQ7&level=33208" -O per_gene/EOG091G0IQ7/EOG091G0IQ7.orthodb.fasta 1> per_gene/EOG091G0IQ7/get_outgroups.stdout.txt 2> per_gene/EOG091G0IQ7/get_outgroups.stderr.txt && break || echo -e "try again ($i)" && sleep 15
        done

	#This is quick an dirty for now and just takes the first protein if there is more than one for an outgroup taxon
        bash ../scripts/download_outgroups.sh taxids.txt per_gene/EOG091G0IQ7/EOG091G0IQ7.orthodb.fasta > per_gene/EOG091G0IQ7/EOG091G0IQ7.outgroup.fasta
        
[Sun Jul  5 23:05:15 2020]
Finished job 214.
1709 of 3292 steps (52%) done

[Sun Jul  5 23:05:15 2020]
rule get_seqs:
    input: /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ingroup.txt, /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/outgroup.txt
    output: per_gene/EOG091G1BQN/EOG091G1BQN.ingroup.fasta
    log: per_gene/EOG091G1BQN/get_seqs.stdout.txt, per_gene/EOG091G1BQN/get_seqs.stderr.txt
    jobid: 3264
    wildcards: BUSCO=EOG091G1BQN
    threads: 2


	basedir=$(pwd)
        cd per_gene/EOG091G1BQN
        
        bash $basedir/../scripts/fetch_seqs.sh EOG091G1BQN /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ingroup.txt /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/outgroup.txt 1> ../../per_gene/EOG091G1BQN/get_seqs.stdout.txt 2> ../../per_gene/EOG091G1BQN/get_seqs.stderr.txt
	mv EOG091G1BQN.fasta $basedir/per_gene/EOG091G1BQN/EOG091G1BQN.ingroup.fasta
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/72476f9d9a5bd0627b4d721143a21354.simg
[Sun Jul  5 23:05:16 2020]
Finished job 2717.
1710 of 3292 steps (52%) done

[Sun Jul  5 23:05:16 2020]
rule join_groups:
    input: per_gene/EOG091G0IQ7/EOG091G0IQ7.ingroup.fasta, per_gene/EOG091G0IQ7/EOG091G0IQ7.outgroup.fasta
    output: per_gene/EOG091G0IQ7/EOG091G0IQ7.fasta
    jobid: 2182
    wildcards: BUSCO=EOG091G0IQ7


        cat per_gene/EOG091G0IQ7/EOG091G0IQ7.ingroup.fasta per_gene/EOG091G0IQ7/EOG091G0IQ7.outgroup.fasta > per_gene/EOG091G0IQ7/EOG091G0IQ7.fasta
        
[Sun Jul  5 23:05:16 2020]
Finished job 2182.
1711 of 3292 steps (52%) done
[Sun Jul  5 23:05:18 2020]
Finished job 3183.
1712 of 3292 steps (52%) done

[Sun Jul  5 23:05:18 2020]
rule join_groups:
    input: per_gene/EOG091G0CEK/EOG091G0CEK.ingroup.fasta, per_gene/EOG091G0CEK/EOG091G0CEK.outgroup.fasta
    output: per_gene/EOG091G0CEK/EOG091G0CEK.fasta
    jobid: 2415
    wildcards: BUSCO=EOG091G0CEK


        cat per_gene/EOG091G0CEK/EOG091G0CEK.ingroup.fasta per_gene/EOG091G0CEK/EOG091G0CEK.outgroup.fasta > per_gene/EOG091G0CEK/EOG091G0CEK.fasta
        
[Sun Jul  5 23:05:18 2020]
Finished job 2415.
1713 of 3292 steps (52%) done

[Sun Jul  5 23:05:18 2020]
rule MSA:
    input: per_gene/EOG091G0CEK/EOG091G0CEK.fasta
    output: per_gene/EOG091G0CEK/EOG091G0CEK.clustalo.fasta
    log: per_gene/EOG091G0CEK/MSA.stdout.txt, per_gene/EOG091G0CEK/MSA.stderr.txt
    jobid: 1950
    wildcards: BUSCO=EOG091G0CEK
    threads: 2


        clustalo -i per_gene/EOG091G0CEK/EOG091G0CEK.fasta -o per_gene/EOG091G0CEK/EOG091G0CEK.clustalo.fasta --threads=2 1> per_gene/EOG091G0CEK/MSA.stdout.txt 2> per_gene/EOG091G0CEK/MSA.stderr.txt
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/d68c9691725a7401923680874285c430.simg
[Sun Jul  5 23:05:19 2020]
Finished job 1950.
1714 of 3292 steps (52%) done

[Sun Jul  5 23:05:19 2020]
rule score_and_cut:
    input: per_gene/EOG091G0CEK/EOG091G0CEK.clustalo.fasta
    output: per_gene/EOG091G0CEK/ALICUT_EOG091G0CEK.clustalo.fasta
    jobid: 1127
    wildcards: BUSCO=EOG091G0CEK
    threads: 2


        cd per_gene/EOG091G0CEK
        Aliscore.pl -N -r 200000000000000000 -i ../../per_gene/EOG091G0CEK/EOG091G0CEK.clustalo.fasta &> aliscore.log
        ALICUT.pl -s &> alicut.log
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/63c88c27a0fa300f57066b0ef65fefcb.simg
[Sun Jul  5 23:05:19 2020]
Finished job 2812.
1715 of 3292 steps (52%) done

[Sun Jul  5 23:05:19 2020]
rule MSA:
    input: per_gene/EOG091G0IQ7/EOG091G0IQ7.fasta
    output: per_gene/EOG091G0IQ7/EOG091G0IQ7.clustalo.fasta
    log: per_gene/EOG091G0IQ7/MSA.stdout.txt, per_gene/EOG091G0IQ7/MSA.stderr.txt
    jobid: 1484
    wildcards: BUSCO=EOG091G0IQ7
    threads: 2


        clustalo -i per_gene/EOG091G0IQ7/EOG091G0IQ7.fasta -o per_gene/EOG091G0IQ7/EOG091G0IQ7.clustalo.fasta --threads=2 1> per_gene/EOG091G0IQ7/MSA.stdout.txt 2> per_gene/EOG091G0IQ7/MSA.stderr.txt
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/d68c9691725a7401923680874285c430.simg
[Sun Jul  5 23:05:21 2020]
Finished job 1484.
1716 of 3292 steps (52%) done

[Sun Jul  5 23:05:21 2020]
rule score_and_cut:
    input: per_gene/EOG091G0IQ7/EOG091G0IQ7.clustalo.fasta
    output: per_gene/EOG091G0IQ7/ALICUT_EOG091G0IQ7.clustalo.fasta
    jobid: 661
    wildcards: BUSCO=EOG091G0IQ7
    threads: 2


        cd per_gene/EOG091G0IQ7
        Aliscore.pl -N -r 200000000000000000 -i ../../per_gene/EOG091G0IQ7/EOG091G0IQ7.clustalo.fasta &> aliscore.log
        ALICUT.pl -s &> alicut.log
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/63c88c27a0fa300f57066b0ef65fefcb.simg
[Sun Jul  5 23:05:26 2020]
Finished job 3264.
1717 of 3292 steps (52%) done

[Sun Jul  5 23:05:26 2020]
rule get_outgroups:
    input: per_gene/EOG091G0QIP/EOG091G0QIP.ingroup.fasta
    output: per_gene/EOG091G0QIP/EOG091G0QIP.orthodb.fasta, per_gene/EOG091G0QIP/EOG091G0QIP.outgroup.fasta
    log: per_gene/EOG091G0QIP/get_outgroups.stdout.txt, per_gene/EOG091G0QIP/get_outgroups.stderr.txt
    jobid: 2813
    wildcards: BUSCO=EOG091G0QIP


        #download fastas from Orhtodb for BUSCO id
        for i in {1..5}
        do
             wget "http://www.orthodb.org/fasta?query=EOG091G0QIP&level=33208" -O per_gene/EOG091G0QIP/EOG091G0QIP.orthodb.fasta 1> per_gene/EOG091G0QIP/get_outgroups.stdout.txt 2> per_gene/EOG091G0QIP/get_outgroups.stderr.txt && break || echo -e "try again ($i)" && sleep 15
        done

	#This is quick an dirty for now and just takes the first protein if there is more than one for an outgroup taxon
        bash ../scripts/download_outgroups.sh taxids.txt per_gene/EOG091G0QIP/EOG091G0QIP.orthodb.fasta > per_gene/EOG091G0QIP/EOG091G0QIP.outgroup.fasta
        

[Sun Jul  5 23:05:26 2020]
rule get_outgroups:
    input: per_gene/EOG091G1BQN/EOG091G1BQN.ingroup.fasta
    output: per_gene/EOG091G1BQN/EOG091G1BQN.orthodb.fasta, per_gene/EOG091G1BQN/EOG091G1BQN.outgroup.fasta
    log: per_gene/EOG091G1BQN/get_outgroups.stdout.txt, per_gene/EOG091G1BQN/get_outgroups.stderr.txt
    jobid: 3265
    wildcards: BUSCO=EOG091G1BQN


        #download fastas from Orhtodb for BUSCO id
        for i in {1..5}
        do
             wget "http://www.orthodb.org/fasta?query=EOG091G1BQN&level=33208" -O per_gene/EOG091G1BQN/EOG091G1BQN.orthodb.fasta 1> per_gene/EOG091G1BQN/get_outgroups.stdout.txt 2> per_gene/EOG091G1BQN/get_outgroups.stderr.txt && break || echo -e "try again ($i)" && sleep 15
        done

	#This is quick an dirty for now and just takes the first protein if there is more than one for an outgroup taxon
        bash ../scripts/download_outgroups.sh taxids.txt per_gene/EOG091G1BQN/EOG091G1BQN.orthodb.fasta > per_gene/EOG091G1BQN/EOG091G1BQN.outgroup.fasta
        
[Sun Jul  5 23:05:27 2020]
Finished job 2942.
1718 of 3292 steps (52%) done

[Sun Jul  5 23:05:27 2020]
rule get_outgroups:
    input: per_gene/EOG091G1A1V/EOG091G1A1V.ingroup.fasta
    output: per_gene/EOG091G1A1V/EOG091G1A1V.orthodb.fasta, per_gene/EOG091G1A1V/EOG091G1A1V.outgroup.fasta
    log: per_gene/EOG091G1A1V/get_outgroups.stdout.txt, per_gene/EOG091G1A1V/get_outgroups.stderr.txt
    jobid: 2943
    wildcards: BUSCO=EOG091G1A1V


        #download fastas from Orhtodb for BUSCO id
        for i in {1..5}
        do
             wget "http://www.orthodb.org/fasta?query=EOG091G1A1V&level=33208" -O per_gene/EOG091G1A1V/EOG091G1A1V.orthodb.fasta 1> per_gene/EOG091G1A1V/get_outgroups.stdout.txt 2> per_gene/EOG091G1A1V/get_outgroups.stderr.txt && break || echo -e "try again ($i)" && sleep 15
        done

	#This is quick an dirty for now and just takes the first protein if there is more than one for an outgroup taxon
        bash ../scripts/download_outgroups.sh taxids.txt per_gene/EOG091G1A1V/EOG091G1A1V.orthodb.fasta > per_gene/EOG091G1A1V/EOG091G1A1V.outgroup.fasta
        
[Sun Jul  5 23:05:27 2020]
Finished job 2813.
1719 of 3292 steps (52%) done

[Sun Jul  5 23:05:27 2020]
rule join_groups:
    input: per_gene/EOG091G0QIP/EOG091G0QIP.ingroup.fasta, per_gene/EOG091G0QIP/EOG091G0QIP.outgroup.fasta
    output: per_gene/EOG091G0QIP/EOG091G0QIP.fasta
    jobid: 2230
    wildcards: BUSCO=EOG091G0QIP


        cat per_gene/EOG091G0QIP/EOG091G0QIP.ingroup.fasta per_gene/EOG091G0QIP/EOG091G0QIP.outgroup.fasta > per_gene/EOG091G0QIP/EOG091G0QIP.fasta
        
[Sun Jul  5 23:05:27 2020]
Finished job 2230.
1720 of 3292 steps (52%) done

[Sun Jul  5 23:05:27 2020]
rule MSA:
    input: per_gene/EOG091G0QIP/EOG091G0QIP.fasta
    output: per_gene/EOG091G0QIP/EOG091G0QIP.clustalo.fasta
    log: per_gene/EOG091G0QIP/MSA.stdout.txt, per_gene/EOG091G0QIP/MSA.stderr.txt
    jobid: 1580
    wildcards: BUSCO=EOG091G0QIP
    threads: 2


        clustalo -i per_gene/EOG091G0QIP/EOG091G0QIP.fasta -o per_gene/EOG091G0QIP/EOG091G0QIP.clustalo.fasta --threads=2 1> per_gene/EOG091G0QIP/MSA.stdout.txt 2> per_gene/EOG091G0QIP/MSA.stderr.txt
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/d68c9691725a7401923680874285c430.simg
[Sun Jul  5 23:05:27 2020]
Finished job 1580.
1721 of 3292 steps (52%) done

[Sun Jul  5 23:05:27 2020]
rule score_and_cut:
    input: per_gene/EOG091G0QIP/EOG091G0QIP.clustalo.fasta
    output: per_gene/EOG091G0QIP/ALICUT_EOG091G0QIP.clustalo.fasta
    jobid: 757
    wildcards: BUSCO=EOG091G0QIP
    threads: 2


        cd per_gene/EOG091G0QIP
        Aliscore.pl -N -r 200000000000000000 -i ../../per_gene/EOG091G0QIP/EOG091G0QIP.clustalo.fasta &> aliscore.log
        ALICUT.pl -s &> alicut.log
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/63c88c27a0fa300f57066b0ef65fefcb.simg
[Sun Jul  5 23:05:28 2020]
Finished job 3265.
1722 of 3292 steps (52%) done

[Sun Jul  5 23:05:28 2020]
rule join_groups:
    input: per_gene/EOG091G1BQN/EOG091G1BQN.ingroup.fasta, per_gene/EOG091G1BQN/EOG091G1BQN.outgroup.fasta
    output: per_gene/EOG091G1BQN/EOG091G1BQN.fasta
    jobid: 2456
    wildcards: BUSCO=EOG091G1BQN


        cat per_gene/EOG091G1BQN/EOG091G1BQN.ingroup.fasta per_gene/EOG091G1BQN/EOG091G1BQN.outgroup.fasta > per_gene/EOG091G1BQN/EOG091G1BQN.fasta
        
[Sun Jul  5 23:05:28 2020]
Finished job 2456.
1723 of 3292 steps (52%) done
[Sun Jul  5 23:05:29 2020]
Finished job 1127.
1724 of 3292 steps (52%) done

[Sun Jul  5 23:05:29 2020]
rule remove_empty:
    input: per_gene/EOG091G0CEK/ALICUT_EOG091G0CEK.clustalo.fasta
    output: per_gene/EOG091G0CEK/empty_check.done
    jobid: 1949
    wildcards: BUSCO=EOG091G0CEK


         if [ "$(cat per_gene/EOG091G0CEK/ALICUT_EOG091G0CEK.clustalo.fasta | grep -v ">" | sed 's/-//g' | grep "^$" | wc -l)" -gt 0 ]
         then
              cp per_gene/EOG091G0CEK/ALICUT_EOG091G0CEK.clustalo.fasta per_gene/EOG091G0CEK/ALICUT_EOG091G0CEK.clustalo.fasta.backup
              bash ../scripts/remove_empty.sh per_gene/EOG091G0CEK/ALICUT_EOG091G0CEK.clustalo.fasta.backup > per_gene/EOG091G0CEK/ALICUT_EOG091G0CEK.clustalo.fasta
         fi
         touch per_gene/EOG091G0CEK/empty_check.done
         

[Sun Jul  5 23:05:29 2020]
rule MSA:
    input: per_gene/EOG091G1BQN/EOG091G1BQN.fasta
    output: per_gene/EOG091G1BQN/EOG091G1BQN.clustalo.fasta
    log: per_gene/EOG091G1BQN/MSA.stdout.txt, per_gene/EOG091G1BQN/MSA.stderr.txt
    jobid: 2032
    wildcards: BUSCO=EOG091G1BQN
    threads: 2


        clustalo -i per_gene/EOG091G1BQN/EOG091G1BQN.fasta -o per_gene/EOG091G1BQN/EOG091G1BQN.clustalo.fasta --threads=2 1> per_gene/EOG091G1BQN/MSA.stdout.txt 2> per_gene/EOG091G1BQN/MSA.stderr.txt
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/d68c9691725a7401923680874285c430.simg
[Sun Jul  5 23:05:29 2020]
Finished job 1949.
1725 of 3292 steps (52%) done
[Sun Jul  5 23:05:29 2020]
Finished job 2943.
1726 of 3292 steps (52%) done

[Sun Jul  5 23:05:29 2020]
rule join_groups:
    input: per_gene/EOG091G1A1V/EOG091G1A1V.ingroup.fasta, per_gene/EOG091G1A1V/EOG091G1A1V.outgroup.fasta
    output: per_gene/EOG091G1A1V/EOG091G1A1V.fasta
    jobid: 2295
    wildcards: BUSCO=EOG091G1A1V


        cat per_gene/EOG091G1A1V/EOG091G1A1V.ingroup.fasta per_gene/EOG091G1A1V/EOG091G1A1V.outgroup.fasta > per_gene/EOG091G1A1V/EOG091G1A1V.fasta
        
[Sun Jul  5 23:05:29 2020]
Finished job 2295.
1727 of 3292 steps (52%) done

[Sun Jul  5 23:05:29 2020]
rule MSA:
    input: per_gene/EOG091G1A1V/EOG091G1A1V.fasta
    output: per_gene/EOG091G1A1V/EOG091G1A1V.clustalo.fasta
    log: per_gene/EOG091G1A1V/MSA.stdout.txt, per_gene/EOG091G1A1V/MSA.stderr.txt
    jobid: 1710
    wildcards: BUSCO=EOG091G1A1V
    threads: 2


        clustalo -i per_gene/EOG091G1A1V/EOG091G1A1V.fasta -o per_gene/EOG091G1A1V/EOG091G1A1V.clustalo.fasta --threads=2 1> per_gene/EOG091G1A1V/MSA.stdout.txt 2> per_gene/EOG091G1A1V/MSA.stderr.txt
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/d68c9691725a7401923680874285c430.simg
[Sun Jul  5 23:05:30 2020]
Finished job 2032.
1728 of 3292 steps (52%) done

[Sun Jul  5 23:05:30 2020]
rule score_and_cut:
    input: per_gene/EOG091G1BQN/EOG091G1BQN.clustalo.fasta
    output: per_gene/EOG091G1BQN/ALICUT_EOG091G1BQN.clustalo.fasta
    jobid: 1209
    wildcards: BUSCO=EOG091G1BQN
    threads: 2


        cd per_gene/EOG091G1BQN
        Aliscore.pl -N -r 200000000000000000 -i ../../per_gene/EOG091G1BQN/EOG091G1BQN.clustalo.fasta &> aliscore.log
        ALICUT.pl -s &> alicut.log
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/63c88c27a0fa300f57066b0ef65fefcb.simg
[Sun Jul  5 23:05:30 2020]
Finished job 1710.
1729 of 3292 steps (53%) done

[Sun Jul  5 23:05:30 2020]
rule score_and_cut:
    input: per_gene/EOG091G1A1V/EOG091G1A1V.clustalo.fasta
    output: per_gene/EOG091G1A1V/ALICUT_EOG091G1A1V.clustalo.fasta
    jobid: 887
    wildcards: BUSCO=EOG091G1A1V
    threads: 2


        cd per_gene/EOG091G1A1V
        Aliscore.pl -N -r 200000000000000000 -i ../../per_gene/EOG091G1A1V/EOG091G1A1V.clustalo.fasta &> aliscore.log
        ALICUT.pl -s &> alicut.log
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/63c88c27a0fa300f57066b0ef65fefcb.simg
[Sun Jul  5 23:05:31 2020]
Finished job 661.
1730 of 3292 steps (53%) done

[Sun Jul  5 23:05:31 2020]
rule find_best_model:
    input: per_gene/EOG091G0CEK/ALICUT_EOG091G0CEK.clustalo.fasta, per_gene/EOG091G0CEK/empty_check.done
    output: per_gene/EOG091G0CEK/EOG091G0CEK.best_model
    log: per_gene/EOG091G0CEK/find_best_model.stderr.txt
    jobid: 1126
    wildcards: BUSCO=EOG091G0CEK
    threads: 2


        cd per_gene/EOG091G0CEK
        if [ ! -d find_best_model ]
        then
            mkdir find_best_model
        fi
        cd find_best_model
        ln -s ../../../per_gene/EOG091G0CEK/ALICUT_EOG091G0CEK.clustalo.fasta EOG091G0CEK.fasta
        ProteinModelSelection.pl EOG091G0CEK.fasta 1> ../../../per_gene/EOG091G0CEK/EOG091G0CEK.best_model 2> ../../../per_gene/EOG091G0CEK/find_best_model.stderr.txt
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/c0c09ee657b1e27f2c5687e0e9aa8d70.simg
[Sun Jul  5 23:05:39 2020]
Finished job 757.
1731 of 3292 steps (53%) done

[Sun Jul  5 23:05:39 2020]
rule remove_empty:
    input: per_gene/EOG091G0QIP/ALICUT_EOG091G0QIP.clustalo.fasta
    output: per_gene/EOG091G0QIP/empty_check.done
    jobid: 1579
    wildcards: BUSCO=EOG091G0QIP


         if [ "$(cat per_gene/EOG091G0QIP/ALICUT_EOG091G0QIP.clustalo.fasta | grep -v ">" | sed 's/-//g' | grep "^$" | wc -l)" -gt 0 ]
         then
              cp per_gene/EOG091G0QIP/ALICUT_EOG091G0QIP.clustalo.fasta per_gene/EOG091G0QIP/ALICUT_EOG091G0QIP.clustalo.fasta.backup
              bash ../scripts/remove_empty.sh per_gene/EOG091G0QIP/ALICUT_EOG091G0QIP.clustalo.fasta.backup > per_gene/EOG091G0QIP/ALICUT_EOG091G0QIP.clustalo.fasta
         fi
         touch per_gene/EOG091G0QIP/empty_check.done
         

[Sun Jul  5 23:05:39 2020]
rule remove_empty:
    input: per_gene/EOG091G0IQ7/ALICUT_EOG091G0IQ7.clustalo.fasta
    output: per_gene/EOG091G0IQ7/empty_check.done
    jobid: 1483
    wildcards: BUSCO=EOG091G0IQ7


         if [ "$(cat per_gene/EOG091G0IQ7/ALICUT_EOG091G0IQ7.clustalo.fasta | grep -v ">" | sed 's/-//g' | grep "^$" | wc -l)" -gt 0 ]
         then
              cp per_gene/EOG091G0IQ7/ALICUT_EOG091G0IQ7.clustalo.fasta per_gene/EOG091G0IQ7/ALICUT_EOG091G0IQ7.clustalo.fasta.backup
              bash ../scripts/remove_empty.sh per_gene/EOG091G0IQ7/ALICUT_EOG091G0IQ7.clustalo.fasta.backup > per_gene/EOG091G0IQ7/ALICUT_EOG091G0IQ7.clustalo.fasta
         fi
         touch per_gene/EOG091G0IQ7/empty_check.done
         
[Sun Jul  5 23:05:39 2020]
Finished job 1579.
1732 of 3292 steps (53%) done
[Sun Jul  5 23:05:39 2020]
Finished job 1483.
1733 of 3292 steps (53%) done

[Sun Jul  5 23:05:39 2020]
rule find_best_model:
    input: per_gene/EOG091G0IQ7/ALICUT_EOG091G0IQ7.clustalo.fasta, per_gene/EOG091G0IQ7/empty_check.done
    output: per_gene/EOG091G0IQ7/EOG091G0IQ7.best_model
    log: per_gene/EOG091G0IQ7/find_best_model.stderr.txt
    jobid: 660
    wildcards: BUSCO=EOG091G0IQ7
    threads: 2


        cd per_gene/EOG091G0IQ7
        if [ ! -d find_best_model ]
        then
            mkdir find_best_model
        fi
        cd find_best_model
        ln -s ../../../per_gene/EOG091G0IQ7/ALICUT_EOG091G0IQ7.clustalo.fasta EOG091G0IQ7.fasta
        ProteinModelSelection.pl EOG091G0IQ7.fasta 1> ../../../per_gene/EOG091G0IQ7/EOG091G0IQ7.best_model 2> ../../../per_gene/EOG091G0IQ7/find_best_model.stderr.txt
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/c0c09ee657b1e27f2c5687e0e9aa8d70.simg
[Sun Jul  5 23:05:40 2020]
Finished job 1209.
1734 of 3292 steps (53%) done

[Sun Jul  5 23:05:40 2020]
rule find_best_model:
    input: per_gene/EOG091G0QIP/ALICUT_EOG091G0QIP.clustalo.fasta, per_gene/EOG091G0QIP/empty_check.done
    output: per_gene/EOG091G0QIP/EOG091G0QIP.best_model
    log: per_gene/EOG091G0QIP/find_best_model.stderr.txt
    jobid: 756
    wildcards: BUSCO=EOG091G0QIP
    threads: 2


        cd per_gene/EOG091G0QIP
        if [ ! -d find_best_model ]
        then
            mkdir find_best_model
        fi
        cd find_best_model
        ln -s ../../../per_gene/EOG091G0QIP/ALICUT_EOG091G0QIP.clustalo.fasta EOG091G0QIP.fasta
        ProteinModelSelection.pl EOG091G0QIP.fasta 1> ../../../per_gene/EOG091G0QIP/EOG091G0QIP.best_model 2> ../../../per_gene/EOG091G0QIP/find_best_model.stderr.txt
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/c0c09ee657b1e27f2c5687e0e9aa8d70.simg
[Sun Jul  5 23:05:40 2020]
Finished job 887.
1735 of 3292 steps (53%) done

[Sun Jul  5 23:05:40 2020]
rule remove_empty:
    input: per_gene/EOG091G1BQN/ALICUT_EOG091G1BQN.clustalo.fasta
    output: per_gene/EOG091G1BQN/empty_check.done
    jobid: 2031
    wildcards: BUSCO=EOG091G1BQN


         if [ "$(cat per_gene/EOG091G1BQN/ALICUT_EOG091G1BQN.clustalo.fasta | grep -v ">" | sed 's/-//g' | grep "^$" | wc -l)" -gt 0 ]
         then
              cp per_gene/EOG091G1BQN/ALICUT_EOG091G1BQN.clustalo.fasta per_gene/EOG091G1BQN/ALICUT_EOG091G1BQN.clustalo.fasta.backup
              bash ../scripts/remove_empty.sh per_gene/EOG091G1BQN/ALICUT_EOG091G1BQN.clustalo.fasta.backup > per_gene/EOG091G1BQN/ALICUT_EOG091G1BQN.clustalo.fasta
         fi
         touch per_gene/EOG091G1BQN/empty_check.done
         

[Sun Jul  5 23:05:40 2020]
rule remove_empty:
    input: per_gene/EOG091G1A1V/ALICUT_EOG091G1A1V.clustalo.fasta
    output: per_gene/EOG091G1A1V/empty_check.done
    jobid: 1709
    wildcards: BUSCO=EOG091G1A1V


         if [ "$(cat per_gene/EOG091G1A1V/ALICUT_EOG091G1A1V.clustalo.fasta | grep -v ">" | sed 's/-//g' | grep "^$" | wc -l)" -gt 0 ]
         then
              cp per_gene/EOG091G1A1V/ALICUT_EOG091G1A1V.clustalo.fasta per_gene/EOG091G1A1V/ALICUT_EOG091G1A1V.clustalo.fasta.backup
              bash ../scripts/remove_empty.sh per_gene/EOG091G1A1V/ALICUT_EOG091G1A1V.clustalo.fasta.backup > per_gene/EOG091G1A1V/ALICUT_EOG091G1A1V.clustalo.fasta
         fi
         touch per_gene/EOG091G1A1V/empty_check.done
         
[Sun Jul  5 23:05:40 2020]
Finished job 2031.
1736 of 3292 steps (53%) done
[Sun Jul  5 23:05:40 2020]
Finished job 1709.
1737 of 3292 steps (53%) done

[Sun Jul  5 23:05:40 2020]
rule find_best_model:
    input: per_gene/EOG091G1BQN/ALICUT_EOG091G1BQN.clustalo.fasta, per_gene/EOG091G1BQN/empty_check.done
    output: per_gene/EOG091G1BQN/EOG091G1BQN.best_model
    log: per_gene/EOG091G1BQN/find_best_model.stderr.txt
    jobid: 1208
    wildcards: BUSCO=EOG091G1BQN
    threads: 2


        cd per_gene/EOG091G1BQN
        if [ ! -d find_best_model ]
        then
            mkdir find_best_model
        fi
        cd find_best_model
        ln -s ../../../per_gene/EOG091G1BQN/ALICUT_EOG091G1BQN.clustalo.fasta EOG091G1BQN.fasta
        ProteinModelSelection.pl EOG091G1BQN.fasta 1> ../../../per_gene/EOG091G1BQN/EOG091G1BQN.best_model 2> ../../../per_gene/EOG091G1BQN/find_best_model.stderr.txt
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/c0c09ee657b1e27f2c5687e0e9aa8d70.simg
[Sun Jul  5 23:05:51 2020]
Finished job 1052.
1738 of 3292 steps (53%) done

[Sun Jul  5 23:05:51 2020]
rule infer_single_ML:
    input: per_gene/EOG091G01GC/EOG091G01GC.best_model, per_gene/EOG091G01GC/ALICUT_EOG091G01GC.clustalo.fasta
    output: per_gene/EOG091G01GC/EOG091G01GC.raxml.done
    log: per_gene/EOG091G01GC/infer_single_ML.stdout.txt, per_gene/EOG091G01GC/infer_single_ML.stderr.txt
    jobid: 320
    wildcards: BUSCO=EOG091G01GC
    threads: 2


        cd per_gene/EOG091G01GC
	count=$(cat ../../per_gene/EOG091G01GC/ALICUT_EOG091G01GC.clustalo.fasta | grep ">" | wc -l)
	if [ "$count" -gt 5 ]
        then
		RAxMLmodel=$(cat ../../per_gene/EOG091G01GC/EOG091G01GC.best_model | grep "Best" | cut -d ":" -f 2 | tr -d '[:space:]')
                if [ "$(ls -1 | grep "^RAxML" | wc -l)" -ne 0 ]
		then
			rm RAxML*
		fi
        	raxml -f a -T 2 -m PROTGAMMA$RAxMLmodel         	-p 12345 -x 12345 -# 100         	-s ../../per_gene/EOG091G01GC/ALICUT_EOG091G01GC.clustalo.fasta -n EOG091G01GC.clustalo.aln.ALICUT.$RAxMLmodel 		1> ../../per_gene/EOG091G01GC/infer_single_ML.stdout.txt 2> ../../per_gene/EOG091G01GC/infer_single_ML.stderr.txt
	else
		echo "fasta file per_gene/EOG091G01GC/ALICUT_EOG091G01GC.clustalo.fasta contains fewer than 5 sequences - skipped" > ../../per_gene/EOG091G01GC/infer_single_ML.stdout.txt
		touch raxml.skipped
	fi
        touch ../../per_gene/EOG091G01GC/EOG091G01GC.raxml.done
        
[33mJob counts:
	count	jobs
	1	infer_single_ML
	1[0m
[33m
        cd per_gene/EOG091G01GC
	count=$(cat ../../per_gene/EOG091G01GC/ALICUT_EOG091G01GC.clustalo.fasta | grep ">" | wc -l)
	if [ "$count" -gt 5 ]
        then
		RAxMLmodel=$(cat ../../per_gene/EOG091G01GC/EOG091G01GC.best_model | grep "Best" | cut -d ":" -f 2 | tr -d '[:space:]')
                if [ "$(ls -1 | grep "^RAxML" | wc -l)" -ne 0 ]
		then
			rm RAxML*
		fi
        	raxml -f a -T 2 -m PROTGAMMA$RAxMLmodel         	-p 12345 -x 12345 -# 100         	-s ../../per_gene/EOG091G01GC/ALICUT_EOG091G01GC.clustalo.fasta -n EOG091G01GC.clustalo.aln.ALICUT.$RAxMLmodel 		1> ../../per_gene/EOG091G01GC/infer_single_ML.stdout.txt 2> ../../per_gene/EOG091G01GC/infer_single_ML.stderr.txt
	else
		echo "fasta file per_gene/EOG091G01GC/ALICUT_EOG091G01GC.clustalo.fasta contains fewer than 5 sequences - skipped" > ../../per_gene/EOG091G01GC/infer_single_ML.stdout.txt
		touch raxml.skipped
	fi
        touch ../../per_gene/EOG091G01GC/EOG091G01GC.raxml.done
        [0m
[Sun Jul  5 23:05:58 2020]
Finished job 1126.
1739 of 3292 steps (53%) done

[Sun Jul  5 23:05:58 2020]
rule infer_single_ML:
    input: per_gene/EOG091G0CEK/EOG091G0CEK.best_model, per_gene/EOG091G0CEK/ALICUT_EOG091G0CEK.clustalo.fasta
    output: per_gene/EOG091G0CEK/EOG091G0CEK.raxml.done
    log: per_gene/EOG091G0CEK/infer_single_ML.stdout.txt, per_gene/EOG091G0CEK/infer_single_ML.stderr.txt
    jobid: 357
    wildcards: BUSCO=EOG091G0CEK
    threads: 2


        cd per_gene/EOG091G0CEK
	count=$(cat ../../per_gene/EOG091G0CEK/ALICUT_EOG091G0CEK.clustalo.fasta | grep ">" | wc -l)
	if [ "$count" -gt 5 ]
        then
		RAxMLmodel=$(cat ../../per_gene/EOG091G0CEK/EOG091G0CEK.best_model | grep "Best" | cut -d ":" -f 2 | tr -d '[:space:]')
                if [ "$(ls -1 | grep "^RAxML" | wc -l)" -ne 0 ]
		then
			rm RAxML*
		fi
        	raxml -f a -T 2 -m PROTGAMMA$RAxMLmodel         	-p 12345 -x 12345 -# 100         	-s ../../per_gene/EOG091G0CEK/ALICUT_EOG091G0CEK.clustalo.fasta -n EOG091G0CEK.clustalo.aln.ALICUT.$RAxMLmodel 		1> ../../per_gene/EOG091G0CEK/infer_single_ML.stdout.txt 2> ../../per_gene/EOG091G0CEK/infer_single_ML.stderr.txt
	else
		echo "fasta file per_gene/EOG091G0CEK/ALICUT_EOG091G0CEK.clustalo.fasta contains fewer than 5 sequences - skipped" > ../../per_gene/EOG091G0CEK/infer_single_ML.stdout.txt
		touch raxml.skipped
	fi
        touch ../../per_gene/EOG091G0CEK/EOG091G0CEK.raxml.done
        
[33mJob counts:
	count	jobs
	1	infer_single_ML
	1[0m
[33m
        cd per_gene/EOG091G0CEK
	count=$(cat ../../per_gene/EOG091G0CEK/ALICUT_EOG091G0CEK.clustalo.fasta | grep ">" | wc -l)
	if [ "$count" -gt 5 ]
        then
		RAxMLmodel=$(cat ../../per_gene/EOG091G0CEK/EOG091G0CEK.best_model | grep "Best" | cut -d ":" -f 2 | tr -d '[:space:]')
                if [ "$(ls -1 | grep "^RAxML" | wc -l)" -ne 0 ]
		then
			rm RAxML*
		fi
        	raxml -f a -T 2 -m PROTGAMMA$RAxMLmodel         	-p 12345 -x 12345 -# 100         	-s ../../per_gene/EOG091G0CEK/ALICUT_EOG091G0CEK.clustalo.fasta -n EOG091G0CEK.clustalo.aln.ALICUT.$RAxMLmodel 		1> ../../per_gene/EOG091G0CEK/infer_single_ML.stdout.txt 2> ../../per_gene/EOG091G0CEK/infer_single_ML.stderr.txt
	else
		echo "fasta file per_gene/EOG091G0CEK/ALICUT_EOG091G0CEK.clustalo.fasta contains fewer than 5 sequences - skipped" > ../../per_gene/EOG091G0CEK/infer_single_ML.stdout.txt
		touch raxml.skipped
	fi
        touch ../../per_gene/EOG091G0CEK/EOG091G0CEK.raxml.done
        [0m
[Sun Jul  5 23:06:03 2020]
Finished job 756.
1740 of 3292 steps (53%) done

[Sun Jul  5 23:06:03 2020]
rule infer_single_ML:
    input: per_gene/EOG091G0QIP/EOG091G0QIP.best_model, per_gene/EOG091G0QIP/ALICUT_EOG091G0QIP.clustalo.fasta
    output: per_gene/EOG091G0QIP/EOG091G0QIP.raxml.done
    log: per_gene/EOG091G0QIP/infer_single_ML.stdout.txt, per_gene/EOG091G0QIP/infer_single_ML.stderr.txt
    jobid: 172
    wildcards: BUSCO=EOG091G0QIP
    threads: 2


        cd per_gene/EOG091G0QIP
	count=$(cat ../../per_gene/EOG091G0QIP/ALICUT_EOG091G0QIP.clustalo.fasta | grep ">" | wc -l)
	if [ "$count" -gt 5 ]
        then
		RAxMLmodel=$(cat ../../per_gene/EOG091G0QIP/EOG091G0QIP.best_model | grep "Best" | cut -d ":" -f 2 | tr -d '[:space:]')
                if [ "$(ls -1 | grep "^RAxML" | wc -l)" -ne 0 ]
		then
			rm RAxML*
		fi
        	raxml -f a -T 2 -m PROTGAMMA$RAxMLmodel         	-p 12345 -x 12345 -# 100         	-s ../../per_gene/EOG091G0QIP/ALICUT_EOG091G0QIP.clustalo.fasta -n EOG091G0QIP.clustalo.aln.ALICUT.$RAxMLmodel 		1> ../../per_gene/EOG091G0QIP/infer_single_ML.stdout.txt 2> ../../per_gene/EOG091G0QIP/infer_single_ML.stderr.txt
	else
		echo "fasta file per_gene/EOG091G0QIP/ALICUT_EOG091G0QIP.clustalo.fasta contains fewer than 5 sequences - skipped" > ../../per_gene/EOG091G0QIP/infer_single_ML.stdout.txt
		touch raxml.skipped
	fi
        touch ../../per_gene/EOG091G0QIP/EOG091G0QIP.raxml.done
        
[Sun Jul  5 23:06:04 2020]
Finished job 660.
1741 of 3292 steps (53%) done

[Sun Jul  5 23:06:04 2020]
rule infer_single_ML:
    input: per_gene/EOG091G0IQ7/EOG091G0IQ7.best_model, per_gene/EOG091G0IQ7/ALICUT_EOG091G0IQ7.clustalo.fasta
    output: per_gene/EOG091G0IQ7/EOG091G0IQ7.raxml.done
    log: per_gene/EOG091G0IQ7/infer_single_ML.stdout.txt, per_gene/EOG091G0IQ7/infer_single_ML.stderr.txt
    jobid: 124
    wildcards: BUSCO=EOG091G0IQ7
    threads: 2


        cd per_gene/EOG091G0IQ7
	count=$(cat ../../per_gene/EOG091G0IQ7/ALICUT_EOG091G0IQ7.clustalo.fasta | grep ">" | wc -l)
	if [ "$count" -gt 5 ]
        then
		RAxMLmodel=$(cat ../../per_gene/EOG091G0IQ7/EOG091G0IQ7.best_model | grep "Best" | cut -d ":" -f 2 | tr -d '[:space:]')
                if [ "$(ls -1 | grep "^RAxML" | wc -l)" -ne 0 ]
		then
			rm RAxML*
		fi
        	raxml -f a -T 2 -m PROTGAMMA$RAxMLmodel         	-p 12345 -x 12345 -# 100         	-s ../../per_gene/EOG091G0IQ7/ALICUT_EOG091G0IQ7.clustalo.fasta -n EOG091G0IQ7.clustalo.aln.ALICUT.$RAxMLmodel 		1> ../../per_gene/EOG091G0IQ7/infer_single_ML.stdout.txt 2> ../../per_gene/EOG091G0IQ7/infer_single_ML.stderr.txt
	else
		echo "fasta file per_gene/EOG091G0IQ7/ALICUT_EOG091G0IQ7.clustalo.fasta contains fewer than 5 sequences - skipped" > ../../per_gene/EOG091G0IQ7/infer_single_ML.stdout.txt
		touch raxml.skipped
	fi
        touch ../../per_gene/EOG091G0IQ7/EOG091G0IQ7.raxml.done
        
[33mJob counts:
	count	jobs
	1	infer_single_ML
	1[0m
[33m
        cd per_gene/EOG091G0QIP
	count=$(cat ../../per_gene/EOG091G0QIP/ALICUT_EOG091G0QIP.clustalo.fasta | grep ">" | wc -l)
	if [ "$count" -gt 5 ]
        then
		RAxMLmodel=$(cat ../../per_gene/EOG091G0QIP/EOG091G0QIP.best_model | grep "Best" | cut -d ":" -f 2 | tr -d '[:space:]')
                if [ "$(ls -1 | grep "^RAxML" | wc -l)" -ne 0 ]
		then
			rm RAxML*
		fi
        	raxml -f a -T 2 -m PROTGAMMA$RAxMLmodel         	-p 12345 -x 12345 -# 100         	-s ../../per_gene/EOG091G0QIP/ALICUT_EOG091G0QIP.clustalo.fasta -n EOG091G0QIP.clustalo.aln.ALICUT.$RAxMLmodel 		1> ../../per_gene/EOG091G0QIP/infer_single_ML.stdout.txt 2> ../../per_gene/EOG091G0QIP/infer_single_ML.stderr.txt
	else
		echo "fasta file per_gene/EOG091G0QIP/ALICUT_EOG091G0QIP.clustalo.fasta contains fewer than 5 sequences - skipped" > ../../per_gene/EOG091G0QIP/infer_single_ML.stdout.txt
		touch raxml.skipped
	fi
        touch ../../per_gene/EOG091G0QIP/EOG091G0QIP.raxml.done
        [0m
[33mJob counts:
	count	jobs
	1	infer_single_ML
	1[0m
[33m
        cd per_gene/EOG091G0IQ7
	count=$(cat ../../per_gene/EOG091G0IQ7/ALICUT_EOG091G0IQ7.clustalo.fasta | grep ">" | wc -l)
	if [ "$count" -gt 5 ]
        then
		RAxMLmodel=$(cat ../../per_gene/EOG091G0IQ7/EOG091G0IQ7.best_model | grep "Best" | cut -d ":" -f 2 | tr -d '[:space:]')
                if [ "$(ls -1 | grep "^RAxML" | wc -l)" -ne 0 ]
		then
			rm RAxML*
		fi
        	raxml -f a -T 2 -m PROTGAMMA$RAxMLmodel         	-p 12345 -x 12345 -# 100         	-s ../../per_gene/EOG091G0IQ7/ALICUT_EOG091G0IQ7.clustalo.fasta -n EOG091G0IQ7.clustalo.aln.ALICUT.$RAxMLmodel 		1> ../../per_gene/EOG091G0IQ7/infer_single_ML.stdout.txt 2> ../../per_gene/EOG091G0IQ7/infer_single_ML.stderr.txt
	else
		echo "fasta file per_gene/EOG091G0IQ7/ALICUT_EOG091G0IQ7.clustalo.fasta contains fewer than 5 sequences - skipped" > ../../per_gene/EOG091G0IQ7/infer_single_ML.stdout.txt
		touch raxml.skipped
	fi
        touch ../../per_gene/EOG091G0IQ7/EOG091G0IQ7.raxml.done
        [0m
[Sun Jul  5 23:06:05 2020]
Finished job 1208.
1742 of 3292 steps (53%) done

[Sun Jul  5 23:06:05 2020]
rule infer_single_ML:
    input: per_gene/EOG091G1BQN/EOG091G1BQN.best_model, per_gene/EOG091G1BQN/ALICUT_EOG091G1BQN.clustalo.fasta
    output: per_gene/EOG091G1BQN/EOG091G1BQN.raxml.done
    log: per_gene/EOG091G1BQN/infer_single_ML.stdout.txt, per_gene/EOG091G1BQN/infer_single_ML.stderr.txt
    jobid: 398
    wildcards: BUSCO=EOG091G1BQN
    threads: 2


        cd per_gene/EOG091G1BQN
	count=$(cat ../../per_gene/EOG091G1BQN/ALICUT_EOG091G1BQN.clustalo.fasta | grep ">" | wc -l)
	if [ "$count" -gt 5 ]
        then
		RAxMLmodel=$(cat ../../per_gene/EOG091G1BQN/EOG091G1BQN.best_model | grep "Best" | cut -d ":" -f 2 | tr -d '[:space:]')
                if [ "$(ls -1 | grep "^RAxML" | wc -l)" -ne 0 ]
		then
			rm RAxML*
		fi
        	raxml -f a -T 2 -m PROTGAMMA$RAxMLmodel         	-p 12345 -x 12345 -# 100         	-s ../../per_gene/EOG091G1BQN/ALICUT_EOG091G1BQN.clustalo.fasta -n EOG091G1BQN.clustalo.aln.ALICUT.$RAxMLmodel 		1> ../../per_gene/EOG091G1BQN/infer_single_ML.stdout.txt 2> ../../per_gene/EOG091G1BQN/infer_single_ML.stderr.txt
	else
		echo "fasta file per_gene/EOG091G1BQN/ALICUT_EOG091G1BQN.clustalo.fasta contains fewer than 5 sequences - skipped" > ../../per_gene/EOG091G1BQN/infer_single_ML.stdout.txt
		touch raxml.skipped
	fi
        touch ../../per_gene/EOG091G1BQN/EOG091G1BQN.raxml.done
        
[33mJob counts:
	count	jobs
	1	infer_single_ML
	1[0m
[33m
        cd per_gene/EOG091G1BQN
	count=$(cat ../../per_gene/EOG091G1BQN/ALICUT_EOG091G1BQN.clustalo.fasta | grep ">" | wc -l)
	if [ "$count" -gt 5 ]
        then
		RAxMLmodel=$(cat ../../per_gene/EOG091G1BQN/EOG091G1BQN.best_model | grep "Best" | cut -d ":" -f 2 | tr -d '[:space:]')
                if [ "$(ls -1 | grep "^RAxML" | wc -l)" -ne 0 ]
		then
			rm RAxML*
		fi
        	raxml -f a -T 2 -m PROTGAMMA$RAxMLmodel         	-p 12345 -x 12345 -# 100         	-s ../../per_gene/EOG091G1BQN/ALICUT_EOG091G1BQN.clustalo.fasta -n EOG091G1BQN.clustalo.aln.ALICUT.$RAxMLmodel 		1> ../../per_gene/EOG091G1BQN/infer_single_ML.stdout.txt 2> ../../per_gene/EOG091G1BQN/infer_single_ML.stderr.txt
	else
		echo "fasta file per_gene/EOG091G1BQN/ALICUT_EOG091G1BQN.clustalo.fasta contains fewer than 5 sequences - skipped" > ../../per_gene/EOG091G1BQN/infer_single_ML.stdout.txt
		touch raxml.skipped
	fi
        touch ../../per_gene/EOG091G1BQN/EOG091G1BQN.raxml.done
        [0m
[Sun Jul  5 23:07:03 2020]
Finished job 158.
1743 of 3292 steps (53%) done

[Sun Jul  5 23:07:03 2020]
rule find_best_model:
    input: per_gene/EOG091G1A1V/ALICUT_EOG091G1A1V.clustalo.fasta, per_gene/EOG091G1A1V/empty_check.done
    output: per_gene/EOG091G1A1V/EOG091G1A1V.best_model
    log: per_gene/EOG091G1A1V/find_best_model.stderr.txt
    jobid: 886
    wildcards: BUSCO=EOG091G1A1V
    threads: 2


        cd per_gene/EOG091G1A1V
        if [ ! -d find_best_model ]
        then
            mkdir find_best_model
        fi
        cd find_best_model
        ln -s ../../../per_gene/EOG091G1A1V/ALICUT_EOG091G1A1V.clustalo.fasta EOG091G1A1V.fasta
        ProteinModelSelection.pl EOG091G1A1V.fasta 1> ../../../per_gene/EOG091G1A1V/EOG091G1A1V.best_model 2> ../../../per_gene/EOG091G1A1V/find_best_model.stderr.txt
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/c0c09ee657b1e27f2c5687e0e9aa8d70.simg
[Sun Jul  5 23:07:14 2020]
Finished job 403.
1744 of 3292 steps (53%) done

[Sun Jul  5 23:07:14 2020]
rule get_seqs:
    input: /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ingroup.txt, /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/outgroup.txt
    output: per_gene/EOG091G03M4/EOG091G03M4.ingroup.fasta
    log: per_gene/EOG091G03M4/get_seqs.stdout.txt, per_gene/EOG091G03M4/get_seqs.stderr.txt
    jobid: 2512
    wildcards: BUSCO=EOG091G03M4
    threads: 2


	basedir=$(pwd)
        cd per_gene/EOG091G03M4
        
        bash $basedir/../scripts/fetch_seqs.sh EOG091G03M4 /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ingroup.txt /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/outgroup.txt 1> ../../per_gene/EOG091G03M4/get_seqs.stdout.txt 2> ../../per_gene/EOG091G03M4/get_seqs.stderr.txt
	mv EOG091G03M4.fasta $basedir/per_gene/EOG091G03M4/EOG091G03M4.ingroup.fasta
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/72476f9d9a5bd0627b4d721143a21354.simg
[Sun Jul  5 23:07:20 2020]
Finished job 93.
1745 of 3292 steps (53%) done

[Sun Jul  5 23:07:20 2020]
rule get_seqs:
    input: /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ingroup.txt, /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/outgroup.txt
    output: per_gene/EOG091G01VH/EOG091G01VH.ingroup.fasta
    log: per_gene/EOG091G01VH/get_seqs.stdout.txt, per_gene/EOG091G01VH/get_seqs.stderr.txt
    jobid: 3050
    wildcards: BUSCO=EOG091G01VH
    threads: 2


	basedir=$(pwd)
        cd per_gene/EOG091G01VH
        
        bash $basedir/../scripts/fetch_seqs.sh EOG091G01VH /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ingroup.txt /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/outgroup.txt 1> ../../per_gene/EOG091G01VH/get_seqs.stdout.txt 2> ../../per_gene/EOG091G01VH/get_seqs.stderr.txt
	mv EOG091G01VH.fasta $basedir/per_gene/EOG091G01VH/EOG091G01VH.ingroup.fasta
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/72476f9d9a5bd0627b4d721143a21354.simg
[Sun Jul  5 23:07:24 2020]
Finished job 886.
1746 of 3292 steps (53%) done

[Sun Jul  5 23:07:24 2020]
rule infer_single_ML:
    input: per_gene/EOG091G1A1V/EOG091G1A1V.best_model, per_gene/EOG091G1A1V/ALICUT_EOG091G1A1V.clustalo.fasta
    output: per_gene/EOG091G1A1V/EOG091G1A1V.raxml.done
    log: per_gene/EOG091G1A1V/infer_single_ML.stdout.txt, per_gene/EOG091G1A1V/infer_single_ML.stderr.txt
    jobid: 237
    wildcards: BUSCO=EOG091G1A1V
    threads: 2


        cd per_gene/EOG091G1A1V
	count=$(cat ../../per_gene/EOG091G1A1V/ALICUT_EOG091G1A1V.clustalo.fasta | grep ">" | wc -l)
	if [ "$count" -gt 5 ]
        then
		RAxMLmodel=$(cat ../../per_gene/EOG091G1A1V/EOG091G1A1V.best_model | grep "Best" | cut -d ":" -f 2 | tr -d '[:space:]')
                if [ "$(ls -1 | grep "^RAxML" | wc -l)" -ne 0 ]
		then
			rm RAxML*
		fi
        	raxml -f a -T 2 -m PROTGAMMA$RAxMLmodel         	-p 12345 -x 12345 -# 100         	-s ../../per_gene/EOG091G1A1V/ALICUT_EOG091G1A1V.clustalo.fasta -n EOG091G1A1V.clustalo.aln.ALICUT.$RAxMLmodel 		1> ../../per_gene/EOG091G1A1V/infer_single_ML.stdout.txt 2> ../../per_gene/EOG091G1A1V/infer_single_ML.stderr.txt
	else
		echo "fasta file per_gene/EOG091G1A1V/ALICUT_EOG091G1A1V.clustalo.fasta contains fewer than 5 sequences - skipped" > ../../per_gene/EOG091G1A1V/infer_single_ML.stdout.txt
		touch raxml.skipped
	fi
        touch ../../per_gene/EOG091G1A1V/EOG091G1A1V.raxml.done
        
[Sun Jul  5 23:07:27 2020]
Finished job 2512.
1747 of 3292 steps (53%) done

[Sun Jul  5 23:07:27 2020]
rule get_outgroups:
    input: per_gene/EOG091G03M4/EOG091G03M4.ingroup.fasta
    output: per_gene/EOG091G03M4/EOG091G03M4.orthodb.fasta, per_gene/EOG091G03M4/EOG091G03M4.outgroup.fasta
    log: per_gene/EOG091G03M4/get_outgroups.stdout.txt, per_gene/EOG091G03M4/get_outgroups.stderr.txt
    jobid: 2513
    wildcards: BUSCO=EOG091G03M4


        #download fastas from Orhtodb for BUSCO id
        for i in {1..5}
        do
             wget "http://www.orthodb.org/fasta?query=EOG091G03M4&level=33208" -O per_gene/EOG091G03M4/EOG091G03M4.orthodb.fasta 1> per_gene/EOG091G03M4/get_outgroups.stdout.txt 2> per_gene/EOG091G03M4/get_outgroups.stderr.txt && break || echo -e "try again ($i)" && sleep 15
        done

	#This is quick an dirty for now and just takes the first protein if there is more than one for an outgroup taxon
        bash ../scripts/download_outgroups.sh taxids.txt per_gene/EOG091G03M4/EOG091G03M4.orthodb.fasta > per_gene/EOG091G03M4/EOG091G03M4.outgroup.fasta
        
[Sun Jul  5 23:07:27 2020]
Finished job 2513.
1748 of 3292 steps (53%) done

[Sun Jul  5 23:07:27 2020]
rule join_groups:
    input: per_gene/EOG091G03M4/EOG091G03M4.ingroup.fasta, per_gene/EOG091G03M4/EOG091G03M4.outgroup.fasta
    output: per_gene/EOG091G03M4/EOG091G03M4.fasta
    jobid: 2080
    wildcards: BUSCO=EOG091G03M4


        cat per_gene/EOG091G03M4/EOG091G03M4.ingroup.fasta per_gene/EOG091G03M4/EOG091G03M4.outgroup.fasta > per_gene/EOG091G03M4/EOG091G03M4.fasta
        
[Sun Jul  5 23:07:27 2020]
Finished job 2080.
1749 of 3292 steps (53%) done

[Sun Jul  5 23:07:27 2020]
rule MSA:
    input: per_gene/EOG091G03M4/EOG091G03M4.fasta
    output: per_gene/EOG091G03M4/EOG091G03M4.clustalo.fasta
    log: per_gene/EOG091G03M4/MSA.stdout.txt, per_gene/EOG091G03M4/MSA.stderr.txt
    jobid: 1280
    wildcards: BUSCO=EOG091G03M4
    threads: 2


        clustalo -i per_gene/EOG091G03M4/EOG091G03M4.fasta -o per_gene/EOG091G03M4/EOG091G03M4.clustalo.fasta --threads=2 1> per_gene/EOG091G03M4/MSA.stdout.txt 2> per_gene/EOG091G03M4/MSA.stderr.txt
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/d68c9691725a7401923680874285c430.simg
[Sun Jul  5 23:07:31 2020]
Finished job 1280.
1750 of 3292 steps (53%) done

[Sun Jul  5 23:07:31 2020]
rule score_and_cut:
    input: per_gene/EOG091G03M4/EOG091G03M4.clustalo.fasta
    output: per_gene/EOG091G03M4/ALICUT_EOG091G03M4.clustalo.fasta
    jobid: 457
    wildcards: BUSCO=EOG091G03M4
    threads: 2


        cd per_gene/EOG091G03M4
        Aliscore.pl -N -r 200000000000000000 -i ../../per_gene/EOG091G03M4/EOG091G03M4.clustalo.fasta &> aliscore.log
        ALICUT.pl -s &> alicut.log
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/63c88c27a0fa300f57066b0ef65fefcb.simg
[Sun Jul  5 23:07:31 2020]
Finished job 3050.
1751 of 3292 steps (53%) done

[Sun Jul  5 23:07:31 2020]
rule get_outgroups:
    input: per_gene/EOG091G01VH/EOG091G01VH.ingroup.fasta
    output: per_gene/EOG091G01VH/EOG091G01VH.orthodb.fasta, per_gene/EOG091G01VH/EOG091G01VH.outgroup.fasta
    log: per_gene/EOG091G01VH/get_outgroups.stdout.txt, per_gene/EOG091G01VH/get_outgroups.stderr.txt
    jobid: 3051
    wildcards: BUSCO=EOG091G01VH


        #download fastas from Orhtodb for BUSCO id
        for i in {1..5}
        do
             wget "http://www.orthodb.org/fasta?query=EOG091G01VH&level=33208" -O per_gene/EOG091G01VH/EOG091G01VH.orthodb.fasta 1> per_gene/EOG091G01VH/get_outgroups.stdout.txt 2> per_gene/EOG091G01VH/get_outgroups.stderr.txt && break || echo -e "try again ($i)" && sleep 15
        done

	#This is quick an dirty for now and just takes the first protein if there is more than one for an outgroup taxon
        bash ../scripts/download_outgroups.sh taxids.txt per_gene/EOG091G01VH/EOG091G01VH.orthodb.fasta > per_gene/EOG091G01VH/EOG091G01VH.outgroup.fasta
        
[33mJob counts:
	count	jobs
	1	infer_single_ML
	1[0m
[33m
        cd per_gene/EOG091G1A1V
	count=$(cat ../../per_gene/EOG091G1A1V/ALICUT_EOG091G1A1V.clustalo.fasta | grep ">" | wc -l)
	if [ "$count" -gt 5 ]
        then
		RAxMLmodel=$(cat ../../per_gene/EOG091G1A1V/EOG091G1A1V.best_model | grep "Best" | cut -d ":" -f 2 | tr -d '[:space:]')
                if [ "$(ls -1 | grep "^RAxML" | wc -l)" -ne 0 ]
		then
			rm RAxML*
		fi
        	raxml -f a -T 2 -m PROTGAMMA$RAxMLmodel         	-p 12345 -x 12345 -# 100         	-s ../../per_gene/EOG091G1A1V/ALICUT_EOG091G1A1V.clustalo.fasta -n EOG091G1A1V.clustalo.aln.ALICUT.$RAxMLmodel 		1> ../../per_gene/EOG091G1A1V/infer_single_ML.stdout.txt 2> ../../per_gene/EOG091G1A1V/infer_single_ML.stderr.txt
	else
		echo "fasta file per_gene/EOG091G1A1V/ALICUT_EOG091G1A1V.clustalo.fasta contains fewer than 5 sequences - skipped" > ../../per_gene/EOG091G1A1V/infer_single_ML.stdout.txt
		touch raxml.skipped
	fi
        touch ../../per_gene/EOG091G1A1V/EOG091G1A1V.raxml.done
        [0m
[Sun Jul  5 23:07:32 2020]
Finished job 3051.
1752 of 3292 steps (53%) done

[Sun Jul  5 23:07:32 2020]
rule join_groups:
    input: per_gene/EOG091G01VH/EOG091G01VH.ingroup.fasta, per_gene/EOG091G01VH/EOG091G01VH.outgroup.fasta
    output: per_gene/EOG091G01VH/EOG091G01VH.fasta
    jobid: 2349
    wildcards: BUSCO=EOG091G01VH


        cat per_gene/EOG091G01VH/EOG091G01VH.ingroup.fasta per_gene/EOG091G01VH/EOG091G01VH.outgroup.fasta > per_gene/EOG091G01VH/EOG091G01VH.fasta
        
[Sun Jul  5 23:07:32 2020]
Finished job 2349.
1753 of 3292 steps (53%) done

[Sun Jul  5 23:07:32 2020]
rule MSA:
    input: per_gene/EOG091G01VH/EOG091G01VH.fasta
    output: per_gene/EOG091G01VH/EOG091G01VH.clustalo.fasta
    log: per_gene/EOG091G01VH/MSA.stdout.txt, per_gene/EOG091G01VH/MSA.stderr.txt
    jobid: 1818
    wildcards: BUSCO=EOG091G01VH
    threads: 2


        clustalo -i per_gene/EOG091G01VH/EOG091G01VH.fasta -o per_gene/EOG091G01VH/EOG091G01VH.clustalo.fasta --threads=2 1> per_gene/EOG091G01VH/MSA.stdout.txt 2> per_gene/EOG091G01VH/MSA.stderr.txt
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/d68c9691725a7401923680874285c430.simg
[Sun Jul  5 23:07:37 2020]
Finished job 1818.
1754 of 3292 steps (53%) done

[Sun Jul  5 23:07:37 2020]
rule score_and_cut:
    input: per_gene/EOG091G01VH/EOG091G01VH.clustalo.fasta
    output: per_gene/EOG091G01VH/ALICUT_EOG091G01VH.clustalo.fasta
    jobid: 995
    wildcards: BUSCO=EOG091G01VH
    threads: 2


        cd per_gene/EOG091G01VH
        Aliscore.pl -N -r 200000000000000000 -i ../../per_gene/EOG091G01VH/EOG091G01VH.clustalo.fasta &> aliscore.log
        ALICUT.pl -s &> alicut.log
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/63c88c27a0fa300f57066b0ef65fefcb.simg
[Sun Jul  5 23:07:41 2020]
Finished job 457.
1755 of 3292 steps (53%) done

[Sun Jul  5 23:07:41 2020]
rule remove_empty:
    input: per_gene/EOG091G03M4/ALICUT_EOG091G03M4.clustalo.fasta
    output: per_gene/EOG091G03M4/empty_check.done
    jobid: 1279
    wildcards: BUSCO=EOG091G03M4


         if [ "$(cat per_gene/EOG091G03M4/ALICUT_EOG091G03M4.clustalo.fasta | grep -v ">" | sed 's/-//g' | grep "^$" | wc -l)" -gt 0 ]
         then
              cp per_gene/EOG091G03M4/ALICUT_EOG091G03M4.clustalo.fasta per_gene/EOG091G03M4/ALICUT_EOG091G03M4.clustalo.fasta.backup
              bash ../scripts/remove_empty.sh per_gene/EOG091G03M4/ALICUT_EOG091G03M4.clustalo.fasta.backup > per_gene/EOG091G03M4/ALICUT_EOG091G03M4.clustalo.fasta
         fi
         touch per_gene/EOG091G03M4/empty_check.done
         
[Sun Jul  5 23:07:41 2020]
Finished job 1279.
1756 of 3292 steps (53%) done

[Sun Jul  5 23:07:41 2020]
rule find_best_model:
    input: per_gene/EOG091G03M4/ALICUT_EOG091G03M4.clustalo.fasta, per_gene/EOG091G03M4/empty_check.done
    output: per_gene/EOG091G03M4/EOG091G03M4.best_model
    log: per_gene/EOG091G03M4/find_best_model.stderr.txt
    jobid: 456
    wildcards: BUSCO=EOG091G03M4
    threads: 2


        cd per_gene/EOG091G03M4
        if [ ! -d find_best_model ]
        then
            mkdir find_best_model
        fi
        cd find_best_model
        ln -s ../../../per_gene/EOG091G03M4/ALICUT_EOG091G03M4.clustalo.fasta EOG091G03M4.fasta
        ProteinModelSelection.pl EOG091G03M4.fasta 1> ../../../per_gene/EOG091G03M4/EOG091G03M4.best_model 2> ../../../per_gene/EOG091G03M4/find_best_model.stderr.txt
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/c0c09ee657b1e27f2c5687e0e9aa8d70.simg
[Sun Jul  5 23:07:49 2020]
Finished job 995.
1757 of 3292 steps (53%) done

[Sun Jul  5 23:07:49 2020]
rule remove_empty:
    input: per_gene/EOG091G01VH/ALICUT_EOG091G01VH.clustalo.fasta
    output: per_gene/EOG091G01VH/empty_check.done
    jobid: 1817
    wildcards: BUSCO=EOG091G01VH


         if [ "$(cat per_gene/EOG091G01VH/ALICUT_EOG091G01VH.clustalo.fasta | grep -v ">" | sed 's/-//g' | grep "^$" | wc -l)" -gt 0 ]
         then
              cp per_gene/EOG091G01VH/ALICUT_EOG091G01VH.clustalo.fasta per_gene/EOG091G01VH/ALICUT_EOG091G01VH.clustalo.fasta.backup
              bash ../scripts/remove_empty.sh per_gene/EOG091G01VH/ALICUT_EOG091G01VH.clustalo.fasta.backup > per_gene/EOG091G01VH/ALICUT_EOG091G01VH.clustalo.fasta
         fi
         touch per_gene/EOG091G01VH/empty_check.done
         
[Sun Jul  5 23:07:49 2020]
Finished job 1817.
1758 of 3292 steps (53%) done

[Sun Jul  5 23:07:49 2020]
rule find_best_model:
    input: per_gene/EOG091G01VH/ALICUT_EOG091G01VH.clustalo.fasta, per_gene/EOG091G01VH/empty_check.done
    output: per_gene/EOG091G01VH/EOG091G01VH.best_model
    log: per_gene/EOG091G01VH/find_best_model.stderr.txt
    jobid: 994
    wildcards: BUSCO=EOG091G01VH
    threads: 2


        cd per_gene/EOG091G01VH
        if [ ! -d find_best_model ]
        then
            mkdir find_best_model
        fi
        cd find_best_model
        ln -s ../../../per_gene/EOG091G01VH/ALICUT_EOG091G01VH.clustalo.fasta EOG091G01VH.fasta
        ProteinModelSelection.pl EOG091G01VH.fasta 1> ../../../per_gene/EOG091G01VH/EOG091G01VH.best_model 2> ../../../per_gene/EOG091G01VH/find_best_model.stderr.txt
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/c0c09ee657b1e27f2c5687e0e9aa8d70.simg
[Sun Jul  5 23:08:02 2020]
Finished job 245.
1759 of 3292 steps (53%) done

[Sun Jul  5 23:08:02 2020]
rule get_seqs:
    input: /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ingroup.txt, /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/outgroup.txt
    output: per_gene/EOG091G0N0A/EOG091G0N0A.ingroup.fasta
    log: per_gene/EOG091G0N0A/get_seqs.stdout.txt, per_gene/EOG091G0N0A/get_seqs.stderr.txt
    jobid: 2780
    wildcards: BUSCO=EOG091G0N0A
    threads: 2


	basedir=$(pwd)
        cd per_gene/EOG091G0N0A
        
        bash $basedir/../scripts/fetch_seqs.sh EOG091G0N0A /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ingroup.txt /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/outgroup.txt 1> ../../per_gene/EOG091G0N0A/get_seqs.stdout.txt 2> ../../per_gene/EOG091G0N0A/get_seqs.stderr.txt
	mv EOG091G0N0A.fasta $basedir/per_gene/EOG091G0N0A/EOG091G0N0A.ingroup.fasta
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/72476f9d9a5bd0627b4d721143a21354.simg
[Sun Jul  5 23:08:14 2020]
Finished job 2780.
1760 of 3292 steps (53%) done

[Sun Jul  5 23:08:14 2020]
rule get_outgroups:
    input: per_gene/EOG091G0N0A/EOG091G0N0A.ingroup.fasta
    output: per_gene/EOG091G0N0A/EOG091G0N0A.orthodb.fasta, per_gene/EOG091G0N0A/EOG091G0N0A.outgroup.fasta
    log: per_gene/EOG091G0N0A/get_outgroups.stdout.txt, per_gene/EOG091G0N0A/get_outgroups.stderr.txt
    jobid: 2781
    wildcards: BUSCO=EOG091G0N0A


        #download fastas from Orhtodb for BUSCO id
        for i in {1..5}
        do
             wget "http://www.orthodb.org/fasta?query=EOG091G0N0A&level=33208" -O per_gene/EOG091G0N0A/EOG091G0N0A.orthodb.fasta 1> per_gene/EOG091G0N0A/get_outgroups.stdout.txt 2> per_gene/EOG091G0N0A/get_outgroups.stderr.txt && break || echo -e "try again ($i)" && sleep 15
        done

	#This is quick an dirty for now and just takes the first protein if there is more than one for an outgroup taxon
        bash ../scripts/download_outgroups.sh taxids.txt per_gene/EOG091G0N0A/EOG091G0N0A.orthodb.fasta > per_gene/EOG091G0N0A/EOG091G0N0A.outgroup.fasta
        
[Sun Jul  5 23:08:15 2020]
Finished job 2781.
1761 of 3292 steps (53%) done

[Sun Jul  5 23:08:15 2020]
rule join_groups:
    input: per_gene/EOG091G0N0A/EOG091G0N0A.ingroup.fasta, per_gene/EOG091G0N0A/EOG091G0N0A.outgroup.fasta
    output: per_gene/EOG091G0N0A/EOG091G0N0A.fasta
    jobid: 2214
    wildcards: BUSCO=EOG091G0N0A


        cat per_gene/EOG091G0N0A/EOG091G0N0A.ingroup.fasta per_gene/EOG091G0N0A/EOG091G0N0A.outgroup.fasta > per_gene/EOG091G0N0A/EOG091G0N0A.fasta
        
[Sun Jul  5 23:08:15 2020]
Finished job 2214.
1762 of 3292 steps (54%) done

[Sun Jul  5 23:08:15 2020]
rule MSA:
    input: per_gene/EOG091G0N0A/EOG091G0N0A.fasta
    output: per_gene/EOG091G0N0A/EOG091G0N0A.clustalo.fasta
    log: per_gene/EOG091G0N0A/MSA.stdout.txt, per_gene/EOG091G0N0A/MSA.stderr.txt
    jobid: 1548
    wildcards: BUSCO=EOG091G0N0A
    threads: 2


        clustalo -i per_gene/EOG091G0N0A/EOG091G0N0A.fasta -o per_gene/EOG091G0N0A/EOG091G0N0A.clustalo.fasta --threads=2 1> per_gene/EOG091G0N0A/MSA.stdout.txt 2> per_gene/EOG091G0N0A/MSA.stderr.txt
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/d68c9691725a7401923680874285c430.simg
[Sun Jul  5 23:08:17 2020]
Finished job 1548.
1763 of 3292 steps (54%) done

[Sun Jul  5 23:08:17 2020]
rule score_and_cut:
    input: per_gene/EOG091G0N0A/EOG091G0N0A.clustalo.fasta
    output: per_gene/EOG091G0N0A/ALICUT_EOG091G0N0A.clustalo.fasta
    jobid: 725
    wildcards: BUSCO=EOG091G0N0A
    threads: 2


        cd per_gene/EOG091G0N0A
        Aliscore.pl -N -r 200000000000000000 -i ../../per_gene/EOG091G0N0A/EOG091G0N0A.clustalo.fasta &> aliscore.log
        ALICUT.pl -s &> alicut.log
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/63c88c27a0fa300f57066b0ef65fefcb.simg
[Sun Jul  5 23:08:25 2020]
Finished job 456.
1764 of 3292 steps (54%) done

[Sun Jul  5 23:08:25 2020]
rule infer_single_ML:
    input: per_gene/EOG091G03M4/EOG091G03M4.best_model, per_gene/EOG091G03M4/ALICUT_EOG091G03M4.clustalo.fasta
    output: per_gene/EOG091G03M4/EOG091G03M4.raxml.done
    log: per_gene/EOG091G03M4/infer_single_ML.stdout.txt, per_gene/EOG091G03M4/infer_single_ML.stderr.txt
    jobid: 22
    wildcards: BUSCO=EOG091G03M4
    threads: 2


        cd per_gene/EOG091G03M4
	count=$(cat ../../per_gene/EOG091G03M4/ALICUT_EOG091G03M4.clustalo.fasta | grep ">" | wc -l)
	if [ "$count" -gt 5 ]
        then
		RAxMLmodel=$(cat ../../per_gene/EOG091G03M4/EOG091G03M4.best_model | grep "Best" | cut -d ":" -f 2 | tr -d '[:space:]')
                if [ "$(ls -1 | grep "^RAxML" | wc -l)" -ne 0 ]
		then
			rm RAxML*
		fi
        	raxml -f a -T 2 -m PROTGAMMA$RAxMLmodel         	-p 12345 -x 12345 -# 100         	-s ../../per_gene/EOG091G03M4/ALICUT_EOG091G03M4.clustalo.fasta -n EOG091G03M4.clustalo.aln.ALICUT.$RAxMLmodel 		1> ../../per_gene/EOG091G03M4/infer_single_ML.stdout.txt 2> ../../per_gene/EOG091G03M4/infer_single_ML.stderr.txt
	else
		echo "fasta file per_gene/EOG091G03M4/ALICUT_EOG091G03M4.clustalo.fasta contains fewer than 5 sequences - skipped" > ../../per_gene/EOG091G03M4/infer_single_ML.stdout.txt
		touch raxml.skipped
	fi
        touch ../../per_gene/EOG091G03M4/EOG091G03M4.raxml.done
        
[Sun Jul  5 23:08:26 2020]
Finished job 263.
1765 of 3292 steps (54%) done

[Sun Jul  5 23:08:26 2020]
rule get_seqs:
    input: /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ingroup.txt, /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/outgroup.txt
    output: per_gene/EOG091G0990/EOG091G0990.ingroup.fasta
    log: per_gene/EOG091G0990/get_seqs.stdout.txt, per_gene/EOG091G0990/get_seqs.stderr.txt
    jobid: 2602
    wildcards: BUSCO=EOG091G0990
    threads: 2


	basedir=$(pwd)
        cd per_gene/EOG091G0990
        
        bash $basedir/../scripts/fetch_seqs.sh EOG091G0990 /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ingroup.txt /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/outgroup.txt 1> ../../per_gene/EOG091G0990/get_seqs.stdout.txt 2> ../../per_gene/EOG091G0990/get_seqs.stderr.txt
	mv EOG091G0990.fasta $basedir/per_gene/EOG091G0990/EOG091G0990.ingroup.fasta
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/72476f9d9a5bd0627b4d721143a21354.simg
[Sun Jul  5 23:08:28 2020]
Finished job 725.
1766 of 3292 steps (54%) done

[Sun Jul  5 23:08:28 2020]
rule remove_empty:
    input: per_gene/EOG091G0N0A/ALICUT_EOG091G0N0A.clustalo.fasta
    output: per_gene/EOG091G0N0A/empty_check.done
    jobid: 1547
    wildcards: BUSCO=EOG091G0N0A


         if [ "$(cat per_gene/EOG091G0N0A/ALICUT_EOG091G0N0A.clustalo.fasta | grep -v ">" | sed 's/-//g' | grep "^$" | wc -l)" -gt 0 ]
         then
              cp per_gene/EOG091G0N0A/ALICUT_EOG091G0N0A.clustalo.fasta per_gene/EOG091G0N0A/ALICUT_EOG091G0N0A.clustalo.fasta.backup
              bash ../scripts/remove_empty.sh per_gene/EOG091G0N0A/ALICUT_EOG091G0N0A.clustalo.fasta.backup > per_gene/EOG091G0N0A/ALICUT_EOG091G0N0A.clustalo.fasta
         fi
         touch per_gene/EOG091G0N0A/empty_check.done
         
[Sun Jul  5 23:08:28 2020]
Finished job 1547.
1767 of 3292 steps (54%) done

[Sun Jul  5 23:08:28 2020]
rule find_best_model:
    input: per_gene/EOG091G0N0A/ALICUT_EOG091G0N0A.clustalo.fasta, per_gene/EOG091G0N0A/empty_check.done
    output: per_gene/EOG091G0N0A/EOG091G0N0A.best_model
    log: per_gene/EOG091G0N0A/find_best_model.stderr.txt
    jobid: 724
    wildcards: BUSCO=EOG091G0N0A
    threads: 2


        cd per_gene/EOG091G0N0A
        if [ ! -d find_best_model ]
        then
            mkdir find_best_model
        fi
        cd find_best_model
        ln -s ../../../per_gene/EOG091G0N0A/ALICUT_EOG091G0N0A.clustalo.fasta EOG091G0N0A.fasta
        ProteinModelSelection.pl EOG091G0N0A.fasta 1> ../../../per_gene/EOG091G0N0A/EOG091G0N0A.best_model 2> ../../../per_gene/EOG091G0N0A/find_best_model.stderr.txt
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/c0c09ee657b1e27f2c5687e0e9aa8d70.simg
[33mJob counts:
	count	jobs
	1	infer_single_ML
	1[0m
[33m
        cd per_gene/EOG091G03M4
	count=$(cat ../../per_gene/EOG091G03M4/ALICUT_EOG091G03M4.clustalo.fasta | grep ">" | wc -l)
	if [ "$count" -gt 5 ]
        then
		RAxMLmodel=$(cat ../../per_gene/EOG091G03M4/EOG091G03M4.best_model | grep "Best" | cut -d ":" -f 2 | tr -d '[:space:]')
                if [ "$(ls -1 | grep "^RAxML" | wc -l)" -ne 0 ]
		then
			rm RAxML*
		fi
        	raxml -f a -T 2 -m PROTGAMMA$RAxMLmodel         	-p 12345 -x 12345 -# 100         	-s ../../per_gene/EOG091G03M4/ALICUT_EOG091G03M4.clustalo.fasta -n EOG091G03M4.clustalo.aln.ALICUT.$RAxMLmodel 		1> ../../per_gene/EOG091G03M4/infer_single_ML.stdout.txt 2> ../../per_gene/EOG091G03M4/infer_single_ML.stderr.txt
	else
		echo "fasta file per_gene/EOG091G03M4/ALICUT_EOG091G03M4.clustalo.fasta contains fewer than 5 sequences - skipped" > ../../per_gene/EOG091G03M4/infer_single_ML.stdout.txt
		touch raxml.skipped
	fi
        touch ../../per_gene/EOG091G03M4/EOG091G03M4.raxml.done
        [0m
[Sun Jul  5 23:08:39 2020]
Finished job 2602.
1768 of 3292 steps (54%) done

[Sun Jul  5 23:08:39 2020]
rule get_outgroups:
    input: per_gene/EOG091G0990/EOG091G0990.ingroup.fasta
    output: per_gene/EOG091G0990/EOG091G0990.orthodb.fasta, per_gene/EOG091G0990/EOG091G0990.outgroup.fasta
    log: per_gene/EOG091G0990/get_outgroups.stdout.txt, per_gene/EOG091G0990/get_outgroups.stderr.txt
    jobid: 2603
    wildcards: BUSCO=EOG091G0990


        #download fastas from Orhtodb for BUSCO id
        for i in {1..5}
        do
             wget "http://www.orthodb.org/fasta?query=EOG091G0990&level=33208" -O per_gene/EOG091G0990/EOG091G0990.orthodb.fasta 1> per_gene/EOG091G0990/get_outgroups.stdout.txt 2> per_gene/EOG091G0990/get_outgroups.stderr.txt && break || echo -e "try again ($i)" && sleep 15
        done

	#This is quick an dirty for now and just takes the first protein if there is more than one for an outgroup taxon
        bash ../scripts/download_outgroups.sh taxids.txt per_gene/EOG091G0990/EOG091G0990.orthodb.fasta > per_gene/EOG091G0990/EOG091G0990.outgroup.fasta
        
[Sun Jul  5 23:08:40 2020]
Finished job 2603.
1769 of 3292 steps (54%) done

[Sun Jul  5 23:08:40 2020]
rule join_groups:
    input: per_gene/EOG091G0990/EOG091G0990.ingroup.fasta, per_gene/EOG091G0990/EOG091G0990.outgroup.fasta
    output: per_gene/EOG091G0990/EOG091G0990.fasta
    jobid: 2125
    wildcards: BUSCO=EOG091G0990


        cat per_gene/EOG091G0990/EOG091G0990.ingroup.fasta per_gene/EOG091G0990/EOG091G0990.outgroup.fasta > per_gene/EOG091G0990/EOG091G0990.fasta
        
[Sun Jul  5 23:08:40 2020]
Finished job 2125.
1770 of 3292 steps (54%) done

[Sun Jul  5 23:08:40 2020]
rule MSA:
    input: per_gene/EOG091G0990/EOG091G0990.fasta
    output: per_gene/EOG091G0990/EOG091G0990.clustalo.fasta
    log: per_gene/EOG091G0990/MSA.stdout.txt, per_gene/EOG091G0990/MSA.stderr.txt
    jobid: 1370
    wildcards: BUSCO=EOG091G0990
    threads: 2


        clustalo -i per_gene/EOG091G0990/EOG091G0990.fasta -o per_gene/EOG091G0990/EOG091G0990.clustalo.fasta --threads=2 1> per_gene/EOG091G0990/MSA.stdout.txt 2> per_gene/EOG091G0990/MSA.stderr.txt
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/d68c9691725a7401923680874285c430.simg
[Sun Jul  5 23:08:42 2020]
Finished job 1370.
1771 of 3292 steps (54%) done

[Sun Jul  5 23:08:42 2020]
rule score_and_cut:
    input: per_gene/EOG091G0990/EOG091G0990.clustalo.fasta
    output: per_gene/EOG091G0990/ALICUT_EOG091G0990.clustalo.fasta
    jobid: 547
    wildcards: BUSCO=EOG091G0990
    threads: 2


        cd per_gene/EOG091G0990
        Aliscore.pl -N -r 200000000000000000 -i ../../per_gene/EOG091G0990/EOG091G0990.clustalo.fasta &> aliscore.log
        ALICUT.pl -s &> alicut.log
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/63c88c27a0fa300f57066b0ef65fefcb.simg
[Sun Jul  5 23:08:48 2020]
Finished job 994.
1772 of 3292 steps (54%) done

[Sun Jul  5 23:08:48 2020]
rule infer_single_ML:
    input: per_gene/EOG091G01VH/EOG091G01VH.best_model, per_gene/EOG091G01VH/ALICUT_EOG091G01VH.clustalo.fasta
    output: per_gene/EOG091G01VH/EOG091G01VH.raxml.done
    log: per_gene/EOG091G01VH/infer_single_ML.stdout.txt, per_gene/EOG091G01VH/infer_single_ML.stderr.txt
    jobid: 291
    wildcards: BUSCO=EOG091G01VH
    threads: 2


        cd per_gene/EOG091G01VH
	count=$(cat ../../per_gene/EOG091G01VH/ALICUT_EOG091G01VH.clustalo.fasta | grep ">" | wc -l)
	if [ "$count" -gt 5 ]
        then
		RAxMLmodel=$(cat ../../per_gene/EOG091G01VH/EOG091G01VH.best_model | grep "Best" | cut -d ":" -f 2 | tr -d '[:space:]')
                if [ "$(ls -1 | grep "^RAxML" | wc -l)" -ne 0 ]
		then
			rm RAxML*
		fi
        	raxml -f a -T 2 -m PROTGAMMA$RAxMLmodel         	-p 12345 -x 12345 -# 100         	-s ../../per_gene/EOG091G01VH/ALICUT_EOG091G01VH.clustalo.fasta -n EOG091G01VH.clustalo.aln.ALICUT.$RAxMLmodel 		1> ../../per_gene/EOG091G01VH/infer_single_ML.stdout.txt 2> ../../per_gene/EOG091G01VH/infer_single_ML.stderr.txt
	else
		echo "fasta file per_gene/EOG091G01VH/ALICUT_EOG091G01VH.clustalo.fasta contains fewer than 5 sequences - skipped" > ../../per_gene/EOG091G01VH/infer_single_ML.stdout.txt
		touch raxml.skipped
	fi
        touch ../../per_gene/EOG091G01VH/EOG091G01VH.raxml.done
        
[Sun Jul  5 23:08:50 2020]
Finished job 724.
1773 of 3292 steps (54%) done

[Sun Jul  5 23:08:50 2020]
rule infer_single_ML:
    input: per_gene/EOG091G0N0A/EOG091G0N0A.best_model, per_gene/EOG091G0N0A/ALICUT_EOG091G0N0A.clustalo.fasta
    output: per_gene/EOG091G0N0A/EOG091G0N0A.raxml.done
    log: per_gene/EOG091G0N0A/infer_single_ML.stdout.txt, per_gene/EOG091G0N0A/infer_single_ML.stderr.txt
    jobid: 156
    wildcards: BUSCO=EOG091G0N0A
    threads: 2


        cd per_gene/EOG091G0N0A
	count=$(cat ../../per_gene/EOG091G0N0A/ALICUT_EOG091G0N0A.clustalo.fasta | grep ">" | wc -l)
	if [ "$count" -gt 5 ]
        then
		RAxMLmodel=$(cat ../../per_gene/EOG091G0N0A/EOG091G0N0A.best_model | grep "Best" | cut -d ":" -f 2 | tr -d '[:space:]')
                if [ "$(ls -1 | grep "^RAxML" | wc -l)" -ne 0 ]
		then
			rm RAxML*
		fi
        	raxml -f a -T 2 -m PROTGAMMA$RAxMLmodel         	-p 12345 -x 12345 -# 100         	-s ../../per_gene/EOG091G0N0A/ALICUT_EOG091G0N0A.clustalo.fasta -n EOG091G0N0A.clustalo.aln.ALICUT.$RAxMLmodel 		1> ../../per_gene/EOG091G0N0A/infer_single_ML.stdout.txt 2> ../../per_gene/EOG091G0N0A/infer_single_ML.stderr.txt
	else
		echo "fasta file per_gene/EOG091G0N0A/ALICUT_EOG091G0N0A.clustalo.fasta contains fewer than 5 sequences - skipped" > ../../per_gene/EOG091G0N0A/infer_single_ML.stdout.txt
		touch raxml.skipped
	fi
        touch ../../per_gene/EOG091G0N0A/EOG091G0N0A.raxml.done
        
[Sun Jul  5 23:08:52 2020]
Finished job 547.
1774 of 3292 steps (54%) done

[Sun Jul  5 23:08:52 2020]
rule remove_empty:
    input: per_gene/EOG091G0990/ALICUT_EOG091G0990.clustalo.fasta
    output: per_gene/EOG091G0990/empty_check.done
    jobid: 1369
    wildcards: BUSCO=EOG091G0990


         if [ "$(cat per_gene/EOG091G0990/ALICUT_EOG091G0990.clustalo.fasta | grep -v ">" | sed 's/-//g' | grep "^$" | wc -l)" -gt 0 ]
         then
              cp per_gene/EOG091G0990/ALICUT_EOG091G0990.clustalo.fasta per_gene/EOG091G0990/ALICUT_EOG091G0990.clustalo.fasta.backup
              bash ../scripts/remove_empty.sh per_gene/EOG091G0990/ALICUT_EOG091G0990.clustalo.fasta.backup > per_gene/EOG091G0990/ALICUT_EOG091G0990.clustalo.fasta
         fi
         touch per_gene/EOG091G0990/empty_check.done
         
[Sun Jul  5 23:08:52 2020]
Finished job 1369.
1775 of 3292 steps (54%) done

[Sun Jul  5 23:08:52 2020]
rule find_best_model:
    input: per_gene/EOG091G0990/ALICUT_EOG091G0990.clustalo.fasta, per_gene/EOG091G0990/empty_check.done
    output: per_gene/EOG091G0990/EOG091G0990.best_model
    log: per_gene/EOG091G0990/find_best_model.stderr.txt
    jobid: 546
    wildcards: BUSCO=EOG091G0990
    threads: 2


        cd per_gene/EOG091G0990
        if [ ! -d find_best_model ]
        then
            mkdir find_best_model
        fi
        cd find_best_model
        ln -s ../../../per_gene/EOG091G0990/ALICUT_EOG091G0990.clustalo.fasta EOG091G0990.fasta
        ProteinModelSelection.pl EOG091G0990.fasta 1> ../../../per_gene/EOG091G0990/EOG091G0990.best_model 2> ../../../per_gene/EOG091G0990/find_best_model.stderr.txt
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/c0c09ee657b1e27f2c5687e0e9aa8d70.simg
[33mJob counts:
	count	jobs
	1	infer_single_ML
	1[0m
[33mJob counts:
	count	jobs
	1	infer_single_ML
	1[0m
[33m
        cd per_gene/EOG091G01VH
	count=$(cat ../../per_gene/EOG091G01VH/ALICUT_EOG091G01VH.clustalo.fasta | grep ">" | wc -l)
	if [ "$count" -gt 5 ]
        then
		RAxMLmodel=$(cat ../../per_gene/EOG091G01VH/EOG091G01VH.best_model | grep "Best" | cut -d ":" -f 2 | tr -d '[:space:]')
                if [ "$(ls -1 | grep "^RAxML" | wc -l)" -ne 0 ]
		then
			rm RAxML*
		fi
        	raxml -f a -T 2 -m PROTGAMMA$RAxMLmodel         	-p 12345 -x 12345 -# 100         	-s ../../per_gene/EOG091G01VH/ALICUT_EOG091G01VH.clustalo.fasta -n EOG091G01VH.clustalo.aln.ALICUT.$RAxMLmodel 		1> ../../per_gene/EOG091G01VH/infer_single_ML.stdout.txt 2> ../../per_gene/EOG091G01VH/infer_single_ML.stderr.txt
	else
		echo "fasta file per_gene/EOG091G01VH/ALICUT_EOG091G01VH.clustalo.fasta contains fewer than 5 sequences - skipped" > ../../per_gene/EOG091G01VH/infer_single_ML.stdout.txt
		touch raxml.skipped
	fi
        touch ../../per_gene/EOG091G01VH/EOG091G01VH.raxml.done
        [0m
[33m
        cd per_gene/EOG091G0N0A
	count=$(cat ../../per_gene/EOG091G0N0A/ALICUT_EOG091G0N0A.clustalo.fasta | grep ">" | wc -l)
	if [ "$count" -gt 5 ]
        then
		RAxMLmodel=$(cat ../../per_gene/EOG091G0N0A/EOG091G0N0A.best_model | grep "Best" | cut -d ":" -f 2 | tr -d '[:space:]')
                if [ "$(ls -1 | grep "^RAxML" | wc -l)" -ne 0 ]
		then
			rm RAxML*
		fi
        	raxml -f a -T 2 -m PROTGAMMA$RAxMLmodel         	-p 12345 -x 12345 -# 100         	-s ../../per_gene/EOG091G0N0A/ALICUT_EOG091G0N0A.clustalo.fasta -n EOG091G0N0A.clustalo.aln.ALICUT.$RAxMLmodel 		1> ../../per_gene/EOG091G0N0A/infer_single_ML.stdout.txt 2> ../../per_gene/EOG091G0N0A/infer_single_ML.stderr.txt
	else
		echo "fasta file per_gene/EOG091G0N0A/ALICUT_EOG091G0N0A.clustalo.fasta contains fewer than 5 sequences - skipped" > ../../per_gene/EOG091G0N0A/infer_single_ML.stdout.txt
		touch raxml.skipped
	fi
        touch ../../per_gene/EOG091G0N0A/EOG091G0N0A.raxml.done
        [0m
[Sun Jul  5 23:09:09 2020]
Finished job 235.
1776 of 3292 steps (54%) done

[Sun Jul  5 23:09:09 2020]
rule get_seqs:
    input: /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ingroup.txt, /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/outgroup.txt
    output: per_gene/EOG091G10IX/EOG091G10IX.ingroup.fasta
    log: per_gene/EOG091G10IX/get_seqs.stdout.txt, per_gene/EOG091G10IX/get_seqs.stderr.txt
    jobid: 2914
    wildcards: BUSCO=EOG091G10IX
    threads: 2


	basedir=$(pwd)
        cd per_gene/EOG091G10IX
        
        bash $basedir/../scripts/fetch_seqs.sh EOG091G10IX /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ingroup.txt /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/outgroup.txt 1> ../../per_gene/EOG091G10IX/get_seqs.stdout.txt 2> ../../per_gene/EOG091G10IX/get_seqs.stderr.txt
	mv EOG091G10IX.fasta $basedir/per_gene/EOG091G10IX/EOG091G10IX.ingroup.fasta
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/72476f9d9a5bd0627b4d721143a21354.simg
[Sun Jul  5 23:09:18 2020]
Finished job 299.
1777 of 3292 steps (54%) done

[Sun Jul  5 23:09:18 2020]
rule get_seqs:
    input: /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ingroup.txt, /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/outgroup.txt
    output: per_gene/EOG091G0CMN/EOG091G0CMN.ingroup.fasta
    log: per_gene/EOG091G0CMN/get_seqs.stdout.txt, per_gene/EOG091G0CMN/get_seqs.stderr.txt
    jobid: 3184
    wildcards: BUSCO=EOG091G0CMN
    threads: 2


	basedir=$(pwd)
        cd per_gene/EOG091G0CMN
        
        bash $basedir/../scripts/fetch_seqs.sh EOG091G0CMN /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ingroup.txt /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/outgroup.txt 1> ../../per_gene/EOG091G0CMN/get_seqs.stdout.txt 2> ../../per_gene/EOG091G0CMN/get_seqs.stderr.txt
	mv EOG091G0CMN.fasta $basedir/per_gene/EOG091G0CMN/EOG091G0CMN.ingroup.fasta
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/72476f9d9a5bd0627b4d721143a21354.simg
[Sun Jul  5 23:09:20 2020]
Finished job 2914.
1778 of 3292 steps (54%) done

[Sun Jul  5 23:09:20 2020]
rule get_outgroups:
    input: per_gene/EOG091G10IX/EOG091G10IX.ingroup.fasta
    output: per_gene/EOG091G10IX/EOG091G10IX.orthodb.fasta, per_gene/EOG091G10IX/EOG091G10IX.outgroup.fasta
    log: per_gene/EOG091G10IX/get_outgroups.stdout.txt, per_gene/EOG091G10IX/get_outgroups.stderr.txt
    jobid: 2915
    wildcards: BUSCO=EOG091G10IX


        #download fastas from Orhtodb for BUSCO id
        for i in {1..5}
        do
             wget "http://www.orthodb.org/fasta?query=EOG091G10IX&level=33208" -O per_gene/EOG091G10IX/EOG091G10IX.orthodb.fasta 1> per_gene/EOG091G10IX/get_outgroups.stdout.txt 2> per_gene/EOG091G10IX/get_outgroups.stderr.txt && break || echo -e "try again ($i)" && sleep 15
        done

	#This is quick an dirty for now and just takes the first protein if there is more than one for an outgroup taxon
        bash ../scripts/download_outgroups.sh taxids.txt per_gene/EOG091G10IX/EOG091G10IX.orthodb.fasta > per_gene/EOG091G10IX/EOG091G10IX.outgroup.fasta
        
[Sun Jul  5 23:09:21 2020]
Finished job 2915.
1779 of 3292 steps (54%) done

[Sun Jul  5 23:09:21 2020]
rule join_groups:
    input: per_gene/EOG091G10IX/EOG091G10IX.ingroup.fasta, per_gene/EOG091G10IX/EOG091G10IX.outgroup.fasta
    output: per_gene/EOG091G10IX/EOG091G10IX.fasta
    jobid: 2281
    wildcards: BUSCO=EOG091G10IX


        cat per_gene/EOG091G10IX/EOG091G10IX.ingroup.fasta per_gene/EOG091G10IX/EOG091G10IX.outgroup.fasta > per_gene/EOG091G10IX/EOG091G10IX.fasta
        
[Sun Jul  5 23:09:21 2020]
Finished job 2281.
1780 of 3292 steps (54%) done

[Sun Jul  5 23:09:21 2020]
rule MSA:
    input: per_gene/EOG091G10IX/EOG091G10IX.fasta
    output: per_gene/EOG091G10IX/EOG091G10IX.clustalo.fasta
    log: per_gene/EOG091G10IX/MSA.stdout.txt, per_gene/EOG091G10IX/MSA.stderr.txt
    jobid: 1682
    wildcards: BUSCO=EOG091G10IX
    threads: 2


        clustalo -i per_gene/EOG091G10IX/EOG091G10IX.fasta -o per_gene/EOG091G10IX/EOG091G10IX.clustalo.fasta --threads=2 1> per_gene/EOG091G10IX/MSA.stdout.txt 2> per_gene/EOG091G10IX/MSA.stderr.txt
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/d68c9691725a7401923680874285c430.simg
[Sun Jul  5 23:09:22 2020]
Finished job 1682.
1781 of 3292 steps (54%) done

[Sun Jul  5 23:09:22 2020]
rule score_and_cut:
    input: per_gene/EOG091G10IX/EOG091G10IX.clustalo.fasta
    output: per_gene/EOG091G10IX/ALICUT_EOG091G10IX.clustalo.fasta
    jobid: 859
    wildcards: BUSCO=EOG091G10IX
    threads: 2


        cd per_gene/EOG091G10IX
        Aliscore.pl -N -r 200000000000000000 -i ../../per_gene/EOG091G10IX/EOG091G10IX.clustalo.fasta &> aliscore.log
        ALICUT.pl -s &> alicut.log
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/63c88c27a0fa300f57066b0ef65fefcb.simg
[Sun Jul  5 23:09:29 2020]
Finished job 546.
1782 of 3292 steps (54%) done

[Sun Jul  5 23:09:29 2020]
rule infer_single_ML:
    input: per_gene/EOG091G0990/EOG091G0990.best_model, per_gene/EOG091G0990/ALICUT_EOG091G0990.clustalo.fasta
    output: per_gene/EOG091G0990/EOG091G0990.raxml.done
    log: per_gene/EOG091G0990/infer_single_ML.stdout.txt, per_gene/EOG091G0990/infer_single_ML.stderr.txt
    jobid: 67
    wildcards: BUSCO=EOG091G0990
    threads: 2


        cd per_gene/EOG091G0990
	count=$(cat ../../per_gene/EOG091G0990/ALICUT_EOG091G0990.clustalo.fasta | grep ">" | wc -l)
	if [ "$count" -gt 5 ]
        then
		RAxMLmodel=$(cat ../../per_gene/EOG091G0990/EOG091G0990.best_model | grep "Best" | cut -d ":" -f 2 | tr -d '[:space:]')
                if [ "$(ls -1 | grep "^RAxML" | wc -l)" -ne 0 ]
		then
			rm RAxML*
		fi
        	raxml -f a -T 2 -m PROTGAMMA$RAxMLmodel         	-p 12345 -x 12345 -# 100         	-s ../../per_gene/EOG091G0990/ALICUT_EOG091G0990.clustalo.fasta -n EOG091G0990.clustalo.aln.ALICUT.$RAxMLmodel 		1> ../../per_gene/EOG091G0990/infer_single_ML.stdout.txt 2> ../../per_gene/EOG091G0990/infer_single_ML.stderr.txt
	else
		echo "fasta file per_gene/EOG091G0990/ALICUT_EOG091G0990.clustalo.fasta contains fewer than 5 sequences - skipped" > ../../per_gene/EOG091G0990/infer_single_ML.stdout.txt
		touch raxml.skipped
	fi
        touch ../../per_gene/EOG091G0990/EOG091G0990.raxml.done
        
[Sun Jul  5 23:09:30 2020]
Finished job 3184.
1783 of 3292 steps (54%) done

[Sun Jul  5 23:09:30 2020]
rule get_outgroups:
    input: per_gene/EOG091G0CMN/EOG091G0CMN.ingroup.fasta
    output: per_gene/EOG091G0CMN/EOG091G0CMN.orthodb.fasta, per_gene/EOG091G0CMN/EOG091G0CMN.outgroup.fasta
    log: per_gene/EOG091G0CMN/get_outgroups.stdout.txt, per_gene/EOG091G0CMN/get_outgroups.stderr.txt
    jobid: 3185
    wildcards: BUSCO=EOG091G0CMN


        #download fastas from Orhtodb for BUSCO id
        for i in {1..5}
        do
             wget "http://www.orthodb.org/fasta?query=EOG091G0CMN&level=33208" -O per_gene/EOG091G0CMN/EOG091G0CMN.orthodb.fasta 1> per_gene/EOG091G0CMN/get_outgroups.stdout.txt 2> per_gene/EOG091G0CMN/get_outgroups.stderr.txt && break || echo -e "try again ($i)" && sleep 15
        done

	#This is quick an dirty for now and just takes the first protein if there is more than one for an outgroup taxon
        bash ../scripts/download_outgroups.sh taxids.txt per_gene/EOG091G0CMN/EOG091G0CMN.orthodb.fasta > per_gene/EOG091G0CMN/EOG091G0CMN.outgroup.fasta
        
[33mJob counts:
	count	jobs
	1	infer_single_ML
	1[0m
[33m
        cd per_gene/EOG091G0990
	count=$(cat ../../per_gene/EOG091G0990/ALICUT_EOG091G0990.clustalo.fasta | grep ">" | wc -l)
	if [ "$count" -gt 5 ]
        then
		RAxMLmodel=$(cat ../../per_gene/EOG091G0990/EOG091G0990.best_model | grep "Best" | cut -d ":" -f 2 | tr -d '[:space:]')
                if [ "$(ls -1 | grep "^RAxML" | wc -l)" -ne 0 ]
		then
			rm RAxML*
		fi
        	raxml -f a -T 2 -m PROTGAMMA$RAxMLmodel         	-p 12345 -x 12345 -# 100         	-s ../../per_gene/EOG091G0990/ALICUT_EOG091G0990.clustalo.fasta -n EOG091G0990.clustalo.aln.ALICUT.$RAxMLmodel 		1> ../../per_gene/EOG091G0990/infer_single_ML.stdout.txt 2> ../../per_gene/EOG091G0990/infer_single_ML.stderr.txt
	else
		echo "fasta file per_gene/EOG091G0990/ALICUT_EOG091G0990.clustalo.fasta contains fewer than 5 sequences - skipped" > ../../per_gene/EOG091G0990/infer_single_ML.stdout.txt
		touch raxml.skipped
	fi
        touch ../../per_gene/EOG091G0990/EOG091G0990.raxml.done
        [0m
[Sun Jul  5 23:09:31 2020]
Finished job 3185.
1784 of 3292 steps (54%) done

[Sun Jul  5 23:09:31 2020]
rule join_groups:
    input: per_gene/EOG091G0CMN/EOG091G0CMN.ingroup.fasta, per_gene/EOG091G0CMN/EOG091G0CMN.outgroup.fasta
    output: per_gene/EOG091G0CMN/EOG091G0CMN.fasta
    jobid: 2416
    wildcards: BUSCO=EOG091G0CMN


        cat per_gene/EOG091G0CMN/EOG091G0CMN.ingroup.fasta per_gene/EOG091G0CMN/EOG091G0CMN.outgroup.fasta > per_gene/EOG091G0CMN/EOG091G0CMN.fasta
        
[Sun Jul  5 23:09:31 2020]
Finished job 2416.
1785 of 3292 steps (54%) done

[Sun Jul  5 23:09:31 2020]
rule MSA:
    input: per_gene/EOG091G0CMN/EOG091G0CMN.fasta
    output: per_gene/EOG091G0CMN/EOG091G0CMN.clustalo.fasta
    log: per_gene/EOG091G0CMN/MSA.stdout.txt, per_gene/EOG091G0CMN/MSA.stderr.txt
    jobid: 1952
    wildcards: BUSCO=EOG091G0CMN
    threads: 2


        clustalo -i per_gene/EOG091G0CMN/EOG091G0CMN.fasta -o per_gene/EOG091G0CMN/EOG091G0CMN.clustalo.fasta --threads=2 1> per_gene/EOG091G0CMN/MSA.stdout.txt 2> per_gene/EOG091G0CMN/MSA.stderr.txt
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/d68c9691725a7401923680874285c430.simg
[Sun Jul  5 23:09:31 2020]
Finished job 859.
1786 of 3292 steps (54%) done

[Sun Jul  5 23:09:31 2020]
rule remove_empty:
    input: per_gene/EOG091G10IX/ALICUT_EOG091G10IX.clustalo.fasta
    output: per_gene/EOG091G10IX/empty_check.done
    jobid: 1681
    wildcards: BUSCO=EOG091G10IX


         if [ "$(cat per_gene/EOG091G10IX/ALICUT_EOG091G10IX.clustalo.fasta | grep -v ">" | sed 's/-//g' | grep "^$" | wc -l)" -gt 0 ]
         then
              cp per_gene/EOG091G10IX/ALICUT_EOG091G10IX.clustalo.fasta per_gene/EOG091G10IX/ALICUT_EOG091G10IX.clustalo.fasta.backup
              bash ../scripts/remove_empty.sh per_gene/EOG091G10IX/ALICUT_EOG091G10IX.clustalo.fasta.backup > per_gene/EOG091G10IX/ALICUT_EOG091G10IX.clustalo.fasta
         fi
         touch per_gene/EOG091G10IX/empty_check.done
         
[Sun Jul  5 23:09:31 2020]
Finished job 1681.
1787 of 3292 steps (54%) done

[Sun Jul  5 23:09:31 2020]
rule find_best_model:
    input: per_gene/EOG091G10IX/ALICUT_EOG091G10IX.clustalo.fasta, per_gene/EOG091G10IX/empty_check.done
    output: per_gene/EOG091G10IX/EOG091G10IX.best_model
    log: per_gene/EOG091G10IX/find_best_model.stderr.txt
    jobid: 858
    wildcards: BUSCO=EOG091G10IX
    threads: 2


        cd per_gene/EOG091G10IX
        if [ ! -d find_best_model ]
        then
            mkdir find_best_model
        fi
        cd find_best_model
        ln -s ../../../per_gene/EOG091G10IX/ALICUT_EOG091G10IX.clustalo.fasta EOG091G10IX.fasta
        ProteinModelSelection.pl EOG091G10IX.fasta 1> ../../../per_gene/EOG091G10IX/EOG091G10IX.best_model 2> ../../../per_gene/EOG091G10IX/find_best_model.stderr.txt
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/c0c09ee657b1e27f2c5687e0e9aa8d70.simg
[Sun Jul  5 23:09:32 2020]
Finished job 1952.
1788 of 3292 steps (54%) done

[Sun Jul  5 23:09:32 2020]
rule score_and_cut:
    input: per_gene/EOG091G0CMN/EOG091G0CMN.clustalo.fasta
    output: per_gene/EOG091G0CMN/ALICUT_EOG091G0CMN.clustalo.fasta
    jobid: 1129
    wildcards: BUSCO=EOG091G0CMN
    threads: 2


        cd per_gene/EOG091G0CMN
        Aliscore.pl -N -r 200000000000000000 -i ../../per_gene/EOG091G0CMN/EOG091G0CMN.clustalo.fasta &> aliscore.log
        ALICUT.pl -s &> alicut.log
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/63c88c27a0fa300f57066b0ef65fefcb.simg
[Sun Jul  5 23:09:43 2020]
Finished job 1129.
1789 of 3292 steps (54%) done

[Sun Jul  5 23:09:43 2020]
rule remove_empty:
    input: per_gene/EOG091G0CMN/ALICUT_EOG091G0CMN.clustalo.fasta
    output: per_gene/EOG091G0CMN/empty_check.done
    jobid: 1951
    wildcards: BUSCO=EOG091G0CMN


         if [ "$(cat per_gene/EOG091G0CMN/ALICUT_EOG091G0CMN.clustalo.fasta | grep -v ">" | sed 's/-//g' | grep "^$" | wc -l)" -gt 0 ]
         then
              cp per_gene/EOG091G0CMN/ALICUT_EOG091G0CMN.clustalo.fasta per_gene/EOG091G0CMN/ALICUT_EOG091G0CMN.clustalo.fasta.backup
              bash ../scripts/remove_empty.sh per_gene/EOG091G0CMN/ALICUT_EOG091G0CMN.clustalo.fasta.backup > per_gene/EOG091G0CMN/ALICUT_EOG091G0CMN.clustalo.fasta
         fi
         touch per_gene/EOG091G0CMN/empty_check.done
         
[Sun Jul  5 23:09:43 2020]
Finished job 1951.
1790 of 3292 steps (54%) done

[Sun Jul  5 23:09:43 2020]
rule find_best_model:
    input: per_gene/EOG091G0CMN/ALICUT_EOG091G0CMN.clustalo.fasta, per_gene/EOG091G0CMN/empty_check.done
    output: per_gene/EOG091G0CMN/EOG091G0CMN.best_model
    log: per_gene/EOG091G0CMN/find_best_model.stderr.txt
    jobid: 1128
    wildcards: BUSCO=EOG091G0CMN
    threads: 2


        cd per_gene/EOG091G0CMN
        if [ ! -d find_best_model ]
        then
            mkdir find_best_model
        fi
        cd find_best_model
        ln -s ../../../per_gene/EOG091G0CMN/ALICUT_EOG091G0CMN.clustalo.fasta EOG091G0CMN.fasta
        ProteinModelSelection.pl EOG091G0CMN.fasta 1> ../../../per_gene/EOG091G0CMN/EOG091G0CMN.best_model 2> ../../../per_gene/EOG091G0CMN/find_best_model.stderr.txt
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/c0c09ee657b1e27f2c5687e0e9aa8d70.simg
[Sun Jul  5 23:09:50 2020]
Finished job 172.
1791 of 3292 steps (54%) done

[Sun Jul  5 23:09:50 2020]
rule get_seqs:
    input: /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ingroup.txt, /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/outgroup.txt
    output: per_gene/EOG091G0GDF/EOG091G0GDF.ingroup.fasta
    log: per_gene/EOG091G0GDF/get_seqs.stdout.txt, per_gene/EOG091G0GDF/get_seqs.stderr.txt
    jobid: 2688
    wildcards: BUSCO=EOG091G0GDF
    threads: 2


	basedir=$(pwd)
        cd per_gene/EOG091G0GDF
        
        bash $basedir/../scripts/fetch_seqs.sh EOG091G0GDF /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ingroup.txt /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/outgroup.txt 1> ../../per_gene/EOG091G0GDF/get_seqs.stdout.txt 2> ../../per_gene/EOG091G0GDF/get_seqs.stderr.txt
	mv EOG091G0GDF.fasta $basedir/per_gene/EOG091G0GDF/EOG091G0GDF.ingroup.fasta
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/72476f9d9a5bd0627b4d721143a21354.simg
[Sun Jul  5 23:09:53 2020]
Finished job 858.
1792 of 3292 steps (54%) done

[Sun Jul  5 23:09:53 2020]
rule infer_single_ML:
    input: per_gene/EOG091G10IX/EOG091G10IX.best_model, per_gene/EOG091G10IX/ALICUT_EOG091G10IX.clustalo.fasta
    output: per_gene/EOG091G10IX/EOG091G10IX.raxml.done
    log: per_gene/EOG091G10IX/infer_single_ML.stdout.txt, per_gene/EOG091G10IX/infer_single_ML.stderr.txt
    jobid: 223
    wildcards: BUSCO=EOG091G10IX
    threads: 2


        cd per_gene/EOG091G10IX
	count=$(cat ../../per_gene/EOG091G10IX/ALICUT_EOG091G10IX.clustalo.fasta | grep ">" | wc -l)
	if [ "$count" -gt 5 ]
        then
		RAxMLmodel=$(cat ../../per_gene/EOG091G10IX/EOG091G10IX.best_model | grep "Best" | cut -d ":" -f 2 | tr -d '[:space:]')
                if [ "$(ls -1 | grep "^RAxML" | wc -l)" -ne 0 ]
		then
			rm RAxML*
		fi
        	raxml -f a -T 2 -m PROTGAMMA$RAxMLmodel         	-p 12345 -x 12345 -# 100         	-s ../../per_gene/EOG091G10IX/ALICUT_EOG091G10IX.clustalo.fasta -n EOG091G10IX.clustalo.aln.ALICUT.$RAxMLmodel 		1> ../../per_gene/EOG091G10IX/infer_single_ML.stdout.txt 2> ../../per_gene/EOG091G10IX/infer_single_ML.stderr.txt
	else
		echo "fasta file per_gene/EOG091G10IX/ALICUT_EOG091G10IX.clustalo.fasta contains fewer than 5 sequences - skipped" > ../../per_gene/EOG091G10IX/infer_single_ML.stdout.txt
		touch raxml.skipped
	fi
        touch ../../per_gene/EOG091G10IX/EOG091G10IX.raxml.done
        
[33mJob counts:
	count	jobs
	1	infer_single_ML
	1[0m
[33m
        cd per_gene/EOG091G10IX
	count=$(cat ../../per_gene/EOG091G10IX/ALICUT_EOG091G10IX.clustalo.fasta | grep ">" | wc -l)
	if [ "$count" -gt 5 ]
        then
		RAxMLmodel=$(cat ../../per_gene/EOG091G10IX/EOG091G10IX.best_model | grep "Best" | cut -d ":" -f 2 | tr -d '[:space:]')
                if [ "$(ls -1 | grep "^RAxML" | wc -l)" -ne 0 ]
		then
			rm RAxML*
		fi
        	raxml -f a -T 2 -m PROTGAMMA$RAxMLmodel         	-p 12345 -x 12345 -# 100         	-s ../../per_gene/EOG091G10IX/ALICUT_EOG091G10IX.clustalo.fasta -n EOG091G10IX.clustalo.aln.ALICUT.$RAxMLmodel 		1> ../../per_gene/EOG091G10IX/infer_single_ML.stdout.txt 2> ../../per_gene/EOG091G10IX/infer_single_ML.stderr.txt
	else
		echo "fasta file per_gene/EOG091G10IX/ALICUT_EOG091G10IX.clustalo.fasta contains fewer than 5 sequences - skipped" > ../../per_gene/EOG091G10IX/infer_single_ML.stdout.txt
		touch raxml.skipped
	fi
        touch ../../per_gene/EOG091G10IX/EOG091G10IX.raxml.done
        [0m
[Sun Jul  5 23:10:04 2020]
Finished job 2688.
1793 of 3292 steps (54%) done

[Sun Jul  5 23:10:04 2020]
rule get_outgroups:
    input: per_gene/EOG091G0GDF/EOG091G0GDF.ingroup.fasta
    output: per_gene/EOG091G0GDF/EOG091G0GDF.orthodb.fasta, per_gene/EOG091G0GDF/EOG091G0GDF.outgroup.fasta
    log: per_gene/EOG091G0GDF/get_outgroups.stdout.txt, per_gene/EOG091G0GDF/get_outgroups.stderr.txt
    jobid: 2689
    wildcards: BUSCO=EOG091G0GDF


        #download fastas from Orhtodb for BUSCO id
        for i in {1..5}
        do
             wget "http://www.orthodb.org/fasta?query=EOG091G0GDF&level=33208" -O per_gene/EOG091G0GDF/EOG091G0GDF.orthodb.fasta 1> per_gene/EOG091G0GDF/get_outgroups.stdout.txt 2> per_gene/EOG091G0GDF/get_outgroups.stderr.txt && break || echo -e "try again ($i)" && sleep 15
        done

	#This is quick an dirty for now and just takes the first protein if there is more than one for an outgroup taxon
        bash ../scripts/download_outgroups.sh taxids.txt per_gene/EOG091G0GDF/EOG091G0GDF.orthodb.fasta > per_gene/EOG091G0GDF/EOG091G0GDF.outgroup.fasta
        
[Sun Jul  5 23:10:05 2020]
Finished job 2689.
1794 of 3292 steps (54%) done

[Sun Jul  5 23:10:05 2020]
rule join_groups:
    input: per_gene/EOG091G0GDF/EOG091G0GDF.ingroup.fasta, per_gene/EOG091G0GDF/EOG091G0GDF.outgroup.fasta
    output: per_gene/EOG091G0GDF/EOG091G0GDF.fasta
    jobid: 2168
    wildcards: BUSCO=EOG091G0GDF


        cat per_gene/EOG091G0GDF/EOG091G0GDF.ingroup.fasta per_gene/EOG091G0GDF/EOG091G0GDF.outgroup.fasta > per_gene/EOG091G0GDF/EOG091G0GDF.fasta
        
[Sun Jul  5 23:10:05 2020]
Finished job 2168.
1795 of 3292 steps (55%) done

[Sun Jul  5 23:10:05 2020]
rule MSA:
    input: per_gene/EOG091G0GDF/EOG091G0GDF.fasta
    output: per_gene/EOG091G0GDF/EOG091G0GDF.clustalo.fasta
    log: per_gene/EOG091G0GDF/MSA.stdout.txt, per_gene/EOG091G0GDF/MSA.stderr.txt
    jobid: 1456
    wildcards: BUSCO=EOG091G0GDF
    threads: 2


        clustalo -i per_gene/EOG091G0GDF/EOG091G0GDF.fasta -o per_gene/EOG091G0GDF/EOG091G0GDF.clustalo.fasta --threads=2 1> per_gene/EOG091G0GDF/MSA.stdout.txt 2> per_gene/EOG091G0GDF/MSA.stderr.txt
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/d68c9691725a7401923680874285c430.simg
[Sun Jul  5 23:10:06 2020]
Finished job 1456.
1796 of 3292 steps (55%) done

[Sun Jul  5 23:10:06 2020]
rule score_and_cut:
    input: per_gene/EOG091G0GDF/EOG091G0GDF.clustalo.fasta
    output: per_gene/EOG091G0GDF/ALICUT_EOG091G0GDF.clustalo.fasta
    jobid: 633
    wildcards: BUSCO=EOG091G0GDF
    threads: 2


        cd per_gene/EOG091G0GDF
        Aliscore.pl -N -r 200000000000000000 -i ../../per_gene/EOG091G0GDF/EOG091G0GDF.clustalo.fasta &> aliscore.log
        ALICUT.pl -s &> alicut.log
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/63c88c27a0fa300f57066b0ef65fefcb.simg
[Sun Jul  5 23:10:07 2020]
Finished job 257.
1797 of 3292 steps (55%) done

[Sun Jul  5 23:10:07 2020]
rule get_seqs:
    input: /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ingroup.txt, /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/outgroup.txt
    output: per_gene/EOG091G0N0R/EOG091G0N0R.ingroup.fasta
    log: per_gene/EOG091G0N0R/get_seqs.stdout.txt, per_gene/EOG091G0N0R/get_seqs.stderr.txt
    jobid: 2782
    wildcards: BUSCO=EOG091G0N0R
    threads: 2


	basedir=$(pwd)
        cd per_gene/EOG091G0N0R
        
        bash $basedir/../scripts/fetch_seqs.sh EOG091G0N0R /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ingroup.txt /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/outgroup.txt 1> ../../per_gene/EOG091G0N0R/get_seqs.stdout.txt 2> ../../per_gene/EOG091G0N0R/get_seqs.stderr.txt
	mv EOG091G0N0R.fasta $basedir/per_gene/EOG091G0N0R/EOG091G0N0R.ingroup.fasta
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/72476f9d9a5bd0627b4d721143a21354.simg
[Sun Jul  5 23:10:07 2020]
Finished job 1128.
1798 of 3292 steps (55%) done

[Sun Jul  5 23:10:07 2020]
rule infer_single_ML:
    input: per_gene/EOG091G0CMN/EOG091G0CMN.best_model, per_gene/EOG091G0CMN/ALICUT_EOG091G0CMN.clustalo.fasta
    output: per_gene/EOG091G0CMN/EOG091G0CMN.raxml.done
    log: per_gene/EOG091G0CMN/infer_single_ML.stdout.txt, per_gene/EOG091G0CMN/infer_single_ML.stderr.txt
    jobid: 358
    wildcards: BUSCO=EOG091G0CMN
    threads: 2


        cd per_gene/EOG091G0CMN
	count=$(cat ../../per_gene/EOG091G0CMN/ALICUT_EOG091G0CMN.clustalo.fasta | grep ">" | wc -l)
	if [ "$count" -gt 5 ]
        then
		RAxMLmodel=$(cat ../../per_gene/EOG091G0CMN/EOG091G0CMN.best_model | grep "Best" | cut -d ":" -f 2 | tr -d '[:space:]')
                if [ "$(ls -1 | grep "^RAxML" | wc -l)" -ne 0 ]
		then
			rm RAxML*
		fi
        	raxml -f a -T 2 -m PROTGAMMA$RAxMLmodel         	-p 12345 -x 12345 -# 100         	-s ../../per_gene/EOG091G0CMN/ALICUT_EOG091G0CMN.clustalo.fasta -n EOG091G0CMN.clustalo.aln.ALICUT.$RAxMLmodel 		1> ../../per_gene/EOG091G0CMN/infer_single_ML.stdout.txt 2> ../../per_gene/EOG091G0CMN/infer_single_ML.stderr.txt
	else
		echo "fasta file per_gene/EOG091G0CMN/ALICUT_EOG091G0CMN.clustalo.fasta contains fewer than 5 sequences - skipped" > ../../per_gene/EOG091G0CMN/infer_single_ML.stdout.txt
		touch raxml.skipped
	fi
        touch ../../per_gene/EOG091G0CMN/EOG091G0CMN.raxml.done
        
[Sun Jul  5 23:10:10 2020]
Finished job 398.
1799 of 3292 steps (55%) done

[Sun Jul  5 23:10:10 2020]
rule get_seqs:
    input: /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ingroup.txt, /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/outgroup.txt
    output: per_gene/EOG091G0VSZ/EOG091G0VSZ.ingroup.fasta
    log: per_gene/EOG091G0VSZ/get_seqs.stdout.txt, per_gene/EOG091G0VSZ/get_seqs.stderr.txt
    jobid: 2880
    wildcards: BUSCO=EOG091G0VSZ
    threads: 2


	basedir=$(pwd)
        cd per_gene/EOG091G0VSZ
        
        bash $basedir/../scripts/fetch_seqs.sh EOG091G0VSZ /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ingroup.txt /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/outgroup.txt 1> ../../per_gene/EOG091G0VSZ/get_seqs.stdout.txt 2> ../../per_gene/EOG091G0VSZ/get_seqs.stderr.txt
	mv EOG091G0VSZ.fasta $basedir/per_gene/EOG091G0VSZ/EOG091G0VSZ.ingroup.fasta
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/72476f9d9a5bd0627b4d721143a21354.simg
[33mJob counts:
	count	jobs
	1	infer_single_ML
	1[0m
[33m
        cd per_gene/EOG091G0CMN
	count=$(cat ../../per_gene/EOG091G0CMN/ALICUT_EOG091G0CMN.clustalo.fasta | grep ">" | wc -l)
	if [ "$count" -gt 5 ]
        then
		RAxMLmodel=$(cat ../../per_gene/EOG091G0CMN/EOG091G0CMN.best_model | grep "Best" | cut -d ":" -f 2 | tr -d '[:space:]')
                if [ "$(ls -1 | grep "^RAxML" | wc -l)" -ne 0 ]
		then
			rm RAxML*
		fi
        	raxml -f a -T 2 -m PROTGAMMA$RAxMLmodel         	-p 12345 -x 12345 -# 100         	-s ../../per_gene/EOG091G0CMN/ALICUT_EOG091G0CMN.clustalo.fasta -n EOG091G0CMN.clustalo.aln.ALICUT.$RAxMLmodel 		1> ../../per_gene/EOG091G0CMN/infer_single_ML.stdout.txt 2> ../../per_gene/EOG091G0CMN/infer_single_ML.stderr.txt
	else
		echo "fasta file per_gene/EOG091G0CMN/ALICUT_EOG091G0CMN.clustalo.fasta contains fewer than 5 sequences - skipped" > ../../per_gene/EOG091G0CMN/infer_single_ML.stdout.txt
		touch raxml.skipped
	fi
        touch ../../per_gene/EOG091G0CMN/EOG091G0CMN.raxml.done
        [0m
[Sun Jul  5 23:10:16 2020]
Finished job 633.
1800 of 3292 steps (55%) done

[Sun Jul  5 23:10:16 2020]
rule remove_empty:
    input: per_gene/EOG091G0GDF/ALICUT_EOG091G0GDF.clustalo.fasta
    output: per_gene/EOG091G0GDF/empty_check.done
    jobid: 1455
    wildcards: BUSCO=EOG091G0GDF


         if [ "$(cat per_gene/EOG091G0GDF/ALICUT_EOG091G0GDF.clustalo.fasta | grep -v ">" | sed 's/-//g' | grep "^$" | wc -l)" -gt 0 ]
         then
              cp per_gene/EOG091G0GDF/ALICUT_EOG091G0GDF.clustalo.fasta per_gene/EOG091G0GDF/ALICUT_EOG091G0GDF.clustalo.fasta.backup
              bash ../scripts/remove_empty.sh per_gene/EOG091G0GDF/ALICUT_EOG091G0GDF.clustalo.fasta.backup > per_gene/EOG091G0GDF/ALICUT_EOG091G0GDF.clustalo.fasta
         fi
         touch per_gene/EOG091G0GDF/empty_check.done
         
[Sun Jul  5 23:10:16 2020]
Finished job 1455.
1801 of 3292 steps (55%) done

[Sun Jul  5 23:10:16 2020]
rule find_best_model:
    input: per_gene/EOG091G0GDF/ALICUT_EOG091G0GDF.clustalo.fasta, per_gene/EOG091G0GDF/empty_check.done
    output: per_gene/EOG091G0GDF/EOG091G0GDF.best_model
    log: per_gene/EOG091G0GDF/find_best_model.stderr.txt
    jobid: 632
    wildcards: BUSCO=EOG091G0GDF
    threads: 2


        cd per_gene/EOG091G0GDF
        if [ ! -d find_best_model ]
        then
            mkdir find_best_model
        fi
        cd find_best_model
        ln -s ../../../per_gene/EOG091G0GDF/ALICUT_EOG091G0GDF.clustalo.fasta EOG091G0GDF.fasta
        ProteinModelSelection.pl EOG091G0GDF.fasta 1> ../../../per_gene/EOG091G0GDF/EOG091G0GDF.best_model 2> ../../../per_gene/EOG091G0GDF/find_best_model.stderr.txt
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/c0c09ee657b1e27f2c5687e0e9aa8d70.simg
[Sun Jul  5 23:10:18 2020]
Finished job 2782.
1802 of 3292 steps (55%) done

[Sun Jul  5 23:10:18 2020]
rule get_outgroups:
    input: per_gene/EOG091G0N0R/EOG091G0N0R.ingroup.fasta
    output: per_gene/EOG091G0N0R/EOG091G0N0R.orthodb.fasta, per_gene/EOG091G0N0R/EOG091G0N0R.outgroup.fasta
    log: per_gene/EOG091G0N0R/get_outgroups.stdout.txt, per_gene/EOG091G0N0R/get_outgroups.stderr.txt
    jobid: 2783
    wildcards: BUSCO=EOG091G0N0R


        #download fastas from Orhtodb for BUSCO id
        for i in {1..5}
        do
             wget "http://www.orthodb.org/fasta?query=EOG091G0N0R&level=33208" -O per_gene/EOG091G0N0R/EOG091G0N0R.orthodb.fasta 1> per_gene/EOG091G0N0R/get_outgroups.stdout.txt 2> per_gene/EOG091G0N0R/get_outgroups.stderr.txt && break || echo -e "try again ($i)" && sleep 15
        done

	#This is quick an dirty for now and just takes the first protein if there is more than one for an outgroup taxon
        bash ../scripts/download_outgroups.sh taxids.txt per_gene/EOG091G0N0R/EOG091G0N0R.orthodb.fasta > per_gene/EOG091G0N0R/EOG091G0N0R.outgroup.fasta
        
[Sun Jul  5 23:10:19 2020]
Finished job 2783.
1803 of 3292 steps (55%) done

[Sun Jul  5 23:10:19 2020]
rule join_groups:
    input: per_gene/EOG091G0N0R/EOG091G0N0R.ingroup.fasta, per_gene/EOG091G0N0R/EOG091G0N0R.outgroup.fasta
    output: per_gene/EOG091G0N0R/EOG091G0N0R.fasta
    jobid: 2215
    wildcards: BUSCO=EOG091G0N0R


        cat per_gene/EOG091G0N0R/EOG091G0N0R.ingroup.fasta per_gene/EOG091G0N0R/EOG091G0N0R.outgroup.fasta > per_gene/EOG091G0N0R/EOG091G0N0R.fasta
        
[Sun Jul  5 23:10:19 2020]
Finished job 2215.
1804 of 3292 steps (55%) done

[Sun Jul  5 23:10:19 2020]
rule MSA:
    input: per_gene/EOG091G0N0R/EOG091G0N0R.fasta
    output: per_gene/EOG091G0N0R/EOG091G0N0R.clustalo.fasta
    log: per_gene/EOG091G0N0R/MSA.stdout.txt, per_gene/EOG091G0N0R/MSA.stderr.txt
    jobid: 1550
    wildcards: BUSCO=EOG091G0N0R
    threads: 2


        clustalo -i per_gene/EOG091G0N0R/EOG091G0N0R.fasta -o per_gene/EOG091G0N0R/EOG091G0N0R.clustalo.fasta --threads=2 1> per_gene/EOG091G0N0R/MSA.stdout.txt 2> per_gene/EOG091G0N0R/MSA.stderr.txt
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/d68c9691725a7401923680874285c430.simg
[Sun Jul  5 23:10:20 2020]
Finished job 237.
1805 of 3292 steps (55%) done

[Sun Jul  5 23:10:20 2020]
rule get_seqs:
    input: /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ingroup.txt, /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/outgroup.txt
    output: per_gene/EOG091G08UU/EOG091G08UU.ingroup.fasta
    log: per_gene/EOG091G08UU/get_seqs.stdout.txt, per_gene/EOG091G08UU/get_seqs.stderr.txt
    jobid: 3076
    wildcards: BUSCO=EOG091G08UU
    threads: 2


	basedir=$(pwd)
        cd per_gene/EOG091G08UU
        
        bash $basedir/../scripts/fetch_seqs.sh EOG091G08UU /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ingroup.txt /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/outgroup.txt 1> ../../per_gene/EOG091G08UU/get_seqs.stdout.txt 2> ../../per_gene/EOG091G08UU/get_seqs.stderr.txt
	mv EOG091G08UU.fasta $basedir/per_gene/EOG091G08UU/EOG091G08UU.ingroup.fasta
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/72476f9d9a5bd0627b4d721143a21354.simg
[Sun Jul  5 23:10:21 2020]
Finished job 1550.
1806 of 3292 steps (55%) done

[Sun Jul  5 23:10:21 2020]
rule score_and_cut:
    input: per_gene/EOG091G0N0R/EOG091G0N0R.clustalo.fasta
    output: per_gene/EOG091G0N0R/ALICUT_EOG091G0N0R.clustalo.fasta
    jobid: 727
    wildcards: BUSCO=EOG091G0N0R
    threads: 2


        cd per_gene/EOG091G0N0R
        Aliscore.pl -N -r 200000000000000000 -i ../../per_gene/EOG091G0N0R/EOG091G0N0R.clustalo.fasta &> aliscore.log
        ALICUT.pl -s &> alicut.log
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/63c88c27a0fa300f57066b0ef65fefcb.simg
[Sun Jul  5 23:10:22 2020]
Finished job 2880.
1807 of 3292 steps (55%) done

[Sun Jul  5 23:10:22 2020]
rule get_outgroups:
    input: per_gene/EOG091G0VSZ/EOG091G0VSZ.ingroup.fasta
    output: per_gene/EOG091G0VSZ/EOG091G0VSZ.orthodb.fasta, per_gene/EOG091G0VSZ/EOG091G0VSZ.outgroup.fasta
    log: per_gene/EOG091G0VSZ/get_outgroups.stdout.txt, per_gene/EOG091G0VSZ/get_outgroups.stderr.txt
    jobid: 2881
    wildcards: BUSCO=EOG091G0VSZ


        #download fastas from Orhtodb for BUSCO id
        for i in {1..5}
        do
             wget "http://www.orthodb.org/fasta?query=EOG091G0VSZ&level=33208" -O per_gene/EOG091G0VSZ/EOG091G0VSZ.orthodb.fasta 1> per_gene/EOG091G0VSZ/get_outgroups.stdout.txt 2> per_gene/EOG091G0VSZ/get_outgroups.stderr.txt && break || echo -e "try again ($i)" && sleep 15
        done

	#This is quick an dirty for now and just takes the first protein if there is more than one for an outgroup taxon
        bash ../scripts/download_outgroups.sh taxids.txt per_gene/EOG091G0VSZ/EOG091G0VSZ.orthodb.fasta > per_gene/EOG091G0VSZ/EOG091G0VSZ.outgroup.fasta
        
[Sun Jul  5 23:10:23 2020]
Finished job 2881.
1808 of 3292 steps (55%) done

[Sun Jul  5 23:10:23 2020]
rule join_groups:
    input: per_gene/EOG091G0VSZ/EOG091G0VSZ.ingroup.fasta, per_gene/EOG091G0VSZ/EOG091G0VSZ.outgroup.fasta
    output: per_gene/EOG091G0VSZ/EOG091G0VSZ.fasta
    jobid: 2264
    wildcards: BUSCO=EOG091G0VSZ


        cat per_gene/EOG091G0VSZ/EOG091G0VSZ.ingroup.fasta per_gene/EOG091G0VSZ/EOG091G0VSZ.outgroup.fasta > per_gene/EOG091G0VSZ/EOG091G0VSZ.fasta
        
[Sun Jul  5 23:10:23 2020]
Finished job 2264.
1809 of 3292 steps (55%) done

[Sun Jul  5 23:10:23 2020]
rule MSA:
    input: per_gene/EOG091G0VSZ/EOG091G0VSZ.fasta
    output: per_gene/EOG091G0VSZ/EOG091G0VSZ.clustalo.fasta
    log: per_gene/EOG091G0VSZ/MSA.stdout.txt, per_gene/EOG091G0VSZ/MSA.stderr.txt
    jobid: 1648
    wildcards: BUSCO=EOG091G0VSZ
    threads: 2


        clustalo -i per_gene/EOG091G0VSZ/EOG091G0VSZ.fasta -o per_gene/EOG091G0VSZ/EOG091G0VSZ.clustalo.fasta --threads=2 1> per_gene/EOG091G0VSZ/MSA.stdout.txt 2> per_gene/EOG091G0VSZ/MSA.stderr.txt
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/d68c9691725a7401923680874285c430.simg
[Sun Jul  5 23:10:24 2020]
Finished job 1648.
1810 of 3292 steps (55%) done

[Sun Jul  5 23:10:24 2020]
rule score_and_cut:
    input: per_gene/EOG091G0VSZ/EOG091G0VSZ.clustalo.fasta
    output: per_gene/EOG091G0VSZ/ALICUT_EOG091G0VSZ.clustalo.fasta
    jobid: 825
    wildcards: BUSCO=EOG091G0VSZ
    threads: 2


        cd per_gene/EOG091G0VSZ
        Aliscore.pl -N -r 200000000000000000 -i ../../per_gene/EOG091G0VSZ/EOG091G0VSZ.clustalo.fasta &> aliscore.log
        ALICUT.pl -s &> alicut.log
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/63c88c27a0fa300f57066b0ef65fefcb.simg
[Sun Jul  5 23:10:30 2020]
Finished job 727.
1811 of 3292 steps (55%) done

[Sun Jul  5 23:10:30 2020]
rule remove_empty:
    input: per_gene/EOG091G0N0R/ALICUT_EOG091G0N0R.clustalo.fasta
    output: per_gene/EOG091G0N0R/empty_check.done
    jobid: 1549
    wildcards: BUSCO=EOG091G0N0R


         if [ "$(cat per_gene/EOG091G0N0R/ALICUT_EOG091G0N0R.clustalo.fasta | grep -v ">" | sed 's/-//g' | grep "^$" | wc -l)" -gt 0 ]
         then
              cp per_gene/EOG091G0N0R/ALICUT_EOG091G0N0R.clustalo.fasta per_gene/EOG091G0N0R/ALICUT_EOG091G0N0R.clustalo.fasta.backup
              bash ../scripts/remove_empty.sh per_gene/EOG091G0N0R/ALICUT_EOG091G0N0R.clustalo.fasta.backup > per_gene/EOG091G0N0R/ALICUT_EOG091G0N0R.clustalo.fasta
         fi
         touch per_gene/EOG091G0N0R/empty_check.done
         
[Sun Jul  5 23:10:30 2020]
Finished job 1549.
1812 of 3292 steps (55%) done

[Sun Jul  5 23:10:30 2020]
rule find_best_model:
    input: per_gene/EOG091G0N0R/ALICUT_EOG091G0N0R.clustalo.fasta, per_gene/EOG091G0N0R/empty_check.done
    output: per_gene/EOG091G0N0R/EOG091G0N0R.best_model
    log: per_gene/EOG091G0N0R/find_best_model.stderr.txt
    jobid: 726
    wildcards: BUSCO=EOG091G0N0R
    threads: 2


        cd per_gene/EOG091G0N0R
        if [ ! -d find_best_model ]
        then
            mkdir find_best_model
        fi
        cd find_best_model
        ln -s ../../../per_gene/EOG091G0N0R/ALICUT_EOG091G0N0R.clustalo.fasta EOG091G0N0R.fasta
        ProteinModelSelection.pl EOG091G0N0R.fasta 1> ../../../per_gene/EOG091G0N0R/EOG091G0N0R.best_model 2> ../../../per_gene/EOG091G0N0R/find_best_model.stderr.txt
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/c0c09ee657b1e27f2c5687e0e9aa8d70.simg
[Sun Jul  5 23:10:32 2020]
Finished job 124.
1813 of 3292 steps (55%) done

[Sun Jul  5 23:10:32 2020]
rule get_seqs:
    input: /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ingroup.txt, /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/outgroup.txt
    output: per_gene/EOG091G05SE/EOG091G05SE.ingroup.fasta
    log: per_gene/EOG091G05SE/get_seqs.stdout.txt, per_gene/EOG091G05SE/get_seqs.stderr.txt
    jobid: 3142
    wildcards: BUSCO=EOG091G05SE
    threads: 2


	basedir=$(pwd)
        cd per_gene/EOG091G05SE
        
        bash $basedir/../scripts/fetch_seqs.sh EOG091G05SE /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ingroup.txt /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/outgroup.txt 1> ../../per_gene/EOG091G05SE/get_seqs.stdout.txt 2> ../../per_gene/EOG091G05SE/get_seqs.stderr.txt
	mv EOG091G05SE.fasta $basedir/per_gene/EOG091G05SE/EOG091G05SE.ingroup.fasta
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/72476f9d9a5bd0627b4d721143a21354.simg
[Sun Jul  5 23:10:33 2020]
Finished job 825.
1814 of 3292 steps (55%) done

[Sun Jul  5 23:10:33 2020]
rule remove_empty:
    input: per_gene/EOG091G0VSZ/ALICUT_EOG091G0VSZ.clustalo.fasta
    output: per_gene/EOG091G0VSZ/empty_check.done
    jobid: 1647
    wildcards: BUSCO=EOG091G0VSZ


         if [ "$(cat per_gene/EOG091G0VSZ/ALICUT_EOG091G0VSZ.clustalo.fasta | grep -v ">" | sed 's/-//g' | grep "^$" | wc -l)" -gt 0 ]
         then
              cp per_gene/EOG091G0VSZ/ALICUT_EOG091G0VSZ.clustalo.fasta per_gene/EOG091G0VSZ/ALICUT_EOG091G0VSZ.clustalo.fasta.backup
              bash ../scripts/remove_empty.sh per_gene/EOG091G0VSZ/ALICUT_EOG091G0VSZ.clustalo.fasta.backup > per_gene/EOG091G0VSZ/ALICUT_EOG091G0VSZ.clustalo.fasta
         fi
         touch per_gene/EOG091G0VSZ/empty_check.done
         
[Sun Jul  5 23:10:33 2020]
Finished job 1647.
1815 of 3292 steps (55%) done

[Sun Jul  5 23:10:33 2020]
rule find_best_model:
    input: per_gene/EOG091G0VSZ/ALICUT_EOG091G0VSZ.clustalo.fasta, per_gene/EOG091G0VSZ/empty_check.done
    output: per_gene/EOG091G0VSZ/EOG091G0VSZ.best_model
    log: per_gene/EOG091G0VSZ/find_best_model.stderr.txt
    jobid: 824
    wildcards: BUSCO=EOG091G0VSZ
    threads: 2


        cd per_gene/EOG091G0VSZ
        if [ ! -d find_best_model ]
        then
            mkdir find_best_model
        fi
        cd find_best_model
        ln -s ../../../per_gene/EOG091G0VSZ/ALICUT_EOG091G0VSZ.clustalo.fasta EOG091G0VSZ.fasta
        ProteinModelSelection.pl EOG091G0VSZ.fasta 1> ../../../per_gene/EOG091G0VSZ/EOG091G0VSZ.best_model 2> ../../../per_gene/EOG091G0VSZ/find_best_model.stderr.txt
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/c0c09ee657b1e27f2c5687e0e9aa8d70.simg
[Sun Jul  5 23:10:33 2020]
Finished job 3076.
1816 of 3292 steps (55%) done

[Sun Jul  5 23:10:33 2020]
rule get_outgroups:
    input: per_gene/EOG091G08UU/EOG091G08UU.ingroup.fasta
    output: per_gene/EOG091G08UU/EOG091G08UU.orthodb.fasta, per_gene/EOG091G08UU/EOG091G08UU.outgroup.fasta
    log: per_gene/EOG091G08UU/get_outgroups.stdout.txt, per_gene/EOG091G08UU/get_outgroups.stderr.txt
    jobid: 3077
    wildcards: BUSCO=EOG091G08UU


        #download fastas from Orhtodb for BUSCO id
        for i in {1..5}
        do
             wget "http://www.orthodb.org/fasta?query=EOG091G08UU&level=33208" -O per_gene/EOG091G08UU/EOG091G08UU.orthodb.fasta 1> per_gene/EOG091G08UU/get_outgroups.stdout.txt 2> per_gene/EOG091G08UU/get_outgroups.stderr.txt && break || echo -e "try again ($i)" && sleep 15
        done

	#This is quick an dirty for now and just takes the first protein if there is more than one for an outgroup taxon
        bash ../scripts/download_outgroups.sh taxids.txt per_gene/EOG091G08UU/EOG091G08UU.orthodb.fasta > per_gene/EOG091G08UU/EOG091G08UU.outgroup.fasta
        
[Sun Jul  5 23:10:34 2020]
Finished job 3077.
1817 of 3292 steps (55%) done

[Sun Jul  5 23:10:34 2020]
rule join_groups:
    input: per_gene/EOG091G08UU/EOG091G08UU.ingroup.fasta, per_gene/EOG091G08UU/EOG091G08UU.outgroup.fasta
    output: per_gene/EOG091G08UU/EOG091G08UU.fasta
    jobid: 2362
    wildcards: BUSCO=EOG091G08UU


        cat per_gene/EOG091G08UU/EOG091G08UU.ingroup.fasta per_gene/EOG091G08UU/EOG091G08UU.outgroup.fasta > per_gene/EOG091G08UU/EOG091G08UU.fasta
        
[Sun Jul  5 23:10:34 2020]
Finished job 2362.
1818 of 3292 steps (55%) done

[Sun Jul  5 23:10:34 2020]
rule MSA:
    input: per_gene/EOG091G08UU/EOG091G08UU.fasta
    output: per_gene/EOG091G08UU/EOG091G08UU.clustalo.fasta
    log: per_gene/EOG091G08UU/MSA.stdout.txt, per_gene/EOG091G08UU/MSA.stderr.txt
    jobid: 1844
    wildcards: BUSCO=EOG091G08UU
    threads: 2


        clustalo -i per_gene/EOG091G08UU/EOG091G08UU.fasta -o per_gene/EOG091G08UU/EOG091G08UU.clustalo.fasta --threads=2 1> per_gene/EOG091G08UU/MSA.stdout.txt 2> per_gene/EOG091G08UU/MSA.stderr.txt
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/d68c9691725a7401923680874285c430.simg
[Sun Jul  5 23:10:35 2020]
Finished job 1844.
1819 of 3292 steps (55%) done

[Sun Jul  5 23:10:35 2020]
rule score_and_cut:
    input: per_gene/EOG091G08UU/EOG091G08UU.clustalo.fasta
    output: per_gene/EOG091G08UU/ALICUT_EOG091G08UU.clustalo.fasta
    jobid: 1021
    wildcards: BUSCO=EOG091G08UU
    threads: 2


        cd per_gene/EOG091G08UU
        Aliscore.pl -N -r 200000000000000000 -i ../../per_gene/EOG091G08UU/EOG091G08UU.clustalo.fasta &> aliscore.log
        ALICUT.pl -s &> alicut.log
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/63c88c27a0fa300f57066b0ef65fefcb.simg
[Sun Jul  5 23:10:37 2020]
Finished job 79.
1820 of 3292 steps (55%) done

[Sun Jul  5 23:10:37 2020]
rule get_seqs:
    input: /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ingroup.txt, /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/outgroup.txt
    output: per_gene/EOG091G017G/EOG091G017G.ingroup.fasta
    log: per_gene/EOG091G017G/get_seqs.stdout.txt, per_gene/EOG091G017G/get_seqs.stderr.txt
    jobid: 2478
    wildcards: BUSCO=EOG091G017G
    threads: 2


	basedir=$(pwd)
        cd per_gene/EOG091G017G
        
        bash $basedir/../scripts/fetch_seqs.sh EOG091G017G /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ingroup.txt /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/outgroup.txt 1> ../../per_gene/EOG091G017G/get_seqs.stdout.txt 2> ../../per_gene/EOG091G017G/get_seqs.stderr.txt
	mv EOG091G017G.fasta $basedir/per_gene/EOG091G017G/EOG091G017G.ingroup.fasta
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/72476f9d9a5bd0627b4d721143a21354.simg
[Sun Jul  5 23:10:45 2020]
Finished job 3142.
1821 of 3292 steps (55%) done

[Sun Jul  5 23:10:45 2020]
rule get_outgroups:
    input: per_gene/EOG091G05SE/EOG091G05SE.ingroup.fasta
    output: per_gene/EOG091G05SE/EOG091G05SE.orthodb.fasta, per_gene/EOG091G05SE/EOG091G05SE.outgroup.fasta
    log: per_gene/EOG091G05SE/get_outgroups.stdout.txt, per_gene/EOG091G05SE/get_outgroups.stderr.txt
    jobid: 3143
    wildcards: BUSCO=EOG091G05SE


        #download fastas from Orhtodb for BUSCO id
        for i in {1..5}
        do
             wget "http://www.orthodb.org/fasta?query=EOG091G05SE&level=33208" -O per_gene/EOG091G05SE/EOG091G05SE.orthodb.fasta 1> per_gene/EOG091G05SE/get_outgroups.stdout.txt 2> per_gene/EOG091G05SE/get_outgroups.stderr.txt && break || echo -e "try again ($i)" && sleep 15
        done

	#This is quick an dirty for now and just takes the first protein if there is more than one for an outgroup taxon
        bash ../scripts/download_outgroups.sh taxids.txt per_gene/EOG091G05SE/EOG091G05SE.orthodb.fasta > per_gene/EOG091G05SE/EOG091G05SE.outgroup.fasta
        
[Sun Jul  5 23:10:46 2020]
Finished job 3143.
1822 of 3292 steps (55%) done
[Sun Jul  5 23:10:46 2020]
Finished job 1021.
1823 of 3292 steps (55%) done

[Sun Jul  5 23:10:46 2020]
rule join_groups:
    input: per_gene/EOG091G05SE/EOG091G05SE.ingroup.fasta, per_gene/EOG091G05SE/EOG091G05SE.outgroup.fasta
    output: per_gene/EOG091G05SE/EOG091G05SE.fasta
    jobid: 2395
    wildcards: BUSCO=EOG091G05SE


        cat per_gene/EOG091G05SE/EOG091G05SE.ingroup.fasta per_gene/EOG091G05SE/EOG091G05SE.outgroup.fasta > per_gene/EOG091G05SE/EOG091G05SE.fasta
        

[Sun Jul  5 23:10:46 2020]
rule remove_empty:
    input: per_gene/EOG091G08UU/ALICUT_EOG091G08UU.clustalo.fasta
    output: per_gene/EOG091G08UU/empty_check.done
    jobid: 1843
    wildcards: BUSCO=EOG091G08UU


         if [ "$(cat per_gene/EOG091G08UU/ALICUT_EOG091G08UU.clustalo.fasta | grep -v ">" | sed 's/-//g' | grep "^$" | wc -l)" -gt 0 ]
         then
              cp per_gene/EOG091G08UU/ALICUT_EOG091G08UU.clustalo.fasta per_gene/EOG091G08UU/ALICUT_EOG091G08UU.clustalo.fasta.backup
              bash ../scripts/remove_empty.sh per_gene/EOG091G08UU/ALICUT_EOG091G08UU.clustalo.fasta.backup > per_gene/EOG091G08UU/ALICUT_EOG091G08UU.clustalo.fasta
         fi
         touch per_gene/EOG091G08UU/empty_check.done
         

[Sun Jul  5 23:10:46 2020]
rule get_seqs:
    input: /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ingroup.txt, /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/outgroup.txt
    output: per_gene/EOG091G03XO/EOG091G03XO.ingroup.fasta
    log: per_gene/EOG091G03XO/get_seqs.stdout.txt, per_gene/EOG091G03XO/get_seqs.stderr.txt
    jobid: 3128
    wildcards: BUSCO=EOG091G03XO
    threads: 2


	basedir=$(pwd)
        cd per_gene/EOG091G03XO
        
        bash $basedir/../scripts/fetch_seqs.sh EOG091G03XO /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ingroup.txt /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/outgroup.txt 1> ../../per_gene/EOG091G03XO/get_seqs.stdout.txt 2> ../../per_gene/EOG091G03XO/get_seqs.stderr.txt
	mv EOG091G03XO.fasta $basedir/per_gene/EOG091G03XO/EOG091G03XO.ingroup.fasta
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/72476f9d9a5bd0627b4d721143a21354.simg
[Sun Jul  5 23:10:46 2020]
Finished job 2395.
1824 of 3292 steps (55%) done
[Sun Jul  5 23:10:46 2020]
Finished job 1843.
1825 of 3292 steps (55%) done

[Sun Jul  5 23:10:46 2020]
rule MSA:
    input: per_gene/EOG091G05SE/EOG091G05SE.fasta
    output: per_gene/EOG091G05SE/EOG091G05SE.clustalo.fasta
    log: per_gene/EOG091G05SE/MSA.stdout.txt, per_gene/EOG091G05SE/MSA.stderr.txt
    jobid: 1910
    wildcards: BUSCO=EOG091G05SE
    threads: 2


        clustalo -i per_gene/EOG091G05SE/EOG091G05SE.fasta -o per_gene/EOG091G05SE/EOG091G05SE.clustalo.fasta --threads=2 1> per_gene/EOG091G05SE/MSA.stdout.txt 2> per_gene/EOG091G05SE/MSA.stderr.txt
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/d68c9691725a7401923680874285c430.simg
[Sun Jul  5 23:10:47 2020]
Finished job 1910.
1826 of 3292 steps (55%) done

[Sun Jul  5 23:10:47 2020]
rule score_and_cut:
    input: per_gene/EOG091G05SE/EOG091G05SE.clustalo.fasta
    output: per_gene/EOG091G05SE/ALICUT_EOG091G05SE.clustalo.fasta
    jobid: 1087
    wildcards: BUSCO=EOG091G05SE
    threads: 2


        cd per_gene/EOG091G05SE
        Aliscore.pl -N -r 200000000000000000 -i ../../per_gene/EOG091G05SE/EOG091G05SE.clustalo.fasta &> aliscore.log
        ALICUT.pl -s &> alicut.log
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/63c88c27a0fa300f57066b0ef65fefcb.simg
[Sun Jul  5 23:10:50 2020]
Finished job 357.
1827 of 3292 steps (55%) done

[Sun Jul  5 23:10:50 2020]
rule find_best_model:
    input: per_gene/EOG091G08UU/ALICUT_EOG091G08UU.clustalo.fasta, per_gene/EOG091G08UU/empty_check.done
    output: per_gene/EOG091G08UU/EOG091G08UU.best_model
    log: per_gene/EOG091G08UU/find_best_model.stderr.txt
    jobid: 1020
    wildcards: BUSCO=EOG091G08UU
    threads: 2


        cd per_gene/EOG091G08UU
        if [ ! -d find_best_model ]
        then
            mkdir find_best_model
        fi
        cd find_best_model
        ln -s ../../../per_gene/EOG091G08UU/ALICUT_EOG091G08UU.clustalo.fasta EOG091G08UU.fasta
        ProteinModelSelection.pl EOG091G08UU.fasta 1> ../../../per_gene/EOG091G08UU/EOG091G08UU.best_model 2> ../../../per_gene/EOG091G08UU/find_best_model.stderr.txt
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/c0c09ee657b1e27f2c5687e0e9aa8d70.simg
[Sun Jul  5 23:10:52 2020]
Finished job 632.
1828 of 3292 steps (56%) done

[Sun Jul  5 23:10:52 2020]
rule infer_single_ML:
    input: per_gene/EOG091G0GDF/EOG091G0GDF.best_model, per_gene/EOG091G0GDF/ALICUT_EOG091G0GDF.clustalo.fasta
    output: per_gene/EOG091G0GDF/EOG091G0GDF.raxml.done
    log: per_gene/EOG091G0GDF/infer_single_ML.stdout.txt, per_gene/EOG091G0GDF/infer_single_ML.stderr.txt
    jobid: 110
    wildcards: BUSCO=EOG091G0GDF
    threads: 2


        cd per_gene/EOG091G0GDF
	count=$(cat ../../per_gene/EOG091G0GDF/ALICUT_EOG091G0GDF.clustalo.fasta | grep ">" | wc -l)
	if [ "$count" -gt 5 ]
        then
		RAxMLmodel=$(cat ../../per_gene/EOG091G0GDF/EOG091G0GDF.best_model | grep "Best" | cut -d ":" -f 2 | tr -d '[:space:]')
                if [ "$(ls -1 | grep "^RAxML" | wc -l)" -ne 0 ]
		then
			rm RAxML*
		fi
        	raxml -f a -T 2 -m PROTGAMMA$RAxMLmodel         	-p 12345 -x 12345 -# 100         	-s ../../per_gene/EOG091G0GDF/ALICUT_EOG091G0GDF.clustalo.fasta -n EOG091G0GDF.clustalo.aln.ALICUT.$RAxMLmodel 		1> ../../per_gene/EOG091G0GDF/infer_single_ML.stdout.txt 2> ../../per_gene/EOG091G0GDF/infer_single_ML.stderr.txt
	else
		echo "fasta file per_gene/EOG091G0GDF/ALICUT_EOG091G0GDF.clustalo.fasta contains fewer than 5 sequences - skipped" > ../../per_gene/EOG091G0GDF/infer_single_ML.stdout.txt
		touch raxml.skipped
	fi
        touch ../../per_gene/EOG091G0GDF/EOG091G0GDF.raxml.done
        
[Sun Jul  5 23:10:53 2020]
Finished job 2478.
1829 of 3292 steps (56%) done

[Sun Jul  5 23:10:53 2020]
rule get_outgroups:
    input: per_gene/EOG091G017G/EOG091G017G.ingroup.fasta
    output: per_gene/EOG091G017G/EOG091G017G.orthodb.fasta, per_gene/EOG091G017G/EOG091G017G.outgroup.fasta
    log: per_gene/EOG091G017G/get_outgroups.stdout.txt, per_gene/EOG091G017G/get_outgroups.stderr.txt
    jobid: 2479
    wildcards: BUSCO=EOG091G017G


        #download fastas from Orhtodb for BUSCO id
        for i in {1..5}
        do
             wget "http://www.orthodb.org/fasta?query=EOG091G017G&level=33208" -O per_gene/EOG091G017G/EOG091G017G.orthodb.fasta 1> per_gene/EOG091G017G/get_outgroups.stdout.txt 2> per_gene/EOG091G017G/get_outgroups.stderr.txt && break || echo -e "try again ($i)" && sleep 15
        done

	#This is quick an dirty for now and just takes the first protein if there is more than one for an outgroup taxon
        bash ../scripts/download_outgroups.sh taxids.txt per_gene/EOG091G017G/EOG091G017G.orthodb.fasta > per_gene/EOG091G017G/EOG091G017G.outgroup.fasta
        
[Sun Jul  5 23:10:54 2020]
Finished job 2479.
1830 of 3292 steps (56%) done

[Sun Jul  5 23:10:54 2020]
rule join_groups:
    input: per_gene/EOG091G017G/EOG091G017G.ingroup.fasta, per_gene/EOG091G017G/EOG091G017G.outgroup.fasta
    output: per_gene/EOG091G017G/EOG091G017G.fasta
    jobid: 2063
    wildcards: BUSCO=EOG091G017G


        cat per_gene/EOG091G017G/EOG091G017G.ingroup.fasta per_gene/EOG091G017G/EOG091G017G.outgroup.fasta > per_gene/EOG091G017G/EOG091G017G.fasta
        
[33mJob counts:
	count	jobs
	1	infer_single_ML
	1[0m
[Sun Jul  5 23:10:54 2020]
Finished job 2063.
1831 of 3292 steps (56%) done
[33m
        cd per_gene/EOG091G0GDF
	count=$(cat ../../per_gene/EOG091G0GDF/ALICUT_EOG091G0GDF.clustalo.fasta | grep ">" | wc -l)
	if [ "$count" -gt 5 ]
        then
		RAxMLmodel=$(cat ../../per_gene/EOG091G0GDF/EOG091G0GDF.best_model | grep "Best" | cut -d ":" -f 2 | tr -d '[:space:]')
                if [ "$(ls -1 | grep "^RAxML" | wc -l)" -ne 0 ]
		then
			rm RAxML*
		fi
        	raxml -f a -T 2 -m PROTGAMMA$RAxMLmodel         	-p 12345 -x 12345 -# 100         	-s ../../per_gene/EOG091G0GDF/ALICUT_EOG091G0GDF.clustalo.fasta -n EOG091G0GDF.clustalo.aln.ALICUT.$RAxMLmodel 		1> ../../per_gene/EOG091G0GDF/infer_single_ML.stdout.txt 2> ../../per_gene/EOG091G0GDF/infer_single_ML.stderr.txt
	else
		echo "fasta file per_gene/EOG091G0GDF/ALICUT_EOG091G0GDF.clustalo.fasta contains fewer than 5 sequences - skipped" > ../../per_gene/EOG091G0GDF/infer_single_ML.stdout.txt
		touch raxml.skipped
	fi
        touch ../../per_gene/EOG091G0GDF/EOG091G0GDF.raxml.done
        [0m

[Sun Jul  5 23:10:54 2020]
rule MSA:
    input: per_gene/EOG091G017G/EOG091G017G.fasta
    output: per_gene/EOG091G017G/EOG091G017G.clustalo.fasta
    log: per_gene/EOG091G017G/MSA.stdout.txt, per_gene/EOG091G017G/MSA.stderr.txt
    jobid: 1246
    wildcards: BUSCO=EOG091G017G
    threads: 2


        clustalo -i per_gene/EOG091G017G/EOG091G017G.fasta -o per_gene/EOG091G017G/EOG091G017G.clustalo.fasta --threads=2 1> per_gene/EOG091G017G/MSA.stdout.txt 2> per_gene/EOG091G017G/MSA.stderr.txt
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/d68c9691725a7401923680874285c430.simg
[Sun Jul  5 23:10:55 2020]
Finished job 23.
1832 of 3292 steps (56%) done

[Sun Jul  5 23:10:55 2020]
rule get_seqs:
    input: /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ingroup.txt, /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/outgroup.txt
    output: per_gene/EOG091G0CQ2/EOG091G0CQ2.ingroup.fasta
    log: per_gene/EOG091G0CQ2/get_seqs.stdout.txt, per_gene/EOG091G0CQ2/get_seqs.stderr.txt
    jobid: 3086
    wildcards: BUSCO=EOG091G0CQ2
    threads: 2


	basedir=$(pwd)
        cd per_gene/EOG091G0CQ2
        
        bash $basedir/../scripts/fetch_seqs.sh EOG091G0CQ2 /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ingroup.txt /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/outgroup.txt 1> ../../per_gene/EOG091G0CQ2/get_seqs.stdout.txt 2> ../../per_gene/EOG091G0CQ2/get_seqs.stderr.txt
	mv EOG091G0CQ2.fasta $basedir/per_gene/EOG091G0CQ2/EOG091G0CQ2.ingroup.fasta
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/72476f9d9a5bd0627b4d721143a21354.simg
[Sun Jul  5 23:10:56 2020]
Finished job 726.
1833 of 3292 steps (56%) done

[Sun Jul  5 23:10:56 2020]
rule infer_single_ML:
    input: per_gene/EOG091G0N0R/EOG091G0N0R.best_model, per_gene/EOG091G0N0R/ALICUT_EOG091G0N0R.clustalo.fasta
    output: per_gene/EOG091G0N0R/EOG091G0N0R.raxml.done
    log: per_gene/EOG091G0N0R/infer_single_ML.stdout.txt, per_gene/EOG091G0N0R/infer_single_ML.stderr.txt
    jobid: 157
    wildcards: BUSCO=EOG091G0N0R
    threads: 2


        cd per_gene/EOG091G0N0R
	count=$(cat ../../per_gene/EOG091G0N0R/ALICUT_EOG091G0N0R.clustalo.fasta | grep ">" | wc -l)
	if [ "$count" -gt 5 ]
        then
		RAxMLmodel=$(cat ../../per_gene/EOG091G0N0R/EOG091G0N0R.best_model | grep "Best" | cut -d ":" -f 2 | tr -d '[:space:]')
                if [ "$(ls -1 | grep "^RAxML" | wc -l)" -ne 0 ]
		then
			rm RAxML*
		fi
        	raxml -f a -T 2 -m PROTGAMMA$RAxMLmodel         	-p 12345 -x 12345 -# 100         	-s ../../per_gene/EOG091G0N0R/ALICUT_EOG091G0N0R.clustalo.fasta -n EOG091G0N0R.clustalo.aln.ALICUT.$RAxMLmodel 		1> ../../per_gene/EOG091G0N0R/infer_single_ML.stdout.txt 2> ../../per_gene/EOG091G0N0R/infer_single_ML.stderr.txt
	else
		echo "fasta file per_gene/EOG091G0N0R/ALICUT_EOG091G0N0R.clustalo.fasta contains fewer than 5 sequences - skipped" > ../../per_gene/EOG091G0N0R/infer_single_ML.stdout.txt
		touch raxml.skipped
	fi
        touch ../../per_gene/EOG091G0N0R/EOG091G0N0R.raxml.done
        
[Sun Jul  5 23:10:57 2020]
Finished job 1087.
1834 of 3292 steps (56%) done

[Sun Jul  5 23:10:57 2020]
rule remove_empty:
    input: per_gene/EOG091G05SE/ALICUT_EOG091G05SE.clustalo.fasta
    output: per_gene/EOG091G05SE/empty_check.done
    jobid: 1909
    wildcards: BUSCO=EOG091G05SE


         if [ "$(cat per_gene/EOG091G05SE/ALICUT_EOG091G05SE.clustalo.fasta | grep -v ">" | sed 's/-//g' | grep "^$" | wc -l)" -gt 0 ]
         then
              cp per_gene/EOG091G05SE/ALICUT_EOG091G05SE.clustalo.fasta per_gene/EOG091G05SE/ALICUT_EOG091G05SE.clustalo.fasta.backup
              bash ../scripts/remove_empty.sh per_gene/EOG091G05SE/ALICUT_EOG091G05SE.clustalo.fasta.backup > per_gene/EOG091G05SE/ALICUT_EOG091G05SE.clustalo.fasta
         fi
         touch per_gene/EOG091G05SE/empty_check.done
         
[Sun Jul  5 23:10:57 2020]
Finished job 1909.
1835 of 3292 steps (56%) done

[Sun Jul  5 23:10:57 2020]
rule find_best_model:
    input: per_gene/EOG091G05SE/ALICUT_EOG091G05SE.clustalo.fasta, per_gene/EOG091G05SE/empty_check.done
    output: per_gene/EOG091G05SE/EOG091G05SE.best_model
    log: per_gene/EOG091G05SE/find_best_model.stderr.txt
    jobid: 1086
    wildcards: BUSCO=EOG091G05SE
    threads: 2


        cd per_gene/EOG091G05SE
        if [ ! -d find_best_model ]
        then
            mkdir find_best_model
        fi
        cd find_best_model
        ln -s ../../../per_gene/EOG091G05SE/ALICUT_EOG091G05SE.clustalo.fasta EOG091G05SE.fasta
        ProteinModelSelection.pl EOG091G05SE.fasta 1> ../../../per_gene/EOG091G05SE/EOG091G05SE.best_model 2> ../../../per_gene/EOG091G05SE/find_best_model.stderr.txt
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/c0c09ee657b1e27f2c5687e0e9aa8d70.simg
[33mJob counts:
	count	jobs
	1	infer_single_ML
	1[0m
[33m
        cd per_gene/EOG091G0N0R
	count=$(cat ../../per_gene/EOG091G0N0R/ALICUT_EOG091G0N0R.clustalo.fasta | grep ">" | wc -l)
	if [ "$count" -gt 5 ]
        then
		RAxMLmodel=$(cat ../../per_gene/EOG091G0N0R/EOG091G0N0R.best_model | grep "Best" | cut -d ":" -f 2 | tr -d '[:space:]')
                if [ "$(ls -1 | grep "^RAxML" | wc -l)" -ne 0 ]
		then
			rm RAxML*
		fi
        	raxml -f a -T 2 -m PROTGAMMA$RAxMLmodel         	-p 12345 -x 12345 -# 100         	-s ../../per_gene/EOG091G0N0R/ALICUT_EOG091G0N0R.clustalo.fasta -n EOG091G0N0R.clustalo.aln.ALICUT.$RAxMLmodel 		1> ../../per_gene/EOG091G0N0R/infer_single_ML.stdout.txt 2> ../../per_gene/EOG091G0N0R/infer_single_ML.stderr.txt
	else
		echo "fasta file per_gene/EOG091G0N0R/ALICUT_EOG091G0N0R.clustalo.fasta contains fewer than 5 sequences - skipped" > ../../per_gene/EOG091G0N0R/infer_single_ML.stdout.txt
		touch raxml.skipped
	fi
        touch ../../per_gene/EOG091G0N0R/EOG091G0N0R.raxml.done
        [0m
[Sun Jul  5 23:10:58 2020]
Finished job 1246.
1836 of 3292 steps (56%) done

[Sun Jul  5 23:10:58 2020]
rule score_and_cut:
    input: per_gene/EOG091G017G/EOG091G017G.clustalo.fasta
    output: per_gene/EOG091G017G/ALICUT_EOG091G017G.clustalo.fasta
    jobid: 423
    wildcards: BUSCO=EOG091G017G
    threads: 2


        cd per_gene/EOG091G017G
        Aliscore.pl -N -r 200000000000000000 -i ../../per_gene/EOG091G017G/EOG091G017G.clustalo.fasta &> aliscore.log
        ALICUT.pl -s &> alicut.log
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/63c88c27a0fa300f57066b0ef65fefcb.simg
[Sun Jul  5 23:10:59 2020]
Finished job 824.
1837 of 3292 steps (56%) done

[Sun Jul  5 23:10:59 2020]
rule infer_single_ML:
    input: per_gene/EOG091G0VSZ/EOG091G0VSZ.best_model, per_gene/EOG091G0VSZ/ALICUT_EOG091G0VSZ.clustalo.fasta
    output: per_gene/EOG091G0VSZ/EOG091G0VSZ.raxml.done
    log: per_gene/EOG091G0VSZ/infer_single_ML.stdout.txt, per_gene/EOG091G0VSZ/infer_single_ML.stderr.txt
    jobid: 206
    wildcards: BUSCO=EOG091G0VSZ
    threads: 2


        cd per_gene/EOG091G0VSZ
	count=$(cat ../../per_gene/EOG091G0VSZ/ALICUT_EOG091G0VSZ.clustalo.fasta | grep ">" | wc -l)
	if [ "$count" -gt 5 ]
        then
		RAxMLmodel=$(cat ../../per_gene/EOG091G0VSZ/EOG091G0VSZ.best_model | grep "Best" | cut -d ":" -f 2 | tr -d '[:space:]')
                if [ "$(ls -1 | grep "^RAxML" | wc -l)" -ne 0 ]
		then
			rm RAxML*
		fi
        	raxml -f a -T 2 -m PROTGAMMA$RAxMLmodel         	-p 12345 -x 12345 -# 100         	-s ../../per_gene/EOG091G0VSZ/ALICUT_EOG091G0VSZ.clustalo.fasta -n EOG091G0VSZ.clustalo.aln.ALICUT.$RAxMLmodel 		1> ../../per_gene/EOG091G0VSZ/infer_single_ML.stdout.txt 2> ../../per_gene/EOG091G0VSZ/infer_single_ML.stderr.txt
	else
		echo "fasta file per_gene/EOG091G0VSZ/ALICUT_EOG091G0VSZ.clustalo.fasta contains fewer than 5 sequences - skipped" > ../../per_gene/EOG091G0VSZ/infer_single_ML.stdout.txt
		touch raxml.skipped
	fi
        touch ../../per_gene/EOG091G0VSZ/EOG091G0VSZ.raxml.done
        
[Sun Jul  5 23:10:59 2020]
Finished job 3128.
1838 of 3292 steps (56%) done

[Sun Jul  5 23:10:59 2020]
rule get_outgroups:
    input: per_gene/EOG091G03XO/EOG091G03XO.ingroup.fasta
    output: per_gene/EOG091G03XO/EOG091G03XO.orthodb.fasta, per_gene/EOG091G03XO/EOG091G03XO.outgroup.fasta
    log: per_gene/EOG091G03XO/get_outgroups.stdout.txt, per_gene/EOG091G03XO/get_outgroups.stderr.txt
    jobid: 3129
    wildcards: BUSCO=EOG091G03XO


        #download fastas from Orhtodb for BUSCO id
        for i in {1..5}
        do
             wget "http://www.orthodb.org/fasta?query=EOG091G03XO&level=33208" -O per_gene/EOG091G03XO/EOG091G03XO.orthodb.fasta 1> per_gene/EOG091G03XO/get_outgroups.stdout.txt 2> per_gene/EOG091G03XO/get_outgroups.stderr.txt && break || echo -e "try again ($i)" && sleep 15
        done

	#This is quick an dirty for now and just takes the first protein if there is more than one for an outgroup taxon
        bash ../scripts/download_outgroups.sh taxids.txt per_gene/EOG091G03XO/EOG091G03XO.orthodb.fasta > per_gene/EOG091G03XO/EOG091G03XO.outgroup.fasta
        
[Sun Jul  5 23:11:00 2020]
Finished job 3129.
1839 of 3292 steps (56%) done

[Sun Jul  5 23:11:00 2020]
rule join_groups:
    input: per_gene/EOG091G03XO/EOG091G03XO.ingroup.fasta, per_gene/EOG091G03XO/EOG091G03XO.outgroup.fasta
    output: per_gene/EOG091G03XO/EOG091G03XO.fasta
    jobid: 2388
    wildcards: BUSCO=EOG091G03XO


        cat per_gene/EOG091G03XO/EOG091G03XO.ingroup.fasta per_gene/EOG091G03XO/EOG091G03XO.outgroup.fasta > per_gene/EOG091G03XO/EOG091G03XO.fasta
        
[Sun Jul  5 23:11:00 2020]
Finished job 2388.
1840 of 3292 steps (56%) done

[Sun Jul  5 23:11:00 2020]
rule MSA:
    input: per_gene/EOG091G03XO/EOG091G03XO.fasta
    output: per_gene/EOG091G03XO/EOG091G03XO.clustalo.fasta
    log: per_gene/EOG091G03XO/MSA.stdout.txt, per_gene/EOG091G03XO/MSA.stderr.txt
    jobid: 1896
    wildcards: BUSCO=EOG091G03XO
    threads: 2


        clustalo -i per_gene/EOG091G03XO/EOG091G03XO.fasta -o per_gene/EOG091G03XO/EOG091G03XO.clustalo.fasta --threads=2 1> per_gene/EOG091G03XO/MSA.stdout.txt 2> per_gene/EOG091G03XO/MSA.stderr.txt
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/d68c9691725a7401923680874285c430.simg
[33mJob counts:
	count	jobs
	1	infer_single_ML
	1[0m
[33m
        cd per_gene/EOG091G0VSZ
	count=$(cat ../../per_gene/EOG091G0VSZ/ALICUT_EOG091G0VSZ.clustalo.fasta | grep ">" | wc -l)
	if [ "$count" -gt 5 ]
        then
		RAxMLmodel=$(cat ../../per_gene/EOG091G0VSZ/EOG091G0VSZ.best_model | grep "Best" | cut -d ":" -f 2 | tr -d '[:space:]')
                if [ "$(ls -1 | grep "^RAxML" | wc -l)" -ne 0 ]
		then
			rm RAxML*
		fi
        	raxml -f a -T 2 -m PROTGAMMA$RAxMLmodel         	-p 12345 -x 12345 -# 100         	-s ../../per_gene/EOG091G0VSZ/ALICUT_EOG091G0VSZ.clustalo.fasta -n EOG091G0VSZ.clustalo.aln.ALICUT.$RAxMLmodel 		1> ../../per_gene/EOG091G0VSZ/infer_single_ML.stdout.txt 2> ../../per_gene/EOG091G0VSZ/infer_single_ML.stderr.txt
	else
		echo "fasta file per_gene/EOG091G0VSZ/ALICUT_EOG091G0VSZ.clustalo.fasta contains fewer than 5 sequences - skipped" > ../../per_gene/EOG091G0VSZ/infer_single_ML.stdout.txt
		touch raxml.skipped
	fi
        touch ../../per_gene/EOG091G0VSZ/EOG091G0VSZ.raxml.done
        [0m
[Sun Jul  5 23:11:03 2020]
Finished job 1896.
1841 of 3292 steps (56%) done

[Sun Jul  5 23:11:03 2020]
rule score_and_cut:
    input: per_gene/EOG091G03XO/EOG091G03XO.clustalo.fasta
    output: per_gene/EOG091G03XO/ALICUT_EOG091G03XO.clustalo.fasta
    jobid: 1073
    wildcards: BUSCO=EOG091G03XO
    threads: 2


        cd per_gene/EOG091G03XO
        Aliscore.pl -N -r 200000000000000000 -i ../../per_gene/EOG091G03XO/EOG091G03XO.clustalo.fasta &> aliscore.log
        ALICUT.pl -s &> alicut.log
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/63c88c27a0fa300f57066b0ef65fefcb.simg
[Sun Jul  5 23:11:07 2020]
Finished job 3086.
1842 of 3292 steps (56%) done

[Sun Jul  5 23:11:07 2020]
rule get_outgroups:
    input: per_gene/EOG091G0CQ2/EOG091G0CQ2.ingroup.fasta
    output: per_gene/EOG091G0CQ2/EOG091G0CQ2.orthodb.fasta, per_gene/EOG091G0CQ2/EOG091G0CQ2.outgroup.fasta
    log: per_gene/EOG091G0CQ2/get_outgroups.stdout.txt, per_gene/EOG091G0CQ2/get_outgroups.stderr.txt
    jobid: 3087
    wildcards: BUSCO=EOG091G0CQ2


        #download fastas from Orhtodb for BUSCO id
        for i in {1..5}
        do
             wget "http://www.orthodb.org/fasta?query=EOG091G0CQ2&level=33208" -O per_gene/EOG091G0CQ2/EOG091G0CQ2.orthodb.fasta 1> per_gene/EOG091G0CQ2/get_outgroups.stdout.txt 2> per_gene/EOG091G0CQ2/get_outgroups.stderr.txt && break || echo -e "try again ($i)" && sleep 15
        done

	#This is quick an dirty for now and just takes the first protein if there is more than one for an outgroup taxon
        bash ../scripts/download_outgroups.sh taxids.txt per_gene/EOG091G0CQ2/EOG091G0CQ2.orthodb.fasta > per_gene/EOG091G0CQ2/EOG091G0CQ2.outgroup.fasta
        
[Sun Jul  5 23:11:08 2020]
Finished job 3087.
1843 of 3292 steps (56%) done

[Sun Jul  5 23:11:08 2020]
rule join_groups:
    input: per_gene/EOG091G0CQ2/EOG091G0CQ2.ingroup.fasta, per_gene/EOG091G0CQ2/EOG091G0CQ2.outgroup.fasta
    output: per_gene/EOG091G0CQ2/EOG091G0CQ2.fasta
    jobid: 2367
    wildcards: BUSCO=EOG091G0CQ2


        cat per_gene/EOG091G0CQ2/EOG091G0CQ2.ingroup.fasta per_gene/EOG091G0CQ2/EOG091G0CQ2.outgroup.fasta > per_gene/EOG091G0CQ2/EOG091G0CQ2.fasta
        
[Sun Jul  5 23:11:08 2020]
Finished job 2367.
1844 of 3292 steps (56%) done

[Sun Jul  5 23:11:08 2020]
rule MSA:
    input: per_gene/EOG091G0CQ2/EOG091G0CQ2.fasta
    output: per_gene/EOG091G0CQ2/EOG091G0CQ2.clustalo.fasta
    log: per_gene/EOG091G0CQ2/MSA.stdout.txt, per_gene/EOG091G0CQ2/MSA.stderr.txt
    jobid: 1854
    wildcards: BUSCO=EOG091G0CQ2
    threads: 2


        clustalo -i per_gene/EOG091G0CQ2/EOG091G0CQ2.fasta -o per_gene/EOG091G0CQ2/EOG091G0CQ2.clustalo.fasta --threads=2 1> per_gene/EOG091G0CQ2/MSA.stdout.txt 2> per_gene/EOG091G0CQ2/MSA.stderr.txt
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/d68c9691725a7401923680874285c430.simg
[Sun Jul  5 23:11:09 2020]
Finished job 423.
1845 of 3292 steps (56%) done

[Sun Jul  5 23:11:09 2020]
rule remove_empty:
    input: per_gene/EOG091G017G/ALICUT_EOG091G017G.clustalo.fasta
    output: per_gene/EOG091G017G/empty_check.done
    jobid: 1245
    wildcards: BUSCO=EOG091G017G


         if [ "$(cat per_gene/EOG091G017G/ALICUT_EOG091G017G.clustalo.fasta | grep -v ">" | sed 's/-//g' | grep "^$" | wc -l)" -gt 0 ]
         then
              cp per_gene/EOG091G017G/ALICUT_EOG091G017G.clustalo.fasta per_gene/EOG091G017G/ALICUT_EOG091G017G.clustalo.fasta.backup
              bash ../scripts/remove_empty.sh per_gene/EOG091G017G/ALICUT_EOG091G017G.clustalo.fasta.backup > per_gene/EOG091G017G/ALICUT_EOG091G017G.clustalo.fasta
         fi
         touch per_gene/EOG091G017G/empty_check.done
         
[Sun Jul  5 23:11:09 2020]
Finished job 1245.
1846 of 3292 steps (56%) done

[Sun Jul  5 23:11:09 2020]
rule find_best_model:
    input: per_gene/EOG091G017G/ALICUT_EOG091G017G.clustalo.fasta, per_gene/EOG091G017G/empty_check.done
    output: per_gene/EOG091G017G/EOG091G017G.best_model
    log: per_gene/EOG091G017G/find_best_model.stderr.txt
    jobid: 422
    wildcards: BUSCO=EOG091G017G
    threads: 2


        cd per_gene/EOG091G017G
        if [ ! -d find_best_model ]
        then
            mkdir find_best_model
        fi
        cd find_best_model
        ln -s ../../../per_gene/EOG091G017G/ALICUT_EOG091G017G.clustalo.fasta EOG091G017G.fasta
        ProteinModelSelection.pl EOG091G017G.fasta 1> ../../../per_gene/EOG091G017G/EOG091G017G.best_model 2> ../../../per_gene/EOG091G017G/find_best_model.stderr.txt
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/c0c09ee657b1e27f2c5687e0e9aa8d70.simg
[Sun Jul  5 23:11:09 2020]
Finished job 1854.
1847 of 3292 steps (56%) done

[Sun Jul  5 23:11:09 2020]
rule score_and_cut:
    input: per_gene/EOG091G0CQ2/EOG091G0CQ2.clustalo.fasta
    output: per_gene/EOG091G0CQ2/ALICUT_EOG091G0CQ2.clustalo.fasta
    jobid: 1031
    wildcards: BUSCO=EOG091G0CQ2
    threads: 2


        cd per_gene/EOG091G0CQ2
        Aliscore.pl -N -r 200000000000000000 -i ../../per_gene/EOG091G0CQ2/EOG091G0CQ2.clustalo.fasta &> aliscore.log
        ALICUT.pl -s &> alicut.log
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/63c88c27a0fa300f57066b0ef65fefcb.simg
[Sun Jul  5 23:11:14 2020]
Finished job 1073.
1848 of 3292 steps (56%) done

[Sun Jul  5 23:11:14 2020]
rule remove_empty:
    input: per_gene/EOG091G03XO/ALICUT_EOG091G03XO.clustalo.fasta
    output: per_gene/EOG091G03XO/empty_check.done
    jobid: 1895
    wildcards: BUSCO=EOG091G03XO


         if [ "$(cat per_gene/EOG091G03XO/ALICUT_EOG091G03XO.clustalo.fasta | grep -v ">" | sed 's/-//g' | grep "^$" | wc -l)" -gt 0 ]
         then
              cp per_gene/EOG091G03XO/ALICUT_EOG091G03XO.clustalo.fasta per_gene/EOG091G03XO/ALICUT_EOG091G03XO.clustalo.fasta.backup
              bash ../scripts/remove_empty.sh per_gene/EOG091G03XO/ALICUT_EOG091G03XO.clustalo.fasta.backup > per_gene/EOG091G03XO/ALICUT_EOG091G03XO.clustalo.fasta
         fi
         touch per_gene/EOG091G03XO/empty_check.done
         
[Sun Jul  5 23:11:15 2020]
Finished job 1895.
1849 of 3292 steps (56%) done

[Sun Jul  5 23:11:15 2020]
rule find_best_model:
    input: per_gene/EOG091G03XO/ALICUT_EOG091G03XO.clustalo.fasta, per_gene/EOG091G03XO/empty_check.done
    output: per_gene/EOG091G03XO/EOG091G03XO.best_model
    log: per_gene/EOG091G03XO/find_best_model.stderr.txt
    jobid: 1072
    wildcards: BUSCO=EOG091G03XO
    threads: 2


        cd per_gene/EOG091G03XO
        if [ ! -d find_best_model ]
        then
            mkdir find_best_model
        fi
        cd find_best_model
        ln -s ../../../per_gene/EOG091G03XO/ALICUT_EOG091G03XO.clustalo.fasta EOG091G03XO.fasta
        ProteinModelSelection.pl EOG091G03XO.fasta 1> ../../../per_gene/EOG091G03XO/EOG091G03XO.best_model 2> ../../../per_gene/EOG091G03XO/find_best_model.stderr.txt
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/c0c09ee657b1e27f2c5687e0e9aa8d70.simg
[Sun Jul  5 23:11:19 2020]
Finished job 1031.
1850 of 3292 steps (56%) done

[Sun Jul  5 23:11:19 2020]
rule remove_empty:
    input: per_gene/EOG091G0CQ2/ALICUT_EOG091G0CQ2.clustalo.fasta
    output: per_gene/EOG091G0CQ2/empty_check.done
    jobid: 1853
    wildcards: BUSCO=EOG091G0CQ2


         if [ "$(cat per_gene/EOG091G0CQ2/ALICUT_EOG091G0CQ2.clustalo.fasta | grep -v ">" | sed 's/-//g' | grep "^$" | wc -l)" -gt 0 ]
         then
              cp per_gene/EOG091G0CQ2/ALICUT_EOG091G0CQ2.clustalo.fasta per_gene/EOG091G0CQ2/ALICUT_EOG091G0CQ2.clustalo.fasta.backup
              bash ../scripts/remove_empty.sh per_gene/EOG091G0CQ2/ALICUT_EOG091G0CQ2.clustalo.fasta.backup > per_gene/EOG091G0CQ2/ALICUT_EOG091G0CQ2.clustalo.fasta
         fi
         touch per_gene/EOG091G0CQ2/empty_check.done
         
[Sun Jul  5 23:11:22 2020]
Finished job 1853.
1851 of 3292 steps (56%) done

[Sun Jul  5 23:11:22 2020]
rule find_best_model:
    input: per_gene/EOG091G0CQ2/ALICUT_EOG091G0CQ2.clustalo.fasta, per_gene/EOG091G0CQ2/empty_check.done
    output: per_gene/EOG091G0CQ2/EOG091G0CQ2.best_model
    log: per_gene/EOG091G0CQ2/find_best_model.stderr.txt
    jobid: 1030
    wildcards: BUSCO=EOG091G0CQ2
    threads: 2


        cd per_gene/EOG091G0CQ2
        if [ ! -d find_best_model ]
        then
            mkdir find_best_model
        fi
        cd find_best_model
        ln -s ../../../per_gene/EOG091G0CQ2/ALICUT_EOG091G0CQ2.clustalo.fasta EOG091G0CQ2.fasta
        ProteinModelSelection.pl EOG091G0CQ2.fasta 1> ../../../per_gene/EOG091G0CQ2/EOG091G0CQ2.best_model 2> ../../../per_gene/EOG091G0CQ2/find_best_model.stderr.txt
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/c0c09ee657b1e27f2c5687e0e9aa8d70.simg
[Sun Jul  5 23:11:22 2020]
Finished job 1020.
1852 of 3292 steps (56%) done

[Sun Jul  5 23:11:22 2020]
rule infer_single_ML:
    input: per_gene/EOG091G08UU/EOG091G08UU.best_model, per_gene/EOG091G08UU/ALICUT_EOG091G08UU.clustalo.fasta
    output: per_gene/EOG091G08UU/EOG091G08UU.raxml.done
    log: per_gene/EOG091G08UU/infer_single_ML.stdout.txt, per_gene/EOG091G08UU/infer_single_ML.stderr.txt
    jobid: 304
    wildcards: BUSCO=EOG091G08UU
    threads: 2


        cd per_gene/EOG091G08UU
	count=$(cat ../../per_gene/EOG091G08UU/ALICUT_EOG091G08UU.clustalo.fasta | grep ">" | wc -l)
	if [ "$count" -gt 5 ]
        then
		RAxMLmodel=$(cat ../../per_gene/EOG091G08UU/EOG091G08UU.best_model | grep "Best" | cut -d ":" -f 2 | tr -d '[:space:]')
                if [ "$(ls -1 | grep "^RAxML" | wc -l)" -ne 0 ]
		then
			rm RAxML*
		fi
        	raxml -f a -T 2 -m PROTGAMMA$RAxMLmodel         	-p 12345 -x 12345 -# 100         	-s ../../per_gene/EOG091G08UU/ALICUT_EOG091G08UU.clustalo.fasta -n EOG091G08UU.clustalo.aln.ALICUT.$RAxMLmodel 		1> ../../per_gene/EOG091G08UU/infer_single_ML.stdout.txt 2> ../../per_gene/EOG091G08UU/infer_single_ML.stderr.txt
	else
		echo "fasta file per_gene/EOG091G08UU/ALICUT_EOG091G08UU.clustalo.fasta contains fewer than 5 sequences - skipped" > ../../per_gene/EOG091G08UU/infer_single_ML.stdout.txt
		touch raxml.skipped
	fi
        touch ../../per_gene/EOG091G08UU/EOG091G08UU.raxml.done
        
[33mJob counts:
	count	jobs
	1	infer_single_ML
	1[0m
[33m
        cd per_gene/EOG091G08UU
	count=$(cat ../../per_gene/EOG091G08UU/ALICUT_EOG091G08UU.clustalo.fasta | grep ">" | wc -l)
	if [ "$count" -gt 5 ]
        then
		RAxMLmodel=$(cat ../../per_gene/EOG091G08UU/EOG091G08UU.best_model | grep "Best" | cut -d ":" -f 2 | tr -d '[:space:]')
                if [ "$(ls -1 | grep "^RAxML" | wc -l)" -ne 0 ]
		then
			rm RAxML*
		fi
        	raxml -f a -T 2 -m PROTGAMMA$RAxMLmodel         	-p 12345 -x 12345 -# 100         	-s ../../per_gene/EOG091G08UU/ALICUT_EOG091G08UU.clustalo.fasta -n EOG091G08UU.clustalo.aln.ALICUT.$RAxMLmodel 		1> ../../per_gene/EOG091G08UU/infer_single_ML.stdout.txt 2> ../../per_gene/EOG091G08UU/infer_single_ML.stderr.txt
	else
		echo "fasta file per_gene/EOG091G08UU/ALICUT_EOG091G08UU.clustalo.fasta contains fewer than 5 sequences - skipped" > ../../per_gene/EOG091G08UU/infer_single_ML.stdout.txt
		touch raxml.skipped
	fi
        touch ../../per_gene/EOG091G08UU/EOG091G08UU.raxml.done
        [0m
[Sun Jul  5 23:11:32 2020]
Finished job 1086.
1853 of 3292 steps (56%) done

[Sun Jul  5 23:11:32 2020]
rule infer_single_ML:
    input: per_gene/EOG091G05SE/EOG091G05SE.best_model, per_gene/EOG091G05SE/ALICUT_EOG091G05SE.clustalo.fasta
    output: per_gene/EOG091G05SE/EOG091G05SE.raxml.done
    log: per_gene/EOG091G05SE/infer_single_ML.stdout.txt, per_gene/EOG091G05SE/infer_single_ML.stderr.txt
    jobid: 337
    wildcards: BUSCO=EOG091G05SE
    threads: 2


        cd per_gene/EOG091G05SE
	count=$(cat ../../per_gene/EOG091G05SE/ALICUT_EOG091G05SE.clustalo.fasta | grep ">" | wc -l)
	if [ "$count" -gt 5 ]
        then
		RAxMLmodel=$(cat ../../per_gene/EOG091G05SE/EOG091G05SE.best_model | grep "Best" | cut -d ":" -f 2 | tr -d '[:space:]')
                if [ "$(ls -1 | grep "^RAxML" | wc -l)" -ne 0 ]
		then
			rm RAxML*
		fi
        	raxml -f a -T 2 -m PROTGAMMA$RAxMLmodel         	-p 12345 -x 12345 -# 100         	-s ../../per_gene/EOG091G05SE/ALICUT_EOG091G05SE.clustalo.fasta -n EOG091G05SE.clustalo.aln.ALICUT.$RAxMLmodel 		1> ../../per_gene/EOG091G05SE/infer_single_ML.stdout.txt 2> ../../per_gene/EOG091G05SE/infer_single_ML.stderr.txt
	else
		echo "fasta file per_gene/EOG091G05SE/ALICUT_EOG091G05SE.clustalo.fasta contains fewer than 5 sequences - skipped" > ../../per_gene/EOG091G05SE/infer_single_ML.stdout.txt
		touch raxml.skipped
	fi
        touch ../../per_gene/EOG091G05SE/EOG091G05SE.raxml.done
        
[Sun Jul  5 23:11:32 2020]
Finished job 1072.
1854 of 3292 steps (56%) done

[Sun Jul  5 23:11:32 2020]
rule infer_single_ML:
    input: per_gene/EOG091G03XO/EOG091G03XO.best_model, per_gene/EOG091G03XO/ALICUT_EOG091G03XO.clustalo.fasta
    output: per_gene/EOG091G03XO/EOG091G03XO.raxml.done
    log: per_gene/EOG091G03XO/infer_single_ML.stdout.txt, per_gene/EOG091G03XO/infer_single_ML.stderr.txt
    jobid: 330
    wildcards: BUSCO=EOG091G03XO
    threads: 2


        cd per_gene/EOG091G03XO
	count=$(cat ../../per_gene/EOG091G03XO/ALICUT_EOG091G03XO.clustalo.fasta | grep ">" | wc -l)
	if [ "$count" -gt 5 ]
        then
		RAxMLmodel=$(cat ../../per_gene/EOG091G03XO/EOG091G03XO.best_model | grep "Best" | cut -d ":" -f 2 | tr -d '[:space:]')
                if [ "$(ls -1 | grep "^RAxML" | wc -l)" -ne 0 ]
		then
			rm RAxML*
		fi
        	raxml -f a -T 2 -m PROTGAMMA$RAxMLmodel         	-p 12345 -x 12345 -# 100         	-s ../../per_gene/EOG091G03XO/ALICUT_EOG091G03XO.clustalo.fasta -n EOG091G03XO.clustalo.aln.ALICUT.$RAxMLmodel 		1> ../../per_gene/EOG091G03XO/infer_single_ML.stdout.txt 2> ../../per_gene/EOG091G03XO/infer_single_ML.stderr.txt
	else
		echo "fasta file per_gene/EOG091G03XO/ALICUT_EOG091G03XO.clustalo.fasta contains fewer than 5 sequences - skipped" > ../../per_gene/EOG091G03XO/infer_single_ML.stdout.txt
		touch raxml.skipped
	fi
        touch ../../per_gene/EOG091G03XO/EOG091G03XO.raxml.done
        
[33mJob counts:
	count	jobs
	1	infer_single_ML
	1[0m
[33m
        cd per_gene/EOG091G05SE
	count=$(cat ../../per_gene/EOG091G05SE/ALICUT_EOG091G05SE.clustalo.fasta | grep ">" | wc -l)
	if [ "$count" -gt 5 ]
        then
		RAxMLmodel=$(cat ../../per_gene/EOG091G05SE/EOG091G05SE.best_model | grep "Best" | cut -d ":" -f 2 | tr -d '[:space:]')
                if [ "$(ls -1 | grep "^RAxML" | wc -l)" -ne 0 ]
		then
			rm RAxML*
		fi
        	raxml -f a -T 2 -m PROTGAMMA$RAxMLmodel         	-p 12345 -x 12345 -# 100         	-s ../../per_gene/EOG091G05SE/ALICUT_EOG091G05SE.clustalo.fasta -n EOG091G05SE.clustalo.aln.ALICUT.$RAxMLmodel 		1> ../../per_gene/EOG091G05SE/infer_single_ML.stdout.txt 2> ../../per_gene/EOG091G05SE/infer_single_ML.stderr.txt
	else
		echo "fasta file per_gene/EOG091G05SE/ALICUT_EOG091G05SE.clustalo.fasta contains fewer than 5 sequences - skipped" > ../../per_gene/EOG091G05SE/infer_single_ML.stdout.txt
		touch raxml.skipped
	fi
        touch ../../per_gene/EOG091G05SE/EOG091G05SE.raxml.done
        [0m
[33mJob counts:
	count	jobs
	1	infer_single_ML
	1[0m
[33m
        cd per_gene/EOG091G03XO
	count=$(cat ../../per_gene/EOG091G03XO/ALICUT_EOG091G03XO.clustalo.fasta | grep ">" | wc -l)
	if [ "$count" -gt 5 ]
        then
		RAxMLmodel=$(cat ../../per_gene/EOG091G03XO/EOG091G03XO.best_model | grep "Best" | cut -d ":" -f 2 | tr -d '[:space:]')
                if [ "$(ls -1 | grep "^RAxML" | wc -l)" -ne 0 ]
		then
			rm RAxML*
		fi
        	raxml -f a -T 2 -m PROTGAMMA$RAxMLmodel         	-p 12345 -x 12345 -# 100         	-s ../../per_gene/EOG091G03XO/ALICUT_EOG091G03XO.clustalo.fasta -n EOG091G03XO.clustalo.aln.ALICUT.$RAxMLmodel 		1> ../../per_gene/EOG091G03XO/infer_single_ML.stdout.txt 2> ../../per_gene/EOG091G03XO/infer_single_ML.stderr.txt
	else
		echo "fasta file per_gene/EOG091G03XO/ALICUT_EOG091G03XO.clustalo.fasta contains fewer than 5 sequences - skipped" > ../../per_gene/EOG091G03XO/infer_single_ML.stdout.txt
		touch raxml.skipped
	fi
        touch ../../per_gene/EOG091G03XO/EOG091G03XO.raxml.done
        [0m
[Sun Jul  5 23:11:55 2020]
Finished job 1030.
1855 of 3292 steps (56%) done

[Sun Jul  5 23:11:55 2020]
rule infer_single_ML:
    input: per_gene/EOG091G0CQ2/EOG091G0CQ2.best_model, per_gene/EOG091G0CQ2/ALICUT_EOG091G0CQ2.clustalo.fasta
    output: per_gene/EOG091G0CQ2/EOG091G0CQ2.raxml.done
    log: per_gene/EOG091G0CQ2/infer_single_ML.stdout.txt, per_gene/EOG091G0CQ2/infer_single_ML.stderr.txt
    jobid: 309
    wildcards: BUSCO=EOG091G0CQ2
    threads: 2


        cd per_gene/EOG091G0CQ2
	count=$(cat ../../per_gene/EOG091G0CQ2/ALICUT_EOG091G0CQ2.clustalo.fasta | grep ">" | wc -l)
	if [ "$count" -gt 5 ]
        then
		RAxMLmodel=$(cat ../../per_gene/EOG091G0CQ2/EOG091G0CQ2.best_model | grep "Best" | cut -d ":" -f 2 | tr -d '[:space:]')
                if [ "$(ls -1 | grep "^RAxML" | wc -l)" -ne 0 ]
		then
			rm RAxML*
		fi
        	raxml -f a -T 2 -m PROTGAMMA$RAxMLmodel         	-p 12345 -x 12345 -# 100         	-s ../../per_gene/EOG091G0CQ2/ALICUT_EOG091G0CQ2.clustalo.fasta -n EOG091G0CQ2.clustalo.aln.ALICUT.$RAxMLmodel 		1> ../../per_gene/EOG091G0CQ2/infer_single_ML.stdout.txt 2> ../../per_gene/EOG091G0CQ2/infer_single_ML.stderr.txt
	else
		echo "fasta file per_gene/EOG091G0CQ2/ALICUT_EOG091G0CQ2.clustalo.fasta contains fewer than 5 sequences - skipped" > ../../per_gene/EOG091G0CQ2/infer_single_ML.stdout.txt
		touch raxml.skipped
	fi
        touch ../../per_gene/EOG091G0CQ2/EOG091G0CQ2.raxml.done
        
[Sun Jul  5 23:11:59 2020]
Finished job 156.
1856 of 3292 steps (56%) done

[Sun Jul  5 23:11:59 2020]
rule get_seqs:
    input: /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ingroup.txt, /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/outgroup.txt
    output: per_gene/EOG091G09UB/EOG091G09UB.ingroup.fasta
    log: per_gene/EOG091G09UB/get_seqs.stdout.txt, per_gene/EOG091G09UB/get_seqs.stderr.txt
    jobid: 3168
    wildcards: BUSCO=EOG091G09UB
    threads: 2


	basedir=$(pwd)
        cd per_gene/EOG091G09UB
        
        bash $basedir/../scripts/fetch_seqs.sh EOG091G09UB /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ingroup.txt /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/outgroup.txt 1> ../../per_gene/EOG091G09UB/get_seqs.stdout.txt 2> ../../per_gene/EOG091G09UB/get_seqs.stderr.txt
	mv EOG091G09UB.fasta $basedir/per_gene/EOG091G09UB/EOG091G09UB.ingroup.fasta
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/72476f9d9a5bd0627b4d721143a21354.simg
[Sun Jul  5 23:12:02 2020]
Finished job 330.
1857 of 3292 steps (56%) done

[Sun Jul  5 23:12:02 2020]
rule get_seqs:
    input: /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ingroup.txt, /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/outgroup.txt
    output: per_gene/EOG091G03G3/EOG091G03G3.ingroup.fasta
    log: per_gene/EOG091G03G3/get_seqs.stdout.txt, per_gene/EOG091G03G3/get_seqs.stderr.txt
    jobid: 3122
    wildcards: BUSCO=EOG091G03G3
    threads: 2


	basedir=$(pwd)
        cd per_gene/EOG091G03G3
        
        bash $basedir/../scripts/fetch_seqs.sh EOG091G03G3 /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ingroup.txt /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/outgroup.txt 1> ../../per_gene/EOG091G03G3/get_seqs.stdout.txt 2> ../../per_gene/EOG091G03G3/get_seqs.stderr.txt
	mv EOG091G03G3.fasta $basedir/per_gene/EOG091G03G3/EOG091G03G3.ingroup.fasta
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/72476f9d9a5bd0627b4d721143a21354.simg
[33mJob counts:
	count	jobs
	1	infer_single_ML
	1[0m
[33m
        cd per_gene/EOG091G0CQ2
	count=$(cat ../../per_gene/EOG091G0CQ2/ALICUT_EOG091G0CQ2.clustalo.fasta | grep ">" | wc -l)
	if [ "$count" -gt 5 ]
        then
		RAxMLmodel=$(cat ../../per_gene/EOG091G0CQ2/EOG091G0CQ2.best_model | grep "Best" | cut -d ":" -f 2 | tr -d '[:space:]')
                if [ "$(ls -1 | grep "^RAxML" | wc -l)" -ne 0 ]
		then
			rm RAxML*
		fi
        	raxml -f a -T 2 -m PROTGAMMA$RAxMLmodel         	-p 12345 -x 12345 -# 100         	-s ../../per_gene/EOG091G0CQ2/ALICUT_EOG091G0CQ2.clustalo.fasta -n EOG091G0CQ2.clustalo.aln.ALICUT.$RAxMLmodel 		1> ../../per_gene/EOG091G0CQ2/infer_single_ML.stdout.txt 2> ../../per_gene/EOG091G0CQ2/infer_single_ML.stderr.txt
	else
		echo "fasta file per_gene/EOG091G0CQ2/ALICUT_EOG091G0CQ2.clustalo.fasta contains fewer than 5 sequences - skipped" > ../../per_gene/EOG091G0CQ2/infer_single_ML.stdout.txt
		touch raxml.skipped
	fi
        touch ../../per_gene/EOG091G0CQ2/EOG091G0CQ2.raxml.done
        [0m
[Sun Jul  5 23:12:12 2020]
Finished job 3168.
1858 of 3292 steps (56%) done

[Sun Jul  5 23:12:12 2020]
rule get_outgroups:
    input: per_gene/EOG091G09UB/EOG091G09UB.ingroup.fasta
    output: per_gene/EOG091G09UB/EOG091G09UB.orthodb.fasta, per_gene/EOG091G09UB/EOG091G09UB.outgroup.fasta
    log: per_gene/EOG091G09UB/get_outgroups.stdout.txt, per_gene/EOG091G09UB/get_outgroups.stderr.txt
    jobid: 3169
    wildcards: BUSCO=EOG091G09UB


        #download fastas from Orhtodb for BUSCO id
        for i in {1..5}
        do
             wget "http://www.orthodb.org/fasta?query=EOG091G09UB&level=33208" -O per_gene/EOG091G09UB/EOG091G09UB.orthodb.fasta 1> per_gene/EOG091G09UB/get_outgroups.stdout.txt 2> per_gene/EOG091G09UB/get_outgroups.stderr.txt && break || echo -e "try again ($i)" && sleep 15
        done

	#This is quick an dirty for now and just takes the first protein if there is more than one for an outgroup taxon
        bash ../scripts/download_outgroups.sh taxids.txt per_gene/EOG091G09UB/EOG091G09UB.orthodb.fasta > per_gene/EOG091G09UB/EOG091G09UB.outgroup.fasta
        
[Sun Jul  5 23:12:12 2020]
Finished job 3169.
1859 of 3292 steps (56%) done

[Sun Jul  5 23:12:12 2020]
rule join_groups:
    input: per_gene/EOG091G09UB/EOG091G09UB.ingroup.fasta, per_gene/EOG091G09UB/EOG091G09UB.outgroup.fasta
    output: per_gene/EOG091G09UB/EOG091G09UB.fasta
    jobid: 2408
    wildcards: BUSCO=EOG091G09UB


        cat per_gene/EOG091G09UB/EOG091G09UB.ingroup.fasta per_gene/EOG091G09UB/EOG091G09UB.outgroup.fasta > per_gene/EOG091G09UB/EOG091G09UB.fasta
        
[Sun Jul  5 23:12:12 2020]
Finished job 2408.
1860 of 3292 steps (57%) done

[Sun Jul  5 23:12:12 2020]
rule MSA:
    input: per_gene/EOG091G09UB/EOG091G09UB.fasta
    output: per_gene/EOG091G09UB/EOG091G09UB.clustalo.fasta
    log: per_gene/EOG091G09UB/MSA.stdout.txt, per_gene/EOG091G09UB/MSA.stderr.txt
    jobid: 1936
    wildcards: BUSCO=EOG091G09UB
    threads: 2


        clustalo -i per_gene/EOG091G09UB/EOG091G09UB.fasta -o per_gene/EOG091G09UB/EOG091G09UB.clustalo.fasta --threads=2 1> per_gene/EOG091G09UB/MSA.stdout.txt 2> per_gene/EOG091G09UB/MSA.stderr.txt
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/d68c9691725a7401923680874285c430.simg
[Sun Jul  5 23:12:14 2020]
Finished job 1936.
1861 of 3292 steps (57%) done

[Sun Jul  5 23:12:14 2020]
rule score_and_cut:
    input: per_gene/EOG091G09UB/EOG091G09UB.clustalo.fasta
    output: per_gene/EOG091G09UB/ALICUT_EOG091G09UB.clustalo.fasta
    jobid: 1113
    wildcards: BUSCO=EOG091G09UB
    threads: 2


        cd per_gene/EOG091G09UB
        Aliscore.pl -N -r 200000000000000000 -i ../../per_gene/EOG091G09UB/EOG091G09UB.clustalo.fasta &> aliscore.log
        ALICUT.pl -s &> alicut.log
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/63c88c27a0fa300f57066b0ef65fefcb.simg
[Sun Jul  5 23:12:15 2020]
Finished job 3122.
1862 of 3292 steps (57%) done

[Sun Jul  5 23:12:15 2020]
rule get_outgroups:
    input: per_gene/EOG091G03G3/EOG091G03G3.ingroup.fasta
    output: per_gene/EOG091G03G3/EOG091G03G3.orthodb.fasta, per_gene/EOG091G03G3/EOG091G03G3.outgroup.fasta
    log: per_gene/EOG091G03G3/get_outgroups.stdout.txt, per_gene/EOG091G03G3/get_outgroups.stderr.txt
    jobid: 3123
    wildcards: BUSCO=EOG091G03G3


        #download fastas from Orhtodb for BUSCO id
        for i in {1..5}
        do
             wget "http://www.orthodb.org/fasta?query=EOG091G03G3&level=33208" -O per_gene/EOG091G03G3/EOG091G03G3.orthodb.fasta 1> per_gene/EOG091G03G3/get_outgroups.stdout.txt 2> per_gene/EOG091G03G3/get_outgroups.stderr.txt && break || echo -e "try again ($i)" && sleep 15
        done

	#This is quick an dirty for now and just takes the first protein if there is more than one for an outgroup taxon
        bash ../scripts/download_outgroups.sh taxids.txt per_gene/EOG091G03G3/EOG091G03G3.orthodb.fasta > per_gene/EOG091G03G3/EOG091G03G3.outgroup.fasta
        
[Sun Jul  5 23:12:16 2020]
Finished job 3123.
1863 of 3292 steps (57%) done

[Sun Jul  5 23:12:16 2020]
rule join_groups:
    input: per_gene/EOG091G03G3/EOG091G03G3.ingroup.fasta, per_gene/EOG091G03G3/EOG091G03G3.outgroup.fasta
    output: per_gene/EOG091G03G3/EOG091G03G3.fasta
    jobid: 2385
    wildcards: BUSCO=EOG091G03G3


        cat per_gene/EOG091G03G3/EOG091G03G3.ingroup.fasta per_gene/EOG091G03G3/EOG091G03G3.outgroup.fasta > per_gene/EOG091G03G3/EOG091G03G3.fasta
        
[Sun Jul  5 23:12:16 2020]
Finished job 2385.
1864 of 3292 steps (57%) done

[Sun Jul  5 23:12:16 2020]
rule MSA:
    input: per_gene/EOG091G03G3/EOG091G03G3.fasta
    output: per_gene/EOG091G03G3/EOG091G03G3.clustalo.fasta
    log: per_gene/EOG091G03G3/MSA.stdout.txt, per_gene/EOG091G03G3/MSA.stderr.txt
    jobid: 1890
    wildcards: BUSCO=EOG091G03G3
    threads: 2


        clustalo -i per_gene/EOG091G03G3/EOG091G03G3.fasta -o per_gene/EOG091G03G3/EOG091G03G3.clustalo.fasta --threads=2 1> per_gene/EOG091G03G3/MSA.stdout.txt 2> per_gene/EOG091G03G3/MSA.stderr.txt
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/d68c9691725a7401923680874285c430.simg
[Sun Jul  5 23:12:18 2020]
Finished job 1890.
1865 of 3292 steps (57%) done

[Sun Jul  5 23:12:18 2020]
rule score_and_cut:
    input: per_gene/EOG091G03G3/EOG091G03G3.clustalo.fasta
    output: per_gene/EOG091G03G3/ALICUT_EOG091G03G3.clustalo.fasta
    jobid: 1067
    wildcards: BUSCO=EOG091G03G3
    threads: 2


        cd per_gene/EOG091G03G3
        Aliscore.pl -N -r 200000000000000000 -i ../../per_gene/EOG091G03G3/EOG091G03G3.clustalo.fasta &> aliscore.log
        ALICUT.pl -s &> alicut.log
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/63c88c27a0fa300f57066b0ef65fefcb.simg
[Sun Jul  5 23:12:20 2020]
Finished job 422.
1866 of 3292 steps (57%) done

[Sun Jul  5 23:12:20 2020]
rule infer_single_ML:
    input: per_gene/EOG091G017G/EOG091G017G.best_model, per_gene/EOG091G017G/ALICUT_EOG091G017G.clustalo.fasta
    output: per_gene/EOG091G017G/EOG091G017G.raxml.done
    log: per_gene/EOG091G017G/infer_single_ML.stdout.txt, per_gene/EOG091G017G/infer_single_ML.stderr.txt
    jobid: 5
    wildcards: BUSCO=EOG091G017G
    threads: 2


        cd per_gene/EOG091G017G
	count=$(cat ../../per_gene/EOG091G017G/ALICUT_EOG091G017G.clustalo.fasta | grep ">" | wc -l)
	if [ "$count" -gt 5 ]
        then
		RAxMLmodel=$(cat ../../per_gene/EOG091G017G/EOG091G017G.best_model | grep "Best" | cut -d ":" -f 2 | tr -d '[:space:]')
                if [ "$(ls -1 | grep "^RAxML" | wc -l)" -ne 0 ]
		then
			rm RAxML*
		fi
        	raxml -f a -T 2 -m PROTGAMMA$RAxMLmodel         	-p 12345 -x 12345 -# 100         	-s ../../per_gene/EOG091G017G/ALICUT_EOG091G017G.clustalo.fasta -n EOG091G017G.clustalo.aln.ALICUT.$RAxMLmodel 		1> ../../per_gene/EOG091G017G/infer_single_ML.stdout.txt 2> ../../per_gene/EOG091G017G/infer_single_ML.stderr.txt
	else
		echo "fasta file per_gene/EOG091G017G/ALICUT_EOG091G017G.clustalo.fasta contains fewer than 5 sequences - skipped" > ../../per_gene/EOG091G017G/infer_single_ML.stdout.txt
		touch raxml.skipped
	fi
        touch ../../per_gene/EOG091G017G/EOG091G017G.raxml.done
        
[33mJob counts:
	count	jobs
	1	infer_single_ML
	1[0m
[33m
        cd per_gene/EOG091G017G
	count=$(cat ../../per_gene/EOG091G017G/ALICUT_EOG091G017G.clustalo.fasta | grep ">" | wc -l)
	if [ "$count" -gt 5 ]
        then
		RAxMLmodel=$(cat ../../per_gene/EOG091G017G/EOG091G017G.best_model | grep "Best" | cut -d ":" -f 2 | tr -d '[:space:]')
                if [ "$(ls -1 | grep "^RAxML" | wc -l)" -ne 0 ]
		then
			rm RAxML*
		fi
        	raxml -f a -T 2 -m PROTGAMMA$RAxMLmodel         	-p 12345 -x 12345 -# 100         	-s ../../per_gene/EOG091G017G/ALICUT_EOG091G017G.clustalo.fasta -n EOG091G017G.clustalo.aln.ALICUT.$RAxMLmodel 		1> ../../per_gene/EOG091G017G/infer_single_ML.stdout.txt 2> ../../per_gene/EOG091G017G/infer_single_ML.stderr.txt
	else
		echo "fasta file per_gene/EOG091G017G/ALICUT_EOG091G017G.clustalo.fasta contains fewer than 5 sequences - skipped" > ../../per_gene/EOG091G017G/infer_single_ML.stdout.txt
		touch raxml.skipped
	fi
        touch ../../per_gene/EOG091G017G/EOG091G017G.raxml.done
        [0m
[Sun Jul  5 23:12:25 2020]
Finished job 1113.
1867 of 3292 steps (57%) done

[Sun Jul  5 23:12:25 2020]
rule remove_empty:
    input: per_gene/EOG091G09UB/ALICUT_EOG091G09UB.clustalo.fasta
    output: per_gene/EOG091G09UB/empty_check.done
    jobid: 1935
    wildcards: BUSCO=EOG091G09UB


         if [ "$(cat per_gene/EOG091G09UB/ALICUT_EOG091G09UB.clustalo.fasta | grep -v ">" | sed 's/-//g' | grep "^$" | wc -l)" -gt 0 ]
         then
              cp per_gene/EOG091G09UB/ALICUT_EOG091G09UB.clustalo.fasta per_gene/EOG091G09UB/ALICUT_EOG091G09UB.clustalo.fasta.backup
              bash ../scripts/remove_empty.sh per_gene/EOG091G09UB/ALICUT_EOG091G09UB.clustalo.fasta.backup > per_gene/EOG091G09UB/ALICUT_EOG091G09UB.clustalo.fasta
         fi
         touch per_gene/EOG091G09UB/empty_check.done
         
[Sun Jul  5 23:12:25 2020]
Finished job 1935.
1868 of 3292 steps (57%) done

[Sun Jul  5 23:12:25 2020]
rule find_best_model:
    input: per_gene/EOG091G09UB/ALICUT_EOG091G09UB.clustalo.fasta, per_gene/EOG091G09UB/empty_check.done
    output: per_gene/EOG091G09UB/EOG091G09UB.best_model
    log: per_gene/EOG091G09UB/find_best_model.stderr.txt
    jobid: 1112
    wildcards: BUSCO=EOG091G09UB
    threads: 2


        cd per_gene/EOG091G09UB
        if [ ! -d find_best_model ]
        then
            mkdir find_best_model
        fi
        cd find_best_model
        ln -s ../../../per_gene/EOG091G09UB/ALICUT_EOG091G09UB.clustalo.fasta EOG091G09UB.fasta
        ProteinModelSelection.pl EOG091G09UB.fasta 1> ../../../per_gene/EOG091G09UB/EOG091G09UB.best_model 2> ../../../per_gene/EOG091G09UB/find_best_model.stderr.txt
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/c0c09ee657b1e27f2c5687e0e9aa8d70.simg
[Sun Jul  5 23:12:29 2020]
Finished job 1067.
1869 of 3292 steps (57%) done

[Sun Jul  5 23:12:29 2020]
rule remove_empty:
    input: per_gene/EOG091G03G3/ALICUT_EOG091G03G3.clustalo.fasta
    output: per_gene/EOG091G03G3/empty_check.done
    jobid: 1889
    wildcards: BUSCO=EOG091G03G3


         if [ "$(cat per_gene/EOG091G03G3/ALICUT_EOG091G03G3.clustalo.fasta | grep -v ">" | sed 's/-//g' | grep "^$" | wc -l)" -gt 0 ]
         then
              cp per_gene/EOG091G03G3/ALICUT_EOG091G03G3.clustalo.fasta per_gene/EOG091G03G3/ALICUT_EOG091G03G3.clustalo.fasta.backup
              bash ../scripts/remove_empty.sh per_gene/EOG091G03G3/ALICUT_EOG091G03G3.clustalo.fasta.backup > per_gene/EOG091G03G3/ALICUT_EOG091G03G3.clustalo.fasta
         fi
         touch per_gene/EOG091G03G3/empty_check.done
         
[Sun Jul  5 23:12:29 2020]
Finished job 1889.
1870 of 3292 steps (57%) done

[Sun Jul  5 23:12:29 2020]
rule find_best_model:
    input: per_gene/EOG091G03G3/ALICUT_EOG091G03G3.clustalo.fasta, per_gene/EOG091G03G3/empty_check.done
    output: per_gene/EOG091G03G3/EOG091G03G3.best_model
    log: per_gene/EOG091G03G3/find_best_model.stderr.txt
    jobid: 1066
    wildcards: BUSCO=EOG091G03G3
    threads: 2


        cd per_gene/EOG091G03G3
        if [ ! -d find_best_model ]
        then
            mkdir find_best_model
        fi
        cd find_best_model
        ln -s ../../../per_gene/EOG091G03G3/ALICUT_EOG091G03G3.clustalo.fasta EOG091G03G3.fasta
        ProteinModelSelection.pl EOG091G03G3.fasta 1> ../../../per_gene/EOG091G03G3/EOG091G03G3.best_model 2> ../../../per_gene/EOG091G03G3/find_best_model.stderr.txt
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/c0c09ee657b1e27f2c5687e0e9aa8d70.simg
[Sun Jul  5 23:12:40 2020]
Finished job 223.
1871 of 3292 steps (57%) done

[Sun Jul  5 23:12:40 2020]
rule get_seqs:
    input: /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ingroup.txt, /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/outgroup.txt
    output: per_gene/EOG091G0J14/EOG091G0J14.ingroup.fasta
    log: per_gene/EOG091G0J14/get_seqs.stdout.txt, per_gene/EOG091G0J14/get_seqs.stderr.txt
    jobid: 2722
    wildcards: BUSCO=EOG091G0J14
    threads: 2


	basedir=$(pwd)
        cd per_gene/EOG091G0J14
        
        bash $basedir/../scripts/fetch_seqs.sh EOG091G0J14 /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ingroup.txt /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/outgroup.txt 1> ../../per_gene/EOG091G0J14/get_seqs.stdout.txt 2> ../../per_gene/EOG091G0J14/get_seqs.stderr.txt
	mv EOG091G0J14.fasta $basedir/per_gene/EOG091G0J14/EOG091G0J14.ingroup.fasta
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/72476f9d9a5bd0627b4d721143a21354.simg
[Sun Jul  5 23:12:52 2020]
Finished job 2722.
1872 of 3292 steps (57%) done

[Sun Jul  5 23:12:52 2020]
rule get_outgroups:
    input: per_gene/EOG091G0J14/EOG091G0J14.ingroup.fasta
    output: per_gene/EOG091G0J14/EOG091G0J14.orthodb.fasta, per_gene/EOG091G0J14/EOG091G0J14.outgroup.fasta
    log: per_gene/EOG091G0J14/get_outgroups.stdout.txt, per_gene/EOG091G0J14/get_outgroups.stderr.txt
    jobid: 2723
    wildcards: BUSCO=EOG091G0J14


        #download fastas from Orhtodb for BUSCO id
        for i in {1..5}
        do
             wget "http://www.orthodb.org/fasta?query=EOG091G0J14&level=33208" -O per_gene/EOG091G0J14/EOG091G0J14.orthodb.fasta 1> per_gene/EOG091G0J14/get_outgroups.stdout.txt 2> per_gene/EOG091G0J14/get_outgroups.stderr.txt && break || echo -e "try again ($i)" && sleep 15
        done

	#This is quick an dirty for now and just takes the first protein if there is more than one for an outgroup taxon
        bash ../scripts/download_outgroups.sh taxids.txt per_gene/EOG091G0J14/EOG091G0J14.orthodb.fasta > per_gene/EOG091G0J14/EOG091G0J14.outgroup.fasta
        
[Sun Jul  5 23:12:53 2020]
Finished job 2723.
1873 of 3292 steps (57%) done

[Sun Jul  5 23:12:53 2020]
rule join_groups:
    input: per_gene/EOG091G0J14/EOG091G0J14.ingroup.fasta, per_gene/EOG091G0J14/EOG091G0J14.outgroup.fasta
    output: per_gene/EOG091G0J14/EOG091G0J14.fasta
    jobid: 2185
    wildcards: BUSCO=EOG091G0J14


        cat per_gene/EOG091G0J14/EOG091G0J14.ingroup.fasta per_gene/EOG091G0J14/EOG091G0J14.outgroup.fasta > per_gene/EOG091G0J14/EOG091G0J14.fasta
        
[Sun Jul  5 23:12:53 2020]
Finished job 2185.
1874 of 3292 steps (57%) done

[Sun Jul  5 23:12:53 2020]
rule MSA:
    input: per_gene/EOG091G0J14/EOG091G0J14.fasta
    output: per_gene/EOG091G0J14/EOG091G0J14.clustalo.fasta
    log: per_gene/EOG091G0J14/MSA.stdout.txt, per_gene/EOG091G0J14/MSA.stderr.txt
    jobid: 1490
    wildcards: BUSCO=EOG091G0J14
    threads: 2


        clustalo -i per_gene/EOG091G0J14/EOG091G0J14.fasta -o per_gene/EOG091G0J14/EOG091G0J14.clustalo.fasta --threads=2 1> per_gene/EOG091G0J14/MSA.stdout.txt 2> per_gene/EOG091G0J14/MSA.stderr.txt
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/d68c9691725a7401923680874285c430.simg
[Sun Jul  5 23:12:54 2020]
Finished job 1490.
1875 of 3292 steps (57%) done

[Sun Jul  5 23:12:54 2020]
rule score_and_cut:
    input: per_gene/EOG091G0J14/EOG091G0J14.clustalo.fasta
    output: per_gene/EOG091G0J14/ALICUT_EOG091G0J14.clustalo.fasta
    jobid: 667
    wildcards: BUSCO=EOG091G0J14
    threads: 2


        cd per_gene/EOG091G0J14
        Aliscore.pl -N -r 200000000000000000 -i ../../per_gene/EOG091G0J14/EOG091G0J14.clustalo.fasta &> aliscore.log
        ALICUT.pl -s &> alicut.log
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/63c88c27a0fa300f57066b0ef65fefcb.simg
[Sun Jul  5 23:13:03 2020]
Finished job 1112.
1876 of 3292 steps (57%) done

[Sun Jul  5 23:13:03 2020]
rule infer_single_ML:
    input: per_gene/EOG091G09UB/EOG091G09UB.best_model, per_gene/EOG091G09UB/ALICUT_EOG091G09UB.clustalo.fasta
    output: per_gene/EOG091G09UB/EOG091G09UB.raxml.done
    log: per_gene/EOG091G09UB/infer_single_ML.stdout.txt, per_gene/EOG091G09UB/infer_single_ML.stderr.txt
    jobid: 350
    wildcards: BUSCO=EOG091G09UB
    threads: 2


        cd per_gene/EOG091G09UB
	count=$(cat ../../per_gene/EOG091G09UB/ALICUT_EOG091G09UB.clustalo.fasta | grep ">" | wc -l)
	if [ "$count" -gt 5 ]
        then
		RAxMLmodel=$(cat ../../per_gene/EOG091G09UB/EOG091G09UB.best_model | grep "Best" | cut -d ":" -f 2 | tr -d '[:space:]')
                if [ "$(ls -1 | grep "^RAxML" | wc -l)" -ne 0 ]
		then
			rm RAxML*
		fi
        	raxml -f a -T 2 -m PROTGAMMA$RAxMLmodel         	-p 12345 -x 12345 -# 100         	-s ../../per_gene/EOG091G09UB/ALICUT_EOG091G09UB.clustalo.fasta -n EOG091G09UB.clustalo.aln.ALICUT.$RAxMLmodel 		1> ../../per_gene/EOG091G09UB/infer_single_ML.stdout.txt 2> ../../per_gene/EOG091G09UB/infer_single_ML.stderr.txt
	else
		echo "fasta file per_gene/EOG091G09UB/ALICUT_EOG091G09UB.clustalo.fasta contains fewer than 5 sequences - skipped" > ../../per_gene/EOG091G09UB/infer_single_ML.stdout.txt
		touch raxml.skipped
	fi
        touch ../../per_gene/EOG091G09UB/EOG091G09UB.raxml.done
        
[Sun Jul  5 23:13:03 2020]
Finished job 1066.
1877 of 3292 steps (57%) done

[Sun Jul  5 23:13:03 2020]
rule infer_single_ML:
    input: per_gene/EOG091G03G3/EOG091G03G3.best_model, per_gene/EOG091G03G3/ALICUT_EOG091G03G3.clustalo.fasta
    output: per_gene/EOG091G03G3/EOG091G03G3.raxml.done
    log: per_gene/EOG091G03G3/infer_single_ML.stdout.txt, per_gene/EOG091G03G3/infer_single_ML.stderr.txt
    jobid: 327
    wildcards: BUSCO=EOG091G03G3
    threads: 2


        cd per_gene/EOG091G03G3
	count=$(cat ../../per_gene/EOG091G03G3/ALICUT_EOG091G03G3.clustalo.fasta | grep ">" | wc -l)
	if [ "$count" -gt 5 ]
        then
		RAxMLmodel=$(cat ../../per_gene/EOG091G03G3/EOG091G03G3.best_model | grep "Best" | cut -d ":" -f 2 | tr -d '[:space:]')
                if [ "$(ls -1 | grep "^RAxML" | wc -l)" -ne 0 ]
		then
			rm RAxML*
		fi
        	raxml -f a -T 2 -m PROTGAMMA$RAxMLmodel         	-p 12345 -x 12345 -# 100         	-s ../../per_gene/EOG091G03G3/ALICUT_EOG091G03G3.clustalo.fasta -n EOG091G03G3.clustalo.aln.ALICUT.$RAxMLmodel 		1> ../../per_gene/EOG091G03G3/infer_single_ML.stdout.txt 2> ../../per_gene/EOG091G03G3/infer_single_ML.stderr.txt
	else
		echo "fasta file per_gene/EOG091G03G3/ALICUT_EOG091G03G3.clustalo.fasta contains fewer than 5 sequences - skipped" > ../../per_gene/EOG091G03G3/infer_single_ML.stdout.txt
		touch raxml.skipped
	fi
        touch ../../per_gene/EOG091G03G3/EOG091G03G3.raxml.done
        
[Sun Jul  5 23:13:06 2020]
Finished job 667.
1878 of 3292 steps (57%) done

[Sun Jul  5 23:13:06 2020]
rule remove_empty:
    input: per_gene/EOG091G0J14/ALICUT_EOG091G0J14.clustalo.fasta
    output: per_gene/EOG091G0J14/empty_check.done
    jobid: 1489
    wildcards: BUSCO=EOG091G0J14


         if [ "$(cat per_gene/EOG091G0J14/ALICUT_EOG091G0J14.clustalo.fasta | grep -v ">" | sed 's/-//g' | grep "^$" | wc -l)" -gt 0 ]
         then
              cp per_gene/EOG091G0J14/ALICUT_EOG091G0J14.clustalo.fasta per_gene/EOG091G0J14/ALICUT_EOG091G0J14.clustalo.fasta.backup
              bash ../scripts/remove_empty.sh per_gene/EOG091G0J14/ALICUT_EOG091G0J14.clustalo.fasta.backup > per_gene/EOG091G0J14/ALICUT_EOG091G0J14.clustalo.fasta
         fi
         touch per_gene/EOG091G0J14/empty_check.done
         
[Sun Jul  5 23:13:06 2020]
Finished job 1489.
1879 of 3292 steps (57%) done

[Sun Jul  5 23:13:06 2020]
rule find_best_model:
    input: per_gene/EOG091G0J14/ALICUT_EOG091G0J14.clustalo.fasta, per_gene/EOG091G0J14/empty_check.done
    output: per_gene/EOG091G0J14/EOG091G0J14.best_model
    log: per_gene/EOG091G0J14/find_best_model.stderr.txt
    jobid: 666
    wildcards: BUSCO=EOG091G0J14
    threads: 2


        cd per_gene/EOG091G0J14
        if [ ! -d find_best_model ]
        then
            mkdir find_best_model
        fi
        cd find_best_model
        ln -s ../../../per_gene/EOG091G0J14/ALICUT_EOG091G0J14.clustalo.fasta EOG091G0J14.fasta
        ProteinModelSelection.pl EOG091G0J14.fasta 1> ../../../per_gene/EOG091G0J14/EOG091G0J14.best_model 2> ../../../per_gene/EOG091G0J14/find_best_model.stderr.txt
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/c0c09ee657b1e27f2c5687e0e9aa8d70.simg
[33mJob counts:
	count	jobs
	1	infer_single_ML
	1[0m
[33mJob counts:
	count	jobs
	1	infer_single_ML
	1[0m
[33m
        cd per_gene/EOG091G03G3
	count=$(cat ../../per_gene/EOG091G03G3/ALICUT_EOG091G03G3.clustalo.fasta | grep ">" | wc -l)
	if [ "$count" -gt 5 ]
        then
		RAxMLmodel=$(cat ../../per_gene/EOG091G03G3/EOG091G03G3.best_model | grep "Best" | cut -d ":" -f 2 | tr -d '[:space:]')
                if [ "$(ls -1 | grep "^RAxML" | wc -l)" -ne 0 ]
		then
			rm RAxML*
		fi
        	raxml -f a -T 2 -m PROTGAMMA$RAxMLmodel         	-p 12345 -x 12345 -# 100         	-s ../../per_gene/EOG091G03G3/ALICUT_EOG091G03G3.clustalo.fasta -n EOG091G03G3.clustalo.aln.ALICUT.$RAxMLmodel 		1> ../../per_gene/EOG091G03G3/infer_single_ML.stdout.txt 2> ../../per_gene/EOG091G03G3/infer_single_ML.stderr.txt
	else
		echo "fasta file per_gene/EOG091G03G3/ALICUT_EOG091G03G3.clustalo.fasta contains fewer than 5 sequences - skipped" > ../../per_gene/EOG091G03G3/infer_single_ML.stdout.txt
		touch raxml.skipped
	fi
        touch ../../per_gene/EOG091G03G3/EOG091G03G3.raxml.done
        [0m
[33m
        cd per_gene/EOG091G09UB
	count=$(cat ../../per_gene/EOG091G09UB/ALICUT_EOG091G09UB.clustalo.fasta | grep ">" | wc -l)
	if [ "$count" -gt 5 ]
        then
		RAxMLmodel=$(cat ../../per_gene/EOG091G09UB/EOG091G09UB.best_model | grep "Best" | cut -d ":" -f 2 | tr -d '[:space:]')
                if [ "$(ls -1 | grep "^RAxML" | wc -l)" -ne 0 ]
		then
			rm RAxML*
		fi
        	raxml -f a -T 2 -m PROTGAMMA$RAxMLmodel         	-p 12345 -x 12345 -# 100         	-s ../../per_gene/EOG091G09UB/ALICUT_EOG091G09UB.clustalo.fasta -n EOG091G09UB.clustalo.aln.ALICUT.$RAxMLmodel 		1> ../../per_gene/EOG091G09UB/infer_single_ML.stdout.txt 2> ../../per_gene/EOG091G09UB/infer_single_ML.stderr.txt
	else
		echo "fasta file per_gene/EOG091G09UB/ALICUT_EOG091G09UB.clustalo.fasta contains fewer than 5 sequences - skipped" > ../../per_gene/EOG091G09UB/infer_single_ML.stdout.txt
		touch raxml.skipped
	fi
        touch ../../per_gene/EOG091G09UB/EOG091G09UB.raxml.done
        [0m
[Sun Jul  5 23:13:25 2020]
Finished job 358.
1880 of 3292 steps (57%) done

[Sun Jul  5 23:13:25 2020]
rule get_seqs:
    input: /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ingroup.txt, /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/outgroup.txt
    output: per_gene/EOG091G0NOA/EOG091G0NOA.ingroup.fasta
    log: per_gene/EOG091G0NOA/get_seqs.stdout.txt, per_gene/EOG091G0NOA/get_seqs.stderr.txt
    jobid: 3240
    wildcards: BUSCO=EOG091G0NOA
    threads: 2


	basedir=$(pwd)
        cd per_gene/EOG091G0NOA
        
        bash $basedir/../scripts/fetch_seqs.sh EOG091G0NOA /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ingroup.txt /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/outgroup.txt 1> ../../per_gene/EOG091G0NOA/get_seqs.stdout.txt 2> ../../per_gene/EOG091G0NOA/get_seqs.stderr.txt
	mv EOG091G0NOA.fasta $basedir/per_gene/EOG091G0NOA/EOG091G0NOA.ingroup.fasta
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/72476f9d9a5bd0627b4d721143a21354.simg
[Sun Jul  5 23:13:32 2020]
Finished job 666.
1881 of 3292 steps (57%) done

[Sun Jul  5 23:13:32 2020]
rule infer_single_ML:
    input: per_gene/EOG091G0J14/EOG091G0J14.best_model, per_gene/EOG091G0J14/ALICUT_EOG091G0J14.clustalo.fasta
    output: per_gene/EOG091G0J14/EOG091G0J14.raxml.done
    log: per_gene/EOG091G0J14/infer_single_ML.stdout.txt, per_gene/EOG091G0J14/infer_single_ML.stderr.txt
    jobid: 127
    wildcards: BUSCO=EOG091G0J14
    threads: 2


        cd per_gene/EOG091G0J14
	count=$(cat ../../per_gene/EOG091G0J14/ALICUT_EOG091G0J14.clustalo.fasta | grep ">" | wc -l)
	if [ "$count" -gt 5 ]
        then
		RAxMLmodel=$(cat ../../per_gene/EOG091G0J14/EOG091G0J14.best_model | grep "Best" | cut -d ":" -f 2 | tr -d '[:space:]')
                if [ "$(ls -1 | grep "^RAxML" | wc -l)" -ne 0 ]
		then
			rm RAxML*
		fi
        	raxml -f a -T 2 -m PROTGAMMA$RAxMLmodel         	-p 12345 -x 12345 -# 100         	-s ../../per_gene/EOG091G0J14/ALICUT_EOG091G0J14.clustalo.fasta -n EOG091G0J14.clustalo.aln.ALICUT.$RAxMLmodel 		1> ../../per_gene/EOG091G0J14/infer_single_ML.stdout.txt 2> ../../per_gene/EOG091G0J14/infer_single_ML.stderr.txt
	else
		echo "fasta file per_gene/EOG091G0J14/ALICUT_EOG091G0J14.clustalo.fasta contains fewer than 5 sequences - skipped" > ../../per_gene/EOG091G0J14/infer_single_ML.stdout.txt
		touch raxml.skipped
	fi
        touch ../../per_gene/EOG091G0J14/EOG091G0J14.raxml.done
        
[33mJob counts:
	count	jobs
	1	infer_single_ML
	1[0m
[33m
        cd per_gene/EOG091G0J14
	count=$(cat ../../per_gene/EOG091G0J14/ALICUT_EOG091G0J14.clustalo.fasta | grep ">" | wc -l)
	if [ "$count" -gt 5 ]
        then
		RAxMLmodel=$(cat ../../per_gene/EOG091G0J14/EOG091G0J14.best_model | grep "Best" | cut -d ":" -f 2 | tr -d '[:space:]')
                if [ "$(ls -1 | grep "^RAxML" | wc -l)" -ne 0 ]
		then
			rm RAxML*
		fi
        	raxml -f a -T 2 -m PROTGAMMA$RAxMLmodel         	-p 12345 -x 12345 -# 100         	-s ../../per_gene/EOG091G0J14/ALICUT_EOG091G0J14.clustalo.fasta -n EOG091G0J14.clustalo.aln.ALICUT.$RAxMLmodel 		1> ../../per_gene/EOG091G0J14/infer_single_ML.stdout.txt 2> ../../per_gene/EOG091G0J14/infer_single_ML.stderr.txt
	else
		echo "fasta file per_gene/EOG091G0J14/ALICUT_EOG091G0J14.clustalo.fasta contains fewer than 5 sequences - skipped" > ../../per_gene/EOG091G0J14/infer_single_ML.stdout.txt
		touch raxml.skipped
	fi
        touch ../../per_gene/EOG091G0J14/EOG091G0J14.raxml.done
        [0m
[Sun Jul  5 23:13:38 2020]
Finished job 3240.
1882 of 3292 steps (57%) done

[Sun Jul  5 23:13:38 2020]
rule get_outgroups:
    input: per_gene/EOG091G0NOA/EOG091G0NOA.ingroup.fasta
    output: per_gene/EOG091G0NOA/EOG091G0NOA.orthodb.fasta, per_gene/EOG091G0NOA/EOG091G0NOA.outgroup.fasta
    log: per_gene/EOG091G0NOA/get_outgroups.stdout.txt, per_gene/EOG091G0NOA/get_outgroups.stderr.txt
    jobid: 3241
    wildcards: BUSCO=EOG091G0NOA


        #download fastas from Orhtodb for BUSCO id
        for i in {1..5}
        do
             wget "http://www.orthodb.org/fasta?query=EOG091G0NOA&level=33208" -O per_gene/EOG091G0NOA/EOG091G0NOA.orthodb.fasta 1> per_gene/EOG091G0NOA/get_outgroups.stdout.txt 2> per_gene/EOG091G0NOA/get_outgroups.stderr.txt && break || echo -e "try again ($i)" && sleep 15
        done

	#This is quick an dirty for now and just takes the first protein if there is more than one for an outgroup taxon
        bash ../scripts/download_outgroups.sh taxids.txt per_gene/EOG091G0NOA/EOG091G0NOA.orthodb.fasta > per_gene/EOG091G0NOA/EOG091G0NOA.outgroup.fasta
        
[Sun Jul  5 23:13:38 2020]
Finished job 3241.
1883 of 3292 steps (57%) done

[Sun Jul  5 23:13:38 2020]
rule join_groups:
    input: per_gene/EOG091G0NOA/EOG091G0NOA.ingroup.fasta, per_gene/EOG091G0NOA/EOG091G0NOA.outgroup.fasta
    output: per_gene/EOG091G0NOA/EOG091G0NOA.fasta
    jobid: 2444
    wildcards: BUSCO=EOG091G0NOA


        cat per_gene/EOG091G0NOA/EOG091G0NOA.ingroup.fasta per_gene/EOG091G0NOA/EOG091G0NOA.outgroup.fasta > per_gene/EOG091G0NOA/EOG091G0NOA.fasta
        
[Sun Jul  5 23:13:38 2020]
Finished job 2444.
1884 of 3292 steps (57%) done

[Sun Jul  5 23:13:38 2020]
rule MSA:
    input: per_gene/EOG091G0NOA/EOG091G0NOA.fasta
    output: per_gene/EOG091G0NOA/EOG091G0NOA.clustalo.fasta
    log: per_gene/EOG091G0NOA/MSA.stdout.txt, per_gene/EOG091G0NOA/MSA.stderr.txt
    jobid: 2008
    wildcards: BUSCO=EOG091G0NOA
    threads: 2


        clustalo -i per_gene/EOG091G0NOA/EOG091G0NOA.fasta -o per_gene/EOG091G0NOA/EOG091G0NOA.clustalo.fasta --threads=2 1> per_gene/EOG091G0NOA/MSA.stdout.txt 2> per_gene/EOG091G0NOA/MSA.stderr.txt
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/d68c9691725a7401923680874285c430.simg
[Sun Jul  5 23:13:40 2020]
Finished job 2008.
1885 of 3292 steps (57%) done

[Sun Jul  5 23:13:40 2020]
rule score_and_cut:
    input: per_gene/EOG091G0NOA/EOG091G0NOA.clustalo.fasta
    output: per_gene/EOG091G0NOA/ALICUT_EOG091G0NOA.clustalo.fasta
    jobid: 1185
    wildcards: BUSCO=EOG091G0NOA
    threads: 2


        cd per_gene/EOG091G0NOA
        Aliscore.pl -N -r 200000000000000000 -i ../../per_gene/EOG091G0NOA/EOG091G0NOA.clustalo.fasta &> aliscore.log
        ALICUT.pl -s &> alicut.log
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/63c88c27a0fa300f57066b0ef65fefcb.simg
[Sun Jul  5 23:13:50 2020]
Finished job 1185.
1886 of 3292 steps (57%) done

[Sun Jul  5 23:13:50 2020]
rule remove_empty:
    input: per_gene/EOG091G0NOA/ALICUT_EOG091G0NOA.clustalo.fasta
    output: per_gene/EOG091G0NOA/empty_check.done
    jobid: 2007
    wildcards: BUSCO=EOG091G0NOA


         if [ "$(cat per_gene/EOG091G0NOA/ALICUT_EOG091G0NOA.clustalo.fasta | grep -v ">" | sed 's/-//g' | grep "^$" | wc -l)" -gt 0 ]
         then
              cp per_gene/EOG091G0NOA/ALICUT_EOG091G0NOA.clustalo.fasta per_gene/EOG091G0NOA/ALICUT_EOG091G0NOA.clustalo.fasta.backup
              bash ../scripts/remove_empty.sh per_gene/EOG091G0NOA/ALICUT_EOG091G0NOA.clustalo.fasta.backup > per_gene/EOG091G0NOA/ALICUT_EOG091G0NOA.clustalo.fasta
         fi
         touch per_gene/EOG091G0NOA/empty_check.done
         
[Sun Jul  5 23:13:50 2020]
Finished job 2007.
1887 of 3292 steps (57%) done

[Sun Jul  5 23:13:50 2020]
rule find_best_model:
    input: per_gene/EOG091G0NOA/ALICUT_EOG091G0NOA.clustalo.fasta, per_gene/EOG091G0NOA/empty_check.done
    output: per_gene/EOG091G0NOA/EOG091G0NOA.best_model
    log: per_gene/EOG091G0NOA/find_best_model.stderr.txt
    jobid: 1184
    wildcards: BUSCO=EOG091G0NOA
    threads: 2


        cd per_gene/EOG091G0NOA
        if [ ! -d find_best_model ]
        then
            mkdir find_best_model
        fi
        cd find_best_model
        ln -s ../../../per_gene/EOG091G0NOA/ALICUT_EOG091G0NOA.clustalo.fasta EOG091G0NOA.fasta
        ProteinModelSelection.pl EOG091G0NOA.fasta 1> ../../../per_gene/EOG091G0NOA/EOG091G0NOA.best_model 2> ../../../per_gene/EOG091G0NOA/find_best_model.stderr.txt
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/c0c09ee657b1e27f2c5687e0e9aa8d70.simg
[Sun Jul  5 23:14:10 2020]
Finished job 1184.
1888 of 3292 steps (57%) done

[Sun Jul  5 23:14:10 2020]
rule infer_single_ML:
    input: per_gene/EOG091G0NOA/EOG091G0NOA.best_model, per_gene/EOG091G0NOA/ALICUT_EOG091G0NOA.clustalo.fasta
    output: per_gene/EOG091G0NOA/EOG091G0NOA.raxml.done
    log: per_gene/EOG091G0NOA/infer_single_ML.stdout.txt, per_gene/EOG091G0NOA/infer_single_ML.stderr.txt
    jobid: 386
    wildcards: BUSCO=EOG091G0NOA
    threads: 2


        cd per_gene/EOG091G0NOA
	count=$(cat ../../per_gene/EOG091G0NOA/ALICUT_EOG091G0NOA.clustalo.fasta | grep ">" | wc -l)
	if [ "$count" -gt 5 ]
        then
		RAxMLmodel=$(cat ../../per_gene/EOG091G0NOA/EOG091G0NOA.best_model | grep "Best" | cut -d ":" -f 2 | tr -d '[:space:]')
                if [ "$(ls -1 | grep "^RAxML" | wc -l)" -ne 0 ]
		then
			rm RAxML*
		fi
        	raxml -f a -T 2 -m PROTGAMMA$RAxMLmodel         	-p 12345 -x 12345 -# 100         	-s ../../per_gene/EOG091G0NOA/ALICUT_EOG091G0NOA.clustalo.fasta -n EOG091G0NOA.clustalo.aln.ALICUT.$RAxMLmodel 		1> ../../per_gene/EOG091G0NOA/infer_single_ML.stdout.txt 2> ../../per_gene/EOG091G0NOA/infer_single_ML.stderr.txt
	else
		echo "fasta file per_gene/EOG091G0NOA/ALICUT_EOG091G0NOA.clustalo.fasta contains fewer than 5 sequences - skipped" > ../../per_gene/EOG091G0NOA/infer_single_ML.stdout.txt
		touch raxml.skipped
	fi
        touch ../../per_gene/EOG091G0NOA/EOG091G0NOA.raxml.done
        
[33mJob counts:
	count	jobs
	1	infer_single_ML
	1[0m
[33m
        cd per_gene/EOG091G0NOA
	count=$(cat ../../per_gene/EOG091G0NOA/ALICUT_EOG091G0NOA.clustalo.fasta | grep ">" | wc -l)
	if [ "$count" -gt 5 ]
        then
		RAxMLmodel=$(cat ../../per_gene/EOG091G0NOA/EOG091G0NOA.best_model | grep "Best" | cut -d ":" -f 2 | tr -d '[:space:]')
                if [ "$(ls -1 | grep "^RAxML" | wc -l)" -ne 0 ]
		then
			rm RAxML*
		fi
        	raxml -f a -T 2 -m PROTGAMMA$RAxMLmodel         	-p 12345 -x 12345 -# 100         	-s ../../per_gene/EOG091G0NOA/ALICUT_EOG091G0NOA.clustalo.fasta -n EOG091G0NOA.clustalo.aln.ALICUT.$RAxMLmodel 		1> ../../per_gene/EOG091G0NOA/infer_single_ML.stdout.txt 2> ../../per_gene/EOG091G0NOA/infer_single_ML.stderr.txt
	else
		echo "fasta file per_gene/EOG091G0NOA/ALICUT_EOG091G0NOA.clustalo.fasta contains fewer than 5 sequences - skipped" > ../../per_gene/EOG091G0NOA/infer_single_ML.stdout.txt
		touch raxml.skipped
	fi
        touch ../../per_gene/EOG091G0NOA/EOG091G0NOA.raxml.done
        [0m
[Sun Jul  5 23:14:44 2020]
Finished job 157.
1889 of 3292 steps (57%) done

[Sun Jul  5 23:14:44 2020]
rule get_seqs:
    input: /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ingroup.txt, /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/outgroup.txt
    output: per_gene/EOG091G0IQD/EOG091G0IQD.ingroup.fasta
    log: per_gene/EOG091G0IQD/get_seqs.stdout.txt, per_gene/EOG091G0IQD/get_seqs.stderr.txt
    jobid: 3210
    wildcards: BUSCO=EOG091G0IQD
    threads: 2


	basedir=$(pwd)
        cd per_gene/EOG091G0IQD
        
        bash $basedir/../scripts/fetch_seqs.sh EOG091G0IQD /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ingroup.txt /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/outgroup.txt 1> ../../per_gene/EOG091G0IQD/get_seqs.stdout.txt 2> ../../per_gene/EOG091G0IQD/get_seqs.stderr.txt
	mv EOG091G0IQD.fasta $basedir/per_gene/EOG091G0IQD/EOG091G0IQD.ingroup.fasta
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/72476f9d9a5bd0627b4d721143a21354.simg
[Sun Jul  5 23:14:57 2020]
Finished job 3210.
1890 of 3292 steps (57%) done

[Sun Jul  5 23:14:57 2020]
rule get_outgroups:
    input: per_gene/EOG091G0IQD/EOG091G0IQD.ingroup.fasta
    output: per_gene/EOG091G0IQD/EOG091G0IQD.orthodb.fasta, per_gene/EOG091G0IQD/EOG091G0IQD.outgroup.fasta
    log: per_gene/EOG091G0IQD/get_outgroups.stdout.txt, per_gene/EOG091G0IQD/get_outgroups.stderr.txt
    jobid: 3211
    wildcards: BUSCO=EOG091G0IQD


        #download fastas from Orhtodb for BUSCO id
        for i in {1..5}
        do
             wget "http://www.orthodb.org/fasta?query=EOG091G0IQD&level=33208" -O per_gene/EOG091G0IQD/EOG091G0IQD.orthodb.fasta 1> per_gene/EOG091G0IQD/get_outgroups.stdout.txt 2> per_gene/EOG091G0IQD/get_outgroups.stderr.txt && break || echo -e "try again ($i)" && sleep 15
        done

	#This is quick an dirty for now and just takes the first protein if there is more than one for an outgroup taxon
        bash ../scripts/download_outgroups.sh taxids.txt per_gene/EOG091G0IQD/EOG091G0IQD.orthodb.fasta > per_gene/EOG091G0IQD/EOG091G0IQD.outgroup.fasta
        
[Sun Jul  5 23:14:57 2020]
Finished job 3211.
1891 of 3292 steps (57%) done

[Sun Jul  5 23:14:57 2020]
rule join_groups:
    input: per_gene/EOG091G0IQD/EOG091G0IQD.ingroup.fasta, per_gene/EOG091G0IQD/EOG091G0IQD.outgroup.fasta
    output: per_gene/EOG091G0IQD/EOG091G0IQD.fasta
    jobid: 2429
    wildcards: BUSCO=EOG091G0IQD


        cat per_gene/EOG091G0IQD/EOG091G0IQD.ingroup.fasta per_gene/EOG091G0IQD/EOG091G0IQD.outgroup.fasta > per_gene/EOG091G0IQD/EOG091G0IQD.fasta
        
[Sun Jul  5 23:14:58 2020]
Finished job 2429.
1892 of 3292 steps (57%) done

[Sun Jul  5 23:14:58 2020]
rule MSA:
    input: per_gene/EOG091G0IQD/EOG091G0IQD.fasta
    output: per_gene/EOG091G0IQD/EOG091G0IQD.clustalo.fasta
    log: per_gene/EOG091G0IQD/MSA.stdout.txt, per_gene/EOG091G0IQD/MSA.stderr.txt
    jobid: 1978
    wildcards: BUSCO=EOG091G0IQD
    threads: 2


        clustalo -i per_gene/EOG091G0IQD/EOG091G0IQD.fasta -o per_gene/EOG091G0IQD/EOG091G0IQD.clustalo.fasta --threads=2 1> per_gene/EOG091G0IQD/MSA.stdout.txt 2> per_gene/EOG091G0IQD/MSA.stderr.txt
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/d68c9691725a7401923680874285c430.simg
[Sun Jul  5 23:14:58 2020]
Finished job 1978.
1893 of 3292 steps (58%) done

[Sun Jul  5 23:14:58 2020]
rule score_and_cut:
    input: per_gene/EOG091G0IQD/EOG091G0IQD.clustalo.fasta
    output: per_gene/EOG091G0IQD/ALICUT_EOG091G0IQD.clustalo.fasta
    jobid: 1155
    wildcards: BUSCO=EOG091G0IQD
    threads: 2


        cd per_gene/EOG091G0IQD
        Aliscore.pl -N -r 200000000000000000 -i ../../per_gene/EOG091G0IQD/EOG091G0IQD.clustalo.fasta &> aliscore.log
        ALICUT.pl -s &> alicut.log
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/63c88c27a0fa300f57066b0ef65fefcb.simg
[Sun Jul  5 23:15:02 2020]
Finished job 164.
1894 of 3292 steps (58%) done

[Sun Jul  5 23:15:02 2020]
rule get_seqs:
    input: /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ingroup.txt, /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/outgroup.txt
    output: per_gene/EOG091G0R3S/EOG091G0R3S.ingroup.fasta
    log: per_gene/EOG091G0R3S/get_seqs.stdout.txt, per_gene/EOG091G0R3S/get_seqs.stderr.txt
    jobid: 3246
    wildcards: BUSCO=EOG091G0R3S
    threads: 2


	basedir=$(pwd)
        cd per_gene/EOG091G0R3S
        
        bash $basedir/../scripts/fetch_seqs.sh EOG091G0R3S /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ingroup.txt /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/outgroup.txt 1> ../../per_gene/EOG091G0R3S/get_seqs.stdout.txt 2> ../../per_gene/EOG091G0R3S/get_seqs.stderr.txt
	mv EOG091G0R3S.fasta $basedir/per_gene/EOG091G0R3S/EOG091G0R3S.ingroup.fasta
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/72476f9d9a5bd0627b4d721143a21354.simg
[Sun Jul  5 23:15:08 2020]
Finished job 1155.
1895 of 3292 steps (58%) done

[Sun Jul  5 23:15:08 2020]
rule remove_empty:
    input: per_gene/EOG091G0IQD/ALICUT_EOG091G0IQD.clustalo.fasta
    output: per_gene/EOG091G0IQD/empty_check.done
    jobid: 1977
    wildcards: BUSCO=EOG091G0IQD


         if [ "$(cat per_gene/EOG091G0IQD/ALICUT_EOG091G0IQD.clustalo.fasta | grep -v ">" | sed 's/-//g' | grep "^$" | wc -l)" -gt 0 ]
         then
              cp per_gene/EOG091G0IQD/ALICUT_EOG091G0IQD.clustalo.fasta per_gene/EOG091G0IQD/ALICUT_EOG091G0IQD.clustalo.fasta.backup
              bash ../scripts/remove_empty.sh per_gene/EOG091G0IQD/ALICUT_EOG091G0IQD.clustalo.fasta.backup > per_gene/EOG091G0IQD/ALICUT_EOG091G0IQD.clustalo.fasta
         fi
         touch per_gene/EOG091G0IQD/empty_check.done
         
[Sun Jul  5 23:15:08 2020]
Finished job 1977.
1896 of 3292 steps (58%) done

[Sun Jul  5 23:15:08 2020]
rule find_best_model:
    input: per_gene/EOG091G0IQD/ALICUT_EOG091G0IQD.clustalo.fasta, per_gene/EOG091G0IQD/empty_check.done
    output: per_gene/EOG091G0IQD/EOG091G0IQD.best_model
    log: per_gene/EOG091G0IQD/find_best_model.stderr.txt
    jobid: 1154
    wildcards: BUSCO=EOG091G0IQD
    threads: 2


        cd per_gene/EOG091G0IQD
        if [ ! -d find_best_model ]
        then
            mkdir find_best_model
        fi
        cd find_best_model
        ln -s ../../../per_gene/EOG091G0IQD/ALICUT_EOG091G0IQD.clustalo.fasta EOG091G0IQD.fasta
        ProteinModelSelection.pl EOG091G0IQD.fasta 1> ../../../per_gene/EOG091G0IQD/EOG091G0IQD.best_model 2> ../../../per_gene/EOG091G0IQD/find_best_model.stderr.txt
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/c0c09ee657b1e27f2c5687e0e9aa8d70.simg
[Sun Jul  5 23:15:14 2020]
Finished job 3246.
1897 of 3292 steps (58%) done

[Sun Jul  5 23:15:14 2020]
rule get_outgroups:
    input: per_gene/EOG091G0R3S/EOG091G0R3S.ingroup.fasta
    output: per_gene/EOG091G0R3S/EOG091G0R3S.orthodb.fasta, per_gene/EOG091G0R3S/EOG091G0R3S.outgroup.fasta
    log: per_gene/EOG091G0R3S/get_outgroups.stdout.txt, per_gene/EOG091G0R3S/get_outgroups.stderr.txt
    jobid: 3247
    wildcards: BUSCO=EOG091G0R3S


        #download fastas from Orhtodb for BUSCO id
        for i in {1..5}
        do
             wget "http://www.orthodb.org/fasta?query=EOG091G0R3S&level=33208" -O per_gene/EOG091G0R3S/EOG091G0R3S.orthodb.fasta 1> per_gene/EOG091G0R3S/get_outgroups.stdout.txt 2> per_gene/EOG091G0R3S/get_outgroups.stderr.txt && break || echo -e "try again ($i)" && sleep 15
        done

	#This is quick an dirty for now and just takes the first protein if there is more than one for an outgroup taxon
        bash ../scripts/download_outgroups.sh taxids.txt per_gene/EOG091G0R3S/EOG091G0R3S.orthodb.fasta > per_gene/EOG091G0R3S/EOG091G0R3S.outgroup.fasta
        
[Sun Jul  5 23:15:15 2020]
Finished job 3247.
1898 of 3292 steps (58%) done

[Sun Jul  5 23:15:15 2020]
rule join_groups:
    input: per_gene/EOG091G0R3S/EOG091G0R3S.ingroup.fasta, per_gene/EOG091G0R3S/EOG091G0R3S.outgroup.fasta
    output: per_gene/EOG091G0R3S/EOG091G0R3S.fasta
    jobid: 2447
    wildcards: BUSCO=EOG091G0R3S


        cat per_gene/EOG091G0R3S/EOG091G0R3S.ingroup.fasta per_gene/EOG091G0R3S/EOG091G0R3S.outgroup.fasta > per_gene/EOG091G0R3S/EOG091G0R3S.fasta
        
[Sun Jul  5 23:15:15 2020]
Finished job 2447.
1899 of 3292 steps (58%) done

[Sun Jul  5 23:15:15 2020]
rule MSA:
    input: per_gene/EOG091G0R3S/EOG091G0R3S.fasta
    output: per_gene/EOG091G0R3S/EOG091G0R3S.clustalo.fasta
    log: per_gene/EOG091G0R3S/MSA.stdout.txt, per_gene/EOG091G0R3S/MSA.stderr.txt
    jobid: 2014
    wildcards: BUSCO=EOG091G0R3S
    threads: 2


        clustalo -i per_gene/EOG091G0R3S/EOG091G0R3S.fasta -o per_gene/EOG091G0R3S/EOG091G0R3S.clustalo.fasta --threads=2 1> per_gene/EOG091G0R3S/MSA.stdout.txt 2> per_gene/EOG091G0R3S/MSA.stderr.txt
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/d68c9691725a7401923680874285c430.simg
[Sun Jul  5 23:15:17 2020]
Finished job 2014.
1900 of 3292 steps (58%) done

[Sun Jul  5 23:15:17 2020]
rule score_and_cut:
    input: per_gene/EOG091G0R3S/EOG091G0R3S.clustalo.fasta
    output: per_gene/EOG091G0R3S/ALICUT_EOG091G0R3S.clustalo.fasta
    jobid: 1191
    wildcards: BUSCO=EOG091G0R3S
    threads: 2


        cd per_gene/EOG091G0R3S
        Aliscore.pl -N -r 200000000000000000 -i ../../per_gene/EOG091G0R3S/EOG091G0R3S.clustalo.fasta &> aliscore.log
        ALICUT.pl -s &> alicut.log
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/63c88c27a0fa300f57066b0ef65fefcb.simg
[Sun Jul  5 23:15:23 2020]
Finished job 206.
1901 of 3292 steps (58%) done

[Sun Jul  5 23:15:23 2020]
rule get_seqs:
    input: /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ingroup.txt, /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/outgroup.txt
    output: per_gene/EOG091G0AE9/EOG091G0AE9.ingroup.fasta
    log: per_gene/EOG091G0AE9/get_seqs.stdout.txt, per_gene/EOG091G0AE9/get_seqs.stderr.txt
    jobid: 2620
    wildcards: BUSCO=EOG091G0AE9
    threads: 2


	basedir=$(pwd)
        cd per_gene/EOG091G0AE9
        
        bash $basedir/../scripts/fetch_seqs.sh EOG091G0AE9 /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ingroup.txt /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/outgroup.txt 1> ../../per_gene/EOG091G0AE9/get_seqs.stdout.txt 2> ../../per_gene/EOG091G0AE9/get_seqs.stderr.txt
	mv EOG091G0AE9.fasta $basedir/per_gene/EOG091G0AE9/EOG091G0AE9.ingroup.fasta
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/72476f9d9a5bd0627b4d721143a21354.simg
[Sun Jul  5 23:15:24 2020]
Finished job 320.
1902 of 3292 steps (58%) done

[Sun Jul  5 23:15:24 2020]
rule get_seqs:
    input: /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ingroup.txt, /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/outgroup.txt
    output: per_gene/EOG091G0VQK/EOG091G0VQK.ingroup.fasta
    log: per_gene/EOG091G0VQK/get_seqs.stdout.txt, per_gene/EOG091G0VQK/get_seqs.stderr.txt
    jobid: 2878
    wildcards: BUSCO=EOG091G0VQK
    threads: 2


	basedir=$(pwd)
        cd per_gene/EOG091G0VQK
        
        bash $basedir/../scripts/fetch_seqs.sh EOG091G0VQK /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ingroup.txt /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/outgroup.txt 1> ../../per_gene/EOG091G0VQK/get_seqs.stdout.txt 2> ../../per_gene/EOG091G0VQK/get_seqs.stderr.txt
	mv EOG091G0VQK.fasta $basedir/per_gene/EOG091G0VQK/EOG091G0VQK.ingroup.fasta
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/72476f9d9a5bd0627b4d721143a21354.simg
[Sun Jul  5 23:15:27 2020]
Finished job 67.
1903 of 3292 steps (58%) done

[Sun Jul  5 23:15:27 2020]
rule get_seqs:
    input: /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ingroup.txt, /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/outgroup.txt
    output: per_gene/EOG091G0NNO/EOG091G0NNO.ingroup.fasta
    log: per_gene/EOG091G0NNO/get_seqs.stdout.txt, per_gene/EOG091G0NNO/get_seqs.stderr.txt
    jobid: 2790
    wildcards: BUSCO=EOG091G0NNO
    threads: 2


	basedir=$(pwd)
        cd per_gene/EOG091G0NNO
        
        bash $basedir/../scripts/fetch_seqs.sh EOG091G0NNO /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ingroup.txt /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/outgroup.txt 1> ../../per_gene/EOG091G0NNO/get_seqs.stdout.txt 2> ../../per_gene/EOG091G0NNO/get_seqs.stderr.txt
	mv EOG091G0NNO.fasta $basedir/per_gene/EOG091G0NNO/EOG091G0NNO.ingroup.fasta
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/72476f9d9a5bd0627b4d721143a21354.simg
[Sun Jul  5 23:15:28 2020]
Finished job 1191.
1904 of 3292 steps (58%) done

[Sun Jul  5 23:15:28 2020]
rule remove_empty:
    input: per_gene/EOG091G0R3S/ALICUT_EOG091G0R3S.clustalo.fasta
    output: per_gene/EOG091G0R3S/empty_check.done
    jobid: 2013
    wildcards: BUSCO=EOG091G0R3S


         if [ "$(cat per_gene/EOG091G0R3S/ALICUT_EOG091G0R3S.clustalo.fasta | grep -v ">" | sed 's/-//g' | grep "^$" | wc -l)" -gt 0 ]
         then
              cp per_gene/EOG091G0R3S/ALICUT_EOG091G0R3S.clustalo.fasta per_gene/EOG091G0R3S/ALICUT_EOG091G0R3S.clustalo.fasta.backup
              bash ../scripts/remove_empty.sh per_gene/EOG091G0R3S/ALICUT_EOG091G0R3S.clustalo.fasta.backup > per_gene/EOG091G0R3S/ALICUT_EOG091G0R3S.clustalo.fasta
         fi
         touch per_gene/EOG091G0R3S/empty_check.done
         
[Sun Jul  5 23:15:28 2020]
Finished job 2013.
1905 of 3292 steps (58%) done

[Sun Jul  5 23:15:28 2020]
rule find_best_model:
    input: per_gene/EOG091G0R3S/ALICUT_EOG091G0R3S.clustalo.fasta, per_gene/EOG091G0R3S/empty_check.done
    output: per_gene/EOG091G0R3S/EOG091G0R3S.best_model
    log: per_gene/EOG091G0R3S/find_best_model.stderr.txt
    jobid: 1190
    wildcards: BUSCO=EOG091G0R3S
    threads: 2


        cd per_gene/EOG091G0R3S
        if [ ! -d find_best_model ]
        then
            mkdir find_best_model
        fi
        cd find_best_model
        ln -s ../../../per_gene/EOG091G0R3S/ALICUT_EOG091G0R3S.clustalo.fasta EOG091G0R3S.fasta
        ProteinModelSelection.pl EOG091G0R3S.fasta 1> ../../../per_gene/EOG091G0R3S/EOG091G0R3S.best_model 2> ../../../per_gene/EOG091G0R3S/find_best_model.stderr.txt
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/c0c09ee657b1e27f2c5687e0e9aa8d70.simg
[Sun Jul  5 23:15:34 2020]
Finished job 2620.
1906 of 3292 steps (58%) done

[Sun Jul  5 23:15:34 2020]
rule get_outgroups:
    input: per_gene/EOG091G0AE9/EOG091G0AE9.ingroup.fasta
    output: per_gene/EOG091G0AE9/EOG091G0AE9.orthodb.fasta, per_gene/EOG091G0AE9/EOG091G0AE9.outgroup.fasta
    log: per_gene/EOG091G0AE9/get_outgroups.stdout.txt, per_gene/EOG091G0AE9/get_outgroups.stderr.txt
    jobid: 2621
    wildcards: BUSCO=EOG091G0AE9


        #download fastas from Orhtodb for BUSCO id
        for i in {1..5}
        do
             wget "http://www.orthodb.org/fasta?query=EOG091G0AE9&level=33208" -O per_gene/EOG091G0AE9/EOG091G0AE9.orthodb.fasta 1> per_gene/EOG091G0AE9/get_outgroups.stdout.txt 2> per_gene/EOG091G0AE9/get_outgroups.stderr.txt && break || echo -e "try again ($i)" && sleep 15
        done

	#This is quick an dirty for now and just takes the first protein if there is more than one for an outgroup taxon
        bash ../scripts/download_outgroups.sh taxids.txt per_gene/EOG091G0AE9/EOG091G0AE9.orthodb.fasta > per_gene/EOG091G0AE9/EOG091G0AE9.outgroup.fasta
        
[Sun Jul  5 23:15:35 2020]
Finished job 2621.
1907 of 3292 steps (58%) done

[Sun Jul  5 23:15:35 2020]
rule join_groups:
    input: per_gene/EOG091G0AE9/EOG091G0AE9.ingroup.fasta, per_gene/EOG091G0AE9/EOG091G0AE9.outgroup.fasta
    output: per_gene/EOG091G0AE9/EOG091G0AE9.fasta
    jobid: 2134
    wildcards: BUSCO=EOG091G0AE9


        cat per_gene/EOG091G0AE9/EOG091G0AE9.ingroup.fasta per_gene/EOG091G0AE9/EOG091G0AE9.outgroup.fasta > per_gene/EOG091G0AE9/EOG091G0AE9.fasta
        
[Sun Jul  5 23:15:35 2020]
Finished job 2134.
1908 of 3292 steps (58%) done

[Sun Jul  5 23:15:35 2020]
rule MSA:
    input: per_gene/EOG091G0AE9/EOG091G0AE9.fasta
    output: per_gene/EOG091G0AE9/EOG091G0AE9.clustalo.fasta
    log: per_gene/EOG091G0AE9/MSA.stdout.txt, per_gene/EOG091G0AE9/MSA.stderr.txt
    jobid: 1388
    wildcards: BUSCO=EOG091G0AE9
    threads: 2


        clustalo -i per_gene/EOG091G0AE9/EOG091G0AE9.fasta -o per_gene/EOG091G0AE9/EOG091G0AE9.clustalo.fasta --threads=2 1> per_gene/EOG091G0AE9/MSA.stdout.txt 2> per_gene/EOG091G0AE9/MSA.stderr.txt
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/d68c9691725a7401923680874285c430.simg
[Sun Jul  5 23:15:35 2020]
Finished job 2878.
1909 of 3292 steps (58%) done

[Sun Jul  5 23:15:35 2020]
rule get_outgroups:
    input: per_gene/EOG091G0VQK/EOG091G0VQK.ingroup.fasta
    output: per_gene/EOG091G0VQK/EOG091G0VQK.orthodb.fasta, per_gene/EOG091G0VQK/EOG091G0VQK.outgroup.fasta
    log: per_gene/EOG091G0VQK/get_outgroups.stdout.txt, per_gene/EOG091G0VQK/get_outgroups.stderr.txt
    jobid: 2879
    wildcards: BUSCO=EOG091G0VQK


        #download fastas from Orhtodb for BUSCO id
        for i in {1..5}
        do
             wget "http://www.orthodb.org/fasta?query=EOG091G0VQK&level=33208" -O per_gene/EOG091G0VQK/EOG091G0VQK.orthodb.fasta 1> per_gene/EOG091G0VQK/get_outgroups.stdout.txt 2> per_gene/EOG091G0VQK/get_outgroups.stderr.txt && break || echo -e "try again ($i)" && sleep 15
        done

	#This is quick an dirty for now and just takes the first protein if there is more than one for an outgroup taxon
        bash ../scripts/download_outgroups.sh taxids.txt per_gene/EOG091G0VQK/EOG091G0VQK.orthodb.fasta > per_gene/EOG091G0VQK/EOG091G0VQK.outgroup.fasta
        
[Sun Jul  5 23:15:36 2020]
Finished job 2879.
1910 of 3292 steps (58%) done

[Sun Jul  5 23:15:36 2020]
rule join_groups:
    input: per_gene/EOG091G0VQK/EOG091G0VQK.ingroup.fasta, per_gene/EOG091G0VQK/EOG091G0VQK.outgroup.fasta
    output: per_gene/EOG091G0VQK/EOG091G0VQK.fasta
    jobid: 2263
    wildcards: BUSCO=EOG091G0VQK


        cat per_gene/EOG091G0VQK/EOG091G0VQK.ingroup.fasta per_gene/EOG091G0VQK/EOG091G0VQK.outgroup.fasta > per_gene/EOG091G0VQK/EOG091G0VQK.fasta
        
[Sun Jul  5 23:15:36 2020]
Finished job 2263.
1911 of 3292 steps (58%) done

[Sun Jul  5 23:15:36 2020]
rule MSA:
    input: per_gene/EOG091G0VQK/EOG091G0VQK.fasta
    output: per_gene/EOG091G0VQK/EOG091G0VQK.clustalo.fasta
    log: per_gene/EOG091G0VQK/MSA.stdout.txt, per_gene/EOG091G0VQK/MSA.stderr.txt
    jobid: 1646
    wildcards: BUSCO=EOG091G0VQK
    threads: 2


        clustalo -i per_gene/EOG091G0VQK/EOG091G0VQK.fasta -o per_gene/EOG091G0VQK/EOG091G0VQK.clustalo.fasta --threads=2 1> per_gene/EOG091G0VQK/MSA.stdout.txt 2> per_gene/EOG091G0VQK/MSA.stderr.txt
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/d68c9691725a7401923680874285c430.simg
[Sun Jul  5 23:15:37 2020]
Finished job 1388.
1912 of 3292 steps (58%) done

[Sun Jul  5 23:15:37 2020]
rule score_and_cut:
    input: per_gene/EOG091G0AE9/EOG091G0AE9.clustalo.fasta
    output: per_gene/EOG091G0AE9/ALICUT_EOG091G0AE9.clustalo.fasta
    jobid: 565
    wildcards: BUSCO=EOG091G0AE9
    threads: 2


        cd per_gene/EOG091G0AE9
        Aliscore.pl -N -r 200000000000000000 -i ../../per_gene/EOG091G0AE9/EOG091G0AE9.clustalo.fasta &> aliscore.log
        ALICUT.pl -s &> alicut.log
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/63c88c27a0fa300f57066b0ef65fefcb.simg
[Sun Jul  5 23:15:39 2020]
Finished job 1154.
1913 of 3292 steps (58%) done

[Sun Jul  5 23:15:39 2020]
rule infer_single_ML:
    input: per_gene/EOG091G0IQD/EOG091G0IQD.best_model, per_gene/EOG091G0IQD/ALICUT_EOG091G0IQD.clustalo.fasta
    output: per_gene/EOG091G0IQD/EOG091G0IQD.raxml.done
    log: per_gene/EOG091G0IQD/infer_single_ML.stdout.txt, per_gene/EOG091G0IQD/infer_single_ML.stderr.txt
    jobid: 371
    wildcards: BUSCO=EOG091G0IQD
    threads: 2


        cd per_gene/EOG091G0IQD
	count=$(cat ../../per_gene/EOG091G0IQD/ALICUT_EOG091G0IQD.clustalo.fasta | grep ">" | wc -l)
	if [ "$count" -gt 5 ]
        then
		RAxMLmodel=$(cat ../../per_gene/EOG091G0IQD/EOG091G0IQD.best_model | grep "Best" | cut -d ":" -f 2 | tr -d '[:space:]')
                if [ "$(ls -1 | grep "^RAxML" | wc -l)" -ne 0 ]
		then
			rm RAxML*
		fi
        	raxml -f a -T 2 -m PROTGAMMA$RAxMLmodel         	-p 12345 -x 12345 -# 100         	-s ../../per_gene/EOG091G0IQD/ALICUT_EOG091G0IQD.clustalo.fasta -n EOG091G0IQD.clustalo.aln.ALICUT.$RAxMLmodel 		1> ../../per_gene/EOG091G0IQD/infer_single_ML.stdout.txt 2> ../../per_gene/EOG091G0IQD/infer_single_ML.stderr.txt
	else
		echo "fasta file per_gene/EOG091G0IQD/ALICUT_EOG091G0IQD.clustalo.fasta contains fewer than 5 sequences - skipped" > ../../per_gene/EOG091G0IQD/infer_single_ML.stdout.txt
		touch raxml.skipped
	fi
        touch ../../per_gene/EOG091G0IQD/EOG091G0IQD.raxml.done
        
[Sun Jul  5 23:15:39 2020]
Finished job 2790.
1914 of 3292 steps (58%) done

[Sun Jul  5 23:15:39 2020]
rule get_outgroups:
    input: per_gene/EOG091G0NNO/EOG091G0NNO.ingroup.fasta
    output: per_gene/EOG091G0NNO/EOG091G0NNO.orthodb.fasta, per_gene/EOG091G0NNO/EOG091G0NNO.outgroup.fasta
    log: per_gene/EOG091G0NNO/get_outgroups.stdout.txt, per_gene/EOG091G0NNO/get_outgroups.stderr.txt
    jobid: 2791
    wildcards: BUSCO=EOG091G0NNO


        #download fastas from Orhtodb for BUSCO id
        for i in {1..5}
        do
             wget "http://www.orthodb.org/fasta?query=EOG091G0NNO&level=33208" -O per_gene/EOG091G0NNO/EOG091G0NNO.orthodb.fasta 1> per_gene/EOG091G0NNO/get_outgroups.stdout.txt 2> per_gene/EOG091G0NNO/get_outgroups.stderr.txt && break || echo -e "try again ($i)" && sleep 15
        done

	#This is quick an dirty for now and just takes the first protein if there is more than one for an outgroup taxon
        bash ../scripts/download_outgroups.sh taxids.txt per_gene/EOG091G0NNO/EOG091G0NNO.orthodb.fasta > per_gene/EOG091G0NNO/EOG091G0NNO.outgroup.fasta
        
[Sun Jul  5 23:15:40 2020]
Finished job 2791.
1915 of 3292 steps (58%) done

[Sun Jul  5 23:15:40 2020]
rule join_groups:
    input: per_gene/EOG091G0NNO/EOG091G0NNO.ingroup.fasta, per_gene/EOG091G0NNO/EOG091G0NNO.outgroup.fasta
    output: per_gene/EOG091G0NNO/EOG091G0NNO.fasta
    jobid: 2219
    wildcards: BUSCO=EOG091G0NNO


        cat per_gene/EOG091G0NNO/EOG091G0NNO.ingroup.fasta per_gene/EOG091G0NNO/EOG091G0NNO.outgroup.fasta > per_gene/EOG091G0NNO/EOG091G0NNO.fasta
        
[Sun Jul  5 23:15:40 2020]
Finished job 2219.
1916 of 3292 steps (58%) done

[Sun Jul  5 23:15:40 2020]
rule MSA:
    input: per_gene/EOG091G0NNO/EOG091G0NNO.fasta
    output: per_gene/EOG091G0NNO/EOG091G0NNO.clustalo.fasta
    log: per_gene/EOG091G0NNO/MSA.stdout.txt, per_gene/EOG091G0NNO/MSA.stderr.txt
    jobid: 1558
    wildcards: BUSCO=EOG091G0NNO
    threads: 2


        clustalo -i per_gene/EOG091G0NNO/EOG091G0NNO.fasta -o per_gene/EOG091G0NNO/EOG091G0NNO.clustalo.fasta --threads=2 1> per_gene/EOG091G0NNO/MSA.stdout.txt 2> per_gene/EOG091G0NNO/MSA.stderr.txt
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/d68c9691725a7401923680874285c430.simg
[Sun Jul  5 23:15:41 2020]
Finished job 1646.
1917 of 3292 steps (58%) done

[Sun Jul  5 23:15:41 2020]
rule score_and_cut:
    input: per_gene/EOG091G0VQK/EOG091G0VQK.clustalo.fasta
    output: per_gene/EOG091G0VQK/ALICUT_EOG091G0VQK.clustalo.fasta
    jobid: 823
    wildcards: BUSCO=EOG091G0VQK
    threads: 2


        cd per_gene/EOG091G0VQK
        Aliscore.pl -N -r 200000000000000000 -i ../../per_gene/EOG091G0VQK/EOG091G0VQK.clustalo.fasta &> aliscore.log
        ALICUT.pl -s &> alicut.log
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/63c88c27a0fa300f57066b0ef65fefcb.simg
[Sun Jul  5 23:15:42 2020]
Finished job 1558.
1918 of 3292 steps (58%) done

[Sun Jul  5 23:15:42 2020]
rule score_and_cut:
    input: per_gene/EOG091G0NNO/EOG091G0NNO.clustalo.fasta
    output: per_gene/EOG091G0NNO/ALICUT_EOG091G0NNO.clustalo.fasta
    jobid: 735
    wildcards: BUSCO=EOG091G0NNO
    threads: 2


        cd per_gene/EOG091G0NNO
        Aliscore.pl -N -r 200000000000000000 -i ../../per_gene/EOG091G0NNO/EOG091G0NNO.clustalo.fasta &> aliscore.log
        ALICUT.pl -s &> alicut.log
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/63c88c27a0fa300f57066b0ef65fefcb.simg
[Sun Jul  5 23:15:48 2020]
Finished job 565.
1919 of 3292 steps (58%) done

[Sun Jul  5 23:15:48 2020]
rule remove_empty:
    input: per_gene/EOG091G0AE9/ALICUT_EOG091G0AE9.clustalo.fasta
    output: per_gene/EOG091G0AE9/empty_check.done
    jobid: 1387
    wildcards: BUSCO=EOG091G0AE9


         if [ "$(cat per_gene/EOG091G0AE9/ALICUT_EOG091G0AE9.clustalo.fasta | grep -v ">" | sed 's/-//g' | grep "^$" | wc -l)" -gt 0 ]
         then
              cp per_gene/EOG091G0AE9/ALICUT_EOG091G0AE9.clustalo.fasta per_gene/EOG091G0AE9/ALICUT_EOG091G0AE9.clustalo.fasta.backup
              bash ../scripts/remove_empty.sh per_gene/EOG091G0AE9/ALICUT_EOG091G0AE9.clustalo.fasta.backup > per_gene/EOG091G0AE9/ALICUT_EOG091G0AE9.clustalo.fasta
         fi
         touch per_gene/EOG091G0AE9/empty_check.done
         
[Sun Jul  5 23:15:49 2020]
Finished job 1387.
1920 of 3292 steps (58%) done

[Sun Jul  5 23:15:49 2020]
rule find_best_model:
    input: per_gene/EOG091G0AE9/ALICUT_EOG091G0AE9.clustalo.fasta, per_gene/EOG091G0AE9/empty_check.done
    output: per_gene/EOG091G0AE9/EOG091G0AE9.best_model
    log: per_gene/EOG091G0AE9/find_best_model.stderr.txt
    jobid: 564
    wildcards: BUSCO=EOG091G0AE9
    threads: 2


        cd per_gene/EOG091G0AE9
        if [ ! -d find_best_model ]
        then
            mkdir find_best_model
        fi
        cd find_best_model
        ln -s ../../../per_gene/EOG091G0AE9/ALICUT_EOG091G0AE9.clustalo.fasta EOG091G0AE9.fasta
        ProteinModelSelection.pl EOG091G0AE9.fasta 1> ../../../per_gene/EOG091G0AE9/EOG091G0AE9.best_model 2> ../../../per_gene/EOG091G0AE9/find_best_model.stderr.txt
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/c0c09ee657b1e27f2c5687e0e9aa8d70.simg
[Sun Jul  5 23:15:52 2020]
Finished job 735.
1921 of 3292 steps (58%) done

[Sun Jul  5 23:15:52 2020]
rule remove_empty:
    input: per_gene/EOG091G0NNO/ALICUT_EOG091G0NNO.clustalo.fasta
    output: per_gene/EOG091G0NNO/empty_check.done
    jobid: 1557
    wildcards: BUSCO=EOG091G0NNO


         if [ "$(cat per_gene/EOG091G0NNO/ALICUT_EOG091G0NNO.clustalo.fasta | grep -v ">" | sed 's/-//g' | grep "^$" | wc -l)" -gt 0 ]
         then
              cp per_gene/EOG091G0NNO/ALICUT_EOG091G0NNO.clustalo.fasta per_gene/EOG091G0NNO/ALICUT_EOG091G0NNO.clustalo.fasta.backup
              bash ../scripts/remove_empty.sh per_gene/EOG091G0NNO/ALICUT_EOG091G0NNO.clustalo.fasta.backup > per_gene/EOG091G0NNO/ALICUT_EOG091G0NNO.clustalo.fasta
         fi
         touch per_gene/EOG091G0NNO/empty_check.done
         
[Sun Jul  5 23:15:52 2020]
Finished job 1557.
1922 of 3292 steps (58%) done

[Sun Jul  5 23:15:52 2020]
rule find_best_model:
    input: per_gene/EOG091G0NNO/ALICUT_EOG091G0NNO.clustalo.fasta, per_gene/EOG091G0NNO/empty_check.done
    output: per_gene/EOG091G0NNO/EOG091G0NNO.best_model
    log: per_gene/EOG091G0NNO/find_best_model.stderr.txt
    jobid: 734
    wildcards: BUSCO=EOG091G0NNO
    threads: 2


        cd per_gene/EOG091G0NNO
        if [ ! -d find_best_model ]
        then
            mkdir find_best_model
        fi
        cd find_best_model
        ln -s ../../../per_gene/EOG091G0NNO/ALICUT_EOG091G0NNO.clustalo.fasta EOG091G0NNO.fasta
        ProteinModelSelection.pl EOG091G0NNO.fasta 1> ../../../per_gene/EOG091G0NNO/EOG091G0NNO.best_model 2> ../../../per_gene/EOG091G0NNO/find_best_model.stderr.txt
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/c0c09ee657b1e27f2c5687e0e9aa8d70.simg
[Sun Jul  5 23:15:53 2020]
Finished job 1190.
1923 of 3292 steps (58%) done

[Sun Jul  5 23:15:53 2020]
rule infer_single_ML:
    input: per_gene/EOG091G0R3S/EOG091G0R3S.best_model, per_gene/EOG091G0R3S/ALICUT_EOG091G0R3S.clustalo.fasta
    output: per_gene/EOG091G0R3S/EOG091G0R3S.raxml.done
    log: per_gene/EOG091G0R3S/infer_single_ML.stdout.txt, per_gene/EOG091G0R3S/infer_single_ML.stderr.txt
    jobid: 389
    wildcards: BUSCO=EOG091G0R3S
    threads: 2


        cd per_gene/EOG091G0R3S
	count=$(cat ../../per_gene/EOG091G0R3S/ALICUT_EOG091G0R3S.clustalo.fasta | grep ">" | wc -l)
	if [ "$count" -gt 5 ]
        then
		RAxMLmodel=$(cat ../../per_gene/EOG091G0R3S/EOG091G0R3S.best_model | grep "Best" | cut -d ":" -f 2 | tr -d '[:space:]')
                if [ "$(ls -1 | grep "^RAxML" | wc -l)" -ne 0 ]
		then
			rm RAxML*
		fi
        	raxml -f a -T 2 -m PROTGAMMA$RAxMLmodel         	-p 12345 -x 12345 -# 100         	-s ../../per_gene/EOG091G0R3S/ALICUT_EOG091G0R3S.clustalo.fasta -n EOG091G0R3S.clustalo.aln.ALICUT.$RAxMLmodel 		1> ../../per_gene/EOG091G0R3S/infer_single_ML.stdout.txt 2> ../../per_gene/EOG091G0R3S/infer_single_ML.stderr.txt
	else
		echo "fasta file per_gene/EOG091G0R3S/ALICUT_EOG091G0R3S.clustalo.fasta contains fewer than 5 sequences - skipped" > ../../per_gene/EOG091G0R3S/infer_single_ML.stdout.txt
		touch raxml.skipped
	fi
        touch ../../per_gene/EOG091G0R3S/EOG091G0R3S.raxml.done
        
[Sun Jul  5 23:15:55 2020]
Finished job 823.
1924 of 3292 steps (58%) done

[Sun Jul  5 23:15:55 2020]
rule remove_empty:
    input: per_gene/EOG091G0VQK/ALICUT_EOG091G0VQK.clustalo.fasta
    output: per_gene/EOG091G0VQK/empty_check.done
    jobid: 1645
    wildcards: BUSCO=EOG091G0VQK


         if [ "$(cat per_gene/EOG091G0VQK/ALICUT_EOG091G0VQK.clustalo.fasta | grep -v ">" | sed 's/-//g' | grep "^$" | wc -l)" -gt 0 ]
         then
              cp per_gene/EOG091G0VQK/ALICUT_EOG091G0VQK.clustalo.fasta per_gene/EOG091G0VQK/ALICUT_EOG091G0VQK.clustalo.fasta.backup
              bash ../scripts/remove_empty.sh per_gene/EOG091G0VQK/ALICUT_EOG091G0VQK.clustalo.fasta.backup > per_gene/EOG091G0VQK/ALICUT_EOG091G0VQK.clustalo.fasta
         fi
         touch per_gene/EOG091G0VQK/empty_check.done
         
[Sun Jul  5 23:15:55 2020]
Finished job 1645.
1925 of 3292 steps (58%) done

[Sun Jul  5 23:15:55 2020]
rule find_best_model:
    input: per_gene/EOG091G0VQK/ALICUT_EOG091G0VQK.clustalo.fasta, per_gene/EOG091G0VQK/empty_check.done
    output: per_gene/EOG091G0VQK/EOG091G0VQK.best_model
    log: per_gene/EOG091G0VQK/find_best_model.stderr.txt
    jobid: 822
    wildcards: BUSCO=EOG091G0VQK
    threads: 2


        cd per_gene/EOG091G0VQK
        if [ ! -d find_best_model ]
        then
            mkdir find_best_model
        fi
        cd find_best_model
        ln -s ../../../per_gene/EOG091G0VQK/ALICUT_EOG091G0VQK.clustalo.fasta EOG091G0VQK.fasta
        ProteinModelSelection.pl EOG091G0VQK.fasta 1> ../../../per_gene/EOG091G0VQK/EOG091G0VQK.best_model 2> ../../../per_gene/EOG091G0VQK/find_best_model.stderr.txt
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/c0c09ee657b1e27f2c5687e0e9aa8d70.simg
[Sun Jul  5 23:16:23 2020]
Finished job 564.
1926 of 3292 steps (59%) done

[Sun Jul  5 23:16:23 2020]
rule infer_single_ML:
    input: per_gene/EOG091G0AE9/EOG091G0AE9.best_model, per_gene/EOG091G0AE9/ALICUT_EOG091G0AE9.clustalo.fasta
    output: per_gene/EOG091G0AE9/EOG091G0AE9.raxml.done
    log: per_gene/EOG091G0AE9/infer_single_ML.stdout.txt, per_gene/EOG091G0AE9/infer_single_ML.stderr.txt
    jobid: 76
    wildcards: BUSCO=EOG091G0AE9
    threads: 2


        cd per_gene/EOG091G0AE9
	count=$(cat ../../per_gene/EOG091G0AE9/ALICUT_EOG091G0AE9.clustalo.fasta | grep ">" | wc -l)
	if [ "$count" -gt 5 ]
        then
		RAxMLmodel=$(cat ../../per_gene/EOG091G0AE9/EOG091G0AE9.best_model | grep "Best" | cut -d ":" -f 2 | tr -d '[:space:]')
                if [ "$(ls -1 | grep "^RAxML" | wc -l)" -ne 0 ]
		then
			rm RAxML*
		fi
        	raxml -f a -T 2 -m PROTGAMMA$RAxMLmodel         	-p 12345 -x 12345 -# 100         	-s ../../per_gene/EOG091G0AE9/ALICUT_EOG091G0AE9.clustalo.fasta -n EOG091G0AE9.clustalo.aln.ALICUT.$RAxMLmodel 		1> ../../per_gene/EOG091G0AE9/infer_single_ML.stdout.txt 2> ../../per_gene/EOG091G0AE9/infer_single_ML.stderr.txt
	else
		echo "fasta file per_gene/EOG091G0AE9/ALICUT_EOG091G0AE9.clustalo.fasta contains fewer than 5 sequences - skipped" > ../../per_gene/EOG091G0AE9/infer_single_ML.stdout.txt
		touch raxml.skipped
	fi
        touch ../../per_gene/EOG091G0AE9/EOG091G0AE9.raxml.done
        
[Sun Jul  5 23:16:23 2020]
Finished job 734.
1927 of 3292 steps (59%) done

[Sun Jul  5 23:16:23 2020]
rule infer_single_ML:
    input: per_gene/EOG091G0NNO/EOG091G0NNO.best_model, per_gene/EOG091G0NNO/ALICUT_EOG091G0NNO.clustalo.fasta
    output: per_gene/EOG091G0NNO/EOG091G0NNO.raxml.done
    log: per_gene/EOG091G0NNO/infer_single_ML.stdout.txt, per_gene/EOG091G0NNO/infer_single_ML.stderr.txt
    jobid: 161
    wildcards: BUSCO=EOG091G0NNO
    threads: 2


        cd per_gene/EOG091G0NNO
	count=$(cat ../../per_gene/EOG091G0NNO/ALICUT_EOG091G0NNO.clustalo.fasta | grep ">" | wc -l)
	if [ "$count" -gt 5 ]
        then
		RAxMLmodel=$(cat ../../per_gene/EOG091G0NNO/EOG091G0NNO.best_model | grep "Best" | cut -d ":" -f 2 | tr -d '[:space:]')
                if [ "$(ls -1 | grep "^RAxML" | wc -l)" -ne 0 ]
		then
			rm RAxML*
		fi
        	raxml -f a -T 2 -m PROTGAMMA$RAxMLmodel         	-p 12345 -x 12345 -# 100         	-s ../../per_gene/EOG091G0NNO/ALICUT_EOG091G0NNO.clustalo.fasta -n EOG091G0NNO.clustalo.aln.ALICUT.$RAxMLmodel 		1> ../../per_gene/EOG091G0NNO/infer_single_ML.stdout.txt 2> ../../per_gene/EOG091G0NNO/infer_single_ML.stderr.txt
	else
		echo "fasta file per_gene/EOG091G0NNO/ALICUT_EOG091G0NNO.clustalo.fasta contains fewer than 5 sequences - skipped" > ../../per_gene/EOG091G0NNO/infer_single_ML.stdout.txt
		touch raxml.skipped
	fi
        touch ../../per_gene/EOG091G0NNO/EOG091G0NNO.raxml.done
        
[Sun Jul  5 23:16:24 2020]
Finished job 822.
1928 of 3292 steps (59%) done

[Sun Jul  5 23:16:24 2020]
rule infer_single_ML:
    input: per_gene/EOG091G0VQK/EOG091G0VQK.best_model, per_gene/EOG091G0VQK/ALICUT_EOG091G0VQK.clustalo.fasta
    output: per_gene/EOG091G0VQK/EOG091G0VQK.raxml.done
    log: per_gene/EOG091G0VQK/infer_single_ML.stdout.txt, per_gene/EOG091G0VQK/infer_single_ML.stderr.txt
    jobid: 205
    wildcards: BUSCO=EOG091G0VQK
    threads: 2


        cd per_gene/EOG091G0VQK
	count=$(cat ../../per_gene/EOG091G0VQK/ALICUT_EOG091G0VQK.clustalo.fasta | grep ">" | wc -l)
	if [ "$count" -gt 5 ]
        then
		RAxMLmodel=$(cat ../../per_gene/EOG091G0VQK/EOG091G0VQK.best_model | grep "Best" | cut -d ":" -f 2 | tr -d '[:space:]')
                if [ "$(ls -1 | grep "^RAxML" | wc -l)" -ne 0 ]
		then
			rm RAxML*
		fi
        	raxml -f a -T 2 -m PROTGAMMA$RAxMLmodel         	-p 12345 -x 12345 -# 100         	-s ../../per_gene/EOG091G0VQK/ALICUT_EOG091G0VQK.clustalo.fasta -n EOG091G0VQK.clustalo.aln.ALICUT.$RAxMLmodel 		1> ../../per_gene/EOG091G0VQK/infer_single_ML.stdout.txt 2> ../../per_gene/EOG091G0VQK/infer_single_ML.stderr.txt
	else
		echo "fasta file per_gene/EOG091G0VQK/ALICUT_EOG091G0VQK.clustalo.fasta contains fewer than 5 sequences - skipped" > ../../per_gene/EOG091G0VQK/infer_single_ML.stdout.txt
		touch raxml.skipped
	fi
        touch ../../per_gene/EOG091G0VQK/EOG091G0VQK.raxml.done
        
[Sun Jul  5 23:16:30 2020]
Finished job 386.
1929 of 3292 steps (59%) done

[Sun Jul  5 23:16:30 2020]
rule get_seqs:
    input: /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ingroup.txt, /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/outgroup.txt
    output: per_gene/EOG091G0HYF/EOG091G0HYF.ingroup.fasta
    log: per_gene/EOG091G0HYF/get_seqs.stdout.txt, per_gene/EOG091G0HYF/get_seqs.stderr.txt
    jobid: 3202
    wildcards: BUSCO=EOG091G0HYF
    threads: 2


	basedir=$(pwd)
        cd per_gene/EOG091G0HYF
        
        bash $basedir/../scripts/fetch_seqs.sh EOG091G0HYF /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ingroup.txt /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/outgroup.txt 1> ../../per_gene/EOG091G0HYF/get_seqs.stdout.txt 2> ../../per_gene/EOG091G0HYF/get_seqs.stderr.txt
	mv EOG091G0HYF.fasta $basedir/per_gene/EOG091G0HYF/EOG091G0HYF.ingroup.fasta
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/72476f9d9a5bd0627b4d721143a21354.simg
[33mJob counts:
	count	jobs
	1	infer_single_ML
	1[0m
[33m
        cd per_gene/EOG091G0IQD
	count=$(cat ../../per_gene/EOG091G0IQD/ALICUT_EOG091G0IQD.clustalo.fasta | grep ">" | wc -l)
	if [ "$count" -gt 5 ]
        then
		RAxMLmodel=$(cat ../../per_gene/EOG091G0IQD/EOG091G0IQD.best_model | grep "Best" | cut -d ":" -f 2 | tr -d '[:space:]')
                if [ "$(ls -1 | grep "^RAxML" | wc -l)" -ne 0 ]
		then
			rm RAxML*
		fi
        	raxml -f a -T 2 -m PROTGAMMA$RAxMLmodel         	-p 12345 -x 12345 -# 100         	-s ../../per_gene/EOG091G0IQD/ALICUT_EOG091G0IQD.clustalo.fasta -n EOG091G0IQD.clustalo.aln.ALICUT.$RAxMLmodel 		1> ../../per_gene/EOG091G0IQD/infer_single_ML.stdout.txt 2> ../../per_gene/EOG091G0IQD/infer_single_ML.stderr.txt
	else
		echo "fasta file per_gene/EOG091G0IQD/ALICUT_EOG091G0IQD.clustalo.fasta contains fewer than 5 sequences - skipped" > ../../per_gene/EOG091G0IQD/infer_single_ML.stdout.txt
		touch raxml.skipped
	fi
        touch ../../per_gene/EOG091G0IQD/EOG091G0IQD.raxml.done
        [0m
[33mJob counts:
	count	jobs
	1	infer_single_ML
	1[0m
[33m
        cd per_gene/EOG091G0NNO
	count=$(cat ../../per_gene/EOG091G0NNO/ALICUT_EOG091G0NNO.clustalo.fasta | grep ">" | wc -l)
	if [ "$count" -gt 5 ]
        then
		RAxMLmodel=$(cat ../../per_gene/EOG091G0NNO/EOG091G0NNO.best_model | grep "Best" | cut -d ":" -f 2 | tr -d '[:space:]')
                if [ "$(ls -1 | grep "^RAxML" | wc -l)" -ne 0 ]
		then
			rm RAxML*
		fi
        	raxml -f a -T 2 -m PROTGAMMA$RAxMLmodel         	-p 12345 -x 12345 -# 100         	-s ../../per_gene/EOG091G0NNO/ALICUT_EOG091G0NNO.clustalo.fasta -n EOG091G0NNO.clustalo.aln.ALICUT.$RAxMLmodel 		1> ../../per_gene/EOG091G0NNO/infer_single_ML.stdout.txt 2> ../../per_gene/EOG091G0NNO/infer_single_ML.stderr.txt
	else
		echo "fasta file per_gene/EOG091G0NNO/ALICUT_EOG091G0NNO.clustalo.fasta contains fewer than 5 sequences - skipped" > ../../per_gene/EOG091G0NNO/infer_single_ML.stdout.txt
		touch raxml.skipped
	fi
        touch ../../per_gene/EOG091G0NNO/EOG091G0NNO.raxml.done
        [0m
[33mJob counts:
	count	jobs
	1	infer_single_ML
	1[0m
[33m
        cd per_gene/EOG091G0AE9
	count=$(cat ../../per_gene/EOG091G0AE9/ALICUT_EOG091G0AE9.clustalo.fasta | grep ">" | wc -l)
	if [ "$count" -gt 5 ]
        then
		RAxMLmodel=$(cat ../../per_gene/EOG091G0AE9/EOG091G0AE9.best_model | grep "Best" | cut -d ":" -f 2 | tr -d '[:space:]')
                if [ "$(ls -1 | grep "^RAxML" | wc -l)" -ne 0 ]
		then
			rm RAxML*
		fi
        	raxml -f a -T 2 -m PROTGAMMA$RAxMLmodel         	-p 12345 -x 12345 -# 100         	-s ../../per_gene/EOG091G0AE9/ALICUT_EOG091G0AE9.clustalo.fasta -n EOG091G0AE9.clustalo.aln.ALICUT.$RAxMLmodel 		1> ../../per_gene/EOG091G0AE9/infer_single_ML.stdout.txt 2> ../../per_gene/EOG091G0AE9/infer_single_ML.stderr.txt
	else
		echo "fasta file per_gene/EOG091G0AE9/ALICUT_EOG091G0AE9.clustalo.fasta contains fewer than 5 sequences - skipped" > ../../per_gene/EOG091G0AE9/infer_single_ML.stdout.txt
		touch raxml.skipped
	fi
        touch ../../per_gene/EOG091G0AE9/EOG091G0AE9.raxml.done
        [0m
[33mJob counts:
	count	jobs
	1	infer_single_ML
	1[0m
[33m
        cd per_gene/EOG091G0R3S
	count=$(cat ../../per_gene/EOG091G0R3S/ALICUT_EOG091G0R3S.clustalo.fasta | grep ">" | wc -l)
	if [ "$count" -gt 5 ]
        then
		RAxMLmodel=$(cat ../../per_gene/EOG091G0R3S/EOG091G0R3S.best_model | grep "Best" | cut -d ":" -f 2 | tr -d '[:space:]')
                if [ "$(ls -1 | grep "^RAxML" | wc -l)" -ne 0 ]
		then
			rm RAxML*
		fi
        	raxml -f a -T 2 -m PROTGAMMA$RAxMLmodel         	-p 12345 -x 12345 -# 100         	-s ../../per_gene/EOG091G0R3S/ALICUT_EOG091G0R3S.clustalo.fasta -n EOG091G0R3S.clustalo.aln.ALICUT.$RAxMLmodel 		1> ../../per_gene/EOG091G0R3S/infer_single_ML.stdout.txt 2> ../../per_gene/EOG091G0R3S/infer_single_ML.stderr.txt
	else
		echo "fasta file per_gene/EOG091G0R3S/ALICUT_EOG091G0R3S.clustalo.fasta contains fewer than 5 sequences - skipped" > ../../per_gene/EOG091G0R3S/infer_single_ML.stdout.txt
		touch raxml.skipped
	fi
        touch ../../per_gene/EOG091G0R3S/EOG091G0R3S.raxml.done
        [0m
[33mJob counts:
	count	jobs
	1	infer_single_ML
	1[0m
[33m
        cd per_gene/EOG091G0VQK
	count=$(cat ../../per_gene/EOG091G0VQK/ALICUT_EOG091G0VQK.clustalo.fasta | grep ">" | wc -l)
	if [ "$count" -gt 5 ]
        then
		RAxMLmodel=$(cat ../../per_gene/EOG091G0VQK/EOG091G0VQK.best_model | grep "Best" | cut -d ":" -f 2 | tr -d '[:space:]')
                if [ "$(ls -1 | grep "^RAxML" | wc -l)" -ne 0 ]
		then
			rm RAxML*
		fi
        	raxml -f a -T 2 -m PROTGAMMA$RAxMLmodel         	-p 12345 -x 12345 -# 100         	-s ../../per_gene/EOG091G0VQK/ALICUT_EOG091G0VQK.clustalo.fasta -n EOG091G0VQK.clustalo.aln.ALICUT.$RAxMLmodel 		1> ../../per_gene/EOG091G0VQK/infer_single_ML.stdout.txt 2> ../../per_gene/EOG091G0VQK/infer_single_ML.stderr.txt
	else
		echo "fasta file per_gene/EOG091G0VQK/ALICUT_EOG091G0VQK.clustalo.fasta contains fewer than 5 sequences - skipped" > ../../per_gene/EOG091G0VQK/infer_single_ML.stdout.txt
		touch raxml.skipped
	fi
        touch ../../per_gene/EOG091G0VQK/EOG091G0VQK.raxml.done
        [0m
[Sun Jul  5 23:16:43 2020]
Finished job 3202.
1930 of 3292 steps (59%) done

[Sun Jul  5 23:16:43 2020]
rule get_outgroups:
    input: per_gene/EOG091G0HYF/EOG091G0HYF.ingroup.fasta
    output: per_gene/EOG091G0HYF/EOG091G0HYF.orthodb.fasta, per_gene/EOG091G0HYF/EOG091G0HYF.outgroup.fasta
    log: per_gene/EOG091G0HYF/get_outgroups.stdout.txt, per_gene/EOG091G0HYF/get_outgroups.stderr.txt
    jobid: 3203
    wildcards: BUSCO=EOG091G0HYF


        #download fastas from Orhtodb for BUSCO id
        for i in {1..5}
        do
             wget "http://www.orthodb.org/fasta?query=EOG091G0HYF&level=33208" -O per_gene/EOG091G0HYF/EOG091G0HYF.orthodb.fasta 1> per_gene/EOG091G0HYF/get_outgroups.stdout.txt 2> per_gene/EOG091G0HYF/get_outgroups.stderr.txt && break || echo -e "try again ($i)" && sleep 15
        done

	#This is quick an dirty for now and just takes the first protein if there is more than one for an outgroup taxon
        bash ../scripts/download_outgroups.sh taxids.txt per_gene/EOG091G0HYF/EOG091G0HYF.orthodb.fasta > per_gene/EOG091G0HYF/EOG091G0HYF.outgroup.fasta
        
[Sun Jul  5 23:16:44 2020]
Finished job 3203.
1931 of 3292 steps (59%) done

[Sun Jul  5 23:16:44 2020]
rule join_groups:
    input: per_gene/EOG091G0HYF/EOG091G0HYF.ingroup.fasta, per_gene/EOG091G0HYF/EOG091G0HYF.outgroup.fasta
    output: per_gene/EOG091G0HYF/EOG091G0HYF.fasta
    jobid: 2425
    wildcards: BUSCO=EOG091G0HYF


        cat per_gene/EOG091G0HYF/EOG091G0HYF.ingroup.fasta per_gene/EOG091G0HYF/EOG091G0HYF.outgroup.fasta > per_gene/EOG091G0HYF/EOG091G0HYF.fasta
        
[Sun Jul  5 23:16:44 2020]
Finished job 2425.
1932 of 3292 steps (59%) done

[Sun Jul  5 23:16:44 2020]
rule MSA:
    input: per_gene/EOG091G0HYF/EOG091G0HYF.fasta
    output: per_gene/EOG091G0HYF/EOG091G0HYF.clustalo.fasta
    log: per_gene/EOG091G0HYF/MSA.stdout.txt, per_gene/EOG091G0HYF/MSA.stderr.txt
    jobid: 1970
    wildcards: BUSCO=EOG091G0HYF
    threads: 2


        clustalo -i per_gene/EOG091G0HYF/EOG091G0HYF.fasta -o per_gene/EOG091G0HYF/EOG091G0HYF.clustalo.fasta --threads=2 1> per_gene/EOG091G0HYF/MSA.stdout.txt 2> per_gene/EOG091G0HYF/MSA.stderr.txt
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/d68c9691725a7401923680874285c430.simg
[Sun Jul  5 23:16:44 2020]
Finished job 1970.
1933 of 3292 steps (59%) done

[Sun Jul  5 23:16:44 2020]
rule score_and_cut:
    input: per_gene/EOG091G0HYF/EOG091G0HYF.clustalo.fasta
    output: per_gene/EOG091G0HYF/ALICUT_EOG091G0HYF.clustalo.fasta
    jobid: 1147
    wildcards: BUSCO=EOG091G0HYF
    threads: 2


        cd per_gene/EOG091G0HYF
        Aliscore.pl -N -r 200000000000000000 -i ../../per_gene/EOG091G0HYF/EOG091G0HYF.clustalo.fasta &> aliscore.log
        ALICUT.pl -s &> alicut.log
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/63c88c27a0fa300f57066b0ef65fefcb.simg
[Sun Jul  5 23:16:55 2020]
Finished job 1147.
1934 of 3292 steps (59%) done

[Sun Jul  5 23:16:55 2020]
rule remove_empty:
    input: per_gene/EOG091G0HYF/ALICUT_EOG091G0HYF.clustalo.fasta
    output: per_gene/EOG091G0HYF/empty_check.done
    jobid: 1969
    wildcards: BUSCO=EOG091G0HYF


         if [ "$(cat per_gene/EOG091G0HYF/ALICUT_EOG091G0HYF.clustalo.fasta | grep -v ">" | sed 's/-//g' | grep "^$" | wc -l)" -gt 0 ]
         then
              cp per_gene/EOG091G0HYF/ALICUT_EOG091G0HYF.clustalo.fasta per_gene/EOG091G0HYF/ALICUT_EOG091G0HYF.clustalo.fasta.backup
              bash ../scripts/remove_empty.sh per_gene/EOG091G0HYF/ALICUT_EOG091G0HYF.clustalo.fasta.backup > per_gene/EOG091G0HYF/ALICUT_EOG091G0HYF.clustalo.fasta
         fi
         touch per_gene/EOG091G0HYF/empty_check.done
         
[Sun Jul  5 23:16:55 2020]
Finished job 1969.
1935 of 3292 steps (59%) done

[Sun Jul  5 23:16:55 2020]
rule find_best_model:
    input: per_gene/EOG091G0HYF/ALICUT_EOG091G0HYF.clustalo.fasta, per_gene/EOG091G0HYF/empty_check.done
    output: per_gene/EOG091G0HYF/EOG091G0HYF.best_model
    log: per_gene/EOG091G0HYF/find_best_model.stderr.txt
    jobid: 1146
    wildcards: BUSCO=EOG091G0HYF
    threads: 2


        cd per_gene/EOG091G0HYF
        if [ ! -d find_best_model ]
        then
            mkdir find_best_model
        fi
        cd find_best_model
        ln -s ../../../per_gene/EOG091G0HYF/ALICUT_EOG091G0HYF.clustalo.fasta EOG091G0HYF.fasta
        ProteinModelSelection.pl EOG091G0HYF.fasta 1> ../../../per_gene/EOG091G0HYF/EOG091G0HYF.best_model 2> ../../../per_gene/EOG091G0HYF/find_best_model.stderr.txt
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/c0c09ee657b1e27f2c5687e0e9aa8d70.simg
[Sun Jul  5 23:17:21 2020]
Finished job 1146.
1936 of 3292 steps (59%) done

[Sun Jul  5 23:17:21 2020]
rule infer_single_ML:
    input: per_gene/EOG091G0HYF/EOG091G0HYF.best_model, per_gene/EOG091G0HYF/ALICUT_EOG091G0HYF.clustalo.fasta
    output: per_gene/EOG091G0HYF/EOG091G0HYF.raxml.done
    log: per_gene/EOG091G0HYF/infer_single_ML.stdout.txt, per_gene/EOG091G0HYF/infer_single_ML.stderr.txt
    jobid: 367
    wildcards: BUSCO=EOG091G0HYF
    threads: 2


        cd per_gene/EOG091G0HYF
	count=$(cat ../../per_gene/EOG091G0HYF/ALICUT_EOG091G0HYF.clustalo.fasta | grep ">" | wc -l)
	if [ "$count" -gt 5 ]
        then
		RAxMLmodel=$(cat ../../per_gene/EOG091G0HYF/EOG091G0HYF.best_model | grep "Best" | cut -d ":" -f 2 | tr -d '[:space:]')
                if [ "$(ls -1 | grep "^RAxML" | wc -l)" -ne 0 ]
		then
			rm RAxML*
		fi
        	raxml -f a -T 2 -m PROTGAMMA$RAxMLmodel         	-p 12345 -x 12345 -# 100         	-s ../../per_gene/EOG091G0HYF/ALICUT_EOG091G0HYF.clustalo.fasta -n EOG091G0HYF.clustalo.aln.ALICUT.$RAxMLmodel 		1> ../../per_gene/EOG091G0HYF/infer_single_ML.stdout.txt 2> ../../per_gene/EOG091G0HYF/infer_single_ML.stderr.txt
	else
		echo "fasta file per_gene/EOG091G0HYF/ALICUT_EOG091G0HYF.clustalo.fasta contains fewer than 5 sequences - skipped" > ../../per_gene/EOG091G0HYF/infer_single_ML.stdout.txt
		touch raxml.skipped
	fi
        touch ../../per_gene/EOG091G0HYF/EOG091G0HYF.raxml.done
        
[33mJob counts:
	count	jobs
	1	infer_single_ML
	1[0m
[33m
        cd per_gene/EOG091G0HYF
	count=$(cat ../../per_gene/EOG091G0HYF/ALICUT_EOG091G0HYF.clustalo.fasta | grep ">" | wc -l)
	if [ "$count" -gt 5 ]
        then
		RAxMLmodel=$(cat ../../per_gene/EOG091G0HYF/EOG091G0HYF.best_model | grep "Best" | cut -d ":" -f 2 | tr -d '[:space:]')
                if [ "$(ls -1 | grep "^RAxML" | wc -l)" -ne 0 ]
		then
			rm RAxML*
		fi
        	raxml -f a -T 2 -m PROTGAMMA$RAxMLmodel         	-p 12345 -x 12345 -# 100         	-s ../../per_gene/EOG091G0HYF/ALICUT_EOG091G0HYF.clustalo.fasta -n EOG091G0HYF.clustalo.aln.ALICUT.$RAxMLmodel 		1> ../../per_gene/EOG091G0HYF/infer_single_ML.stdout.txt 2> ../../per_gene/EOG091G0HYF/infer_single_ML.stderr.txt
	else
		echo "fasta file per_gene/EOG091G0HYF/ALICUT_EOG091G0HYF.clustalo.fasta contains fewer than 5 sequences - skipped" > ../../per_gene/EOG091G0HYF/infer_single_ML.stdout.txt
		touch raxml.skipped
	fi
        touch ../../per_gene/EOG091G0HYF/EOG091G0HYF.raxml.done
        [0m
[Sun Jul  5 23:18:15 2020]
Finished job 309.
1937 of 3292 steps (59%) done

[Sun Jul  5 23:18:15 2020]
rule get_seqs:
    input: /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ingroup.txt, /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/outgroup.txt
    output: per_gene/EOG091G0O7O/EOG091G0O7O.ingroup.fasta
    log: per_gene/EOG091G0O7O/get_seqs.stdout.txt, per_gene/EOG091G0O7O/get_seqs.stderr.txt
    jobid: 3280
    wildcards: BUSCO=EOG091G0O7O
    threads: 2


	basedir=$(pwd)
        cd per_gene/EOG091G0O7O
        
        bash $basedir/../scripts/fetch_seqs.sh EOG091G0O7O /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ingroup.txt /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/outgroup.txt 1> ../../per_gene/EOG091G0O7O/get_seqs.stdout.txt 2> ../../per_gene/EOG091G0O7O/get_seqs.stderr.txt
	mv EOG091G0O7O.fasta $basedir/per_gene/EOG091G0O7O/EOG091G0O7O.ingroup.fasta
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/72476f9d9a5bd0627b4d721143a21354.simg
[Sun Jul  5 23:18:27 2020]
Finished job 3280.
1938 of 3292 steps (59%) done

[Sun Jul  5 23:18:27 2020]
rule get_outgroups:
    input: per_gene/EOG091G0O7O/EOG091G0O7O.ingroup.fasta
    output: per_gene/EOG091G0O7O/EOG091G0O7O.orthodb.fasta, per_gene/EOG091G0O7O/EOG091G0O7O.outgroup.fasta
    log: per_gene/EOG091G0O7O/get_outgroups.stdout.txt, per_gene/EOG091G0O7O/get_outgroups.stderr.txt
    jobid: 3281
    wildcards: BUSCO=EOG091G0O7O


        #download fastas from Orhtodb for BUSCO id
        for i in {1..5}
        do
             wget "http://www.orthodb.org/fasta?query=EOG091G0O7O&level=33208" -O per_gene/EOG091G0O7O/EOG091G0O7O.orthodb.fasta 1> per_gene/EOG091G0O7O/get_outgroups.stdout.txt 2> per_gene/EOG091G0O7O/get_outgroups.stderr.txt && break || echo -e "try again ($i)" && sleep 15
        done

	#This is quick an dirty for now and just takes the first protein if there is more than one for an outgroup taxon
        bash ../scripts/download_outgroups.sh taxids.txt per_gene/EOG091G0O7O/EOG091G0O7O.orthodb.fasta > per_gene/EOG091G0O7O/EOG091G0O7O.outgroup.fasta
        
[Sun Jul  5 23:18:28 2020]
Finished job 3281.
1939 of 3292 steps (59%) done

[Sun Jul  5 23:18:28 2020]
rule join_groups:
    input: per_gene/EOG091G0O7O/EOG091G0O7O.ingroup.fasta, per_gene/EOG091G0O7O/EOG091G0O7O.outgroup.fasta
    output: per_gene/EOG091G0O7O/EOG091G0O7O.fasta
    jobid: 2464
    wildcards: BUSCO=EOG091G0O7O


        cat per_gene/EOG091G0O7O/EOG091G0O7O.ingroup.fasta per_gene/EOG091G0O7O/EOG091G0O7O.outgroup.fasta > per_gene/EOG091G0O7O/EOG091G0O7O.fasta
        
[Sun Jul  5 23:18:28 2020]
Finished job 2464.
1940 of 3292 steps (59%) done

[Sun Jul  5 23:18:28 2020]
rule MSA:
    input: per_gene/EOG091G0O7O/EOG091G0O7O.fasta
    output: per_gene/EOG091G0O7O/EOG091G0O7O.clustalo.fasta
    log: per_gene/EOG091G0O7O/MSA.stdout.txt, per_gene/EOG091G0O7O/MSA.stderr.txt
    jobid: 2048
    wildcards: BUSCO=EOG091G0O7O
    threads: 2


        clustalo -i per_gene/EOG091G0O7O/EOG091G0O7O.fasta -o per_gene/EOG091G0O7O/EOG091G0O7O.clustalo.fasta --threads=2 1> per_gene/EOG091G0O7O/MSA.stdout.txt 2> per_gene/EOG091G0O7O/MSA.stderr.txt
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/d68c9691725a7401923680874285c430.simg
[Sun Jul  5 23:18:30 2020]
Finished job 2048.
1941 of 3292 steps (59%) done

[Sun Jul  5 23:18:30 2020]
rule score_and_cut:
    input: per_gene/EOG091G0O7O/EOG091G0O7O.clustalo.fasta
    output: per_gene/EOG091G0O7O/ALICUT_EOG091G0O7O.clustalo.fasta
    jobid: 1225
    wildcards: BUSCO=EOG091G0O7O
    threads: 2


        cd per_gene/EOG091G0O7O
        Aliscore.pl -N -r 200000000000000000 -i ../../per_gene/EOG091G0O7O/EOG091G0O7O.clustalo.fasta &> aliscore.log
        ALICUT.pl -s &> alicut.log
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/63c88c27a0fa300f57066b0ef65fefcb.simg
[Sun Jul  5 23:18:41 2020]
Finished job 1225.
1942 of 3292 steps (59%) done

[Sun Jul  5 23:18:41 2020]
rule remove_empty:
    input: per_gene/EOG091G0O7O/ALICUT_EOG091G0O7O.clustalo.fasta
    output: per_gene/EOG091G0O7O/empty_check.done
    jobid: 2047
    wildcards: BUSCO=EOG091G0O7O


         if [ "$(cat per_gene/EOG091G0O7O/ALICUT_EOG091G0O7O.clustalo.fasta | grep -v ">" | sed 's/-//g' | grep "^$" | wc -l)" -gt 0 ]
         then
              cp per_gene/EOG091G0O7O/ALICUT_EOG091G0O7O.clustalo.fasta per_gene/EOG091G0O7O/ALICUT_EOG091G0O7O.clustalo.fasta.backup
              bash ../scripts/remove_empty.sh per_gene/EOG091G0O7O/ALICUT_EOG091G0O7O.clustalo.fasta.backup > per_gene/EOG091G0O7O/ALICUT_EOG091G0O7O.clustalo.fasta
         fi
         touch per_gene/EOG091G0O7O/empty_check.done
         
[Sun Jul  5 23:18:41 2020]
Finished job 2047.
1943 of 3292 steps (59%) done

[Sun Jul  5 23:18:41 2020]
rule find_best_model:
    input: per_gene/EOG091G0O7O/ALICUT_EOG091G0O7O.clustalo.fasta, per_gene/EOG091G0O7O/empty_check.done
    output: per_gene/EOG091G0O7O/EOG091G0O7O.best_model
    log: per_gene/EOG091G0O7O/find_best_model.stderr.txt
    jobid: 1224
    wildcards: BUSCO=EOG091G0O7O
    threads: 2


        cd per_gene/EOG091G0O7O
        if [ ! -d find_best_model ]
        then
            mkdir find_best_model
        fi
        cd find_best_model
        ln -s ../../../per_gene/EOG091G0O7O/ALICUT_EOG091G0O7O.clustalo.fasta EOG091G0O7O.fasta
        ProteinModelSelection.pl EOG091G0O7O.fasta 1> ../../../per_gene/EOG091G0O7O/EOG091G0O7O.best_model 2> ../../../per_gene/EOG091G0O7O/find_best_model.stderr.txt
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/c0c09ee657b1e27f2c5687e0e9aa8d70.simg
[Sun Jul  5 23:18:52 2020]
Finished job 110.
1944 of 3292 steps (59%) done

[Sun Jul  5 23:18:52 2020]
rule get_seqs:
    input: /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ingroup.txt, /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/outgroup.txt
    output: per_gene/EOG091G08FX/EOG091G08FX.ingroup.fasta
    log: per_gene/EOG091G08FX/get_seqs.stdout.txt, per_gene/EOG091G08FX/get_seqs.stderr.txt
    jobid: 2962
    wildcards: BUSCO=EOG091G08FX
    threads: 2


	basedir=$(pwd)
        cd per_gene/EOG091G08FX
        
        bash $basedir/../scripts/fetch_seqs.sh EOG091G08FX /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ingroup.txt /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/outgroup.txt 1> ../../per_gene/EOG091G08FX/get_seqs.stdout.txt 2> ../../per_gene/EOG091G08FX/get_seqs.stderr.txt
	mv EOG091G08FX.fasta $basedir/per_gene/EOG091G08FX/EOG091G08FX.ingroup.fasta
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/72476f9d9a5bd0627b4d721143a21354.simg
[Sun Jul  5 23:19:03 2020]
Finished job 304.
1945 of 3292 steps (59%) done

[Sun Jul  5 23:19:03 2020]
rule get_seqs:
    input: /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ingroup.txt, /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/outgroup.txt
    output: per_gene/EOG091G0EZO/EOG091G0EZO.ingroup.fasta
    log: per_gene/EOG091G0EZO/get_seqs.stdout.txt, per_gene/EOG091G0EZO/get_seqs.stderr.txt
    jobid: 2676
    wildcards: BUSCO=EOG091G0EZO
    threads: 2


	basedir=$(pwd)
        cd per_gene/EOG091G0EZO
        
        bash $basedir/../scripts/fetch_seqs.sh EOG091G0EZO /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ingroup.txt /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/outgroup.txt 1> ../../per_gene/EOG091G0EZO/get_seqs.stdout.txt 2> ../../per_gene/EOG091G0EZO/get_seqs.stderr.txt
	mv EOG091G0EZO.fasta $basedir/per_gene/EOG091G0EZO/EOG091G0EZO.ingroup.fasta
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/72476f9d9a5bd0627b4d721143a21354.simg
[Sun Jul  5 23:19:05 2020]
Finished job 2962.
1946 of 3292 steps (59%) done

[Sun Jul  5 23:19:05 2020]
rule get_outgroups:
    input: per_gene/EOG091G08FX/EOG091G08FX.ingroup.fasta
    output: per_gene/EOG091G08FX/EOG091G08FX.orthodb.fasta, per_gene/EOG091G08FX/EOG091G08FX.outgroup.fasta
    log: per_gene/EOG091G08FX/get_outgroups.stdout.txt, per_gene/EOG091G08FX/get_outgroups.stderr.txt
    jobid: 2963
    wildcards: BUSCO=EOG091G08FX


        #download fastas from Orhtodb for BUSCO id
        for i in {1..5}
        do
             wget "http://www.orthodb.org/fasta?query=EOG091G08FX&level=33208" -O per_gene/EOG091G08FX/EOG091G08FX.orthodb.fasta 1> per_gene/EOG091G08FX/get_outgroups.stdout.txt 2> per_gene/EOG091G08FX/get_outgroups.stderr.txt && break || echo -e "try again ($i)" && sleep 15
        done

	#This is quick an dirty for now and just takes the first protein if there is more than one for an outgroup taxon
        bash ../scripts/download_outgroups.sh taxids.txt per_gene/EOG091G08FX/EOG091G08FX.orthodb.fasta > per_gene/EOG091G08FX/EOG091G08FX.outgroup.fasta
        
[Sun Jul  5 23:19:06 2020]
Finished job 2963.
1947 of 3292 steps (59%) done

[Sun Jul  5 23:19:06 2020]
rule join_groups:
    input: per_gene/EOG091G08FX/EOG091G08FX.ingroup.fasta, per_gene/EOG091G08FX/EOG091G08FX.outgroup.fasta
    output: per_gene/EOG091G08FX/EOG091G08FX.fasta
    jobid: 2305
    wildcards: BUSCO=EOG091G08FX


        cat per_gene/EOG091G08FX/EOG091G08FX.ingroup.fasta per_gene/EOG091G08FX/EOG091G08FX.outgroup.fasta > per_gene/EOG091G08FX/EOG091G08FX.fasta
        
[Sun Jul  5 23:19:06 2020]
Finished job 2305.
1948 of 3292 steps (59%) done
[Sun Jul  5 23:19:06 2020]
Finished job 127.
1949 of 3292 steps (59%) done

[Sun Jul  5 23:19:06 2020]
rule get_seqs:
    input: /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ingroup.txt, /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/outgroup.txt
    output: per_gene/EOG091G0IWR/EOG091G0IWR.ingroup.fasta
    log: per_gene/EOG091G0IWR/get_seqs.stdout.txt, per_gene/EOG091G0IWR/get_seqs.stderr.txt
    jobid: 3096
    wildcards: BUSCO=EOG091G0IWR
    threads: 2


	basedir=$(pwd)
        cd per_gene/EOG091G0IWR
        
        bash $basedir/../scripts/fetch_seqs.sh EOG091G0IWR /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ingroup.txt /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/outgroup.txt 1> ../../per_gene/EOG091G0IWR/get_seqs.stdout.txt 2> ../../per_gene/EOG091G0IWR/get_seqs.stderr.txt
	mv EOG091G0IWR.fasta $basedir/per_gene/EOG091G0IWR/EOG091G0IWR.ingroup.fasta
        

Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/72476f9d9a5bd0627b4d721143a21354.simg
[Sun Jul  5 23:19:06 2020]
rule MSA:
    input: per_gene/EOG091G08FX/EOG091G08FX.fasta
    output: per_gene/EOG091G08FX/EOG091G08FX.clustalo.fasta
    log: per_gene/EOG091G08FX/MSA.stdout.txt, per_gene/EOG091G08FX/MSA.stderr.txt
    jobid: 1730
    wildcards: BUSCO=EOG091G08FX
    threads: 2


        clustalo -i per_gene/EOG091G08FX/EOG091G08FX.fasta -o per_gene/EOG091G08FX/EOG091G08FX.clustalo.fasta --threads=2 1> per_gene/EOG091G08FX/MSA.stdout.txt 2> per_gene/EOG091G08FX/MSA.stderr.txt
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/d68c9691725a7401923680874285c430.simg
[Sun Jul  5 23:19:06 2020]
Finished job 1224.
1950 of 3292 steps (59%) done

[Sun Jul  5 23:19:06 2020]
rule infer_single_ML:
    input: per_gene/EOG091G0O7O/EOG091G0O7O.best_model, per_gene/EOG091G0O7O/ALICUT_EOG091G0O7O.clustalo.fasta
    output: per_gene/EOG091G0O7O/EOG091G0O7O.raxml.done
    log: per_gene/EOG091G0O7O/infer_single_ML.stdout.txt, per_gene/EOG091G0O7O/infer_single_ML.stderr.txt
    jobid: 406
    wildcards: BUSCO=EOG091G0O7O
    threads: 2


        cd per_gene/EOG091G0O7O
	count=$(cat ../../per_gene/EOG091G0O7O/ALICUT_EOG091G0O7O.clustalo.fasta | grep ">" | wc -l)
	if [ "$count" -gt 5 ]
        then
		RAxMLmodel=$(cat ../../per_gene/EOG091G0O7O/EOG091G0O7O.best_model | grep "Best" | cut -d ":" -f 2 | tr -d '[:space:]')
                if [ "$(ls -1 | grep "^RAxML" | wc -l)" -ne 0 ]
		then
			rm RAxML*
		fi
        	raxml -f a -T 2 -m PROTGAMMA$RAxMLmodel         	-p 12345 -x 12345 -# 100         	-s ../../per_gene/EOG091G0O7O/ALICUT_EOG091G0O7O.clustalo.fasta -n EOG091G0O7O.clustalo.aln.ALICUT.$RAxMLmodel 		1> ../../per_gene/EOG091G0O7O/infer_single_ML.stdout.txt 2> ../../per_gene/EOG091G0O7O/infer_single_ML.stderr.txt
	else
		echo "fasta file per_gene/EOG091G0O7O/ALICUT_EOG091G0O7O.clustalo.fasta contains fewer than 5 sequences - skipped" > ../../per_gene/EOG091G0O7O/infer_single_ML.stdout.txt
		touch raxml.skipped
	fi
        touch ../../per_gene/EOG091G0O7O/EOG091G0O7O.raxml.done
        
[Sun Jul  5 23:19:08 2020]
Finished job 1730.
1951 of 3292 steps (59%) done

[Sun Jul  5 23:19:08 2020]
rule score_and_cut:
    input: per_gene/EOG091G08FX/EOG091G08FX.clustalo.fasta
    output: per_gene/EOG091G08FX/ALICUT_EOG091G08FX.clustalo.fasta
    jobid: 907
    wildcards: BUSCO=EOG091G08FX
    threads: 2


        cd per_gene/EOG091G08FX
        Aliscore.pl -N -r 200000000000000000 -i ../../per_gene/EOG091G08FX/EOG091G08FX.clustalo.fasta &> aliscore.log
        ALICUT.pl -s &> alicut.log
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/63c88c27a0fa300f57066b0ef65fefcb.simg
[Sun Jul  5 23:19:13 2020]
Finished job 22.
1952 of 3292 steps (59%) done

[Sun Jul  5 23:19:13 2020]
rule get_seqs:
    input: /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ingroup.txt, /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/outgroup.txt
    output: per_gene/EOG091G029K/EOG091G029K.ingroup.fasta
    log: per_gene/EOG091G029K/get_seqs.stdout.txt, per_gene/EOG091G029K/get_seqs.stderr.txt
    jobid: 3114
    wildcards: BUSCO=EOG091G029K
    threads: 2


	basedir=$(pwd)
        cd per_gene/EOG091G029K
        
        bash $basedir/../scripts/fetch_seqs.sh EOG091G029K /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ingroup.txt /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/outgroup.txt 1> ../../per_gene/EOG091G029K/get_seqs.stdout.txt 2> ../../per_gene/EOG091G029K/get_seqs.stderr.txt
	mv EOG091G029K.fasta $basedir/per_gene/EOG091G029K/EOG091G029K.ingroup.fasta
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/72476f9d9a5bd0627b4d721143a21354.simg
[Sun Jul  5 23:19:14 2020]
Finished job 2676.
1953 of 3292 steps (59%) done

[Sun Jul  5 23:19:14 2020]
rule get_outgroups:
    input: per_gene/EOG091G0EZO/EOG091G0EZO.ingroup.fasta
    output: per_gene/EOG091G0EZO/EOG091G0EZO.orthodb.fasta, per_gene/EOG091G0EZO/EOG091G0EZO.outgroup.fasta
    log: per_gene/EOG091G0EZO/get_outgroups.stdout.txt, per_gene/EOG091G0EZO/get_outgroups.stderr.txt
    jobid: 2677
    wildcards: BUSCO=EOG091G0EZO


        #download fastas from Orhtodb for BUSCO id
        for i in {1..5}
        do
             wget "http://www.orthodb.org/fasta?query=EOG091G0EZO&level=33208" -O per_gene/EOG091G0EZO/EOG091G0EZO.orthodb.fasta 1> per_gene/EOG091G0EZO/get_outgroups.stdout.txt 2> per_gene/EOG091G0EZO/get_outgroups.stderr.txt && break || echo -e "try again ($i)" && sleep 15
        done

	#This is quick an dirty for now and just takes the first protein if there is more than one for an outgroup taxon
        bash ../scripts/download_outgroups.sh taxids.txt per_gene/EOG091G0EZO/EOG091G0EZO.orthodb.fasta > per_gene/EOG091G0EZO/EOG091G0EZO.outgroup.fasta
        
[Sun Jul  5 23:19:16 2020]
Finished job 2677.
1954 of 3292 steps (59%) done

[Sun Jul  5 23:19:16 2020]
rule join_groups:
    input: per_gene/EOG091G0EZO/EOG091G0EZO.ingroup.fasta, per_gene/EOG091G0EZO/EOG091G0EZO.outgroup.fasta
    output: per_gene/EOG091G0EZO/EOG091G0EZO.fasta
    jobid: 2162
    wildcards: BUSCO=EOG091G0EZO


        cat per_gene/EOG091G0EZO/EOG091G0EZO.ingroup.fasta per_gene/EOG091G0EZO/EOG091G0EZO.outgroup.fasta > per_gene/EOG091G0EZO/EOG091G0EZO.fasta
        
[Sun Jul  5 23:19:16 2020]
Finished job 2162.
1955 of 3292 steps (59%) done

[Sun Jul  5 23:19:16 2020]
rule MSA:
    input: per_gene/EOG091G0EZO/EOG091G0EZO.fasta
    output: per_gene/EOG091G0EZO/EOG091G0EZO.clustalo.fasta
    log: per_gene/EOG091G0EZO/MSA.stdout.txt, per_gene/EOG091G0EZO/MSA.stderr.txt
    jobid: 1444
    wildcards: BUSCO=EOG091G0EZO
    threads: 2


        clustalo -i per_gene/EOG091G0EZO/EOG091G0EZO.fasta -o per_gene/EOG091G0EZO/EOG091G0EZO.clustalo.fasta --threads=2 1> per_gene/EOG091G0EZO/MSA.stdout.txt 2> per_gene/EOG091G0EZO/MSA.stderr.txt
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/d68c9691725a7401923680874285c430.simg
[Sun Jul  5 23:19:17 2020]
Finished job 1444.
1956 of 3292 steps (59%) done

[Sun Jul  5 23:19:17 2020]
rule score_and_cut:
    input: per_gene/EOG091G0EZO/EOG091G0EZO.clustalo.fasta
    output: per_gene/EOG091G0EZO/ALICUT_EOG091G0EZO.clustalo.fasta
    jobid: 621
    wildcards: BUSCO=EOG091G0EZO
    threads: 2


        cd per_gene/EOG091G0EZO
        Aliscore.pl -N -r 200000000000000000 -i ../../per_gene/EOG091G0EZO/EOG091G0EZO.clustalo.fasta &> aliscore.log
        ALICUT.pl -s &> alicut.log
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/63c88c27a0fa300f57066b0ef65fefcb.simg
[Sun Jul  5 23:19:18 2020]
Finished job 3096.
1957 of 3292 steps (59%) done

[Sun Jul  5 23:19:18 2020]
rule get_outgroups:
    input: per_gene/EOG091G0IWR/EOG091G0IWR.ingroup.fasta
    output: per_gene/EOG091G0IWR/EOG091G0IWR.orthodb.fasta, per_gene/EOG091G0IWR/EOG091G0IWR.outgroup.fasta
    log: per_gene/EOG091G0IWR/get_outgroups.stdout.txt, per_gene/EOG091G0IWR/get_outgroups.stderr.txt
    jobid: 3097
    wildcards: BUSCO=EOG091G0IWR


        #download fastas from Orhtodb for BUSCO id
        for i in {1..5}
        do
             wget "http://www.orthodb.org/fasta?query=EOG091G0IWR&level=33208" -O per_gene/EOG091G0IWR/EOG091G0IWR.orthodb.fasta 1> per_gene/EOG091G0IWR/get_outgroups.stdout.txt 2> per_gene/EOG091G0IWR/get_outgroups.stderr.txt && break || echo -e "try again ($i)" && sleep 15
        done

	#This is quick an dirty for now and just takes the first protein if there is more than one for an outgroup taxon
        bash ../scripts/download_outgroups.sh taxids.txt per_gene/EOG091G0IWR/EOG091G0IWR.orthodb.fasta > per_gene/EOG091G0IWR/EOG091G0IWR.outgroup.fasta
        
[Sun Jul  5 23:19:18 2020]
Finished job 337.
1958 of 3292 steps (59%) done

[Sun Jul  5 23:19:18 2020]
rule get_seqs:
    input: /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ingroup.txt, /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/outgroup.txt
    output: per_gene/EOG091G02O5/EOG091G02O5.ingroup.fasta
    log: per_gene/EOG091G02O5/get_seqs.stdout.txt, per_gene/EOG091G02O5/get_seqs.stderr.txt
    jobid: 2494
    wildcards: BUSCO=EOG091G02O5
    threads: 2


	basedir=$(pwd)
        cd per_gene/EOG091G02O5
        
        bash $basedir/../scripts/fetch_seqs.sh EOG091G02O5 /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ingroup.txt /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/outgroup.txt 1> ../../per_gene/EOG091G02O5/get_seqs.stdout.txt 2> ../../per_gene/EOG091G02O5/get_seqs.stderr.txt
	mv EOG091G02O5.fasta $basedir/per_gene/EOG091G02O5/EOG091G02O5.ingroup.fasta
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/72476f9d9a5bd0627b4d721143a21354.simg
[Sun Jul  5 23:19:18 2020]
Finished job 907.
1959 of 3292 steps (60%) done

[Sun Jul  5 23:19:18 2020]
rule remove_empty:
    input: per_gene/EOG091G08FX/ALICUT_EOG091G08FX.clustalo.fasta
    output: per_gene/EOG091G08FX/empty_check.done
    jobid: 1729
    wildcards: BUSCO=EOG091G08FX


         if [ "$(cat per_gene/EOG091G08FX/ALICUT_EOG091G08FX.clustalo.fasta | grep -v ">" | sed 's/-//g' | grep "^$" | wc -l)" -gt 0 ]
         then
              cp per_gene/EOG091G08FX/ALICUT_EOG091G08FX.clustalo.fasta per_gene/EOG091G08FX/ALICUT_EOG091G08FX.clustalo.fasta.backup
              bash ../scripts/remove_empty.sh per_gene/EOG091G08FX/ALICUT_EOG091G08FX.clustalo.fasta.backup > per_gene/EOG091G08FX/ALICUT_EOG091G08FX.clustalo.fasta
         fi
         touch per_gene/EOG091G08FX/empty_check.done
         

[Sun Jul  5 23:19:18 2020]
rule get_seqs:
    input: /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ingroup.txt, /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/outgroup.txt
    output: per_gene/EOG091G11OU/EOG091G11OU.ingroup.fasta
    log: per_gene/EOG091G11OU/get_seqs.stdout.txt, per_gene/EOG091G11OU/get_seqs.stderr.txt
    jobid: 2922
    wildcards: BUSCO=EOG091G11OU
    threads: 2


	basedir=$(pwd)
        cd per_gene/EOG091G11OU
        
        bash $basedir/../scripts/fetch_seqs.sh EOG091G11OU /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ingroup.txt /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/outgroup.txt 1> ../../per_gene/EOG091G11OU/get_seqs.stdout.txt 2> ../../per_gene/EOG091G11OU/get_seqs.stderr.txt
	mv EOG091G11OU.fasta $basedir/per_gene/EOG091G11OU/EOG091G11OU.ingroup.fasta
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/72476f9d9a5bd0627b4d721143a21354.simg
[Sun Jul  5 23:19:18 2020]
Finished job 1729.
1960 of 3292 steps (60%) done
[Sun Jul  5 23:19:19 2020]
Finished job 3097.
1961 of 3292 steps (60%) done

[Sun Jul  5 23:19:19 2020]
rule join_groups:
    input: per_gene/EOG091G0IWR/EOG091G0IWR.ingroup.fasta, per_gene/EOG091G0IWR/EOG091G0IWR.outgroup.fasta
    output: per_gene/EOG091G0IWR/EOG091G0IWR.fasta
    jobid: 2372
    wildcards: BUSCO=EOG091G0IWR


        cat per_gene/EOG091G0IWR/EOG091G0IWR.ingroup.fasta per_gene/EOG091G0IWR/EOG091G0IWR.outgroup.fasta > per_gene/EOG091G0IWR/EOG091G0IWR.fasta
        
[Sun Jul  5 23:19:19 2020]
Finished job 2372.
1962 of 3292 steps (60%) done

[Sun Jul  5 23:19:19 2020]
rule MSA:
    input: per_gene/EOG091G0IWR/EOG091G0IWR.fasta
    output: per_gene/EOG091G0IWR/EOG091G0IWR.clustalo.fasta
    log: per_gene/EOG091G0IWR/MSA.stdout.txt, per_gene/EOG091G0IWR/MSA.stderr.txt
    jobid: 1864
    wildcards: BUSCO=EOG091G0IWR
    threads: 2


        clustalo -i per_gene/EOG091G0IWR/EOG091G0IWR.fasta -o per_gene/EOG091G0IWR/EOG091G0IWR.clustalo.fasta --threads=2 1> per_gene/EOG091G0IWR/MSA.stdout.txt 2> per_gene/EOG091G0IWR/MSA.stderr.txt
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/d68c9691725a7401923680874285c430.simg
[Sun Jul  5 23:19:20 2020]
Finished job 1864.
1963 of 3292 steps (60%) done

[Sun Jul  5 23:19:20 2020]
rule score_and_cut:
    input: per_gene/EOG091G0IWR/EOG091G0IWR.clustalo.fasta
    output: per_gene/EOG091G0IWR/ALICUT_EOG091G0IWR.clustalo.fasta
    jobid: 1041
    wildcards: BUSCO=EOG091G0IWR
    threads: 2


        cd per_gene/EOG091G0IWR
        Aliscore.pl -N -r 200000000000000000 -i ../../per_gene/EOG091G0IWR/EOG091G0IWR.clustalo.fasta &> aliscore.log
        ALICUT.pl -s &> alicut.log
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/63c88c27a0fa300f57066b0ef65fefcb.simg
[33mJob counts:
	count	jobs
	1	infer_single_ML
	1[0m
[33m
        cd per_gene/EOG091G0O7O
	count=$(cat ../../per_gene/EOG091G0O7O/ALICUT_EOG091G0O7O.clustalo.fasta | grep ">" | wc -l)
	if [ "$count" -gt 5 ]
        then
		RAxMLmodel=$(cat ../../per_gene/EOG091G0O7O/EOG091G0O7O.best_model | grep "Best" | cut -d ":" -f 2 | tr -d '[:space:]')
                if [ "$(ls -1 | grep "^RAxML" | wc -l)" -ne 0 ]
		then
			rm RAxML*
		fi
        	raxml -f a -T 2 -m PROTGAMMA$RAxMLmodel         	-p 12345 -x 12345 -# 100         	-s ../../per_gene/EOG091G0O7O/ALICUT_EOG091G0O7O.clustalo.fasta -n EOG091G0O7O.clustalo.aln.ALICUT.$RAxMLmodel 		1> ../../per_gene/EOG091G0O7O/infer_single_ML.stdout.txt 2> ../../per_gene/EOG091G0O7O/infer_single_ML.stderr.txt
	else
		echo "fasta file per_gene/EOG091G0O7O/ALICUT_EOG091G0O7O.clustalo.fasta contains fewer than 5 sequences - skipped" > ../../per_gene/EOG091G0O7O/infer_single_ML.stdout.txt
		touch raxml.skipped
	fi
        touch ../../per_gene/EOG091G0O7O/EOG091G0O7O.raxml.done
        [0m
[Sun Jul  5 23:19:25 2020]
Finished job 3114.
1964 of 3292 steps (60%) done

[Sun Jul  5 23:19:25 2020]
rule get_outgroups:
    input: per_gene/EOG091G029K/EOG091G029K.ingroup.fasta
    output: per_gene/EOG091G029K/EOG091G029K.orthodb.fasta, per_gene/EOG091G029K/EOG091G029K.outgroup.fasta
    log: per_gene/EOG091G029K/get_outgroups.stdout.txt, per_gene/EOG091G029K/get_outgroups.stderr.txt
    jobid: 3115
    wildcards: BUSCO=EOG091G029K


        #download fastas from Orhtodb for BUSCO id
        for i in {1..5}
        do
             wget "http://www.orthodb.org/fasta?query=EOG091G029K&level=33208" -O per_gene/EOG091G029K/EOG091G029K.orthodb.fasta 1> per_gene/EOG091G029K/get_outgroups.stdout.txt 2> per_gene/EOG091G029K/get_outgroups.stderr.txt && break || echo -e "try again ($i)" && sleep 15
        done

	#This is quick an dirty for now and just takes the first protein if there is more than one for an outgroup taxon
        bash ../scripts/download_outgroups.sh taxids.txt per_gene/EOG091G029K/EOG091G029K.orthodb.fasta > per_gene/EOG091G029K/EOG091G029K.outgroup.fasta
        
[Sun Jul  5 23:19:26 2020]
Finished job 3115.
1965 of 3292 steps (60%) done

[Sun Jul  5 23:19:26 2020]
rule join_groups:
    input: per_gene/EOG091G029K/EOG091G029K.ingroup.fasta, per_gene/EOG091G029K/EOG091G029K.outgroup.fasta
    output: per_gene/EOG091G029K/EOG091G029K.fasta
    jobid: 2381
    wildcards: BUSCO=EOG091G029K


        cat per_gene/EOG091G029K/EOG091G029K.ingroup.fasta per_gene/EOG091G029K/EOG091G029K.outgroup.fasta > per_gene/EOG091G029K/EOG091G029K.fasta
        
[Sun Jul  5 23:19:26 2020]
Finished job 2381.
1966 of 3292 steps (60%) done

[Sun Jul  5 23:19:26 2020]
rule MSA:
    input: per_gene/EOG091G029K/EOG091G029K.fasta
    output: per_gene/EOG091G029K/EOG091G029K.clustalo.fasta
    log: per_gene/EOG091G029K/MSA.stdout.txt, per_gene/EOG091G029K/MSA.stderr.txt
    jobid: 1882
    wildcards: BUSCO=EOG091G029K
    threads: 2


        clustalo -i per_gene/EOG091G029K/EOG091G029K.fasta -o per_gene/EOG091G029K/EOG091G029K.clustalo.fasta --threads=2 1> per_gene/EOG091G029K/MSA.stdout.txt 2> per_gene/EOG091G029K/MSA.stderr.txt
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/d68c9691725a7401923680874285c430.simg
[Sun Jul  5 23:19:27 2020]
Finished job 621.
1967 of 3292 steps (60%) done

[Sun Jul  5 23:19:27 2020]
rule find_best_model:
    input: per_gene/EOG091G08FX/ALICUT_EOG091G08FX.clustalo.fasta, per_gene/EOG091G08FX/empty_check.done
    output: per_gene/EOG091G08FX/EOG091G08FX.best_model
    log: per_gene/EOG091G08FX/find_best_model.stderr.txt
    jobid: 906
    wildcards: BUSCO=EOG091G08FX
    threads: 2


        cd per_gene/EOG091G08FX
        if [ ! -d find_best_model ]
        then
            mkdir find_best_model
        fi
        cd find_best_model
        ln -s ../../../per_gene/EOG091G08FX/ALICUT_EOG091G08FX.clustalo.fasta EOG091G08FX.fasta
        ProteinModelSelection.pl EOG091G08FX.fasta 1> ../../../per_gene/EOG091G08FX/EOG091G08FX.best_model 2> ../../../per_gene/EOG091G08FX/find_best_model.stderr.txt
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/c0c09ee657b1e27f2c5687e0e9aa8d70.simg
[Sun Jul  5 23:19:30 2020]
Finished job 1041.
1968 of 3292 steps (60%) done

[Sun Jul  5 23:19:30 2020]
rule remove_empty:
    input: per_gene/EOG091G0IWR/ALICUT_EOG091G0IWR.clustalo.fasta
    output: per_gene/EOG091G0IWR/empty_check.done
    jobid: 1863
    wildcards: BUSCO=EOG091G0IWR


         if [ "$(cat per_gene/EOG091G0IWR/ALICUT_EOG091G0IWR.clustalo.fasta | grep -v ">" | sed 's/-//g' | grep "^$" | wc -l)" -gt 0 ]
         then
              cp per_gene/EOG091G0IWR/ALICUT_EOG091G0IWR.clustalo.fasta per_gene/EOG091G0IWR/ALICUT_EOG091G0IWR.clustalo.fasta.backup
              bash ../scripts/remove_empty.sh per_gene/EOG091G0IWR/ALICUT_EOG091G0IWR.clustalo.fasta.backup > per_gene/EOG091G0IWR/ALICUT_EOG091G0IWR.clustalo.fasta
         fi
         touch per_gene/EOG091G0IWR/empty_check.done
         

[Sun Jul  5 23:19:30 2020]
rule remove_empty:
    input: per_gene/EOG091G0EZO/ALICUT_EOG091G0EZO.clustalo.fasta
    output: per_gene/EOG091G0EZO/empty_check.done
    jobid: 1443
    wildcards: BUSCO=EOG091G0EZO


         if [ "$(cat per_gene/EOG091G0EZO/ALICUT_EOG091G0EZO.clustalo.fasta | grep -v ">" | sed 's/-//g' | grep "^$" | wc -l)" -gt 0 ]
         then
              cp per_gene/EOG091G0EZO/ALICUT_EOG091G0EZO.clustalo.fasta per_gene/EOG091G0EZO/ALICUT_EOG091G0EZO.clustalo.fasta.backup
              bash ../scripts/remove_empty.sh per_gene/EOG091G0EZO/ALICUT_EOG091G0EZO.clustalo.fasta.backup > per_gene/EOG091G0EZO/ALICUT_EOG091G0EZO.clustalo.fasta
         fi
         touch per_gene/EOG091G0EZO/empty_check.done
         
[Sun Jul  5 23:19:30 2020]
Finished job 1863.
1969 of 3292 steps (60%) done
[Sun Jul  5 23:19:30 2020]
Finished job 1443.
1970 of 3292 steps (60%) done
[Sun Jul  5 23:19:30 2020]
Finished job 1882.
1971 of 3292 steps (60%) done
[Sun Jul  5 23:19:30 2020]
Finished job 2494.
1972 of 3292 steps (60%) done

[Sun Jul  5 23:19:30 2020]
rule find_best_model:
    input: per_gene/EOG091G0IWR/ALICUT_EOG091G0IWR.clustalo.fasta, per_gene/EOG091G0IWR/empty_check.done
    output: per_gene/EOG091G0IWR/EOG091G0IWR.best_model
    log: per_gene/EOG091G0IWR/find_best_model.stderr.txt
    jobid: 1040
    wildcards: BUSCO=EOG091G0IWR
    threads: 2


        cd per_gene/EOG091G0IWR
        if [ ! -d find_best_model ]
        then
            mkdir find_best_model
        fi
        cd find_best_model
        ln -s ../../../per_gene/EOG091G0IWR/ALICUT_EOG091G0IWR.clustalo.fasta EOG091G0IWR.fasta
        ProteinModelSelection.pl EOG091G0IWR.fasta 1> ../../../per_gene/EOG091G0IWR/EOG091G0IWR.best_model 2> ../../../per_gene/EOG091G0IWR/find_best_model.stderr.txt
        

[Sun Jul  5 23:19:30 2020]
rule find_best_model:
    input: per_gene/EOG091G0EZO/ALICUT_EOG091G0EZO.clustalo.fasta, per_gene/EOG091G0EZO/empty_check.done
    output: per_gene/EOG091G0EZO/EOG091G0EZO.best_model
    log: per_gene/EOG091G0EZO/find_best_model.stderr.txt
    jobid: 620
    wildcards: BUSCO=EOG091G0EZO
    threads: 2


        cd per_gene/EOG091G0EZO
        if [ ! -d find_best_model ]
        then
            mkdir find_best_model
        fi
        cd find_best_model
        ln -s ../../../per_gene/EOG091G0EZO/ALICUT_EOG091G0EZO.clustalo.fasta EOG091G0EZO.fasta
        ProteinModelSelection.pl EOG091G0EZO.fasta 1> ../../../per_gene/EOG091G0EZO/EOG091G0EZO.best_model 2> ../../../per_gene/EOG091G0EZO/find_best_model.stderr.txt
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/c0c09ee657b1e27f2c5687e0e9aa8d70.simg
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/c0c09ee657b1e27f2c5687e0e9aa8d70.simg

[Sun Jul  5 23:19:30 2020]
rule score_and_cut:
    input: per_gene/EOG091G029K/EOG091G029K.clustalo.fasta
    output: per_gene/EOG091G029K/ALICUT_EOG091G029K.clustalo.fasta
    jobid: 1059
    wildcards: BUSCO=EOG091G029K
    threads: 2


        cd per_gene/EOG091G029K
        Aliscore.pl -N -r 200000000000000000 -i ../../per_gene/EOG091G029K/EOG091G029K.clustalo.fasta &> aliscore.log
        ALICUT.pl -s &> alicut.log
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/63c88c27a0fa300f57066b0ef65fefcb.simg
[Sun Jul  5 23:19:31 2020]
Finished job 2922.
1973 of 3292 steps (60%) done

[Sun Jul  5 23:19:31 2020]
rule get_outgroups:
    input: per_gene/EOG091G02O5/EOG091G02O5.ingroup.fasta
    output: per_gene/EOG091G02O5/EOG091G02O5.orthodb.fasta, per_gene/EOG091G02O5/EOG091G02O5.outgroup.fasta
    log: per_gene/EOG091G02O5/get_outgroups.stdout.txt, per_gene/EOG091G02O5/get_outgroups.stderr.txt
    jobid: 2495
    wildcards: BUSCO=EOG091G02O5


        #download fastas from Orhtodb for BUSCO id
        for i in {1..5}
        do
             wget "http://www.orthodb.org/fasta?query=EOG091G02O5&level=33208" -O per_gene/EOG091G02O5/EOG091G02O5.orthodb.fasta 1> per_gene/EOG091G02O5/get_outgroups.stdout.txt 2> per_gene/EOG091G02O5/get_outgroups.stderr.txt && break || echo -e "try again ($i)" && sleep 15
        done

	#This is quick an dirty for now and just takes the first protein if there is more than one for an outgroup taxon
        bash ../scripts/download_outgroups.sh taxids.txt per_gene/EOG091G02O5/EOG091G02O5.orthodb.fasta > per_gene/EOG091G02O5/EOG091G02O5.outgroup.fasta
        

[Sun Jul  5 23:19:31 2020]
rule get_outgroups:
    input: per_gene/EOG091G11OU/EOG091G11OU.ingroup.fasta
    output: per_gene/EOG091G11OU/EOG091G11OU.orthodb.fasta, per_gene/EOG091G11OU/EOG091G11OU.outgroup.fasta
    log: per_gene/EOG091G11OU/get_outgroups.stdout.txt, per_gene/EOG091G11OU/get_outgroups.stderr.txt
    jobid: 2923
    wildcards: BUSCO=EOG091G11OU


        #download fastas from Orhtodb for BUSCO id
        for i in {1..5}
        do
             wget "http://www.orthodb.org/fasta?query=EOG091G11OU&level=33208" -O per_gene/EOG091G11OU/EOG091G11OU.orthodb.fasta 1> per_gene/EOG091G11OU/get_outgroups.stdout.txt 2> per_gene/EOG091G11OU/get_outgroups.stderr.txt && break || echo -e "try again ($i)" && sleep 15
        done

	#This is quick an dirty for now and just takes the first protein if there is more than one for an outgroup taxon
        bash ../scripts/download_outgroups.sh taxids.txt per_gene/EOG091G11OU/EOG091G11OU.orthodb.fasta > per_gene/EOG091G11OU/EOG091G11OU.outgroup.fasta
        
[Sun Jul  5 23:19:32 2020]
Finished job 2495.
1974 of 3292 steps (60%) done

[Sun Jul  5 23:19:32 2020]
rule join_groups:
    input: per_gene/EOG091G02O5/EOG091G02O5.ingroup.fasta, per_gene/EOG091G02O5/EOG091G02O5.outgroup.fasta
    output: per_gene/EOG091G02O5/EOG091G02O5.fasta
    jobid: 2071
    wildcards: BUSCO=EOG091G02O5


        cat per_gene/EOG091G02O5/EOG091G02O5.ingroup.fasta per_gene/EOG091G02O5/EOG091G02O5.outgroup.fasta > per_gene/EOG091G02O5/EOG091G02O5.fasta
        
[Sun Jul  5 23:19:32 2020]
Finished job 2071.
1975 of 3292 steps (60%) done
[Sun Jul  5 23:19:33 2020]
Finished job 2923.
1976 of 3292 steps (60%) done

[Sun Jul  5 23:19:33 2020]
rule MSA:
    input: per_gene/EOG091G02O5/EOG091G02O5.fasta
    output: per_gene/EOG091G02O5/EOG091G02O5.clustalo.fasta
    log: per_gene/EOG091G02O5/MSA.stdout.txt, per_gene/EOG091G02O5/MSA.stderr.txt
    jobid: 1262
    wildcards: BUSCO=EOG091G02O5
    threads: 2


        clustalo -i per_gene/EOG091G02O5/EOG091G02O5.fasta -o per_gene/EOG091G02O5/EOG091G02O5.clustalo.fasta --threads=2 1> per_gene/EOG091G02O5/MSA.stdout.txt 2> per_gene/EOG091G02O5/MSA.stderr.txt
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/d68c9691725a7401923680874285c430.simg
[Sun Jul  5 23:19:35 2020]
Finished job 1262.
1977 of 3292 steps (60%) done

[Sun Jul  5 23:19:35 2020]
rule score_and_cut:
    input: per_gene/EOG091G02O5/EOG091G02O5.clustalo.fasta
    output: per_gene/EOG091G02O5/ALICUT_EOG091G02O5.clustalo.fasta
    jobid: 439
    wildcards: BUSCO=EOG091G02O5
    threads: 2


        cd per_gene/EOG091G02O5
        Aliscore.pl -N -r 200000000000000000 -i ../../per_gene/EOG091G02O5/EOG091G02O5.clustalo.fasta &> aliscore.log
        ALICUT.pl -s &> alicut.log
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/63c88c27a0fa300f57066b0ef65fefcb.simg
[Sun Jul  5 23:19:43 2020]
Finished job 1059.
1978 of 3292 steps (60%) done

[Sun Jul  5 23:19:43 2020]
rule join_groups:
    input: per_gene/EOG091G11OU/EOG091G11OU.ingroup.fasta, per_gene/EOG091G11OU/EOG091G11OU.outgroup.fasta
    output: per_gene/EOG091G11OU/EOG091G11OU.fasta
    jobid: 2285
    wildcards: BUSCO=EOG091G11OU


        cat per_gene/EOG091G11OU/EOG091G11OU.ingroup.fasta per_gene/EOG091G11OU/EOG091G11OU.outgroup.fasta > per_gene/EOG091G11OU/EOG091G11OU.fasta
        

[Sun Jul  5 23:19:43 2020]
rule remove_empty:
    input: per_gene/EOG091G029K/ALICUT_EOG091G029K.clustalo.fasta
    output: per_gene/EOG091G029K/empty_check.done
    jobid: 1881
    wildcards: BUSCO=EOG091G029K


         if [ "$(cat per_gene/EOG091G029K/ALICUT_EOG091G029K.clustalo.fasta | grep -v ">" | sed 's/-//g' | grep "^$" | wc -l)" -gt 0 ]
         then
              cp per_gene/EOG091G029K/ALICUT_EOG091G029K.clustalo.fasta per_gene/EOG091G029K/ALICUT_EOG091G029K.clustalo.fasta.backup
              bash ../scripts/remove_empty.sh per_gene/EOG091G029K/ALICUT_EOG091G029K.clustalo.fasta.backup > per_gene/EOG091G029K/ALICUT_EOG091G029K.clustalo.fasta
         fi
         touch per_gene/EOG091G029K/empty_check.done
         
[Sun Jul  5 23:19:43 2020]
Finished job 2285.
1979 of 3292 steps (60%) done
[Sun Jul  5 23:19:43 2020]
Finished job 1881.
1980 of 3292 steps (60%) done

[Sun Jul  5 23:19:43 2020]
rule find_best_model:
    input: per_gene/EOG091G029K/ALICUT_EOG091G029K.clustalo.fasta, per_gene/EOG091G029K/empty_check.done
    output: per_gene/EOG091G029K/EOG091G029K.best_model
    log: per_gene/EOG091G029K/find_best_model.stderr.txt
    jobid: 1058
    wildcards: BUSCO=EOG091G029K
    threads: 2


        cd per_gene/EOG091G029K
        if [ ! -d find_best_model ]
        then
            mkdir find_best_model
        fi
        cd find_best_model
        ln -s ../../../per_gene/EOG091G029K/ALICUT_EOG091G029K.clustalo.fasta EOG091G029K.fasta
        ProteinModelSelection.pl EOG091G029K.fasta 1> ../../../per_gene/EOG091G029K/EOG091G029K.best_model 2> ../../../per_gene/EOG091G029K/find_best_model.stderr.txt
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/c0c09ee657b1e27f2c5687e0e9aa8d70.simg
[Sun Jul  5 23:19:46 2020]
Finished job 439.
1981 of 3292 steps (60%) done

[Sun Jul  5 23:19:46 2020]
rule remove_empty:
    input: per_gene/EOG091G02O5/ALICUT_EOG091G02O5.clustalo.fasta
    output: per_gene/EOG091G02O5/empty_check.done
    jobid: 1261
    wildcards: BUSCO=EOG091G02O5


         if [ "$(cat per_gene/EOG091G02O5/ALICUT_EOG091G02O5.clustalo.fasta | grep -v ">" | sed 's/-//g' | grep "^$" | wc -l)" -gt 0 ]
         then
              cp per_gene/EOG091G02O5/ALICUT_EOG091G02O5.clustalo.fasta per_gene/EOG091G02O5/ALICUT_EOG091G02O5.clustalo.fasta.backup
              bash ../scripts/remove_empty.sh per_gene/EOG091G02O5/ALICUT_EOG091G02O5.clustalo.fasta.backup > per_gene/EOG091G02O5/ALICUT_EOG091G02O5.clustalo.fasta
         fi
         touch per_gene/EOG091G02O5/empty_check.done
         
[Sun Jul  5 23:19:46 2020]
Finished job 1261.
1982 of 3292 steps (60%) done

[Sun Jul  5 23:19:46 2020]
rule find_best_model:
    input: per_gene/EOG091G02O5/ALICUT_EOG091G02O5.clustalo.fasta, per_gene/EOG091G02O5/empty_check.done
    output: per_gene/EOG091G02O5/EOG091G02O5.best_model
    log: per_gene/EOG091G02O5/find_best_model.stderr.txt
    jobid: 438
    wildcards: BUSCO=EOG091G02O5
    threads: 2


        cd per_gene/EOG091G02O5
        if [ ! -d find_best_model ]
        then
            mkdir find_best_model
        fi
        cd find_best_model
        ln -s ../../../per_gene/EOG091G02O5/ALICUT_EOG091G02O5.clustalo.fasta EOG091G02O5.fasta
        ProteinModelSelection.pl EOG091G02O5.fasta 1> ../../../per_gene/EOG091G02O5/EOG091G02O5.best_model 2> ../../../per_gene/EOG091G02O5/find_best_model.stderr.txt
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/c0c09ee657b1e27f2c5687e0e9aa8d70.simg
[Sun Jul  5 23:19:56 2020]
Finished job 1040.
1983 of 3292 steps (60%) done

[Sun Jul  5 23:19:56 2020]
rule MSA:
    input: per_gene/EOG091G11OU/EOG091G11OU.fasta
    output: per_gene/EOG091G11OU/EOG091G11OU.clustalo.fasta
    log: per_gene/EOG091G11OU/MSA.stdout.txt, per_gene/EOG091G11OU/MSA.stderr.txt
    jobid: 1690
    wildcards: BUSCO=EOG091G11OU
    threads: 2


        clustalo -i per_gene/EOG091G11OU/EOG091G11OU.fasta -o per_gene/EOG091G11OU/EOG091G11OU.clustalo.fasta --threads=2 1> per_gene/EOG091G11OU/MSA.stdout.txt 2> per_gene/EOG091G11OU/MSA.stderr.txt
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/d68c9691725a7401923680874285c430.simg
[Sun Jul  5 23:19:57 2020]
Finished job 1690.
1984 of 3292 steps (60%) done

[Sun Jul  5 23:19:57 2020]
rule score_and_cut:
    input: per_gene/EOG091G11OU/EOG091G11OU.clustalo.fasta
    output: per_gene/EOG091G11OU/ALICUT_EOG091G11OU.clustalo.fasta
    jobid: 867
    wildcards: BUSCO=EOG091G11OU
    threads: 2


        cd per_gene/EOG091G11OU
        Aliscore.pl -N -r 200000000000000000 -i ../../per_gene/EOG091G11OU/EOG091G11OU.clustalo.fasta &> aliscore.log
        ALICUT.pl -s &> alicut.log
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/63c88c27a0fa300f57066b0ef65fefcb.simg
[Sun Jul  5 23:20:01 2020]
Finished job 620.
1985 of 3292 steps (60%) done

[Sun Jul  5 23:20:01 2020]
rule infer_single_ML:
    input: per_gene/EOG091G0EZO/EOG091G0EZO.best_model, per_gene/EOG091G0EZO/ALICUT_EOG091G0EZO.clustalo.fasta
    output: per_gene/EOG091G0EZO/EOG091G0EZO.raxml.done
    log: per_gene/EOG091G0EZO/infer_single_ML.stdout.txt, per_gene/EOG091G0EZO/infer_single_ML.stderr.txt
    jobid: 104
    wildcards: BUSCO=EOG091G0EZO
    threads: 2


        cd per_gene/EOG091G0EZO
	count=$(cat ../../per_gene/EOG091G0EZO/ALICUT_EOG091G0EZO.clustalo.fasta | grep ">" | wc -l)
	if [ "$count" -gt 5 ]
        then
		RAxMLmodel=$(cat ../../per_gene/EOG091G0EZO/EOG091G0EZO.best_model | grep "Best" | cut -d ":" -f 2 | tr -d '[:space:]')
                if [ "$(ls -1 | grep "^RAxML" | wc -l)" -ne 0 ]
		then
			rm RAxML*
		fi
        	raxml -f a -T 2 -m PROTGAMMA$RAxMLmodel         	-p 12345 -x 12345 -# 100         	-s ../../per_gene/EOG091G0EZO/ALICUT_EOG091G0EZO.clustalo.fasta -n EOG091G0EZO.clustalo.aln.ALICUT.$RAxMLmodel 		1> ../../per_gene/EOG091G0EZO/infer_single_ML.stdout.txt 2> ../../per_gene/EOG091G0EZO/infer_single_ML.stderr.txt
	else
		echo "fasta file per_gene/EOG091G0EZO/ALICUT_EOG091G0EZO.clustalo.fasta contains fewer than 5 sequences - skipped" > ../../per_gene/EOG091G0EZO/infer_single_ML.stdout.txt
		touch raxml.skipped
	fi
        touch ../../per_gene/EOG091G0EZO/EOG091G0EZO.raxml.done
        
[33mJob counts:
	count	jobs
	1	infer_single_ML
	1[0m
[33m
        cd per_gene/EOG091G0EZO
	count=$(cat ../../per_gene/EOG091G0EZO/ALICUT_EOG091G0EZO.clustalo.fasta | grep ">" | wc -l)
	if [ "$count" -gt 5 ]
        then
		RAxMLmodel=$(cat ../../per_gene/EOG091G0EZO/EOG091G0EZO.best_model | grep "Best" | cut -d ":" -f 2 | tr -d '[:space:]')
                if [ "$(ls -1 | grep "^RAxML" | wc -l)" -ne 0 ]
		then
			rm RAxML*
		fi
        	raxml -f a -T 2 -m PROTGAMMA$RAxMLmodel         	-p 12345 -x 12345 -# 100         	-s ../../per_gene/EOG091G0EZO/ALICUT_EOG091G0EZO.clustalo.fasta -n EOG091G0EZO.clustalo.aln.ALICUT.$RAxMLmodel 		1> ../../per_gene/EOG091G0EZO/infer_single_ML.stdout.txt 2> ../../per_gene/EOG091G0EZO/infer_single_ML.stderr.txt
	else
		echo "fasta file per_gene/EOG091G0EZO/ALICUT_EOG091G0EZO.clustalo.fasta contains fewer than 5 sequences - skipped" > ../../per_gene/EOG091G0EZO/infer_single_ML.stdout.txt
		touch raxml.skipped
	fi
        touch ../../per_gene/EOG091G0EZO/EOG091G0EZO.raxml.done
        [0m
[Sun Jul  5 23:20:04 2020]
Finished job 906.
1986 of 3292 steps (60%) done

[Sun Jul  5 23:20:04 2020]
rule infer_single_ML:
    input: per_gene/EOG091G08FX/EOG091G08FX.best_model, per_gene/EOG091G08FX/ALICUT_EOG091G08FX.clustalo.fasta
    output: per_gene/EOG091G08FX/EOG091G08FX.raxml.done
    log: per_gene/EOG091G08FX/infer_single_ML.stdout.txt, per_gene/EOG091G08FX/infer_single_ML.stderr.txt
    jobid: 247
    wildcards: BUSCO=EOG091G08FX
    threads: 2


        cd per_gene/EOG091G08FX
	count=$(cat ../../per_gene/EOG091G08FX/ALICUT_EOG091G08FX.clustalo.fasta | grep ">" | wc -l)
	if [ "$count" -gt 5 ]
        then
		RAxMLmodel=$(cat ../../per_gene/EOG091G08FX/EOG091G08FX.best_model | grep "Best" | cut -d ":" -f 2 | tr -d '[:space:]')
                if [ "$(ls -1 | grep "^RAxML" | wc -l)" -ne 0 ]
		then
			rm RAxML*
		fi
        	raxml -f a -T 2 -m PROTGAMMA$RAxMLmodel         	-p 12345 -x 12345 -# 100         	-s ../../per_gene/EOG091G08FX/ALICUT_EOG091G08FX.clustalo.fasta -n EOG091G08FX.clustalo.aln.ALICUT.$RAxMLmodel 		1> ../../per_gene/EOG091G08FX/infer_single_ML.stdout.txt 2> ../../per_gene/EOG091G08FX/infer_single_ML.stderr.txt
	else
		echo "fasta file per_gene/EOG091G08FX/ALICUT_EOG091G08FX.clustalo.fasta contains fewer than 5 sequences - skipped" > ../../per_gene/EOG091G08FX/infer_single_ML.stdout.txt
		touch raxml.skipped
	fi
        touch ../../per_gene/EOG091G08FX/EOG091G08FX.raxml.done
        
[33mJob counts:
	count	jobs
	1	infer_single_ML
	1[0m
[33m
        cd per_gene/EOG091G08FX
	count=$(cat ../../per_gene/EOG091G08FX/ALICUT_EOG091G08FX.clustalo.fasta | grep ">" | wc -l)
	if [ "$count" -gt 5 ]
        then
		RAxMLmodel=$(cat ../../per_gene/EOG091G08FX/EOG091G08FX.best_model | grep "Best" | cut -d ":" -f 2 | tr -d '[:space:]')
                if [ "$(ls -1 | grep "^RAxML" | wc -l)" -ne 0 ]
		then
			rm RAxML*
		fi
        	raxml -f a -T 2 -m PROTGAMMA$RAxMLmodel         	-p 12345 -x 12345 -# 100         	-s ../../per_gene/EOG091G08FX/ALICUT_EOG091G08FX.clustalo.fasta -n EOG091G08FX.clustalo.aln.ALICUT.$RAxMLmodel 		1> ../../per_gene/EOG091G08FX/infer_single_ML.stdout.txt 2> ../../per_gene/EOG091G08FX/infer_single_ML.stderr.txt
	else
		echo "fasta file per_gene/EOG091G08FX/ALICUT_EOG091G08FX.clustalo.fasta contains fewer than 5 sequences - skipped" > ../../per_gene/EOG091G08FX/infer_single_ML.stdout.txt
		touch raxml.skipped
	fi
        touch ../../per_gene/EOG091G08FX/EOG091G08FX.raxml.done
        [0m
[Sun Jul  5 23:20:06 2020]
Finished job 867.
1987 of 3292 steps (60%) done

[Sun Jul  5 23:20:06 2020]
rule infer_single_ML:
    input: per_gene/EOG091G0IWR/EOG091G0IWR.best_model, per_gene/EOG091G0IWR/ALICUT_EOG091G0IWR.clustalo.fasta
    output: per_gene/EOG091G0IWR/EOG091G0IWR.raxml.done
    log: per_gene/EOG091G0IWR/infer_single_ML.stdout.txt, per_gene/EOG091G0IWR/infer_single_ML.stderr.txt
    jobid: 314
    wildcards: BUSCO=EOG091G0IWR
    threads: 2


        cd per_gene/EOG091G0IWR
	count=$(cat ../../per_gene/EOG091G0IWR/ALICUT_EOG091G0IWR.clustalo.fasta | grep ">" | wc -l)
	if [ "$count" -gt 5 ]
        then
		RAxMLmodel=$(cat ../../per_gene/EOG091G0IWR/EOG091G0IWR.best_model | grep "Best" | cut -d ":" -f 2 | tr -d '[:space:]')
                if [ "$(ls -1 | grep "^RAxML" | wc -l)" -ne 0 ]
		then
			rm RAxML*
		fi
        	raxml -f a -T 2 -m PROTGAMMA$RAxMLmodel         	-p 12345 -x 12345 -# 100         	-s ../../per_gene/EOG091G0IWR/ALICUT_EOG091G0IWR.clustalo.fasta -n EOG091G0IWR.clustalo.aln.ALICUT.$RAxMLmodel 		1> ../../per_gene/EOG091G0IWR/infer_single_ML.stdout.txt 2> ../../per_gene/EOG091G0IWR/infer_single_ML.stderr.txt
	else
		echo "fasta file per_gene/EOG091G0IWR/ALICUT_EOG091G0IWR.clustalo.fasta contains fewer than 5 sequences - skipped" > ../../per_gene/EOG091G0IWR/infer_single_ML.stdout.txt
		touch raxml.skipped
	fi
        touch ../../per_gene/EOG091G0IWR/EOG091G0IWR.raxml.done
        
[33mJob counts:
	count	jobs
	1	infer_single_ML
	1[0m
[33m
        cd per_gene/EOG091G0IWR
	count=$(cat ../../per_gene/EOG091G0IWR/ALICUT_EOG091G0IWR.clustalo.fasta | grep ">" | wc -l)
	if [ "$count" -gt 5 ]
        then
		RAxMLmodel=$(cat ../../per_gene/EOG091G0IWR/EOG091G0IWR.best_model | grep "Best" | cut -d ":" -f 2 | tr -d '[:space:]')
                if [ "$(ls -1 | grep "^RAxML" | wc -l)" -ne 0 ]
		then
			rm RAxML*
		fi
        	raxml -f a -T 2 -m PROTGAMMA$RAxMLmodel         	-p 12345 -x 12345 -# 100         	-s ../../per_gene/EOG091G0IWR/ALICUT_EOG091G0IWR.clustalo.fasta -n EOG091G0IWR.clustalo.aln.ALICUT.$RAxMLmodel 		1> ../../per_gene/EOG091G0IWR/infer_single_ML.stdout.txt 2> ../../per_gene/EOG091G0IWR/infer_single_ML.stderr.txt
	else
		echo "fasta file per_gene/EOG091G0IWR/ALICUT_EOG091G0IWR.clustalo.fasta contains fewer than 5 sequences - skipped" > ../../per_gene/EOG091G0IWR/infer_single_ML.stdout.txt
		touch raxml.skipped
	fi
        touch ../../per_gene/EOG091G0IWR/EOG091G0IWR.raxml.done
        [0m
[Sun Jul  5 23:20:17 2020]
Finished job 438.
1988 of 3292 steps (60%) done

[Sun Jul  5 23:20:17 2020]
rule infer_single_ML:
    input: per_gene/EOG091G02O5/EOG091G02O5.best_model, per_gene/EOG091G02O5/ALICUT_EOG091G02O5.clustalo.fasta
    output: per_gene/EOG091G02O5/EOG091G02O5.raxml.done
    log: per_gene/EOG091G02O5/infer_single_ML.stdout.txt, per_gene/EOG091G02O5/infer_single_ML.stderr.txt
    jobid: 13
    wildcards: BUSCO=EOG091G02O5
    threads: 2


        cd per_gene/EOG091G02O5
	count=$(cat ../../per_gene/EOG091G02O5/ALICUT_EOG091G02O5.clustalo.fasta | grep ">" | wc -l)
	if [ "$count" -gt 5 ]
        then
		RAxMLmodel=$(cat ../../per_gene/EOG091G02O5/EOG091G02O5.best_model | grep "Best" | cut -d ":" -f 2 | tr -d '[:space:]')
                if [ "$(ls -1 | grep "^RAxML" | wc -l)" -ne 0 ]
		then
			rm RAxML*
		fi
        	raxml -f a -T 2 -m PROTGAMMA$RAxMLmodel         	-p 12345 -x 12345 -# 100         	-s ../../per_gene/EOG091G02O5/ALICUT_EOG091G02O5.clustalo.fasta -n EOG091G02O5.clustalo.aln.ALICUT.$RAxMLmodel 		1> ../../per_gene/EOG091G02O5/infer_single_ML.stdout.txt 2> ../../per_gene/EOG091G02O5/infer_single_ML.stderr.txt
	else
		echo "fasta file per_gene/EOG091G02O5/ALICUT_EOG091G02O5.clustalo.fasta contains fewer than 5 sequences - skipped" > ../../per_gene/EOG091G02O5/infer_single_ML.stdout.txt
		touch raxml.skipped
	fi
        touch ../../per_gene/EOG091G02O5/EOG091G02O5.raxml.done
        
[Sun Jul  5 23:20:17 2020]
Finished job 1058.
1989 of 3292 steps (60%) done

[Sun Jul  5 23:20:17 2020]
rule infer_single_ML:
    input: per_gene/EOG091G029K/EOG091G029K.best_model, per_gene/EOG091G029K/ALICUT_EOG091G029K.clustalo.fasta
    output: per_gene/EOG091G029K/EOG091G029K.raxml.done
    log: per_gene/EOG091G029K/infer_single_ML.stdout.txt, per_gene/EOG091G029K/infer_single_ML.stderr.txt
    jobid: 323
    wildcards: BUSCO=EOG091G029K
    threads: 2


        cd per_gene/EOG091G029K
	count=$(cat ../../per_gene/EOG091G029K/ALICUT_EOG091G029K.clustalo.fasta | grep ">" | wc -l)
	if [ "$count" -gt 5 ]
        then
		RAxMLmodel=$(cat ../../per_gene/EOG091G029K/EOG091G029K.best_model | grep "Best" | cut -d ":" -f 2 | tr -d '[:space:]')
                if [ "$(ls -1 | grep "^RAxML" | wc -l)" -ne 0 ]
		then
			rm RAxML*
		fi
        	raxml -f a -T 2 -m PROTGAMMA$RAxMLmodel         	-p 12345 -x 12345 -# 100         	-s ../../per_gene/EOG091G029K/ALICUT_EOG091G029K.clustalo.fasta -n EOG091G029K.clustalo.aln.ALICUT.$RAxMLmodel 		1> ../../per_gene/EOG091G029K/infer_single_ML.stdout.txt 2> ../../per_gene/EOG091G029K/infer_single_ML.stderr.txt
	else
		echo "fasta file per_gene/EOG091G029K/ALICUT_EOG091G029K.clustalo.fasta contains fewer than 5 sequences - skipped" > ../../per_gene/EOG091G029K/infer_single_ML.stdout.txt
		touch raxml.skipped
	fi
        touch ../../per_gene/EOG091G029K/EOG091G029K.raxml.done
        
[33mJob counts:
	count	jobs
	1	infer_single_ML
	1[0m
[33m
        cd per_gene/EOG091G02O5
	count=$(cat ../../per_gene/EOG091G02O5/ALICUT_EOG091G02O5.clustalo.fasta | grep ">" | wc -l)
	if [ "$count" -gt 5 ]
        then
		RAxMLmodel=$(cat ../../per_gene/EOG091G02O5/EOG091G02O5.best_model | grep "Best" | cut -d ":" -f 2 | tr -d '[:space:]')
                if [ "$(ls -1 | grep "^RAxML" | wc -l)" -ne 0 ]
		then
			rm RAxML*
		fi
        	raxml -f a -T 2 -m PROTGAMMA$RAxMLmodel         	-p 12345 -x 12345 -# 100         	-s ../../per_gene/EOG091G02O5/ALICUT_EOG091G02O5.clustalo.fasta -n EOG091G02O5.clustalo.aln.ALICUT.$RAxMLmodel 		1> ../../per_gene/EOG091G02O5/infer_single_ML.stdout.txt 2> ../../per_gene/EOG091G02O5/infer_single_ML.stderr.txt
	else
		echo "fasta file per_gene/EOG091G02O5/ALICUT_EOG091G02O5.clustalo.fasta contains fewer than 5 sequences - skipped" > ../../per_gene/EOG091G02O5/infer_single_ML.stdout.txt
		touch raxml.skipped
	fi
        touch ../../per_gene/EOG091G02O5/EOG091G02O5.raxml.done
        [0m
[33mJob counts:
	count	jobs
	1	infer_single_ML
	1[0m
[33m
        cd per_gene/EOG091G029K
	count=$(cat ../../per_gene/EOG091G029K/ALICUT_EOG091G029K.clustalo.fasta | grep ">" | wc -l)
	if [ "$count" -gt 5 ]
        then
		RAxMLmodel=$(cat ../../per_gene/EOG091G029K/EOG091G029K.best_model | grep "Best" | cut -d ":" -f 2 | tr -d '[:space:]')
                if [ "$(ls -1 | grep "^RAxML" | wc -l)" -ne 0 ]
		then
			rm RAxML*
		fi
        	raxml -f a -T 2 -m PROTGAMMA$RAxMLmodel         	-p 12345 -x 12345 -# 100         	-s ../../per_gene/EOG091G029K/ALICUT_EOG091G029K.clustalo.fasta -n EOG091G029K.clustalo.aln.ALICUT.$RAxMLmodel 		1> ../../per_gene/EOG091G029K/infer_single_ML.stdout.txt 2> ../../per_gene/EOG091G029K/infer_single_ML.stderr.txt
	else
		echo "fasta file per_gene/EOG091G029K/ALICUT_EOG091G029K.clustalo.fasta contains fewer than 5 sequences - skipped" > ../../per_gene/EOG091G029K/infer_single_ML.stdout.txt
		touch raxml.skipped
	fi
        touch ../../per_gene/EOG091G029K/EOG091G029K.raxml.done
        [0m
[Sun Jul  5 23:21:13 2020]
Finished job 205.
1990 of 3292 steps (60%) done

[Sun Jul  5 23:21:13 2020]
rule remove_empty:
    input: per_gene/EOG091G11OU/ALICUT_EOG091G11OU.clustalo.fasta
    output: per_gene/EOG091G11OU/empty_check.done
    jobid: 1689
    wildcards: BUSCO=EOG091G11OU


         if [ "$(cat per_gene/EOG091G11OU/ALICUT_EOG091G11OU.clustalo.fasta | grep -v ">" | sed 's/-//g' | grep "^$" | wc -l)" -gt 0 ]
         then
              cp per_gene/EOG091G11OU/ALICUT_EOG091G11OU.clustalo.fasta per_gene/EOG091G11OU/ALICUT_EOG091G11OU.clustalo.fasta.backup
              bash ../scripts/remove_empty.sh per_gene/EOG091G11OU/ALICUT_EOG091G11OU.clustalo.fasta.backup > per_gene/EOG091G11OU/ALICUT_EOG091G11OU.clustalo.fasta
         fi
         touch per_gene/EOG091G11OU/empty_check.done
         
[Sun Jul  5 23:21:13 2020]
Finished job 1689.
1991 of 3292 steps (60%) done

[Sun Jul  5 23:21:13 2020]
rule find_best_model:
    input: per_gene/EOG091G11OU/ALICUT_EOG091G11OU.clustalo.fasta, per_gene/EOG091G11OU/empty_check.done
    output: per_gene/EOG091G11OU/EOG091G11OU.best_model
    log: per_gene/EOG091G11OU/find_best_model.stderr.txt
    jobid: 866
    wildcards: BUSCO=EOG091G11OU
    threads: 2


        cd per_gene/EOG091G11OU
        if [ ! -d find_best_model ]
        then
            mkdir find_best_model
        fi
        cd find_best_model
        ln -s ../../../per_gene/EOG091G11OU/ALICUT_EOG091G11OU.clustalo.fasta EOG091G11OU.fasta
        ProteinModelSelection.pl EOG091G11OU.fasta 1> ../../../per_gene/EOG091G11OU/EOG091G11OU.best_model 2> ../../../per_gene/EOG091G11OU/find_best_model.stderr.txt
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/c0c09ee657b1e27f2c5687e0e9aa8d70.simg
[Sun Jul  5 23:21:22 2020]
Finished job 350.
1992 of 3292 steps (61%) done

[Sun Jul  5 23:21:22 2020]
rule get_seqs:
    input: /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ingroup.txt, /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/outgroup.txt
    output: per_gene/EOG091G0ES6/EOG091G0ES6.ingroup.fasta
    log: per_gene/EOG091G0ES6/get_seqs.stdout.txt, per_gene/EOG091G0ES6/get_seqs.stderr.txt
    jobid: 2672
    wildcards: BUSCO=EOG091G0ES6
    threads: 2


	basedir=$(pwd)
        cd per_gene/EOG091G0ES6
        
        bash $basedir/../scripts/fetch_seqs.sh EOG091G0ES6 /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ingroup.txt /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/outgroup.txt 1> ../../per_gene/EOG091G0ES6/get_seqs.stdout.txt 2> ../../per_gene/EOG091G0ES6/get_seqs.stderr.txt
	mv EOG091G0ES6.fasta $basedir/per_gene/EOG091G0ES6/EOG091G0ES6.ingroup.fasta
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/72476f9d9a5bd0627b4d721143a21354.simg
[Sun Jul  5 23:21:26 2020]
Finished job 389.
1993 of 3292 steps (61%) done

[Sun Jul  5 23:21:26 2020]
rule get_seqs:
    input: /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ingroup.txt, /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/outgroup.txt
    output: per_gene/EOG091G0E06/EOG091G0E06.ingroup.fasta
    log: per_gene/EOG091G0E06/get_seqs.stdout.txt, per_gene/EOG091G0E06/get_seqs.stderr.txt
    jobid: 2666
    wildcards: BUSCO=EOG091G0E06
    threads: 2


	basedir=$(pwd)
        cd per_gene/EOG091G0E06
        
        bash $basedir/../scripts/fetch_seqs.sh EOG091G0E06 /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ingroup.txt /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/outgroup.txt 1> ../../per_gene/EOG091G0E06/get_seqs.stdout.txt 2> ../../per_gene/EOG091G0E06/get_seqs.stderr.txt
	mv EOG091G0E06.fasta $basedir/per_gene/EOG091G0E06/EOG091G0E06.ingroup.fasta
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/72476f9d9a5bd0627b4d721143a21354.simg
[Sun Jul  5 23:21:36 2020]
Finished job 2672.
1994 of 3292 steps (61%) done

[Sun Jul  5 23:21:36 2020]
rule get_outgroups:
    input: per_gene/EOG091G0ES6/EOG091G0ES6.ingroup.fasta
    output: per_gene/EOG091G0ES6/EOG091G0ES6.orthodb.fasta, per_gene/EOG091G0ES6/EOG091G0ES6.outgroup.fasta
    log: per_gene/EOG091G0ES6/get_outgroups.stdout.txt, per_gene/EOG091G0ES6/get_outgroups.stderr.txt
    jobid: 2673
    wildcards: BUSCO=EOG091G0ES6


        #download fastas from Orhtodb for BUSCO id
        for i in {1..5}
        do
             wget "http://www.orthodb.org/fasta?query=EOG091G0ES6&level=33208" -O per_gene/EOG091G0ES6/EOG091G0ES6.orthodb.fasta 1> per_gene/EOG091G0ES6/get_outgroups.stdout.txt 2> per_gene/EOG091G0ES6/get_outgroups.stderr.txt && break || echo -e "try again ($i)" && sleep 15
        done

	#This is quick an dirty for now and just takes the first protein if there is more than one for an outgroup taxon
        bash ../scripts/download_outgroups.sh taxids.txt per_gene/EOG091G0ES6/EOG091G0ES6.orthodb.fasta > per_gene/EOG091G0ES6/EOG091G0ES6.outgroup.fasta
        
[Sun Jul  5 23:21:37 2020]
Finished job 2673.
1995 of 3292 steps (61%) done

[Sun Jul  5 23:21:37 2020]
rule join_groups:
    input: per_gene/EOG091G0ES6/EOG091G0ES6.ingroup.fasta, per_gene/EOG091G0ES6/EOG091G0ES6.outgroup.fasta
    output: per_gene/EOG091G0ES6/EOG091G0ES6.fasta
    jobid: 2160
    wildcards: BUSCO=EOG091G0ES6


        cat per_gene/EOG091G0ES6/EOG091G0ES6.ingroup.fasta per_gene/EOG091G0ES6/EOG091G0ES6.outgroup.fasta > per_gene/EOG091G0ES6/EOG091G0ES6.fasta
        
[Sun Jul  5 23:21:37 2020]
Finished job 2160.
1996 of 3292 steps (61%) done

[Sun Jul  5 23:21:37 2020]
rule MSA:
    input: per_gene/EOG091G0ES6/EOG091G0ES6.fasta
    output: per_gene/EOG091G0ES6/EOG091G0ES6.clustalo.fasta
    log: per_gene/EOG091G0ES6/MSA.stdout.txt, per_gene/EOG091G0ES6/MSA.stderr.txt
    jobid: 1440
    wildcards: BUSCO=EOG091G0ES6
    threads: 2


        clustalo -i per_gene/EOG091G0ES6/EOG091G0ES6.fasta -o per_gene/EOG091G0ES6/EOG091G0ES6.clustalo.fasta --threads=2 1> per_gene/EOG091G0ES6/MSA.stdout.txt 2> per_gene/EOG091G0ES6/MSA.stderr.txt
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/d68c9691725a7401923680874285c430.simg
[Sun Jul  5 23:21:39 2020]
Finished job 1440.
1997 of 3292 steps (61%) done

[Sun Jul  5 23:21:39 2020]
rule score_and_cut:
    input: per_gene/EOG091G0ES6/EOG091G0ES6.clustalo.fasta
    output: per_gene/EOG091G0ES6/ALICUT_EOG091G0ES6.clustalo.fasta
    jobid: 617
    wildcards: BUSCO=EOG091G0ES6
    threads: 2


        cd per_gene/EOG091G0ES6
        Aliscore.pl -N -r 200000000000000000 -i ../../per_gene/EOG091G0ES6/EOG091G0ES6.clustalo.fasta &> aliscore.log
        ALICUT.pl -s &> alicut.log
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/63c88c27a0fa300f57066b0ef65fefcb.simg
[Sun Jul  5 23:21:39 2020]
Finished job 2666.
1998 of 3292 steps (61%) done

[Sun Jul  5 23:21:39 2020]
rule get_outgroups:
    input: per_gene/EOG091G0E06/EOG091G0E06.ingroup.fasta
    output: per_gene/EOG091G0E06/EOG091G0E06.orthodb.fasta, per_gene/EOG091G0E06/EOG091G0E06.outgroup.fasta
    log: per_gene/EOG091G0E06/get_outgroups.stdout.txt, per_gene/EOG091G0E06/get_outgroups.stderr.txt
    jobid: 2667
    wildcards: BUSCO=EOG091G0E06


        #download fastas from Orhtodb for BUSCO id
        for i in {1..5}
        do
             wget "http://www.orthodb.org/fasta?query=EOG091G0E06&level=33208" -O per_gene/EOG091G0E06/EOG091G0E06.orthodb.fasta 1> per_gene/EOG091G0E06/get_outgroups.stdout.txt 2> per_gene/EOG091G0E06/get_outgroups.stderr.txt && break || echo -e "try again ($i)" && sleep 15
        done

	#This is quick an dirty for now and just takes the first protein if there is more than one for an outgroup taxon
        bash ../scripts/download_outgroups.sh taxids.txt per_gene/EOG091G0E06/EOG091G0E06.orthodb.fasta > per_gene/EOG091G0E06/EOG091G0E06.outgroup.fasta
        
[Sun Jul  5 23:21:40 2020]
Finished job 2667.
1999 of 3292 steps (61%) done

[Sun Jul  5 23:21:40 2020]
rule join_groups:
    input: per_gene/EOG091G0E06/EOG091G0E06.ingroup.fasta, per_gene/EOG091G0E06/EOG091G0E06.outgroup.fasta
    output: per_gene/EOG091G0E06/EOG091G0E06.fasta
    jobid: 2157
    wildcards: BUSCO=EOG091G0E06


        cat per_gene/EOG091G0E06/EOG091G0E06.ingroup.fasta per_gene/EOG091G0E06/EOG091G0E06.outgroup.fasta > per_gene/EOG091G0E06/EOG091G0E06.fasta
        
[Sun Jul  5 23:21:40 2020]
Finished job 2157.
2000 of 3292 steps (61%) done

[Sun Jul  5 23:21:40 2020]
rule MSA:
    input: per_gene/EOG091G0E06/EOG091G0E06.fasta
    output: per_gene/EOG091G0E06/EOG091G0E06.clustalo.fasta
    log: per_gene/EOG091G0E06/MSA.stdout.txt, per_gene/EOG091G0E06/MSA.stderr.txt
    jobid: 1434
    wildcards: BUSCO=EOG091G0E06
    threads: 2


        clustalo -i per_gene/EOG091G0E06/EOG091G0E06.fasta -o per_gene/EOG091G0E06/EOG091G0E06.clustalo.fasta --threads=2 1> per_gene/EOG091G0E06/MSA.stdout.txt 2> per_gene/EOG091G0E06/MSA.stderr.txt
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/d68c9691725a7401923680874285c430.simg
[Sun Jul  5 23:21:40 2020]
Finished job 866.
2001 of 3292 steps (61%) done

[Sun Jul  5 23:21:40 2020]
rule infer_single_ML:
    input: per_gene/EOG091G11OU/EOG091G11OU.best_model, per_gene/EOG091G11OU/ALICUT_EOG091G11OU.clustalo.fasta
    output: per_gene/EOG091G11OU/EOG091G11OU.raxml.done
    log: per_gene/EOG091G11OU/infer_single_ML.stdout.txt, per_gene/EOG091G11OU/infer_single_ML.stderr.txt
    jobid: 227
    wildcards: BUSCO=EOG091G11OU
    threads: 2


        cd per_gene/EOG091G11OU
	count=$(cat ../../per_gene/EOG091G11OU/ALICUT_EOG091G11OU.clustalo.fasta | grep ">" | wc -l)
	if [ "$count" -gt 5 ]
        then
		RAxMLmodel=$(cat ../../per_gene/EOG091G11OU/EOG091G11OU.best_model | grep "Best" | cut -d ":" -f 2 | tr -d '[:space:]')
                if [ "$(ls -1 | grep "^RAxML" | wc -l)" -ne 0 ]
		then
			rm RAxML*
		fi
        	raxml -f a -T 2 -m PROTGAMMA$RAxMLmodel         	-p 12345 -x 12345 -# 100         	-s ../../per_gene/EOG091G11OU/ALICUT_EOG091G11OU.clustalo.fasta -n EOG091G11OU.clustalo.aln.ALICUT.$RAxMLmodel 		1> ../../per_gene/EOG091G11OU/infer_single_ML.stdout.txt 2> ../../per_gene/EOG091G11OU/infer_single_ML.stderr.txt
	else
		echo "fasta file per_gene/EOG091G11OU/ALICUT_EOG091G11OU.clustalo.fasta contains fewer than 5 sequences - skipped" > ../../per_gene/EOG091G11OU/infer_single_ML.stdout.txt
		touch raxml.skipped
	fi
        touch ../../per_gene/EOG091G11OU/EOG091G11OU.raxml.done
        
[Sun Jul  5 23:21:41 2020]
Finished job 1434.
2002 of 3292 steps (61%) done

[Sun Jul  5 23:21:41 2020]
rule score_and_cut:
    input: per_gene/EOG091G0E06/EOG091G0E06.clustalo.fasta
    output: per_gene/EOG091G0E06/ALICUT_EOG091G0E06.clustalo.fasta
    jobid: 611
    wildcards: BUSCO=EOG091G0E06
    threads: 2


        cd per_gene/EOG091G0E06
        Aliscore.pl -N -r 200000000000000000 -i ../../per_gene/EOG091G0E06/EOG091G0E06.clustalo.fasta &> aliscore.log
        ALICUT.pl -s &> alicut.log
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/63c88c27a0fa300f57066b0ef65fefcb.simg
[Sun Jul  5 23:21:48 2020]
Finished job 367.
2003 of 3292 steps (61%) done

[Sun Jul  5 23:21:48 2020]
rule get_seqs:
    input: /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ingroup.txt, /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/outgroup.txt
    output: per_gene/EOG091G0QE1/EOG091G0QE1.ingroup.fasta
    log: per_gene/EOG091G0QE1/get_seqs.stdout.txt, per_gene/EOG091G0QE1/get_seqs.stderr.txt
    jobid: 2808
    wildcards: BUSCO=EOG091G0QE1
    threads: 2


	basedir=$(pwd)
        cd per_gene/EOG091G0QE1
        
        bash $basedir/../scripts/fetch_seqs.sh EOG091G0QE1 /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ingroup.txt /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/outgroup.txt 1> ../../per_gene/EOG091G0QE1/get_seqs.stdout.txt 2> ../../per_gene/EOG091G0QE1/get_seqs.stderr.txt
	mv EOG091G0QE1.fasta $basedir/per_gene/EOG091G0QE1/EOG091G0QE1.ingroup.fasta
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/72476f9d9a5bd0627b4d721143a21354.simg
[Sun Jul  5 23:21:49 2020]
Finished job 617.
2004 of 3292 steps (61%) done

[Sun Jul  5 23:21:49 2020]
rule remove_empty:
    input: per_gene/EOG091G0ES6/ALICUT_EOG091G0ES6.clustalo.fasta
    output: per_gene/EOG091G0ES6/empty_check.done
    jobid: 1439
    wildcards: BUSCO=EOG091G0ES6


         if [ "$(cat per_gene/EOG091G0ES6/ALICUT_EOG091G0ES6.clustalo.fasta | grep -v ">" | sed 's/-//g' | grep "^$" | wc -l)" -gt 0 ]
         then
              cp per_gene/EOG091G0ES6/ALICUT_EOG091G0ES6.clustalo.fasta per_gene/EOG091G0ES6/ALICUT_EOG091G0ES6.clustalo.fasta.backup
              bash ../scripts/remove_empty.sh per_gene/EOG091G0ES6/ALICUT_EOG091G0ES6.clustalo.fasta.backup > per_gene/EOG091G0ES6/ALICUT_EOG091G0ES6.clustalo.fasta
         fi
         touch per_gene/EOG091G0ES6/empty_check.done
         
[Sun Jul  5 23:21:49 2020]
Finished job 1439.
2005 of 3292 steps (61%) done

[Sun Jul  5 23:21:49 2020]
rule find_best_model:
    input: per_gene/EOG091G0ES6/ALICUT_EOG091G0ES6.clustalo.fasta, per_gene/EOG091G0ES6/empty_check.done
    output: per_gene/EOG091G0ES6/EOG091G0ES6.best_model
    log: per_gene/EOG091G0ES6/find_best_model.stderr.txt
    jobid: 616
    wildcards: BUSCO=EOG091G0ES6
    threads: 2


        cd per_gene/EOG091G0ES6
        if [ ! -d find_best_model ]
        then
            mkdir find_best_model
        fi
        cd find_best_model
        ln -s ../../../per_gene/EOG091G0ES6/ALICUT_EOG091G0ES6.clustalo.fasta EOG091G0ES6.fasta
        ProteinModelSelection.pl EOG091G0ES6.fasta 1> ../../../per_gene/EOG091G0ES6/EOG091G0ES6.best_model 2> ../../../per_gene/EOG091G0ES6/find_best_model.stderr.txt
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/c0c09ee657b1e27f2c5687e0e9aa8d70.simg
[Sun Jul  5 23:21:50 2020]
Finished job 611.
2006 of 3292 steps (61%) done

[Sun Jul  5 23:21:50 2020]
rule remove_empty:
    input: per_gene/EOG091G0E06/ALICUT_EOG091G0E06.clustalo.fasta
    output: per_gene/EOG091G0E06/empty_check.done
    jobid: 1433
    wildcards: BUSCO=EOG091G0E06


         if [ "$(cat per_gene/EOG091G0E06/ALICUT_EOG091G0E06.clustalo.fasta | grep -v ">" | sed 's/-//g' | grep "^$" | wc -l)" -gt 0 ]
         then
              cp per_gene/EOG091G0E06/ALICUT_EOG091G0E06.clustalo.fasta per_gene/EOG091G0E06/ALICUT_EOG091G0E06.clustalo.fasta.backup
              bash ../scripts/remove_empty.sh per_gene/EOG091G0E06/ALICUT_EOG091G0E06.clustalo.fasta.backup > per_gene/EOG091G0E06/ALICUT_EOG091G0E06.clustalo.fasta
         fi
         touch per_gene/EOG091G0E06/empty_check.done
         
[Sun Jul  5 23:21:50 2020]
Finished job 1433.
2007 of 3292 steps (61%) done

[Sun Jul  5 23:21:50 2020]
rule find_best_model:
    input: per_gene/EOG091G0E06/ALICUT_EOG091G0E06.clustalo.fasta, per_gene/EOG091G0E06/empty_check.done
    output: per_gene/EOG091G0E06/EOG091G0E06.best_model
    log: per_gene/EOG091G0E06/find_best_model.stderr.txt
    jobid: 610
    wildcards: BUSCO=EOG091G0E06
    threads: 2


        cd per_gene/EOG091G0E06
        if [ ! -d find_best_model ]
        then
            mkdir find_best_model
        fi
        cd find_best_model
        ln -s ../../../per_gene/EOG091G0E06/ALICUT_EOG091G0E06.clustalo.fasta EOG091G0E06.fasta
        ProteinModelSelection.pl EOG091G0E06.fasta 1> ../../../per_gene/EOG091G0E06/EOG091G0E06.best_model 2> ../../../per_gene/EOG091G0E06/find_best_model.stderr.txt
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/c0c09ee657b1e27f2c5687e0e9aa8d70.simg
[33mJob counts:
	count	jobs
	1	infer_single_ML
	1[0m
[33m
        cd per_gene/EOG091G11OU
	count=$(cat ../../per_gene/EOG091G11OU/ALICUT_EOG091G11OU.clustalo.fasta | grep ">" | wc -l)
	if [ "$count" -gt 5 ]
        then
		RAxMLmodel=$(cat ../../per_gene/EOG091G11OU/EOG091G11OU.best_model | grep "Best" | cut -d ":" -f 2 | tr -d '[:space:]')
                if [ "$(ls -1 | grep "^RAxML" | wc -l)" -ne 0 ]
		then
			rm RAxML*
		fi
        	raxml -f a -T 2 -m PROTGAMMA$RAxMLmodel         	-p 12345 -x 12345 -# 100         	-s ../../per_gene/EOG091G11OU/ALICUT_EOG091G11OU.clustalo.fasta -n EOG091G11OU.clustalo.aln.ALICUT.$RAxMLmodel 		1> ../../per_gene/EOG091G11OU/infer_single_ML.stdout.txt 2> ../../per_gene/EOG091G11OU/infer_single_ML.stderr.txt
	else
		echo "fasta file per_gene/EOG091G11OU/ALICUT_EOG091G11OU.clustalo.fasta contains fewer than 5 sequences - skipped" > ../../per_gene/EOG091G11OU/infer_single_ML.stdout.txt
		touch raxml.skipped
	fi
        touch ../../per_gene/EOG091G11OU/EOG091G11OU.raxml.done
        [0m
[Sun Jul  5 23:22:03 2020]
Finished job 2808.
2008 of 3292 steps (61%) done

[Sun Jul  5 23:22:03 2020]
rule get_outgroups:
    input: per_gene/EOG091G0QE1/EOG091G0QE1.ingroup.fasta
    output: per_gene/EOG091G0QE1/EOG091G0QE1.orthodb.fasta, per_gene/EOG091G0QE1/EOG091G0QE1.outgroup.fasta
    log: per_gene/EOG091G0QE1/get_outgroups.stdout.txt, per_gene/EOG091G0QE1/get_outgroups.stderr.txt
    jobid: 2809
    wildcards: BUSCO=EOG091G0QE1


        #download fastas from Orhtodb for BUSCO id
        for i in {1..5}
        do
             wget "http://www.orthodb.org/fasta?query=EOG091G0QE1&level=33208" -O per_gene/EOG091G0QE1/EOG091G0QE1.orthodb.fasta 1> per_gene/EOG091G0QE1/get_outgroups.stdout.txt 2> per_gene/EOG091G0QE1/get_outgroups.stderr.txt && break || echo -e "try again ($i)" && sleep 15
        done

	#This is quick an dirty for now and just takes the first protein if there is more than one for an outgroup taxon
        bash ../scripts/download_outgroups.sh taxids.txt per_gene/EOG091G0QE1/EOG091G0QE1.orthodb.fasta > per_gene/EOG091G0QE1/EOG091G0QE1.outgroup.fasta
        
[Sun Jul  5 23:22:04 2020]
Finished job 2809.
2009 of 3292 steps (61%) done

[Sun Jul  5 23:22:04 2020]
rule join_groups:
    input: per_gene/EOG091G0QE1/EOG091G0QE1.ingroup.fasta, per_gene/EOG091G0QE1/EOG091G0QE1.outgroup.fasta
    output: per_gene/EOG091G0QE1/EOG091G0QE1.fasta
    jobid: 2228
    wildcards: BUSCO=EOG091G0QE1


        cat per_gene/EOG091G0QE1/EOG091G0QE1.ingroup.fasta per_gene/EOG091G0QE1/EOG091G0QE1.outgroup.fasta > per_gene/EOG091G0QE1/EOG091G0QE1.fasta
        
[Sun Jul  5 23:22:04 2020]
Finished job 2228.
2010 of 3292 steps (61%) done

[Sun Jul  5 23:22:04 2020]
rule MSA:
    input: per_gene/EOG091G0QE1/EOG091G0QE1.fasta
    output: per_gene/EOG091G0QE1/EOG091G0QE1.clustalo.fasta
    log: per_gene/EOG091G0QE1/MSA.stdout.txt, per_gene/EOG091G0QE1/MSA.stderr.txt
    jobid: 1576
    wildcards: BUSCO=EOG091G0QE1
    threads: 2


        clustalo -i per_gene/EOG091G0QE1/EOG091G0QE1.fasta -o per_gene/EOG091G0QE1/EOG091G0QE1.clustalo.fasta --threads=2 1> per_gene/EOG091G0QE1/MSA.stdout.txt 2> per_gene/EOG091G0QE1/MSA.stderr.txt
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/d68c9691725a7401923680874285c430.simg
[Sun Jul  5 23:22:05 2020]
Finished job 1576.
2011 of 3292 steps (61%) done

[Sun Jul  5 23:22:05 2020]
rule score_and_cut:
    input: per_gene/EOG091G0QE1/EOG091G0QE1.clustalo.fasta
    output: per_gene/EOG091G0QE1/ALICUT_EOG091G0QE1.clustalo.fasta
    jobid: 753
    wildcards: BUSCO=EOG091G0QE1
    threads: 2


        cd per_gene/EOG091G0QE1
        Aliscore.pl -N -r 200000000000000000 -i ../../per_gene/EOG091G0QE1/EOG091G0QE1.clustalo.fasta &> aliscore.log
        ALICUT.pl -s &> alicut.log
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/63c88c27a0fa300f57066b0ef65fefcb.simg
[Sun Jul  5 23:22:15 2020]
Finished job 753.
2012 of 3292 steps (61%) done

[Sun Jul  5 23:22:15 2020]
rule remove_empty:
    input: per_gene/EOG091G0QE1/ALICUT_EOG091G0QE1.clustalo.fasta
    output: per_gene/EOG091G0QE1/empty_check.done
    jobid: 1575
    wildcards: BUSCO=EOG091G0QE1


         if [ "$(cat per_gene/EOG091G0QE1/ALICUT_EOG091G0QE1.clustalo.fasta | grep -v ">" | sed 's/-//g' | grep "^$" | wc -l)" -gt 0 ]
         then
              cp per_gene/EOG091G0QE1/ALICUT_EOG091G0QE1.clustalo.fasta per_gene/EOG091G0QE1/ALICUT_EOG091G0QE1.clustalo.fasta.backup
              bash ../scripts/remove_empty.sh per_gene/EOG091G0QE1/ALICUT_EOG091G0QE1.clustalo.fasta.backup > per_gene/EOG091G0QE1/ALICUT_EOG091G0QE1.clustalo.fasta
         fi
         touch per_gene/EOG091G0QE1/empty_check.done
         
[Sun Jul  5 23:22:15 2020]
Finished job 1575.
2013 of 3292 steps (61%) done

[Sun Jul  5 23:22:15 2020]
rule find_best_model:
    input: per_gene/EOG091G0QE1/ALICUT_EOG091G0QE1.clustalo.fasta, per_gene/EOG091G0QE1/empty_check.done
    output: per_gene/EOG091G0QE1/EOG091G0QE1.best_model
    log: per_gene/EOG091G0QE1/find_best_model.stderr.txt
    jobid: 752
    wildcards: BUSCO=EOG091G0QE1
    threads: 2


        cd per_gene/EOG091G0QE1
        if [ ! -d find_best_model ]
        then
            mkdir find_best_model
        fi
        cd find_best_model
        ln -s ../../../per_gene/EOG091G0QE1/ALICUT_EOG091G0QE1.clustalo.fasta EOG091G0QE1.fasta
        ProteinModelSelection.pl EOG091G0QE1.fasta 1> ../../../per_gene/EOG091G0QE1/EOG091G0QE1.best_model 2> ../../../per_gene/EOG091G0QE1/find_best_model.stderr.txt
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/c0c09ee657b1e27f2c5687e0e9aa8d70.simg
[Sun Jul  5 23:22:18 2020]
Finished job 610.
2014 of 3292 steps (61%) done

[Sun Jul  5 23:22:18 2020]
rule infer_single_ML:
    input: per_gene/EOG091G0E06/EOG091G0E06.best_model, per_gene/EOG091G0E06/ALICUT_EOG091G0E06.clustalo.fasta
    output: per_gene/EOG091G0E06/EOG091G0E06.raxml.done
    log: per_gene/EOG091G0E06/infer_single_ML.stdout.txt, per_gene/EOG091G0E06/infer_single_ML.stderr.txt
    jobid: 99
    wildcards: BUSCO=EOG091G0E06
    threads: 2


        cd per_gene/EOG091G0E06
	count=$(cat ../../per_gene/EOG091G0E06/ALICUT_EOG091G0E06.clustalo.fasta | grep ">" | wc -l)
	if [ "$count" -gt 5 ]
        then
		RAxMLmodel=$(cat ../../per_gene/EOG091G0E06/EOG091G0E06.best_model | grep "Best" | cut -d ":" -f 2 | tr -d '[:space:]')
                if [ "$(ls -1 | grep "^RAxML" | wc -l)" -ne 0 ]
		then
			rm RAxML*
		fi
        	raxml -f a -T 2 -m PROTGAMMA$RAxMLmodel         	-p 12345 -x 12345 -# 100         	-s ../../per_gene/EOG091G0E06/ALICUT_EOG091G0E06.clustalo.fasta -n EOG091G0E06.clustalo.aln.ALICUT.$RAxMLmodel 		1> ../../per_gene/EOG091G0E06/infer_single_ML.stdout.txt 2> ../../per_gene/EOG091G0E06/infer_single_ML.stderr.txt
	else
		echo "fasta file per_gene/EOG091G0E06/ALICUT_EOG091G0E06.clustalo.fasta contains fewer than 5 sequences - skipped" > ../../per_gene/EOG091G0E06/infer_single_ML.stdout.txt
		touch raxml.skipped
	fi
        touch ../../per_gene/EOG091G0E06/EOG091G0E06.raxml.done
        
[33mJob counts:
	count	jobs
	1	infer_single_ML
	1[0m
[33m
        cd per_gene/EOG091G0E06
	count=$(cat ../../per_gene/EOG091G0E06/ALICUT_EOG091G0E06.clustalo.fasta | grep ">" | wc -l)
	if [ "$count" -gt 5 ]
        then
		RAxMLmodel=$(cat ../../per_gene/EOG091G0E06/EOG091G0E06.best_model | grep "Best" | cut -d ":" -f 2 | tr -d '[:space:]')
                if [ "$(ls -1 | grep "^RAxML" | wc -l)" -ne 0 ]
		then
			rm RAxML*
		fi
        	raxml -f a -T 2 -m PROTGAMMA$RAxMLmodel         	-p 12345 -x 12345 -# 100         	-s ../../per_gene/EOG091G0E06/ALICUT_EOG091G0E06.clustalo.fasta -n EOG091G0E06.clustalo.aln.ALICUT.$RAxMLmodel 		1> ../../per_gene/EOG091G0E06/infer_single_ML.stdout.txt 2> ../../per_gene/EOG091G0E06/infer_single_ML.stderr.txt
	else
		echo "fasta file per_gene/EOG091G0E06/ALICUT_EOG091G0E06.clustalo.fasta contains fewer than 5 sequences - skipped" > ../../per_gene/EOG091G0E06/infer_single_ML.stdout.txt
		touch raxml.skipped
	fi
        touch ../../per_gene/EOG091G0E06/EOG091G0E06.raxml.done
        [0m
[Sun Jul  5 23:22:22 2020]
Finished job 616.
2015 of 3292 steps (61%) done

[Sun Jul  5 23:22:22 2020]
rule infer_single_ML:
    input: per_gene/EOG091G0ES6/EOG091G0ES6.best_model, per_gene/EOG091G0ES6/ALICUT_EOG091G0ES6.clustalo.fasta
    output: per_gene/EOG091G0ES6/EOG091G0ES6.raxml.done
    log: per_gene/EOG091G0ES6/infer_single_ML.stdout.txt, per_gene/EOG091G0ES6/infer_single_ML.stderr.txt
    jobid: 102
    wildcards: BUSCO=EOG091G0ES6
    threads: 2


        cd per_gene/EOG091G0ES6
	count=$(cat ../../per_gene/EOG091G0ES6/ALICUT_EOG091G0ES6.clustalo.fasta | grep ">" | wc -l)
	if [ "$count" -gt 5 ]
        then
		RAxMLmodel=$(cat ../../per_gene/EOG091G0ES6/EOG091G0ES6.best_model | grep "Best" | cut -d ":" -f 2 | tr -d '[:space:]')
                if [ "$(ls -1 | grep "^RAxML" | wc -l)" -ne 0 ]
		then
			rm RAxML*
		fi
        	raxml -f a -T 2 -m PROTGAMMA$RAxMLmodel         	-p 12345 -x 12345 -# 100         	-s ../../per_gene/EOG091G0ES6/ALICUT_EOG091G0ES6.clustalo.fasta -n EOG091G0ES6.clustalo.aln.ALICUT.$RAxMLmodel 		1> ../../per_gene/EOG091G0ES6/infer_single_ML.stdout.txt 2> ../../per_gene/EOG091G0ES6/infer_single_ML.stderr.txt
	else
		echo "fasta file per_gene/EOG091G0ES6/ALICUT_EOG091G0ES6.clustalo.fasta contains fewer than 5 sequences - skipped" > ../../per_gene/EOG091G0ES6/infer_single_ML.stdout.txt
		touch raxml.skipped
	fi
        touch ../../per_gene/EOG091G0ES6/EOG091G0ES6.raxml.done
        
[33mJob counts:
	count	jobs
	1	infer_single_ML
	1[0m
[33m
        cd per_gene/EOG091G0ES6
	count=$(cat ../../per_gene/EOG091G0ES6/ALICUT_EOG091G0ES6.clustalo.fasta | grep ">" | wc -l)
	if [ "$count" -gt 5 ]
        then
		RAxMLmodel=$(cat ../../per_gene/EOG091G0ES6/EOG091G0ES6.best_model | grep "Best" | cut -d ":" -f 2 | tr -d '[:space:]')
                if [ "$(ls -1 | grep "^RAxML" | wc -l)" -ne 0 ]
		then
			rm RAxML*
		fi
        	raxml -f a -T 2 -m PROTGAMMA$RAxMLmodel         	-p 12345 -x 12345 -# 100         	-s ../../per_gene/EOG091G0ES6/ALICUT_EOG091G0ES6.clustalo.fasta -n EOG091G0ES6.clustalo.aln.ALICUT.$RAxMLmodel 		1> ../../per_gene/EOG091G0ES6/infer_single_ML.stdout.txt 2> ../../per_gene/EOG091G0ES6/infer_single_ML.stderr.txt
	else
		echo "fasta file per_gene/EOG091G0ES6/ALICUT_EOG091G0ES6.clustalo.fasta contains fewer than 5 sequences - skipped" > ../../per_gene/EOG091G0ES6/infer_single_ML.stdout.txt
		touch raxml.skipped
	fi
        touch ../../per_gene/EOG091G0ES6/EOG091G0ES6.raxml.done
        [0m
[Sun Jul  5 23:22:30 2020]
Finished job 371.
2016 of 3292 steps (61%) done

[Sun Jul  5 23:22:30 2020]
rule get_seqs:
    input: /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ingroup.txt, /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/outgroup.txt
    output: per_gene/EOG091G0291/EOG091G0291.ingroup.fasta
    log: per_gene/EOG091G0291/get_seqs.stdout.txt, per_gene/EOG091G0291/get_seqs.stderr.txt
    jobid: 3112
    wildcards: BUSCO=EOG091G0291
    threads: 2


	basedir=$(pwd)
        cd per_gene/EOG091G0291
        
        bash $basedir/../scripts/fetch_seqs.sh EOG091G0291 /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ingroup.txt /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/outgroup.txt 1> ../../per_gene/EOG091G0291/get_seqs.stdout.txt 2> ../../per_gene/EOG091G0291/get_seqs.stderr.txt
	mv EOG091G0291.fasta $basedir/per_gene/EOG091G0291/EOG091G0291.ingroup.fasta
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/72476f9d9a5bd0627b4d721143a21354.simg
[Sun Jul  5 23:22:31 2020]
Finished job 327.
2017 of 3292 steps (61%) done

[Sun Jul  5 23:22:31 2020]
rule get_seqs:
    input: /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ingroup.txt, /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/outgroup.txt
    output: per_gene/EOG091G0GWF/EOG091G0GWF.ingroup.fasta
    log: per_gene/EOG091G0GWF/get_seqs.stdout.txt, per_gene/EOG091G0GWF/get_seqs.stderr.txt
    jobid: 3272
    wildcards: BUSCO=EOG091G0GWF
    threads: 2


	basedir=$(pwd)
        cd per_gene/EOG091G0GWF
        
        bash $basedir/../scripts/fetch_seqs.sh EOG091G0GWF /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ingroup.txt /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/outgroup.txt 1> ../../per_gene/EOG091G0GWF/get_seqs.stdout.txt 2> ../../per_gene/EOG091G0GWF/get_seqs.stderr.txt
	mv EOG091G0GWF.fasta $basedir/per_gene/EOG091G0GWF/EOG091G0GWF.ingroup.fasta
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/72476f9d9a5bd0627b4d721143a21354.simg
[Sun Jul  5 23:22:36 2020]
Finished job 161.
2018 of 3292 steps (61%) done

[Sun Jul  5 23:22:36 2020]
rule get_seqs:
    input: /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ingroup.txt, /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/outgroup.txt
    output: per_gene/EOG091G059G/EOG091G059G.ingroup.fasta
    log: per_gene/EOG091G059G/get_seqs.stdout.txt, per_gene/EOG091G059G/get_seqs.stderr.txt
    jobid: 3138
    wildcards: BUSCO=EOG091G059G
    threads: 2


	basedir=$(pwd)
        cd per_gene/EOG091G059G
        
        bash $basedir/../scripts/fetch_seqs.sh EOG091G059G /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ingroup.txt /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/outgroup.txt 1> ../../per_gene/EOG091G059G/get_seqs.stdout.txt 2> ../../per_gene/EOG091G059G/get_seqs.stderr.txt
	mv EOG091G059G.fasta $basedir/per_gene/EOG091G059G/EOG091G059G.ingroup.fasta
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/72476f9d9a5bd0627b4d721143a21354.simg
[Sun Jul  5 23:22:41 2020]
Finished job 752.
2019 of 3292 steps (61%) done

[Sun Jul  5 23:22:41 2020]
rule infer_single_ML:
    input: per_gene/EOG091G0QE1/EOG091G0QE1.best_model, per_gene/EOG091G0QE1/ALICUT_EOG091G0QE1.clustalo.fasta
    output: per_gene/EOG091G0QE1/EOG091G0QE1.raxml.done
    log: per_gene/EOG091G0QE1/infer_single_ML.stdout.txt, per_gene/EOG091G0QE1/infer_single_ML.stderr.txt
    jobid: 170
    wildcards: BUSCO=EOG091G0QE1
    threads: 2


        cd per_gene/EOG091G0QE1
	count=$(cat ../../per_gene/EOG091G0QE1/ALICUT_EOG091G0QE1.clustalo.fasta | grep ">" | wc -l)
	if [ "$count" -gt 5 ]
        then
		RAxMLmodel=$(cat ../../per_gene/EOG091G0QE1/EOG091G0QE1.best_model | grep "Best" | cut -d ":" -f 2 | tr -d '[:space:]')
                if [ "$(ls -1 | grep "^RAxML" | wc -l)" -ne 0 ]
		then
			rm RAxML*
		fi
        	raxml -f a -T 2 -m PROTGAMMA$RAxMLmodel         	-p 12345 -x 12345 -# 100         	-s ../../per_gene/EOG091G0QE1/ALICUT_EOG091G0QE1.clustalo.fasta -n EOG091G0QE1.clustalo.aln.ALICUT.$RAxMLmodel 		1> ../../per_gene/EOG091G0QE1/infer_single_ML.stdout.txt 2> ../../per_gene/EOG091G0QE1/infer_single_ML.stderr.txt
	else
		echo "fasta file per_gene/EOG091G0QE1/ALICUT_EOG091G0QE1.clustalo.fasta contains fewer than 5 sequences - skipped" > ../../per_gene/EOG091G0QE1/infer_single_ML.stdout.txt
		touch raxml.skipped
	fi
        touch ../../per_gene/EOG091G0QE1/EOG091G0QE1.raxml.done
        
[33mJob counts:
	count	jobs
	1	infer_single_ML
	1[0m
[33m
        cd per_gene/EOG091G0QE1
	count=$(cat ../../per_gene/EOG091G0QE1/ALICUT_EOG091G0QE1.clustalo.fasta | grep ">" | wc -l)
	if [ "$count" -gt 5 ]
        then
		RAxMLmodel=$(cat ../../per_gene/EOG091G0QE1/EOG091G0QE1.best_model | grep "Best" | cut -d ":" -f 2 | tr -d '[:space:]')
                if [ "$(ls -1 | grep "^RAxML" | wc -l)" -ne 0 ]
		then
			rm RAxML*
		fi
        	raxml -f a -T 2 -m PROTGAMMA$RAxMLmodel         	-p 12345 -x 12345 -# 100         	-s ../../per_gene/EOG091G0QE1/ALICUT_EOG091G0QE1.clustalo.fasta -n EOG091G0QE1.clustalo.aln.ALICUT.$RAxMLmodel 		1> ../../per_gene/EOG091G0QE1/infer_single_ML.stdout.txt 2> ../../per_gene/EOG091G0QE1/infer_single_ML.stderr.txt
	else
		echo "fasta file per_gene/EOG091G0QE1/ALICUT_EOG091G0QE1.clustalo.fasta contains fewer than 5 sequences - skipped" > ../../per_gene/EOG091G0QE1/infer_single_ML.stdout.txt
		touch raxml.skipped
	fi
        touch ../../per_gene/EOG091G0QE1/EOG091G0QE1.raxml.done
        [0m
[Sun Jul  5 23:22:43 2020]
Finished job 3272.
2020 of 3292 steps (61%) done
[Sun Jul  5 23:22:43 2020]
Finished job 3112.
2021 of 3292 steps (61%) done

[Sun Jul  5 23:22:43 2020]
rule get_seqs:
    input: /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ingroup.txt, /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/outgroup.txt
    output: per_gene/EOG091G0307/EOG091G0307.ingroup.fasta
    log: per_gene/EOG091G0307/get_seqs.stdout.txt, per_gene/EOG091G0307/get_seqs.stderr.txt
    jobid: 2500
    wildcards: BUSCO=EOG091G0307
    threads: 2


	basedir=$(pwd)
        cd per_gene/EOG091G0307
        
        bash $basedir/../scripts/fetch_seqs.sh EOG091G0307 /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ingroup.txt /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/outgroup.txt 1> ../../per_gene/EOG091G0307/get_seqs.stdout.txt 2> ../../per_gene/EOG091G0307/get_seqs.stderr.txt
	mv EOG091G0307.fasta $basedir/per_gene/EOG091G0307/EOG091G0307.ingroup.fasta
        

[Sun Jul  5 23:22:43 2020]
rule get_outgroups:
    input: per_gene/EOG091G0GWF/EOG091G0GWF.ingroup.fasta
    output: per_gene/EOG091G0GWF/EOG091G0GWF.orthodb.fasta, per_gene/EOG091G0GWF/EOG091G0GWF.outgroup.fasta
    log: per_gene/EOG091G0GWF/get_outgroups.stdout.txt, per_gene/EOG091G0GWF/get_outgroups.stderr.txt
    jobid: 3273
    wildcards: BUSCO=EOG091G0GWF


        #download fastas from Orhtodb for BUSCO id
        for i in {1..5}
        do
             wget "http://www.orthodb.org/fasta?query=EOG091G0GWF&level=33208" -O per_gene/EOG091G0GWF/EOG091G0GWF.orthodb.fasta 1> per_gene/EOG091G0GWF/get_outgroups.stdout.txt 2> per_gene/EOG091G0GWF/get_outgroups.stderr.txt && break || echo -e "try again ($i)" && sleep 15
        done

	#This is quick an dirty for now and just takes the first protein if there is more than one for an outgroup taxon
        bash ../scripts/download_outgroups.sh taxids.txt per_gene/EOG091G0GWF/EOG091G0GWF.orthodb.fasta > per_gene/EOG091G0GWF/EOG091G0GWF.outgroup.fasta
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/72476f9d9a5bd0627b4d721143a21354.simg

[Sun Jul  5 23:22:43 2020]
rule get_outgroups:
    input: per_gene/EOG091G0291/EOG091G0291.ingroup.fasta
    output: per_gene/EOG091G0291/EOG091G0291.orthodb.fasta, per_gene/EOG091G0291/EOG091G0291.outgroup.fasta
    log: per_gene/EOG091G0291/get_outgroups.stdout.txt, per_gene/EOG091G0291/get_outgroups.stderr.txt
    jobid: 3113
    wildcards: BUSCO=EOG091G0291


        #download fastas from Orhtodb for BUSCO id
        for i in {1..5}
        do
             wget "http://www.orthodb.org/fasta?query=EOG091G0291&level=33208" -O per_gene/EOG091G0291/EOG091G0291.orthodb.fasta 1> per_gene/EOG091G0291/get_outgroups.stdout.txt 2> per_gene/EOG091G0291/get_outgroups.stderr.txt && break || echo -e "try again ($i)" && sleep 15
        done

	#This is quick an dirty for now and just takes the first protein if there is more than one for an outgroup taxon
        bash ../scripts/download_outgroups.sh taxids.txt per_gene/EOG091G0291/EOG091G0291.orthodb.fasta > per_gene/EOG091G0291/EOG091G0291.outgroup.fasta
        
[Sun Jul  5 23:22:44 2020]
Finished job 3273.
2022 of 3292 steps (61%) done

[Sun Jul  5 23:22:44 2020]
rule join_groups:
    input: per_gene/EOG091G0GWF/EOG091G0GWF.ingroup.fasta, per_gene/EOG091G0GWF/EOG091G0GWF.outgroup.fasta
    output: per_gene/EOG091G0GWF/EOG091G0GWF.fasta
    jobid: 2460
    wildcards: BUSCO=EOG091G0GWF


        cat per_gene/EOG091G0GWF/EOG091G0GWF.ingroup.fasta per_gene/EOG091G0GWF/EOG091G0GWF.outgroup.fasta > per_gene/EOG091G0GWF/EOG091G0GWF.fasta
        
[Sun Jul  5 23:22:44 2020]
Finished job 2460.
2023 of 3292 steps (61%) done
[Sun Jul  5 23:22:45 2020]
Finished job 3113.
2024 of 3292 steps (61%) done

[Sun Jul  5 23:22:45 2020]
rule join_groups:
    input: per_gene/EOG091G0291/EOG091G0291.ingroup.fasta, per_gene/EOG091G0291/EOG091G0291.outgroup.fasta
    output: per_gene/EOG091G0291/EOG091G0291.fasta
    jobid: 2380
    wildcards: BUSCO=EOG091G0291


        cat per_gene/EOG091G0291/EOG091G0291.ingroup.fasta per_gene/EOG091G0291/EOG091G0291.outgroup.fasta > per_gene/EOG091G0291/EOG091G0291.fasta
        
[Sun Jul  5 23:22:45 2020]
Finished job 2380.
2025 of 3292 steps (62%) done

[Sun Jul  5 23:22:45 2020]
rule MSA:
    input: per_gene/EOG091G0291/EOG091G0291.fasta
    output: per_gene/EOG091G0291/EOG091G0291.clustalo.fasta
    log: per_gene/EOG091G0291/MSA.stdout.txt, per_gene/EOG091G0291/MSA.stderr.txt
    jobid: 1880
    wildcards: BUSCO=EOG091G0291
    threads: 2


        clustalo -i per_gene/EOG091G0291/EOG091G0291.fasta -o per_gene/EOG091G0291/EOG091G0291.clustalo.fasta --threads=2 1> per_gene/EOG091G0291/MSA.stdout.txt 2> per_gene/EOG091G0291/MSA.stderr.txt
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/d68c9691725a7401923680874285c430.simg
[Sun Jul  5 23:22:47 2020]
Finished job 406.
2026 of 3292 steps (62%) done

[Sun Jul  5 23:22:47 2020]
rule MSA:
    input: per_gene/EOG091G0GWF/EOG091G0GWF.fasta
    output: per_gene/EOG091G0GWF/EOG091G0GWF.clustalo.fasta
    log: per_gene/EOG091G0GWF/MSA.stdout.txt, per_gene/EOG091G0GWF/MSA.stderr.txt
    jobid: 2040
    wildcards: BUSCO=EOG091G0GWF
    threads: 2


        clustalo -i per_gene/EOG091G0GWF/EOG091G0GWF.fasta -o per_gene/EOG091G0GWF/EOG091G0GWF.clustalo.fasta --threads=2 1> per_gene/EOG091G0GWF/MSA.stdout.txt 2> per_gene/EOG091G0GWF/MSA.stderr.txt
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/d68c9691725a7401923680874285c430.simg
[Sun Jul  5 23:22:48 2020]
Finished job 3138.
2027 of 3292 steps (62%) done

[Sun Jul  5 23:22:48 2020]
rule get_outgroups:
    input: per_gene/EOG091G059G/EOG091G059G.ingroup.fasta
    output: per_gene/EOG091G059G/EOG091G059G.orthodb.fasta, per_gene/EOG091G059G/EOG091G059G.outgroup.fasta
    log: per_gene/EOG091G059G/get_outgroups.stdout.txt, per_gene/EOG091G059G/get_outgroups.stderr.txt
    jobid: 3139
    wildcards: BUSCO=EOG091G059G


        #download fastas from Orhtodb for BUSCO id
        for i in {1..5}
        do
             wget "http://www.orthodb.org/fasta?query=EOG091G059G&level=33208" -O per_gene/EOG091G059G/EOG091G059G.orthodb.fasta 1> per_gene/EOG091G059G/get_outgroups.stdout.txt 2> per_gene/EOG091G059G/get_outgroups.stderr.txt && break || echo -e "try again ($i)" && sleep 15
        done

	#This is quick an dirty for now and just takes the first protein if there is more than one for an outgroup taxon
        bash ../scripts/download_outgroups.sh taxids.txt per_gene/EOG091G059G/EOG091G059G.orthodb.fasta > per_gene/EOG091G059G/EOG091G059G.outgroup.fasta
        
[Sun Jul  5 23:22:48 2020]
Finished job 1880.
2028 of 3292 steps (62%) done

[Sun Jul  5 23:22:48 2020]
rule score_and_cut:
    input: per_gene/EOG091G0291/EOG091G0291.clustalo.fasta
    output: per_gene/EOG091G0291/ALICUT_EOG091G0291.clustalo.fasta
    jobid: 1057
    wildcards: BUSCO=EOG091G0291
    threads: 2


        cd per_gene/EOG091G0291
        Aliscore.pl -N -r 200000000000000000 -i ../../per_gene/EOG091G0291/EOG091G0291.clustalo.fasta &> aliscore.log
        ALICUT.pl -s &> alicut.log
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/63c88c27a0fa300f57066b0ef65fefcb.simg
[Sun Jul  5 23:22:48 2020]
Finished job 2040.
2029 of 3292 steps (62%) done

[Sun Jul  5 23:22:48 2020]
rule score_and_cut:
    input: per_gene/EOG091G0GWF/EOG091G0GWF.clustalo.fasta
    output: per_gene/EOG091G0GWF/ALICUT_EOG091G0GWF.clustalo.fasta
    jobid: 1217
    wildcards: BUSCO=EOG091G0GWF
    threads: 2


        cd per_gene/EOG091G0GWF
        Aliscore.pl -N -r 200000000000000000 -i ../../per_gene/EOG091G0GWF/EOG091G0GWF.clustalo.fasta &> aliscore.log
        ALICUT.pl -s &> alicut.log
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/63c88c27a0fa300f57066b0ef65fefcb.simg
[Sun Jul  5 23:22:49 2020]
Finished job 3139.
2030 of 3292 steps (62%) done

[Sun Jul  5 23:22:49 2020]
rule join_groups:
    input: per_gene/EOG091G059G/EOG091G059G.ingroup.fasta, per_gene/EOG091G059G/EOG091G059G.outgroup.fasta
    output: per_gene/EOG091G059G/EOG091G059G.fasta
    jobid: 2393
    wildcards: BUSCO=EOG091G059G


        cat per_gene/EOG091G059G/EOG091G059G.ingroup.fasta per_gene/EOG091G059G/EOG091G059G.outgroup.fasta > per_gene/EOG091G059G/EOG091G059G.fasta
        
[Sun Jul  5 23:22:49 2020]
Finished job 2393.
2031 of 3292 steps (62%) done

[Sun Jul  5 23:22:49 2020]
rule MSA:
    input: per_gene/EOG091G059G/EOG091G059G.fasta
    output: per_gene/EOG091G059G/EOG091G059G.clustalo.fasta
    log: per_gene/EOG091G059G/MSA.stdout.txt, per_gene/EOG091G059G/MSA.stderr.txt
    jobid: 1906
    wildcards: BUSCO=EOG091G059G
    threads: 2


        clustalo -i per_gene/EOG091G059G/EOG091G059G.fasta -o per_gene/EOG091G059G/EOG091G059G.clustalo.fasta --threads=2 1> per_gene/EOG091G059G/MSA.stdout.txt 2> per_gene/EOG091G059G/MSA.stderr.txt
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/d68c9691725a7401923680874285c430.simg
[Sun Jul  5 23:22:50 2020]
Finished job 1906.
2032 of 3292 steps (62%) done

[Sun Jul  5 23:22:50 2020]
rule score_and_cut:
    input: per_gene/EOG091G059G/EOG091G059G.clustalo.fasta
    output: per_gene/EOG091G059G/ALICUT_EOG091G059G.clustalo.fasta
    jobid: 1083
    wildcards: BUSCO=EOG091G059G
    threads: 2


        cd per_gene/EOG091G059G
        Aliscore.pl -N -r 200000000000000000 -i ../../per_gene/EOG091G059G/EOG091G059G.clustalo.fasta &> aliscore.log
        ALICUT.pl -s &> alicut.log
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/63c88c27a0fa300f57066b0ef65fefcb.simg
[Sun Jul  5 23:22:53 2020]
Finished job 2500.
2033 of 3292 steps (62%) done

[Sun Jul  5 23:22:53 2020]
rule get_outgroups:
    input: per_gene/EOG091G0307/EOG091G0307.ingroup.fasta
    output: per_gene/EOG091G0307/EOG091G0307.orthodb.fasta, per_gene/EOG091G0307/EOG091G0307.outgroup.fasta
    log: per_gene/EOG091G0307/get_outgroups.stdout.txt, per_gene/EOG091G0307/get_outgroups.stderr.txt
    jobid: 2501
    wildcards: BUSCO=EOG091G0307


        #download fastas from Orhtodb for BUSCO id
        for i in {1..5}
        do
             wget "http://www.orthodb.org/fasta?query=EOG091G0307&level=33208" -O per_gene/EOG091G0307/EOG091G0307.orthodb.fasta 1> per_gene/EOG091G0307/get_outgroups.stdout.txt 2> per_gene/EOG091G0307/get_outgroups.stderr.txt && break || echo -e "try again ($i)" && sleep 15
        done

	#This is quick an dirty for now and just takes the first protein if there is more than one for an outgroup taxon
        bash ../scripts/download_outgroups.sh taxids.txt per_gene/EOG091G0307/EOG091G0307.orthodb.fasta > per_gene/EOG091G0307/EOG091G0307.outgroup.fasta
        
[Sun Jul  5 23:22:54 2020]
Finished job 2501.
2034 of 3292 steps (62%) done

[Sun Jul  5 23:22:54 2020]
rule join_groups:
    input: per_gene/EOG091G0307/EOG091G0307.ingroup.fasta, per_gene/EOG091G0307/EOG091G0307.outgroup.fasta
    output: per_gene/EOG091G0307/EOG091G0307.fasta
    jobid: 2074
    wildcards: BUSCO=EOG091G0307


        cat per_gene/EOG091G0307/EOG091G0307.ingroup.fasta per_gene/EOG091G0307/EOG091G0307.outgroup.fasta > per_gene/EOG091G0307/EOG091G0307.fasta
        
[Sun Jul  5 23:22:54 2020]
Finished job 2074.
2035 of 3292 steps (62%) done

[Sun Jul  5 23:22:54 2020]
rule MSA:
    input: per_gene/EOG091G0307/EOG091G0307.fasta
    output: per_gene/EOG091G0307/EOG091G0307.clustalo.fasta
    log: per_gene/EOG091G0307/MSA.stdout.txt, per_gene/EOG091G0307/MSA.stderr.txt
    jobid: 1268
    wildcards: BUSCO=EOG091G0307
    threads: 2


        clustalo -i per_gene/EOG091G0307/EOG091G0307.fasta -o per_gene/EOG091G0307/EOG091G0307.clustalo.fasta --threads=2 1> per_gene/EOG091G0307/MSA.stdout.txt 2> per_gene/EOG091G0307/MSA.stderr.txt
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/d68c9691725a7401923680874285c430.simg
[Sun Jul  5 23:22:58 2020]
Finished job 1217.
2036 of 3292 steps (62%) done

[Sun Jul  5 23:22:58 2020]
rule remove_empty:
    input: per_gene/EOG091G0GWF/ALICUT_EOG091G0GWF.clustalo.fasta
    output: per_gene/EOG091G0GWF/empty_check.done
    jobid: 2039
    wildcards: BUSCO=EOG091G0GWF


         if [ "$(cat per_gene/EOG091G0GWF/ALICUT_EOG091G0GWF.clustalo.fasta | grep -v ">" | sed 's/-//g' | grep "^$" | wc -l)" -gt 0 ]
         then
              cp per_gene/EOG091G0GWF/ALICUT_EOG091G0GWF.clustalo.fasta per_gene/EOG091G0GWF/ALICUT_EOG091G0GWF.clustalo.fasta.backup
              bash ../scripts/remove_empty.sh per_gene/EOG091G0GWF/ALICUT_EOG091G0GWF.clustalo.fasta.backup > per_gene/EOG091G0GWF/ALICUT_EOG091G0GWF.clustalo.fasta
         fi
         touch per_gene/EOG091G0GWF/empty_check.done
         
[Sun Jul  5 23:22:58 2020]
Finished job 2039.
2037 of 3292 steps (62%) done

[Sun Jul  5 23:22:58 2020]
rule find_best_model:
    input: per_gene/EOG091G0GWF/ALICUT_EOG091G0GWF.clustalo.fasta, per_gene/EOG091G0GWF/empty_check.done
    output: per_gene/EOG091G0GWF/EOG091G0GWF.best_model
    log: per_gene/EOG091G0GWF/find_best_model.stderr.txt
    jobid: 1216
    wildcards: BUSCO=EOG091G0GWF
    threads: 2


        cd per_gene/EOG091G0GWF
        if [ ! -d find_best_model ]
        then
            mkdir find_best_model
        fi
        cd find_best_model
        ln -s ../../../per_gene/EOG091G0GWF/ALICUT_EOG091G0GWF.clustalo.fasta EOG091G0GWF.fasta
        ProteinModelSelection.pl EOG091G0GWF.fasta 1> ../../../per_gene/EOG091G0GWF/EOG091G0GWF.best_model 2> ../../../per_gene/EOG091G0GWF/find_best_model.stderr.txt
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/c0c09ee657b1e27f2c5687e0e9aa8d70.simg
[Sun Jul  5 23:22:58 2020]
Finished job 1057.
2038 of 3292 steps (62%) done

[Sun Jul  5 23:22:59 2020]
rule remove_empty:
    input: per_gene/EOG091G0291/ALICUT_EOG091G0291.clustalo.fasta
    output: per_gene/EOG091G0291/empty_check.done
    jobid: 1879
    wildcards: BUSCO=EOG091G0291


         if [ "$(cat per_gene/EOG091G0291/ALICUT_EOG091G0291.clustalo.fasta | grep -v ">" | sed 's/-//g' | grep "^$" | wc -l)" -gt 0 ]
         then
              cp per_gene/EOG091G0291/ALICUT_EOG091G0291.clustalo.fasta per_gene/EOG091G0291/ALICUT_EOG091G0291.clustalo.fasta.backup
              bash ../scripts/remove_empty.sh per_gene/EOG091G0291/ALICUT_EOG091G0291.clustalo.fasta.backup > per_gene/EOG091G0291/ALICUT_EOG091G0291.clustalo.fasta
         fi
         touch per_gene/EOG091G0291/empty_check.done
         
[Sun Jul  5 23:22:59 2020]
Finished job 1879.
2039 of 3292 steps (62%) done

[Sun Jul  5 23:22:59 2020]
rule find_best_model:
    input: per_gene/EOG091G0291/ALICUT_EOG091G0291.clustalo.fasta, per_gene/EOG091G0291/empty_check.done
    output: per_gene/EOG091G0291/EOG091G0291.best_model
    log: per_gene/EOG091G0291/find_best_model.stderr.txt
    jobid: 1056
    wildcards: BUSCO=EOG091G0291
    threads: 2


        cd per_gene/EOG091G0291
        if [ ! -d find_best_model ]
        then
            mkdir find_best_model
        fi
        cd find_best_model
        ln -s ../../../per_gene/EOG091G0291/ALICUT_EOG091G0291.clustalo.fasta EOG091G0291.fasta
        ProteinModelSelection.pl EOG091G0291.fasta 1> ../../../per_gene/EOG091G0291/EOG091G0291.best_model 2> ../../../per_gene/EOG091G0291/find_best_model.stderr.txt
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/c0c09ee657b1e27f2c5687e0e9aa8d70.simg
[Sun Jul  5 23:23:00 2020]
Finished job 1268.
2040 of 3292 steps (62%) done

[Sun Jul  5 23:23:00 2020]
rule score_and_cut:
    input: per_gene/EOG091G0307/EOG091G0307.clustalo.fasta
    output: per_gene/EOG091G0307/ALICUT_EOG091G0307.clustalo.fasta
    jobid: 445
    wildcards: BUSCO=EOG091G0307
    threads: 2


        cd per_gene/EOG091G0307
        Aliscore.pl -N -r 200000000000000000 -i ../../per_gene/EOG091G0307/EOG091G0307.clustalo.fasta &> aliscore.log
        ALICUT.pl -s &> alicut.log
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/63c88c27a0fa300f57066b0ef65fefcb.simg
[Sun Jul  5 23:23:01 2020]
Finished job 1083.
2041 of 3292 steps (62%) done

[Sun Jul  5 23:23:01 2020]
rule remove_empty:
    input: per_gene/EOG091G059G/ALICUT_EOG091G059G.clustalo.fasta
    output: per_gene/EOG091G059G/empty_check.done
    jobid: 1905
    wildcards: BUSCO=EOG091G059G


         if [ "$(cat per_gene/EOG091G059G/ALICUT_EOG091G059G.clustalo.fasta | grep -v ">" | sed 's/-//g' | grep "^$" | wc -l)" -gt 0 ]
         then
              cp per_gene/EOG091G059G/ALICUT_EOG091G059G.clustalo.fasta per_gene/EOG091G059G/ALICUT_EOG091G059G.clustalo.fasta.backup
              bash ../scripts/remove_empty.sh per_gene/EOG091G059G/ALICUT_EOG091G059G.clustalo.fasta.backup > per_gene/EOG091G059G/ALICUT_EOG091G059G.clustalo.fasta
         fi
         touch per_gene/EOG091G059G/empty_check.done
         
[Sun Jul  5 23:23:01 2020]
Finished job 1905.
2042 of 3292 steps (62%) done

[Sun Jul  5 23:23:01 2020]
rule find_best_model:
    input: per_gene/EOG091G059G/ALICUT_EOG091G059G.clustalo.fasta, per_gene/EOG091G059G/empty_check.done
    output: per_gene/EOG091G059G/EOG091G059G.best_model
    log: per_gene/EOG091G059G/find_best_model.stderr.txt
    jobid: 1082
    wildcards: BUSCO=EOG091G059G
    threads: 2


        cd per_gene/EOG091G059G
        if [ ! -d find_best_model ]
        then
            mkdir find_best_model
        fi
        cd find_best_model
        ln -s ../../../per_gene/EOG091G059G/ALICUT_EOG091G059G.clustalo.fasta EOG091G059G.fasta
        ProteinModelSelection.pl EOG091G059G.fasta 1> ../../../per_gene/EOG091G059G/EOG091G059G.best_model 2> ../../../per_gene/EOG091G059G/find_best_model.stderr.txt
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/c0c09ee657b1e27f2c5687e0e9aa8d70.simg
[Sun Jul  5 23:23:12 2020]
Finished job 445.
2043 of 3292 steps (62%) done

[Sun Jul  5 23:23:12 2020]
rule remove_empty:
    input: per_gene/EOG091G0307/ALICUT_EOG091G0307.clustalo.fasta
    output: per_gene/EOG091G0307/empty_check.done
    jobid: 1267
    wildcards: BUSCO=EOG091G0307


         if [ "$(cat per_gene/EOG091G0307/ALICUT_EOG091G0307.clustalo.fasta | grep -v ">" | sed 's/-//g' | grep "^$" | wc -l)" -gt 0 ]
         then
              cp per_gene/EOG091G0307/ALICUT_EOG091G0307.clustalo.fasta per_gene/EOG091G0307/ALICUT_EOG091G0307.clustalo.fasta.backup
              bash ../scripts/remove_empty.sh per_gene/EOG091G0307/ALICUT_EOG091G0307.clustalo.fasta.backup > per_gene/EOG091G0307/ALICUT_EOG091G0307.clustalo.fasta
         fi
         touch per_gene/EOG091G0307/empty_check.done
         
[Sun Jul  5 23:23:12 2020]
Finished job 1267.
2044 of 3292 steps (62%) done

[Sun Jul  5 23:23:12 2020]
rule find_best_model:
    input: per_gene/EOG091G0307/ALICUT_EOG091G0307.clustalo.fasta, per_gene/EOG091G0307/empty_check.done
    output: per_gene/EOG091G0307/EOG091G0307.best_model
    log: per_gene/EOG091G0307/find_best_model.stderr.txt
    jobid: 444
    wildcards: BUSCO=EOG091G0307
    threads: 2


        cd per_gene/EOG091G0307
        if [ ! -d find_best_model ]
        then
            mkdir find_best_model
        fi
        cd find_best_model
        ln -s ../../../per_gene/EOG091G0307/ALICUT_EOG091G0307.clustalo.fasta EOG091G0307.fasta
        ProteinModelSelection.pl EOG091G0307.fasta 1> ../../../per_gene/EOG091G0307/EOG091G0307.best_model 2> ../../../per_gene/EOG091G0307/find_best_model.stderr.txt
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/c0c09ee657b1e27f2c5687e0e9aa8d70.simg
[Sun Jul  5 23:23:32 2020]
Finished job 1216.
2045 of 3292 steps (62%) done

[Sun Jul  5 23:23:32 2020]
rule infer_single_ML:
    input: per_gene/EOG091G0GWF/EOG091G0GWF.best_model, per_gene/EOG091G0GWF/ALICUT_EOG091G0GWF.clustalo.fasta
    output: per_gene/EOG091G0GWF/EOG091G0GWF.raxml.done
    log: per_gene/EOG091G0GWF/infer_single_ML.stdout.txt, per_gene/EOG091G0GWF/infer_single_ML.stderr.txt
    jobid: 402
    wildcards: BUSCO=EOG091G0GWF
    threads: 2


        cd per_gene/EOG091G0GWF
	count=$(cat ../../per_gene/EOG091G0GWF/ALICUT_EOG091G0GWF.clustalo.fasta | grep ">" | wc -l)
	if [ "$count" -gt 5 ]
        then
		RAxMLmodel=$(cat ../../per_gene/EOG091G0GWF/EOG091G0GWF.best_model | grep "Best" | cut -d ":" -f 2 | tr -d '[:space:]')
                if [ "$(ls -1 | grep "^RAxML" | wc -l)" -ne 0 ]
		then
			rm RAxML*
		fi
        	raxml -f a -T 2 -m PROTGAMMA$RAxMLmodel         	-p 12345 -x 12345 -# 100         	-s ../../per_gene/EOG091G0GWF/ALICUT_EOG091G0GWF.clustalo.fasta -n EOG091G0GWF.clustalo.aln.ALICUT.$RAxMLmodel 		1> ../../per_gene/EOG091G0GWF/infer_single_ML.stdout.txt 2> ../../per_gene/EOG091G0GWF/infer_single_ML.stderr.txt
	else
		echo "fasta file per_gene/EOG091G0GWF/ALICUT_EOG091G0GWF.clustalo.fasta contains fewer than 5 sequences - skipped" > ../../per_gene/EOG091G0GWF/infer_single_ML.stdout.txt
		touch raxml.skipped
	fi
        touch ../../per_gene/EOG091G0GWF/EOG091G0GWF.raxml.done
        
[33mJob counts:
	count	jobs
	1	infer_single_ML
	1[0m
[33m
        cd per_gene/EOG091G0GWF
	count=$(cat ../../per_gene/EOG091G0GWF/ALICUT_EOG091G0GWF.clustalo.fasta | grep ">" | wc -l)
	if [ "$count" -gt 5 ]
        then
		RAxMLmodel=$(cat ../../per_gene/EOG091G0GWF/EOG091G0GWF.best_model | grep "Best" | cut -d ":" -f 2 | tr -d '[:space:]')
                if [ "$(ls -1 | grep "^RAxML" | wc -l)" -ne 0 ]
		then
			rm RAxML*
		fi
        	raxml -f a -T 2 -m PROTGAMMA$RAxMLmodel         	-p 12345 -x 12345 -# 100         	-s ../../per_gene/EOG091G0GWF/ALICUT_EOG091G0GWF.clustalo.fasta -n EOG091G0GWF.clustalo.aln.ALICUT.$RAxMLmodel 		1> ../../per_gene/EOG091G0GWF/infer_single_ML.stdout.txt 2> ../../per_gene/EOG091G0GWF/infer_single_ML.stderr.txt
	else
		echo "fasta file per_gene/EOG091G0GWF/ALICUT_EOG091G0GWF.clustalo.fasta contains fewer than 5 sequences - skipped" > ../../per_gene/EOG091G0GWF/infer_single_ML.stdout.txt
		touch raxml.skipped
	fi
        touch ../../per_gene/EOG091G0GWF/EOG091G0GWF.raxml.done
        [0m
[Sun Jul  5 23:23:40 2020]
Finished job 1082.
2046 of 3292 steps (62%) done

[Sun Jul  5 23:23:40 2020]
rule infer_single_ML:
    input: per_gene/EOG091G059G/EOG091G059G.best_model, per_gene/EOG091G059G/ALICUT_EOG091G059G.clustalo.fasta
    output: per_gene/EOG091G059G/EOG091G059G.raxml.done
    log: per_gene/EOG091G059G/infer_single_ML.stdout.txt, per_gene/EOG091G059G/infer_single_ML.stderr.txt
    jobid: 335
    wildcards: BUSCO=EOG091G059G
    threads: 2


        cd per_gene/EOG091G059G
	count=$(cat ../../per_gene/EOG091G059G/ALICUT_EOG091G059G.clustalo.fasta | grep ">" | wc -l)
	if [ "$count" -gt 5 ]
        then
		RAxMLmodel=$(cat ../../per_gene/EOG091G059G/EOG091G059G.best_model | grep "Best" | cut -d ":" -f 2 | tr -d '[:space:]')
                if [ "$(ls -1 | grep "^RAxML" | wc -l)" -ne 0 ]
		then
			rm RAxML*
		fi
        	raxml -f a -T 2 -m PROTGAMMA$RAxMLmodel         	-p 12345 -x 12345 -# 100         	-s ../../per_gene/EOG091G059G/ALICUT_EOG091G059G.clustalo.fasta -n EOG091G059G.clustalo.aln.ALICUT.$RAxMLmodel 		1> ../../per_gene/EOG091G059G/infer_single_ML.stdout.txt 2> ../../per_gene/EOG091G059G/infer_single_ML.stderr.txt
	else
		echo "fasta file per_gene/EOG091G059G/ALICUT_EOG091G059G.clustalo.fasta contains fewer than 5 sequences - skipped" > ../../per_gene/EOG091G059G/infer_single_ML.stdout.txt
		touch raxml.skipped
	fi
        touch ../../per_gene/EOG091G059G/EOG091G059G.raxml.done
        
[33mJob counts:
	count	jobs
	1	infer_single_ML
	1[0m
[33m
        cd per_gene/EOG091G059G
	count=$(cat ../../per_gene/EOG091G059G/ALICUT_EOG091G059G.clustalo.fasta | grep ">" | wc -l)
	if [ "$count" -gt 5 ]
        then
		RAxMLmodel=$(cat ../../per_gene/EOG091G059G/EOG091G059G.best_model | grep "Best" | cut -d ":" -f 2 | tr -d '[:space:]')
                if [ "$(ls -1 | grep "^RAxML" | wc -l)" -ne 0 ]
		then
			rm RAxML*
		fi
        	raxml -f a -T 2 -m PROTGAMMA$RAxMLmodel         	-p 12345 -x 12345 -# 100         	-s ../../per_gene/EOG091G059G/ALICUT_EOG091G059G.clustalo.fasta -n EOG091G059G.clustalo.aln.ALICUT.$RAxMLmodel 		1> ../../per_gene/EOG091G059G/infer_single_ML.stdout.txt 2> ../../per_gene/EOG091G059G/infer_single_ML.stderr.txt
	else
		echo "fasta file per_gene/EOG091G059G/ALICUT_EOG091G059G.clustalo.fasta contains fewer than 5 sequences - skipped" > ../../per_gene/EOG091G059G/infer_single_ML.stdout.txt
		touch raxml.skipped
	fi
        touch ../../per_gene/EOG091G059G/EOG091G059G.raxml.done
        [0m
[Sun Jul  5 23:23:44 2020]
Finished job 1056.
2047 of 3292 steps (62%) done

[Sun Jul  5 23:23:44 2020]
rule infer_single_ML:
    input: per_gene/EOG091G0291/EOG091G0291.best_model, per_gene/EOG091G0291/ALICUT_EOG091G0291.clustalo.fasta
    output: per_gene/EOG091G0291/EOG091G0291.raxml.done
    log: per_gene/EOG091G0291/infer_single_ML.stdout.txt, per_gene/EOG091G0291/infer_single_ML.stderr.txt
    jobid: 322
    wildcards: BUSCO=EOG091G0291
    threads: 2


        cd per_gene/EOG091G0291
	count=$(cat ../../per_gene/EOG091G0291/ALICUT_EOG091G0291.clustalo.fasta | grep ">" | wc -l)
	if [ "$count" -gt 5 ]
        then
		RAxMLmodel=$(cat ../../per_gene/EOG091G0291/EOG091G0291.best_model | grep "Best" | cut -d ":" -f 2 | tr -d '[:space:]')
                if [ "$(ls -1 | grep "^RAxML" | wc -l)" -ne 0 ]
		then
			rm RAxML*
		fi
        	raxml -f a -T 2 -m PROTGAMMA$RAxMLmodel         	-p 12345 -x 12345 -# 100         	-s ../../per_gene/EOG091G0291/ALICUT_EOG091G0291.clustalo.fasta -n EOG091G0291.clustalo.aln.ALICUT.$RAxMLmodel 		1> ../../per_gene/EOG091G0291/infer_single_ML.stdout.txt 2> ../../per_gene/EOG091G0291/infer_single_ML.stderr.txt
	else
		echo "fasta file per_gene/EOG091G0291/ALICUT_EOG091G0291.clustalo.fasta contains fewer than 5 sequences - skipped" > ../../per_gene/EOG091G0291/infer_single_ML.stdout.txt
		touch raxml.skipped
	fi
        touch ../../per_gene/EOG091G0291/EOG091G0291.raxml.done
        
[33mJob counts:
	count	jobs
	1	infer_single_ML
	1[0m
[33m
        cd per_gene/EOG091G0291
	count=$(cat ../../per_gene/EOG091G0291/ALICUT_EOG091G0291.clustalo.fasta | grep ">" | wc -l)
	if [ "$count" -gt 5 ]
        then
		RAxMLmodel=$(cat ../../per_gene/EOG091G0291/EOG091G0291.best_model | grep "Best" | cut -d ":" -f 2 | tr -d '[:space:]')
                if [ "$(ls -1 | grep "^RAxML" | wc -l)" -ne 0 ]
		then
			rm RAxML*
		fi
        	raxml -f a -T 2 -m PROTGAMMA$RAxMLmodel         	-p 12345 -x 12345 -# 100         	-s ../../per_gene/EOG091G0291/ALICUT_EOG091G0291.clustalo.fasta -n EOG091G0291.clustalo.aln.ALICUT.$RAxMLmodel 		1> ../../per_gene/EOG091G0291/infer_single_ML.stdout.txt 2> ../../per_gene/EOG091G0291/infer_single_ML.stderr.txt
	else
		echo "fasta file per_gene/EOG091G0291/ALICUT_EOG091G0291.clustalo.fasta contains fewer than 5 sequences - skipped" > ../../per_gene/EOG091G0291/infer_single_ML.stdout.txt
		touch raxml.skipped
	fi
        touch ../../per_gene/EOG091G0291/EOG091G0291.raxml.done
        [0m
[Sun Jul  5 23:23:54 2020]
Finished job 444.
2048 of 3292 steps (62%) done

[Sun Jul  5 23:23:54 2020]
rule infer_single_ML:
    input: per_gene/EOG091G0307/EOG091G0307.best_model, per_gene/EOG091G0307/ALICUT_EOG091G0307.clustalo.fasta
    output: per_gene/EOG091G0307/EOG091G0307.raxml.done
    log: per_gene/EOG091G0307/infer_single_ML.stdout.txt, per_gene/EOG091G0307/infer_single_ML.stderr.txt
    jobid: 16
    wildcards: BUSCO=EOG091G0307
    threads: 2


        cd per_gene/EOG091G0307
	count=$(cat ../../per_gene/EOG091G0307/ALICUT_EOG091G0307.clustalo.fasta | grep ">" | wc -l)
	if [ "$count" -gt 5 ]
        then
		RAxMLmodel=$(cat ../../per_gene/EOG091G0307/EOG091G0307.best_model | grep "Best" | cut -d ":" -f 2 | tr -d '[:space:]')
                if [ "$(ls -1 | grep "^RAxML" | wc -l)" -ne 0 ]
		then
			rm RAxML*
		fi
        	raxml -f a -T 2 -m PROTGAMMA$RAxMLmodel         	-p 12345 -x 12345 -# 100         	-s ../../per_gene/EOG091G0307/ALICUT_EOG091G0307.clustalo.fasta -n EOG091G0307.clustalo.aln.ALICUT.$RAxMLmodel 		1> ../../per_gene/EOG091G0307/infer_single_ML.stdout.txt 2> ../../per_gene/EOG091G0307/infer_single_ML.stderr.txt
	else
		echo "fasta file per_gene/EOG091G0307/ALICUT_EOG091G0307.clustalo.fasta contains fewer than 5 sequences - skipped" > ../../per_gene/EOG091G0307/infer_single_ML.stdout.txt
		touch raxml.skipped
	fi
        touch ../../per_gene/EOG091G0307/EOG091G0307.raxml.done
        
[33mJob counts:
	count	jobs
	1	infer_single_ML
	1[0m
[33m
        cd per_gene/EOG091G0307
	count=$(cat ../../per_gene/EOG091G0307/ALICUT_EOG091G0307.clustalo.fasta | grep ">" | wc -l)
	if [ "$count" -gt 5 ]
        then
		RAxMLmodel=$(cat ../../per_gene/EOG091G0307/EOG091G0307.best_model | grep "Best" | cut -d ":" -f 2 | tr -d '[:space:]')
                if [ "$(ls -1 | grep "^RAxML" | wc -l)" -ne 0 ]
		then
			rm RAxML*
		fi
        	raxml -f a -T 2 -m PROTGAMMA$RAxMLmodel         	-p 12345 -x 12345 -# 100         	-s ../../per_gene/EOG091G0307/ALICUT_EOG091G0307.clustalo.fasta -n EOG091G0307.clustalo.aln.ALICUT.$RAxMLmodel 		1> ../../per_gene/EOG091G0307/infer_single_ML.stdout.txt 2> ../../per_gene/EOG091G0307/infer_single_ML.stderr.txt
	else
		echo "fasta file per_gene/EOG091G0307/ALICUT_EOG091G0307.clustalo.fasta contains fewer than 5 sequences - skipped" > ../../per_gene/EOG091G0307/infer_single_ML.stdout.txt
		touch raxml.skipped
	fi
        touch ../../per_gene/EOG091G0307/EOG091G0307.raxml.done
        [0m
[Sun Jul  5 23:24:02 2020]
Finished job 76.
2049 of 3292 steps (62%) done

[Sun Jul  5 23:24:02 2020]
rule get_seqs:
    input: /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ingroup.txt, /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/outgroup.txt
    output: per_gene/EOG091G07EJ/EOG091G07EJ.ingroup.fasta
    log: per_gene/EOG091G07EJ/get_seqs.stdout.txt, per_gene/EOG091G07EJ/get_seqs.stderr.txt
    jobid: 3156
    wildcards: BUSCO=EOG091G07EJ
    threads: 2


	basedir=$(pwd)
        cd per_gene/EOG091G07EJ
        
        bash $basedir/../scripts/fetch_seqs.sh EOG091G07EJ /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ingroup.txt /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/outgroup.txt 1> ../../per_gene/EOG091G07EJ/get_seqs.stdout.txt 2> ../../per_gene/EOG091G07EJ/get_seqs.stderr.txt
	mv EOG091G07EJ.fasta $basedir/per_gene/EOG091G07EJ/EOG091G07EJ.ingroup.fasta
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/72476f9d9a5bd0627b4d721143a21354.simg
[Sun Jul  5 23:24:14 2020]
Finished job 3156.
2050 of 3292 steps (62%) done

[Sun Jul  5 23:24:14 2020]
rule get_outgroups:
    input: per_gene/EOG091G07EJ/EOG091G07EJ.ingroup.fasta
    output: per_gene/EOG091G07EJ/EOG091G07EJ.orthodb.fasta, per_gene/EOG091G07EJ/EOG091G07EJ.outgroup.fasta
    log: per_gene/EOG091G07EJ/get_outgroups.stdout.txt, per_gene/EOG091G07EJ/get_outgroups.stderr.txt
    jobid: 3157
    wildcards: BUSCO=EOG091G07EJ


        #download fastas from Orhtodb for BUSCO id
        for i in {1..5}
        do
             wget "http://www.orthodb.org/fasta?query=EOG091G07EJ&level=33208" -O per_gene/EOG091G07EJ/EOG091G07EJ.orthodb.fasta 1> per_gene/EOG091G07EJ/get_outgroups.stdout.txt 2> per_gene/EOG091G07EJ/get_outgroups.stderr.txt && break || echo -e "try again ($i)" && sleep 15
        done

	#This is quick an dirty for now and just takes the first protein if there is more than one for an outgroup taxon
        bash ../scripts/download_outgroups.sh taxids.txt per_gene/EOG091G07EJ/EOG091G07EJ.orthodb.fasta > per_gene/EOG091G07EJ/EOG091G07EJ.outgroup.fasta
        
[Sun Jul  5 23:24:14 2020]
Finished job 314.
2051 of 3292 steps (62%) done

[Sun Jul  5 23:24:14 2020]
rule get_seqs:
    input: /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ingroup.txt, /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/outgroup.txt
    output: per_gene/EOG091G03TX/EOG091G03TX.ingroup.fasta
    log: per_gene/EOG091G03TX/get_seqs.stdout.txt, per_gene/EOG091G03TX/get_seqs.stderr.txt
    jobid: 3126
    wildcards: BUSCO=EOG091G03TX
    threads: 2


	basedir=$(pwd)
        cd per_gene/EOG091G03TX
        
        bash $basedir/../scripts/fetch_seqs.sh EOG091G03TX /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ingroup.txt /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/outgroup.txt 1> ../../per_gene/EOG091G03TX/get_seqs.stdout.txt 2> ../../per_gene/EOG091G03TX/get_seqs.stderr.txt
	mv EOG091G03TX.fasta $basedir/per_gene/EOG091G03TX/EOG091G03TX.ingroup.fasta
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/72476f9d9a5bd0627b4d721143a21354.simg
[Sun Jul  5 23:24:15 2020]
Finished job 3157.
2052 of 3292 steps (62%) done

[Sun Jul  5 23:24:15 2020]
rule join_groups:
    input: per_gene/EOG091G07EJ/EOG091G07EJ.ingroup.fasta, per_gene/EOG091G07EJ/EOG091G07EJ.outgroup.fasta
    output: per_gene/EOG091G07EJ/EOG091G07EJ.fasta
    jobid: 2402
    wildcards: BUSCO=EOG091G07EJ


        cat per_gene/EOG091G07EJ/EOG091G07EJ.ingroup.fasta per_gene/EOG091G07EJ/EOG091G07EJ.outgroup.fasta > per_gene/EOG091G07EJ/EOG091G07EJ.fasta
        
[Sun Jul  5 23:24:15 2020]
Finished job 2402.
2053 of 3292 steps (62%) done

[Sun Jul  5 23:24:15 2020]
rule MSA:
    input: per_gene/EOG091G07EJ/EOG091G07EJ.fasta
    output: per_gene/EOG091G07EJ/EOG091G07EJ.clustalo.fasta
    log: per_gene/EOG091G07EJ/MSA.stdout.txt, per_gene/EOG091G07EJ/MSA.stderr.txt
    jobid: 1924
    wildcards: BUSCO=EOG091G07EJ
    threads: 2


        clustalo -i per_gene/EOG091G07EJ/EOG091G07EJ.fasta -o per_gene/EOG091G07EJ/EOG091G07EJ.clustalo.fasta --threads=2 1> per_gene/EOG091G07EJ/MSA.stdout.txt 2> per_gene/EOG091G07EJ/MSA.stderr.txt
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/d68c9691725a7401923680874285c430.simg
[Sun Jul  5 23:24:16 2020]
Finished job 1924.
2054 of 3292 steps (62%) done

[Sun Jul  5 23:24:16 2020]
rule score_and_cut:
    input: per_gene/EOG091G07EJ/EOG091G07EJ.clustalo.fasta
    output: per_gene/EOG091G07EJ/ALICUT_EOG091G07EJ.clustalo.fasta
    jobid: 1101
    wildcards: BUSCO=EOG091G07EJ
    threads: 2


        cd per_gene/EOG091G07EJ
        Aliscore.pl -N -r 200000000000000000 -i ../../per_gene/EOG091G07EJ/EOG091G07EJ.clustalo.fasta &> aliscore.log
        ALICUT.pl -s &> alicut.log
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/63c88c27a0fa300f57066b0ef65fefcb.simg
[Sun Jul  5 23:24:26 2020]
Finished job 1101.
2055 of 3292 steps (62%) done

[Sun Jul  5 23:24:26 2020]
rule remove_empty:
    input: per_gene/EOG091G07EJ/ALICUT_EOG091G07EJ.clustalo.fasta
    output: per_gene/EOG091G07EJ/empty_check.done
    jobid: 1923
    wildcards: BUSCO=EOG091G07EJ


         if [ "$(cat per_gene/EOG091G07EJ/ALICUT_EOG091G07EJ.clustalo.fasta | grep -v ">" | sed 's/-//g' | grep "^$" | wc -l)" -gt 0 ]
         then
              cp per_gene/EOG091G07EJ/ALICUT_EOG091G07EJ.clustalo.fasta per_gene/EOG091G07EJ/ALICUT_EOG091G07EJ.clustalo.fasta.backup
              bash ../scripts/remove_empty.sh per_gene/EOG091G07EJ/ALICUT_EOG091G07EJ.clustalo.fasta.backup > per_gene/EOG091G07EJ/ALICUT_EOG091G07EJ.clustalo.fasta
         fi
         touch per_gene/EOG091G07EJ/empty_check.done
         
[Sun Jul  5 23:24:26 2020]
Finished job 1923.
2056 of 3292 steps (62%) done

[Sun Jul  5 23:24:26 2020]
rule find_best_model:
    input: per_gene/EOG091G07EJ/ALICUT_EOG091G07EJ.clustalo.fasta, per_gene/EOG091G07EJ/empty_check.done
    output: per_gene/EOG091G07EJ/EOG091G07EJ.best_model
    log: per_gene/EOG091G07EJ/find_best_model.stderr.txt
    jobid: 1100
    wildcards: BUSCO=EOG091G07EJ
    threads: 2


        cd per_gene/EOG091G07EJ
        if [ ! -d find_best_model ]
        then
            mkdir find_best_model
        fi
        cd find_best_model
        ln -s ../../../per_gene/EOG091G07EJ/ALICUT_EOG091G07EJ.clustalo.fasta EOG091G07EJ.fasta
        ProteinModelSelection.pl EOG091G07EJ.fasta 1> ../../../per_gene/EOG091G07EJ/EOG091G07EJ.best_model 2> ../../../per_gene/EOG091G07EJ/find_best_model.stderr.txt
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/c0c09ee657b1e27f2c5687e0e9aa8d70.simg
[Sun Jul  5 23:24:27 2020]
Finished job 3126.
2057 of 3292 steps (62%) done

[Sun Jul  5 23:24:27 2020]
rule get_outgroups:
    input: per_gene/EOG091G03TX/EOG091G03TX.ingroup.fasta
    output: per_gene/EOG091G03TX/EOG091G03TX.orthodb.fasta, per_gene/EOG091G03TX/EOG091G03TX.outgroup.fasta
    log: per_gene/EOG091G03TX/get_outgroups.stdout.txt, per_gene/EOG091G03TX/get_outgroups.stderr.txt
    jobid: 3127
    wildcards: BUSCO=EOG091G03TX


        #download fastas from Orhtodb for BUSCO id
        for i in {1..5}
        do
             wget "http://www.orthodb.org/fasta?query=EOG091G03TX&level=33208" -O per_gene/EOG091G03TX/EOG091G03TX.orthodb.fasta 1> per_gene/EOG091G03TX/get_outgroups.stdout.txt 2> per_gene/EOG091G03TX/get_outgroups.stderr.txt && break || echo -e "try again ($i)" && sleep 15
        done

	#This is quick an dirty for now and just takes the first protein if there is more than one for an outgroup taxon
        bash ../scripts/download_outgroups.sh taxids.txt per_gene/EOG091G03TX/EOG091G03TX.orthodb.fasta > per_gene/EOG091G03TX/EOG091G03TX.outgroup.fasta
        
[Sun Jul  5 23:24:27 2020]
Finished job 3127.
2058 of 3292 steps (63%) done

[Sun Jul  5 23:24:27 2020]
rule join_groups:
    input: per_gene/EOG091G03TX/EOG091G03TX.ingroup.fasta, per_gene/EOG091G03TX/EOG091G03TX.outgroup.fasta
    output: per_gene/EOG091G03TX/EOG091G03TX.fasta
    jobid: 2387
    wildcards: BUSCO=EOG091G03TX


        cat per_gene/EOG091G03TX/EOG091G03TX.ingroup.fasta per_gene/EOG091G03TX/EOG091G03TX.outgroup.fasta > per_gene/EOG091G03TX/EOG091G03TX.fasta
        
[Sun Jul  5 23:24:27 2020]
Finished job 2387.
2059 of 3292 steps (63%) done

[Sun Jul  5 23:24:27 2020]
rule MSA:
    input: per_gene/EOG091G03TX/EOG091G03TX.fasta
    output: per_gene/EOG091G03TX/EOG091G03TX.clustalo.fasta
    log: per_gene/EOG091G03TX/MSA.stdout.txt, per_gene/EOG091G03TX/MSA.stderr.txt
    jobid: 1894
    wildcards: BUSCO=EOG091G03TX
    threads: 2


        clustalo -i per_gene/EOG091G03TX/EOG091G03TX.fasta -o per_gene/EOG091G03TX/EOG091G03TX.clustalo.fasta --threads=2 1> per_gene/EOG091G03TX/MSA.stdout.txt 2> per_gene/EOG091G03TX/MSA.stderr.txt
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/d68c9691725a7401923680874285c430.simg
[Sun Jul  5 23:24:31 2020]
Finished job 1894.
2060 of 3292 steps (63%) done

[Sun Jul  5 23:24:31 2020]
rule score_and_cut:
    input: per_gene/EOG091G03TX/EOG091G03TX.clustalo.fasta
    output: per_gene/EOG091G03TX/ALICUT_EOG091G03TX.clustalo.fasta
    jobid: 1071
    wildcards: BUSCO=EOG091G03TX
    threads: 2


        cd per_gene/EOG091G03TX
        Aliscore.pl -N -r 200000000000000000 -i ../../per_gene/EOG091G03TX/EOG091G03TX.clustalo.fasta &> aliscore.log
        ALICUT.pl -s &> alicut.log
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/63c88c27a0fa300f57066b0ef65fefcb.simg
[Sun Jul  5 23:24:37 2020]
Finished job 291.
2061 of 3292 steps (63%) done

[Sun Jul  5 23:24:37 2020]
rule get_seqs:
    input: /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ingroup.txt, /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/outgroup.txt
    output: per_gene/EOG091G0L84/EOG091G0L84.ingroup.fasta
    log: per_gene/EOG091G0L84/get_seqs.stdout.txt, per_gene/EOG091G0L84/get_seqs.stderr.txt
    jobid: 3278
    wildcards: BUSCO=EOG091G0L84
    threads: 2


	basedir=$(pwd)
        cd per_gene/EOG091G0L84
        
        bash $basedir/../scripts/fetch_seqs.sh EOG091G0L84 /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ingroup.txt /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/outgroup.txt 1> ../../per_gene/EOG091G0L84/get_seqs.stdout.txt 2> ../../per_gene/EOG091G0L84/get_seqs.stderr.txt
	mv EOG091G0L84.fasta $basedir/per_gene/EOG091G0L84/EOG091G0L84.ingroup.fasta
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/72476f9d9a5bd0627b4d721143a21354.simg
[Sun Jul  5 23:24:42 2020]
Finished job 1071.
2062 of 3292 steps (63%) done

[Sun Jul  5 23:24:42 2020]
rule remove_empty:
    input: per_gene/EOG091G03TX/ALICUT_EOG091G03TX.clustalo.fasta
    output: per_gene/EOG091G03TX/empty_check.done
    jobid: 1893
    wildcards: BUSCO=EOG091G03TX


         if [ "$(cat per_gene/EOG091G03TX/ALICUT_EOG091G03TX.clustalo.fasta | grep -v ">" | sed 's/-//g' | grep "^$" | wc -l)" -gt 0 ]
         then
              cp per_gene/EOG091G03TX/ALICUT_EOG091G03TX.clustalo.fasta per_gene/EOG091G03TX/ALICUT_EOG091G03TX.clustalo.fasta.backup
              bash ../scripts/remove_empty.sh per_gene/EOG091G03TX/ALICUT_EOG091G03TX.clustalo.fasta.backup > per_gene/EOG091G03TX/ALICUT_EOG091G03TX.clustalo.fasta
         fi
         touch per_gene/EOG091G03TX/empty_check.done
         
[Sun Jul  5 23:24:42 2020]
Finished job 1893.
2063 of 3292 steps (63%) done

[Sun Jul  5 23:24:42 2020]
rule find_best_model:
    input: per_gene/EOG091G03TX/ALICUT_EOG091G03TX.clustalo.fasta, per_gene/EOG091G03TX/empty_check.done
    output: per_gene/EOG091G03TX/EOG091G03TX.best_model
    log: per_gene/EOG091G03TX/find_best_model.stderr.txt
    jobid: 1070
    wildcards: BUSCO=EOG091G03TX
    threads: 2


        cd per_gene/EOG091G03TX
        if [ ! -d find_best_model ]
        then
            mkdir find_best_model
        fi
        cd find_best_model
        ln -s ../../../per_gene/EOG091G03TX/ALICUT_EOG091G03TX.clustalo.fasta EOG091G03TX.fasta
        ProteinModelSelection.pl EOG091G03TX.fasta 1> ../../../per_gene/EOG091G03TX/EOG091G03TX.best_model 2> ../../../per_gene/EOG091G03TX/find_best_model.stderr.txt
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/c0c09ee657b1e27f2c5687e0e9aa8d70.simg
[Sun Jul  5 23:24:48 2020]
Finished job 3278.
2064 of 3292 steps (63%) done

[Sun Jul  5 23:24:48 2020]
rule get_outgroups:
    input: per_gene/EOG091G0L84/EOG091G0L84.ingroup.fasta
    output: per_gene/EOG091G0L84/EOG091G0L84.orthodb.fasta, per_gene/EOG091G0L84/EOG091G0L84.outgroup.fasta
    log: per_gene/EOG091G0L84/get_outgroups.stdout.txt, per_gene/EOG091G0L84/get_outgroups.stderr.txt
    jobid: 3279
    wildcards: BUSCO=EOG091G0L84


        #download fastas from Orhtodb for BUSCO id
        for i in {1..5}
        do
             wget "http://www.orthodb.org/fasta?query=EOG091G0L84&level=33208" -O per_gene/EOG091G0L84/EOG091G0L84.orthodb.fasta 1> per_gene/EOG091G0L84/get_outgroups.stdout.txt 2> per_gene/EOG091G0L84/get_outgroups.stderr.txt && break || echo -e "try again ($i)" && sleep 15
        done

	#This is quick an dirty for now and just takes the first protein if there is more than one for an outgroup taxon
        bash ../scripts/download_outgroups.sh taxids.txt per_gene/EOG091G0L84/EOG091G0L84.orthodb.fasta > per_gene/EOG091G0L84/EOG091G0L84.outgroup.fasta
        
[Sun Jul  5 23:24:49 2020]
Finished job 3279.
2065 of 3292 steps (63%) done

[Sun Jul  5 23:24:49 2020]
rule join_groups:
    input: per_gene/EOG091G0L84/EOG091G0L84.ingroup.fasta, per_gene/EOG091G0L84/EOG091G0L84.outgroup.fasta
    output: per_gene/EOG091G0L84/EOG091G0L84.fasta
    jobid: 2463
    wildcards: BUSCO=EOG091G0L84


        cat per_gene/EOG091G0L84/EOG091G0L84.ingroup.fasta per_gene/EOG091G0L84/EOG091G0L84.outgroup.fasta > per_gene/EOG091G0L84/EOG091G0L84.fasta
        
[Sun Jul  5 23:24:49 2020]
Finished job 2463.
2066 of 3292 steps (63%) done

[Sun Jul  5 23:24:49 2020]
rule MSA:
    input: per_gene/EOG091G0L84/EOG091G0L84.fasta
    output: per_gene/EOG091G0L84/EOG091G0L84.clustalo.fasta
    log: per_gene/EOG091G0L84/MSA.stdout.txt, per_gene/EOG091G0L84/MSA.stderr.txt
    jobid: 2046
    wildcards: BUSCO=EOG091G0L84
    threads: 2


        clustalo -i per_gene/EOG091G0L84/EOG091G0L84.fasta -o per_gene/EOG091G0L84/EOG091G0L84.clustalo.fasta --threads=2 1> per_gene/EOG091G0L84/MSA.stdout.txt 2> per_gene/EOG091G0L84/MSA.stderr.txt
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/d68c9691725a7401923680874285c430.simg
[Sun Jul  5 23:24:50 2020]
Finished job 2046.
2067 of 3292 steps (63%) done

[Sun Jul  5 23:24:50 2020]
rule score_and_cut:
    input: per_gene/EOG091G0L84/EOG091G0L84.clustalo.fasta
    output: per_gene/EOG091G0L84/ALICUT_EOG091G0L84.clustalo.fasta
    jobid: 1223
    wildcards: BUSCO=EOG091G0L84
    threads: 2


        cd per_gene/EOG091G0L84
        Aliscore.pl -N -r 200000000000000000 -i ../../per_gene/EOG091G0L84/EOG091G0L84.clustalo.fasta &> aliscore.log
        ALICUT.pl -s &> alicut.log
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/63c88c27a0fa300f57066b0ef65fefcb.simg
[Sun Jul  5 23:25:00 2020]
Finished job 1223.
2068 of 3292 steps (63%) done

[Sun Jul  5 23:25:00 2020]
rule remove_empty:
    input: per_gene/EOG091G0L84/ALICUT_EOG091G0L84.clustalo.fasta
    output: per_gene/EOG091G0L84/empty_check.done
    jobid: 2045
    wildcards: BUSCO=EOG091G0L84


         if [ "$(cat per_gene/EOG091G0L84/ALICUT_EOG091G0L84.clustalo.fasta | grep -v ">" | sed 's/-//g' | grep "^$" | wc -l)" -gt 0 ]
         then
              cp per_gene/EOG091G0L84/ALICUT_EOG091G0L84.clustalo.fasta per_gene/EOG091G0L84/ALICUT_EOG091G0L84.clustalo.fasta.backup
              bash ../scripts/remove_empty.sh per_gene/EOG091G0L84/ALICUT_EOG091G0L84.clustalo.fasta.backup > per_gene/EOG091G0L84/ALICUT_EOG091G0L84.clustalo.fasta
         fi
         touch per_gene/EOG091G0L84/empty_check.done
         
[Sun Jul  5 23:25:00 2020]
Finished job 2045.
2069 of 3292 steps (63%) done

[Sun Jul  5 23:25:00 2020]
rule find_best_model:
    input: per_gene/EOG091G0L84/ALICUT_EOG091G0L84.clustalo.fasta, per_gene/EOG091G0L84/empty_check.done
    output: per_gene/EOG091G0L84/EOG091G0L84.best_model
    log: per_gene/EOG091G0L84/find_best_model.stderr.txt
    jobid: 1222
    wildcards: BUSCO=EOG091G0L84
    threads: 2


        cd per_gene/EOG091G0L84
        if [ ! -d find_best_model ]
        then
            mkdir find_best_model
        fi
        cd find_best_model
        ln -s ../../../per_gene/EOG091G0L84/ALICUT_EOG091G0L84.clustalo.fasta EOG091G0L84.fasta
        ProteinModelSelection.pl EOG091G0L84.fasta 1> ../../../per_gene/EOG091G0L84/EOG091G0L84.best_model 2> ../../../per_gene/EOG091G0L84/find_best_model.stderr.txt
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/c0c09ee657b1e27f2c5687e0e9aa8d70.simg
[Sun Jul  5 23:25:02 2020]
Finished job 1100.
2070 of 3292 steps (63%) done

[Sun Jul  5 23:25:02 2020]
rule infer_single_ML:
    input: per_gene/EOG091G07EJ/EOG091G07EJ.best_model, per_gene/EOG091G07EJ/ALICUT_EOG091G07EJ.clustalo.fasta
    output: per_gene/EOG091G07EJ/EOG091G07EJ.raxml.done
    log: per_gene/EOG091G07EJ/infer_single_ML.stdout.txt, per_gene/EOG091G07EJ/infer_single_ML.stderr.txt
    jobid: 344
    wildcards: BUSCO=EOG091G07EJ
    threads: 2


        cd per_gene/EOG091G07EJ
	count=$(cat ../../per_gene/EOG091G07EJ/ALICUT_EOG091G07EJ.clustalo.fasta | grep ">" | wc -l)
	if [ "$count" -gt 5 ]
        then
		RAxMLmodel=$(cat ../../per_gene/EOG091G07EJ/EOG091G07EJ.best_model | grep "Best" | cut -d ":" -f 2 | tr -d '[:space:]')
                if [ "$(ls -1 | grep "^RAxML" | wc -l)" -ne 0 ]
		then
			rm RAxML*
		fi
        	raxml -f a -T 2 -m PROTGAMMA$RAxMLmodel         	-p 12345 -x 12345 -# 100         	-s ../../per_gene/EOG091G07EJ/ALICUT_EOG091G07EJ.clustalo.fasta -n EOG091G07EJ.clustalo.aln.ALICUT.$RAxMLmodel 		1> ../../per_gene/EOG091G07EJ/infer_single_ML.stdout.txt 2> ../../per_gene/EOG091G07EJ/infer_single_ML.stderr.txt
	else
		echo "fasta file per_gene/EOG091G07EJ/ALICUT_EOG091G07EJ.clustalo.fasta contains fewer than 5 sequences - skipped" > ../../per_gene/EOG091G07EJ/infer_single_ML.stdout.txt
		touch raxml.skipped
	fi
        touch ../../per_gene/EOG091G07EJ/EOG091G07EJ.raxml.done
        
[Sun Jul  5 23:25:23 2020]
Finished job 1070.
2071 of 3292 steps (63%) done

[Sun Jul  5 23:25:23 2020]
rule infer_single_ML:
    input: per_gene/EOG091G03TX/EOG091G03TX.best_model, per_gene/EOG091G03TX/ALICUT_EOG091G03TX.clustalo.fasta
    output: per_gene/EOG091G03TX/EOG091G03TX.raxml.done
    log: per_gene/EOG091G03TX/infer_single_ML.stdout.txt, per_gene/EOG091G03TX/infer_single_ML.stderr.txt
    jobid: 329
    wildcards: BUSCO=EOG091G03TX
    threads: 2


        cd per_gene/EOG091G03TX
	count=$(cat ../../per_gene/EOG091G03TX/ALICUT_EOG091G03TX.clustalo.fasta | grep ">" | wc -l)
	if [ "$count" -gt 5 ]
        then
		RAxMLmodel=$(cat ../../per_gene/EOG091G03TX/EOG091G03TX.best_model | grep "Best" | cut -d ":" -f 2 | tr -d '[:space:]')
                if [ "$(ls -1 | grep "^RAxML" | wc -l)" -ne 0 ]
		then
			rm RAxML*
		fi
        	raxml -f a -T 2 -m PROTGAMMA$RAxMLmodel         	-p 12345 -x 12345 -# 100         	-s ../../per_gene/EOG091G03TX/ALICUT_EOG091G03TX.clustalo.fasta -n EOG091G03TX.clustalo.aln.ALICUT.$RAxMLmodel 		1> ../../per_gene/EOG091G03TX/infer_single_ML.stdout.txt 2> ../../per_gene/EOG091G03TX/infer_single_ML.stderr.txt
	else
		echo "fasta file per_gene/EOG091G03TX/ALICUT_EOG091G03TX.clustalo.fasta contains fewer than 5 sequences - skipped" > ../../per_gene/EOG091G03TX/infer_single_ML.stdout.txt
		touch raxml.skipped
	fi
        touch ../../per_gene/EOG091G03TX/EOG091G03TX.raxml.done
        
[Sun Jul  5 23:25:26 2020]
Finished job 1222.
2072 of 3292 steps (63%) done

[Sun Jul  5 23:25:26 2020]
rule infer_single_ML:
    input: per_gene/EOG091G0L84/EOG091G0L84.best_model, per_gene/EOG091G0L84/ALICUT_EOG091G0L84.clustalo.fasta
    output: per_gene/EOG091G0L84/EOG091G0L84.raxml.done
    log: per_gene/EOG091G0L84/infer_single_ML.stdout.txt, per_gene/EOG091G0L84/infer_single_ML.stderr.txt
    jobid: 405
    wildcards: BUSCO=EOG091G0L84
    threads: 2


        cd per_gene/EOG091G0L84
	count=$(cat ../../per_gene/EOG091G0L84/ALICUT_EOG091G0L84.clustalo.fasta | grep ">" | wc -l)
	if [ "$count" -gt 5 ]
        then
		RAxMLmodel=$(cat ../../per_gene/EOG091G0L84/EOG091G0L84.best_model | grep "Best" | cut -d ":" -f 2 | tr -d '[:space:]')
                if [ "$(ls -1 | grep "^RAxML" | wc -l)" -ne 0 ]
		then
			rm RAxML*
		fi
        	raxml -f a -T 2 -m PROTGAMMA$RAxMLmodel         	-p 12345 -x 12345 -# 100         	-s ../../per_gene/EOG091G0L84/ALICUT_EOG091G0L84.clustalo.fasta -n EOG091G0L84.clustalo.aln.ALICUT.$RAxMLmodel 		1> ../../per_gene/EOG091G0L84/infer_single_ML.stdout.txt 2> ../../per_gene/EOG091G0L84/infer_single_ML.stderr.txt
	else
		echo "fasta file per_gene/EOG091G0L84/ALICUT_EOG091G0L84.clustalo.fasta contains fewer than 5 sequences - skipped" > ../../per_gene/EOG091G0L84/infer_single_ML.stdout.txt
		touch raxml.skipped
	fi
        touch ../../per_gene/EOG091G0L84/EOG091G0L84.raxml.done
        
[33mJob counts:
	count	jobs
	1	infer_single_ML
	1[0m
[33m
        cd per_gene/EOG091G0L84
	count=$(cat ../../per_gene/EOG091G0L84/ALICUT_EOG091G0L84.clustalo.fasta | grep ">" | wc -l)
	if [ "$count" -gt 5 ]
        then
		RAxMLmodel=$(cat ../../per_gene/EOG091G0L84/EOG091G0L84.best_model | grep "Best" | cut -d ":" -f 2 | tr -d '[:space:]')
                if [ "$(ls -1 | grep "^RAxML" | wc -l)" -ne 0 ]
		then
			rm RAxML*
		fi
        	raxml -f a -T 2 -m PROTGAMMA$RAxMLmodel         	-p 12345 -x 12345 -# 100         	-s ../../per_gene/EOG091G0L84/ALICUT_EOG091G0L84.clustalo.fasta -n EOG091G0L84.clustalo.aln.ALICUT.$RAxMLmodel 		1> ../../per_gene/EOG091G0L84/infer_single_ML.stdout.txt 2> ../../per_gene/EOG091G0L84/infer_single_ML.stderr.txt
	else
		echo "fasta file per_gene/EOG091G0L84/ALICUT_EOG091G0L84.clustalo.fasta contains fewer than 5 sequences - skipped" > ../../per_gene/EOG091G0L84/infer_single_ML.stdout.txt
		touch raxml.skipped
	fi
        touch ../../per_gene/EOG091G0L84/EOG091G0L84.raxml.done
        [0m
[33mJob counts:
	count	jobs
	1	infer_single_ML
	1[0m
[33mJob counts:
	count	jobs
	1	infer_single_ML
	1[0m
[33m
        cd per_gene/EOG091G03TX
	count=$(cat ../../per_gene/EOG091G03TX/ALICUT_EOG091G03TX.clustalo.fasta | grep ">" | wc -l)
	if [ "$count" -gt 5 ]
        then
		RAxMLmodel=$(cat ../../per_gene/EOG091G03TX/EOG091G03TX.best_model | grep "Best" | cut -d ":" -f 2 | tr -d '[:space:]')
                if [ "$(ls -1 | grep "^RAxML" | wc -l)" -ne 0 ]
		then
			rm RAxML*
		fi
        	raxml -f a -T 2 -m PROTGAMMA$RAxMLmodel         	-p 12345 -x 12345 -# 100         	-s ../../per_gene/EOG091G03TX/ALICUT_EOG091G03TX.clustalo.fasta -n EOG091G03TX.clustalo.aln.ALICUT.$RAxMLmodel 		1> ../../per_gene/EOG091G03TX/infer_single_ML.stdout.txt 2> ../../per_gene/EOG091G03TX/infer_single_ML.stderr.txt
	else
		echo "fasta file per_gene/EOG091G03TX/ALICUT_EOG091G03TX.clustalo.fasta contains fewer than 5 sequences - skipped" > ../../per_gene/EOG091G03TX/infer_single_ML.stdout.txt
		touch raxml.skipped
	fi
        touch ../../per_gene/EOG091G03TX/EOG091G03TX.raxml.done
        [0m
[33m
        cd per_gene/EOG091G07EJ
	count=$(cat ../../per_gene/EOG091G07EJ/ALICUT_EOG091G07EJ.clustalo.fasta | grep ">" | wc -l)
	if [ "$count" -gt 5 ]
        then
		RAxMLmodel=$(cat ../../per_gene/EOG091G07EJ/EOG091G07EJ.best_model | grep "Best" | cut -d ":" -f 2 | tr -d '[:space:]')
                if [ "$(ls -1 | grep "^RAxML" | wc -l)" -ne 0 ]
		then
			rm RAxML*
		fi
        	raxml -f a -T 2 -m PROTGAMMA$RAxMLmodel         	-p 12345 -x 12345 -# 100         	-s ../../per_gene/EOG091G07EJ/ALICUT_EOG091G07EJ.clustalo.fasta -n EOG091G07EJ.clustalo.aln.ALICUT.$RAxMLmodel 		1> ../../per_gene/EOG091G07EJ/infer_single_ML.stdout.txt 2> ../../per_gene/EOG091G07EJ/infer_single_ML.stderr.txt
	else
		echo "fasta file per_gene/EOG091G07EJ/ALICUT_EOG091G07EJ.clustalo.fasta contains fewer than 5 sequences - skipped" > ../../per_gene/EOG091G07EJ/infer_single_ML.stdout.txt
		touch raxml.skipped
	fi
        touch ../../per_gene/EOG091G07EJ/EOG091G07EJ.raxml.done
        [0m
[Sun Jul  5 23:25:37 2020]
Finished job 227.
2073 of 3292 steps (63%) done

[Sun Jul  5 23:25:37 2020]
rule get_seqs:
    input: /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ingroup.txt, /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/outgroup.txt
    output: per_gene/EOG091G0530/EOG091G0530.ingroup.fasta
    log: per_gene/EOG091G0530/get_seqs.stdout.txt, per_gene/EOG091G0530/get_seqs.stderr.txt
    jobid: 2528
    wildcards: BUSCO=EOG091G0530
    threads: 2


	basedir=$(pwd)
        cd per_gene/EOG091G0530
        
        bash $basedir/../scripts/fetch_seqs.sh EOG091G0530 /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ingroup.txt /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/outgroup.txt 1> ../../per_gene/EOG091G0530/get_seqs.stdout.txt 2> ../../per_gene/EOG091G0530/get_seqs.stderr.txt
	mv EOG091G0530.fasta $basedir/per_gene/EOG091G0530/EOG091G0530.ingroup.fasta
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/72476f9d9a5bd0627b4d721143a21354.simg
[Sun Jul  5 23:25:48 2020]
Finished job 323.
2074 of 3292 steps (63%) done

[Sun Jul  5 23:25:48 2020]
rule get_seqs:
    input: /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ingroup.txt, /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/outgroup.txt
    output: per_gene/EOG091G0NQW/EOG091G0NQW.ingroup.fasta
    log: per_gene/EOG091G0NQW/get_seqs.stdout.txt, per_gene/EOG091G0NQW/get_seqs.stderr.txt
    jobid: 3100
    wildcards: BUSCO=EOG091G0NQW
    threads: 2


	basedir=$(pwd)
        cd per_gene/EOG091G0NQW
        
        bash $basedir/../scripts/fetch_seqs.sh EOG091G0NQW /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ingroup.txt /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/outgroup.txt 1> ../../per_gene/EOG091G0NQW/get_seqs.stdout.txt 2> ../../per_gene/EOG091G0NQW/get_seqs.stderr.txt
	mv EOG091G0NQW.fasta $basedir/per_gene/EOG091G0NQW/EOG091G0NQW.ingroup.fasta
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/72476f9d9a5bd0627b4d721143a21354.simg
[Sun Jul  5 23:25:50 2020]
Finished job 2528.
2075 of 3292 steps (63%) done

[Sun Jul  5 23:25:50 2020]
rule get_outgroups:
    input: per_gene/EOG091G0530/EOG091G0530.ingroup.fasta
    output: per_gene/EOG091G0530/EOG091G0530.orthodb.fasta, per_gene/EOG091G0530/EOG091G0530.outgroup.fasta
    log: per_gene/EOG091G0530/get_outgroups.stdout.txt, per_gene/EOG091G0530/get_outgroups.stderr.txt
    jobid: 2529
    wildcards: BUSCO=EOG091G0530


        #download fastas from Orhtodb for BUSCO id
        for i in {1..5}
        do
             wget "http://www.orthodb.org/fasta?query=EOG091G0530&level=33208" -O per_gene/EOG091G0530/EOG091G0530.orthodb.fasta 1> per_gene/EOG091G0530/get_outgroups.stdout.txt 2> per_gene/EOG091G0530/get_outgroups.stderr.txt && break || echo -e "try again ($i)" && sleep 15
        done

	#This is quick an dirty for now and just takes the first protein if there is more than one for an outgroup taxon
        bash ../scripts/download_outgroups.sh taxids.txt per_gene/EOG091G0530/EOG091G0530.orthodb.fasta > per_gene/EOG091G0530/EOG091G0530.outgroup.fasta
        
[Sun Jul  5 23:25:51 2020]
Finished job 2529.
2076 of 3292 steps (63%) done

[Sun Jul  5 23:25:51 2020]
rule join_groups:
    input: per_gene/EOG091G0530/EOG091G0530.ingroup.fasta, per_gene/EOG091G0530/EOG091G0530.outgroup.fasta
    output: per_gene/EOG091G0530/EOG091G0530.fasta
    jobid: 2088
    wildcards: BUSCO=EOG091G0530


        cat per_gene/EOG091G0530/EOG091G0530.ingroup.fasta per_gene/EOG091G0530/EOG091G0530.outgroup.fasta > per_gene/EOG091G0530/EOG091G0530.fasta
        
[Sun Jul  5 23:25:51 2020]
Finished job 2088.
2077 of 3292 steps (63%) done

[Sun Jul  5 23:25:51 2020]
rule MSA:
    input: per_gene/EOG091G0530/EOG091G0530.fasta
    output: per_gene/EOG091G0530/EOG091G0530.clustalo.fasta
    log: per_gene/EOG091G0530/MSA.stdout.txt, per_gene/EOG091G0530/MSA.stderr.txt
    jobid: 1296
    wildcards: BUSCO=EOG091G0530
    threads: 2


        clustalo -i per_gene/EOG091G0530/EOG091G0530.fasta -o per_gene/EOG091G0530/EOG091G0530.clustalo.fasta --threads=2 1> per_gene/EOG091G0530/MSA.stdout.txt 2> per_gene/EOG091G0530/MSA.stderr.txt
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/d68c9691725a7401923680874285c430.simg
[Sun Jul  5 23:25:54 2020]
Finished job 1296.
2078 of 3292 steps (63%) done

[Sun Jul  5 23:25:54 2020]
rule score_and_cut:
    input: per_gene/EOG091G0530/EOG091G0530.clustalo.fasta
    output: per_gene/EOG091G0530/ALICUT_EOG091G0530.clustalo.fasta
    jobid: 473
    wildcards: BUSCO=EOG091G0530
    threads: 2


        cd per_gene/EOG091G0530
        Aliscore.pl -N -r 200000000000000000 -i ../../per_gene/EOG091G0530/EOG091G0530.clustalo.fasta &> aliscore.log
        ALICUT.pl -s &> alicut.log
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/63c88c27a0fa300f57066b0ef65fefcb.simg
[Sun Jul  5 23:25:54 2020]
Finished job 104.
2079 of 3292 steps (63%) done

[Sun Jul  5 23:25:54 2020]
rule get_seqs:
    input: /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ingroup.txt, /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/outgroup.txt
    output: per_gene/EOG091G09U9/EOG091G09U9.ingroup.fasta
    log: per_gene/EOG091G09U9/get_seqs.stdout.txt, per_gene/EOG091G09U9/get_seqs.stderr.txt
    jobid: 3166
    wildcards: BUSCO=EOG091G09U9
    threads: 2


	basedir=$(pwd)
        cd per_gene/EOG091G09U9
        
        bash $basedir/../scripts/fetch_seqs.sh EOG091G09U9 /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ingroup.txt /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/outgroup.txt 1> ../../per_gene/EOG091G09U9/get_seqs.stdout.txt 2> ../../per_gene/EOG091G09U9/get_seqs.stderr.txt
	mv EOG091G09U9.fasta $basedir/per_gene/EOG091G09U9/EOG091G09U9.ingroup.fasta
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/72476f9d9a5bd0627b4d721143a21354.simg
[Sun Jul  5 23:26:00 2020]
Finished job 3100.
2080 of 3292 steps (63%) done

[Sun Jul  5 23:26:00 2020]
rule get_outgroups:
    input: per_gene/EOG091G0NQW/EOG091G0NQW.ingroup.fasta
    output: per_gene/EOG091G0NQW/EOG091G0NQW.orthodb.fasta, per_gene/EOG091G0NQW/EOG091G0NQW.outgroup.fasta
    log: per_gene/EOG091G0NQW/get_outgroups.stdout.txt, per_gene/EOG091G0NQW/get_outgroups.stderr.txt
    jobid: 3101
    wildcards: BUSCO=EOG091G0NQW


        #download fastas from Orhtodb for BUSCO id
        for i in {1..5}
        do
             wget "http://www.orthodb.org/fasta?query=EOG091G0NQW&level=33208" -O per_gene/EOG091G0NQW/EOG091G0NQW.orthodb.fasta 1> per_gene/EOG091G0NQW/get_outgroups.stdout.txt 2> per_gene/EOG091G0NQW/get_outgroups.stderr.txt && break || echo -e "try again ($i)" && sleep 15
        done

	#This is quick an dirty for now and just takes the first protein if there is more than one for an outgroup taxon
        bash ../scripts/download_outgroups.sh taxids.txt per_gene/EOG091G0NQW/EOG091G0NQW.orthodb.fasta > per_gene/EOG091G0NQW/EOG091G0NQW.outgroup.fasta
        
[Sun Jul  5 23:26:00 2020]
Finished job 3101.
2081 of 3292 steps (63%) done

[Sun Jul  5 23:26:00 2020]
rule join_groups:
    input: per_gene/EOG091G0NQW/EOG091G0NQW.ingroup.fasta, per_gene/EOG091G0NQW/EOG091G0NQW.outgroup.fasta
    output: per_gene/EOG091G0NQW/EOG091G0NQW.fasta
    jobid: 2374
    wildcards: BUSCO=EOG091G0NQW


        cat per_gene/EOG091G0NQW/EOG091G0NQW.ingroup.fasta per_gene/EOG091G0NQW/EOG091G0NQW.outgroup.fasta > per_gene/EOG091G0NQW/EOG091G0NQW.fasta
        
[Sun Jul  5 23:26:00 2020]
Finished job 2374.
2082 of 3292 steps (63%) done

[Sun Jul  5 23:26:00 2020]
rule MSA:
    input: per_gene/EOG091G0NQW/EOG091G0NQW.fasta
    output: per_gene/EOG091G0NQW/EOG091G0NQW.clustalo.fasta
    log: per_gene/EOG091G0NQW/MSA.stdout.txt, per_gene/EOG091G0NQW/MSA.stderr.txt
    jobid: 1868
    wildcards: BUSCO=EOG091G0NQW
    threads: 2


        clustalo -i per_gene/EOG091G0NQW/EOG091G0NQW.fasta -o per_gene/EOG091G0NQW/EOG091G0NQW.clustalo.fasta --threads=2 1> per_gene/EOG091G0NQW/MSA.stdout.txt 2> per_gene/EOG091G0NQW/MSA.stderr.txt
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/d68c9691725a7401923680874285c430.simg
[Sun Jul  5 23:26:02 2020]
Finished job 1868.
2083 of 3292 steps (63%) done

[Sun Jul  5 23:26:02 2020]
rule score_and_cut:
    input: per_gene/EOG091G0NQW/EOG091G0NQW.clustalo.fasta
    output: per_gene/EOG091G0NQW/ALICUT_EOG091G0NQW.clustalo.fasta
    jobid: 1045
    wildcards: BUSCO=EOG091G0NQW
    threads: 2


        cd per_gene/EOG091G0NQW
        Aliscore.pl -N -r 200000000000000000 -i ../../per_gene/EOG091G0NQW/EOG091G0NQW.clustalo.fasta &> aliscore.log
        ALICUT.pl -s &> alicut.log
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/63c88c27a0fa300f57066b0ef65fefcb.simg
[Sun Jul  5 23:26:05 2020]
Finished job 473.
2084 of 3292 steps (63%) done

[Sun Jul  5 23:26:05 2020]
rule remove_empty:
    input: per_gene/EOG091G0530/ALICUT_EOG091G0530.clustalo.fasta
    output: per_gene/EOG091G0530/empty_check.done
    jobid: 1295
    wildcards: BUSCO=EOG091G0530


         if [ "$(cat per_gene/EOG091G0530/ALICUT_EOG091G0530.clustalo.fasta | grep -v ">" | sed 's/-//g' | grep "^$" | wc -l)" -gt 0 ]
         then
              cp per_gene/EOG091G0530/ALICUT_EOG091G0530.clustalo.fasta per_gene/EOG091G0530/ALICUT_EOG091G0530.clustalo.fasta.backup
              bash ../scripts/remove_empty.sh per_gene/EOG091G0530/ALICUT_EOG091G0530.clustalo.fasta.backup > per_gene/EOG091G0530/ALICUT_EOG091G0530.clustalo.fasta
         fi
         touch per_gene/EOG091G0530/empty_check.done
         
[Sun Jul  5 23:26:05 2020]
Finished job 1295.
2085 of 3292 steps (63%) done

[Sun Jul  5 23:26:05 2020]
rule find_best_model:
    input: per_gene/EOG091G0530/ALICUT_EOG091G0530.clustalo.fasta, per_gene/EOG091G0530/empty_check.done
    output: per_gene/EOG091G0530/EOG091G0530.best_model
    log: per_gene/EOG091G0530/find_best_model.stderr.txt
    jobid: 472
    wildcards: BUSCO=EOG091G0530
    threads: 2


        cd per_gene/EOG091G0530
        if [ ! -d find_best_model ]
        then
            mkdir find_best_model
        fi
        cd find_best_model
        ln -s ../../../per_gene/EOG091G0530/ALICUT_EOG091G0530.clustalo.fasta EOG091G0530.fasta
        ProteinModelSelection.pl EOG091G0530.fasta 1> ../../../per_gene/EOG091G0530/EOG091G0530.best_model 2> ../../../per_gene/EOG091G0530/find_best_model.stderr.txt
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/c0c09ee657b1e27f2c5687e0e9aa8d70.simg
[Sun Jul  5 23:26:06 2020]
Finished job 3166.
2086 of 3292 steps (63%) done

[Sun Jul  5 23:26:06 2020]
rule get_outgroups:
    input: per_gene/EOG091G09U9/EOG091G09U9.ingroup.fasta
    output: per_gene/EOG091G09U9/EOG091G09U9.orthodb.fasta, per_gene/EOG091G09U9/EOG091G09U9.outgroup.fasta
    log: per_gene/EOG091G09U9/get_outgroups.stdout.txt, per_gene/EOG091G09U9/get_outgroups.stderr.txt
    jobid: 3167
    wildcards: BUSCO=EOG091G09U9


        #download fastas from Orhtodb for BUSCO id
        for i in {1..5}
        do
             wget "http://www.orthodb.org/fasta?query=EOG091G09U9&level=33208" -O per_gene/EOG091G09U9/EOG091G09U9.orthodb.fasta 1> per_gene/EOG091G09U9/get_outgroups.stdout.txt 2> per_gene/EOG091G09U9/get_outgroups.stderr.txt && break || echo -e "try again ($i)" && sleep 15
        done

	#This is quick an dirty for now and just takes the first protein if there is more than one for an outgroup taxon
        bash ../scripts/download_outgroups.sh taxids.txt per_gene/EOG091G09U9/EOG091G09U9.orthodb.fasta > per_gene/EOG091G09U9/EOG091G09U9.outgroup.fasta
        
[Sun Jul  5 23:26:06 2020]
Finished job 3167.
2087 of 3292 steps (63%) done

[Sun Jul  5 23:26:06 2020]
rule join_groups:
    input: per_gene/EOG091G09U9/EOG091G09U9.ingroup.fasta, per_gene/EOG091G09U9/EOG091G09U9.outgroup.fasta
    output: per_gene/EOG091G09U9/EOG091G09U9.fasta
    jobid: 2407
    wildcards: BUSCO=EOG091G09U9


        cat per_gene/EOG091G09U9/EOG091G09U9.ingroup.fasta per_gene/EOG091G09U9/EOG091G09U9.outgroup.fasta > per_gene/EOG091G09U9/EOG091G09U9.fasta
        
[Sun Jul  5 23:26:06 2020]
Finished job 2407.
2088 of 3292 steps (63%) done

[Sun Jul  5 23:26:06 2020]
rule MSA:
    input: per_gene/EOG091G09U9/EOG091G09U9.fasta
    output: per_gene/EOG091G09U9/EOG091G09U9.clustalo.fasta
    log: per_gene/EOG091G09U9/MSA.stdout.txt, per_gene/EOG091G09U9/MSA.stderr.txt
    jobid: 1934
    wildcards: BUSCO=EOG091G09U9
    threads: 2


        clustalo -i per_gene/EOG091G09U9/EOG091G09U9.fasta -o per_gene/EOG091G09U9/EOG091G09U9.clustalo.fasta --threads=2 1> per_gene/EOG091G09U9/MSA.stdout.txt 2> per_gene/EOG091G09U9/MSA.stderr.txt
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/d68c9691725a7401923680874285c430.simg
[Sun Jul  5 23:26:08 2020]
Finished job 1934.
2089 of 3292 steps (63%) done

[Sun Jul  5 23:26:08 2020]
rule score_and_cut:
    input: per_gene/EOG091G09U9/EOG091G09U9.clustalo.fasta
    output: per_gene/EOG091G09U9/ALICUT_EOG091G09U9.clustalo.fasta
    jobid: 1111
    wildcards: BUSCO=EOG091G09U9
    threads: 2


        cd per_gene/EOG091G09U9
        Aliscore.pl -N -r 200000000000000000 -i ../../per_gene/EOG091G09U9/EOG091G09U9.clustalo.fasta &> aliscore.log
        ALICUT.pl -s &> alicut.log
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/63c88c27a0fa300f57066b0ef65fefcb.simg
[Sun Jul  5 23:26:13 2020]
Finished job 1045.
2090 of 3292 steps (63%) done

[Sun Jul  5 23:26:13 2020]
rule remove_empty:
    input: per_gene/EOG091G0NQW/ALICUT_EOG091G0NQW.clustalo.fasta
    output: per_gene/EOG091G0NQW/empty_check.done
    jobid: 1867
    wildcards: BUSCO=EOG091G0NQW


         if [ "$(cat per_gene/EOG091G0NQW/ALICUT_EOG091G0NQW.clustalo.fasta | grep -v ">" | sed 's/-//g' | grep "^$" | wc -l)" -gt 0 ]
         then
              cp per_gene/EOG091G0NQW/ALICUT_EOG091G0NQW.clustalo.fasta per_gene/EOG091G0NQW/ALICUT_EOG091G0NQW.clustalo.fasta.backup
              bash ../scripts/remove_empty.sh per_gene/EOG091G0NQW/ALICUT_EOG091G0NQW.clustalo.fasta.backup > per_gene/EOG091G0NQW/ALICUT_EOG091G0NQW.clustalo.fasta
         fi
         touch per_gene/EOG091G0NQW/empty_check.done
         
[Sun Jul  5 23:26:13 2020]
Finished job 1867.
2091 of 3292 steps (64%) done

[Sun Jul  5 23:26:13 2020]
rule find_best_model:
    input: per_gene/EOG091G0NQW/ALICUT_EOG091G0NQW.clustalo.fasta, per_gene/EOG091G0NQW/empty_check.done
    output: per_gene/EOG091G0NQW/EOG091G0NQW.best_model
    log: per_gene/EOG091G0NQW/find_best_model.stderr.txt
    jobid: 1044
    wildcards: BUSCO=EOG091G0NQW
    threads: 2


        cd per_gene/EOG091G0NQW
        if [ ! -d find_best_model ]
        then
            mkdir find_best_model
        fi
        cd find_best_model
        ln -s ../../../per_gene/EOG091G0NQW/ALICUT_EOG091G0NQW.clustalo.fasta EOG091G0NQW.fasta
        ProteinModelSelection.pl EOG091G0NQW.fasta 1> ../../../per_gene/EOG091G0NQW/EOG091G0NQW.best_model 2> ../../../per_gene/EOG091G0NQW/find_best_model.stderr.txt
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/c0c09ee657b1e27f2c5687e0e9aa8d70.simg
[Sun Jul  5 23:26:18 2020]
Finished job 1111.
2092 of 3292 steps (64%) done

[Sun Jul  5 23:26:18 2020]
rule remove_empty:
    input: per_gene/EOG091G09U9/ALICUT_EOG091G09U9.clustalo.fasta
    output: per_gene/EOG091G09U9/empty_check.done
    jobid: 1933
    wildcards: BUSCO=EOG091G09U9


         if [ "$(cat per_gene/EOG091G09U9/ALICUT_EOG091G09U9.clustalo.fasta | grep -v ">" | sed 's/-//g' | grep "^$" | wc -l)" -gt 0 ]
         then
              cp per_gene/EOG091G09U9/ALICUT_EOG091G09U9.clustalo.fasta per_gene/EOG091G09U9/ALICUT_EOG091G09U9.clustalo.fasta.backup
              bash ../scripts/remove_empty.sh per_gene/EOG091G09U9/ALICUT_EOG091G09U9.clustalo.fasta.backup > per_gene/EOG091G09U9/ALICUT_EOG091G09U9.clustalo.fasta
         fi
         touch per_gene/EOG091G09U9/empty_check.done
         
[Sun Jul  5 23:26:18 2020]
Finished job 1933.
2093 of 3292 steps (64%) done

[Sun Jul  5 23:26:18 2020]
rule find_best_model:
    input: per_gene/EOG091G09U9/ALICUT_EOG091G09U9.clustalo.fasta, per_gene/EOG091G09U9/empty_check.done
    output: per_gene/EOG091G09U9/EOG091G09U9.best_model
    log: per_gene/EOG091G09U9/find_best_model.stderr.txt
    jobid: 1110
    wildcards: BUSCO=EOG091G09U9
    threads: 2


        cd per_gene/EOG091G09U9
        if [ ! -d find_best_model ]
        then
            mkdir find_best_model
        fi
        cd find_best_model
        ln -s ../../../per_gene/EOG091G09U9/ALICUT_EOG091G09U9.clustalo.fasta EOG091G09U9.fasta
        ProteinModelSelection.pl EOG091G09U9.fasta 1> ../../../per_gene/EOG091G09U9/EOG091G09U9.best_model 2> ../../../per_gene/EOG091G09U9/find_best_model.stderr.txt
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/c0c09ee657b1e27f2c5687e0e9aa8d70.simg
[Sun Jul  5 23:26:21 2020]
Finished job 13.
2094 of 3292 steps (64%) done

[Sun Jul  5 23:26:21 2020]
rule get_seqs:
    input: /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ingroup.txt, /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/outgroup.txt
    output: per_gene/EOG091G08BK/EOG091G08BK.ingroup.fasta
    log: per_gene/EOG091G08BK/get_seqs.stdout.txt, per_gene/EOG091G08BK/get_seqs.stderr.txt
    jobid: 2590
    wildcards: BUSCO=EOG091G08BK
    threads: 2


	basedir=$(pwd)
        cd per_gene/EOG091G08BK
        
        bash $basedir/../scripts/fetch_seqs.sh EOG091G08BK /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ingroup.txt /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/outgroup.txt 1> ../../per_gene/EOG091G08BK/get_seqs.stdout.txt 2> ../../per_gene/EOG091G08BK/get_seqs.stderr.txt
	mv EOG091G08BK.fasta $basedir/per_gene/EOG091G08BK/EOG091G08BK.ingroup.fasta
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/72476f9d9a5bd0627b4d721143a21354.simg
[Sun Jul  5 23:26:35 2020]
Finished job 2590.
2095 of 3292 steps (64%) done

[Sun Jul  5 23:26:35 2020]
rule get_outgroups:
    input: per_gene/EOG091G08BK/EOG091G08BK.ingroup.fasta
    output: per_gene/EOG091G08BK/EOG091G08BK.orthodb.fasta, per_gene/EOG091G08BK/EOG091G08BK.outgroup.fasta
    log: per_gene/EOG091G08BK/get_outgroups.stdout.txt, per_gene/EOG091G08BK/get_outgroups.stderr.txt
    jobid: 2591
    wildcards: BUSCO=EOG091G08BK


        #download fastas from Orhtodb for BUSCO id
        for i in {1..5}
        do
             wget "http://www.orthodb.org/fasta?query=EOG091G08BK&level=33208" -O per_gene/EOG091G08BK/EOG091G08BK.orthodb.fasta 1> per_gene/EOG091G08BK/get_outgroups.stdout.txt 2> per_gene/EOG091G08BK/get_outgroups.stderr.txt && break || echo -e "try again ($i)" && sleep 15
        done

	#This is quick an dirty for now and just takes the first protein if there is more than one for an outgroup taxon
        bash ../scripts/download_outgroups.sh taxids.txt per_gene/EOG091G08BK/EOG091G08BK.orthodb.fasta > per_gene/EOG091G08BK/EOG091G08BK.outgroup.fasta
        
[Sun Jul  5 23:26:35 2020]
Finished job 2591.
2096 of 3292 steps (64%) done

[Sun Jul  5 23:26:35 2020]
rule join_groups:
    input: per_gene/EOG091G08BK/EOG091G08BK.ingroup.fasta, per_gene/EOG091G08BK/EOG091G08BK.outgroup.fasta
    output: per_gene/EOG091G08BK/EOG091G08BK.fasta
    jobid: 2119
    wildcards: BUSCO=EOG091G08BK


        cat per_gene/EOG091G08BK/EOG091G08BK.ingroup.fasta per_gene/EOG091G08BK/EOG091G08BK.outgroup.fasta > per_gene/EOG091G08BK/EOG091G08BK.fasta
        
[Sun Jul  5 23:26:36 2020]
Finished job 2119.
2097 of 3292 steps (64%) done

[Sun Jul  5 23:26:36 2020]
rule MSA:
    input: per_gene/EOG091G08BK/EOG091G08BK.fasta
    output: per_gene/EOG091G08BK/EOG091G08BK.clustalo.fasta
    log: per_gene/EOG091G08BK/MSA.stdout.txt, per_gene/EOG091G08BK/MSA.stderr.txt
    jobid: 1358
    wildcards: BUSCO=EOG091G08BK
    threads: 2


        clustalo -i per_gene/EOG091G08BK/EOG091G08BK.fasta -o per_gene/EOG091G08BK/EOG091G08BK.clustalo.fasta --threads=2 1> per_gene/EOG091G08BK/MSA.stdout.txt 2> per_gene/EOG091G08BK/MSA.stderr.txt
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/d68c9691725a7401923680874285c430.simg
[Sun Jul  5 23:26:38 2020]
Finished job 1358.
2098 of 3292 steps (64%) done

[Sun Jul  5 23:26:38 2020]
rule score_and_cut:
    input: per_gene/EOG091G08BK/EOG091G08BK.clustalo.fasta
    output: per_gene/EOG091G08BK/ALICUT_EOG091G08BK.clustalo.fasta
    jobid: 535
    wildcards: BUSCO=EOG091G08BK
    threads: 2


        cd per_gene/EOG091G08BK
        Aliscore.pl -N -r 200000000000000000 -i ../../per_gene/EOG091G08BK/EOG091G08BK.clustalo.fasta &> aliscore.log
        ALICUT.pl -s &> alicut.log
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/63c88c27a0fa300f57066b0ef65fefcb.simg
[Sun Jul  5 23:26:47 2020]
Finished job 472.
2099 of 3292 steps (64%) done

[Sun Jul  5 23:26:47 2020]
rule infer_single_ML:
    input: per_gene/EOG091G0530/EOG091G0530.best_model, per_gene/EOG091G0530/ALICUT_EOG091G0530.clustalo.fasta
    output: per_gene/EOG091G0530/EOG091G0530.raxml.done
    log: per_gene/EOG091G0530/infer_single_ML.stdout.txt, per_gene/EOG091G0530/infer_single_ML.stderr.txt
    jobid: 30
    wildcards: BUSCO=EOG091G0530
    threads: 2


        cd per_gene/EOG091G0530
	count=$(cat ../../per_gene/EOG091G0530/ALICUT_EOG091G0530.clustalo.fasta | grep ">" | wc -l)
	if [ "$count" -gt 5 ]
        then
		RAxMLmodel=$(cat ../../per_gene/EOG091G0530/EOG091G0530.best_model | grep "Best" | cut -d ":" -f 2 | tr -d '[:space:]')
                if [ "$(ls -1 | grep "^RAxML" | wc -l)" -ne 0 ]
		then
			rm RAxML*
		fi
        	raxml -f a -T 2 -m PROTGAMMA$RAxMLmodel         	-p 12345 -x 12345 -# 100         	-s ../../per_gene/EOG091G0530/ALICUT_EOG091G0530.clustalo.fasta -n EOG091G0530.clustalo.aln.ALICUT.$RAxMLmodel 		1> ../../per_gene/EOG091G0530/infer_single_ML.stdout.txt 2> ../../per_gene/EOG091G0530/infer_single_ML.stderr.txt
	else
		echo "fasta file per_gene/EOG091G0530/ALICUT_EOG091G0530.clustalo.fasta contains fewer than 5 sequences - skipped" > ../../per_gene/EOG091G0530/infer_single_ML.stdout.txt
		touch raxml.skipped
	fi
        touch ../../per_gene/EOG091G0530/EOG091G0530.raxml.done
        
[Sun Jul  5 23:26:47 2020]
Finished job 99.
2100 of 3292 steps (64%) done

[Sun Jul  5 23:26:47 2020]
rule get_seqs:
    input: /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ingroup.txt, /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/outgroup.txt
    output: per_gene/EOG091G011X/EOG091G011X.ingroup.fasta
    log: per_gene/EOG091G011X/get_seqs.stdout.txt, per_gene/EOG091G011X/get_seqs.stderr.txt
    jobid: 2476
    wildcards: BUSCO=EOG091G011X
    threads: 2


	basedir=$(pwd)
        cd per_gene/EOG091G011X
        
        bash $basedir/../scripts/fetch_seqs.sh EOG091G011X /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ingroup.txt /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/outgroup.txt 1> ../../per_gene/EOG091G011X/get_seqs.stdout.txt 2> ../../per_gene/EOG091G011X/get_seqs.stderr.txt
	mv EOG091G011X.fasta $basedir/per_gene/EOG091G011X/EOG091G011X.ingroup.fasta
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/72476f9d9a5bd0627b4d721143a21354.simg
[Sun Jul  5 23:26:50 2020]
Finished job 535.
2101 of 3292 steps (64%) done

[Sun Jul  5 23:26:50 2020]
rule remove_empty:
    input: per_gene/EOG091G08BK/ALICUT_EOG091G08BK.clustalo.fasta
    output: per_gene/EOG091G08BK/empty_check.done
    jobid: 1357
    wildcards: BUSCO=EOG091G08BK


         if [ "$(cat per_gene/EOG091G08BK/ALICUT_EOG091G08BK.clustalo.fasta | grep -v ">" | sed 's/-//g' | grep "^$" | wc -l)" -gt 0 ]
         then
              cp per_gene/EOG091G08BK/ALICUT_EOG091G08BK.clustalo.fasta per_gene/EOG091G08BK/ALICUT_EOG091G08BK.clustalo.fasta.backup
              bash ../scripts/remove_empty.sh per_gene/EOG091G08BK/ALICUT_EOG091G08BK.clustalo.fasta.backup > per_gene/EOG091G08BK/ALICUT_EOG091G08BK.clustalo.fasta
         fi
         touch per_gene/EOG091G08BK/empty_check.done
         
[Sun Jul  5 23:26:50 2020]
Finished job 1357.
2102 of 3292 steps (64%) done

[Sun Jul  5 23:26:50 2020]
rule find_best_model:
    input: per_gene/EOG091G08BK/ALICUT_EOG091G08BK.clustalo.fasta, per_gene/EOG091G08BK/empty_check.done
    output: per_gene/EOG091G08BK/EOG091G08BK.best_model
    log: per_gene/EOG091G08BK/find_best_model.stderr.txt
    jobid: 534
    wildcards: BUSCO=EOG091G08BK
    threads: 2


        cd per_gene/EOG091G08BK
        if [ ! -d find_best_model ]
        then
            mkdir find_best_model
        fi
        cd find_best_model
        ln -s ../../../per_gene/EOG091G08BK/ALICUT_EOG091G08BK.clustalo.fasta EOG091G08BK.fasta
        ProteinModelSelection.pl EOG091G08BK.fasta 1> ../../../per_gene/EOG091G08BK/EOG091G08BK.best_model 2> ../../../per_gene/EOG091G08BK/find_best_model.stderr.txt
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/c0c09ee657b1e27f2c5687e0e9aa8d70.simg
[Sun Jul  5 23:26:55 2020]
Finished job 1044.
2103 of 3292 steps (64%) done

[Sun Jul  5 23:26:55 2020]
rule infer_single_ML:
    input: per_gene/EOG091G0NQW/EOG091G0NQW.best_model, per_gene/EOG091G0NQW/ALICUT_EOG091G0NQW.clustalo.fasta
    output: per_gene/EOG091G0NQW/EOG091G0NQW.raxml.done
    log: per_gene/EOG091G0NQW/infer_single_ML.stdout.txt, per_gene/EOG091G0NQW/infer_single_ML.stderr.txt
    jobid: 316
    wildcards: BUSCO=EOG091G0NQW
    threads: 2


        cd per_gene/EOG091G0NQW
	count=$(cat ../../per_gene/EOG091G0NQW/ALICUT_EOG091G0NQW.clustalo.fasta | grep ">" | wc -l)
	if [ "$count" -gt 5 ]
        then
		RAxMLmodel=$(cat ../../per_gene/EOG091G0NQW/EOG091G0NQW.best_model | grep "Best" | cut -d ":" -f 2 | tr -d '[:space:]')
                if [ "$(ls -1 | grep "^RAxML" | wc -l)" -ne 0 ]
		then
			rm RAxML*
		fi
        	raxml -f a -T 2 -m PROTGAMMA$RAxMLmodel         	-p 12345 -x 12345 -# 100         	-s ../../per_gene/EOG091G0NQW/ALICUT_EOG091G0NQW.clustalo.fasta -n EOG091G0NQW.clustalo.aln.ALICUT.$RAxMLmodel 		1> ../../per_gene/EOG091G0NQW/infer_single_ML.stdout.txt 2> ../../per_gene/EOG091G0NQW/infer_single_ML.stderr.txt
	else
		echo "fasta file per_gene/EOG091G0NQW/ALICUT_EOG091G0NQW.clustalo.fasta contains fewer than 5 sequences - skipped" > ../../per_gene/EOG091G0NQW/infer_single_ML.stdout.txt
		touch raxml.skipped
	fi
        touch ../../per_gene/EOG091G0NQW/EOG091G0NQW.raxml.done
        
[Sun Jul  5 23:26:57 2020]
Finished job 1110.
2104 of 3292 steps (64%) done

[Sun Jul  5 23:26:57 2020]
rule infer_single_ML:
    input: per_gene/EOG091G09U9/EOG091G09U9.best_model, per_gene/EOG091G09U9/ALICUT_EOG091G09U9.clustalo.fasta
    output: per_gene/EOG091G09U9/EOG091G09U9.raxml.done
    log: per_gene/EOG091G09U9/infer_single_ML.stdout.txt, per_gene/EOG091G09U9/infer_single_ML.stderr.txt
    jobid: 349
    wildcards: BUSCO=EOG091G09U9
    threads: 2


        cd per_gene/EOG091G09U9
	count=$(cat ../../per_gene/EOG091G09U9/ALICUT_EOG091G09U9.clustalo.fasta | grep ">" | wc -l)
	if [ "$count" -gt 5 ]
        then
		RAxMLmodel=$(cat ../../per_gene/EOG091G09U9/EOG091G09U9.best_model | grep "Best" | cut -d ":" -f 2 | tr -d '[:space:]')
                if [ "$(ls -1 | grep "^RAxML" | wc -l)" -ne 0 ]
		then
			rm RAxML*
		fi
        	raxml -f a -T 2 -m PROTGAMMA$RAxMLmodel         	-p 12345 -x 12345 -# 100         	-s ../../per_gene/EOG091G09U9/ALICUT_EOG091G09U9.clustalo.fasta -n EOG091G09U9.clustalo.aln.ALICUT.$RAxMLmodel 		1> ../../per_gene/EOG091G09U9/infer_single_ML.stdout.txt 2> ../../per_gene/EOG091G09U9/infer_single_ML.stderr.txt
	else
		echo "fasta file per_gene/EOG091G09U9/ALICUT_EOG091G09U9.clustalo.fasta contains fewer than 5 sequences - skipped" > ../../per_gene/EOG091G09U9/infer_single_ML.stdout.txt
		touch raxml.skipped
	fi
        touch ../../per_gene/EOG091G09U9/EOG091G09U9.raxml.done
        
[33mJob counts:
	count	jobs
	1	infer_single_ML
	1[0m
[33m
        cd per_gene/EOG091G0530
	count=$(cat ../../per_gene/EOG091G0530/ALICUT_EOG091G0530.clustalo.fasta | grep ">" | wc -l)
	if [ "$count" -gt 5 ]
        then
		RAxMLmodel=$(cat ../../per_gene/EOG091G0530/EOG091G0530.best_model | grep "Best" | cut -d ":" -f 2 | tr -d '[:space:]')
                if [ "$(ls -1 | grep "^RAxML" | wc -l)" -ne 0 ]
		then
			rm RAxML*
		fi
        	raxml -f a -T 2 -m PROTGAMMA$RAxMLmodel         	-p 12345 -x 12345 -# 100         	-s ../../per_gene/EOG091G0530/ALICUT_EOG091G0530.clustalo.fasta -n EOG091G0530.clustalo.aln.ALICUT.$RAxMLmodel 		1> ../../per_gene/EOG091G0530/infer_single_ML.stdout.txt 2> ../../per_gene/EOG091G0530/infer_single_ML.stderr.txt
	else
		echo "fasta file per_gene/EOG091G0530/ALICUT_EOG091G0530.clustalo.fasta contains fewer than 5 sequences - skipped" > ../../per_gene/EOG091G0530/infer_single_ML.stdout.txt
		touch raxml.skipped
	fi
        touch ../../per_gene/EOG091G0530/EOG091G0530.raxml.done
        [0m
[33mJob counts:
	count	jobs
	1	infer_single_ML
	1[0m
[33m
        cd per_gene/EOG091G0NQW
	count=$(cat ../../per_gene/EOG091G0NQW/ALICUT_EOG091G0NQW.clustalo.fasta | grep ">" | wc -l)
	if [ "$count" -gt 5 ]
        then
		RAxMLmodel=$(cat ../../per_gene/EOG091G0NQW/EOG091G0NQW.best_model | grep "Best" | cut -d ":" -f 2 | tr -d '[:space:]')
                if [ "$(ls -1 | grep "^RAxML" | wc -l)" -ne 0 ]
		then
			rm RAxML*
		fi
        	raxml -f a -T 2 -m PROTGAMMA$RAxMLmodel         	-p 12345 -x 12345 -# 100         	-s ../../per_gene/EOG091G0NQW/ALICUT_EOG091G0NQW.clustalo.fasta -n EOG091G0NQW.clustalo.aln.ALICUT.$RAxMLmodel 		1> ../../per_gene/EOG091G0NQW/infer_single_ML.stdout.txt 2> ../../per_gene/EOG091G0NQW/infer_single_ML.stderr.txt
	else
		echo "fasta file per_gene/EOG091G0NQW/ALICUT_EOG091G0NQW.clustalo.fasta contains fewer than 5 sequences - skipped" > ../../per_gene/EOG091G0NQW/infer_single_ML.stdout.txt
		touch raxml.skipped
	fi
        touch ../../per_gene/EOG091G0NQW/EOG091G0NQW.raxml.done
        [0m
[33mJob counts:
	count	jobs
	1	infer_single_ML
	1[0m
[33m
        cd per_gene/EOG091G09U9
	count=$(cat ../../per_gene/EOG091G09U9/ALICUT_EOG091G09U9.clustalo.fasta | grep ">" | wc -l)
	if [ "$count" -gt 5 ]
        then
		RAxMLmodel=$(cat ../../per_gene/EOG091G09U9/EOG091G09U9.best_model | grep "Best" | cut -d ":" -f 2 | tr -d '[:space:]')
                if [ "$(ls -1 | grep "^RAxML" | wc -l)" -ne 0 ]
		then
			rm RAxML*
		fi
        	raxml -f a -T 2 -m PROTGAMMA$RAxMLmodel         	-p 12345 -x 12345 -# 100         	-s ../../per_gene/EOG091G09U9/ALICUT_EOG091G09U9.clustalo.fasta -n EOG091G09U9.clustalo.aln.ALICUT.$RAxMLmodel 		1> ../../per_gene/EOG091G09U9/infer_single_ML.stdout.txt 2> ../../per_gene/EOG091G09U9/infer_single_ML.stderr.txt
	else
		echo "fasta file per_gene/EOG091G09U9/ALICUT_EOG091G09U9.clustalo.fasta contains fewer than 5 sequences - skipped" > ../../per_gene/EOG091G09U9/infer_single_ML.stdout.txt
		touch raxml.skipped
	fi
        touch ../../per_gene/EOG091G09U9/EOG091G09U9.raxml.done
        [0m
[Sun Jul  5 23:27:00 2020]
Finished job 2476.
2105 of 3292 steps (64%) done

[Sun Jul  5 23:27:00 2020]
rule get_outgroups:
    input: per_gene/EOG091G011X/EOG091G011X.ingroup.fasta
    output: per_gene/EOG091G011X/EOG091G011X.orthodb.fasta, per_gene/EOG091G011X/EOG091G011X.outgroup.fasta
    log: per_gene/EOG091G011X/get_outgroups.stdout.txt, per_gene/EOG091G011X/get_outgroups.stderr.txt
    jobid: 2477
    wildcards: BUSCO=EOG091G011X


        #download fastas from Orhtodb for BUSCO id
        for i in {1..5}
        do
             wget "http://www.orthodb.org/fasta?query=EOG091G011X&level=33208" -O per_gene/EOG091G011X/EOG091G011X.orthodb.fasta 1> per_gene/EOG091G011X/get_outgroups.stdout.txt 2> per_gene/EOG091G011X/get_outgroups.stderr.txt && break || echo -e "try again ($i)" && sleep 15
        done

	#This is quick an dirty for now and just takes the first protein if there is more than one for an outgroup taxon
        bash ../scripts/download_outgroups.sh taxids.txt per_gene/EOG091G011X/EOG091G011X.orthodb.fasta > per_gene/EOG091G011X/EOG091G011X.outgroup.fasta
        
[Sun Jul  5 23:27:01 2020]
Finished job 2477.
2106 of 3292 steps (64%) done

[Sun Jul  5 23:27:01 2020]
rule join_groups:
    input: per_gene/EOG091G011X/EOG091G011X.ingroup.fasta, per_gene/EOG091G011X/EOG091G011X.outgroup.fasta
    output: per_gene/EOG091G011X/EOG091G011X.fasta
    jobid: 2062
    wildcards: BUSCO=EOG091G011X


        cat per_gene/EOG091G011X/EOG091G011X.ingroup.fasta per_gene/EOG091G011X/EOG091G011X.outgroup.fasta > per_gene/EOG091G011X/EOG091G011X.fasta
        
[Sun Jul  5 23:27:01 2020]
Finished job 2062.
2107 of 3292 steps (64%) done

[Sun Jul  5 23:27:01 2020]
rule MSA:
    input: per_gene/EOG091G011X/EOG091G011X.fasta
    output: per_gene/EOG091G011X/EOG091G011X.clustalo.fasta
    log: per_gene/EOG091G011X/MSA.stdout.txt, per_gene/EOG091G011X/MSA.stderr.txt
    jobid: 1244
    wildcards: BUSCO=EOG091G011X
    threads: 2


        clustalo -i per_gene/EOG091G011X/EOG091G011X.fasta -o per_gene/EOG091G011X/EOG091G011X.clustalo.fasta --threads=2 1> per_gene/EOG091G011X/MSA.stdout.txt 2> per_gene/EOG091G011X/MSA.stderr.txt
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/d68c9691725a7401923680874285c430.simg
[Sun Jul  5 23:27:07 2020]
Finished job 1244.
2108 of 3292 steps (64%) done

[Sun Jul  5 23:27:07 2020]
rule score_and_cut:
    input: per_gene/EOG091G011X/EOG091G011X.clustalo.fasta
    output: per_gene/EOG091G011X/ALICUT_EOG091G011X.clustalo.fasta
    jobid: 421
    wildcards: BUSCO=EOG091G011X
    threads: 2


        cd per_gene/EOG091G011X
        Aliscore.pl -N -r 200000000000000000 -i ../../per_gene/EOG091G011X/EOG091G011X.clustalo.fasta &> aliscore.log
        ALICUT.pl -s &> alicut.log
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/63c88c27a0fa300f57066b0ef65fefcb.simg
[Sun Jul  5 23:27:18 2020]
Finished job 421.
2109 of 3292 steps (64%) done

[Sun Jul  5 23:27:18 2020]
rule remove_empty:
    input: per_gene/EOG091G011X/ALICUT_EOG091G011X.clustalo.fasta
    output: per_gene/EOG091G011X/empty_check.done
    jobid: 1243
    wildcards: BUSCO=EOG091G011X


         if [ "$(cat per_gene/EOG091G011X/ALICUT_EOG091G011X.clustalo.fasta | grep -v ">" | sed 's/-//g' | grep "^$" | wc -l)" -gt 0 ]
         then
              cp per_gene/EOG091G011X/ALICUT_EOG091G011X.clustalo.fasta per_gene/EOG091G011X/ALICUT_EOG091G011X.clustalo.fasta.backup
              bash ../scripts/remove_empty.sh per_gene/EOG091G011X/ALICUT_EOG091G011X.clustalo.fasta.backup > per_gene/EOG091G011X/ALICUT_EOG091G011X.clustalo.fasta
         fi
         touch per_gene/EOG091G011X/empty_check.done
         
[Sun Jul  5 23:27:19 2020]
Finished job 1243.
2110 of 3292 steps (64%) done

[Sun Jul  5 23:27:19 2020]
rule find_best_model:
    input: per_gene/EOG091G011X/ALICUT_EOG091G011X.clustalo.fasta, per_gene/EOG091G011X/empty_check.done
    output: per_gene/EOG091G011X/EOG091G011X.best_model
    log: per_gene/EOG091G011X/find_best_model.stderr.txt
    jobid: 420
    wildcards: BUSCO=EOG091G011X
    threads: 2


        cd per_gene/EOG091G011X
        if [ ! -d find_best_model ]
        then
            mkdir find_best_model
        fi
        cd find_best_model
        ln -s ../../../per_gene/EOG091G011X/ALICUT_EOG091G011X.clustalo.fasta EOG091G011X.fasta
        ProteinModelSelection.pl EOG091G011X.fasta 1> ../../../per_gene/EOG091G011X/EOG091G011X.best_model 2> ../../../per_gene/EOG091G011X/find_best_model.stderr.txt
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/c0c09ee657b1e27f2c5687e0e9aa8d70.simg
[Sun Jul  5 23:27:31 2020]
Finished job 534.
2111 of 3292 steps (64%) done

[Sun Jul  5 23:27:31 2020]
rule infer_single_ML:
    input: per_gene/EOG091G08BK/EOG091G08BK.best_model, per_gene/EOG091G08BK/ALICUT_EOG091G08BK.clustalo.fasta
    output: per_gene/EOG091G08BK/EOG091G08BK.raxml.done
    log: per_gene/EOG091G08BK/infer_single_ML.stdout.txt, per_gene/EOG091G08BK/infer_single_ML.stderr.txt
    jobid: 61
    wildcards: BUSCO=EOG091G08BK
    threads: 2


        cd per_gene/EOG091G08BK
	count=$(cat ../../per_gene/EOG091G08BK/ALICUT_EOG091G08BK.clustalo.fasta | grep ">" | wc -l)
	if [ "$count" -gt 5 ]
        then
		RAxMLmodel=$(cat ../../per_gene/EOG091G08BK/EOG091G08BK.best_model | grep "Best" | cut -d ":" -f 2 | tr -d '[:space:]')
                if [ "$(ls -1 | grep "^RAxML" | wc -l)" -ne 0 ]
		then
			rm RAxML*
		fi
        	raxml -f a -T 2 -m PROTGAMMA$RAxMLmodel         	-p 12345 -x 12345 -# 100         	-s ../../per_gene/EOG091G08BK/ALICUT_EOG091G08BK.clustalo.fasta -n EOG091G08BK.clustalo.aln.ALICUT.$RAxMLmodel 		1> ../../per_gene/EOG091G08BK/infer_single_ML.stdout.txt 2> ../../per_gene/EOG091G08BK/infer_single_ML.stderr.txt
	else
		echo "fasta file per_gene/EOG091G08BK/ALICUT_EOG091G08BK.clustalo.fasta contains fewer than 5 sequences - skipped" > ../../per_gene/EOG091G08BK/infer_single_ML.stdout.txt
		touch raxml.skipped
	fi
        touch ../../per_gene/EOG091G08BK/EOG091G08BK.raxml.done
        
[33mJob counts:
	count	jobs
	1	infer_single_ML
	1[0m
[33m
        cd per_gene/EOG091G08BK
	count=$(cat ../../per_gene/EOG091G08BK/ALICUT_EOG091G08BK.clustalo.fasta | grep ">" | wc -l)
	if [ "$count" -gt 5 ]
        then
		RAxMLmodel=$(cat ../../per_gene/EOG091G08BK/EOG091G08BK.best_model | grep "Best" | cut -d ":" -f 2 | tr -d '[:space:]')
                if [ "$(ls -1 | grep "^RAxML" | wc -l)" -ne 0 ]
		then
			rm RAxML*
		fi
        	raxml -f a -T 2 -m PROTGAMMA$RAxMLmodel         	-p 12345 -x 12345 -# 100         	-s ../../per_gene/EOG091G08BK/ALICUT_EOG091G08BK.clustalo.fasta -n EOG091G08BK.clustalo.aln.ALICUT.$RAxMLmodel 		1> ../../per_gene/EOG091G08BK/infer_single_ML.stdout.txt 2> ../../per_gene/EOG091G08BK/infer_single_ML.stderr.txt
	else
		echo "fasta file per_gene/EOG091G08BK/ALICUT_EOG091G08BK.clustalo.fasta contains fewer than 5 sequences - skipped" > ../../per_gene/EOG091G08BK/infer_single_ML.stdout.txt
		touch raxml.skipped
	fi
        touch ../../per_gene/EOG091G08BK/EOG091G08BK.raxml.done
        [0m
[Sun Jul  5 23:28:34 2020]
Finished job 420.
2112 of 3292 steps (64%) done

[Sun Jul  5 23:28:34 2020]
rule infer_single_ML:
    input: per_gene/EOG091G011X/EOG091G011X.best_model, per_gene/EOG091G011X/ALICUT_EOG091G011X.clustalo.fasta
    output: per_gene/EOG091G011X/EOG091G011X.raxml.done
    log: per_gene/EOG091G011X/infer_single_ML.stdout.txt, per_gene/EOG091G011X/infer_single_ML.stderr.txt
    jobid: 4
    wildcards: BUSCO=EOG091G011X
    threads: 2


        cd per_gene/EOG091G011X
	count=$(cat ../../per_gene/EOG091G011X/ALICUT_EOG091G011X.clustalo.fasta | grep ">" | wc -l)
	if [ "$count" -gt 5 ]
        then
		RAxMLmodel=$(cat ../../per_gene/EOG091G011X/EOG091G011X.best_model | grep "Best" | cut -d ":" -f 2 | tr -d '[:space:]')
                if [ "$(ls -1 | grep "^RAxML" | wc -l)" -ne 0 ]
		then
			rm RAxML*
		fi
        	raxml -f a -T 2 -m PROTGAMMA$RAxMLmodel         	-p 12345 -x 12345 -# 100         	-s ../../per_gene/EOG091G011X/ALICUT_EOG091G011X.clustalo.fasta -n EOG091G011X.clustalo.aln.ALICUT.$RAxMLmodel 		1> ../../per_gene/EOG091G011X/infer_single_ML.stdout.txt 2> ../../per_gene/EOG091G011X/infer_single_ML.stderr.txt
	else
		echo "fasta file per_gene/EOG091G011X/ALICUT_EOG091G011X.clustalo.fasta contains fewer than 5 sequences - skipped" > ../../per_gene/EOG091G011X/infer_single_ML.stdout.txt
		touch raxml.skipped
	fi
        touch ../../per_gene/EOG091G011X/EOG091G011X.raxml.done
        
[Sun Jul  5 23:28:39 2020]
Finished job 170.
2113 of 3292 steps (64%) done

[Sun Jul  5 23:28:39 2020]
rule get_seqs:
    input: /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ingroup.txt, /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/outgroup.txt
    output: per_gene/EOG091G09RJ/EOG091G09RJ.ingroup.fasta
    log: per_gene/EOG091G09RJ/get_seqs.stdout.txt, per_gene/EOG091G09RJ/get_seqs.stderr.txt
    jobid: 2610
    wildcards: BUSCO=EOG091G09RJ
    threads: 2


	basedir=$(pwd)
        cd per_gene/EOG091G09RJ
        
        bash $basedir/../scripts/fetch_seqs.sh EOG091G09RJ /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ingroup.txt /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/outgroup.txt 1> ../../per_gene/EOG091G09RJ/get_seqs.stdout.txt 2> ../../per_gene/EOG091G09RJ/get_seqs.stderr.txt
	mv EOG091G09RJ.fasta $basedir/per_gene/EOG091G09RJ/EOG091G09RJ.ingroup.fasta
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/72476f9d9a5bd0627b4d721143a21354.simg
[Sun Jul  5 23:28:48 2020]
Finished job 405.
2114 of 3292 steps (64%) done

[Sun Jul  5 23:28:48 2020]
rule get_seqs:
    input: /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ingroup.txt, /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/outgroup.txt
    output: per_gene/EOG091G0MDD/EOG091G0MDD.ingroup.fasta
    log: per_gene/EOG091G0MDD/get_seqs.stdout.txt, per_gene/EOG091G0MDD/get_seqs.stderr.txt
    jobid: 3228
    wildcards: BUSCO=EOG091G0MDD
    threads: 2


	basedir=$(pwd)
        cd per_gene/EOG091G0MDD
        
        bash $basedir/../scripts/fetch_seqs.sh EOG091G0MDD /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ingroup.txt /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/outgroup.txt 1> ../../per_gene/EOG091G0MDD/get_seqs.stdout.txt 2> ../../per_gene/EOG091G0MDD/get_seqs.stderr.txt
	mv EOG091G0MDD.fasta $basedir/per_gene/EOG091G0MDD/EOG091G0MDD.ingroup.fasta
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/72476f9d9a5bd0627b4d721143a21354.simg
[33mJob counts:
	count	jobs
	1	infer_single_ML
	1[0m
[33m
        cd per_gene/EOG091G011X
	count=$(cat ../../per_gene/EOG091G011X/ALICUT_EOG091G011X.clustalo.fasta | grep ">" | wc -l)
	if [ "$count" -gt 5 ]
        then
		RAxMLmodel=$(cat ../../per_gene/EOG091G011X/EOG091G011X.best_model | grep "Best" | cut -d ":" -f 2 | tr -d '[:space:]')
                if [ "$(ls -1 | grep "^RAxML" | wc -l)" -ne 0 ]
		then
			rm RAxML*
		fi
        	raxml -f a -T 2 -m PROTGAMMA$RAxMLmodel         	-p 12345 -x 12345 -# 100         	-s ../../per_gene/EOG091G011X/ALICUT_EOG091G011X.clustalo.fasta -n EOG091G011X.clustalo.aln.ALICUT.$RAxMLmodel 		1> ../../per_gene/EOG091G011X/infer_single_ML.stdout.txt 2> ../../per_gene/EOG091G011X/infer_single_ML.stderr.txt
	else
		echo "fasta file per_gene/EOG091G011X/ALICUT_EOG091G011X.clustalo.fasta contains fewer than 5 sequences - skipped" > ../../per_gene/EOG091G011X/infer_single_ML.stdout.txt
		touch raxml.skipped
	fi
        touch ../../per_gene/EOG091G011X/EOG091G011X.raxml.done
        [0m
[Sun Jul  5 23:28:50 2020]
Finished job 247.
2115 of 3292 steps (64%) done

[Sun Jul  5 23:28:50 2020]
rule get_seqs:
    input: /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ingroup.txt, /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/outgroup.txt
    output: per_gene/EOG091G0HTU/EOG091G0HTU.ingroup.fasta
    log: per_gene/EOG091G0HTU/get_seqs.stdout.txt, per_gene/EOG091G0HTU/get_seqs.stderr.txt
    jobid: 3200
    wildcards: BUSCO=EOG091G0HTU
    threads: 2


	basedir=$(pwd)
        cd per_gene/EOG091G0HTU
        
        bash $basedir/../scripts/fetch_seqs.sh EOG091G0HTU /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ingroup.txt /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/outgroup.txt 1> ../../per_gene/EOG091G0HTU/get_seqs.stdout.txt 2> ../../per_gene/EOG091G0HTU/get_seqs.stderr.txt
	mv EOG091G0HTU.fasta $basedir/per_gene/EOG091G0HTU/EOG091G0HTU.ingroup.fasta
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/72476f9d9a5bd0627b4d721143a21354.simg
[Sun Jul  5 23:28:53 2020]
Finished job 2610.
2116 of 3292 steps (64%) done

[Sun Jul  5 23:28:53 2020]
rule get_outgroups:
    input: per_gene/EOG091G09RJ/EOG091G09RJ.ingroup.fasta
    output: per_gene/EOG091G09RJ/EOG091G09RJ.orthodb.fasta, per_gene/EOG091G09RJ/EOG091G09RJ.outgroup.fasta
    log: per_gene/EOG091G09RJ/get_outgroups.stdout.txt, per_gene/EOG091G09RJ/get_outgroups.stderr.txt
    jobid: 2611
    wildcards: BUSCO=EOG091G09RJ


        #download fastas from Orhtodb for BUSCO id
        for i in {1..5}
        do
             wget "http://www.orthodb.org/fasta?query=EOG091G09RJ&level=33208" -O per_gene/EOG091G09RJ/EOG091G09RJ.orthodb.fasta 1> per_gene/EOG091G09RJ/get_outgroups.stdout.txt 2> per_gene/EOG091G09RJ/get_outgroups.stderr.txt && break || echo -e "try again ($i)" && sleep 15
        done

	#This is quick an dirty for now and just takes the first protein if there is more than one for an outgroup taxon
        bash ../scripts/download_outgroups.sh taxids.txt per_gene/EOG091G09RJ/EOG091G09RJ.orthodb.fasta > per_gene/EOG091G09RJ/EOG091G09RJ.outgroup.fasta
        
[Sun Jul  5 23:28:54 2020]
Finished job 2611.
2117 of 3292 steps (64%) done

[Sun Jul  5 23:28:54 2020]
rule join_groups:
    input: per_gene/EOG091G09RJ/EOG091G09RJ.ingroup.fasta, per_gene/EOG091G09RJ/EOG091G09RJ.outgroup.fasta
    output: per_gene/EOG091G09RJ/EOG091G09RJ.fasta
    jobid: 2129
    wildcards: BUSCO=EOG091G09RJ


        cat per_gene/EOG091G09RJ/EOG091G09RJ.ingroup.fasta per_gene/EOG091G09RJ/EOG091G09RJ.outgroup.fasta > per_gene/EOG091G09RJ/EOG091G09RJ.fasta
        
[Sun Jul  5 23:28:54 2020]
Finished job 2129.
2118 of 3292 steps (64%) done

[Sun Jul  5 23:28:54 2020]
rule MSA:
    input: per_gene/EOG091G09RJ/EOG091G09RJ.fasta
    output: per_gene/EOG091G09RJ/EOG091G09RJ.clustalo.fasta
    log: per_gene/EOG091G09RJ/MSA.stdout.txt, per_gene/EOG091G09RJ/MSA.stderr.txt
    jobid: 1378
    wildcards: BUSCO=EOG091G09RJ
    threads: 2


        clustalo -i per_gene/EOG091G09RJ/EOG091G09RJ.fasta -o per_gene/EOG091G09RJ/EOG091G09RJ.clustalo.fasta --threads=2 1> per_gene/EOG091G09RJ/MSA.stdout.txt 2> per_gene/EOG091G09RJ/MSA.stderr.txt
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/d68c9691725a7401923680874285c430.simg
[Sun Jul  5 23:28:57 2020]
Finished job 1378.
2119 of 3292 steps (64%) done

[Sun Jul  5 23:28:57 2020]
rule score_and_cut:
    input: per_gene/EOG091G09RJ/EOG091G09RJ.clustalo.fasta
    output: per_gene/EOG091G09RJ/ALICUT_EOG091G09RJ.clustalo.fasta
    jobid: 555
    wildcards: BUSCO=EOG091G09RJ
    threads: 2


        cd per_gene/EOG091G09RJ
        Aliscore.pl -N -r 200000000000000000 -i ../../per_gene/EOG091G09RJ/EOG091G09RJ.clustalo.fasta &> aliscore.log
        ALICUT.pl -s &> alicut.log
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/63c88c27a0fa300f57066b0ef65fefcb.simg
[Sun Jul  5 23:29:01 2020]
Finished job 3228.
2120 of 3292 steps (64%) done

[Sun Jul  5 23:29:01 2020]
rule get_outgroups:
    input: per_gene/EOG091G0MDD/EOG091G0MDD.ingroup.fasta
    output: per_gene/EOG091G0MDD/EOG091G0MDD.orthodb.fasta, per_gene/EOG091G0MDD/EOG091G0MDD.outgroup.fasta
    log: per_gene/EOG091G0MDD/get_outgroups.stdout.txt, per_gene/EOG091G0MDD/get_outgroups.stderr.txt
    jobid: 3229
    wildcards: BUSCO=EOG091G0MDD


        #download fastas from Orhtodb for BUSCO id
        for i in {1..5}
        do
             wget "http://www.orthodb.org/fasta?query=EOG091G0MDD&level=33208" -O per_gene/EOG091G0MDD/EOG091G0MDD.orthodb.fasta 1> per_gene/EOG091G0MDD/get_outgroups.stdout.txt 2> per_gene/EOG091G0MDD/get_outgroups.stderr.txt && break || echo -e "try again ($i)" && sleep 15
        done

	#This is quick an dirty for now and just takes the first protein if there is more than one for an outgroup taxon
        bash ../scripts/download_outgroups.sh taxids.txt per_gene/EOG091G0MDD/EOG091G0MDD.orthodb.fasta > per_gene/EOG091G0MDD/EOG091G0MDD.outgroup.fasta
        
[Sun Jul  5 23:29:01 2020]
Finished job 3229.
2121 of 3292 steps (64%) done

[Sun Jul  5 23:29:01 2020]
rule join_groups:
    input: per_gene/EOG091G0MDD/EOG091G0MDD.ingroup.fasta, per_gene/EOG091G0MDD/EOG091G0MDD.outgroup.fasta
    output: per_gene/EOG091G0MDD/EOG091G0MDD.fasta
    jobid: 2438
    wildcards: BUSCO=EOG091G0MDD


        cat per_gene/EOG091G0MDD/EOG091G0MDD.ingroup.fasta per_gene/EOG091G0MDD/EOG091G0MDD.outgroup.fasta > per_gene/EOG091G0MDD/EOG091G0MDD.fasta
        
[Sun Jul  5 23:29:01 2020]
Finished job 2438.
2122 of 3292 steps (64%) done

[Sun Jul  5 23:29:01 2020]
rule MSA:
    input: per_gene/EOG091G0MDD/EOG091G0MDD.fasta
    output: per_gene/EOG091G0MDD/EOG091G0MDD.clustalo.fasta
    log: per_gene/EOG091G0MDD/MSA.stdout.txt, per_gene/EOG091G0MDD/MSA.stderr.txt
    jobid: 1996
    wildcards: BUSCO=EOG091G0MDD
    threads: 2


        clustalo -i per_gene/EOG091G0MDD/EOG091G0MDD.fasta -o per_gene/EOG091G0MDD/EOG091G0MDD.clustalo.fasta --threads=2 1> per_gene/EOG091G0MDD/MSA.stdout.txt 2> per_gene/EOG091G0MDD/MSA.stderr.txt
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/d68c9691725a7401923680874285c430.simg
[Sun Jul  5 23:29:02 2020]
Finished job 3200.
2123 of 3292 steps (64%) done

[Sun Jul  5 23:29:02 2020]
rule get_outgroups:
    input: per_gene/EOG091G0HTU/EOG091G0HTU.ingroup.fasta
    output: per_gene/EOG091G0HTU/EOG091G0HTU.orthodb.fasta, per_gene/EOG091G0HTU/EOG091G0HTU.outgroup.fasta
    log: per_gene/EOG091G0HTU/get_outgroups.stdout.txt, per_gene/EOG091G0HTU/get_outgroups.stderr.txt
    jobid: 3201
    wildcards: BUSCO=EOG091G0HTU


        #download fastas from Orhtodb for BUSCO id
        for i in {1..5}
        do
             wget "http://www.orthodb.org/fasta?query=EOG091G0HTU&level=33208" -O per_gene/EOG091G0HTU/EOG091G0HTU.orthodb.fasta 1> per_gene/EOG091G0HTU/get_outgroups.stdout.txt 2> per_gene/EOG091G0HTU/get_outgroups.stderr.txt && break || echo -e "try again ($i)" && sleep 15
        done

	#This is quick an dirty for now and just takes the first protein if there is more than one for an outgroup taxon
        bash ../scripts/download_outgroups.sh taxids.txt per_gene/EOG091G0HTU/EOG091G0HTU.orthodb.fasta > per_gene/EOG091G0HTU/EOG091G0HTU.outgroup.fasta
        
[Sun Jul  5 23:29:02 2020]
Finished job 1996.
2124 of 3292 steps (65%) done

[Sun Jul  5 23:29:02 2020]
rule score_and_cut:
    input: per_gene/EOG091G0MDD/EOG091G0MDD.clustalo.fasta
    output: per_gene/EOG091G0MDD/ALICUT_EOG091G0MDD.clustalo.fasta
    jobid: 1173
    wildcards: BUSCO=EOG091G0MDD
    threads: 2


        cd per_gene/EOG091G0MDD
        Aliscore.pl -N -r 200000000000000000 -i ../../per_gene/EOG091G0MDD/EOG091G0MDD.clustalo.fasta &> aliscore.log
        ALICUT.pl -s &> alicut.log
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/63c88c27a0fa300f57066b0ef65fefcb.simg
[Sun Jul  5 23:29:03 2020]
Finished job 3201.
2125 of 3292 steps (65%) done

[Sun Jul  5 23:29:03 2020]
rule join_groups:
    input: per_gene/EOG091G0HTU/EOG091G0HTU.ingroup.fasta, per_gene/EOG091G0HTU/EOG091G0HTU.outgroup.fasta
    output: per_gene/EOG091G0HTU/EOG091G0HTU.fasta
    jobid: 2424
    wildcards: BUSCO=EOG091G0HTU


        cat per_gene/EOG091G0HTU/EOG091G0HTU.ingroup.fasta per_gene/EOG091G0HTU/EOG091G0HTU.outgroup.fasta > per_gene/EOG091G0HTU/EOG091G0HTU.fasta
        
[Sun Jul  5 23:29:03 2020]
Finished job 2424.
2126 of 3292 steps (65%) done

[Sun Jul  5 23:29:03 2020]
rule MSA:
    input: per_gene/EOG091G0HTU/EOG091G0HTU.fasta
    output: per_gene/EOG091G0HTU/EOG091G0HTU.clustalo.fasta
    log: per_gene/EOG091G0HTU/MSA.stdout.txt, per_gene/EOG091G0HTU/MSA.stderr.txt
    jobid: 1968
    wildcards: BUSCO=EOG091G0HTU
    threads: 2


        clustalo -i per_gene/EOG091G0HTU/EOG091G0HTU.fasta -o per_gene/EOG091G0HTU/EOG091G0HTU.clustalo.fasta --threads=2 1> per_gene/EOG091G0HTU/MSA.stdout.txt 2> per_gene/EOG091G0HTU/MSA.stderr.txt
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/d68c9691725a7401923680874285c430.simg
[Sun Jul  5 23:29:04 2020]
Finished job 1968.
2127 of 3292 steps (65%) done

[Sun Jul  5 23:29:04 2020]
rule score_and_cut:
    input: per_gene/EOG091G0HTU/EOG091G0HTU.clustalo.fasta
    output: per_gene/EOG091G0HTU/ALICUT_EOG091G0HTU.clustalo.fasta
    jobid: 1145
    wildcards: BUSCO=EOG091G0HTU
    threads: 2


        cd per_gene/EOG091G0HTU
        Aliscore.pl -N -r 200000000000000000 -i ../../per_gene/EOG091G0HTU/EOG091G0HTU.clustalo.fasta &> aliscore.log
        ALICUT.pl -s &> alicut.log
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/63c88c27a0fa300f57066b0ef65fefcb.simg
[Sun Jul  5 23:29:09 2020]
Finished job 555.
2128 of 3292 steps (65%) done

[Sun Jul  5 23:29:09 2020]
rule remove_empty:
    input: per_gene/EOG091G09RJ/ALICUT_EOG091G09RJ.clustalo.fasta
    output: per_gene/EOG091G09RJ/empty_check.done
    jobid: 1377
    wildcards: BUSCO=EOG091G09RJ


         if [ "$(cat per_gene/EOG091G09RJ/ALICUT_EOG091G09RJ.clustalo.fasta | grep -v ">" | sed 's/-//g' | grep "^$" | wc -l)" -gt 0 ]
         then
              cp per_gene/EOG091G09RJ/ALICUT_EOG091G09RJ.clustalo.fasta per_gene/EOG091G09RJ/ALICUT_EOG091G09RJ.clustalo.fasta.backup
              bash ../scripts/remove_empty.sh per_gene/EOG091G09RJ/ALICUT_EOG091G09RJ.clustalo.fasta.backup > per_gene/EOG091G09RJ/ALICUT_EOG091G09RJ.clustalo.fasta
         fi
         touch per_gene/EOG091G09RJ/empty_check.done
         
[Sun Jul  5 23:29:09 2020]
Finished job 1377.
2129 of 3292 steps (65%) done

[Sun Jul  5 23:29:09 2020]
rule find_best_model:
    input: per_gene/EOG091G09RJ/ALICUT_EOG091G09RJ.clustalo.fasta, per_gene/EOG091G09RJ/empty_check.done
    output: per_gene/EOG091G09RJ/EOG091G09RJ.best_model
    log: per_gene/EOG091G09RJ/find_best_model.stderr.txt
    jobid: 554
    wildcards: BUSCO=EOG091G09RJ
    threads: 2


        cd per_gene/EOG091G09RJ
        if [ ! -d find_best_model ]
        then
            mkdir find_best_model
        fi
        cd find_best_model
        ln -s ../../../per_gene/EOG091G09RJ/ALICUT_EOG091G09RJ.clustalo.fasta EOG091G09RJ.fasta
        ProteinModelSelection.pl EOG091G09RJ.fasta 1> ../../../per_gene/EOG091G09RJ/EOG091G09RJ.best_model 2> ../../../per_gene/EOG091G09RJ/find_best_model.stderr.txt
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/c0c09ee657b1e27f2c5687e0e9aa8d70.simg
[Sun Jul  5 23:29:13 2020]
Finished job 1173.
2130 of 3292 steps (65%) done

[Sun Jul  5 23:29:13 2020]
rule remove_empty:
    input: per_gene/EOG091G0MDD/ALICUT_EOG091G0MDD.clustalo.fasta
    output: per_gene/EOG091G0MDD/empty_check.done
    jobid: 1995
    wildcards: BUSCO=EOG091G0MDD


         if [ "$(cat per_gene/EOG091G0MDD/ALICUT_EOG091G0MDD.clustalo.fasta | grep -v ">" | sed 's/-//g' | grep "^$" | wc -l)" -gt 0 ]
         then
              cp per_gene/EOG091G0MDD/ALICUT_EOG091G0MDD.clustalo.fasta per_gene/EOG091G0MDD/ALICUT_EOG091G0MDD.clustalo.fasta.backup
              bash ../scripts/remove_empty.sh per_gene/EOG091G0MDD/ALICUT_EOG091G0MDD.clustalo.fasta.backup > per_gene/EOG091G0MDD/ALICUT_EOG091G0MDD.clustalo.fasta
         fi
         touch per_gene/EOG091G0MDD/empty_check.done
         
[Sun Jul  5 23:29:13 2020]
Finished job 1995.
2131 of 3292 steps (65%) done

[Sun Jul  5 23:29:13 2020]
rule find_best_model:
    input: per_gene/EOG091G0MDD/ALICUT_EOG091G0MDD.clustalo.fasta, per_gene/EOG091G0MDD/empty_check.done
    output: per_gene/EOG091G0MDD/EOG091G0MDD.best_model
    log: per_gene/EOG091G0MDD/find_best_model.stderr.txt
    jobid: 1172
    wildcards: BUSCO=EOG091G0MDD
    threads: 2


        cd per_gene/EOG091G0MDD
        if [ ! -d find_best_model ]
        then
            mkdir find_best_model
        fi
        cd find_best_model
        ln -s ../../../per_gene/EOG091G0MDD/ALICUT_EOG091G0MDD.clustalo.fasta EOG091G0MDD.fasta
        ProteinModelSelection.pl EOG091G0MDD.fasta 1> ../../../per_gene/EOG091G0MDD/EOG091G0MDD.best_model 2> ../../../per_gene/EOG091G0MDD/find_best_model.stderr.txt
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/c0c09ee657b1e27f2c5687e0e9aa8d70.simg
[Sun Jul  5 23:29:15 2020]
Finished job 1145.
2132 of 3292 steps (65%) done

[Sun Jul  5 23:29:15 2020]
rule remove_empty:
    input: per_gene/EOG091G0HTU/ALICUT_EOG091G0HTU.clustalo.fasta
    output: per_gene/EOG091G0HTU/empty_check.done
    jobid: 1967
    wildcards: BUSCO=EOG091G0HTU


         if [ "$(cat per_gene/EOG091G0HTU/ALICUT_EOG091G0HTU.clustalo.fasta | grep -v ">" | sed 's/-//g' | grep "^$" | wc -l)" -gt 0 ]
         then
              cp per_gene/EOG091G0HTU/ALICUT_EOG091G0HTU.clustalo.fasta per_gene/EOG091G0HTU/ALICUT_EOG091G0HTU.clustalo.fasta.backup
              bash ../scripts/remove_empty.sh per_gene/EOG091G0HTU/ALICUT_EOG091G0HTU.clustalo.fasta.backup > per_gene/EOG091G0HTU/ALICUT_EOG091G0HTU.clustalo.fasta
         fi
         touch per_gene/EOG091G0HTU/empty_check.done
         
[Sun Jul  5 23:29:15 2020]
Finished job 1967.
2133 of 3292 steps (65%) done

[Sun Jul  5 23:29:15 2020]
rule find_best_model:
    input: per_gene/EOG091G0HTU/ALICUT_EOG091G0HTU.clustalo.fasta, per_gene/EOG091G0HTU/empty_check.done
    output: per_gene/EOG091G0HTU/EOG091G0HTU.best_model
    log: per_gene/EOG091G0HTU/find_best_model.stderr.txt
    jobid: 1144
    wildcards: BUSCO=EOG091G0HTU
    threads: 2


        cd per_gene/EOG091G0HTU
        if [ ! -d find_best_model ]
        then
            mkdir find_best_model
        fi
        cd find_best_model
        ln -s ../../../per_gene/EOG091G0HTU/ALICUT_EOG091G0HTU.clustalo.fasta EOG091G0HTU.fasta
        ProteinModelSelection.pl EOG091G0HTU.fasta 1> ../../../per_gene/EOG091G0HTU/EOG091G0HTU.best_model 2> ../../../per_gene/EOG091G0HTU/find_best_model.stderr.txt
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/c0c09ee657b1e27f2c5687e0e9aa8d70.simg
[Sun Jul  5 23:29:32 2020]
Finished job 102.
2134 of 3292 steps (65%) done

[Sun Jul  5 23:29:32 2020]
rule get_seqs:
    input: /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ingroup.txt, /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/outgroup.txt
    output: per_gene/EOG091G085U/EOG091G085U.ingroup.fasta
    log: per_gene/EOG091G085U/get_seqs.stdout.txt, per_gene/EOG091G085U/get_seqs.stderr.txt
    jobid: 2588
    wildcards: BUSCO=EOG091G085U
    threads: 2


	basedir=$(pwd)
        cd per_gene/EOG091G085U
        
        bash $basedir/../scripts/fetch_seqs.sh EOG091G085U /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ingroup.txt /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/outgroup.txt 1> ../../per_gene/EOG091G085U/get_seqs.stdout.txt 2> ../../per_gene/EOG091G085U/get_seqs.stderr.txt
	mv EOG091G085U.fasta $basedir/per_gene/EOG091G085U/EOG091G085U.ingroup.fasta
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/72476f9d9a5bd0627b4d721143a21354.simg
[Sun Jul  5 23:29:39 2020]
Finished job 554.
2135 of 3292 steps (65%) done

[Sun Jul  5 23:29:39 2020]
rule infer_single_ML:
    input: per_gene/EOG091G09RJ/EOG091G09RJ.best_model, per_gene/EOG091G09RJ/ALICUT_EOG091G09RJ.clustalo.fasta
    output: per_gene/EOG091G09RJ/EOG091G09RJ.raxml.done
    log: per_gene/EOG091G09RJ/infer_single_ML.stdout.txt, per_gene/EOG091G09RJ/infer_single_ML.stderr.txt
    jobid: 71
    wildcards: BUSCO=EOG091G09RJ
    threads: 2


        cd per_gene/EOG091G09RJ
	count=$(cat ../../per_gene/EOG091G09RJ/ALICUT_EOG091G09RJ.clustalo.fasta | grep ">" | wc -l)
	if [ "$count" -gt 5 ]
        then
		RAxMLmodel=$(cat ../../per_gene/EOG091G09RJ/EOG091G09RJ.best_model | grep "Best" | cut -d ":" -f 2 | tr -d '[:space:]')
                if [ "$(ls -1 | grep "^RAxML" | wc -l)" -ne 0 ]
		then
			rm RAxML*
		fi
        	raxml -f a -T 2 -m PROTGAMMA$RAxMLmodel         	-p 12345 -x 12345 -# 100         	-s ../../per_gene/EOG091G09RJ/ALICUT_EOG091G09RJ.clustalo.fasta -n EOG091G09RJ.clustalo.aln.ALICUT.$RAxMLmodel 		1> ../../per_gene/EOG091G09RJ/infer_single_ML.stdout.txt 2> ../../per_gene/EOG091G09RJ/infer_single_ML.stderr.txt
	else
		echo "fasta file per_gene/EOG091G09RJ/ALICUT_EOG091G09RJ.clustalo.fasta contains fewer than 5 sequences - skipped" > ../../per_gene/EOG091G09RJ/infer_single_ML.stdout.txt
		touch raxml.skipped
	fi
        touch ../../per_gene/EOG091G09RJ/EOG091G09RJ.raxml.done
        
[Sun Jul  5 23:29:45 2020]
Finished job 2588.
2136 of 3292 steps (65%) done

[Sun Jul  5 23:29:45 2020]
rule get_outgroups:
    input: per_gene/EOG091G085U/EOG091G085U.ingroup.fasta
    output: per_gene/EOG091G085U/EOG091G085U.orthodb.fasta, per_gene/EOG091G085U/EOG091G085U.outgroup.fasta
    log: per_gene/EOG091G085U/get_outgroups.stdout.txt, per_gene/EOG091G085U/get_outgroups.stderr.txt
    jobid: 2589
    wildcards: BUSCO=EOG091G085U


        #download fastas from Orhtodb for BUSCO id
        for i in {1..5}
        do
             wget "http://www.orthodb.org/fasta?query=EOG091G085U&level=33208" -O per_gene/EOG091G085U/EOG091G085U.orthodb.fasta 1> per_gene/EOG091G085U/get_outgroups.stdout.txt 2> per_gene/EOG091G085U/get_outgroups.stderr.txt && break || echo -e "try again ($i)" && sleep 15
        done

	#This is quick an dirty for now and just takes the first protein if there is more than one for an outgroup taxon
        bash ../scripts/download_outgroups.sh taxids.txt per_gene/EOG091G085U/EOG091G085U.orthodb.fasta > per_gene/EOG091G085U/EOG091G085U.outgroup.fasta
        
[Sun Jul  5 23:29:46 2020]
Finished job 1144.
2137 of 3292 steps (65%) done

[Sun Jul  5 23:29:46 2020]
rule infer_single_ML:
    input: per_gene/EOG091G0HTU/EOG091G0HTU.best_model, per_gene/EOG091G0HTU/ALICUT_EOG091G0HTU.clustalo.fasta
    output: per_gene/EOG091G0HTU/EOG091G0HTU.raxml.done
    log: per_gene/EOG091G0HTU/infer_single_ML.stdout.txt, per_gene/EOG091G0HTU/infer_single_ML.stderr.txt
    jobid: 366
    wildcards: BUSCO=EOG091G0HTU
    threads: 2


        cd per_gene/EOG091G0HTU
	count=$(cat ../../per_gene/EOG091G0HTU/ALICUT_EOG091G0HTU.clustalo.fasta | grep ">" | wc -l)
	if [ "$count" -gt 5 ]
        then
		RAxMLmodel=$(cat ../../per_gene/EOG091G0HTU/EOG091G0HTU.best_model | grep "Best" | cut -d ":" -f 2 | tr -d '[:space:]')
                if [ "$(ls -1 | grep "^RAxML" | wc -l)" -ne 0 ]
		then
			rm RAxML*
		fi
        	raxml -f a -T 2 -m PROTGAMMA$RAxMLmodel         	-p 12345 -x 12345 -# 100         	-s ../../per_gene/EOG091G0HTU/ALICUT_EOG091G0HTU.clustalo.fasta -n EOG091G0HTU.clustalo.aln.ALICUT.$RAxMLmodel 		1> ../../per_gene/EOG091G0HTU/infer_single_ML.stdout.txt 2> ../../per_gene/EOG091G0HTU/infer_single_ML.stderr.txt
	else
		echo "fasta file per_gene/EOG091G0HTU/ALICUT_EOG091G0HTU.clustalo.fasta contains fewer than 5 sequences - skipped" > ../../per_gene/EOG091G0HTU/infer_single_ML.stdout.txt
		touch raxml.skipped
	fi
        touch ../../per_gene/EOG091G0HTU/EOG091G0HTU.raxml.done
        
[Sun Jul  5 23:29:46 2020]
Finished job 2589.
2138 of 3292 steps (65%) done

[Sun Jul  5 23:29:46 2020]
rule join_groups:
    input: per_gene/EOG091G085U/EOG091G085U.ingroup.fasta, per_gene/EOG091G085U/EOG091G085U.outgroup.fasta
    output: per_gene/EOG091G085U/EOG091G085U.fasta
    jobid: 2118
    wildcards: BUSCO=EOG091G085U


        cat per_gene/EOG091G085U/EOG091G085U.ingroup.fasta per_gene/EOG091G085U/EOG091G085U.outgroup.fasta > per_gene/EOG091G085U/EOG091G085U.fasta
        
[Sun Jul  5 23:29:46 2020]
Finished job 2118.
2139 of 3292 steps (65%) done

[Sun Jul  5 23:29:46 2020]
rule MSA:
    input: per_gene/EOG091G085U/EOG091G085U.fasta
    output: per_gene/EOG091G085U/EOG091G085U.clustalo.fasta
    log: per_gene/EOG091G085U/MSA.stdout.txt, per_gene/EOG091G085U/MSA.stderr.txt
    jobid: 1356
    wildcards: BUSCO=EOG091G085U
    threads: 2


        clustalo -i per_gene/EOG091G085U/EOG091G085U.fasta -o per_gene/EOG091G085U/EOG091G085U.clustalo.fasta --threads=2 1> per_gene/EOG091G085U/MSA.stdout.txt 2> per_gene/EOG091G085U/MSA.stderr.txt
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/d68c9691725a7401923680874285c430.simg
[33mJob counts:
	count	jobs
	1	infer_single_ML
	1[0m
[33m
        cd per_gene/EOG091G09RJ
	count=$(cat ../../per_gene/EOG091G09RJ/ALICUT_EOG091G09RJ.clustalo.fasta | grep ">" | wc -l)
	if [ "$count" -gt 5 ]
        then
		RAxMLmodel=$(cat ../../per_gene/EOG091G09RJ/EOG091G09RJ.best_model | grep "Best" | cut -d ":" -f 2 | tr -d '[:space:]')
                if [ "$(ls -1 | grep "^RAxML" | wc -l)" -ne 0 ]
		then
			rm RAxML*
		fi
        	raxml -f a -T 2 -m PROTGAMMA$RAxMLmodel         	-p 12345 -x 12345 -# 100         	-s ../../per_gene/EOG091G09RJ/ALICUT_EOG091G09RJ.clustalo.fasta -n EOG091G09RJ.clustalo.aln.ALICUT.$RAxMLmodel 		1> ../../per_gene/EOG091G09RJ/infer_single_ML.stdout.txt 2> ../../per_gene/EOG091G09RJ/infer_single_ML.stderr.txt
	else
		echo "fasta file per_gene/EOG091G09RJ/ALICUT_EOG091G09RJ.clustalo.fasta contains fewer than 5 sequences - skipped" > ../../per_gene/EOG091G09RJ/infer_single_ML.stdout.txt
		touch raxml.skipped
	fi
        touch ../../per_gene/EOG091G09RJ/EOG091G09RJ.raxml.done
        [0m
[33mJob counts:
	count	jobs
	1	infer_single_ML
	1[0m
[33m
        cd per_gene/EOG091G0HTU
	count=$(cat ../../per_gene/EOG091G0HTU/ALICUT_EOG091G0HTU.clustalo.fasta | grep ">" | wc -l)
	if [ "$count" -gt 5 ]
        then
		RAxMLmodel=$(cat ../../per_gene/EOG091G0HTU/EOG091G0HTU.best_model | grep "Best" | cut -d ":" -f 2 | tr -d '[:space:]')
                if [ "$(ls -1 | grep "^RAxML" | wc -l)" -ne 0 ]
		then
			rm RAxML*
		fi
        	raxml -f a -T 2 -m PROTGAMMA$RAxMLmodel         	-p 12345 -x 12345 -# 100         	-s ../../per_gene/EOG091G0HTU/ALICUT_EOG091G0HTU.clustalo.fasta -n EOG091G0HTU.clustalo.aln.ALICUT.$RAxMLmodel 		1> ../../per_gene/EOG091G0HTU/infer_single_ML.stdout.txt 2> ../../per_gene/EOG091G0HTU/infer_single_ML.stderr.txt
	else
		echo "fasta file per_gene/EOG091G0HTU/ALICUT_EOG091G0HTU.clustalo.fasta contains fewer than 5 sequences - skipped" > ../../per_gene/EOG091G0HTU/infer_single_ML.stdout.txt
		touch raxml.skipped
	fi
        touch ../../per_gene/EOG091G0HTU/EOG091G0HTU.raxml.done
        [0m
[Sun Jul  5 23:29:49 2020]
Finished job 1356.
2140 of 3292 steps (65%) done

[Sun Jul  5 23:29:49 2020]
rule score_and_cut:
    input: per_gene/EOG091G085U/EOG091G085U.clustalo.fasta
    output: per_gene/EOG091G085U/ALICUT_EOG091G085U.clustalo.fasta
    jobid: 533
    wildcards: BUSCO=EOG091G085U
    threads: 2


        cd per_gene/EOG091G085U
        Aliscore.pl -N -r 200000000000000000 -i ../../per_gene/EOG091G085U/EOG091G085U.clustalo.fasta &> aliscore.log
        ALICUT.pl -s &> alicut.log
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/63c88c27a0fa300f57066b0ef65fefcb.simg
[Sun Jul  5 23:29:49 2020]
Finished job 1172.
2141 of 3292 steps (65%) done

[Sun Jul  5 23:29:49 2020]
rule infer_single_ML:
    input: per_gene/EOG091G0MDD/EOG091G0MDD.best_model, per_gene/EOG091G0MDD/ALICUT_EOG091G0MDD.clustalo.fasta
    output: per_gene/EOG091G0MDD/EOG091G0MDD.raxml.done
    log: per_gene/EOG091G0MDD/infer_single_ML.stdout.txt, per_gene/EOG091G0MDD/infer_single_ML.stderr.txt
    jobid: 380
    wildcards: BUSCO=EOG091G0MDD
    threads: 2


        cd per_gene/EOG091G0MDD
	count=$(cat ../../per_gene/EOG091G0MDD/ALICUT_EOG091G0MDD.clustalo.fasta | grep ">" | wc -l)
	if [ "$count" -gt 5 ]
        then
		RAxMLmodel=$(cat ../../per_gene/EOG091G0MDD/EOG091G0MDD.best_model | grep "Best" | cut -d ":" -f 2 | tr -d '[:space:]')
                if [ "$(ls -1 | grep "^RAxML" | wc -l)" -ne 0 ]
		then
			rm RAxML*
		fi
        	raxml -f a -T 2 -m PROTGAMMA$RAxMLmodel         	-p 12345 -x 12345 -# 100         	-s ../../per_gene/EOG091G0MDD/ALICUT_EOG091G0MDD.clustalo.fasta -n EOG091G0MDD.clustalo.aln.ALICUT.$RAxMLmodel 		1> ../../per_gene/EOG091G0MDD/infer_single_ML.stdout.txt 2> ../../per_gene/EOG091G0MDD/infer_single_ML.stderr.txt
	else
		echo "fasta file per_gene/EOG091G0MDD/ALICUT_EOG091G0MDD.clustalo.fasta contains fewer than 5 sequences - skipped" > ../../per_gene/EOG091G0MDD/infer_single_ML.stdout.txt
		touch raxml.skipped
	fi
        touch ../../per_gene/EOG091G0MDD/EOG091G0MDD.raxml.done
        
[33mJob counts:
	count	jobs
	1	infer_single_ML
	1[0m
[33m
        cd per_gene/EOG091G0MDD
	count=$(cat ../../per_gene/EOG091G0MDD/ALICUT_EOG091G0MDD.clustalo.fasta | grep ">" | wc -l)
	if [ "$count" -gt 5 ]
        then
		RAxMLmodel=$(cat ../../per_gene/EOG091G0MDD/EOG091G0MDD.best_model | grep "Best" | cut -d ":" -f 2 | tr -d '[:space:]')
                if [ "$(ls -1 | grep "^RAxML" | wc -l)" -ne 0 ]
		then
			rm RAxML*
		fi
        	raxml -f a -T 2 -m PROTGAMMA$RAxMLmodel         	-p 12345 -x 12345 -# 100         	-s ../../per_gene/EOG091G0MDD/ALICUT_EOG091G0MDD.clustalo.fasta -n EOG091G0MDD.clustalo.aln.ALICUT.$RAxMLmodel 		1> ../../per_gene/EOG091G0MDD/infer_single_ML.stdout.txt 2> ../../per_gene/EOG091G0MDD/infer_single_ML.stderr.txt
	else
		echo "fasta file per_gene/EOG091G0MDD/ALICUT_EOG091G0MDD.clustalo.fasta contains fewer than 5 sequences - skipped" > ../../per_gene/EOG091G0MDD/infer_single_ML.stdout.txt
		touch raxml.skipped
	fi
        touch ../../per_gene/EOG091G0MDD/EOG091G0MDD.raxml.done
        [0m
[Sun Jul  5 23:30:00 2020]
Finished job 533.
2142 of 3292 steps (65%) done

[Sun Jul  5 23:30:00 2020]
rule remove_empty:
    input: per_gene/EOG091G085U/ALICUT_EOG091G085U.clustalo.fasta
    output: per_gene/EOG091G085U/empty_check.done
    jobid: 1355
    wildcards: BUSCO=EOG091G085U


         if [ "$(cat per_gene/EOG091G085U/ALICUT_EOG091G085U.clustalo.fasta | grep -v ">" | sed 's/-//g' | grep "^$" | wc -l)" -gt 0 ]
         then
              cp per_gene/EOG091G085U/ALICUT_EOG091G085U.clustalo.fasta per_gene/EOG091G085U/ALICUT_EOG091G085U.clustalo.fasta.backup
              bash ../scripts/remove_empty.sh per_gene/EOG091G085U/ALICUT_EOG091G085U.clustalo.fasta.backup > per_gene/EOG091G085U/ALICUT_EOG091G085U.clustalo.fasta
         fi
         touch per_gene/EOG091G085U/empty_check.done
         
[Sun Jul  5 23:30:00 2020]
Finished job 1355.
2143 of 3292 steps (65%) done

[Sun Jul  5 23:30:00 2020]
rule find_best_model:
    input: per_gene/EOG091G085U/ALICUT_EOG091G085U.clustalo.fasta, per_gene/EOG091G085U/empty_check.done
    output: per_gene/EOG091G085U/EOG091G085U.best_model
    log: per_gene/EOG091G085U/find_best_model.stderr.txt
    jobid: 532
    wildcards: BUSCO=EOG091G085U
    threads: 2


        cd per_gene/EOG091G085U
        if [ ! -d find_best_model ]
        then
            mkdir find_best_model
        fi
        cd find_best_model
        ln -s ../../../per_gene/EOG091G085U/ALICUT_EOG091G085U.clustalo.fasta EOG091G085U.fasta
        ProteinModelSelection.pl EOG091G085U.fasta 1> ../../../per_gene/EOG091G085U/EOG091G085U.best_model 2> ../../../per_gene/EOG091G085U/find_best_model.stderr.txt
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/c0c09ee657b1e27f2c5687e0e9aa8d70.simg
[Sun Jul  5 23:30:33 2020]
Finished job 402.
2144 of 3292 steps (65%) done

[Sun Jul  5 23:30:33 2020]
rule get_seqs:
    input: /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ingroup.txt, /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/outgroup.txt
    output: per_gene/EOG091G0MVL/EOG091G0MVL.ingroup.fasta
    log: per_gene/EOG091G0MVL/get_seqs.stdout.txt, per_gene/EOG091G0MVL/get_seqs.stderr.txt
    jobid: 2772
    wildcards: BUSCO=EOG091G0MVL
    threads: 2


	basedir=$(pwd)
        cd per_gene/EOG091G0MVL
        
        bash $basedir/../scripts/fetch_seqs.sh EOG091G0MVL /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ingroup.txt /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/outgroup.txt 1> ../../per_gene/EOG091G0MVL/get_seqs.stdout.txt 2> ../../per_gene/EOG091G0MVL/get_seqs.stderr.txt
	mv EOG091G0MVL.fasta $basedir/per_gene/EOG091G0MVL/EOG091G0MVL.ingroup.fasta
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/72476f9d9a5bd0627b4d721143a21354.simg
[Sun Jul  5 23:30:47 2020]
Finished job 532.
2145 of 3292 steps (65%) done

[Sun Jul  5 23:30:47 2020]
rule infer_single_ML:
    input: per_gene/EOG091G085U/EOG091G085U.best_model, per_gene/EOG091G085U/ALICUT_EOG091G085U.clustalo.fasta
    output: per_gene/EOG091G085U/EOG091G085U.raxml.done
    log: per_gene/EOG091G085U/infer_single_ML.stdout.txt, per_gene/EOG091G085U/infer_single_ML.stderr.txt
    jobid: 60
    wildcards: BUSCO=EOG091G085U
    threads: 2


        cd per_gene/EOG091G085U
	count=$(cat ../../per_gene/EOG091G085U/ALICUT_EOG091G085U.clustalo.fasta | grep ">" | wc -l)
	if [ "$count" -gt 5 ]
        then
		RAxMLmodel=$(cat ../../per_gene/EOG091G085U/EOG091G085U.best_model | grep "Best" | cut -d ":" -f 2 | tr -d '[:space:]')
                if [ "$(ls -1 | grep "^RAxML" | wc -l)" -ne 0 ]
		then
			rm RAxML*
		fi
        	raxml -f a -T 2 -m PROTGAMMA$RAxMLmodel         	-p 12345 -x 12345 -# 100         	-s ../../per_gene/EOG091G085U/ALICUT_EOG091G085U.clustalo.fasta -n EOG091G085U.clustalo.aln.ALICUT.$RAxMLmodel 		1> ../../per_gene/EOG091G085U/infer_single_ML.stdout.txt 2> ../../per_gene/EOG091G085U/infer_single_ML.stderr.txt
	else
		echo "fasta file per_gene/EOG091G085U/ALICUT_EOG091G085U.clustalo.fasta contains fewer than 5 sequences - skipped" > ../../per_gene/EOG091G085U/infer_single_ML.stdout.txt
		touch raxml.skipped
	fi
        touch ../../per_gene/EOG091G085U/EOG091G085U.raxml.done
        
[Sun Jul  5 23:30:47 2020]
Finished job 2772.
2146 of 3292 steps (65%) done

[Sun Jul  5 23:30:47 2020]
rule get_outgroups:
    input: per_gene/EOG091G0MVL/EOG091G0MVL.ingroup.fasta
    output: per_gene/EOG091G0MVL/EOG091G0MVL.orthodb.fasta, per_gene/EOG091G0MVL/EOG091G0MVL.outgroup.fasta
    log: per_gene/EOG091G0MVL/get_outgroups.stdout.txt, per_gene/EOG091G0MVL/get_outgroups.stderr.txt
    jobid: 2773
    wildcards: BUSCO=EOG091G0MVL


        #download fastas from Orhtodb for BUSCO id
        for i in {1..5}
        do
             wget "http://www.orthodb.org/fasta?query=EOG091G0MVL&level=33208" -O per_gene/EOG091G0MVL/EOG091G0MVL.orthodb.fasta 1> per_gene/EOG091G0MVL/get_outgroups.stdout.txt 2> per_gene/EOG091G0MVL/get_outgroups.stderr.txt && break || echo -e "try again ($i)" && sleep 15
        done

	#This is quick an dirty for now and just takes the first protein if there is more than one for an outgroup taxon
        bash ../scripts/download_outgroups.sh taxids.txt per_gene/EOG091G0MVL/EOG091G0MVL.orthodb.fasta > per_gene/EOG091G0MVL/EOG091G0MVL.outgroup.fasta
        
[Sun Jul  5 23:30:48 2020]
Finished job 2773.
2147 of 3292 steps (65%) done

[Sun Jul  5 23:30:48 2020]
rule join_groups:
    input: per_gene/EOG091G0MVL/EOG091G0MVL.ingroup.fasta, per_gene/EOG091G0MVL/EOG091G0MVL.outgroup.fasta
    output: per_gene/EOG091G0MVL/EOG091G0MVL.fasta
    jobid: 2210
    wildcards: BUSCO=EOG091G0MVL


        cat per_gene/EOG091G0MVL/EOG091G0MVL.ingroup.fasta per_gene/EOG091G0MVL/EOG091G0MVL.outgroup.fasta > per_gene/EOG091G0MVL/EOG091G0MVL.fasta
        
[Sun Jul  5 23:30:48 2020]
Finished job 2210.
2148 of 3292 steps (65%) done

[Sun Jul  5 23:30:48 2020]
rule MSA:
    input: per_gene/EOG091G0MVL/EOG091G0MVL.fasta
    output: per_gene/EOG091G0MVL/EOG091G0MVL.clustalo.fasta
    log: per_gene/EOG091G0MVL/MSA.stdout.txt, per_gene/EOG091G0MVL/MSA.stderr.txt
    jobid: 1540
    wildcards: BUSCO=EOG091G0MVL
    threads: 2


        clustalo -i per_gene/EOG091G0MVL/EOG091G0MVL.fasta -o per_gene/EOG091G0MVL/EOG091G0MVL.clustalo.fasta --threads=2 1> per_gene/EOG091G0MVL/MSA.stdout.txt 2> per_gene/EOG091G0MVL/MSA.stderr.txt
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/d68c9691725a7401923680874285c430.simg
[Sun Jul  5 23:30:49 2020]
Finished job 1540.
2149 of 3292 steps (65%) done

[Sun Jul  5 23:30:49 2020]
rule score_and_cut:
    input: per_gene/EOG091G0MVL/EOG091G0MVL.clustalo.fasta
    output: per_gene/EOG091G0MVL/ALICUT_EOG091G0MVL.clustalo.fasta
    jobid: 717
    wildcards: BUSCO=EOG091G0MVL
    threads: 2


        cd per_gene/EOG091G0MVL
        Aliscore.pl -N -r 200000000000000000 -i ../../per_gene/EOG091G0MVL/EOG091G0MVL.clustalo.fasta &> aliscore.log
        ALICUT.pl -s &> alicut.log
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/63c88c27a0fa300f57066b0ef65fefcb.simg
[33mJob counts:
	count	jobs
	1	infer_single_ML
	1[0m
[33m
        cd per_gene/EOG091G085U
	count=$(cat ../../per_gene/EOG091G085U/ALICUT_EOG091G085U.clustalo.fasta | grep ">" | wc -l)
	if [ "$count" -gt 5 ]
        then
		RAxMLmodel=$(cat ../../per_gene/EOG091G085U/EOG091G085U.best_model | grep "Best" | cut -d ":" -f 2 | tr -d '[:space:]')
                if [ "$(ls -1 | grep "^RAxML" | wc -l)" -ne 0 ]
		then
			rm RAxML*
		fi
        	raxml -f a -T 2 -m PROTGAMMA$RAxMLmodel         	-p 12345 -x 12345 -# 100         	-s ../../per_gene/EOG091G085U/ALICUT_EOG091G085U.clustalo.fasta -n EOG091G085U.clustalo.aln.ALICUT.$RAxMLmodel 		1> ../../per_gene/EOG091G085U/infer_single_ML.stdout.txt 2> ../../per_gene/EOG091G085U/infer_single_ML.stderr.txt
	else
		echo "fasta file per_gene/EOG091G085U/ALICUT_EOG091G085U.clustalo.fasta contains fewer than 5 sequences - skipped" > ../../per_gene/EOG091G085U/infer_single_ML.stdout.txt
		touch raxml.skipped
	fi
        touch ../../per_gene/EOG091G085U/EOG091G085U.raxml.done
        [0m
[Sun Jul  5 23:31:00 2020]
Finished job 717.
2150 of 3292 steps (65%) done

[Sun Jul  5 23:31:00 2020]
rule remove_empty:
    input: per_gene/EOG091G0MVL/ALICUT_EOG091G0MVL.clustalo.fasta
    output: per_gene/EOG091G0MVL/empty_check.done
    jobid: 1539
    wildcards: BUSCO=EOG091G0MVL


         if [ "$(cat per_gene/EOG091G0MVL/ALICUT_EOG091G0MVL.clustalo.fasta | grep -v ">" | sed 's/-//g' | grep "^$" | wc -l)" -gt 0 ]
         then
              cp per_gene/EOG091G0MVL/ALICUT_EOG091G0MVL.clustalo.fasta per_gene/EOG091G0MVL/ALICUT_EOG091G0MVL.clustalo.fasta.backup
              bash ../scripts/remove_empty.sh per_gene/EOG091G0MVL/ALICUT_EOG091G0MVL.clustalo.fasta.backup > per_gene/EOG091G0MVL/ALICUT_EOG091G0MVL.clustalo.fasta
         fi
         touch per_gene/EOG091G0MVL/empty_check.done
         
[Sun Jul  5 23:31:00 2020]
Finished job 1539.
2151 of 3292 steps (65%) done

[Sun Jul  5 23:31:00 2020]
rule find_best_model:
    input: per_gene/EOG091G0MVL/ALICUT_EOG091G0MVL.clustalo.fasta, per_gene/EOG091G0MVL/empty_check.done
    output: per_gene/EOG091G0MVL/EOG091G0MVL.best_model
    log: per_gene/EOG091G0MVL/find_best_model.stderr.txt
    jobid: 716
    wildcards: BUSCO=EOG091G0MVL
    threads: 2


        cd per_gene/EOG091G0MVL
        if [ ! -d find_best_model ]
        then
            mkdir find_best_model
        fi
        cd find_best_model
        ln -s ../../../per_gene/EOG091G0MVL/ALICUT_EOG091G0MVL.clustalo.fasta EOG091G0MVL.fasta
        ProteinModelSelection.pl EOG091G0MVL.fasta 1> ../../../per_gene/EOG091G0MVL/EOG091G0MVL.best_model 2> ../../../per_gene/EOG091G0MVL/find_best_model.stderr.txt
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/c0c09ee657b1e27f2c5687e0e9aa8d70.simg
[Sun Jul  5 23:31:35 2020]
Finished job 16.
2152 of 3292 steps (65%) done

[Sun Jul  5 23:31:35 2020]
rule get_seqs:
    input: /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ingroup.txt, /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/outgroup.txt
    output: per_gene/EOG091G126R/EOG091G126R.ingroup.fasta
    log: per_gene/EOG091G126R/get_seqs.stdout.txt, per_gene/EOG091G126R/get_seqs.stderr.txt
    jobid: 3290
    wildcards: BUSCO=EOG091G126R
    threads: 2


	basedir=$(pwd)
        cd per_gene/EOG091G126R
        
        bash $basedir/../scripts/fetch_seqs.sh EOG091G126R /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ingroup.txt /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/outgroup.txt 1> ../../per_gene/EOG091G126R/get_seqs.stdout.txt 2> ../../per_gene/EOG091G126R/get_seqs.stderr.txt
	mv EOG091G126R.fasta $basedir/per_gene/EOG091G126R/EOG091G126R.ingroup.fasta
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/72476f9d9a5bd0627b4d721143a21354.simg
[Sun Jul  5 23:31:40 2020]
Finished job 716.
2153 of 3292 steps (65%) done

[Sun Jul  5 23:31:40 2020]
rule infer_single_ML:
    input: per_gene/EOG091G0MVL/EOG091G0MVL.best_model, per_gene/EOG091G0MVL/ALICUT_EOG091G0MVL.clustalo.fasta
    output: per_gene/EOG091G0MVL/EOG091G0MVL.raxml.done
    log: per_gene/EOG091G0MVL/infer_single_ML.stdout.txt, per_gene/EOG091G0MVL/infer_single_ML.stderr.txt
    jobid: 152
    wildcards: BUSCO=EOG091G0MVL
    threads: 2


        cd per_gene/EOG091G0MVL
	count=$(cat ../../per_gene/EOG091G0MVL/ALICUT_EOG091G0MVL.clustalo.fasta | grep ">" | wc -l)
	if [ "$count" -gt 5 ]
        then
		RAxMLmodel=$(cat ../../per_gene/EOG091G0MVL/EOG091G0MVL.best_model | grep "Best" | cut -d ":" -f 2 | tr -d '[:space:]')
                if [ "$(ls -1 | grep "^RAxML" | wc -l)" -ne 0 ]
		then
			rm RAxML*
		fi
        	raxml -f a -T 2 -m PROTGAMMA$RAxMLmodel         	-p 12345 -x 12345 -# 100         	-s ../../per_gene/EOG091G0MVL/ALICUT_EOG091G0MVL.clustalo.fasta -n EOG091G0MVL.clustalo.aln.ALICUT.$RAxMLmodel 		1> ../../per_gene/EOG091G0MVL/infer_single_ML.stdout.txt 2> ../../per_gene/EOG091G0MVL/infer_single_ML.stderr.txt
	else
		echo "fasta file per_gene/EOG091G0MVL/ALICUT_EOG091G0MVL.clustalo.fasta contains fewer than 5 sequences - skipped" > ../../per_gene/EOG091G0MVL/infer_single_ML.stdout.txt
		touch raxml.skipped
	fi
        touch ../../per_gene/EOG091G0MVL/EOG091G0MVL.raxml.done
        
[33mJob counts:
	count	jobs
	1	infer_single_ML
	1[0m
[33m
        cd per_gene/EOG091G0MVL
	count=$(cat ../../per_gene/EOG091G0MVL/ALICUT_EOG091G0MVL.clustalo.fasta | grep ">" | wc -l)
	if [ "$count" -gt 5 ]
        then
		RAxMLmodel=$(cat ../../per_gene/EOG091G0MVL/EOG091G0MVL.best_model | grep "Best" | cut -d ":" -f 2 | tr -d '[:space:]')
                if [ "$(ls -1 | grep "^RAxML" | wc -l)" -ne 0 ]
		then
			rm RAxML*
		fi
        	raxml -f a -T 2 -m PROTGAMMA$RAxMLmodel         	-p 12345 -x 12345 -# 100         	-s ../../per_gene/EOG091G0MVL/ALICUT_EOG091G0MVL.clustalo.fasta -n EOG091G0MVL.clustalo.aln.ALICUT.$RAxMLmodel 		1> ../../per_gene/EOG091G0MVL/infer_single_ML.stdout.txt 2> ../../per_gene/EOG091G0MVL/infer_single_ML.stderr.txt
	else
		echo "fasta file per_gene/EOG091G0MVL/ALICUT_EOG091G0MVL.clustalo.fasta contains fewer than 5 sequences - skipped" > ../../per_gene/EOG091G0MVL/infer_single_ML.stdout.txt
		touch raxml.skipped
	fi
        touch ../../per_gene/EOG091G0MVL/EOG091G0MVL.raxml.done
        [0m
[Sun Jul  5 23:31:48 2020]
Finished job 3290.
2154 of 3292 steps (65%) done

[Sun Jul  5 23:31:48 2020]
rule get_outgroups:
    input: per_gene/EOG091G126R/EOG091G126R.ingroup.fasta
    output: per_gene/EOG091G126R/EOG091G126R.orthodb.fasta, per_gene/EOG091G126R/EOG091G126R.outgroup.fasta
    log: per_gene/EOG091G126R/get_outgroups.stdout.txt, per_gene/EOG091G126R/get_outgroups.stderr.txt
    jobid: 3291
    wildcards: BUSCO=EOG091G126R


        #download fastas from Orhtodb for BUSCO id
        for i in {1..5}
        do
             wget "http://www.orthodb.org/fasta?query=EOG091G126R&level=33208" -O per_gene/EOG091G126R/EOG091G126R.orthodb.fasta 1> per_gene/EOG091G126R/get_outgroups.stdout.txt 2> per_gene/EOG091G126R/get_outgroups.stderr.txt && break || echo -e "try again ($i)" && sleep 15
        done

	#This is quick an dirty for now and just takes the first protein if there is more than one for an outgroup taxon
        bash ../scripts/download_outgroups.sh taxids.txt per_gene/EOG091G126R/EOG091G126R.orthodb.fasta > per_gene/EOG091G126R/EOG091G126R.outgroup.fasta
        
[Sun Jul  5 23:31:49 2020]
Finished job 3291.
2155 of 3292 steps (65%) done

[Sun Jul  5 23:31:49 2020]
rule join_groups:
    input: per_gene/EOG091G126R/EOG091G126R.ingroup.fasta, per_gene/EOG091G126R/EOG091G126R.outgroup.fasta
    output: per_gene/EOG091G126R/EOG091G126R.fasta
    jobid: 2469
    wildcards: BUSCO=EOG091G126R


        cat per_gene/EOG091G126R/EOG091G126R.ingroup.fasta per_gene/EOG091G126R/EOG091G126R.outgroup.fasta > per_gene/EOG091G126R/EOG091G126R.fasta
        
[Sun Jul  5 23:31:49 2020]
Finished job 2469.
2156 of 3292 steps (65%) done

[Sun Jul  5 23:31:49 2020]
rule MSA:
    input: per_gene/EOG091G126R/EOG091G126R.fasta
    output: per_gene/EOG091G126R/EOG091G126R.clustalo.fasta
    log: per_gene/EOG091G126R/MSA.stdout.txt, per_gene/EOG091G126R/MSA.stderr.txt
    jobid: 2058
    wildcards: BUSCO=EOG091G126R
    threads: 2


        clustalo -i per_gene/EOG091G126R/EOG091G126R.fasta -o per_gene/EOG091G126R/EOG091G126R.clustalo.fasta --threads=2 1> per_gene/EOG091G126R/MSA.stdout.txt 2> per_gene/EOG091G126R/MSA.stderr.txt
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/d68c9691725a7401923680874285c430.simg
[Sun Jul  5 23:31:50 2020]
Finished job 2058.
2157 of 3292 steps (66%) done

[Sun Jul  5 23:31:50 2020]
rule score_and_cut:
    input: per_gene/EOG091G126R/EOG091G126R.clustalo.fasta
    output: per_gene/EOG091G126R/ALICUT_EOG091G126R.clustalo.fasta
    jobid: 1235
    wildcards: BUSCO=EOG091G126R
    threads: 2


        cd per_gene/EOG091G126R
        Aliscore.pl -N -r 200000000000000000 -i ../../per_gene/EOG091G126R/EOG091G126R.clustalo.fasta &> aliscore.log
        ALICUT.pl -s &> alicut.log
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/63c88c27a0fa300f57066b0ef65fefcb.simg
[Sun Jul  5 23:32:01 2020]
Finished job 1235.
2158 of 3292 steps (66%) done

[Sun Jul  5 23:32:01 2020]
rule remove_empty:
    input: per_gene/EOG091G126R/ALICUT_EOG091G126R.clustalo.fasta
    output: per_gene/EOG091G126R/empty_check.done
    jobid: 2057
    wildcards: BUSCO=EOG091G126R


         if [ "$(cat per_gene/EOG091G126R/ALICUT_EOG091G126R.clustalo.fasta | grep -v ">" | sed 's/-//g' | grep "^$" | wc -l)" -gt 0 ]
         then
              cp per_gene/EOG091G126R/ALICUT_EOG091G126R.clustalo.fasta per_gene/EOG091G126R/ALICUT_EOG091G126R.clustalo.fasta.backup
              bash ../scripts/remove_empty.sh per_gene/EOG091G126R/ALICUT_EOG091G126R.clustalo.fasta.backup > per_gene/EOG091G126R/ALICUT_EOG091G126R.clustalo.fasta
         fi
         touch per_gene/EOG091G126R/empty_check.done
         
[Sun Jul  5 23:32:01 2020]
Finished job 2057.
2159 of 3292 steps (66%) done

[Sun Jul  5 23:32:01 2020]
rule find_best_model:
    input: per_gene/EOG091G126R/ALICUT_EOG091G126R.clustalo.fasta, per_gene/EOG091G126R/empty_check.done
    output: per_gene/EOG091G126R/EOG091G126R.best_model
    log: per_gene/EOG091G126R/find_best_model.stderr.txt
    jobid: 1234
    wildcards: BUSCO=EOG091G126R
    threads: 2


        cd per_gene/EOG091G126R
        if [ ! -d find_best_model ]
        then
            mkdir find_best_model
        fi
        cd find_best_model
        ln -s ../../../per_gene/EOG091G126R/ALICUT_EOG091G126R.clustalo.fasta EOG091G126R.fasta
        ProteinModelSelection.pl EOG091G126R.fasta 1> ../../../per_gene/EOG091G126R/EOG091G126R.best_model 2> ../../../per_gene/EOG091G126R/find_best_model.stderr.txt
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/c0c09ee657b1e27f2c5687e0e9aa8d70.simg
[Sun Jul  5 23:32:21 2020]
Finished job 344.
2160 of 3292 steps (66%) done

[Sun Jul  5 23:32:21 2020]
rule get_seqs:
    input: /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ingroup.txt, /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/outgroup.txt
    output: per_gene/EOG091G0EHZ/EOG091G0EHZ.ingroup.fasta
    log: per_gene/EOG091G0EHZ/get_seqs.stdout.txt, per_gene/EOG091G0EHZ/get_seqs.stderr.txt
    jobid: 2670
    wildcards: BUSCO=EOG091G0EHZ
    threads: 2


	basedir=$(pwd)
        cd per_gene/EOG091G0EHZ
        
        bash $basedir/../scripts/fetch_seqs.sh EOG091G0EHZ /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ingroup.txt /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/outgroup.txt 1> ../../per_gene/EOG091G0EHZ/get_seqs.stdout.txt 2> ../../per_gene/EOG091G0EHZ/get_seqs.stderr.txt
	mv EOG091G0EHZ.fasta $basedir/per_gene/EOG091G0EHZ/EOG091G0EHZ.ingroup.fasta
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/72476f9d9a5bd0627b4d721143a21354.simg
[Sun Jul  5 23:32:26 2020]
Finished job 1234.
2161 of 3292 steps (66%) done

[Sun Jul  5 23:32:26 2020]
rule infer_single_ML:
    input: per_gene/EOG091G126R/EOG091G126R.best_model, per_gene/EOG091G126R/ALICUT_EOG091G126R.clustalo.fasta
    output: per_gene/EOG091G126R/EOG091G126R.raxml.done
    log: per_gene/EOG091G126R/infer_single_ML.stdout.txt, per_gene/EOG091G126R/infer_single_ML.stderr.txt
    jobid: 411
    wildcards: BUSCO=EOG091G126R
    threads: 2


        cd per_gene/EOG091G126R
	count=$(cat ../../per_gene/EOG091G126R/ALICUT_EOG091G126R.clustalo.fasta | grep ">" | wc -l)
	if [ "$count" -gt 5 ]
        then
		RAxMLmodel=$(cat ../../per_gene/EOG091G126R/EOG091G126R.best_model | grep "Best" | cut -d ":" -f 2 | tr -d '[:space:]')
                if [ "$(ls -1 | grep "^RAxML" | wc -l)" -ne 0 ]
		then
			rm RAxML*
		fi
        	raxml -f a -T 2 -m PROTGAMMA$RAxMLmodel         	-p 12345 -x 12345 -# 100         	-s ../../per_gene/EOG091G126R/ALICUT_EOG091G126R.clustalo.fasta -n EOG091G126R.clustalo.aln.ALICUT.$RAxMLmodel 		1> ../../per_gene/EOG091G126R/infer_single_ML.stdout.txt 2> ../../per_gene/EOG091G126R/infer_single_ML.stderr.txt
	else
		echo "fasta file per_gene/EOG091G126R/ALICUT_EOG091G126R.clustalo.fasta contains fewer than 5 sequences - skipped" > ../../per_gene/EOG091G126R/infer_single_ML.stdout.txt
		touch raxml.skipped
	fi
        touch ../../per_gene/EOG091G126R/EOG091G126R.raxml.done
        
[33mJob counts:
	count	jobs
	1	infer_single_ML
	1[0m
[33m
        cd per_gene/EOG091G126R
	count=$(cat ../../per_gene/EOG091G126R/ALICUT_EOG091G126R.clustalo.fasta | grep ">" | wc -l)
	if [ "$count" -gt 5 ]
        then
		RAxMLmodel=$(cat ../../per_gene/EOG091G126R/EOG091G126R.best_model | grep "Best" | cut -d ":" -f 2 | tr -d '[:space:]')
                if [ "$(ls -1 | grep "^RAxML" | wc -l)" -ne 0 ]
		then
			rm RAxML*
		fi
        	raxml -f a -T 2 -m PROTGAMMA$RAxMLmodel         	-p 12345 -x 12345 -# 100         	-s ../../per_gene/EOG091G126R/ALICUT_EOG091G126R.clustalo.fasta -n EOG091G126R.clustalo.aln.ALICUT.$RAxMLmodel 		1> ../../per_gene/EOG091G126R/infer_single_ML.stdout.txt 2> ../../per_gene/EOG091G126R/infer_single_ML.stderr.txt
	else
		echo "fasta file per_gene/EOG091G126R/ALICUT_EOG091G126R.clustalo.fasta contains fewer than 5 sequences - skipped" > ../../per_gene/EOG091G126R/infer_single_ML.stdout.txt
		touch raxml.skipped
	fi
        touch ../../per_gene/EOG091G126R/EOG091G126R.raxml.done
        [0m
[Sun Jul  5 23:32:32 2020]
Finished job 335.
2162 of 3292 steps (66%) done

[Sun Jul  5 23:32:32 2020]
rule get_seqs:
    input: /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ingroup.txt, /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/outgroup.txt
    output: per_gene/EOG091G0QPG/EOG091G0QPG.ingroup.fasta
    log: per_gene/EOG091G0QPG/get_seqs.stdout.txt, per_gene/EOG091G0QPG/get_seqs.stderr.txt
    jobid: 2818
    wildcards: BUSCO=EOG091G0QPG
    threads: 2


	basedir=$(pwd)
        cd per_gene/EOG091G0QPG
        
        bash $basedir/../scripts/fetch_seqs.sh EOG091G0QPG /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ingroup.txt /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/outgroup.txt 1> ../../per_gene/EOG091G0QPG/get_seqs.stdout.txt 2> ../../per_gene/EOG091G0QPG/get_seqs.stderr.txt
	mv EOG091G0QPG.fasta $basedir/per_gene/EOG091G0QPG/EOG091G0QPG.ingroup.fasta
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/72476f9d9a5bd0627b4d721143a21354.simg
[Sun Jul  5 23:32:36 2020]
Finished job 2670.
2163 of 3292 steps (66%) done

[Sun Jul  5 23:32:36 2020]
rule get_outgroups:
    input: per_gene/EOG091G0EHZ/EOG091G0EHZ.ingroup.fasta
    output: per_gene/EOG091G0EHZ/EOG091G0EHZ.orthodb.fasta, per_gene/EOG091G0EHZ/EOG091G0EHZ.outgroup.fasta
    log: per_gene/EOG091G0EHZ/get_outgroups.stdout.txt, per_gene/EOG091G0EHZ/get_outgroups.stderr.txt
    jobid: 2671
    wildcards: BUSCO=EOG091G0EHZ


        #download fastas from Orhtodb for BUSCO id
        for i in {1..5}
        do
             wget "http://www.orthodb.org/fasta?query=EOG091G0EHZ&level=33208" -O per_gene/EOG091G0EHZ/EOG091G0EHZ.orthodb.fasta 1> per_gene/EOG091G0EHZ/get_outgroups.stdout.txt 2> per_gene/EOG091G0EHZ/get_outgroups.stderr.txt && break || echo -e "try again ($i)" && sleep 15
        done

	#This is quick an dirty for now and just takes the first protein if there is more than one for an outgroup taxon
        bash ../scripts/download_outgroups.sh taxids.txt per_gene/EOG091G0EHZ/EOG091G0EHZ.orthodb.fasta > per_gene/EOG091G0EHZ/EOG091G0EHZ.outgroup.fasta
        
[Sun Jul  5 23:32:37 2020]
Finished job 2671.
2164 of 3292 steps (66%) done

[Sun Jul  5 23:32:38 2020]
rule join_groups:
    input: per_gene/EOG091G0EHZ/EOG091G0EHZ.ingroup.fasta, per_gene/EOG091G0EHZ/EOG091G0EHZ.outgroup.fasta
    output: per_gene/EOG091G0EHZ/EOG091G0EHZ.fasta
    jobid: 2159
    wildcards: BUSCO=EOG091G0EHZ


        cat per_gene/EOG091G0EHZ/EOG091G0EHZ.ingroup.fasta per_gene/EOG091G0EHZ/EOG091G0EHZ.outgroup.fasta > per_gene/EOG091G0EHZ/EOG091G0EHZ.fasta
        
[Sun Jul  5 23:32:38 2020]
Finished job 2159.
2165 of 3292 steps (66%) done

[Sun Jul  5 23:32:38 2020]
rule MSA:
    input: per_gene/EOG091G0EHZ/EOG091G0EHZ.fasta
    output: per_gene/EOG091G0EHZ/EOG091G0EHZ.clustalo.fasta
    log: per_gene/EOG091G0EHZ/MSA.stdout.txt, per_gene/EOG091G0EHZ/MSA.stderr.txt
    jobid: 1438
    wildcards: BUSCO=EOG091G0EHZ
    threads: 2


        clustalo -i per_gene/EOG091G0EHZ/EOG091G0EHZ.fasta -o per_gene/EOG091G0EHZ/EOG091G0EHZ.clustalo.fasta --threads=2 1> per_gene/EOG091G0EHZ/MSA.stdout.txt 2> per_gene/EOG091G0EHZ/MSA.stderr.txt
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/d68c9691725a7401923680874285c430.simg
[Sun Jul  5 23:32:38 2020]
Finished job 1438.
2166 of 3292 steps (66%) done

[Sun Jul  5 23:32:38 2020]
rule score_and_cut:
    input: per_gene/EOG091G0EHZ/EOG091G0EHZ.clustalo.fasta
    output: per_gene/EOG091G0EHZ/ALICUT_EOG091G0EHZ.clustalo.fasta
    jobid: 615
    wildcards: BUSCO=EOG091G0EHZ
    threads: 2


        cd per_gene/EOG091G0EHZ
        Aliscore.pl -N -r 200000000000000000 -i ../../per_gene/EOG091G0EHZ/EOG091G0EHZ.clustalo.fasta &> aliscore.log
        ALICUT.pl -s &> alicut.log
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/63c88c27a0fa300f57066b0ef65fefcb.simg
[Sun Jul  5 23:32:46 2020]
Finished job 2818.
2167 of 3292 steps (66%) done

[Sun Jul  5 23:32:46 2020]
rule get_outgroups:
    input: per_gene/EOG091G0QPG/EOG091G0QPG.ingroup.fasta
    output: per_gene/EOG091G0QPG/EOG091G0QPG.orthodb.fasta, per_gene/EOG091G0QPG/EOG091G0QPG.outgroup.fasta
    log: per_gene/EOG091G0QPG/get_outgroups.stdout.txt, per_gene/EOG091G0QPG/get_outgroups.stderr.txt
    jobid: 2819
    wildcards: BUSCO=EOG091G0QPG


        #download fastas from Orhtodb for BUSCO id
        for i in {1..5}
        do
             wget "http://www.orthodb.org/fasta?query=EOG091G0QPG&level=33208" -O per_gene/EOG091G0QPG/EOG091G0QPG.orthodb.fasta 1> per_gene/EOG091G0QPG/get_outgroups.stdout.txt 2> per_gene/EOG091G0QPG/get_outgroups.stderr.txt && break || echo -e "try again ($i)" && sleep 15
        done

	#This is quick an dirty for now and just takes the first protein if there is more than one for an outgroup taxon
        bash ../scripts/download_outgroups.sh taxids.txt per_gene/EOG091G0QPG/EOG091G0QPG.orthodb.fasta > per_gene/EOG091G0QPG/EOG091G0QPG.outgroup.fasta
        
[Sun Jul  5 23:32:47 2020]
Finished job 2819.
2168 of 3292 steps (66%) done

[Sun Jul  5 23:32:47 2020]
rule join_groups:
    input: per_gene/EOG091G0QPG/EOG091G0QPG.ingroup.fasta, per_gene/EOG091G0QPG/EOG091G0QPG.outgroup.fasta
    output: per_gene/EOG091G0QPG/EOG091G0QPG.fasta
    jobid: 2233
    wildcards: BUSCO=EOG091G0QPG


        cat per_gene/EOG091G0QPG/EOG091G0QPG.ingroup.fasta per_gene/EOG091G0QPG/EOG091G0QPG.outgroup.fasta > per_gene/EOG091G0QPG/EOG091G0QPG.fasta
        
[Sun Jul  5 23:32:47 2020]
Finished job 2233.
2169 of 3292 steps (66%) done

[Sun Jul  5 23:32:47 2020]
rule MSA:
    input: per_gene/EOG091G0QPG/EOG091G0QPG.fasta
    output: per_gene/EOG091G0QPG/EOG091G0QPG.clustalo.fasta
    log: per_gene/EOG091G0QPG/MSA.stdout.txt, per_gene/EOG091G0QPG/MSA.stderr.txt
    jobid: 1586
    wildcards: BUSCO=EOG091G0QPG
    threads: 2


        clustalo -i per_gene/EOG091G0QPG/EOG091G0QPG.fasta -o per_gene/EOG091G0QPG/EOG091G0QPG.clustalo.fasta --threads=2 1> per_gene/EOG091G0QPG/MSA.stdout.txt 2> per_gene/EOG091G0QPG/MSA.stderr.txt
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/d68c9691725a7401923680874285c430.simg
[Sun Jul  5 23:32:48 2020]
Finished job 1586.
2170 of 3292 steps (66%) done

[Sun Jul  5 23:32:48 2020]
rule score_and_cut:
    input: per_gene/EOG091G0QPG/EOG091G0QPG.clustalo.fasta
    output: per_gene/EOG091G0QPG/ALICUT_EOG091G0QPG.clustalo.fasta
    jobid: 763
    wildcards: BUSCO=EOG091G0QPG
    threads: 2


        cd per_gene/EOG091G0QPG
        Aliscore.pl -N -r 200000000000000000 -i ../../per_gene/EOG091G0QPG/EOG091G0QPG.clustalo.fasta &> aliscore.log
        ALICUT.pl -s &> alicut.log
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/63c88c27a0fa300f57066b0ef65fefcb.simg
[Sun Jul  5 23:32:48 2020]
Finished job 615.
2171 of 3292 steps (66%) done

[Sun Jul  5 23:32:48 2020]
rule remove_empty:
    input: per_gene/EOG091G0EHZ/ALICUT_EOG091G0EHZ.clustalo.fasta
    output: per_gene/EOG091G0EHZ/empty_check.done
    jobid: 1437
    wildcards: BUSCO=EOG091G0EHZ


         if [ "$(cat per_gene/EOG091G0EHZ/ALICUT_EOG091G0EHZ.clustalo.fasta | grep -v ">" | sed 's/-//g' | grep "^$" | wc -l)" -gt 0 ]
         then
              cp per_gene/EOG091G0EHZ/ALICUT_EOG091G0EHZ.clustalo.fasta per_gene/EOG091G0EHZ/ALICUT_EOG091G0EHZ.clustalo.fasta.backup
              bash ../scripts/remove_empty.sh per_gene/EOG091G0EHZ/ALICUT_EOG091G0EHZ.clustalo.fasta.backup > per_gene/EOG091G0EHZ/ALICUT_EOG091G0EHZ.clustalo.fasta
         fi
         touch per_gene/EOG091G0EHZ/empty_check.done
         
[Sun Jul  5 23:32:49 2020]
Finished job 1437.
2172 of 3292 steps (66%) done

[Sun Jul  5 23:32:49 2020]
rule find_best_model:
    input: per_gene/EOG091G0EHZ/ALICUT_EOG091G0EHZ.clustalo.fasta, per_gene/EOG091G0EHZ/empty_check.done
    output: per_gene/EOG091G0EHZ/EOG091G0EHZ.best_model
    log: per_gene/EOG091G0EHZ/find_best_model.stderr.txt
    jobid: 614
    wildcards: BUSCO=EOG091G0EHZ
    threads: 2


        cd per_gene/EOG091G0EHZ
        if [ ! -d find_best_model ]
        then
            mkdir find_best_model
        fi
        cd find_best_model
        ln -s ../../../per_gene/EOG091G0EHZ/ALICUT_EOG091G0EHZ.clustalo.fasta EOG091G0EHZ.fasta
        ProteinModelSelection.pl EOG091G0EHZ.fasta 1> ../../../per_gene/EOG091G0EHZ/EOG091G0EHZ.best_model 2> ../../../per_gene/EOG091G0EHZ/find_best_model.stderr.txt
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/c0c09ee657b1e27f2c5687e0e9aa8d70.simg
[Sun Jul  5 23:32:57 2020]
Finished job 763.
2173 of 3292 steps (66%) done

[Sun Jul  5 23:32:57 2020]
rule remove_empty:
    input: per_gene/EOG091G0QPG/ALICUT_EOG091G0QPG.clustalo.fasta
    output: per_gene/EOG091G0QPG/empty_check.done
    jobid: 1585
    wildcards: BUSCO=EOG091G0QPG


         if [ "$(cat per_gene/EOG091G0QPG/ALICUT_EOG091G0QPG.clustalo.fasta | grep -v ">" | sed 's/-//g' | grep "^$" | wc -l)" -gt 0 ]
         then
              cp per_gene/EOG091G0QPG/ALICUT_EOG091G0QPG.clustalo.fasta per_gene/EOG091G0QPG/ALICUT_EOG091G0QPG.clustalo.fasta.backup
              bash ../scripts/remove_empty.sh per_gene/EOG091G0QPG/ALICUT_EOG091G0QPG.clustalo.fasta.backup > per_gene/EOG091G0QPG/ALICUT_EOG091G0QPG.clustalo.fasta
         fi
         touch per_gene/EOG091G0QPG/empty_check.done
         
[Sun Jul  5 23:32:58 2020]
Finished job 1585.
2174 of 3292 steps (66%) done

[Sun Jul  5 23:32:58 2020]
rule find_best_model:
    input: per_gene/EOG091G0QPG/ALICUT_EOG091G0QPG.clustalo.fasta, per_gene/EOG091G0QPG/empty_check.done
    output: per_gene/EOG091G0QPG/EOG091G0QPG.best_model
    log: per_gene/EOG091G0QPG/find_best_model.stderr.txt
    jobid: 762
    wildcards: BUSCO=EOG091G0QPG
    threads: 2


        cd per_gene/EOG091G0QPG
        if [ ! -d find_best_model ]
        then
            mkdir find_best_model
        fi
        cd find_best_model
        ln -s ../../../per_gene/EOG091G0QPG/ALICUT_EOG091G0QPG.clustalo.fasta EOG091G0QPG.fasta
        ProteinModelSelection.pl EOG091G0QPG.fasta 1> ../../../per_gene/EOG091G0QPG/EOG091G0QPG.best_model 2> ../../../per_gene/EOG091G0QPG/find_best_model.stderr.txt
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/c0c09ee657b1e27f2c5687e0e9aa8d70.simg
[Sun Jul  5 23:33:23 2020]
Finished job 614.
2175 of 3292 steps (66%) done

[Sun Jul  5 23:33:23 2020]
rule infer_single_ML:
    input: per_gene/EOG091G0EHZ/EOG091G0EHZ.best_model, per_gene/EOG091G0EHZ/ALICUT_EOG091G0EHZ.clustalo.fasta
    output: per_gene/EOG091G0EHZ/EOG091G0EHZ.raxml.done
    log: per_gene/EOG091G0EHZ/infer_single_ML.stdout.txt, per_gene/EOG091G0EHZ/infer_single_ML.stderr.txt
    jobid: 101
    wildcards: BUSCO=EOG091G0EHZ
    threads: 2


        cd per_gene/EOG091G0EHZ
	count=$(cat ../../per_gene/EOG091G0EHZ/ALICUT_EOG091G0EHZ.clustalo.fasta | grep ">" | wc -l)
	if [ "$count" -gt 5 ]
        then
		RAxMLmodel=$(cat ../../per_gene/EOG091G0EHZ/EOG091G0EHZ.best_model | grep "Best" | cut -d ":" -f 2 | tr -d '[:space:]')
                if [ "$(ls -1 | grep "^RAxML" | wc -l)" -ne 0 ]
		then
			rm RAxML*
		fi
        	raxml -f a -T 2 -m PROTGAMMA$RAxMLmodel         	-p 12345 -x 12345 -# 100         	-s ../../per_gene/EOG091G0EHZ/ALICUT_EOG091G0EHZ.clustalo.fasta -n EOG091G0EHZ.clustalo.aln.ALICUT.$RAxMLmodel 		1> ../../per_gene/EOG091G0EHZ/infer_single_ML.stdout.txt 2> ../../per_gene/EOG091G0EHZ/infer_single_ML.stderr.txt
	else
		echo "fasta file per_gene/EOG091G0EHZ/ALICUT_EOG091G0EHZ.clustalo.fasta contains fewer than 5 sequences - skipped" > ../../per_gene/EOG091G0EHZ/infer_single_ML.stdout.txt
		touch raxml.skipped
	fi
        touch ../../per_gene/EOG091G0EHZ/EOG091G0EHZ.raxml.done
        
[33mJob counts:
	count	jobs
	1	infer_single_ML
	1[0m
[33m
        cd per_gene/EOG091G0EHZ
	count=$(cat ../../per_gene/EOG091G0EHZ/ALICUT_EOG091G0EHZ.clustalo.fasta | grep ">" | wc -l)
	if [ "$count" -gt 5 ]
        then
		RAxMLmodel=$(cat ../../per_gene/EOG091G0EHZ/EOG091G0EHZ.best_model | grep "Best" | cut -d ":" -f 2 | tr -d '[:space:]')
                if [ "$(ls -1 | grep "^RAxML" | wc -l)" -ne 0 ]
		then
			rm RAxML*
		fi
        	raxml -f a -T 2 -m PROTGAMMA$RAxMLmodel         	-p 12345 -x 12345 -# 100         	-s ../../per_gene/EOG091G0EHZ/ALICUT_EOG091G0EHZ.clustalo.fasta -n EOG091G0EHZ.clustalo.aln.ALICUT.$RAxMLmodel 		1> ../../per_gene/EOG091G0EHZ/infer_single_ML.stdout.txt 2> ../../per_gene/EOG091G0EHZ/infer_single_ML.stderr.txt
	else
		echo "fasta file per_gene/EOG091G0EHZ/ALICUT_EOG091G0EHZ.clustalo.fasta contains fewer than 5 sequences - skipped" > ../../per_gene/EOG091G0EHZ/infer_single_ML.stdout.txt
		touch raxml.skipped
	fi
        touch ../../per_gene/EOG091G0EHZ/EOG091G0EHZ.raxml.done
        [0m
[Sun Jul  5 23:33:27 2020]
Finished job 762.
2176 of 3292 steps (66%) done

[Sun Jul  5 23:33:27 2020]
rule infer_single_ML:
    input: per_gene/EOG091G0QPG/EOG091G0QPG.best_model, per_gene/EOG091G0QPG/ALICUT_EOG091G0QPG.clustalo.fasta
    output: per_gene/EOG091G0QPG/EOG091G0QPG.raxml.done
    log: per_gene/EOG091G0QPG/infer_single_ML.stdout.txt, per_gene/EOG091G0QPG/infer_single_ML.stderr.txt
    jobid: 175
    wildcards: BUSCO=EOG091G0QPG
    threads: 2


        cd per_gene/EOG091G0QPG
	count=$(cat ../../per_gene/EOG091G0QPG/ALICUT_EOG091G0QPG.clustalo.fasta | grep ">" | wc -l)
	if [ "$count" -gt 5 ]
        then
		RAxMLmodel=$(cat ../../per_gene/EOG091G0QPG/EOG091G0QPG.best_model | grep "Best" | cut -d ":" -f 2 | tr -d '[:space:]')
                if [ "$(ls -1 | grep "^RAxML" | wc -l)" -ne 0 ]
		then
			rm RAxML*
		fi
        	raxml -f a -T 2 -m PROTGAMMA$RAxMLmodel         	-p 12345 -x 12345 -# 100         	-s ../../per_gene/EOG091G0QPG/ALICUT_EOG091G0QPG.clustalo.fasta -n EOG091G0QPG.clustalo.aln.ALICUT.$RAxMLmodel 		1> ../../per_gene/EOG091G0QPG/infer_single_ML.stdout.txt 2> ../../per_gene/EOG091G0QPG/infer_single_ML.stderr.txt
	else
		echo "fasta file per_gene/EOG091G0QPG/ALICUT_EOG091G0QPG.clustalo.fasta contains fewer than 5 sequences - skipped" > ../../per_gene/EOG091G0QPG/infer_single_ML.stdout.txt
		touch raxml.skipped
	fi
        touch ../../per_gene/EOG091G0QPG/EOG091G0QPG.raxml.done
        
[33mJob counts:
	count	jobs
	1	infer_single_ML
	1[0m
[33m
        cd per_gene/EOG091G0QPG
	count=$(cat ../../per_gene/EOG091G0QPG/ALICUT_EOG091G0QPG.clustalo.fasta | grep ">" | wc -l)
	if [ "$count" -gt 5 ]
        then
		RAxMLmodel=$(cat ../../per_gene/EOG091G0QPG/EOG091G0QPG.best_model | grep "Best" | cut -d ":" -f 2 | tr -d '[:space:]')
                if [ "$(ls -1 | grep "^RAxML" | wc -l)" -ne 0 ]
		then
			rm RAxML*
		fi
        	raxml -f a -T 2 -m PROTGAMMA$RAxMLmodel         	-p 12345 -x 12345 -# 100         	-s ../../per_gene/EOG091G0QPG/ALICUT_EOG091G0QPG.clustalo.fasta -n EOG091G0QPG.clustalo.aln.ALICUT.$RAxMLmodel 		1> ../../per_gene/EOG091G0QPG/infer_single_ML.stdout.txt 2> ../../per_gene/EOG091G0QPG/infer_single_ML.stderr.txt
	else
		echo "fasta file per_gene/EOG091G0QPG/ALICUT_EOG091G0QPG.clustalo.fasta contains fewer than 5 sequences - skipped" > ../../per_gene/EOG091G0QPG/infer_single_ML.stdout.txt
		touch raxml.skipped
	fi
        touch ../../per_gene/EOG091G0QPG/EOG091G0QPG.raxml.done
        [0m
[Sun Jul  5 23:33:42 2020]
Finished job 71.
2177 of 3292 steps (66%) done

[Sun Jul  5 23:33:42 2020]
rule get_seqs:
    input: /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ingroup.txt, /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/outgroup.txt
    output: per_gene/EOG091G08JE/EOG091G08JE.ingroup.fasta
    log: per_gene/EOG091G08JE/get_seqs.stdout.txt, per_gene/EOG091G08JE/get_seqs.stderr.txt
    jobid: 3160
    wildcards: BUSCO=EOG091G08JE
    threads: 2


	basedir=$(pwd)
        cd per_gene/EOG091G08JE
        
        bash $basedir/../scripts/fetch_seqs.sh EOG091G08JE /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ingroup.txt /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/outgroup.txt 1> ../../per_gene/EOG091G08JE/get_seqs.stdout.txt 2> ../../per_gene/EOG091G08JE/get_seqs.stderr.txt
	mv EOG091G08JE.fasta $basedir/per_gene/EOG091G08JE/EOG091G08JE.ingroup.fasta
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/72476f9d9a5bd0627b4d721143a21354.simg
[Sun Jul  5 23:33:54 2020]
Finished job 3160.
2178 of 3292 steps (66%) done

[Sun Jul  5 23:33:54 2020]
rule get_outgroups:
    input: per_gene/EOG091G08JE/EOG091G08JE.ingroup.fasta
    output: per_gene/EOG091G08JE/EOG091G08JE.orthodb.fasta, per_gene/EOG091G08JE/EOG091G08JE.outgroup.fasta
    log: per_gene/EOG091G08JE/get_outgroups.stdout.txt, per_gene/EOG091G08JE/get_outgroups.stderr.txt
    jobid: 3161
    wildcards: BUSCO=EOG091G08JE


        #download fastas from Orhtodb for BUSCO id
        for i in {1..5}
        do
             wget "http://www.orthodb.org/fasta?query=EOG091G08JE&level=33208" -O per_gene/EOG091G08JE/EOG091G08JE.orthodb.fasta 1> per_gene/EOG091G08JE/get_outgroups.stdout.txt 2> per_gene/EOG091G08JE/get_outgroups.stderr.txt && break || echo -e "try again ($i)" && sleep 15
        done

	#This is quick an dirty for now and just takes the first protein if there is more than one for an outgroup taxon
        bash ../scripts/download_outgroups.sh taxids.txt per_gene/EOG091G08JE/EOG091G08JE.orthodb.fasta > per_gene/EOG091G08JE/EOG091G08JE.outgroup.fasta
        
[Sun Jul  5 23:33:56 2020]
Finished job 3161.
2179 of 3292 steps (66%) done

[Sun Jul  5 23:33:56 2020]
rule join_groups:
    input: per_gene/EOG091G08JE/EOG091G08JE.ingroup.fasta, per_gene/EOG091G08JE/EOG091G08JE.outgroup.fasta
    output: per_gene/EOG091G08JE/EOG091G08JE.fasta
    jobid: 2404
    wildcards: BUSCO=EOG091G08JE


        cat per_gene/EOG091G08JE/EOG091G08JE.ingroup.fasta per_gene/EOG091G08JE/EOG091G08JE.outgroup.fasta > per_gene/EOG091G08JE/EOG091G08JE.fasta
        
[Sun Jul  5 23:33:56 2020]
Finished job 2404.
2180 of 3292 steps (66%) done

[Sun Jul  5 23:33:56 2020]
rule MSA:
    input: per_gene/EOG091G08JE/EOG091G08JE.fasta
    output: per_gene/EOG091G08JE/EOG091G08JE.clustalo.fasta
    log: per_gene/EOG091G08JE/MSA.stdout.txt, per_gene/EOG091G08JE/MSA.stderr.txt
    jobid: 1928
    wildcards: BUSCO=EOG091G08JE
    threads: 2


        clustalo -i per_gene/EOG091G08JE/EOG091G08JE.fasta -o per_gene/EOG091G08JE/EOG091G08JE.clustalo.fasta --threads=2 1> per_gene/EOG091G08JE/MSA.stdout.txt 2> per_gene/EOG091G08JE/MSA.stderr.txt
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/d68c9691725a7401923680874285c430.simg
[Sun Jul  5 23:33:57 2020]
Finished job 1928.
2181 of 3292 steps (66%) done

[Sun Jul  5 23:33:57 2020]
rule score_and_cut:
    input: per_gene/EOG091G08JE/EOG091G08JE.clustalo.fasta
    output: per_gene/EOG091G08JE/ALICUT_EOG091G08JE.clustalo.fasta
    jobid: 1105
    wildcards: BUSCO=EOG091G08JE
    threads: 2


        cd per_gene/EOG091G08JE
        Aliscore.pl -N -r 200000000000000000 -i ../../per_gene/EOG091G08JE/EOG091G08JE.clustalo.fasta &> aliscore.log
        ALICUT.pl -s &> alicut.log
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/63c88c27a0fa300f57066b0ef65fefcb.simg
[Sun Jul  5 23:34:07 2020]
Finished job 1105.
2182 of 3292 steps (66%) done

[Sun Jul  5 23:34:07 2020]
rule remove_empty:
    input: per_gene/EOG091G08JE/ALICUT_EOG091G08JE.clustalo.fasta
    output: per_gene/EOG091G08JE/empty_check.done
    jobid: 1927
    wildcards: BUSCO=EOG091G08JE


         if [ "$(cat per_gene/EOG091G08JE/ALICUT_EOG091G08JE.clustalo.fasta | grep -v ">" | sed 's/-//g' | grep "^$" | wc -l)" -gt 0 ]
         then
              cp per_gene/EOG091G08JE/ALICUT_EOG091G08JE.clustalo.fasta per_gene/EOG091G08JE/ALICUT_EOG091G08JE.clustalo.fasta.backup
              bash ../scripts/remove_empty.sh per_gene/EOG091G08JE/ALICUT_EOG091G08JE.clustalo.fasta.backup > per_gene/EOG091G08JE/ALICUT_EOG091G08JE.clustalo.fasta
         fi
         touch per_gene/EOG091G08JE/empty_check.done
         
[Sun Jul  5 23:34:08 2020]
Finished job 1927.
2183 of 3292 steps (66%) done

[Sun Jul  5 23:34:08 2020]
rule find_best_model:
    input: per_gene/EOG091G08JE/ALICUT_EOG091G08JE.clustalo.fasta, per_gene/EOG091G08JE/empty_check.done
    output: per_gene/EOG091G08JE/EOG091G08JE.best_model
    log: per_gene/EOG091G08JE/find_best_model.stderr.txt
    jobid: 1104
    wildcards: BUSCO=EOG091G08JE
    threads: 2


        cd per_gene/EOG091G08JE
        if [ ! -d find_best_model ]
        then
            mkdir find_best_model
        fi
        cd find_best_model
        ln -s ../../../per_gene/EOG091G08JE/ALICUT_EOG091G08JE.clustalo.fasta EOG091G08JE.fasta
        ProteinModelSelection.pl EOG091G08JE.fasta 1> ../../../per_gene/EOG091G08JE/EOG091G08JE.best_model 2> ../../../per_gene/EOG091G08JE/find_best_model.stderr.txt
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/c0c09ee657b1e27f2c5687e0e9aa8d70.simg
[Sun Jul  5 23:34:51 2020]
Finished job 1104.
2184 of 3292 steps (66%) done

[Sun Jul  5 23:34:51 2020]
rule infer_single_ML:
    input: per_gene/EOG091G08JE/EOG091G08JE.best_model, per_gene/EOG091G08JE/ALICUT_EOG091G08JE.clustalo.fasta
    output: per_gene/EOG091G08JE/EOG091G08JE.raxml.done
    log: per_gene/EOG091G08JE/infer_single_ML.stdout.txt, per_gene/EOG091G08JE/infer_single_ML.stderr.txt
    jobid: 346
    wildcards: BUSCO=EOG091G08JE
    threads: 2


        cd per_gene/EOG091G08JE
	count=$(cat ../../per_gene/EOG091G08JE/ALICUT_EOG091G08JE.clustalo.fasta | grep ">" | wc -l)
	if [ "$count" -gt 5 ]
        then
		RAxMLmodel=$(cat ../../per_gene/EOG091G08JE/EOG091G08JE.best_model | grep "Best" | cut -d ":" -f 2 | tr -d '[:space:]')
                if [ "$(ls -1 | grep "^RAxML" | wc -l)" -ne 0 ]
		then
			rm RAxML*
		fi
        	raxml -f a -T 2 -m PROTGAMMA$RAxMLmodel         	-p 12345 -x 12345 -# 100         	-s ../../per_gene/EOG091G08JE/ALICUT_EOG091G08JE.clustalo.fasta -n EOG091G08JE.clustalo.aln.ALICUT.$RAxMLmodel 		1> ../../per_gene/EOG091G08JE/infer_single_ML.stdout.txt 2> ../../per_gene/EOG091G08JE/infer_single_ML.stderr.txt
	else
		echo "fasta file per_gene/EOG091G08JE/ALICUT_EOG091G08JE.clustalo.fasta contains fewer than 5 sequences - skipped" > ../../per_gene/EOG091G08JE/infer_single_ML.stdout.txt
		touch raxml.skipped
	fi
        touch ../../per_gene/EOG091G08JE/EOG091G08JE.raxml.done
        
[33mJob counts:
	count	jobs
	1	infer_single_ML
	1[0m
[33m
        cd per_gene/EOG091G08JE
	count=$(cat ../../per_gene/EOG091G08JE/ALICUT_EOG091G08JE.clustalo.fasta | grep ">" | wc -l)
	if [ "$count" -gt 5 ]
        then
		RAxMLmodel=$(cat ../../per_gene/EOG091G08JE/EOG091G08JE.best_model | grep "Best" | cut -d ":" -f 2 | tr -d '[:space:]')
                if [ "$(ls -1 | grep "^RAxML" | wc -l)" -ne 0 ]
		then
			rm RAxML*
		fi
        	raxml -f a -T 2 -m PROTGAMMA$RAxMLmodel         	-p 12345 -x 12345 -# 100         	-s ../../per_gene/EOG091G08JE/ALICUT_EOG091G08JE.clustalo.fasta -n EOG091G08JE.clustalo.aln.ALICUT.$RAxMLmodel 		1> ../../per_gene/EOG091G08JE/infer_single_ML.stdout.txt 2> ../../per_gene/EOG091G08JE/infer_single_ML.stderr.txt
	else
		echo "fasta file per_gene/EOG091G08JE/ALICUT_EOG091G08JE.clustalo.fasta contains fewer than 5 sequences - skipped" > ../../per_gene/EOG091G08JE/infer_single_ML.stdout.txt
		touch raxml.skipped
	fi
        touch ../../per_gene/EOG091G08JE/EOG091G08JE.raxml.done
        [0m
[Sun Jul  5 23:35:12 2020]
Finished job 349.
2185 of 3292 steps (66%) done

[Sun Jul  5 23:35:12 2020]
rule get_seqs:
    input: /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ingroup.txt, /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/outgroup.txt
    output: per_gene/EOG091G0BTX/EOG091G0BTX.ingroup.fasta
    log: per_gene/EOG091G0BTX/get_seqs.stdout.txt, per_gene/EOG091G0BTX/get_seqs.stderr.txt
    jobid: 2970
    wildcards: BUSCO=EOG091G0BTX
    threads: 2


	basedir=$(pwd)
        cd per_gene/EOG091G0BTX
        
        bash $basedir/../scripts/fetch_seqs.sh EOG091G0BTX /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ingroup.txt /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/outgroup.txt 1> ../../per_gene/EOG091G0BTX/get_seqs.stdout.txt 2> ../../per_gene/EOG091G0BTX/get_seqs.stderr.txt
	mv EOG091G0BTX.fasta $basedir/per_gene/EOG091G0BTX/EOG091G0BTX.ingroup.fasta
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/72476f9d9a5bd0627b4d721143a21354.simg
[Sun Jul  5 23:35:14 2020]
Finished job 366.
2186 of 3292 steps (66%) done

[Sun Jul  5 23:35:14 2020]
rule get_seqs:
    input: /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ingroup.txt, /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/outgroup.txt
    output: per_gene/EOG091G0NVA/EOG091G0NVA.ingroup.fasta
    log: per_gene/EOG091G0NVA/get_seqs.stdout.txt, per_gene/EOG091G0NVA/get_seqs.stderr.txt
    jobid: 2792
    wildcards: BUSCO=EOG091G0NVA
    threads: 2


	basedir=$(pwd)
        cd per_gene/EOG091G0NVA
        
        bash $basedir/../scripts/fetch_seqs.sh EOG091G0NVA /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ingroup.txt /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/outgroup.txt 1> ../../per_gene/EOG091G0NVA/get_seqs.stdout.txt 2> ../../per_gene/EOG091G0NVA/get_seqs.stderr.txt
	mv EOG091G0NVA.fasta $basedir/per_gene/EOG091G0NVA/EOG091G0NVA.ingroup.fasta
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/72476f9d9a5bd0627b4d721143a21354.simg
[Sun Jul  5 23:35:20 2020]
Finished job 411.
2187 of 3292 steps (66%) done

[Sun Jul  5 23:35:20 2020]
rule get_seqs:
    input: /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ingroup.txt, /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/outgroup.txt
    output: per_gene/EOG091G12A5/EOG091G12A5.ingroup.fasta
    log: per_gene/EOG091G12A5/get_seqs.stdout.txt, per_gene/EOG091G12A5/get_seqs.stderr.txt
    jobid: 2926
    wildcards: BUSCO=EOG091G12A5
    threads: 2


	basedir=$(pwd)
        cd per_gene/EOG091G12A5
        
        bash $basedir/../scripts/fetch_seqs.sh EOG091G12A5 /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ingroup.txt /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/outgroup.txt 1> ../../per_gene/EOG091G12A5/get_seqs.stdout.txt 2> ../../per_gene/EOG091G12A5/get_seqs.stderr.txt
	mv EOG091G12A5.fasta $basedir/per_gene/EOG091G12A5/EOG091G12A5.ingroup.fasta
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/72476f9d9a5bd0627b4d721143a21354.simg
[Sun Jul  5 23:35:27 2020]
Finished job 2970.
2188 of 3292 steps (66%) done

[Sun Jul  5 23:35:27 2020]
rule get_outgroups:
    input: per_gene/EOG091G0BTX/EOG091G0BTX.ingroup.fasta
    output: per_gene/EOG091G0BTX/EOG091G0BTX.orthodb.fasta, per_gene/EOG091G0BTX/EOG091G0BTX.outgroup.fasta
    log: per_gene/EOG091G0BTX/get_outgroups.stdout.txt, per_gene/EOG091G0BTX/get_outgroups.stderr.txt
    jobid: 2971
    wildcards: BUSCO=EOG091G0BTX


        #download fastas from Orhtodb for BUSCO id
        for i in {1..5}
        do
             wget "http://www.orthodb.org/fasta?query=EOG091G0BTX&level=33208" -O per_gene/EOG091G0BTX/EOG091G0BTX.orthodb.fasta 1> per_gene/EOG091G0BTX/get_outgroups.stdout.txt 2> per_gene/EOG091G0BTX/get_outgroups.stderr.txt && break || echo -e "try again ($i)" && sleep 15
        done

	#This is quick an dirty for now and just takes the first protein if there is more than one for an outgroup taxon
        bash ../scripts/download_outgroups.sh taxids.txt per_gene/EOG091G0BTX/EOG091G0BTX.orthodb.fasta > per_gene/EOG091G0BTX/EOG091G0BTX.outgroup.fasta
        
[Sun Jul  5 23:35:28 2020]
Finished job 2792.
2189 of 3292 steps (66%) done

[Sun Jul  5 23:35:28 2020]
rule get_seqs:
    input: /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ingroup.txt, /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/outgroup.txt
    output: per_gene/EOG091G09MU/EOG091G09MU.ingroup.fasta
    log: per_gene/EOG091G09MU/get_seqs.stdout.txt, per_gene/EOG091G09MU/get_seqs.stderr.txt
    jobid: 2608
    wildcards: BUSCO=EOG091G09MU
    threads: 2


	basedir=$(pwd)
        cd per_gene/EOG091G09MU
        
        bash $basedir/../scripts/fetch_seqs.sh EOG091G09MU /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ingroup.txt /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/outgroup.txt 1> ../../per_gene/EOG091G09MU/get_seqs.stdout.txt 2> ../../per_gene/EOG091G09MU/get_seqs.stderr.txt
	mv EOG091G09MU.fasta $basedir/per_gene/EOG091G09MU/EOG091G09MU.ingroup.fasta
        

[Sun Jul  5 23:35:28 2020]
rule get_outgroups:
    input: per_gene/EOG091G0NVA/EOG091G0NVA.ingroup.fasta
    output: per_gene/EOG091G0NVA/EOG091G0NVA.orthodb.fasta, per_gene/EOG091G0NVA/EOG091G0NVA.outgroup.fasta
    log: per_gene/EOG091G0NVA/get_outgroups.stdout.txt, per_gene/EOG091G0NVA/get_outgroups.stderr.txt
    jobid: 2793
    wildcards: BUSCO=EOG091G0NVA


        #download fastas from Orhtodb for BUSCO id
        for i in {1..5}
        do
             wget "http://www.orthodb.org/fasta?query=EOG091G0NVA&level=33208" -O per_gene/EOG091G0NVA/EOG091G0NVA.orthodb.fasta 1> per_gene/EOG091G0NVA/get_outgroups.stdout.txt 2> per_gene/EOG091G0NVA/get_outgroups.stderr.txt && break || echo -e "try again ($i)" && sleep 15
        done

	#This is quick an dirty for now and just takes the first protein if there is more than one for an outgroup taxon
        bash ../scripts/download_outgroups.sh taxids.txt per_gene/EOG091G0NVA/EOG091G0NVA.orthodb.fasta > per_gene/EOG091G0NVA/EOG091G0NVA.outgroup.fasta
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/72476f9d9a5bd0627b4d721143a21354.simg
[Sun Jul  5 23:35:28 2020]
Finished job 2971.
2190 of 3292 steps (67%) done

[Sun Jul  5 23:35:28 2020]
rule join_groups:
    input: per_gene/EOG091G0BTX/EOG091G0BTX.ingroup.fasta, per_gene/EOG091G0BTX/EOG091G0BTX.outgroup.fasta
    output: per_gene/EOG091G0BTX/EOG091G0BTX.fasta
    jobid: 2309
    wildcards: BUSCO=EOG091G0BTX


        cat per_gene/EOG091G0BTX/EOG091G0BTX.ingroup.fasta per_gene/EOG091G0BTX/EOG091G0BTX.outgroup.fasta > per_gene/EOG091G0BTX/EOG091G0BTX.fasta
        
[Sun Jul  5 23:35:28 2020]
Finished job 2309.
2191 of 3292 steps (67%) done
[Sun Jul  5 23:35:29 2020]
Finished job 2793.
2192 of 3292 steps (67%) done

[Sun Jul  5 23:35:29 2020]
rule MSA:
    input: per_gene/EOG091G0BTX/EOG091G0BTX.fasta
    output: per_gene/EOG091G0BTX/EOG091G0BTX.clustalo.fasta
    log: per_gene/EOG091G0BTX/MSA.stdout.txt, per_gene/EOG091G0BTX/MSA.stderr.txt
    jobid: 1738
    wildcards: BUSCO=EOG091G0BTX
    threads: 2


        clustalo -i per_gene/EOG091G0BTX/EOG091G0BTX.fasta -o per_gene/EOG091G0BTX/EOG091G0BTX.clustalo.fasta --threads=2 1> per_gene/EOG091G0BTX/MSA.stdout.txt 2> per_gene/EOG091G0BTX/MSA.stderr.txt
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/d68c9691725a7401923680874285c430.simg
[Sun Jul  5 23:35:29 2020]
Finished job 329.
2193 of 3292 steps (67%) done

[Sun Jul  5 23:35:29 2020]
rule join_groups:
    input: per_gene/EOG091G0NVA/EOG091G0NVA.ingroup.fasta, per_gene/EOG091G0NVA/EOG091G0NVA.outgroup.fasta
    output: per_gene/EOG091G0NVA/EOG091G0NVA.fasta
    jobid: 2220
    wildcards: BUSCO=EOG091G0NVA


        cat per_gene/EOG091G0NVA/EOG091G0NVA.ingroup.fasta per_gene/EOG091G0NVA/EOG091G0NVA.outgroup.fasta > per_gene/EOG091G0NVA/EOG091G0NVA.fasta
        
[Sun Jul  5 23:35:29 2020]
Finished job 2220.
2194 of 3292 steps (67%) done

[Sun Jul  5 23:35:29 2020]
rule MSA:
    input: per_gene/EOG091G0NVA/EOG091G0NVA.fasta
    output: per_gene/EOG091G0NVA/EOG091G0NVA.clustalo.fasta
    log: per_gene/EOG091G0NVA/MSA.stdout.txt, per_gene/EOG091G0NVA/MSA.stderr.txt
    jobid: 1560
    wildcards: BUSCO=EOG091G0NVA
    threads: 2


        clustalo -i per_gene/EOG091G0NVA/EOG091G0NVA.fasta -o per_gene/EOG091G0NVA/EOG091G0NVA.clustalo.fasta --threads=2 1> per_gene/EOG091G0NVA/MSA.stdout.txt 2> per_gene/EOG091G0NVA/MSA.stderr.txt
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/d68c9691725a7401923680874285c430.simg
[Sun Jul  5 23:35:30 2020]
Finished job 1560.
2195 of 3292 steps (67%) done

[Sun Jul  5 23:35:30 2020]
rule score_and_cut:
    input: per_gene/EOG091G0NVA/EOG091G0NVA.clustalo.fasta
    output: per_gene/EOG091G0NVA/ALICUT_EOG091G0NVA.clustalo.fasta
    jobid: 737
    wildcards: BUSCO=EOG091G0NVA
    threads: 2


        cd per_gene/EOG091G0NVA
        Aliscore.pl -N -r 200000000000000000 -i ../../per_gene/EOG091G0NVA/EOG091G0NVA.clustalo.fasta &> aliscore.log
        ALICUT.pl -s &> alicut.log
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/63c88c27a0fa300f57066b0ef65fefcb.simg
[Sun Jul  5 23:35:30 2020]
Finished job 1738.
2196 of 3292 steps (67%) done

[Sun Jul  5 23:35:30 2020]
rule score_and_cut:
    input: per_gene/EOG091G0BTX/EOG091G0BTX.clustalo.fasta
    output: per_gene/EOG091G0BTX/ALICUT_EOG091G0BTX.clustalo.fasta
    jobid: 915
    wildcards: BUSCO=EOG091G0BTX
    threads: 2


        cd per_gene/EOG091G0BTX
        Aliscore.pl -N -r 200000000000000000 -i ../../per_gene/EOG091G0BTX/EOG091G0BTX.clustalo.fasta &> aliscore.log
        ALICUT.pl -s &> alicut.log
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/63c88c27a0fa300f57066b0ef65fefcb.simg
[Sun Jul  5 23:35:34 2020]
Finished job 2926.
2197 of 3292 steps (67%) done

[Sun Jul  5 23:35:34 2020]
rule get_outgroups:
    input: per_gene/EOG091G12A5/EOG091G12A5.ingroup.fasta
    output: per_gene/EOG091G12A5/EOG091G12A5.orthodb.fasta, per_gene/EOG091G12A5/EOG091G12A5.outgroup.fasta
    log: per_gene/EOG091G12A5/get_outgroups.stdout.txt, per_gene/EOG091G12A5/get_outgroups.stderr.txt
    jobid: 2927
    wildcards: BUSCO=EOG091G12A5


        #download fastas from Orhtodb for BUSCO id
        for i in {1..5}
        do
             wget "http://www.orthodb.org/fasta?query=EOG091G12A5&level=33208" -O per_gene/EOG091G12A5/EOG091G12A5.orthodb.fasta 1> per_gene/EOG091G12A5/get_outgroups.stdout.txt 2> per_gene/EOG091G12A5/get_outgroups.stderr.txt && break || echo -e "try again ($i)" && sleep 15
        done

	#This is quick an dirty for now and just takes the first protein if there is more than one for an outgroup taxon
        bash ../scripts/download_outgroups.sh taxids.txt per_gene/EOG091G12A5/EOG091G12A5.orthodb.fasta > per_gene/EOG091G12A5/EOG091G12A5.outgroup.fasta
        
[Sun Jul  5 23:35:34 2020]
Finished job 2927.
2198 of 3292 steps (67%) done

[Sun Jul  5 23:35:34 2020]
rule join_groups:
    input: per_gene/EOG091G12A5/EOG091G12A5.ingroup.fasta, per_gene/EOG091G12A5/EOG091G12A5.outgroup.fasta
    output: per_gene/EOG091G12A5/EOG091G12A5.fasta
    jobid: 2287
    wildcards: BUSCO=EOG091G12A5


        cat per_gene/EOG091G12A5/EOG091G12A5.ingroup.fasta per_gene/EOG091G12A5/EOG091G12A5.outgroup.fasta > per_gene/EOG091G12A5/EOG091G12A5.fasta
        
[Sun Jul  5 23:35:34 2020]
Finished job 2287.
2199 of 3292 steps (67%) done

[Sun Jul  5 23:35:34 2020]
rule MSA:
    input: per_gene/EOG091G12A5/EOG091G12A5.fasta
    output: per_gene/EOG091G12A5/EOG091G12A5.clustalo.fasta
    log: per_gene/EOG091G12A5/MSA.stdout.txt, per_gene/EOG091G12A5/MSA.stderr.txt
    jobid: 1694
    wildcards: BUSCO=EOG091G12A5
    threads: 2


        clustalo -i per_gene/EOG091G12A5/EOG091G12A5.fasta -o per_gene/EOG091G12A5/EOG091G12A5.clustalo.fasta --threads=2 1> per_gene/EOG091G12A5/MSA.stdout.txt 2> per_gene/EOG091G12A5/MSA.stderr.txt
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/d68c9691725a7401923680874285c430.simg
[Sun Jul  5 23:35:35 2020]
Finished job 1694.
2200 of 3292 steps (67%) done

[Sun Jul  5 23:35:35 2020]
rule score_and_cut:
    input: per_gene/EOG091G12A5/EOG091G12A5.clustalo.fasta
    output: per_gene/EOG091G12A5/ALICUT_EOG091G12A5.clustalo.fasta
    jobid: 871
    wildcards: BUSCO=EOG091G12A5
    threads: 2


        cd per_gene/EOG091G12A5
        Aliscore.pl -N -r 200000000000000000 -i ../../per_gene/EOG091G12A5/EOG091G12A5.clustalo.fasta &> aliscore.log
        ALICUT.pl -s &> alicut.log
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/63c88c27a0fa300f57066b0ef65fefcb.simg
[Sun Jul  5 23:35:39 2020]
Finished job 915.
2201 of 3292 steps (67%) done

[Sun Jul  5 23:35:39 2020]
rule remove_empty:
    input: per_gene/EOG091G0BTX/ALICUT_EOG091G0BTX.clustalo.fasta
    output: per_gene/EOG091G0BTX/empty_check.done
    jobid: 1737
    wildcards: BUSCO=EOG091G0BTX


         if [ "$(cat per_gene/EOG091G0BTX/ALICUT_EOG091G0BTX.clustalo.fasta | grep -v ">" | sed 's/-//g' | grep "^$" | wc -l)" -gt 0 ]
         then
              cp per_gene/EOG091G0BTX/ALICUT_EOG091G0BTX.clustalo.fasta per_gene/EOG091G0BTX/ALICUT_EOG091G0BTX.clustalo.fasta.backup
              bash ../scripts/remove_empty.sh per_gene/EOG091G0BTX/ALICUT_EOG091G0BTX.clustalo.fasta.backup > per_gene/EOG091G0BTX/ALICUT_EOG091G0BTX.clustalo.fasta
         fi
         touch per_gene/EOG091G0BTX/empty_check.done
         
[Sun Jul  5 23:35:39 2020]
Finished job 1737.
2202 of 3292 steps (67%) done

[Sun Jul  5 23:35:39 2020]
rule find_best_model:
    input: per_gene/EOG091G0BTX/ALICUT_EOG091G0BTX.clustalo.fasta, per_gene/EOG091G0BTX/empty_check.done
    output: per_gene/EOG091G0BTX/EOG091G0BTX.best_model
    log: per_gene/EOG091G0BTX/find_best_model.stderr.txt
    jobid: 914
    wildcards: BUSCO=EOG091G0BTX
    threads: 2


        cd per_gene/EOG091G0BTX
        if [ ! -d find_best_model ]
        then
            mkdir find_best_model
        fi
        cd find_best_model
        ln -s ../../../per_gene/EOG091G0BTX/ALICUT_EOG091G0BTX.clustalo.fasta EOG091G0BTX.fasta
        ProteinModelSelection.pl EOG091G0BTX.fasta 1> ../../../per_gene/EOG091G0BTX/EOG091G0BTX.best_model 2> ../../../per_gene/EOG091G0BTX/find_best_model.stderr.txt
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/c0c09ee657b1e27f2c5687e0e9aa8d70.simg
[Sun Jul  5 23:35:40 2020]
Finished job 737.
2203 of 3292 steps (67%) done

[Sun Jul  5 23:35:40 2020]
rule remove_empty:
    input: per_gene/EOG091G0NVA/ALICUT_EOG091G0NVA.clustalo.fasta
    output: per_gene/EOG091G0NVA/empty_check.done
    jobid: 1559
    wildcards: BUSCO=EOG091G0NVA


         if [ "$(cat per_gene/EOG091G0NVA/ALICUT_EOG091G0NVA.clustalo.fasta | grep -v ">" | sed 's/-//g' | grep "^$" | wc -l)" -gt 0 ]
         then
              cp per_gene/EOG091G0NVA/ALICUT_EOG091G0NVA.clustalo.fasta per_gene/EOG091G0NVA/ALICUT_EOG091G0NVA.clustalo.fasta.backup
              bash ../scripts/remove_empty.sh per_gene/EOG091G0NVA/ALICUT_EOG091G0NVA.clustalo.fasta.backup > per_gene/EOG091G0NVA/ALICUT_EOG091G0NVA.clustalo.fasta
         fi
         touch per_gene/EOG091G0NVA/empty_check.done
         
[Sun Jul  5 23:35:40 2020]
Finished job 1559.
2204 of 3292 steps (67%) done

[Sun Jul  5 23:35:40 2020]
rule find_best_model:
    input: per_gene/EOG091G0NVA/ALICUT_EOG091G0NVA.clustalo.fasta, per_gene/EOG091G0NVA/empty_check.done
    output: per_gene/EOG091G0NVA/EOG091G0NVA.best_model
    log: per_gene/EOG091G0NVA/find_best_model.stderr.txt
    jobid: 736
    wildcards: BUSCO=EOG091G0NVA
    threads: 2


        cd per_gene/EOG091G0NVA
        if [ ! -d find_best_model ]
        then
            mkdir find_best_model
        fi
        cd find_best_model
        ln -s ../../../per_gene/EOG091G0NVA/ALICUT_EOG091G0NVA.clustalo.fasta EOG091G0NVA.fasta
        ProteinModelSelection.pl EOG091G0NVA.fasta 1> ../../../per_gene/EOG091G0NVA/EOG091G0NVA.best_model 2> ../../../per_gene/EOG091G0NVA/find_best_model.stderr.txt
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/c0c09ee657b1e27f2c5687e0e9aa8d70.simg
[Sun Jul  5 23:35:41 2020]
Finished job 61.
2205 of 3292 steps (67%) done

[Sun Jul  5 23:35:41 2020]
rule get_seqs:
    input: /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ingroup.txt, /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/outgroup.txt
    output: per_gene/EOG091G08O3/EOG091G08O3.ingroup.fasta
    log: per_gene/EOG091G08O3/get_seqs.stdout.txt, per_gene/EOG091G08O3/get_seqs.stderr.txt
    jobid: 2594
    wildcards: BUSCO=EOG091G08O3
    threads: 2


	basedir=$(pwd)
        cd per_gene/EOG091G08O3
        
        bash $basedir/../scripts/fetch_seqs.sh EOG091G08O3 /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ingroup.txt /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/outgroup.txt 1> ../../per_gene/EOG091G08O3/get_seqs.stdout.txt 2> ../../per_gene/EOG091G08O3/get_seqs.stderr.txt
	mv EOG091G08O3.fasta $basedir/per_gene/EOG091G08O3/EOG091G08O3.ingroup.fasta
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/72476f9d9a5bd0627b4d721143a21354.simg
[Sun Jul  5 23:35:43 2020]
Finished job 2608.
2206 of 3292 steps (67%) done

[Sun Jul  5 23:35:43 2020]
rule get_outgroups:
    input: per_gene/EOG091G09MU/EOG091G09MU.ingroup.fasta
    output: per_gene/EOG091G09MU/EOG091G09MU.orthodb.fasta, per_gene/EOG091G09MU/EOG091G09MU.outgroup.fasta
    log: per_gene/EOG091G09MU/get_outgroups.stdout.txt, per_gene/EOG091G09MU/get_outgroups.stderr.txt
    jobid: 2609
    wildcards: BUSCO=EOG091G09MU


        #download fastas from Orhtodb for BUSCO id
        for i in {1..5}
        do
             wget "http://www.orthodb.org/fasta?query=EOG091G09MU&level=33208" -O per_gene/EOG091G09MU/EOG091G09MU.orthodb.fasta 1> per_gene/EOG091G09MU/get_outgroups.stdout.txt 2> per_gene/EOG091G09MU/get_outgroups.stderr.txt && break || echo -e "try again ($i)" && sleep 15
        done

	#This is quick an dirty for now and just takes the first protein if there is more than one for an outgroup taxon
        bash ../scripts/download_outgroups.sh taxids.txt per_gene/EOG091G09MU/EOG091G09MU.orthodb.fasta > per_gene/EOG091G09MU/EOG091G09MU.outgroup.fasta
        
[Sun Jul  5 23:35:44 2020]
Finished job 871.
2207 of 3292 steps (67%) done

[Sun Jul  5 23:35:44 2020]
rule remove_empty:
    input: per_gene/EOG091G12A5/ALICUT_EOG091G12A5.clustalo.fasta
    output: per_gene/EOG091G12A5/empty_check.done
    jobid: 1693
    wildcards: BUSCO=EOG091G12A5


         if [ "$(cat per_gene/EOG091G12A5/ALICUT_EOG091G12A5.clustalo.fasta | grep -v ">" | sed 's/-//g' | grep "^$" | wc -l)" -gt 0 ]
         then
              cp per_gene/EOG091G12A5/ALICUT_EOG091G12A5.clustalo.fasta per_gene/EOG091G12A5/ALICUT_EOG091G12A5.clustalo.fasta.backup
              bash ../scripts/remove_empty.sh per_gene/EOG091G12A5/ALICUT_EOG091G12A5.clustalo.fasta.backup > per_gene/EOG091G12A5/ALICUT_EOG091G12A5.clustalo.fasta
         fi
         touch per_gene/EOG091G12A5/empty_check.done
         

[Sun Jul  5 23:35:44 2020]
rule get_seqs:
    input: /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ingroup.txt, /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/outgroup.txt
    output: per_gene/EOG091G0AFP/EOG091G0AFP.ingroup.fasta
    log: per_gene/EOG091G0AFP/get_seqs.stdout.txt, per_gene/EOG091G0AFP/get_seqs.stderr.txt
    jobid: 2622
    wildcards: BUSCO=EOG091G0AFP
    threads: 2


	basedir=$(pwd)
        cd per_gene/EOG091G0AFP
        
        bash $basedir/../scripts/fetch_seqs.sh EOG091G0AFP /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ingroup.txt /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/outgroup.txt 1> ../../per_gene/EOG091G0AFP/get_seqs.stdout.txt 2> ../../per_gene/EOG091G0AFP/get_seqs.stderr.txt
	mv EOG091G0AFP.fasta $basedir/per_gene/EOG091G0AFP/EOG091G0AFP.ingroup.fasta
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/72476f9d9a5bd0627b4d721143a21354.simg
[Sun Jul  5 23:35:44 2020]
Finished job 1693.
2208 of 3292 steps (67%) done
[Sun Jul  5 23:35:44 2020]
Finished job 2609.
2209 of 3292 steps (67%) done

[Sun Jul  5 23:35:44 2020]
rule join_groups:
    input: per_gene/EOG091G09MU/EOG091G09MU.ingroup.fasta, per_gene/EOG091G09MU/EOG091G09MU.outgroup.fasta
    output: per_gene/EOG091G09MU/EOG091G09MU.fasta
    jobid: 2128
    wildcards: BUSCO=EOG091G09MU


        cat per_gene/EOG091G09MU/EOG091G09MU.ingroup.fasta per_gene/EOG091G09MU/EOG091G09MU.outgroup.fasta > per_gene/EOG091G09MU/EOG091G09MU.fasta
        
[Sun Jul  5 23:35:44 2020]
Finished job 2128.
2210 of 3292 steps (67%) done

[Sun Jul  5 23:35:44 2020]
rule MSA:
    input: per_gene/EOG091G09MU/EOG091G09MU.fasta
    output: per_gene/EOG091G09MU/EOG091G09MU.clustalo.fasta
    log: per_gene/EOG091G09MU/MSA.stdout.txt, per_gene/EOG091G09MU/MSA.stderr.txt
    jobid: 1376
    wildcards: BUSCO=EOG091G09MU
    threads: 2


        clustalo -i per_gene/EOG091G09MU/EOG091G09MU.fasta -o per_gene/EOG091G09MU/EOG091G09MU.clustalo.fasta --threads=2 1> per_gene/EOG091G09MU/MSA.stdout.txt 2> per_gene/EOG091G09MU/MSA.stderr.txt
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/d68c9691725a7401923680874285c430.simg
[Sun Jul  5 23:35:46 2020]
Finished job 1376.
2211 of 3292 steps (67%) done

[Sun Jul  5 23:35:46 2020]
rule score_and_cut:
    input: per_gene/EOG091G09MU/EOG091G09MU.clustalo.fasta
    output: per_gene/EOG091G09MU/ALICUT_EOG091G09MU.clustalo.fasta
    jobid: 553
    wildcards: BUSCO=EOG091G09MU
    threads: 2


        cd per_gene/EOG091G09MU
        Aliscore.pl -N -r 200000000000000000 -i ../../per_gene/EOG091G09MU/EOG091G09MU.clustalo.fasta &> aliscore.log
        ALICUT.pl -s &> alicut.log
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/63c88c27a0fa300f57066b0ef65fefcb.simg
[Sun Jul  5 23:35:48 2020]
Finished job 380.
2212 of 3292 steps (67%) done

[Sun Jul  5 23:35:48 2020]
rule find_best_model:
    input: per_gene/EOG091G12A5/ALICUT_EOG091G12A5.clustalo.fasta, per_gene/EOG091G12A5/empty_check.done
    output: per_gene/EOG091G12A5/EOG091G12A5.best_model
    log: per_gene/EOG091G12A5/find_best_model.stderr.txt
    jobid: 870
    wildcards: BUSCO=EOG091G12A5
    threads: 2


        cd per_gene/EOG091G12A5
        if [ ! -d find_best_model ]
        then
            mkdir find_best_model
        fi
        cd find_best_model
        ln -s ../../../per_gene/EOG091G12A5/ALICUT_EOG091G12A5.clustalo.fasta EOG091G12A5.fasta
        ProteinModelSelection.pl EOG091G12A5.fasta 1> ../../../per_gene/EOG091G12A5/EOG091G12A5.best_model 2> ../../../per_gene/EOG091G12A5/find_best_model.stderr.txt
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/c0c09ee657b1e27f2c5687e0e9aa8d70.simg
[Sun Jul  5 23:35:49 2020]
Finished job 322.
2213 of 3292 steps (67%) done

[Sun Jul  5 23:35:49 2020]
rule get_seqs:
    input: /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ingroup.txt, /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/outgroup.txt
    output: per_gene/EOG091G0M12/EOG091G0M12.ingroup.fasta
    log: per_gene/EOG091G0M12/get_seqs.stdout.txt, per_gene/EOG091G0M12/get_seqs.stderr.txt
    jobid: 2756
    wildcards: BUSCO=EOG091G0M12
    threads: 2


	basedir=$(pwd)
        cd per_gene/EOG091G0M12
        
        bash $basedir/../scripts/fetch_seqs.sh EOG091G0M12 /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ingroup.txt /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/outgroup.txt 1> ../../per_gene/EOG091G0M12/get_seqs.stdout.txt 2> ../../per_gene/EOG091G0M12/get_seqs.stderr.txt
	mv EOG091G0M12.fasta $basedir/per_gene/EOG091G0M12/EOG091G0M12.ingroup.fasta
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/72476f9d9a5bd0627b4d721143a21354.simg
[Sun Jul  5 23:35:55 2020]
Finished job 316.
2214 of 3292 steps (67%) done

[Sun Jul  5 23:35:55 2020]
rule get_seqs:
    input: /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ingroup.txt, /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/outgroup.txt
    output: per_gene/EOG091G0A2L/EOG091G0A2L.ingroup.fasta
    log: per_gene/EOG091G0A2L/get_seqs.stdout.txt, per_gene/EOG091G0A2L/get_seqs.stderr.txt
    jobid: 2616
    wildcards: BUSCO=EOG091G0A2L
    threads: 2


	basedir=$(pwd)
        cd per_gene/EOG091G0A2L
        
        bash $basedir/../scripts/fetch_seqs.sh EOG091G0A2L /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ingroup.txt /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/outgroup.txt 1> ../../per_gene/EOG091G0A2L/get_seqs.stdout.txt 2> ../../per_gene/EOG091G0A2L/get_seqs.stderr.txt
	mv EOG091G0A2L.fasta $basedir/per_gene/EOG091G0A2L/EOG091G0A2L.ingroup.fasta
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/72476f9d9a5bd0627b4d721143a21354.simg
[Sun Jul  5 23:35:56 2020]
Finished job 553.
2215 of 3292 steps (67%) done

[Sun Jul  5 23:35:56 2020]
rule remove_empty:
    input: per_gene/EOG091G09MU/ALICUT_EOG091G09MU.clustalo.fasta
    output: per_gene/EOG091G09MU/empty_check.done
    jobid: 1375
    wildcards: BUSCO=EOG091G09MU


         if [ "$(cat per_gene/EOG091G09MU/ALICUT_EOG091G09MU.clustalo.fasta | grep -v ">" | sed 's/-//g' | grep "^$" | wc -l)" -gt 0 ]
         then
              cp per_gene/EOG091G09MU/ALICUT_EOG091G09MU.clustalo.fasta per_gene/EOG091G09MU/ALICUT_EOG091G09MU.clustalo.fasta.backup
              bash ../scripts/remove_empty.sh per_gene/EOG091G09MU/ALICUT_EOG091G09MU.clustalo.fasta.backup > per_gene/EOG091G09MU/ALICUT_EOG091G09MU.clustalo.fasta
         fi
         touch per_gene/EOG091G09MU/empty_check.done
         
[Sun Jul  5 23:35:56 2020]
Finished job 1375.
2216 of 3292 steps (67%) done

[Sun Jul  5 23:35:56 2020]
rule find_best_model:
    input: per_gene/EOG091G09MU/ALICUT_EOG091G09MU.clustalo.fasta, per_gene/EOG091G09MU/empty_check.done
    output: per_gene/EOG091G09MU/EOG091G09MU.best_model
    log: per_gene/EOG091G09MU/find_best_model.stderr.txt
    jobid: 552
    wildcards: BUSCO=EOG091G09MU
    threads: 2


        cd per_gene/EOG091G09MU
        if [ ! -d find_best_model ]
        then
            mkdir find_best_model
        fi
        cd find_best_model
        ln -s ../../../per_gene/EOG091G09MU/ALICUT_EOG091G09MU.clustalo.fasta EOG091G09MU.fasta
        ProteinModelSelection.pl EOG091G09MU.fasta 1> ../../../per_gene/EOG091G09MU/EOG091G09MU.best_model 2> ../../../per_gene/EOG091G09MU/find_best_model.stderr.txt
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/c0c09ee657b1e27f2c5687e0e9aa8d70.simg
[Sun Jul  5 23:35:57 2020]
Finished job 2594.
2217 of 3292 steps (67%) done

[Sun Jul  5 23:35:57 2020]
rule get_outgroups:
    input: per_gene/EOG091G08O3/EOG091G08O3.ingroup.fasta
    output: per_gene/EOG091G08O3/EOG091G08O3.orthodb.fasta, per_gene/EOG091G08O3/EOG091G08O3.outgroup.fasta
    log: per_gene/EOG091G08O3/get_outgroups.stdout.txt, per_gene/EOG091G08O3/get_outgroups.stderr.txt
    jobid: 2595
    wildcards: BUSCO=EOG091G08O3


        #download fastas from Orhtodb for BUSCO id
        for i in {1..5}
        do
             wget "http://www.orthodb.org/fasta?query=EOG091G08O3&level=33208" -O per_gene/EOG091G08O3/EOG091G08O3.orthodb.fasta 1> per_gene/EOG091G08O3/get_outgroups.stdout.txt 2> per_gene/EOG091G08O3/get_outgroups.stderr.txt && break || echo -e "try again ($i)" && sleep 15
        done

	#This is quick an dirty for now and just takes the first protein if there is more than one for an outgroup taxon
        bash ../scripts/download_outgroups.sh taxids.txt per_gene/EOG091G08O3/EOG091G08O3.orthodb.fasta > per_gene/EOG091G08O3/EOG091G08O3.outgroup.fasta
        
[Sun Jul  5 23:35:57 2020]
Finished job 30.
2218 of 3292 steps (67%) done

[Sun Jul  5 23:35:57 2020]
rule get_seqs:
    input: /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ingroup.txt, /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/outgroup.txt
    output: per_gene/EOG091G0YVI/EOG091G0YVI.ingroup.fasta
    log: per_gene/EOG091G0YVI/get_seqs.stdout.txt, per_gene/EOG091G0YVI/get_seqs.stderr.txt
    jobid: 2900
    wildcards: BUSCO=EOG091G0YVI
    threads: 2


	basedir=$(pwd)
        cd per_gene/EOG091G0YVI
        
        bash $basedir/../scripts/fetch_seqs.sh EOG091G0YVI /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ingroup.txt /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/outgroup.txt 1> ../../per_gene/EOG091G0YVI/get_seqs.stdout.txt 2> ../../per_gene/EOG091G0YVI/get_seqs.stderr.txt
	mv EOG091G0YVI.fasta $basedir/per_gene/EOG091G0YVI/EOG091G0YVI.ingroup.fasta
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/72476f9d9a5bd0627b4d721143a21354.simg
[Sun Jul  5 23:35:58 2020]
Finished job 2595.
2219 of 3292 steps (67%) done

[Sun Jul  5 23:35:58 2020]
rule join_groups:
    input: per_gene/EOG091G08O3/EOG091G08O3.ingroup.fasta, per_gene/EOG091G08O3/EOG091G08O3.outgroup.fasta
    output: per_gene/EOG091G08O3/EOG091G08O3.fasta
    jobid: 2121
    wildcards: BUSCO=EOG091G08O3


        cat per_gene/EOG091G08O3/EOG091G08O3.ingroup.fasta per_gene/EOG091G08O3/EOG091G08O3.outgroup.fasta > per_gene/EOG091G08O3/EOG091G08O3.fasta
        
[Sun Jul  5 23:35:58 2020]
Finished job 2121.
2220 of 3292 steps (67%) done

[Sun Jul  5 23:35:58 2020]
rule MSA:
    input: per_gene/EOG091G08O3/EOG091G08O3.fasta
    output: per_gene/EOG091G08O3/EOG091G08O3.clustalo.fasta
    log: per_gene/EOG091G08O3/MSA.stdout.txt, per_gene/EOG091G08O3/MSA.stderr.txt
    jobid: 1362
    wildcards: BUSCO=EOG091G08O3
    threads: 2


        clustalo -i per_gene/EOG091G08O3/EOG091G08O3.fasta -o per_gene/EOG091G08O3/EOG091G08O3.clustalo.fasta --threads=2 1> per_gene/EOG091G08O3/MSA.stdout.txt 2> per_gene/EOG091G08O3/MSA.stderr.txt
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/d68c9691725a7401923680874285c430.simg
[Sun Jul  5 23:36:00 2020]
Finished job 1362.
2221 of 3292 steps (67%) done

[Sun Jul  5 23:36:00 2020]
rule score_and_cut:
    input: per_gene/EOG091G08O3/EOG091G08O3.clustalo.fasta
    output: per_gene/EOG091G08O3/ALICUT_EOG091G08O3.clustalo.fasta
    jobid: 539
    wildcards: BUSCO=EOG091G08O3
    threads: 2


        cd per_gene/EOG091G08O3
        Aliscore.pl -N -r 200000000000000000 -i ../../per_gene/EOG091G08O3/EOG091G08O3.clustalo.fasta &> aliscore.log
        ALICUT.pl -s &> alicut.log
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/63c88c27a0fa300f57066b0ef65fefcb.simg
[Sun Jul  5 23:36:01 2020]
Finished job 2622.
2222 of 3292 steps (67%) done

[Sun Jul  5 23:36:01 2020]
rule get_outgroups:
    input: per_gene/EOG091G0AFP/EOG091G0AFP.ingroup.fasta
    output: per_gene/EOG091G0AFP/EOG091G0AFP.orthodb.fasta, per_gene/EOG091G0AFP/EOG091G0AFP.outgroup.fasta
    log: per_gene/EOG091G0AFP/get_outgroups.stdout.txt, per_gene/EOG091G0AFP/get_outgroups.stderr.txt
    jobid: 2623
    wildcards: BUSCO=EOG091G0AFP


        #download fastas from Orhtodb for BUSCO id
        for i in {1..5}
        do
             wget "http://www.orthodb.org/fasta?query=EOG091G0AFP&level=33208" -O per_gene/EOG091G0AFP/EOG091G0AFP.orthodb.fasta 1> per_gene/EOG091G0AFP/get_outgroups.stdout.txt 2> per_gene/EOG091G0AFP/get_outgroups.stderr.txt && break || echo -e "try again ($i)" && sleep 15
        done

	#This is quick an dirty for now and just takes the first protein if there is more than one for an outgroup taxon
        bash ../scripts/download_outgroups.sh taxids.txt per_gene/EOG091G0AFP/EOG091G0AFP.orthodb.fasta > per_gene/EOG091G0AFP/EOG091G0AFP.outgroup.fasta
        
[Sun Jul  5 23:36:01 2020]
Finished job 2623.
2223 of 3292 steps (68%) done

[Sun Jul  5 23:36:01 2020]
rule join_groups:
    input: per_gene/EOG091G0AFP/EOG091G0AFP.ingroup.fasta, per_gene/EOG091G0AFP/EOG091G0AFP.outgroup.fasta
    output: per_gene/EOG091G0AFP/EOG091G0AFP.fasta
    jobid: 2135
    wildcards: BUSCO=EOG091G0AFP


        cat per_gene/EOG091G0AFP/EOG091G0AFP.ingroup.fasta per_gene/EOG091G0AFP/EOG091G0AFP.outgroup.fasta > per_gene/EOG091G0AFP/EOG091G0AFP.fasta
        
[Sun Jul  5 23:36:01 2020]
Finished job 2135.
2224 of 3292 steps (68%) done

[Sun Jul  5 23:36:01 2020]
rule MSA:
    input: per_gene/EOG091G0AFP/EOG091G0AFP.fasta
    output: per_gene/EOG091G0AFP/EOG091G0AFP.clustalo.fasta
    log: per_gene/EOG091G0AFP/MSA.stdout.txt, per_gene/EOG091G0AFP/MSA.stderr.txt
    jobid: 1390
    wildcards: BUSCO=EOG091G0AFP
    threads: 2


        clustalo -i per_gene/EOG091G0AFP/EOG091G0AFP.fasta -o per_gene/EOG091G0AFP/EOG091G0AFP.clustalo.fasta --threads=2 1> per_gene/EOG091G0AFP/MSA.stdout.txt 2> per_gene/EOG091G0AFP/MSA.stderr.txt
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/d68c9691725a7401923680874285c430.simg
[Sun Jul  5 23:36:02 2020]
Finished job 1390.
2225 of 3292 steps (68%) done

[Sun Jul  5 23:36:02 2020]
rule score_and_cut:
    input: per_gene/EOG091G0AFP/EOG091G0AFP.clustalo.fasta
    output: per_gene/EOG091G0AFP/ALICUT_EOG091G0AFP.clustalo.fasta
    jobid: 567
    wildcards: BUSCO=EOG091G0AFP
    threads: 2


        cd per_gene/EOG091G0AFP
        Aliscore.pl -N -r 200000000000000000 -i ../../per_gene/EOG091G0AFP/EOG091G0AFP.clustalo.fasta &> aliscore.log
        ALICUT.pl -s &> alicut.log
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/63c88c27a0fa300f57066b0ef65fefcb.simg
[Sun Jul  5 23:36:05 2020]
Finished job 2756.
2226 of 3292 steps (68%) done

[Sun Jul  5 23:36:05 2020]
rule get_outgroups:
    input: per_gene/EOG091G0M12/EOG091G0M12.ingroup.fasta
    output: per_gene/EOG091G0M12/EOG091G0M12.orthodb.fasta, per_gene/EOG091G0M12/EOG091G0M12.outgroup.fasta
    log: per_gene/EOG091G0M12/get_outgroups.stdout.txt, per_gene/EOG091G0M12/get_outgroups.stderr.txt
    jobid: 2757
    wildcards: BUSCO=EOG091G0M12


        #download fastas from Orhtodb for BUSCO id
        for i in {1..5}
        do
             wget "http://www.orthodb.org/fasta?query=EOG091G0M12&level=33208" -O per_gene/EOG091G0M12/EOG091G0M12.orthodb.fasta 1> per_gene/EOG091G0M12/get_outgroups.stdout.txt 2> per_gene/EOG091G0M12/get_outgroups.stderr.txt && break || echo -e "try again ($i)" && sleep 15
        done

	#This is quick an dirty for now and just takes the first protein if there is more than one for an outgroup taxon
        bash ../scripts/download_outgroups.sh taxids.txt per_gene/EOG091G0M12/EOG091G0M12.orthodb.fasta > per_gene/EOG091G0M12/EOG091G0M12.outgroup.fasta
        
[Sun Jul  5 23:36:05 2020]
Finished job 2757.
2227 of 3292 steps (68%) done

[Sun Jul  5 23:36:05 2020]
rule join_groups:
    input: per_gene/EOG091G0M12/EOG091G0M12.ingroup.fasta, per_gene/EOG091G0M12/EOG091G0M12.outgroup.fasta
    output: per_gene/EOG091G0M12/EOG091G0M12.fasta
    jobid: 2202
    wildcards: BUSCO=EOG091G0M12


        cat per_gene/EOG091G0M12/EOG091G0M12.ingroup.fasta per_gene/EOG091G0M12/EOG091G0M12.outgroup.fasta > per_gene/EOG091G0M12/EOG091G0M12.fasta
        
[Sun Jul  5 23:36:05 2020]
Finished job 2202.
2228 of 3292 steps (68%) done

[Sun Jul  5 23:36:05 2020]
rule MSA:
    input: per_gene/EOG091G0M12/EOG091G0M12.fasta
    output: per_gene/EOG091G0M12/EOG091G0M12.clustalo.fasta
    log: per_gene/EOG091G0M12/MSA.stdout.txt, per_gene/EOG091G0M12/MSA.stderr.txt
    jobid: 1524
    wildcards: BUSCO=EOG091G0M12
    threads: 2


        clustalo -i per_gene/EOG091G0M12/EOG091G0M12.fasta -o per_gene/EOG091G0M12/EOG091G0M12.clustalo.fasta --threads=2 1> per_gene/EOG091G0M12/MSA.stdout.txt 2> per_gene/EOG091G0M12/MSA.stderr.txt
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/d68c9691725a7401923680874285c430.simg
[Sun Jul  5 23:36:06 2020]
Finished job 1524.
2229 of 3292 steps (68%) done

[Sun Jul  5 23:36:06 2020]
rule score_and_cut:
    input: per_gene/EOG091G0M12/EOG091G0M12.clustalo.fasta
    output: per_gene/EOG091G0M12/ALICUT_EOG091G0M12.clustalo.fasta
    jobid: 701
    wildcards: BUSCO=EOG091G0M12
    threads: 2


        cd per_gene/EOG091G0M12
        Aliscore.pl -N -r 200000000000000000 -i ../../per_gene/EOG091G0M12/EOG091G0M12.clustalo.fasta &> aliscore.log
        ALICUT.pl -s &> alicut.log
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/63c88c27a0fa300f57066b0ef65fefcb.simg
[Sun Jul  5 23:36:09 2020]
Finished job 539.
2230 of 3292 steps (68%) done

[Sun Jul  5 23:36:09 2020]
rule remove_empty:
    input: per_gene/EOG091G08O3/ALICUT_EOG091G08O3.clustalo.fasta
    output: per_gene/EOG091G08O3/empty_check.done
    jobid: 1361
    wildcards: BUSCO=EOG091G08O3


         if [ "$(cat per_gene/EOG091G08O3/ALICUT_EOG091G08O3.clustalo.fasta | grep -v ">" | sed 's/-//g' | grep "^$" | wc -l)" -gt 0 ]
         then
              cp per_gene/EOG091G08O3/ALICUT_EOG091G08O3.clustalo.fasta per_gene/EOG091G08O3/ALICUT_EOG091G08O3.clustalo.fasta.backup
              bash ../scripts/remove_empty.sh per_gene/EOG091G08O3/ALICUT_EOG091G08O3.clustalo.fasta.backup > per_gene/EOG091G08O3/ALICUT_EOG091G08O3.clustalo.fasta
         fi
         touch per_gene/EOG091G08O3/empty_check.done
         
[Sun Jul  5 23:36:09 2020]
Finished job 1361.
2231 of 3292 steps (68%) done

[Sun Jul  5 23:36:09 2020]
rule find_best_model:
    input: per_gene/EOG091G08O3/ALICUT_EOG091G08O3.clustalo.fasta, per_gene/EOG091G08O3/empty_check.done
    output: per_gene/EOG091G08O3/EOG091G08O3.best_model
    log: per_gene/EOG091G08O3/find_best_model.stderr.txt
    jobid: 538
    wildcards: BUSCO=EOG091G08O3
    threads: 2


        cd per_gene/EOG091G08O3
        if [ ! -d find_best_model ]
        then
            mkdir find_best_model
        fi
        cd find_best_model
        ln -s ../../../per_gene/EOG091G08O3/ALICUT_EOG091G08O3.clustalo.fasta EOG091G08O3.fasta
        ProteinModelSelection.pl EOG091G08O3.fasta 1> ../../../per_gene/EOG091G08O3/EOG091G08O3.best_model 2> ../../../per_gene/EOG091G08O3/find_best_model.stderr.txt
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/c0c09ee657b1e27f2c5687e0e9aa8d70.simg
[Sun Jul  5 23:36:10 2020]
Finished job 2616.
2232 of 3292 steps (68%) done

[Sun Jul  5 23:36:10 2020]
rule get_outgroups:
    input: per_gene/EOG091G0A2L/EOG091G0A2L.ingroup.fasta
    output: per_gene/EOG091G0A2L/EOG091G0A2L.orthodb.fasta, per_gene/EOG091G0A2L/EOG091G0A2L.outgroup.fasta
    log: per_gene/EOG091G0A2L/get_outgroups.stdout.txt, per_gene/EOG091G0A2L/get_outgroups.stderr.txt
    jobid: 2617
    wildcards: BUSCO=EOG091G0A2L


        #download fastas from Orhtodb for BUSCO id
        for i in {1..5}
        do
             wget "http://www.orthodb.org/fasta?query=EOG091G0A2L&level=33208" -O per_gene/EOG091G0A2L/EOG091G0A2L.orthodb.fasta 1> per_gene/EOG091G0A2L/get_outgroups.stdout.txt 2> per_gene/EOG091G0A2L/get_outgroups.stderr.txt && break || echo -e "try again ($i)" && sleep 15
        done

	#This is quick an dirty for now and just takes the first protein if there is more than one for an outgroup taxon
        bash ../scripts/download_outgroups.sh taxids.txt per_gene/EOG091G0A2L/EOG091G0A2L.orthodb.fasta > per_gene/EOG091G0A2L/EOG091G0A2L.outgroup.fasta
        
[Sun Jul  5 23:36:10 2020]
Finished job 567.
2233 of 3292 steps (68%) done

[Sun Jul  5 23:36:10 2020]
rule remove_empty:
    input: per_gene/EOG091G0AFP/ALICUT_EOG091G0AFP.clustalo.fasta
    output: per_gene/EOG091G0AFP/empty_check.done
    jobid: 1389
    wildcards: BUSCO=EOG091G0AFP


         if [ "$(cat per_gene/EOG091G0AFP/ALICUT_EOG091G0AFP.clustalo.fasta | grep -v ">" | sed 's/-//g' | grep "^$" | wc -l)" -gt 0 ]
         then
              cp per_gene/EOG091G0AFP/ALICUT_EOG091G0AFP.clustalo.fasta per_gene/EOG091G0AFP/ALICUT_EOG091G0AFP.clustalo.fasta.backup
              bash ../scripts/remove_empty.sh per_gene/EOG091G0AFP/ALICUT_EOG091G0AFP.clustalo.fasta.backup > per_gene/EOG091G0AFP/ALICUT_EOG091G0AFP.clustalo.fasta
         fi
         touch per_gene/EOG091G0AFP/empty_check.done
         

[Sun Jul  5 23:36:10 2020]
rule get_seqs:
    input: /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ingroup.txt, /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/outgroup.txt
    output: per_gene/EOG091G0VZF/EOG091G0VZF.ingroup.fasta
    log: per_gene/EOG091G0VZF/get_seqs.stdout.txt, per_gene/EOG091G0VZF/get_seqs.stderr.txt
    jobid: 3032
    wildcards: BUSCO=EOG091G0VZF
    threads: 2


	basedir=$(pwd)
        cd per_gene/EOG091G0VZF
        
        bash $basedir/../scripts/fetch_seqs.sh EOG091G0VZF /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ingroup.txt /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/outgroup.txt 1> ../../per_gene/EOG091G0VZF/get_seqs.stdout.txt 2> ../../per_gene/EOG091G0VZF/get_seqs.stderr.txt
	mv EOG091G0VZF.fasta $basedir/per_gene/EOG091G0VZF/EOG091G0VZF.ingroup.fasta
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/72476f9d9a5bd0627b4d721143a21354.simg
[Sun Jul  5 23:36:10 2020]
Finished job 1389.
2234 of 3292 steps (68%) done
[Sun Jul  5 23:36:11 2020]
Finished job 2617.
2235 of 3292 steps (68%) done

[Sun Jul  5 23:36:11 2020]
rule join_groups:
    input: per_gene/EOG091G0A2L/EOG091G0A2L.ingroup.fasta, per_gene/EOG091G0A2L/EOG091G0A2L.outgroup.fasta
    output: per_gene/EOG091G0A2L/EOG091G0A2L.fasta
    jobid: 2132
    wildcards: BUSCO=EOG091G0A2L


        cat per_gene/EOG091G0A2L/EOG091G0A2L.ingroup.fasta per_gene/EOG091G0A2L/EOG091G0A2L.outgroup.fasta > per_gene/EOG091G0A2L/EOG091G0A2L.fasta
        
[Sun Jul  5 23:36:11 2020]
Finished job 2132.
2236 of 3292 steps (68%) done

[Sun Jul  5 23:36:11 2020]
rule MSA:
    input: per_gene/EOG091G0A2L/EOG091G0A2L.fasta
    output: per_gene/EOG091G0A2L/EOG091G0A2L.clustalo.fasta
    log: per_gene/EOG091G0A2L/MSA.stdout.txt, per_gene/EOG091G0A2L/MSA.stderr.txt
    jobid: 1384
    wildcards: BUSCO=EOG091G0A2L
    threads: 2


        clustalo -i per_gene/EOG091G0A2L/EOG091G0A2L.fasta -o per_gene/EOG091G0A2L/EOG091G0A2L.clustalo.fasta --threads=2 1> per_gene/EOG091G0A2L/MSA.stdout.txt 2> per_gene/EOG091G0A2L/MSA.stderr.txt
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/d68c9691725a7401923680874285c430.simg
[Sun Jul  5 23:36:13 2020]
Finished job 1384.
2237 of 3292 steps (68%) done

[Sun Jul  5 23:36:13 2020]
rule score_and_cut:
    input: per_gene/EOG091G0A2L/EOG091G0A2L.clustalo.fasta
    output: per_gene/EOG091G0A2L/ALICUT_EOG091G0A2L.clustalo.fasta
    jobid: 561
    wildcards: BUSCO=EOG091G0A2L
    threads: 2


        cd per_gene/EOG091G0A2L
        Aliscore.pl -N -r 200000000000000000 -i ../../per_gene/EOG091G0A2L/EOG091G0A2L.clustalo.fasta &> aliscore.log
        ALICUT.pl -s &> alicut.log
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/63c88c27a0fa300f57066b0ef65fefcb.simg
[Sun Jul  5 23:36:14 2020]
Finished job 2900.
2238 of 3292 steps (68%) done

[Sun Jul  5 23:36:14 2020]
rule find_best_model:
    input: per_gene/EOG091G0AFP/ALICUT_EOG091G0AFP.clustalo.fasta, per_gene/EOG091G0AFP/empty_check.done
    output: per_gene/EOG091G0AFP/EOG091G0AFP.best_model
    log: per_gene/EOG091G0AFP/find_best_model.stderr.txt
    jobid: 566
    wildcards: BUSCO=EOG091G0AFP
    threads: 2


        cd per_gene/EOG091G0AFP
        if [ ! -d find_best_model ]
        then
            mkdir find_best_model
        fi
        cd find_best_model
        ln -s ../../../per_gene/EOG091G0AFP/ALICUT_EOG091G0AFP.clustalo.fasta EOG091G0AFP.fasta
        ProteinModelSelection.pl EOG091G0AFP.fasta 1> ../../../per_gene/EOG091G0AFP/EOG091G0AFP.best_model 2> ../../../per_gene/EOG091G0AFP/find_best_model.stderr.txt
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/c0c09ee657b1e27f2c5687e0e9aa8d70.simg
[Sun Jul  5 23:36:14 2020]
Finished job 870.
2239 of 3292 steps (68%) done

[Sun Jul  5 23:36:14 2020]
rule get_outgroups:
    input: per_gene/EOG091G0YVI/EOG091G0YVI.ingroup.fasta
    output: per_gene/EOG091G0YVI/EOG091G0YVI.orthodb.fasta, per_gene/EOG091G0YVI/EOG091G0YVI.outgroup.fasta
    log: per_gene/EOG091G0YVI/get_outgroups.stdout.txt, per_gene/EOG091G0YVI/get_outgroups.stderr.txt
    jobid: 2901
    wildcards: BUSCO=EOG091G0YVI


        #download fastas from Orhtodb for BUSCO id
        for i in {1..5}
        do
             wget "http://www.orthodb.org/fasta?query=EOG091G0YVI&level=33208" -O per_gene/EOG091G0YVI/EOG091G0YVI.orthodb.fasta 1> per_gene/EOG091G0YVI/get_outgroups.stdout.txt 2> per_gene/EOG091G0YVI/get_outgroups.stderr.txt && break || echo -e "try again ($i)" && sleep 15
        done

	#This is quick an dirty for now and just takes the first protein if there is more than one for an outgroup taxon
        bash ../scripts/download_outgroups.sh taxids.txt per_gene/EOG091G0YVI/EOG091G0YVI.orthodb.fasta > per_gene/EOG091G0YVI/EOG091G0YVI.outgroup.fasta
        
[Sun Jul  5 23:36:14 2020]
Finished job 2901.
2240 of 3292 steps (68%) done

[Sun Jul  5 23:36:14 2020]
rule join_groups:
    input: per_gene/EOG091G0YVI/EOG091G0YVI.ingroup.fasta, per_gene/EOG091G0YVI/EOG091G0YVI.outgroup.fasta
    output: per_gene/EOG091G0YVI/EOG091G0YVI.fasta
    jobid: 2274
    wildcards: BUSCO=EOG091G0YVI


        cat per_gene/EOG091G0YVI/EOG091G0YVI.ingroup.fasta per_gene/EOG091G0YVI/EOG091G0YVI.outgroup.fasta > per_gene/EOG091G0YVI/EOG091G0YVI.fasta
        
[Sun Jul  5 23:36:14 2020]
Finished job 2274.
2241 of 3292 steps (68%) done

[Sun Jul  5 23:36:14 2020]
rule MSA:
    input: per_gene/EOG091G0YVI/EOG091G0YVI.fasta
    output: per_gene/EOG091G0YVI/EOG091G0YVI.clustalo.fasta
    log: per_gene/EOG091G0YVI/MSA.stdout.txt, per_gene/EOG091G0YVI/MSA.stderr.txt
    jobid: 1668
    wildcards: BUSCO=EOG091G0YVI
    threads: 2


        clustalo -i per_gene/EOG091G0YVI/EOG091G0YVI.fasta -o per_gene/EOG091G0YVI/EOG091G0YVI.clustalo.fasta --threads=2 1> per_gene/EOG091G0YVI/MSA.stdout.txt 2> per_gene/EOG091G0YVI/MSA.stderr.txt
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/d68c9691725a7401923680874285c430.simg
[Sun Jul  5 23:36:15 2020]
Finished job 701.
2242 of 3292 steps (68%) done

[Sun Jul  5 23:36:15 2020]
rule remove_empty:
    input: per_gene/EOG091G0M12/ALICUT_EOG091G0M12.clustalo.fasta
    output: per_gene/EOG091G0M12/empty_check.done
    jobid: 1523
    wildcards: BUSCO=EOG091G0M12


         if [ "$(cat per_gene/EOG091G0M12/ALICUT_EOG091G0M12.clustalo.fasta | grep -v ">" | sed 's/-//g' | grep "^$" | wc -l)" -gt 0 ]
         then
              cp per_gene/EOG091G0M12/ALICUT_EOG091G0M12.clustalo.fasta per_gene/EOG091G0M12/ALICUT_EOG091G0M12.clustalo.fasta.backup
              bash ../scripts/remove_empty.sh per_gene/EOG091G0M12/ALICUT_EOG091G0M12.clustalo.fasta.backup > per_gene/EOG091G0M12/ALICUT_EOG091G0M12.clustalo.fasta
         fi
         touch per_gene/EOG091G0M12/empty_check.done
         
[Sun Jul  5 23:36:15 2020]
Finished job 1523.
2243 of 3292 steps (68%) done

[Sun Jul  5 23:36:15 2020]
rule find_best_model:
    input: per_gene/EOG091G0M12/ALICUT_EOG091G0M12.clustalo.fasta, per_gene/EOG091G0M12/empty_check.done
    output: per_gene/EOG091G0M12/EOG091G0M12.best_model
    log: per_gene/EOG091G0M12/find_best_model.stderr.txt
    jobid: 700
    wildcards: BUSCO=EOG091G0M12
    threads: 2


        cd per_gene/EOG091G0M12
        if [ ! -d find_best_model ]
        then
            mkdir find_best_model
        fi
        cd find_best_model
        ln -s ../../../per_gene/EOG091G0M12/ALICUT_EOG091G0M12.clustalo.fasta EOG091G0M12.fasta
        ProteinModelSelection.pl EOG091G0M12.fasta 1> ../../../per_gene/EOG091G0M12/EOG091G0M12.best_model 2> ../../../per_gene/EOG091G0M12/find_best_model.stderr.txt
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/c0c09ee657b1e27f2c5687e0e9aa8d70.simg
[Sun Jul  5 23:36:15 2020]
Finished job 736.
2244 of 3292 steps (68%) done

[Sun Jul  5 23:36:15 2020]
rule infer_single_ML:
    input: per_gene/EOG091G0NVA/EOG091G0NVA.best_model, per_gene/EOG091G0NVA/ALICUT_EOG091G0NVA.clustalo.fasta
    output: per_gene/EOG091G0NVA/EOG091G0NVA.raxml.done
    log: per_gene/EOG091G0NVA/infer_single_ML.stdout.txt, per_gene/EOG091G0NVA/infer_single_ML.stderr.txt
    jobid: 162
    wildcards: BUSCO=EOG091G0NVA
    threads: 2


        cd per_gene/EOG091G0NVA
	count=$(cat ../../per_gene/EOG091G0NVA/ALICUT_EOG091G0NVA.clustalo.fasta | grep ">" | wc -l)
	if [ "$count" -gt 5 ]
        then
		RAxMLmodel=$(cat ../../per_gene/EOG091G0NVA/EOG091G0NVA.best_model | grep "Best" | cut -d ":" -f 2 | tr -d '[:space:]')
                if [ "$(ls -1 | grep "^RAxML" | wc -l)" -ne 0 ]
		then
			rm RAxML*
		fi
        	raxml -f a -T 2 -m PROTGAMMA$RAxMLmodel         	-p 12345 -x 12345 -# 100         	-s ../../per_gene/EOG091G0NVA/ALICUT_EOG091G0NVA.clustalo.fasta -n EOG091G0NVA.clustalo.aln.ALICUT.$RAxMLmodel 		1> ../../per_gene/EOG091G0NVA/infer_single_ML.stdout.txt 2> ../../per_gene/EOG091G0NVA/infer_single_ML.stderr.txt
	else
		echo "fasta file per_gene/EOG091G0NVA/ALICUT_EOG091G0NVA.clustalo.fasta contains fewer than 5 sequences - skipped" > ../../per_gene/EOG091G0NVA/infer_single_ML.stdout.txt
		touch raxml.skipped
	fi
        touch ../../per_gene/EOG091G0NVA/EOG091G0NVA.raxml.done
        
[Sun Jul  5 23:36:18 2020]
Finished job 1668.
2245 of 3292 steps (68%) done

[Sun Jul  5 23:36:18 2020]
rule score_and_cut:
    input: per_gene/EOG091G0YVI/EOG091G0YVI.clustalo.fasta
    output: per_gene/EOG091G0YVI/ALICUT_EOG091G0YVI.clustalo.fasta
    jobid: 845
    wildcards: BUSCO=EOG091G0YVI
    threads: 2


        cd per_gene/EOG091G0YVI
        Aliscore.pl -N -r 200000000000000000 -i ../../per_gene/EOG091G0YVI/EOG091G0YVI.clustalo.fasta &> aliscore.log
        ALICUT.pl -s &> alicut.log
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/63c88c27a0fa300f57066b0ef65fefcb.simg
[Sun Jul  5 23:36:22 2020]
Finished job 561.
2246 of 3292 steps (68%) done

[Sun Jul  5 23:36:22 2020]
rule remove_empty:
    input: per_gene/EOG091G0A2L/ALICUT_EOG091G0A2L.clustalo.fasta
    output: per_gene/EOG091G0A2L/empty_check.done
    jobid: 1383
    wildcards: BUSCO=EOG091G0A2L


         if [ "$(cat per_gene/EOG091G0A2L/ALICUT_EOG091G0A2L.clustalo.fasta | grep -v ">" | sed 's/-//g' | grep "^$" | wc -l)" -gt 0 ]
         then
              cp per_gene/EOG091G0A2L/ALICUT_EOG091G0A2L.clustalo.fasta per_gene/EOG091G0A2L/ALICUT_EOG091G0A2L.clustalo.fasta.backup
              bash ../scripts/remove_empty.sh per_gene/EOG091G0A2L/ALICUT_EOG091G0A2L.clustalo.fasta.backup > per_gene/EOG091G0A2L/ALICUT_EOG091G0A2L.clustalo.fasta
         fi
         touch per_gene/EOG091G0A2L/empty_check.done
         
[Sun Jul  5 23:36:23 2020]
Finished job 1383.
2247 of 3292 steps (68%) done

[Sun Jul  5 23:36:23 2020]
rule find_best_model:
    input: per_gene/EOG091G0A2L/ALICUT_EOG091G0A2L.clustalo.fasta, per_gene/EOG091G0A2L/empty_check.done
    output: per_gene/EOG091G0A2L/EOG091G0A2L.best_model
    log: per_gene/EOG091G0A2L/find_best_model.stderr.txt
    jobid: 560
    wildcards: BUSCO=EOG091G0A2L
    threads: 2


        cd per_gene/EOG091G0A2L
        if [ ! -d find_best_model ]
        then
            mkdir find_best_model
        fi
        cd find_best_model
        ln -s ../../../per_gene/EOG091G0A2L/ALICUT_EOG091G0A2L.clustalo.fasta EOG091G0A2L.fasta
        ProteinModelSelection.pl EOG091G0A2L.fasta 1> ../../../per_gene/EOG091G0A2L/EOG091G0A2L.best_model 2> ../../../per_gene/EOG091G0A2L/find_best_model.stderr.txt
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/c0c09ee657b1e27f2c5687e0e9aa8d70.simg
[Sun Jul  5 23:36:24 2020]
Finished job 914.
2248 of 3292 steps (68%) done

[Sun Jul  5 23:36:24 2020]
rule infer_single_ML:
    input: per_gene/EOG091G0BTX/EOG091G0BTX.best_model, per_gene/EOG091G0BTX/ALICUT_EOG091G0BTX.clustalo.fasta
    output: per_gene/EOG091G0BTX/EOG091G0BTX.raxml.done
    log: per_gene/EOG091G0BTX/infer_single_ML.stdout.txt, per_gene/EOG091G0BTX/infer_single_ML.stderr.txt
    jobid: 251
    wildcards: BUSCO=EOG091G0BTX
    threads: 2


        cd per_gene/EOG091G0BTX
	count=$(cat ../../per_gene/EOG091G0BTX/ALICUT_EOG091G0BTX.clustalo.fasta | grep ">" | wc -l)
	if [ "$count" -gt 5 ]
        then
		RAxMLmodel=$(cat ../../per_gene/EOG091G0BTX/EOG091G0BTX.best_model | grep "Best" | cut -d ":" -f 2 | tr -d '[:space:]')
                if [ "$(ls -1 | grep "^RAxML" | wc -l)" -ne 0 ]
		then
			rm RAxML*
		fi
        	raxml -f a -T 2 -m PROTGAMMA$RAxMLmodel         	-p 12345 -x 12345 -# 100         	-s ../../per_gene/EOG091G0BTX/ALICUT_EOG091G0BTX.clustalo.fasta -n EOG091G0BTX.clustalo.aln.ALICUT.$RAxMLmodel 		1> ../../per_gene/EOG091G0BTX/infer_single_ML.stdout.txt 2> ../../per_gene/EOG091G0BTX/infer_single_ML.stderr.txt
	else
		echo "fasta file per_gene/EOG091G0BTX/ALICUT_EOG091G0BTX.clustalo.fasta contains fewer than 5 sequences - skipped" > ../../per_gene/EOG091G0BTX/infer_single_ML.stdout.txt
		touch raxml.skipped
	fi
        touch ../../per_gene/EOG091G0BTX/EOG091G0BTX.raxml.done
        
[33mJob counts:
	count	jobs
	1	infer_single_ML
	1[0m
[33m
        cd per_gene/EOG091G0NVA
	count=$(cat ../../per_gene/EOG091G0NVA/ALICUT_EOG091G0NVA.clustalo.fasta | grep ">" | wc -l)
	if [ "$count" -gt 5 ]
        then
		RAxMLmodel=$(cat ../../per_gene/EOG091G0NVA/EOG091G0NVA.best_model | grep "Best" | cut -d ":" -f 2 | tr -d '[:space:]')
                if [ "$(ls -1 | grep "^RAxML" | wc -l)" -ne 0 ]
		then
			rm RAxML*
		fi
        	raxml -f a -T 2 -m PROTGAMMA$RAxMLmodel         	-p 12345 -x 12345 -# 100         	-s ../../per_gene/EOG091G0NVA/ALICUT_EOG091G0NVA.clustalo.fasta -n EOG091G0NVA.clustalo.aln.ALICUT.$RAxMLmodel 		1> ../../per_gene/EOG091G0NVA/infer_single_ML.stdout.txt 2> ../../per_gene/EOG091G0NVA/infer_single_ML.stderr.txt
	else
		echo "fasta file per_gene/EOG091G0NVA/ALICUT_EOG091G0NVA.clustalo.fasta contains fewer than 5 sequences - skipped" > ../../per_gene/EOG091G0NVA/infer_single_ML.stdout.txt
		touch raxml.skipped
	fi
        touch ../../per_gene/EOG091G0NVA/EOG091G0NVA.raxml.done
        [0m
[Sun Jul  5 23:36:25 2020]
Finished job 3032.
2249 of 3292 steps (68%) done

[Sun Jul  5 23:36:25 2020]
rule get_outgroups:
    input: per_gene/EOG091G0VZF/EOG091G0VZF.ingroup.fasta
    output: per_gene/EOG091G0VZF/EOG091G0VZF.orthodb.fasta, per_gene/EOG091G0VZF/EOG091G0VZF.outgroup.fasta
    log: per_gene/EOG091G0VZF/get_outgroups.stdout.txt, per_gene/EOG091G0VZF/get_outgroups.stderr.txt
    jobid: 3033
    wildcards: BUSCO=EOG091G0VZF


        #download fastas from Orhtodb for BUSCO id
        for i in {1..5}
        do
             wget "http://www.orthodb.org/fasta?query=EOG091G0VZF&level=33208" -O per_gene/EOG091G0VZF/EOG091G0VZF.orthodb.fasta 1> per_gene/EOG091G0VZF/get_outgroups.stdout.txt 2> per_gene/EOG091G0VZF/get_outgroups.stderr.txt && break || echo -e "try again ($i)" && sleep 15
        done

	#This is quick an dirty for now and just takes the first protein if there is more than one for an outgroup taxon
        bash ../scripts/download_outgroups.sh taxids.txt per_gene/EOG091G0VZF/EOG091G0VZF.orthodb.fasta > per_gene/EOG091G0VZF/EOG091G0VZF.outgroup.fasta
        
[33mJob counts:
	count	jobs
	1	infer_single_ML
	1[0m
[33m
        cd per_gene/EOG091G0BTX
	count=$(cat ../../per_gene/EOG091G0BTX/ALICUT_EOG091G0BTX.clustalo.fasta | grep ">" | wc -l)
	if [ "$count" -gt 5 ]
        then
		RAxMLmodel=$(cat ../../per_gene/EOG091G0BTX/EOG091G0BTX.best_model | grep "Best" | cut -d ":" -f 2 | tr -d '[:space:]')
                if [ "$(ls -1 | grep "^RAxML" | wc -l)" -ne 0 ]
		then
			rm RAxML*
		fi
        	raxml -f a -T 2 -m PROTGAMMA$RAxMLmodel         	-p 12345 -x 12345 -# 100         	-s ../../per_gene/EOG091G0BTX/ALICUT_EOG091G0BTX.clustalo.fasta -n EOG091G0BTX.clustalo.aln.ALICUT.$RAxMLmodel 		1> ../../per_gene/EOG091G0BTX/infer_single_ML.stdout.txt 2> ../../per_gene/EOG091G0BTX/infer_single_ML.stderr.txt
	else
		echo "fasta file per_gene/EOG091G0BTX/ALICUT_EOG091G0BTX.clustalo.fasta contains fewer than 5 sequences - skipped" > ../../per_gene/EOG091G0BTX/infer_single_ML.stdout.txt
		touch raxml.skipped
	fi
        touch ../../per_gene/EOG091G0BTX/EOG091G0BTX.raxml.done
        [0m
[Sun Jul  5 23:36:26 2020]
Finished job 3033.
2250 of 3292 steps (68%) done

[Sun Jul  5 23:36:26 2020]
rule join_groups:
    input: per_gene/EOG091G0VZF/EOG091G0VZF.ingroup.fasta, per_gene/EOG091G0VZF/EOG091G0VZF.outgroup.fasta
    output: per_gene/EOG091G0VZF/EOG091G0VZF.fasta
    jobid: 2340
    wildcards: BUSCO=EOG091G0VZF


        cat per_gene/EOG091G0VZF/EOG091G0VZF.ingroup.fasta per_gene/EOG091G0VZF/EOG091G0VZF.outgroup.fasta > per_gene/EOG091G0VZF/EOG091G0VZF.fasta
        
[Sun Jul  5 23:36:26 2020]
Finished job 2340.
2251 of 3292 steps (68%) done

[Sun Jul  5 23:36:26 2020]
rule MSA:
    input: per_gene/EOG091G0VZF/EOG091G0VZF.fasta
    output: per_gene/EOG091G0VZF/EOG091G0VZF.clustalo.fasta
    log: per_gene/EOG091G0VZF/MSA.stdout.txt, per_gene/EOG091G0VZF/MSA.stderr.txt
    jobid: 1800
    wildcards: BUSCO=EOG091G0VZF
    threads: 2


        clustalo -i per_gene/EOG091G0VZF/EOG091G0VZF.fasta -o per_gene/EOG091G0VZF/EOG091G0VZF.clustalo.fasta --threads=2 1> per_gene/EOG091G0VZF/MSA.stdout.txt 2> per_gene/EOG091G0VZF/MSA.stderr.txt
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/d68c9691725a7401923680874285c430.simg
[Sun Jul  5 23:36:27 2020]
Finished job 845.
2252 of 3292 steps (68%) done

[Sun Jul  5 23:36:27 2020]
rule remove_empty:
    input: per_gene/EOG091G0YVI/ALICUT_EOG091G0YVI.clustalo.fasta
    output: per_gene/EOG091G0YVI/empty_check.done
    jobid: 1667
    wildcards: BUSCO=EOG091G0YVI


         if [ "$(cat per_gene/EOG091G0YVI/ALICUT_EOG091G0YVI.clustalo.fasta | grep -v ">" | sed 's/-//g' | grep "^$" | wc -l)" -gt 0 ]
         then
              cp per_gene/EOG091G0YVI/ALICUT_EOG091G0YVI.clustalo.fasta per_gene/EOG091G0YVI/ALICUT_EOG091G0YVI.clustalo.fasta.backup
              bash ../scripts/remove_empty.sh per_gene/EOG091G0YVI/ALICUT_EOG091G0YVI.clustalo.fasta.backup > per_gene/EOG091G0YVI/ALICUT_EOG091G0YVI.clustalo.fasta
         fi
         touch per_gene/EOG091G0YVI/empty_check.done
         
[Sun Jul  5 23:36:27 2020]
Finished job 1667.
2253 of 3292 steps (68%) done

[Sun Jul  5 23:36:27 2020]
rule find_best_model:
    input: per_gene/EOG091G0YVI/ALICUT_EOG091G0YVI.clustalo.fasta, per_gene/EOG091G0YVI/empty_check.done
    output: per_gene/EOG091G0YVI/EOG091G0YVI.best_model
    log: per_gene/EOG091G0YVI/find_best_model.stderr.txt
    jobid: 844
    wildcards: BUSCO=EOG091G0YVI
    threads: 2


        cd per_gene/EOG091G0YVI
        if [ ! -d find_best_model ]
        then
            mkdir find_best_model
        fi
        cd find_best_model
        ln -s ../../../per_gene/EOG091G0YVI/ALICUT_EOG091G0YVI.clustalo.fasta EOG091G0YVI.fasta
        ProteinModelSelection.pl EOG091G0YVI.fasta 1> ../../../per_gene/EOG091G0YVI/EOG091G0YVI.best_model 2> ../../../per_gene/EOG091G0YVI/find_best_model.stderr.txt
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/c0c09ee657b1e27f2c5687e0e9aa8d70.simg
[Sun Jul  5 23:36:27 2020]
Finished job 1800.
2254 of 3292 steps (68%) done

[Sun Jul  5 23:36:27 2020]
rule score_and_cut:
    input: per_gene/EOG091G0VZF/EOG091G0VZF.clustalo.fasta
    output: per_gene/EOG091G0VZF/ALICUT_EOG091G0VZF.clustalo.fasta
    jobid: 977
    wildcards: BUSCO=EOG091G0VZF
    threads: 2


        cd per_gene/EOG091G0VZF
        Aliscore.pl -N -r 200000000000000000 -i ../../per_gene/EOG091G0VZF/EOG091G0VZF.clustalo.fasta &> aliscore.log
        ALICUT.pl -s &> alicut.log
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/63c88c27a0fa300f57066b0ef65fefcb.simg
[Sun Jul  5 23:36:29 2020]
Finished job 552.
2255 of 3292 steps (68%) done

[Sun Jul  5 23:36:29 2020]
rule infer_single_ML:
    input: per_gene/EOG091G09MU/EOG091G09MU.best_model, per_gene/EOG091G09MU/ALICUT_EOG091G09MU.clustalo.fasta
    output: per_gene/EOG091G09MU/EOG091G09MU.raxml.done
    log: per_gene/EOG091G09MU/infer_single_ML.stdout.txt, per_gene/EOG091G09MU/infer_single_ML.stderr.txt
    jobid: 70
    wildcards: BUSCO=EOG091G09MU
    threads: 2


        cd per_gene/EOG091G09MU
	count=$(cat ../../per_gene/EOG091G09MU/ALICUT_EOG091G09MU.clustalo.fasta | grep ">" | wc -l)
	if [ "$count" -gt 5 ]
        then
		RAxMLmodel=$(cat ../../per_gene/EOG091G09MU/EOG091G09MU.best_model | grep "Best" | cut -d ":" -f 2 | tr -d '[:space:]')
                if [ "$(ls -1 | grep "^RAxML" | wc -l)" -ne 0 ]
		then
			rm RAxML*
		fi
        	raxml -f a -T 2 -m PROTGAMMA$RAxMLmodel         	-p 12345 -x 12345 -# 100         	-s ../../per_gene/EOG091G09MU/ALICUT_EOG091G09MU.clustalo.fasta -n EOG091G09MU.clustalo.aln.ALICUT.$RAxMLmodel 		1> ../../per_gene/EOG091G09MU/infer_single_ML.stdout.txt 2> ../../per_gene/EOG091G09MU/infer_single_ML.stderr.txt
	else
		echo "fasta file per_gene/EOG091G09MU/ALICUT_EOG091G09MU.clustalo.fasta contains fewer than 5 sequences - skipped" > ../../per_gene/EOG091G09MU/infer_single_ML.stdout.txt
		touch raxml.skipped
	fi
        touch ../../per_gene/EOG091G09MU/EOG091G09MU.raxml.done
        
[33mJob counts:
	count	jobs
	1	infer_single_ML
	1[0m
[33m
        cd per_gene/EOG091G09MU
	count=$(cat ../../per_gene/EOG091G09MU/ALICUT_EOG091G09MU.clustalo.fasta | grep ">" | wc -l)
	if [ "$count" -gt 5 ]
        then
		RAxMLmodel=$(cat ../../per_gene/EOG091G09MU/EOG091G09MU.best_model | grep "Best" | cut -d ":" -f 2 | tr -d '[:space:]')
                if [ "$(ls -1 | grep "^RAxML" | wc -l)" -ne 0 ]
		then
			rm RAxML*
		fi
        	raxml -f a -T 2 -m PROTGAMMA$RAxMLmodel         	-p 12345 -x 12345 -# 100         	-s ../../per_gene/EOG091G09MU/ALICUT_EOG091G09MU.clustalo.fasta -n EOG091G09MU.clustalo.aln.ALICUT.$RAxMLmodel 		1> ../../per_gene/EOG091G09MU/infer_single_ML.stdout.txt 2> ../../per_gene/EOG091G09MU/infer_single_ML.stderr.txt
	else
		echo "fasta file per_gene/EOG091G09MU/ALICUT_EOG091G09MU.clustalo.fasta contains fewer than 5 sequences - skipped" > ../../per_gene/EOG091G09MU/infer_single_ML.stdout.txt
		touch raxml.skipped
	fi
        touch ../../per_gene/EOG091G09MU/EOG091G09MU.raxml.done
        [0m
[Sun Jul  5 23:36:36 2020]
Finished job 977.
2256 of 3292 steps (69%) done

[Sun Jul  5 23:36:36 2020]
rule remove_empty:
    input: per_gene/EOG091G0VZF/ALICUT_EOG091G0VZF.clustalo.fasta
    output: per_gene/EOG091G0VZF/empty_check.done
    jobid: 1799
    wildcards: BUSCO=EOG091G0VZF


         if [ "$(cat per_gene/EOG091G0VZF/ALICUT_EOG091G0VZF.clustalo.fasta | grep -v ">" | sed 's/-//g' | grep "^$" | wc -l)" -gt 0 ]
         then
              cp per_gene/EOG091G0VZF/ALICUT_EOG091G0VZF.clustalo.fasta per_gene/EOG091G0VZF/ALICUT_EOG091G0VZF.clustalo.fasta.backup
              bash ../scripts/remove_empty.sh per_gene/EOG091G0VZF/ALICUT_EOG091G0VZF.clustalo.fasta.backup > per_gene/EOG091G0VZF/ALICUT_EOG091G0VZF.clustalo.fasta
         fi
         touch per_gene/EOG091G0VZF/empty_check.done
         
[Sun Jul  5 23:36:36 2020]
Finished job 1799.
2257 of 3292 steps (69%) done

[Sun Jul  5 23:36:36 2020]
rule find_best_model:
    input: per_gene/EOG091G0VZF/ALICUT_EOG091G0VZF.clustalo.fasta, per_gene/EOG091G0VZF/empty_check.done
    output: per_gene/EOG091G0VZF/EOG091G0VZF.best_model
    log: per_gene/EOG091G0VZF/find_best_model.stderr.txt
    jobid: 976
    wildcards: BUSCO=EOG091G0VZF
    threads: 2


        cd per_gene/EOG091G0VZF
        if [ ! -d find_best_model ]
        then
            mkdir find_best_model
        fi
        cd find_best_model
        ln -s ../../../per_gene/EOG091G0VZF/ALICUT_EOG091G0VZF.clustalo.fasta EOG091G0VZF.fasta
        ProteinModelSelection.pl EOG091G0VZF.fasta 1> ../../../per_gene/EOG091G0VZF/EOG091G0VZF.best_model 2> ../../../per_gene/EOG091G0VZF/find_best_model.stderr.txt
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/c0c09ee657b1e27f2c5687e0e9aa8d70.simg
[Sun Jul  5 23:36:48 2020]
Finished job 700.
2258 of 3292 steps (69%) done
[Sun Jul  5 23:36:48 2020]
Finished job 566.
2259 of 3292 steps (69%) done

[Sun Jul  5 23:36:48 2020]
rule infer_single_ML:
    input: per_gene/EOG091G0M12/EOG091G0M12.best_model, per_gene/EOG091G0M12/ALICUT_EOG091G0M12.clustalo.fasta
    output: per_gene/EOG091G0M12/EOG091G0M12.raxml.done
    log: per_gene/EOG091G0M12/infer_single_ML.stdout.txt, per_gene/EOG091G0M12/infer_single_ML.stderr.txt
    jobid: 144
    wildcards: BUSCO=EOG091G0M12
    threads: 2


        cd per_gene/EOG091G0M12
	count=$(cat ../../per_gene/EOG091G0M12/ALICUT_EOG091G0M12.clustalo.fasta | grep ">" | wc -l)
	if [ "$count" -gt 5 ]
        then
		RAxMLmodel=$(cat ../../per_gene/EOG091G0M12/EOG091G0M12.best_model | grep "Best" | cut -d ":" -f 2 | tr -d '[:space:]')
                if [ "$(ls -1 | grep "^RAxML" | wc -l)" -ne 0 ]
		then
			rm RAxML*
		fi
        	raxml -f a -T 2 -m PROTGAMMA$RAxMLmodel         	-p 12345 -x 12345 -# 100         	-s ../../per_gene/EOG091G0M12/ALICUT_EOG091G0M12.clustalo.fasta -n EOG091G0M12.clustalo.aln.ALICUT.$RAxMLmodel 		1> ../../per_gene/EOG091G0M12/infer_single_ML.stdout.txt 2> ../../per_gene/EOG091G0M12/infer_single_ML.stderr.txt
	else
		echo "fasta file per_gene/EOG091G0M12/ALICUT_EOG091G0M12.clustalo.fasta contains fewer than 5 sequences - skipped" > ../../per_gene/EOG091G0M12/infer_single_ML.stdout.txt
		touch raxml.skipped
	fi
        touch ../../per_gene/EOG091G0M12/EOG091G0M12.raxml.done
        

[Sun Jul  5 23:36:48 2020]
rule infer_single_ML:
    input: per_gene/EOG091G0AFP/EOG091G0AFP.best_model, per_gene/EOG091G0AFP/ALICUT_EOG091G0AFP.clustalo.fasta
    output: per_gene/EOG091G0AFP/EOG091G0AFP.raxml.done
    log: per_gene/EOG091G0AFP/infer_single_ML.stdout.txt, per_gene/EOG091G0AFP/infer_single_ML.stderr.txt
    jobid: 77
    wildcards: BUSCO=EOG091G0AFP
    threads: 2


        cd per_gene/EOG091G0AFP
	count=$(cat ../../per_gene/EOG091G0AFP/ALICUT_EOG091G0AFP.clustalo.fasta | grep ">" | wc -l)
	if [ "$count" -gt 5 ]
        then
		RAxMLmodel=$(cat ../../per_gene/EOG091G0AFP/EOG091G0AFP.best_model | grep "Best" | cut -d ":" -f 2 | tr -d '[:space:]')
                if [ "$(ls -1 | grep "^RAxML" | wc -l)" -ne 0 ]
		then
			rm RAxML*
		fi
        	raxml -f a -T 2 -m PROTGAMMA$RAxMLmodel         	-p 12345 -x 12345 -# 100         	-s ../../per_gene/EOG091G0AFP/ALICUT_EOG091G0AFP.clustalo.fasta -n EOG091G0AFP.clustalo.aln.ALICUT.$RAxMLmodel 		1> ../../per_gene/EOG091G0AFP/infer_single_ML.stdout.txt 2> ../../per_gene/EOG091G0AFP/infer_single_ML.stderr.txt
	else
		echo "fasta file per_gene/EOG091G0AFP/ALICUT_EOG091G0AFP.clustalo.fasta contains fewer than 5 sequences - skipped" > ../../per_gene/EOG091G0AFP/infer_single_ML.stdout.txt
		touch raxml.skipped
	fi
        touch ../../per_gene/EOG091G0AFP/EOG091G0AFP.raxml.done
        
[33mJob counts:
	count	jobs
	1	infer_single_ML
	1[0m
[33m
        cd per_gene/EOG091G0M12
	count=$(cat ../../per_gene/EOG091G0M12/ALICUT_EOG091G0M12.clustalo.fasta | grep ">" | wc -l)
	if [ "$count" -gt 5 ]
        then
		RAxMLmodel=$(cat ../../per_gene/EOG091G0M12/EOG091G0M12.best_model | grep "Best" | cut -d ":" -f 2 | tr -d '[:space:]')
                if [ "$(ls -1 | grep "^RAxML" | wc -l)" -ne 0 ]
		then
			rm RAxML*
		fi
        	raxml -f a -T 2 -m PROTGAMMA$RAxMLmodel         	-p 12345 -x 12345 -# 100         	-s ../../per_gene/EOG091G0M12/ALICUT_EOG091G0M12.clustalo.fasta -n EOG091G0M12.clustalo.aln.ALICUT.$RAxMLmodel 		1> ../../per_gene/EOG091G0M12/infer_single_ML.stdout.txt 2> ../../per_gene/EOG091G0M12/infer_single_ML.stderr.txt
	else
		echo "fasta file per_gene/EOG091G0M12/ALICUT_EOG091G0M12.clustalo.fasta contains fewer than 5 sequences - skipped" > ../../per_gene/EOG091G0M12/infer_single_ML.stdout.txt
		touch raxml.skipped
	fi
        touch ../../per_gene/EOG091G0M12/EOG091G0M12.raxml.done
        [0m
[33mJob counts:
	count	jobs
	1	infer_single_ML
	1[0m
[33m
        cd per_gene/EOG091G0AFP
	count=$(cat ../../per_gene/EOG091G0AFP/ALICUT_EOG091G0AFP.clustalo.fasta | grep ">" | wc -l)
	if [ "$count" -gt 5 ]
        then
		RAxMLmodel=$(cat ../../per_gene/EOG091G0AFP/EOG091G0AFP.best_model | grep "Best" | cut -d ":" -f 2 | tr -d '[:space:]')
                if [ "$(ls -1 | grep "^RAxML" | wc -l)" -ne 0 ]
		then
			rm RAxML*
		fi
        	raxml -f a -T 2 -m PROTGAMMA$RAxMLmodel         	-p 12345 -x 12345 -# 100         	-s ../../per_gene/EOG091G0AFP/ALICUT_EOG091G0AFP.clustalo.fasta -n EOG091G0AFP.clustalo.aln.ALICUT.$RAxMLmodel 		1> ../../per_gene/EOG091G0AFP/infer_single_ML.stdout.txt 2> ../../per_gene/EOG091G0AFP/infer_single_ML.stderr.txt
	else
		echo "fasta file per_gene/EOG091G0AFP/ALICUT_EOG091G0AFP.clustalo.fasta contains fewer than 5 sequences - skipped" > ../../per_gene/EOG091G0AFP/infer_single_ML.stdout.txt
		touch raxml.skipped
	fi
        touch ../../per_gene/EOG091G0AFP/EOG091G0AFP.raxml.done
        [0m
[Sun Jul  5 23:36:57 2020]
Finished job 844.
2260 of 3292 steps (69%) done

[Sun Jul  5 23:36:57 2020]
rule infer_single_ML:
    input: per_gene/EOG091G0YVI/EOG091G0YVI.best_model, per_gene/EOG091G0YVI/ALICUT_EOG091G0YVI.clustalo.fasta
    output: per_gene/EOG091G0YVI/EOG091G0YVI.raxml.done
    log: per_gene/EOG091G0YVI/infer_single_ML.stdout.txt, per_gene/EOG091G0YVI/infer_single_ML.stderr.txt
    jobid: 216
    wildcards: BUSCO=EOG091G0YVI
    threads: 2


        cd per_gene/EOG091G0YVI
	count=$(cat ../../per_gene/EOG091G0YVI/ALICUT_EOG091G0YVI.clustalo.fasta | grep ">" | wc -l)
	if [ "$count" -gt 5 ]
        then
		RAxMLmodel=$(cat ../../per_gene/EOG091G0YVI/EOG091G0YVI.best_model | grep "Best" | cut -d ":" -f 2 | tr -d '[:space:]')
                if [ "$(ls -1 | grep "^RAxML" | wc -l)" -ne 0 ]
		then
			rm RAxML*
		fi
        	raxml -f a -T 2 -m PROTGAMMA$RAxMLmodel         	-p 12345 -x 12345 -# 100         	-s ../../per_gene/EOG091G0YVI/ALICUT_EOG091G0YVI.clustalo.fasta -n EOG091G0YVI.clustalo.aln.ALICUT.$RAxMLmodel 		1> ../../per_gene/EOG091G0YVI/infer_single_ML.stdout.txt 2> ../../per_gene/EOG091G0YVI/infer_single_ML.stderr.txt
	else
		echo "fasta file per_gene/EOG091G0YVI/ALICUT_EOG091G0YVI.clustalo.fasta contains fewer than 5 sequences - skipped" > ../../per_gene/EOG091G0YVI/infer_single_ML.stdout.txt
		touch raxml.skipped
	fi
        touch ../../per_gene/EOG091G0YVI/EOG091G0YVI.raxml.done
        
[Sun Jul  5 23:36:58 2020]
Finished job 538.
2261 of 3292 steps (69%) done

[Sun Jul  5 23:36:58 2020]
rule infer_single_ML:
    input: per_gene/EOG091G08O3/EOG091G08O3.best_model, per_gene/EOG091G08O3/ALICUT_EOG091G08O3.clustalo.fasta
    output: per_gene/EOG091G08O3/EOG091G08O3.raxml.done
    log: per_gene/EOG091G08O3/infer_single_ML.stdout.txt, per_gene/EOG091G08O3/infer_single_ML.stderr.txt
    jobid: 63
    wildcards: BUSCO=EOG091G08O3
    threads: 2


        cd per_gene/EOG091G08O3
	count=$(cat ../../per_gene/EOG091G08O3/ALICUT_EOG091G08O3.clustalo.fasta | grep ">" | wc -l)
	if [ "$count" -gt 5 ]
        then
		RAxMLmodel=$(cat ../../per_gene/EOG091G08O3/EOG091G08O3.best_model | grep "Best" | cut -d ":" -f 2 | tr -d '[:space:]')
                if [ "$(ls -1 | grep "^RAxML" | wc -l)" -ne 0 ]
		then
			rm RAxML*
		fi
        	raxml -f a -T 2 -m PROTGAMMA$RAxMLmodel         	-p 12345 -x 12345 -# 100         	-s ../../per_gene/EOG091G08O3/ALICUT_EOG091G08O3.clustalo.fasta -n EOG091G08O3.clustalo.aln.ALICUT.$RAxMLmodel 		1> ../../per_gene/EOG091G08O3/infer_single_ML.stdout.txt 2> ../../per_gene/EOG091G08O3/infer_single_ML.stderr.txt
	else
		echo "fasta file per_gene/EOG091G08O3/ALICUT_EOG091G08O3.clustalo.fasta contains fewer than 5 sequences - skipped" > ../../per_gene/EOG091G08O3/infer_single_ML.stdout.txt
		touch raxml.skipped
	fi
        touch ../../per_gene/EOG091G08O3/EOG091G08O3.raxml.done
        
[33mJob counts:
	count	jobs
	1	infer_single_ML
	1[0m
[33mJob counts:
	count	jobs
	1	infer_single_ML
	1[0m
[33m
        cd per_gene/EOG091G0YVI
	count=$(cat ../../per_gene/EOG091G0YVI/ALICUT_EOG091G0YVI.clustalo.fasta | grep ">" | wc -l)
	if [ "$count" -gt 5 ]
        then
		RAxMLmodel=$(cat ../../per_gene/EOG091G0YVI/EOG091G0YVI.best_model | grep "Best" | cut -d ":" -f 2 | tr -d '[:space:]')
                if [ "$(ls -1 | grep "^RAxML" | wc -l)" -ne 0 ]
		then
			rm RAxML*
		fi
        	raxml -f a -T 2 -m PROTGAMMA$RAxMLmodel         	-p 12345 -x 12345 -# 100         	-s ../../per_gene/EOG091G0YVI/ALICUT_EOG091G0YVI.clustalo.fasta -n EOG091G0YVI.clustalo.aln.ALICUT.$RAxMLmodel 		1> ../../per_gene/EOG091G0YVI/infer_single_ML.stdout.txt 2> ../../per_gene/EOG091G0YVI/infer_single_ML.stderr.txt
	else
		echo "fasta file per_gene/EOG091G0YVI/ALICUT_EOG091G0YVI.clustalo.fasta contains fewer than 5 sequences - skipped" > ../../per_gene/EOG091G0YVI/infer_single_ML.stdout.txt
		touch raxml.skipped
	fi
        touch ../../per_gene/EOG091G0YVI/EOG091G0YVI.raxml.done
        [0m
[33m
        cd per_gene/EOG091G08O3
	count=$(cat ../../per_gene/EOG091G08O3/ALICUT_EOG091G08O3.clustalo.fasta | grep ">" | wc -l)
	if [ "$count" -gt 5 ]
        then
		RAxMLmodel=$(cat ../../per_gene/EOG091G08O3/EOG091G08O3.best_model | grep "Best" | cut -d ":" -f 2 | tr -d '[:space:]')
                if [ "$(ls -1 | grep "^RAxML" | wc -l)" -ne 0 ]
		then
			rm RAxML*
		fi
        	raxml -f a -T 2 -m PROTGAMMA$RAxMLmodel         	-p 12345 -x 12345 -# 100         	-s ../../per_gene/EOG091G08O3/ALICUT_EOG091G08O3.clustalo.fasta -n EOG091G08O3.clustalo.aln.ALICUT.$RAxMLmodel 		1> ../../per_gene/EOG091G08O3/infer_single_ML.stdout.txt 2> ../../per_gene/EOG091G08O3/infer_single_ML.stderr.txt
	else
		echo "fasta file per_gene/EOG091G08O3/ALICUT_EOG091G08O3.clustalo.fasta contains fewer than 5 sequences - skipped" > ../../per_gene/EOG091G08O3/infer_single_ML.stdout.txt
		touch raxml.skipped
	fi
        touch ../../per_gene/EOG091G08O3/EOG091G08O3.raxml.done
        [0m
[Sun Jul  5 23:37:02 2020]
Finished job 5.
2262 of 3292 steps (69%) done

[Sun Jul  5 23:37:02 2020]
rule infer_single_ML:
    input: per_gene/EOG091G12A5/EOG091G12A5.best_model, per_gene/EOG091G12A5/ALICUT_EOG091G12A5.clustalo.fasta
    output: per_gene/EOG091G12A5/EOG091G12A5.raxml.done
    log: per_gene/EOG091G12A5/infer_single_ML.stdout.txt, per_gene/EOG091G12A5/infer_single_ML.stderr.txt
    jobid: 229
    wildcards: BUSCO=EOG091G12A5
    threads: 2


        cd per_gene/EOG091G12A5
	count=$(cat ../../per_gene/EOG091G12A5/ALICUT_EOG091G12A5.clustalo.fasta | grep ">" | wc -l)
	if [ "$count" -gt 5 ]
        then
		RAxMLmodel=$(cat ../../per_gene/EOG091G12A5/EOG091G12A5.best_model | grep "Best" | cut -d ":" -f 2 | tr -d '[:space:]')
                if [ "$(ls -1 | grep "^RAxML" | wc -l)" -ne 0 ]
		then
			rm RAxML*
		fi
        	raxml -f a -T 2 -m PROTGAMMA$RAxMLmodel         	-p 12345 -x 12345 -# 100         	-s ../../per_gene/EOG091G12A5/ALICUT_EOG091G12A5.clustalo.fasta -n EOG091G12A5.clustalo.aln.ALICUT.$RAxMLmodel 		1> ../../per_gene/EOG091G12A5/infer_single_ML.stdout.txt 2> ../../per_gene/EOG091G12A5/infer_single_ML.stderr.txt
	else
		echo "fasta file per_gene/EOG091G12A5/ALICUT_EOG091G12A5.clustalo.fasta contains fewer than 5 sequences - skipped" > ../../per_gene/EOG091G12A5/infer_single_ML.stdout.txt
		touch raxml.skipped
	fi
        touch ../../per_gene/EOG091G12A5/EOG091G12A5.raxml.done
        
[Sun Jul  5 23:37:04 2020]
Finished job 560.
2263 of 3292 steps (69%) done

[Sun Jul  5 23:37:04 2020]
rule infer_single_ML:
    input: per_gene/EOG091G0A2L/EOG091G0A2L.best_model, per_gene/EOG091G0A2L/ALICUT_EOG091G0A2L.clustalo.fasta
    output: per_gene/EOG091G0A2L/EOG091G0A2L.raxml.done
    log: per_gene/EOG091G0A2L/infer_single_ML.stdout.txt, per_gene/EOG091G0A2L/infer_single_ML.stderr.txt
    jobid: 74
    wildcards: BUSCO=EOG091G0A2L
    threads: 2


        cd per_gene/EOG091G0A2L
	count=$(cat ../../per_gene/EOG091G0A2L/ALICUT_EOG091G0A2L.clustalo.fasta | grep ">" | wc -l)
	if [ "$count" -gt 5 ]
        then
		RAxMLmodel=$(cat ../../per_gene/EOG091G0A2L/EOG091G0A2L.best_model | grep "Best" | cut -d ":" -f 2 | tr -d '[:space:]')
                if [ "$(ls -1 | grep "^RAxML" | wc -l)" -ne 0 ]
		then
			rm RAxML*
		fi
        	raxml -f a -T 2 -m PROTGAMMA$RAxMLmodel         	-p 12345 -x 12345 -# 100         	-s ../../per_gene/EOG091G0A2L/ALICUT_EOG091G0A2L.clustalo.fasta -n EOG091G0A2L.clustalo.aln.ALICUT.$RAxMLmodel 		1> ../../per_gene/EOG091G0A2L/infer_single_ML.stdout.txt 2> ../../per_gene/EOG091G0A2L/infer_single_ML.stderr.txt
	else
		echo "fasta file per_gene/EOG091G0A2L/ALICUT_EOG091G0A2L.clustalo.fasta contains fewer than 5 sequences - skipped" > ../../per_gene/EOG091G0A2L/infer_single_ML.stdout.txt
		touch raxml.skipped
	fi
        touch ../../per_gene/EOG091G0A2L/EOG091G0A2L.raxml.done
        
[Sun Jul  5 23:37:05 2020]
Finished job 976.
2264 of 3292 steps (69%) done

[Sun Jul  5 23:37:05 2020]
rule infer_single_ML:
    input: per_gene/EOG091G0VZF/EOG091G0VZF.best_model, per_gene/EOG091G0VZF/ALICUT_EOG091G0VZF.clustalo.fasta
    output: per_gene/EOG091G0VZF/EOG091G0VZF.raxml.done
    log: per_gene/EOG091G0VZF/infer_single_ML.stdout.txt, per_gene/EOG091G0VZF/infer_single_ML.stderr.txt
    jobid: 282
    wildcards: BUSCO=EOG091G0VZF
    threads: 2


        cd per_gene/EOG091G0VZF
	count=$(cat ../../per_gene/EOG091G0VZF/ALICUT_EOG091G0VZF.clustalo.fasta | grep ">" | wc -l)
	if [ "$count" -gt 5 ]
        then
		RAxMLmodel=$(cat ../../per_gene/EOG091G0VZF/EOG091G0VZF.best_model | grep "Best" | cut -d ":" -f 2 | tr -d '[:space:]')
                if [ "$(ls -1 | grep "^RAxML" | wc -l)" -ne 0 ]
		then
			rm RAxML*
		fi
        	raxml -f a -T 2 -m PROTGAMMA$RAxMLmodel         	-p 12345 -x 12345 -# 100         	-s ../../per_gene/EOG091G0VZF/ALICUT_EOG091G0VZF.clustalo.fasta -n EOG091G0VZF.clustalo.aln.ALICUT.$RAxMLmodel 		1> ../../per_gene/EOG091G0VZF/infer_single_ML.stdout.txt 2> ../../per_gene/EOG091G0VZF/infer_single_ML.stderr.txt
	else
		echo "fasta file per_gene/EOG091G0VZF/ALICUT_EOG091G0VZF.clustalo.fasta contains fewer than 5 sequences - skipped" > ../../per_gene/EOG091G0VZF/infer_single_ML.stdout.txt
		touch raxml.skipped
	fi
        touch ../../per_gene/EOG091G0VZF/EOG091G0VZF.raxml.done
        
[33mJob counts:
	count	jobs
	1	infer_single_ML
	1[0m
[33m
        cd per_gene/EOG091G12A5
	count=$(cat ../../per_gene/EOG091G12A5/ALICUT_EOG091G12A5.clustalo.fasta | grep ">" | wc -l)
	if [ "$count" -gt 5 ]
        then
		RAxMLmodel=$(cat ../../per_gene/EOG091G12A5/EOG091G12A5.best_model | grep "Best" | cut -d ":" -f 2 | tr -d '[:space:]')
                if [ "$(ls -1 | grep "^RAxML" | wc -l)" -ne 0 ]
		then
			rm RAxML*
		fi
        	raxml -f a -T 2 -m PROTGAMMA$RAxMLmodel         	-p 12345 -x 12345 -# 100         	-s ../../per_gene/EOG091G12A5/ALICUT_EOG091G12A5.clustalo.fasta -n EOG091G12A5.clustalo.aln.ALICUT.$RAxMLmodel 		1> ../../per_gene/EOG091G12A5/infer_single_ML.stdout.txt 2> ../../per_gene/EOG091G12A5/infer_single_ML.stderr.txt
	else
		echo "fasta file per_gene/EOG091G12A5/ALICUT_EOG091G12A5.clustalo.fasta contains fewer than 5 sequences - skipped" > ../../per_gene/EOG091G12A5/infer_single_ML.stdout.txt
		touch raxml.skipped
	fi
        touch ../../per_gene/EOG091G12A5/EOG091G12A5.raxml.done
        [0m
[33mJob counts:
	count	jobs
	1	infer_single_ML
	1[0m
[33m
        cd per_gene/EOG091G0VZF
	count=$(cat ../../per_gene/EOG091G0VZF/ALICUT_EOG091G0VZF.clustalo.fasta | grep ">" | wc -l)
	if [ "$count" -gt 5 ]
        then
		RAxMLmodel=$(cat ../../per_gene/EOG091G0VZF/EOG091G0VZF.best_model | grep "Best" | cut -d ":" -f 2 | tr -d '[:space:]')
                if [ "$(ls -1 | grep "^RAxML" | wc -l)" -ne 0 ]
		then
			rm RAxML*
		fi
        	raxml -f a -T 2 -m PROTGAMMA$RAxMLmodel         	-p 12345 -x 12345 -# 100         	-s ../../per_gene/EOG091G0VZF/ALICUT_EOG091G0VZF.clustalo.fasta -n EOG091G0VZF.clustalo.aln.ALICUT.$RAxMLmodel 		1> ../../per_gene/EOG091G0VZF/infer_single_ML.stdout.txt 2> ../../per_gene/EOG091G0VZF/infer_single_ML.stderr.txt
	else
		echo "fasta file per_gene/EOG091G0VZF/ALICUT_EOG091G0VZF.clustalo.fasta contains fewer than 5 sequences - skipped" > ../../per_gene/EOG091G0VZF/infer_single_ML.stdout.txt
		touch raxml.skipped
	fi
        touch ../../per_gene/EOG091G0VZF/EOG091G0VZF.raxml.done
        [0m
[33mJob counts:
	count	jobs
	1	infer_single_ML
	1[0m
[33m
        cd per_gene/EOG091G0A2L
	count=$(cat ../../per_gene/EOG091G0A2L/ALICUT_EOG091G0A2L.clustalo.fasta | grep ">" | wc -l)
	if [ "$count" -gt 5 ]
        then
		RAxMLmodel=$(cat ../../per_gene/EOG091G0A2L/EOG091G0A2L.best_model | grep "Best" | cut -d ":" -f 2 | tr -d '[:space:]')
                if [ "$(ls -1 | grep "^RAxML" | wc -l)" -ne 0 ]
		then
			rm RAxML*
		fi
        	raxml -f a -T 2 -m PROTGAMMA$RAxMLmodel         	-p 12345 -x 12345 -# 100         	-s ../../per_gene/EOG091G0A2L/ALICUT_EOG091G0A2L.clustalo.fasta -n EOG091G0A2L.clustalo.aln.ALICUT.$RAxMLmodel 		1> ../../per_gene/EOG091G0A2L/infer_single_ML.stdout.txt 2> ../../per_gene/EOG091G0A2L/infer_single_ML.stderr.txt
	else
		echo "fasta file per_gene/EOG091G0A2L/ALICUT_EOG091G0A2L.clustalo.fasta contains fewer than 5 sequences - skipped" > ../../per_gene/EOG091G0A2L/infer_single_ML.stdout.txt
		touch raxml.skipped
	fi
        touch ../../per_gene/EOG091G0A2L/EOG091G0A2L.raxml.done
        [0m
[Sun Jul  5 23:37:35 2020]
Finished job 175.
2265 of 3292 steps (69%) done

[Sun Jul  5 23:37:35 2020]
rule get_seqs:
    input: /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ingroup.txt, /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/outgroup.txt
    output: per_gene/EOG091G0PUZ/EOG091G0PUZ.ingroup.fasta
    log: per_gene/EOG091G0PUZ/get_seqs.stdout.txt, per_gene/EOG091G0PUZ/get_seqs.stderr.txt
    jobid: 3104
    wildcards: BUSCO=EOG091G0PUZ
    threads: 2


	basedir=$(pwd)
        cd per_gene/EOG091G0PUZ
        
        bash $basedir/../scripts/fetch_seqs.sh EOG091G0PUZ /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ingroup.txt /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/outgroup.txt 1> ../../per_gene/EOG091G0PUZ/get_seqs.stdout.txt 2> ../../per_gene/EOG091G0PUZ/get_seqs.stderr.txt
	mv EOG091G0PUZ.fasta $basedir/per_gene/EOG091G0PUZ/EOG091G0PUZ.ingroup.fasta
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/72476f9d9a5bd0627b4d721143a21354.simg
[Sun Jul  5 23:37:48 2020]
Finished job 3104.
2266 of 3292 steps (69%) done

[Sun Jul  5 23:37:48 2020]
rule get_outgroups:
    input: per_gene/EOG091G0PUZ/EOG091G0PUZ.ingroup.fasta
    output: per_gene/EOG091G0PUZ/EOG091G0PUZ.orthodb.fasta, per_gene/EOG091G0PUZ/EOG091G0PUZ.outgroup.fasta
    log: per_gene/EOG091G0PUZ/get_outgroups.stdout.txt, per_gene/EOG091G0PUZ/get_outgroups.stderr.txt
    jobid: 3105
    wildcards: BUSCO=EOG091G0PUZ


        #download fastas from Orhtodb for BUSCO id
        for i in {1..5}
        do
             wget "http://www.orthodb.org/fasta?query=EOG091G0PUZ&level=33208" -O per_gene/EOG091G0PUZ/EOG091G0PUZ.orthodb.fasta 1> per_gene/EOG091G0PUZ/get_outgroups.stdout.txt 2> per_gene/EOG091G0PUZ/get_outgroups.stderr.txt && break || echo -e "try again ($i)" && sleep 15
        done

	#This is quick an dirty for now and just takes the first protein if there is more than one for an outgroup taxon
        bash ../scripts/download_outgroups.sh taxids.txt per_gene/EOG091G0PUZ/EOG091G0PUZ.orthodb.fasta > per_gene/EOG091G0PUZ/EOG091G0PUZ.outgroup.fasta
        
[Sun Jul  5 23:37:49 2020]
Finished job 3105.
2267 of 3292 steps (69%) done

[Sun Jul  5 23:37:50 2020]
rule join_groups:
    input: per_gene/EOG091G0PUZ/EOG091G0PUZ.ingroup.fasta, per_gene/EOG091G0PUZ/EOG091G0PUZ.outgroup.fasta
    output: per_gene/EOG091G0PUZ/EOG091G0PUZ.fasta
    jobid: 2376
    wildcards: BUSCO=EOG091G0PUZ


        cat per_gene/EOG091G0PUZ/EOG091G0PUZ.ingroup.fasta per_gene/EOG091G0PUZ/EOG091G0PUZ.outgroup.fasta > per_gene/EOG091G0PUZ/EOG091G0PUZ.fasta
        
[Sun Jul  5 23:37:50 2020]
Finished job 2376.
2268 of 3292 steps (69%) done

[Sun Jul  5 23:37:50 2020]
rule MSA:
    input: per_gene/EOG091G0PUZ/EOG091G0PUZ.fasta
    output: per_gene/EOG091G0PUZ/EOG091G0PUZ.clustalo.fasta
    log: per_gene/EOG091G0PUZ/MSA.stdout.txt, per_gene/EOG091G0PUZ/MSA.stderr.txt
    jobid: 1872
    wildcards: BUSCO=EOG091G0PUZ
    threads: 2


        clustalo -i per_gene/EOG091G0PUZ/EOG091G0PUZ.fasta -o per_gene/EOG091G0PUZ/EOG091G0PUZ.clustalo.fasta --threads=2 1> per_gene/EOG091G0PUZ/MSA.stdout.txt 2> per_gene/EOG091G0PUZ/MSA.stderr.txt
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/d68c9691725a7401923680874285c430.simg
[Sun Jul  5 23:37:50 2020]
Finished job 1872.
2269 of 3292 steps (69%) done

[Sun Jul  5 23:37:50 2020]
rule score_and_cut:
    input: per_gene/EOG091G0PUZ/EOG091G0PUZ.clustalo.fasta
    output: per_gene/EOG091G0PUZ/ALICUT_EOG091G0PUZ.clustalo.fasta
    jobid: 1049
    wildcards: BUSCO=EOG091G0PUZ
    threads: 2


        cd per_gene/EOG091G0PUZ
        Aliscore.pl -N -r 200000000000000000 -i ../../per_gene/EOG091G0PUZ/EOG091G0PUZ.clustalo.fasta &> aliscore.log
        ALICUT.pl -s &> alicut.log
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/63c88c27a0fa300f57066b0ef65fefcb.simg
[Sun Jul  5 23:38:00 2020]
Finished job 1049.
2270 of 3292 steps (69%) done

[Sun Jul  5 23:38:00 2020]
rule remove_empty:
    input: per_gene/EOG091G0PUZ/ALICUT_EOG091G0PUZ.clustalo.fasta
    output: per_gene/EOG091G0PUZ/empty_check.done
    jobid: 1871
    wildcards: BUSCO=EOG091G0PUZ


         if [ "$(cat per_gene/EOG091G0PUZ/ALICUT_EOG091G0PUZ.clustalo.fasta | grep -v ">" | sed 's/-//g' | grep "^$" | wc -l)" -gt 0 ]
         then
              cp per_gene/EOG091G0PUZ/ALICUT_EOG091G0PUZ.clustalo.fasta per_gene/EOG091G0PUZ/ALICUT_EOG091G0PUZ.clustalo.fasta.backup
              bash ../scripts/remove_empty.sh per_gene/EOG091G0PUZ/ALICUT_EOG091G0PUZ.clustalo.fasta.backup > per_gene/EOG091G0PUZ/ALICUT_EOG091G0PUZ.clustalo.fasta
         fi
         touch per_gene/EOG091G0PUZ/empty_check.done
         
[Sun Jul  5 23:38:00 2020]
Finished job 1871.
2271 of 3292 steps (69%) done

[Sun Jul  5 23:38:00 2020]
rule find_best_model:
    input: per_gene/EOG091G0PUZ/ALICUT_EOG091G0PUZ.clustalo.fasta, per_gene/EOG091G0PUZ/empty_check.done
    output: per_gene/EOG091G0PUZ/EOG091G0PUZ.best_model
    log: per_gene/EOG091G0PUZ/find_best_model.stderr.txt
    jobid: 1048
    wildcards: BUSCO=EOG091G0PUZ
    threads: 2


        cd per_gene/EOG091G0PUZ
        if [ ! -d find_best_model ]
        then
            mkdir find_best_model
        fi
        cd find_best_model
        ln -s ../../../per_gene/EOG091G0PUZ/ALICUT_EOG091G0PUZ.clustalo.fasta EOG091G0PUZ.fasta
        ProteinModelSelection.pl EOG091G0PUZ.fasta 1> ../../../per_gene/EOG091G0PUZ/EOG091G0PUZ.best_model 2> ../../../per_gene/EOG091G0PUZ/find_best_model.stderr.txt
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/c0c09ee657b1e27f2c5687e0e9aa8d70.simg
[Sun Jul  5 23:38:37 2020]
Finished job 1048.
2272 of 3292 steps (69%) done

[Sun Jul  5 23:38:37 2020]
rule infer_single_ML:
    input: per_gene/EOG091G0PUZ/EOG091G0PUZ.best_model, per_gene/EOG091G0PUZ/ALICUT_EOG091G0PUZ.clustalo.fasta
    output: per_gene/EOG091G0PUZ/EOG091G0PUZ.raxml.done
    log: per_gene/EOG091G0PUZ/infer_single_ML.stdout.txt, per_gene/EOG091G0PUZ/infer_single_ML.stderr.txt
    jobid: 318
    wildcards: BUSCO=EOG091G0PUZ
    threads: 2


        cd per_gene/EOG091G0PUZ
	count=$(cat ../../per_gene/EOG091G0PUZ/ALICUT_EOG091G0PUZ.clustalo.fasta | grep ">" | wc -l)
	if [ "$count" -gt 5 ]
        then
		RAxMLmodel=$(cat ../../per_gene/EOG091G0PUZ/EOG091G0PUZ.best_model | grep "Best" | cut -d ":" -f 2 | tr -d '[:space:]')
                if [ "$(ls -1 | grep "^RAxML" | wc -l)" -ne 0 ]
		then
			rm RAxML*
		fi
        	raxml -f a -T 2 -m PROTGAMMA$RAxMLmodel         	-p 12345 -x 12345 -# 100         	-s ../../per_gene/EOG091G0PUZ/ALICUT_EOG091G0PUZ.clustalo.fasta -n EOG091G0PUZ.clustalo.aln.ALICUT.$RAxMLmodel 		1> ../../per_gene/EOG091G0PUZ/infer_single_ML.stdout.txt 2> ../../per_gene/EOG091G0PUZ/infer_single_ML.stderr.txt
	else
		echo "fasta file per_gene/EOG091G0PUZ/ALICUT_EOG091G0PUZ.clustalo.fasta contains fewer than 5 sequences - skipped" > ../../per_gene/EOG091G0PUZ/infer_single_ML.stdout.txt
		touch raxml.skipped
	fi
        touch ../../per_gene/EOG091G0PUZ/EOG091G0PUZ.raxml.done
        
[33mJob counts:
	count	jobs
	1	infer_single_ML
	1[0m
[33m
        cd per_gene/EOG091G0PUZ
	count=$(cat ../../per_gene/EOG091G0PUZ/ALICUT_EOG091G0PUZ.clustalo.fasta | grep ">" | wc -l)
	if [ "$count" -gt 5 ]
        then
		RAxMLmodel=$(cat ../../per_gene/EOG091G0PUZ/EOG091G0PUZ.best_model | grep "Best" | cut -d ":" -f 2 | tr -d '[:space:]')
                if [ "$(ls -1 | grep "^RAxML" | wc -l)" -ne 0 ]
		then
			rm RAxML*
		fi
        	raxml -f a -T 2 -m PROTGAMMA$RAxMLmodel         	-p 12345 -x 12345 -# 100         	-s ../../per_gene/EOG091G0PUZ/ALICUT_EOG091G0PUZ.clustalo.fasta -n EOG091G0PUZ.clustalo.aln.ALICUT.$RAxMLmodel 		1> ../../per_gene/EOG091G0PUZ/infer_single_ML.stdout.txt 2> ../../per_gene/EOG091G0PUZ/infer_single_ML.stderr.txt
	else
		echo "fasta file per_gene/EOG091G0PUZ/ALICUT_EOG091G0PUZ.clustalo.fasta contains fewer than 5 sequences - skipped" > ../../per_gene/EOG091G0PUZ/infer_single_ML.stdout.txt
		touch raxml.skipped
	fi
        touch ../../per_gene/EOG091G0PUZ/EOG091G0PUZ.raxml.done
        [0m
[Sun Jul  5 23:38:52 2020]
Finished job 60.
2273 of 3292 steps (69%) done

[Sun Jul  5 23:38:52 2020]
rule get_seqs:
    input: /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ingroup.txt, /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/outgroup.txt
    output: per_gene/EOG091G079R/EOG091G079R.ingroup.fasta
    log: per_gene/EOG091G079R/get_seqs.stdout.txt, per_gene/EOG091G079R/get_seqs.stderr.txt
    jobid: 3070
    wildcards: BUSCO=EOG091G079R
    threads: 2


	basedir=$(pwd)
        cd per_gene/EOG091G079R
        
        bash $basedir/../scripts/fetch_seqs.sh EOG091G079R /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ingroup.txt /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/outgroup.txt 1> ../../per_gene/EOG091G079R/get_seqs.stdout.txt 2> ../../per_gene/EOG091G079R/get_seqs.stderr.txt
	mv EOG091G079R.fasta $basedir/per_gene/EOG091G079R/EOG091G079R.ingroup.fasta
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/72476f9d9a5bd0627b4d721143a21354.simg
[Sun Jul  5 23:39:08 2020]
Finished job 3070.
2274 of 3292 steps (69%) done

[Sun Jul  5 23:39:08 2020]
rule get_outgroups:
    input: per_gene/EOG091G079R/EOG091G079R.ingroup.fasta
    output: per_gene/EOG091G079R/EOG091G079R.orthodb.fasta, per_gene/EOG091G079R/EOG091G079R.outgroup.fasta
    log: per_gene/EOG091G079R/get_outgroups.stdout.txt, per_gene/EOG091G079R/get_outgroups.stderr.txt
    jobid: 3071
    wildcards: BUSCO=EOG091G079R


        #download fastas from Orhtodb for BUSCO id
        for i in {1..5}
        do
             wget "http://www.orthodb.org/fasta?query=EOG091G079R&level=33208" -O per_gene/EOG091G079R/EOG091G079R.orthodb.fasta 1> per_gene/EOG091G079R/get_outgroups.stdout.txt 2> per_gene/EOG091G079R/get_outgroups.stderr.txt && break || echo -e "try again ($i)" && sleep 15
        done

	#This is quick an dirty for now and just takes the first protein if there is more than one for an outgroup taxon
        bash ../scripts/download_outgroups.sh taxids.txt per_gene/EOG091G079R/EOG091G079R.orthodb.fasta > per_gene/EOG091G079R/EOG091G079R.outgroup.fasta
        
[Sun Jul  5 23:39:10 2020]
Finished job 3071.
2275 of 3292 steps (69%) done

[Sun Jul  5 23:39:10 2020]
rule join_groups:
    input: per_gene/EOG091G079R/EOG091G079R.ingroup.fasta, per_gene/EOG091G079R/EOG091G079R.outgroup.fasta
    output: per_gene/EOG091G079R/EOG091G079R.fasta
    jobid: 2359
    wildcards: BUSCO=EOG091G079R


        cat per_gene/EOG091G079R/EOG091G079R.ingroup.fasta per_gene/EOG091G079R/EOG091G079R.outgroup.fasta > per_gene/EOG091G079R/EOG091G079R.fasta
        
[Sun Jul  5 23:39:10 2020]
Finished job 2359.
2276 of 3292 steps (69%) done

[Sun Jul  5 23:39:10 2020]
rule MSA:
    input: per_gene/EOG091G079R/EOG091G079R.fasta
    output: per_gene/EOG091G079R/EOG091G079R.clustalo.fasta
    log: per_gene/EOG091G079R/MSA.stdout.txt, per_gene/EOG091G079R/MSA.stderr.txt
    jobid: 1838
    wildcards: BUSCO=EOG091G079R
    threads: 2


        clustalo -i per_gene/EOG091G079R/EOG091G079R.fasta -o per_gene/EOG091G079R/EOG091G079R.clustalo.fasta --threads=2 1> per_gene/EOG091G079R/MSA.stdout.txt 2> per_gene/EOG091G079R/MSA.stderr.txt
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/d68c9691725a7401923680874285c430.simg
[Sun Jul  5 23:39:11 2020]
Finished job 1838.
2277 of 3292 steps (69%) done

[Sun Jul  5 23:39:11 2020]
rule score_and_cut:
    input: per_gene/EOG091G079R/EOG091G079R.clustalo.fasta
    output: per_gene/EOG091G079R/ALICUT_EOG091G079R.clustalo.fasta
    jobid: 1015
    wildcards: BUSCO=EOG091G079R
    threads: 2


        cd per_gene/EOG091G079R
        Aliscore.pl -N -r 200000000000000000 -i ../../per_gene/EOG091G079R/EOG091G079R.clustalo.fasta &> aliscore.log
        ALICUT.pl -s &> alicut.log
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/63c88c27a0fa300f57066b0ef65fefcb.simg
[Sun Jul  5 23:39:21 2020]
Finished job 1015.
2278 of 3292 steps (69%) done

[Sun Jul  5 23:39:21 2020]
rule remove_empty:
    input: per_gene/EOG091G079R/ALICUT_EOG091G079R.clustalo.fasta
    output: per_gene/EOG091G079R/empty_check.done
    jobid: 1837
    wildcards: BUSCO=EOG091G079R


         if [ "$(cat per_gene/EOG091G079R/ALICUT_EOG091G079R.clustalo.fasta | grep -v ">" | sed 's/-//g' | grep "^$" | wc -l)" -gt 0 ]
         then
              cp per_gene/EOG091G079R/ALICUT_EOG091G079R.clustalo.fasta per_gene/EOG091G079R/ALICUT_EOG091G079R.clustalo.fasta.backup
              bash ../scripts/remove_empty.sh per_gene/EOG091G079R/ALICUT_EOG091G079R.clustalo.fasta.backup > per_gene/EOG091G079R/ALICUT_EOG091G079R.clustalo.fasta
         fi
         touch per_gene/EOG091G079R/empty_check.done
         
[Sun Jul  5 23:39:21 2020]
Finished job 1837.
2279 of 3292 steps (69%) done

[Sun Jul  5 23:39:21 2020]
rule find_best_model:
    input: per_gene/EOG091G079R/ALICUT_EOG091G079R.clustalo.fasta, per_gene/EOG091G079R/empty_check.done
    output: per_gene/EOG091G079R/EOG091G079R.best_model
    log: per_gene/EOG091G079R/find_best_model.stderr.txt
    jobid: 1014
    wildcards: BUSCO=EOG091G079R
    threads: 2


        cd per_gene/EOG091G079R
        if [ ! -d find_best_model ]
        then
            mkdir find_best_model
        fi
        cd find_best_model
        ln -s ../../../per_gene/EOG091G079R/ALICUT_EOG091G079R.clustalo.fasta EOG091G079R.fasta
        ProteinModelSelection.pl EOG091G079R.fasta 1> ../../../per_gene/EOG091G079R/EOG091G079R.best_model 2> ../../../per_gene/EOG091G079R/find_best_model.stderr.txt
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/c0c09ee657b1e27f2c5687e0e9aa8d70.simg
[Sun Jul  5 23:39:34 2020]
Finished job 152.
2280 of 3292 steps (69%) done

[Sun Jul  5 23:39:34 2020]
rule get_seqs:
    input: /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ingroup.txt, /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/outgroup.txt
    output: per_gene/EOG091G08SM/EOG091G08SM.ingroup.fasta
    log: per_gene/EOG091G08SM/get_seqs.stdout.txt, per_gene/EOG091G08SM/get_seqs.stderr.txt
    jobid: 3162
    wildcards: BUSCO=EOG091G08SM
    threads: 2


	basedir=$(pwd)
        cd per_gene/EOG091G08SM
        
        bash $basedir/../scripts/fetch_seqs.sh EOG091G08SM /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ingroup.txt /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/outgroup.txt 1> ../../per_gene/EOG091G08SM/get_seqs.stdout.txt 2> ../../per_gene/EOG091G08SM/get_seqs.stderr.txt
	mv EOG091G08SM.fasta $basedir/per_gene/EOG091G08SM/EOG091G08SM.ingroup.fasta
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/72476f9d9a5bd0627b4d721143a21354.simg
[Sun Jul  5 23:39:40 2020]
Finished job 346.
2281 of 3292 steps (69%) done

[Sun Jul  5 23:39:40 2020]
rule get_seqs:
    input: /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ingroup.txt, /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/outgroup.txt
    output: per_gene/EOG091G0J2W/EOG091G0J2W.ingroup.fasta
    log: per_gene/EOG091G0J2W/get_seqs.stdout.txt, per_gene/EOG091G0J2W/get_seqs.stderr.txt
    jobid: 2724
    wildcards: BUSCO=EOG091G0J2W
    threads: 2


	basedir=$(pwd)
        cd per_gene/EOG091G0J2W
        
        bash $basedir/../scripts/fetch_seqs.sh EOG091G0J2W /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ingroup.txt /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/outgroup.txt 1> ../../per_gene/EOG091G0J2W/get_seqs.stdout.txt 2> ../../per_gene/EOG091G0J2W/get_seqs.stderr.txt
	mv EOG091G0J2W.fasta $basedir/per_gene/EOG091G0J2W/EOG091G0J2W.ingroup.fasta
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/72476f9d9a5bd0627b4d721143a21354.simg
[Sun Jul  5 23:39:48 2020]
Finished job 3162.
2282 of 3292 steps (69%) done

[Sun Jul  5 23:39:48 2020]
rule get_outgroups:
    input: per_gene/EOG091G08SM/EOG091G08SM.ingroup.fasta
    output: per_gene/EOG091G08SM/EOG091G08SM.orthodb.fasta, per_gene/EOG091G08SM/EOG091G08SM.outgroup.fasta
    log: per_gene/EOG091G08SM/get_outgroups.stdout.txt, per_gene/EOG091G08SM/get_outgroups.stderr.txt
    jobid: 3163
    wildcards: BUSCO=EOG091G08SM


        #download fastas from Orhtodb for BUSCO id
        for i in {1..5}
        do
             wget "http://www.orthodb.org/fasta?query=EOG091G08SM&level=33208" -O per_gene/EOG091G08SM/EOG091G08SM.orthodb.fasta 1> per_gene/EOG091G08SM/get_outgroups.stdout.txt 2> per_gene/EOG091G08SM/get_outgroups.stderr.txt && break || echo -e "try again ($i)" && sleep 15
        done

	#This is quick an dirty for now and just takes the first protein if there is more than one for an outgroup taxon
        bash ../scripts/download_outgroups.sh taxids.txt per_gene/EOG091G08SM/EOG091G08SM.orthodb.fasta > per_gene/EOG091G08SM/EOG091G08SM.outgroup.fasta
        
[Sun Jul  5 23:39:49 2020]
Finished job 3163.
2283 of 3292 steps (69%) done

[Sun Jul  5 23:39:49 2020]
rule join_groups:
    input: per_gene/EOG091G08SM/EOG091G08SM.ingroup.fasta, per_gene/EOG091G08SM/EOG091G08SM.outgroup.fasta
    output: per_gene/EOG091G08SM/EOG091G08SM.fasta
    jobid: 2405
    wildcards: BUSCO=EOG091G08SM


        cat per_gene/EOG091G08SM/EOG091G08SM.ingroup.fasta per_gene/EOG091G08SM/EOG091G08SM.outgroup.fasta > per_gene/EOG091G08SM/EOG091G08SM.fasta
        
[Sun Jul  5 23:39:49 2020]
Finished job 2405.
2284 of 3292 steps (69%) done

[Sun Jul  5 23:39:49 2020]
rule MSA:
    input: per_gene/EOG091G08SM/EOG091G08SM.fasta
    output: per_gene/EOG091G08SM/EOG091G08SM.clustalo.fasta
    log: per_gene/EOG091G08SM/MSA.stdout.txt, per_gene/EOG091G08SM/MSA.stderr.txt
    jobid: 1930
    wildcards: BUSCO=EOG091G08SM
    threads: 2


        clustalo -i per_gene/EOG091G08SM/EOG091G08SM.fasta -o per_gene/EOG091G08SM/EOG091G08SM.clustalo.fasta --threads=2 1> per_gene/EOG091G08SM/MSA.stdout.txt 2> per_gene/EOG091G08SM/MSA.stderr.txt
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/d68c9691725a7401923680874285c430.simg
[Sun Jul  5 23:39:50 2020]
Finished job 229.
2285 of 3292 steps (69%) done

[Sun Jul  5 23:39:50 2020]
rule get_seqs:
    input: /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ingroup.txt, /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/outgroup.txt
    output: per_gene/EOG091G0PIU/EOG091G0PIU.ingroup.fasta
    log: per_gene/EOG091G0PIU/get_seqs.stdout.txt, per_gene/EOG091G0PIU/get_seqs.stderr.txt
    jobid: 3244
    wildcards: BUSCO=EOG091G0PIU
    threads: 2


	basedir=$(pwd)
        cd per_gene/EOG091G0PIU
        
        bash $basedir/../scripts/fetch_seqs.sh EOG091G0PIU /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ingroup.txt /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/outgroup.txt 1> ../../per_gene/EOG091G0PIU/get_seqs.stdout.txt 2> ../../per_gene/EOG091G0PIU/get_seqs.stderr.txt
	mv EOG091G0PIU.fasta $basedir/per_gene/EOG091G0PIU/EOG091G0PIU.ingroup.fasta
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/72476f9d9a5bd0627b4d721143a21354.simg
[Sun Jul  5 23:39:51 2020]
Finished job 1930.
2286 of 3292 steps (69%) done

[Sun Jul  5 23:39:51 2020]
rule score_and_cut:
    input: per_gene/EOG091G08SM/EOG091G08SM.clustalo.fasta
    output: per_gene/EOG091G08SM/ALICUT_EOG091G08SM.clustalo.fasta
    jobid: 1107
    wildcards: BUSCO=EOG091G08SM
    threads: 2


        cd per_gene/EOG091G08SM
        Aliscore.pl -N -r 200000000000000000 -i ../../per_gene/EOG091G08SM/EOG091G08SM.clustalo.fasta &> aliscore.log
        ALICUT.pl -s &> alicut.log
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/63c88c27a0fa300f57066b0ef65fefcb.simg
[Sun Jul  5 23:39:56 2020]
Finished job 2724.
2287 of 3292 steps (69%) done

[Sun Jul  5 23:39:56 2020]
rule get_outgroups:
    input: per_gene/EOG091G0J2W/EOG091G0J2W.ingroup.fasta
    output: per_gene/EOG091G0J2W/EOG091G0J2W.orthodb.fasta, per_gene/EOG091G0J2W/EOG091G0J2W.outgroup.fasta
    log: per_gene/EOG091G0J2W/get_outgroups.stdout.txt, per_gene/EOG091G0J2W/get_outgroups.stderr.txt
    jobid: 2725
    wildcards: BUSCO=EOG091G0J2W


        #download fastas from Orhtodb for BUSCO id
        for i in {1..5}
        do
             wget "http://www.orthodb.org/fasta?query=EOG091G0J2W&level=33208" -O per_gene/EOG091G0J2W/EOG091G0J2W.orthodb.fasta 1> per_gene/EOG091G0J2W/get_outgroups.stdout.txt 2> per_gene/EOG091G0J2W/get_outgroups.stderr.txt && break || echo -e "try again ($i)" && sleep 15
        done

	#This is quick an dirty for now and just takes the first protein if there is more than one for an outgroup taxon
        bash ../scripts/download_outgroups.sh taxids.txt per_gene/EOG091G0J2W/EOG091G0J2W.orthodb.fasta > per_gene/EOG091G0J2W/EOG091G0J2W.outgroup.fasta
        
[Sun Jul  5 23:39:56 2020]
Finished job 2725.
2288 of 3292 steps (70%) done

[Sun Jul  5 23:39:56 2020]
rule join_groups:
    input: per_gene/EOG091G0J2W/EOG091G0J2W.ingroup.fasta, per_gene/EOG091G0J2W/EOG091G0J2W.outgroup.fasta
    output: per_gene/EOG091G0J2W/EOG091G0J2W.fasta
    jobid: 2186
    wildcards: BUSCO=EOG091G0J2W


        cat per_gene/EOG091G0J2W/EOG091G0J2W.ingroup.fasta per_gene/EOG091G0J2W/EOG091G0J2W.outgroup.fasta > per_gene/EOG091G0J2W/EOG091G0J2W.fasta
        
[Sun Jul  5 23:39:57 2020]
Finished job 2186.
2289 of 3292 steps (70%) done

[Sun Jul  5 23:39:57 2020]
rule MSA:
    input: per_gene/EOG091G0J2W/EOG091G0J2W.fasta
    output: per_gene/EOG091G0J2W/EOG091G0J2W.clustalo.fasta
    log: per_gene/EOG091G0J2W/MSA.stdout.txt, per_gene/EOG091G0J2W/MSA.stderr.txt
    jobid: 1492
    wildcards: BUSCO=EOG091G0J2W
    threads: 2


        clustalo -i per_gene/EOG091G0J2W/EOG091G0J2W.fasta -o per_gene/EOG091G0J2W/EOG091G0J2W.clustalo.fasta --threads=2 1> per_gene/EOG091G0J2W/MSA.stdout.txt 2> per_gene/EOG091G0J2W/MSA.stderr.txt
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/d68c9691725a7401923680874285c430.simg
[Sun Jul  5 23:39:57 2020]
Finished job 1492.
2290 of 3292 steps (70%) done

[Sun Jul  5 23:39:57 2020]
rule score_and_cut:
    input: per_gene/EOG091G0J2W/EOG091G0J2W.clustalo.fasta
    output: per_gene/EOG091G0J2W/ALICUT_EOG091G0J2W.clustalo.fasta
    jobid: 669
    wildcards: BUSCO=EOG091G0J2W
    threads: 2


        cd per_gene/EOG091G0J2W
        Aliscore.pl -N -r 200000000000000000 -i ../../per_gene/EOG091G0J2W/EOG091G0J2W.clustalo.fasta &> aliscore.log
        ALICUT.pl -s &> alicut.log
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/63c88c27a0fa300f57066b0ef65fefcb.simg
[Sun Jul  5 23:40:00 2020]
Finished job 1107.
2291 of 3292 steps (70%) done

[Sun Jul  5 23:40:00 2020]
rule remove_empty:
    input: per_gene/EOG091G08SM/ALICUT_EOG091G08SM.clustalo.fasta
    output: per_gene/EOG091G08SM/empty_check.done
    jobid: 1929
    wildcards: BUSCO=EOG091G08SM


         if [ "$(cat per_gene/EOG091G08SM/ALICUT_EOG091G08SM.clustalo.fasta | grep -v ">" | sed 's/-//g' | grep "^$" | wc -l)" -gt 0 ]
         then
              cp per_gene/EOG091G08SM/ALICUT_EOG091G08SM.clustalo.fasta per_gene/EOG091G08SM/ALICUT_EOG091G08SM.clustalo.fasta.backup
              bash ../scripts/remove_empty.sh per_gene/EOG091G08SM/ALICUT_EOG091G08SM.clustalo.fasta.backup > per_gene/EOG091G08SM/ALICUT_EOG091G08SM.clustalo.fasta
         fi
         touch per_gene/EOG091G08SM/empty_check.done
         
[Sun Jul  5 23:40:01 2020]
Finished job 1929.
2292 of 3292 steps (70%) done

[Sun Jul  5 23:40:01 2020]
rule find_best_model:
    input: per_gene/EOG091G08SM/ALICUT_EOG091G08SM.clustalo.fasta, per_gene/EOG091G08SM/empty_check.done
    output: per_gene/EOG091G08SM/EOG091G08SM.best_model
    log: per_gene/EOG091G08SM/find_best_model.stderr.txt
    jobid: 1106
    wildcards: BUSCO=EOG091G08SM
    threads: 2


        cd per_gene/EOG091G08SM
        if [ ! -d find_best_model ]
        then
            mkdir find_best_model
        fi
        cd find_best_model
        ln -s ../../../per_gene/EOG091G08SM/ALICUT_EOG091G08SM.clustalo.fasta EOG091G08SM.fasta
        ProteinModelSelection.pl EOG091G08SM.fasta 1> ../../../per_gene/EOG091G08SM/EOG091G08SM.best_model 2> ../../../per_gene/EOG091G08SM/find_best_model.stderr.txt
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/c0c09ee657b1e27f2c5687e0e9aa8d70.simg
[Sun Jul  5 23:40:03 2020]
Finished job 1014.
2293 of 3292 steps (70%) done

[Sun Jul  5 23:40:03 2020]
rule infer_single_ML:
    input: per_gene/EOG091G079R/EOG091G079R.best_model, per_gene/EOG091G079R/ALICUT_EOG091G079R.clustalo.fasta
    output: per_gene/EOG091G079R/EOG091G079R.raxml.done
    log: per_gene/EOG091G079R/infer_single_ML.stdout.txt, per_gene/EOG091G079R/infer_single_ML.stderr.txt
    jobid: 301
    wildcards: BUSCO=EOG091G079R
    threads: 2


        cd per_gene/EOG091G079R
	count=$(cat ../../per_gene/EOG091G079R/ALICUT_EOG091G079R.clustalo.fasta | grep ">" | wc -l)
	if [ "$count" -gt 5 ]
        then
		RAxMLmodel=$(cat ../../per_gene/EOG091G079R/EOG091G079R.best_model | grep "Best" | cut -d ":" -f 2 | tr -d '[:space:]')
                if [ "$(ls -1 | grep "^RAxML" | wc -l)" -ne 0 ]
		then
			rm RAxML*
		fi
        	raxml -f a -T 2 -m PROTGAMMA$RAxMLmodel         	-p 12345 -x 12345 -# 100         	-s ../../per_gene/EOG091G079R/ALICUT_EOG091G079R.clustalo.fasta -n EOG091G079R.clustalo.aln.ALICUT.$RAxMLmodel 		1> ../../per_gene/EOG091G079R/infer_single_ML.stdout.txt 2> ../../per_gene/EOG091G079R/infer_single_ML.stderr.txt
	else
		echo "fasta file per_gene/EOG091G079R/ALICUT_EOG091G079R.clustalo.fasta contains fewer than 5 sequences - skipped" > ../../per_gene/EOG091G079R/infer_single_ML.stdout.txt
		touch raxml.skipped
	fi
        touch ../../per_gene/EOG091G079R/EOG091G079R.raxml.done
        
[Sun Jul  5 23:40:05 2020]
Finished job 3244.
2294 of 3292 steps (70%) done

[Sun Jul  5 23:40:05 2020]
rule get_outgroups:
    input: per_gene/EOG091G0PIU/EOG091G0PIU.ingroup.fasta
    output: per_gene/EOG091G0PIU/EOG091G0PIU.orthodb.fasta, per_gene/EOG091G0PIU/EOG091G0PIU.outgroup.fasta
    log: per_gene/EOG091G0PIU/get_outgroups.stdout.txt, per_gene/EOG091G0PIU/get_outgroups.stderr.txt
    jobid: 3245
    wildcards: BUSCO=EOG091G0PIU


        #download fastas from Orhtodb for BUSCO id
        for i in {1..5}
        do
             wget "http://www.orthodb.org/fasta?query=EOG091G0PIU&level=33208" -O per_gene/EOG091G0PIU/EOG091G0PIU.orthodb.fasta 1> per_gene/EOG091G0PIU/get_outgroups.stdout.txt 2> per_gene/EOG091G0PIU/get_outgroups.stderr.txt && break || echo -e "try again ($i)" && sleep 15
        done

	#This is quick an dirty for now and just takes the first protein if there is more than one for an outgroup taxon
        bash ../scripts/download_outgroups.sh taxids.txt per_gene/EOG091G0PIU/EOG091G0PIU.orthodb.fasta > per_gene/EOG091G0PIU/EOG091G0PIU.outgroup.fasta
        
[Sun Jul  5 23:40:05 2020]
Finished job 3245.
2295 of 3292 steps (70%) done

[Sun Jul  5 23:40:05 2020]
rule join_groups:
    input: per_gene/EOG091G0PIU/EOG091G0PIU.ingroup.fasta, per_gene/EOG091G0PIU/EOG091G0PIU.outgroup.fasta
    output: per_gene/EOG091G0PIU/EOG091G0PIU.fasta
    jobid: 2446
    wildcards: BUSCO=EOG091G0PIU


        cat per_gene/EOG091G0PIU/EOG091G0PIU.ingroup.fasta per_gene/EOG091G0PIU/EOG091G0PIU.outgroup.fasta > per_gene/EOG091G0PIU/EOG091G0PIU.fasta
        
[Sun Jul  5 23:40:05 2020]
Finished job 2446.
2296 of 3292 steps (70%) done

[Sun Jul  5 23:40:05 2020]
rule MSA:
    input: per_gene/EOG091G0PIU/EOG091G0PIU.fasta
    output: per_gene/EOG091G0PIU/EOG091G0PIU.clustalo.fasta
    log: per_gene/EOG091G0PIU/MSA.stdout.txt, per_gene/EOG091G0PIU/MSA.stderr.txt
    jobid: 2012
    wildcards: BUSCO=EOG091G0PIU
    threads: 2


        clustalo -i per_gene/EOG091G0PIU/EOG091G0PIU.fasta -o per_gene/EOG091G0PIU/EOG091G0PIU.clustalo.fasta --threads=2 1> per_gene/EOG091G0PIU/MSA.stdout.txt 2> per_gene/EOG091G0PIU/MSA.stderr.txt
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/d68c9691725a7401923680874285c430.simg
[Sun Jul  5 23:40:06 2020]
Finished job 2012.
2297 of 3292 steps (70%) done

[Sun Jul  5 23:40:06 2020]
rule score_and_cut:
    input: per_gene/EOG091G0PIU/EOG091G0PIU.clustalo.fasta
    output: per_gene/EOG091G0PIU/ALICUT_EOG091G0PIU.clustalo.fasta
    jobid: 1189
    wildcards: BUSCO=EOG091G0PIU
    threads: 2


        cd per_gene/EOG091G0PIU
        Aliscore.pl -N -r 200000000000000000 -i ../../per_gene/EOG091G0PIU/EOG091G0PIU.clustalo.fasta &> aliscore.log
        ALICUT.pl -s &> alicut.log
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/63c88c27a0fa300f57066b0ef65fefcb.simg
[Sun Jul  5 23:40:08 2020]
Finished job 669.
2298 of 3292 steps (70%) done

[Sun Jul  5 23:40:08 2020]
rule remove_empty:
    input: per_gene/EOG091G0J2W/ALICUT_EOG091G0J2W.clustalo.fasta
    output: per_gene/EOG091G0J2W/empty_check.done
    jobid: 1491
    wildcards: BUSCO=EOG091G0J2W


         if [ "$(cat per_gene/EOG091G0J2W/ALICUT_EOG091G0J2W.clustalo.fasta | grep -v ">" | sed 's/-//g' | grep "^$" | wc -l)" -gt 0 ]
         then
              cp per_gene/EOG091G0J2W/ALICUT_EOG091G0J2W.clustalo.fasta per_gene/EOG091G0J2W/ALICUT_EOG091G0J2W.clustalo.fasta.backup
              bash ../scripts/remove_empty.sh per_gene/EOG091G0J2W/ALICUT_EOG091G0J2W.clustalo.fasta.backup > per_gene/EOG091G0J2W/ALICUT_EOG091G0J2W.clustalo.fasta
         fi
         touch per_gene/EOG091G0J2W/empty_check.done
         
[Sun Jul  5 23:40:10 2020]
Finished job 1491.
2299 of 3292 steps (70%) done

[Sun Jul  5 23:40:10 2020]
rule find_best_model:
    input: per_gene/EOG091G0J2W/ALICUT_EOG091G0J2W.clustalo.fasta, per_gene/EOG091G0J2W/empty_check.done
    output: per_gene/EOG091G0J2W/EOG091G0J2W.best_model
    log: per_gene/EOG091G0J2W/find_best_model.stderr.txt
    jobid: 668
    wildcards: BUSCO=EOG091G0J2W
    threads: 2


        cd per_gene/EOG091G0J2W
        if [ ! -d find_best_model ]
        then
            mkdir find_best_model
        fi
        cd find_best_model
        ln -s ../../../per_gene/EOG091G0J2W/ALICUT_EOG091G0J2W.clustalo.fasta EOG091G0J2W.fasta
        ProteinModelSelection.pl EOG091G0J2W.fasta 1> ../../../per_gene/EOG091G0J2W/EOG091G0J2W.best_model 2> ../../../per_gene/EOG091G0J2W/find_best_model.stderr.txt
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/c0c09ee657b1e27f2c5687e0e9aa8d70.simg
[Sun Jul  5 23:40:16 2020]
Finished job 1189.
2300 of 3292 steps (70%) done

[Sun Jul  5 23:40:16 2020]
rule remove_empty:
    input: per_gene/EOG091G0PIU/ALICUT_EOG091G0PIU.clustalo.fasta
    output: per_gene/EOG091G0PIU/empty_check.done
    jobid: 2011
    wildcards: BUSCO=EOG091G0PIU


         if [ "$(cat per_gene/EOG091G0PIU/ALICUT_EOG091G0PIU.clustalo.fasta | grep -v ">" | sed 's/-//g' | grep "^$" | wc -l)" -gt 0 ]
         then
              cp per_gene/EOG091G0PIU/ALICUT_EOG091G0PIU.clustalo.fasta per_gene/EOG091G0PIU/ALICUT_EOG091G0PIU.clustalo.fasta.backup
              bash ../scripts/remove_empty.sh per_gene/EOG091G0PIU/ALICUT_EOG091G0PIU.clustalo.fasta.backup > per_gene/EOG091G0PIU/ALICUT_EOG091G0PIU.clustalo.fasta
         fi
         touch per_gene/EOG091G0PIU/empty_check.done
         
[Sun Jul  5 23:40:16 2020]
Finished job 2011.
2301 of 3292 steps (70%) done

[Sun Jul  5 23:40:16 2020]
rule find_best_model:
    input: per_gene/EOG091G0PIU/ALICUT_EOG091G0PIU.clustalo.fasta, per_gene/EOG091G0PIU/empty_check.done
    output: per_gene/EOG091G0PIU/EOG091G0PIU.best_model
    log: per_gene/EOG091G0PIU/find_best_model.stderr.txt
    jobid: 1188
    wildcards: BUSCO=EOG091G0PIU
    threads: 2


        cd per_gene/EOG091G0PIU
        if [ ! -d find_best_model ]
        then
            mkdir find_best_model
        fi
        cd find_best_model
        ln -s ../../../per_gene/EOG091G0PIU/ALICUT_EOG091G0PIU.clustalo.fasta EOG091G0PIU.fasta
        ProteinModelSelection.pl EOG091G0PIU.fasta 1> ../../../per_gene/EOG091G0PIU/EOG091G0PIU.best_model 2> ../../../per_gene/EOG091G0PIU/find_best_model.stderr.txt
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/c0c09ee657b1e27f2c5687e0e9aa8d70.simg
[33mJob counts:
	count	jobs
	1	infer_single_ML
	1[0m
[33m
        cd per_gene/EOG091G079R
	count=$(cat ../../per_gene/EOG091G079R/ALICUT_EOG091G079R.clustalo.fasta | grep ">" | wc -l)
	if [ "$count" -gt 5 ]
        then
		RAxMLmodel=$(cat ../../per_gene/EOG091G079R/EOG091G079R.best_model | grep "Best" | cut -d ":" -f 2 | tr -d '[:space:]')
                if [ "$(ls -1 | grep "^RAxML" | wc -l)" -ne 0 ]
		then
			rm RAxML*
		fi
        	raxml -f a -T 2 -m PROTGAMMA$RAxMLmodel         	-p 12345 -x 12345 -# 100         	-s ../../per_gene/EOG091G079R/ALICUT_EOG091G079R.clustalo.fasta -n EOG091G079R.clustalo.aln.ALICUT.$RAxMLmodel 		1> ../../per_gene/EOG091G079R/infer_single_ML.stdout.txt 2> ../../per_gene/EOG091G079R/infer_single_ML.stderr.txt
	else
		echo "fasta file per_gene/EOG091G079R/ALICUT_EOG091G079R.clustalo.fasta contains fewer than 5 sequences - skipped" > ../../per_gene/EOG091G079R/infer_single_ML.stdout.txt
		touch raxml.skipped
	fi
        touch ../../per_gene/EOG091G079R/EOG091G079R.raxml.done
        [0m
[Sun Jul  5 23:40:34 2020]
Finished job 1106.
2302 of 3292 steps (70%) done

[Sun Jul  5 23:40:34 2020]
rule infer_single_ML:
    input: per_gene/EOG091G08SM/EOG091G08SM.best_model, per_gene/EOG091G08SM/ALICUT_EOG091G08SM.clustalo.fasta
    output: per_gene/EOG091G08SM/EOG091G08SM.raxml.done
    log: per_gene/EOG091G08SM/infer_single_ML.stdout.txt, per_gene/EOG091G08SM/infer_single_ML.stderr.txt
    jobid: 347
    wildcards: BUSCO=EOG091G08SM
    threads: 2


        cd per_gene/EOG091G08SM
	count=$(cat ../../per_gene/EOG091G08SM/ALICUT_EOG091G08SM.clustalo.fasta | grep ">" | wc -l)
	if [ "$count" -gt 5 ]
        then
		RAxMLmodel=$(cat ../../per_gene/EOG091G08SM/EOG091G08SM.best_model | grep "Best" | cut -d ":" -f 2 | tr -d '[:space:]')
                if [ "$(ls -1 | grep "^RAxML" | wc -l)" -ne 0 ]
		then
			rm RAxML*
		fi
        	raxml -f a -T 2 -m PROTGAMMA$RAxMLmodel         	-p 12345 -x 12345 -# 100         	-s ../../per_gene/EOG091G08SM/ALICUT_EOG091G08SM.clustalo.fasta -n EOG091G08SM.clustalo.aln.ALICUT.$RAxMLmodel 		1> ../../per_gene/EOG091G08SM/infer_single_ML.stdout.txt 2> ../../per_gene/EOG091G08SM/infer_single_ML.stderr.txt
	else
		echo "fasta file per_gene/EOG091G08SM/ALICUT_EOG091G08SM.clustalo.fasta contains fewer than 5 sequences - skipped" > ../../per_gene/EOG091G08SM/infer_single_ML.stdout.txt
		touch raxml.skipped
	fi
        touch ../../per_gene/EOG091G08SM/EOG091G08SM.raxml.done
        
[Sun Jul  5 23:40:36 2020]
Finished job 668.
2303 of 3292 steps (70%) done

[Sun Jul  5 23:40:36 2020]
rule infer_single_ML:
    input: per_gene/EOG091G0J2W/EOG091G0J2W.best_model, per_gene/EOG091G0J2W/ALICUT_EOG091G0J2W.clustalo.fasta
    output: per_gene/EOG091G0J2W/EOG091G0J2W.raxml.done
    log: per_gene/EOG091G0J2W/infer_single_ML.stdout.txt, per_gene/EOG091G0J2W/infer_single_ML.stderr.txt
    jobid: 128
    wildcards: BUSCO=EOG091G0J2W
    threads: 2


        cd per_gene/EOG091G0J2W
	count=$(cat ../../per_gene/EOG091G0J2W/ALICUT_EOG091G0J2W.clustalo.fasta | grep ">" | wc -l)
	if [ "$count" -gt 5 ]
        then
		RAxMLmodel=$(cat ../../per_gene/EOG091G0J2W/EOG091G0J2W.best_model | grep "Best" | cut -d ":" -f 2 | tr -d '[:space:]')
                if [ "$(ls -1 | grep "^RAxML" | wc -l)" -ne 0 ]
		then
			rm RAxML*
		fi
        	raxml -f a -T 2 -m PROTGAMMA$RAxMLmodel         	-p 12345 -x 12345 -# 100         	-s ../../per_gene/EOG091G0J2W/ALICUT_EOG091G0J2W.clustalo.fasta -n EOG091G0J2W.clustalo.aln.ALICUT.$RAxMLmodel 		1> ../../per_gene/EOG091G0J2W/infer_single_ML.stdout.txt 2> ../../per_gene/EOG091G0J2W/infer_single_ML.stderr.txt
	else
		echo "fasta file per_gene/EOG091G0J2W/ALICUT_EOG091G0J2W.clustalo.fasta contains fewer than 5 sequences - skipped" > ../../per_gene/EOG091G0J2W/infer_single_ML.stdout.txt
		touch raxml.skipped
	fi
        touch ../../per_gene/EOG091G0J2W/EOG091G0J2W.raxml.done
        
[Sun Jul  5 23:40:37 2020]
Finished job 216.
2304 of 3292 steps (70%) done

[Sun Jul  5 23:40:37 2020]
rule get_seqs:
    input: /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ingroup.txt, /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/outgroup.txt
    output: per_gene/EOG091G05KR/EOG091G05KR.ingroup.fasta
    log: per_gene/EOG091G05KR/get_seqs.stdout.txt, per_gene/EOG091G05KR/get_seqs.stderr.txt
    jobid: 2542
    wildcards: BUSCO=EOG091G05KR
    threads: 2


	basedir=$(pwd)
        cd per_gene/EOG091G05KR
        
        bash $basedir/../scripts/fetch_seqs.sh EOG091G05KR /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ingroup.txt /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/outgroup.txt 1> ../../per_gene/EOG091G05KR/get_seqs.stdout.txt 2> ../../per_gene/EOG091G05KR/get_seqs.stderr.txt
	mv EOG091G05KR.fasta $basedir/per_gene/EOG091G05KR/EOG091G05KR.ingroup.fasta
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/72476f9d9a5bd0627b4d721143a21354.simg
[33mJob counts:
	count	jobs
	1	infer_single_ML
	1[0m
[33m
        cd per_gene/EOG091G08SM
	count=$(cat ../../per_gene/EOG091G08SM/ALICUT_EOG091G08SM.clustalo.fasta | grep ">" | wc -l)
	if [ "$count" -gt 5 ]
        then
		RAxMLmodel=$(cat ../../per_gene/EOG091G08SM/EOG091G08SM.best_model | grep "Best" | cut -d ":" -f 2 | tr -d '[:space:]')
                if [ "$(ls -1 | grep "^RAxML" | wc -l)" -ne 0 ]
		then
			rm RAxML*
		fi
        	raxml -f a -T 2 -m PROTGAMMA$RAxMLmodel         	-p 12345 -x 12345 -# 100         	-s ../../per_gene/EOG091G08SM/ALICUT_EOG091G08SM.clustalo.fasta -n EOG091G08SM.clustalo.aln.ALICUT.$RAxMLmodel 		1> ../../per_gene/EOG091G08SM/infer_single_ML.stdout.txt 2> ../../per_gene/EOG091G08SM/infer_single_ML.stderr.txt
	else
		echo "fasta file per_gene/EOG091G08SM/ALICUT_EOG091G08SM.clustalo.fasta contains fewer than 5 sequences - skipped" > ../../per_gene/EOG091G08SM/infer_single_ML.stdout.txt
		touch raxml.skipped
	fi
        touch ../../per_gene/EOG091G08SM/EOG091G08SM.raxml.done
        [0m
[Sun Jul  5 23:40:38 2020]
Finished job 162.
2305 of 3292 steps (70%) done

[Sun Jul  5 23:40:38 2020]
rule get_seqs:
    input: /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ingroup.txt, /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/outgroup.txt
    output: per_gene/EOG091G06M8/EOG091G06M8.ingroup.fasta
    log: per_gene/EOG091G06M8/get_seqs.stdout.txt, per_gene/EOG091G06M8/get_seqs.stderr.txt
    jobid: 2558
    wildcards: BUSCO=EOG091G06M8
    threads: 2


	basedir=$(pwd)
        cd per_gene/EOG091G06M8
        
        bash $basedir/../scripts/fetch_seqs.sh EOG091G06M8 /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ingroup.txt /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/outgroup.txt 1> ../../per_gene/EOG091G06M8/get_seqs.stdout.txt 2> ../../per_gene/EOG091G06M8/get_seqs.stderr.txt
	mv EOG091G06M8.fasta $basedir/per_gene/EOG091G06M8/EOG091G06M8.ingroup.fasta
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/72476f9d9a5bd0627b4d721143a21354.simg
[33mJob counts:
	count	jobs
	1	infer_single_ML
	1[0m
[33m
        cd per_gene/EOG091G0J2W
	count=$(cat ../../per_gene/EOG091G0J2W/ALICUT_EOG091G0J2W.clustalo.fasta | grep ">" | wc -l)
	if [ "$count" -gt 5 ]
        then
		RAxMLmodel=$(cat ../../per_gene/EOG091G0J2W/EOG091G0J2W.best_model | grep "Best" | cut -d ":" -f 2 | tr -d '[:space:]')
                if [ "$(ls -1 | grep "^RAxML" | wc -l)" -ne 0 ]
		then
			rm RAxML*
		fi
        	raxml -f a -T 2 -m PROTGAMMA$RAxMLmodel         	-p 12345 -x 12345 -# 100         	-s ../../per_gene/EOG091G0J2W/ALICUT_EOG091G0J2W.clustalo.fasta -n EOG091G0J2W.clustalo.aln.ALICUT.$RAxMLmodel 		1> ../../per_gene/EOG091G0J2W/infer_single_ML.stdout.txt 2> ../../per_gene/EOG091G0J2W/infer_single_ML.stderr.txt
	else
		echo "fasta file per_gene/EOG091G0J2W/ALICUT_EOG091G0J2W.clustalo.fasta contains fewer than 5 sequences - skipped" > ../../per_gene/EOG091G0J2W/infer_single_ML.stdout.txt
		touch raxml.skipped
	fi
        touch ../../per_gene/EOG091G0J2W/EOG091G0J2W.raxml.done
        [0m
[Sun Jul  5 23:40:48 2020]
Finished job 1188.
2306 of 3292 steps (70%) done

[Sun Jul  5 23:40:48 2020]
rule infer_single_ML:
    input: per_gene/EOG091G0PIU/EOG091G0PIU.best_model, per_gene/EOG091G0PIU/ALICUT_EOG091G0PIU.clustalo.fasta
    output: per_gene/EOG091G0PIU/EOG091G0PIU.raxml.done
    log: per_gene/EOG091G0PIU/infer_single_ML.stdout.txt, per_gene/EOG091G0PIU/infer_single_ML.stderr.txt
    jobid: 388
    wildcards: BUSCO=EOG091G0PIU
    threads: 2


        cd per_gene/EOG091G0PIU
	count=$(cat ../../per_gene/EOG091G0PIU/ALICUT_EOG091G0PIU.clustalo.fasta | grep ">" | wc -l)
	if [ "$count" -gt 5 ]
        then
		RAxMLmodel=$(cat ../../per_gene/EOG091G0PIU/EOG091G0PIU.best_model | grep "Best" | cut -d ":" -f 2 | tr -d '[:space:]')
                if [ "$(ls -1 | grep "^RAxML" | wc -l)" -ne 0 ]
		then
			rm RAxML*
		fi
        	raxml -f a -T 2 -m PROTGAMMA$RAxMLmodel         	-p 12345 -x 12345 -# 100         	-s ../../per_gene/EOG091G0PIU/ALICUT_EOG091G0PIU.clustalo.fasta -n EOG091G0PIU.clustalo.aln.ALICUT.$RAxMLmodel 		1> ../../per_gene/EOG091G0PIU/infer_single_ML.stdout.txt 2> ../../per_gene/EOG091G0PIU/infer_single_ML.stderr.txt
	else
		echo "fasta file per_gene/EOG091G0PIU/ALICUT_EOG091G0PIU.clustalo.fasta contains fewer than 5 sequences - skipped" > ../../per_gene/EOG091G0PIU/infer_single_ML.stdout.txt
		touch raxml.skipped
	fi
        touch ../../per_gene/EOG091G0PIU/EOG091G0PIU.raxml.done
        
[Sun Jul  5 23:40:48 2020]
Finished job 101.
2307 of 3292 steps (70%) done

[Sun Jul  5 23:40:48 2020]
rule get_seqs:
    input: /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ingroup.txt, /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/outgroup.txt
    output: per_gene/EOG091G0C7Y/EOG091G0C7Y.ingroup.fasta
    log: per_gene/EOG091G0C7Y/get_seqs.stdout.txt, per_gene/EOG091G0C7Y/get_seqs.stderr.txt
    jobid: 3180
    wildcards: BUSCO=EOG091G0C7Y
    threads: 2


	basedir=$(pwd)
        cd per_gene/EOG091G0C7Y
        
        bash $basedir/../scripts/fetch_seqs.sh EOG091G0C7Y /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ingroup.txt /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/outgroup.txt 1> ../../per_gene/EOG091G0C7Y/get_seqs.stdout.txt 2> ../../per_gene/EOG091G0C7Y/get_seqs.stderr.txt
	mv EOG091G0C7Y.fasta $basedir/per_gene/EOG091G0C7Y/EOG091G0C7Y.ingroup.fasta
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/72476f9d9a5bd0627b4d721143a21354.simg
[Sun Jul  5 23:40:48 2020]
Finished job 282.
2308 of 3292 steps (70%) done

[Sun Jul  5 23:40:48 2020]
rule get_seqs:
    input: /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ingroup.txt, /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/outgroup.txt
    output: per_gene/EOG091G0UB5/EOG091G0UB5.ingroup.fasta
    log: per_gene/EOG091G0UB5/get_seqs.stdout.txt, per_gene/EOG091G0UB5/get_seqs.stderr.txt
    jobid: 3028
    wildcards: BUSCO=EOG091G0UB5
    threads: 2


	basedir=$(pwd)
        cd per_gene/EOG091G0UB5
        
        bash $basedir/../scripts/fetch_seqs.sh EOG091G0UB5 /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ingroup.txt /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/outgroup.txt 1> ../../per_gene/EOG091G0UB5/get_seqs.stdout.txt 2> ../../per_gene/EOG091G0UB5/get_seqs.stderr.txt
	mv EOG091G0UB5.fasta $basedir/per_gene/EOG091G0UB5/EOG091G0UB5.ingroup.fasta
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/72476f9d9a5bd0627b4d721143a21354.simg
[33mJob counts:
	count	jobs
	1	infer_single_ML
	1[0m
[33m
        cd per_gene/EOG091G0PIU
	count=$(cat ../../per_gene/EOG091G0PIU/ALICUT_EOG091G0PIU.clustalo.fasta | grep ">" | wc -l)
	if [ "$count" -gt 5 ]
        then
		RAxMLmodel=$(cat ../../per_gene/EOG091G0PIU/EOG091G0PIU.best_model | grep "Best" | cut -d ":" -f 2 | tr -d '[:space:]')
                if [ "$(ls -1 | grep "^RAxML" | wc -l)" -ne 0 ]
		then
			rm RAxML*
		fi
        	raxml -f a -T 2 -m PROTGAMMA$RAxMLmodel         	-p 12345 -x 12345 -# 100         	-s ../../per_gene/EOG091G0PIU/ALICUT_EOG091G0PIU.clustalo.fasta -n EOG091G0PIU.clustalo.aln.ALICUT.$RAxMLmodel 		1> ../../per_gene/EOG091G0PIU/infer_single_ML.stdout.txt 2> ../../per_gene/EOG091G0PIU/infer_single_ML.stderr.txt
	else
		echo "fasta file per_gene/EOG091G0PIU/ALICUT_EOG091G0PIU.clustalo.fasta contains fewer than 5 sequences - skipped" > ../../per_gene/EOG091G0PIU/infer_single_ML.stdout.txt
		touch raxml.skipped
	fi
        touch ../../per_gene/EOG091G0PIU/EOG091G0PIU.raxml.done
        [0m
[Sun Jul  5 23:40:51 2020]
Finished job 2542.
2309 of 3292 steps (70%) done

[Sun Jul  5 23:40:51 2020]
rule get_outgroups:
    input: per_gene/EOG091G05KR/EOG091G05KR.ingroup.fasta
    output: per_gene/EOG091G05KR/EOG091G05KR.orthodb.fasta, per_gene/EOG091G05KR/EOG091G05KR.outgroup.fasta
    log: per_gene/EOG091G05KR/get_outgroups.stdout.txt, per_gene/EOG091G05KR/get_outgroups.stderr.txt
    jobid: 2543
    wildcards: BUSCO=EOG091G05KR


        #download fastas from Orhtodb for BUSCO id
        for i in {1..5}
        do
             wget "http://www.orthodb.org/fasta?query=EOG091G05KR&level=33208" -O per_gene/EOG091G05KR/EOG091G05KR.orthodb.fasta 1> per_gene/EOG091G05KR/get_outgroups.stdout.txt 2> per_gene/EOG091G05KR/get_outgroups.stderr.txt && break || echo -e "try again ($i)" && sleep 15
        done

	#This is quick an dirty for now and just takes the first protein if there is more than one for an outgroup taxon
        bash ../scripts/download_outgroups.sh taxids.txt per_gene/EOG091G05KR/EOG091G05KR.orthodb.fasta > per_gene/EOG091G05KR/EOG091G05KR.outgroup.fasta
        
[Sun Jul  5 23:40:51 2020]
Finished job 2558.
2310 of 3292 steps (70%) done

[Sun Jul  5 23:40:51 2020]
rule get_seqs:
    input: /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ingroup.txt, /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/outgroup.txt
    output: per_gene/EOG091G0ZLQ/EOG091G0ZLQ.ingroup.fasta
    log: per_gene/EOG091G0ZLQ/get_seqs.stdout.txt, per_gene/EOG091G0ZLQ/get_seqs.stderr.txt
    jobid: 3036
    wildcards: BUSCO=EOG091G0ZLQ
    threads: 2


	basedir=$(pwd)
        cd per_gene/EOG091G0ZLQ
        
        bash $basedir/../scripts/fetch_seqs.sh EOG091G0ZLQ /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ingroup.txt /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/outgroup.txt 1> ../../per_gene/EOG091G0ZLQ/get_seqs.stdout.txt 2> ../../per_gene/EOG091G0ZLQ/get_seqs.stderr.txt
	mv EOG091G0ZLQ.fasta $basedir/per_gene/EOG091G0ZLQ/EOG091G0ZLQ.ingroup.fasta
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/72476f9d9a5bd0627b4d721143a21354.simg

[Sun Jul  5 23:40:51 2020]
rule get_outgroups:
    input: per_gene/EOG091G06M8/EOG091G06M8.ingroup.fasta
    output: per_gene/EOG091G06M8/EOG091G06M8.orthodb.fasta, per_gene/EOG091G06M8/EOG091G06M8.outgroup.fasta
    log: per_gene/EOG091G06M8/get_outgroups.stdout.txt, per_gene/EOG091G06M8/get_outgroups.stderr.txt
    jobid: 2559
    wildcards: BUSCO=EOG091G06M8


        #download fastas from Orhtodb for BUSCO id
        for i in {1..5}
        do
             wget "http://www.orthodb.org/fasta?query=EOG091G06M8&level=33208" -O per_gene/EOG091G06M8/EOG091G06M8.orthodb.fasta 1> per_gene/EOG091G06M8/get_outgroups.stdout.txt 2> per_gene/EOG091G06M8/get_outgroups.stderr.txt && break || echo -e "try again ($i)" && sleep 15
        done

	#This is quick an dirty for now and just takes the first protein if there is more than one for an outgroup taxon
        bash ../scripts/download_outgroups.sh taxids.txt per_gene/EOG091G06M8/EOG091G06M8.orthodb.fasta > per_gene/EOG091G06M8/EOG091G06M8.outgroup.fasta
        
[Sun Jul  5 23:40:52 2020]
Finished job 2543.
2311 of 3292 steps (70%) done

[Sun Jul  5 23:40:52 2020]
rule join_groups:
    input: per_gene/EOG091G05KR/EOG091G05KR.ingroup.fasta, per_gene/EOG091G05KR/EOG091G05KR.outgroup.fasta
    output: per_gene/EOG091G05KR/EOG091G05KR.fasta
    jobid: 2095
    wildcards: BUSCO=EOG091G05KR


        cat per_gene/EOG091G05KR/EOG091G05KR.ingroup.fasta per_gene/EOG091G05KR/EOG091G05KR.outgroup.fasta > per_gene/EOG091G05KR/EOG091G05KR.fasta
        
[Sun Jul  5 23:40:52 2020]
Finished job 2095.
2312 of 3292 steps (70%) done
[Sun Jul  5 23:40:53 2020]
Finished job 2559.
2313 of 3292 steps (70%) done

[Sun Jul  5 23:40:53 2020]
rule MSA:
    input: per_gene/EOG091G05KR/EOG091G05KR.fasta
    output: per_gene/EOG091G05KR/EOG091G05KR.clustalo.fasta
    log: per_gene/EOG091G05KR/MSA.stdout.txt, per_gene/EOG091G05KR/MSA.stderr.txt
    jobid: 1310
    wildcards: BUSCO=EOG091G05KR
    threads: 2


        clustalo -i per_gene/EOG091G05KR/EOG091G05KR.fasta -o per_gene/EOG091G05KR/EOG091G05KR.clustalo.fasta --threads=2 1> per_gene/EOG091G05KR/MSA.stdout.txt 2> per_gene/EOG091G05KR/MSA.stderr.txt
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/d68c9691725a7401923680874285c430.simg
[Sun Jul  5 23:40:57 2020]
Finished job 1310.
2314 of 3292 steps (70%) done

[Sun Jul  5 23:40:57 2020]
rule score_and_cut:
    input: per_gene/EOG091G05KR/EOG091G05KR.clustalo.fasta
    output: per_gene/EOG091G05KR/ALICUT_EOG091G05KR.clustalo.fasta
    jobid: 487
    wildcards: BUSCO=EOG091G05KR
    threads: 2


        cd per_gene/EOG091G05KR
        Aliscore.pl -N -r 200000000000000000 -i ../../per_gene/EOG091G05KR/EOG091G05KR.clustalo.fasta &> aliscore.log
        ALICUT.pl -s &> alicut.log
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/63c88c27a0fa300f57066b0ef65fefcb.simg
[Sun Jul  5 23:40:59 2020]
Finished job 3180.
2315 of 3292 steps (70%) done

[Sun Jul  5 23:40:59 2020]
rule join_groups:
    input: per_gene/EOG091G06M8/EOG091G06M8.ingroup.fasta, per_gene/EOG091G06M8/EOG091G06M8.outgroup.fasta
    output: per_gene/EOG091G06M8/EOG091G06M8.fasta
    jobid: 2103
    wildcards: BUSCO=EOG091G06M8


        cat per_gene/EOG091G06M8/EOG091G06M8.ingroup.fasta per_gene/EOG091G06M8/EOG091G06M8.outgroup.fasta > per_gene/EOG091G06M8/EOG091G06M8.fasta
        

[Sun Jul  5 23:40:59 2020]
rule get_outgroups:
    input: per_gene/EOG091G0C7Y/EOG091G0C7Y.ingroup.fasta
    output: per_gene/EOG091G0C7Y/EOG091G0C7Y.orthodb.fasta, per_gene/EOG091G0C7Y/EOG091G0C7Y.outgroup.fasta
    log: per_gene/EOG091G0C7Y/get_outgroups.stdout.txt, per_gene/EOG091G0C7Y/get_outgroups.stderr.txt
    jobid: 3181
    wildcards: BUSCO=EOG091G0C7Y


        #download fastas from Orhtodb for BUSCO id
        for i in {1..5}
        do
             wget "http://www.orthodb.org/fasta?query=EOG091G0C7Y&level=33208" -O per_gene/EOG091G0C7Y/EOG091G0C7Y.orthodb.fasta 1> per_gene/EOG091G0C7Y/get_outgroups.stdout.txt 2> per_gene/EOG091G0C7Y/get_outgroups.stderr.txt && break || echo -e "try again ($i)" && sleep 15
        done

	#This is quick an dirty for now and just takes the first protein if there is more than one for an outgroup taxon
        bash ../scripts/download_outgroups.sh taxids.txt per_gene/EOG091G0C7Y/EOG091G0C7Y.orthodb.fasta > per_gene/EOG091G0C7Y/EOG091G0C7Y.outgroup.fasta
        
[Sun Jul  5 23:40:59 2020]
Finished job 2103.
2316 of 3292 steps (70%) done
[Sun Jul  5 23:41:00 2020]
Finished job 3181.
2317 of 3292 steps (70%) done

[Sun Jul  5 23:41:00 2020]
rule MSA:
    input: per_gene/EOG091G06M8/EOG091G06M8.fasta
    output: per_gene/EOG091G06M8/EOG091G06M8.clustalo.fasta
    log: per_gene/EOG091G06M8/MSA.stdout.txt, per_gene/EOG091G06M8/MSA.stderr.txt
    jobid: 1326
    wildcards: BUSCO=EOG091G06M8
    threads: 2


        clustalo -i per_gene/EOG091G06M8/EOG091G06M8.fasta -o per_gene/EOG091G06M8/EOG091G06M8.clustalo.fasta --threads=2 1> per_gene/EOG091G06M8/MSA.stdout.txt 2> per_gene/EOG091G06M8/MSA.stderr.txt
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/d68c9691725a7401923680874285c430.simg
[Sun Jul  5 23:41:00 2020]
Finished job 3028.
2318 of 3292 steps (70%) done

[Sun Jul  5 23:41:00 2020]
rule join_groups:
    input: per_gene/EOG091G0C7Y/EOG091G0C7Y.ingroup.fasta, per_gene/EOG091G0C7Y/EOG091G0C7Y.outgroup.fasta
    output: per_gene/EOG091G0C7Y/EOG091G0C7Y.fasta
    jobid: 2414
    wildcards: BUSCO=EOG091G0C7Y


        cat per_gene/EOG091G0C7Y/EOG091G0C7Y.ingroup.fasta per_gene/EOG091G0C7Y/EOG091G0C7Y.outgroup.fasta > per_gene/EOG091G0C7Y/EOG091G0C7Y.fasta
        

[Sun Jul  5 23:41:00 2020]
rule get_outgroups:
    input: per_gene/EOG091G0UB5/EOG091G0UB5.ingroup.fasta
    output: per_gene/EOG091G0UB5/EOG091G0UB5.orthodb.fasta, per_gene/EOG091G0UB5/EOG091G0UB5.outgroup.fasta
    log: per_gene/EOG091G0UB5/get_outgroups.stdout.txt, per_gene/EOG091G0UB5/get_outgroups.stderr.txt
    jobid: 3029
    wildcards: BUSCO=EOG091G0UB5


        #download fastas from Orhtodb for BUSCO id
        for i in {1..5}
        do
             wget "http://www.orthodb.org/fasta?query=EOG091G0UB5&level=33208" -O per_gene/EOG091G0UB5/EOG091G0UB5.orthodb.fasta 1> per_gene/EOG091G0UB5/get_outgroups.stdout.txt 2> per_gene/EOG091G0UB5/get_outgroups.stderr.txt && break || echo -e "try again ($i)" && sleep 15
        done

	#This is quick an dirty for now and just takes the first protein if there is more than one for an outgroup taxon
        bash ../scripts/download_outgroups.sh taxids.txt per_gene/EOG091G0UB5/EOG091G0UB5.orthodb.fasta > per_gene/EOG091G0UB5/EOG091G0UB5.outgroup.fasta
        
[Sun Jul  5 23:41:00 2020]
Finished job 2414.
2319 of 3292 steps (70%) done
[Sun Jul  5 23:41:01 2020]
Finished job 3029.
2320 of 3292 steps (70%) done

[Sun Jul  5 23:41:01 2020]
rule MSA:
    input: per_gene/EOG091G0C7Y/EOG091G0C7Y.fasta
    output: per_gene/EOG091G0C7Y/EOG091G0C7Y.clustalo.fasta
    log: per_gene/EOG091G0C7Y/MSA.stdout.txt, per_gene/EOG091G0C7Y/MSA.stderr.txt
    jobid: 1948
    wildcards: BUSCO=EOG091G0C7Y
    threads: 2


        clustalo -i per_gene/EOG091G0C7Y/EOG091G0C7Y.fasta -o per_gene/EOG091G0C7Y/EOG091G0C7Y.clustalo.fasta --threads=2 1> per_gene/EOG091G0C7Y/MSA.stdout.txt 2> per_gene/EOG091G0C7Y/MSA.stderr.txt
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/d68c9691725a7401923680874285c430.simg
[Sun Jul  5 23:41:02 2020]
Finished job 1326.
2321 of 3292 steps (71%) done

[Sun Jul  5 23:41:02 2020]
rule score_and_cut:
    input: per_gene/EOG091G06M8/EOG091G06M8.clustalo.fasta
    output: per_gene/EOG091G06M8/ALICUT_EOG091G06M8.clustalo.fasta
    jobid: 503
    wildcards: BUSCO=EOG091G06M8
    threads: 2


        cd per_gene/EOG091G06M8
        Aliscore.pl -N -r 200000000000000000 -i ../../per_gene/EOG091G06M8/EOG091G06M8.clustalo.fasta &> aliscore.log
        ALICUT.pl -s &> alicut.log
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/63c88c27a0fa300f57066b0ef65fefcb.simg
[Sun Jul  5 23:41:02 2020]
Finished job 144.
2322 of 3292 steps (71%) done

[Sun Jul  5 23:41:02 2020]
rule join_groups:
    input: per_gene/EOG091G0UB5/EOG091G0UB5.ingroup.fasta, per_gene/EOG091G0UB5/EOG091G0UB5.outgroup.fasta
    output: per_gene/EOG091G0UB5/EOG091G0UB5.fasta
    jobid: 2338
    wildcards: BUSCO=EOG091G0UB5


        cat per_gene/EOG091G0UB5/EOG091G0UB5.ingroup.fasta per_gene/EOG091G0UB5/EOG091G0UB5.outgroup.fasta > per_gene/EOG091G0UB5/EOG091G0UB5.fasta
        
[Sun Jul  5 23:41:02 2020]
Finished job 2338.
2323 of 3292 steps (71%) done

[Sun Jul  5 23:41:02 2020]
rule MSA:
    input: per_gene/EOG091G0UB5/EOG091G0UB5.fasta
    output: per_gene/EOG091G0UB5/EOG091G0UB5.clustalo.fasta
    log: per_gene/EOG091G0UB5/MSA.stdout.txt, per_gene/EOG091G0UB5/MSA.stderr.txt
    jobid: 1796
    wildcards: BUSCO=EOG091G0UB5
    threads: 2


        clustalo -i per_gene/EOG091G0UB5/EOG091G0UB5.fasta -o per_gene/EOG091G0UB5/EOG091G0UB5.clustalo.fasta --threads=2 1> per_gene/EOG091G0UB5/MSA.stdout.txt 2> per_gene/EOG091G0UB5/MSA.stderr.txt
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/d68c9691725a7401923680874285c430.simg
[Sun Jul  5 23:41:03 2020]
Finished job 1796.
2324 of 3292 steps (71%) done

[Sun Jul  5 23:41:03 2020]
rule score_and_cut:
    input: per_gene/EOG091G0UB5/EOG091G0UB5.clustalo.fasta
    output: per_gene/EOG091G0UB5/ALICUT_EOG091G0UB5.clustalo.fasta
    jobid: 973
    wildcards: BUSCO=EOG091G0UB5
    threads: 2


        cd per_gene/EOG091G0UB5
        Aliscore.pl -N -r 200000000000000000 -i ../../per_gene/EOG091G0UB5/EOG091G0UB5.clustalo.fasta &> aliscore.log
        ALICUT.pl -s &> alicut.log
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/63c88c27a0fa300f57066b0ef65fefcb.simg
[Sun Jul  5 23:41:03 2020]
Finished job 1948.
2325 of 3292 steps (71%) done

[Sun Jul  5 23:41:03 2020]
rule score_and_cut:
    input: per_gene/EOG091G0C7Y/EOG091G0C7Y.clustalo.fasta
    output: per_gene/EOG091G0C7Y/ALICUT_EOG091G0C7Y.clustalo.fasta
    jobid: 1125
    wildcards: BUSCO=EOG091G0C7Y
    threads: 2


        cd per_gene/EOG091G0C7Y
        Aliscore.pl -N -r 200000000000000000 -i ../../per_gene/EOG091G0C7Y/EOG091G0C7Y.clustalo.fasta &> aliscore.log
        ALICUT.pl -s &> alicut.log
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/63c88c27a0fa300f57066b0ef65fefcb.simg
[Sun Jul  5 23:41:03 2020]
Finished job 3036.
2326 of 3292 steps (71%) done

[Sun Jul  5 23:41:03 2020]
rule get_outgroups:
    input: per_gene/EOG091G0ZLQ/EOG091G0ZLQ.ingroup.fasta
    output: per_gene/EOG091G0ZLQ/EOG091G0ZLQ.orthodb.fasta, per_gene/EOG091G0ZLQ/EOG091G0ZLQ.outgroup.fasta
    log: per_gene/EOG091G0ZLQ/get_outgroups.stdout.txt, per_gene/EOG091G0ZLQ/get_outgroups.stderr.txt
    jobid: 3037
    wildcards: BUSCO=EOG091G0ZLQ


        #download fastas from Orhtodb for BUSCO id
        for i in {1..5}
        do
             wget "http://www.orthodb.org/fasta?query=EOG091G0ZLQ&level=33208" -O per_gene/EOG091G0ZLQ/EOG091G0ZLQ.orthodb.fasta 1> per_gene/EOG091G0ZLQ/get_outgroups.stdout.txt 2> per_gene/EOG091G0ZLQ/get_outgroups.stderr.txt && break || echo -e "try again ($i)" && sleep 15
        done

	#This is quick an dirty for now and just takes the first protein if there is more than one for an outgroup taxon
        bash ../scripts/download_outgroups.sh taxids.txt per_gene/EOG091G0ZLQ/EOG091G0ZLQ.orthodb.fasta > per_gene/EOG091G0ZLQ/EOG091G0ZLQ.outgroup.fasta
        
[Sun Jul  5 23:41:04 2020]
Finished job 3037.
2327 of 3292 steps (71%) done

[Sun Jul  5 23:41:04 2020]
rule join_groups:
    input: per_gene/EOG091G0ZLQ/EOG091G0ZLQ.ingroup.fasta, per_gene/EOG091G0ZLQ/EOG091G0ZLQ.outgroup.fasta
    output: per_gene/EOG091G0ZLQ/EOG091G0ZLQ.fasta
    jobid: 2342
    wildcards: BUSCO=EOG091G0ZLQ


        cat per_gene/EOG091G0ZLQ/EOG091G0ZLQ.ingroup.fasta per_gene/EOG091G0ZLQ/EOG091G0ZLQ.outgroup.fasta > per_gene/EOG091G0ZLQ/EOG091G0ZLQ.fasta
        
[Sun Jul  5 23:41:04 2020]
Finished job 2342.
2328 of 3292 steps (71%) done

[Sun Jul  5 23:41:04 2020]
rule MSA:
    input: per_gene/EOG091G0ZLQ/EOG091G0ZLQ.fasta
    output: per_gene/EOG091G0ZLQ/EOG091G0ZLQ.clustalo.fasta
    log: per_gene/EOG091G0ZLQ/MSA.stdout.txt, per_gene/EOG091G0ZLQ/MSA.stderr.txt
    jobid: 1804
    wildcards: BUSCO=EOG091G0ZLQ
    threads: 2


        clustalo -i per_gene/EOG091G0ZLQ/EOG091G0ZLQ.fasta -o per_gene/EOG091G0ZLQ/EOG091G0ZLQ.clustalo.fasta --threads=2 1> per_gene/EOG091G0ZLQ/MSA.stdout.txt 2> per_gene/EOG091G0ZLQ/MSA.stderr.txt
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/d68c9691725a7401923680874285c430.simg
[Sun Jul  5 23:41:06 2020]
Finished job 1804.
2329 of 3292 steps (71%) done

[Sun Jul  5 23:41:06 2020]
rule score_and_cut:
    input: per_gene/EOG091G0ZLQ/EOG091G0ZLQ.clustalo.fasta
    output: per_gene/EOG091G0ZLQ/ALICUT_EOG091G0ZLQ.clustalo.fasta
    jobid: 981
    wildcards: BUSCO=EOG091G0ZLQ
    threads: 2


        cd per_gene/EOG091G0ZLQ
        Aliscore.pl -N -r 200000000000000000 -i ../../per_gene/EOG091G0ZLQ/EOG091G0ZLQ.clustalo.fasta &> aliscore.log
        ALICUT.pl -s &> alicut.log
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/63c88c27a0fa300f57066b0ef65fefcb.simg
[Sun Jul  5 23:41:12 2020]
Finished job 503.
2330 of 3292 steps (71%) done

[Sun Jul  5 23:41:12 2020]
rule remove_empty:
    input: per_gene/EOG091G06M8/ALICUT_EOG091G06M8.clustalo.fasta
    output: per_gene/EOG091G06M8/empty_check.done
    jobid: 1325
    wildcards: BUSCO=EOG091G06M8


         if [ "$(cat per_gene/EOG091G06M8/ALICUT_EOG091G06M8.clustalo.fasta | grep -v ">" | sed 's/-//g' | grep "^$" | wc -l)" -gt 0 ]
         then
              cp per_gene/EOG091G06M8/ALICUT_EOG091G06M8.clustalo.fasta per_gene/EOG091G06M8/ALICUT_EOG091G06M8.clustalo.fasta.backup
              bash ../scripts/remove_empty.sh per_gene/EOG091G06M8/ALICUT_EOG091G06M8.clustalo.fasta.backup > per_gene/EOG091G06M8/ALICUT_EOG091G06M8.clustalo.fasta
         fi
         touch per_gene/EOG091G06M8/empty_check.done
         
[Sun Jul  5 23:41:13 2020]
Finished job 1325.
2331 of 3292 steps (71%) done

[Sun Jul  5 23:41:13 2020]
rule find_best_model:
    input: per_gene/EOG091G06M8/ALICUT_EOG091G06M8.clustalo.fasta, per_gene/EOG091G06M8/empty_check.done
    output: per_gene/EOG091G06M8/EOG091G06M8.best_model
    log: per_gene/EOG091G06M8/find_best_model.stderr.txt
    jobid: 502
    wildcards: BUSCO=EOG091G06M8
    threads: 2


        cd per_gene/EOG091G06M8
        if [ ! -d find_best_model ]
        then
            mkdir find_best_model
        fi
        cd find_best_model
        ln -s ../../../per_gene/EOG091G06M8/ALICUT_EOG091G06M8.clustalo.fasta EOG091G06M8.fasta
        ProteinModelSelection.pl EOG091G06M8.fasta 1> ../../../per_gene/EOG091G06M8/EOG091G06M8.best_model 2> ../../../per_gene/EOG091G06M8/find_best_model.stderr.txt
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/c0c09ee657b1e27f2c5687e0e9aa8d70.simg
[Sun Jul  5 23:41:14 2020]
Finished job 487.
2332 of 3292 steps (71%) done

[Sun Jul  5 23:41:14 2020]
rule remove_empty:
    input: per_gene/EOG091G05KR/ALICUT_EOG091G05KR.clustalo.fasta
    output: per_gene/EOG091G05KR/empty_check.done
    jobid: 1309
    wildcards: BUSCO=EOG091G05KR


         if [ "$(cat per_gene/EOG091G05KR/ALICUT_EOG091G05KR.clustalo.fasta | grep -v ">" | sed 's/-//g' | grep "^$" | wc -l)" -gt 0 ]
         then
              cp per_gene/EOG091G05KR/ALICUT_EOG091G05KR.clustalo.fasta per_gene/EOG091G05KR/ALICUT_EOG091G05KR.clustalo.fasta.backup
              bash ../scripts/remove_empty.sh per_gene/EOG091G05KR/ALICUT_EOG091G05KR.clustalo.fasta.backup > per_gene/EOG091G05KR/ALICUT_EOG091G05KR.clustalo.fasta
         fi
         touch per_gene/EOG091G05KR/empty_check.done
         
[Sun Jul  5 23:41:14 2020]
Finished job 1309.
2333 of 3292 steps (71%) done

[Sun Jul  5 23:41:14 2020]
rule find_best_model:
    input: per_gene/EOG091G05KR/ALICUT_EOG091G05KR.clustalo.fasta, per_gene/EOG091G05KR/empty_check.done
    output: per_gene/EOG091G05KR/EOG091G05KR.best_model
    log: per_gene/EOG091G05KR/find_best_model.stderr.txt
    jobid: 486
    wildcards: BUSCO=EOG091G05KR
    threads: 2


        cd per_gene/EOG091G05KR
        if [ ! -d find_best_model ]
        then
            mkdir find_best_model
        fi
        cd find_best_model
        ln -s ../../../per_gene/EOG091G05KR/ALICUT_EOG091G05KR.clustalo.fasta EOG091G05KR.fasta
        ProteinModelSelection.pl EOG091G05KR.fasta 1> ../../../per_gene/EOG091G05KR/EOG091G05KR.best_model 2> ../../../per_gene/EOG091G05KR/find_best_model.stderr.txt
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/c0c09ee657b1e27f2c5687e0e9aa8d70.simg
[Sun Jul  5 23:41:15 2020]
Finished job 973.
2334 of 3292 steps (71%) done

[Sun Jul  5 23:41:15 2020]
rule remove_empty:
    input: per_gene/EOG091G0UB5/ALICUT_EOG091G0UB5.clustalo.fasta
    output: per_gene/EOG091G0UB5/empty_check.done
    jobid: 1795
    wildcards: BUSCO=EOG091G0UB5


         if [ "$(cat per_gene/EOG091G0UB5/ALICUT_EOG091G0UB5.clustalo.fasta | grep -v ">" | sed 's/-//g' | grep "^$" | wc -l)" -gt 0 ]
         then
              cp per_gene/EOG091G0UB5/ALICUT_EOG091G0UB5.clustalo.fasta per_gene/EOG091G0UB5/ALICUT_EOG091G0UB5.clustalo.fasta.backup
              bash ../scripts/remove_empty.sh per_gene/EOG091G0UB5/ALICUT_EOG091G0UB5.clustalo.fasta.backup > per_gene/EOG091G0UB5/ALICUT_EOG091G0UB5.clustalo.fasta
         fi
         touch per_gene/EOG091G0UB5/empty_check.done
         
[Sun Jul  5 23:41:15 2020]
Finished job 1795.
2335 of 3292 steps (71%) done

[Sun Jul  5 23:41:15 2020]
rule find_best_model:
    input: per_gene/EOG091G0UB5/ALICUT_EOG091G0UB5.clustalo.fasta, per_gene/EOG091G0UB5/empty_check.done
    output: per_gene/EOG091G0UB5/EOG091G0UB5.best_model
    log: per_gene/EOG091G0UB5/find_best_model.stderr.txt
    jobid: 972
    wildcards: BUSCO=EOG091G0UB5
    threads: 2


        cd per_gene/EOG091G0UB5
        if [ ! -d find_best_model ]
        then
            mkdir find_best_model
        fi
        cd find_best_model
        ln -s ../../../per_gene/EOG091G0UB5/ALICUT_EOG091G0UB5.clustalo.fasta EOG091G0UB5.fasta
        ProteinModelSelection.pl EOG091G0UB5.fasta 1> ../../../per_gene/EOG091G0UB5/EOG091G0UB5.best_model 2> ../../../per_gene/EOG091G0UB5/find_best_model.stderr.txt
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/c0c09ee657b1e27f2c5687e0e9aa8d70.simg
[Sun Jul  5 23:41:15 2020]
Finished job 1125.
2336 of 3292 steps (71%) done

[Sun Jul  5 23:41:15 2020]
rule remove_empty:
    input: per_gene/EOG091G0C7Y/ALICUT_EOG091G0C7Y.clustalo.fasta
    output: per_gene/EOG091G0C7Y/empty_check.done
    jobid: 1947
    wildcards: BUSCO=EOG091G0C7Y


         if [ "$(cat per_gene/EOG091G0C7Y/ALICUT_EOG091G0C7Y.clustalo.fasta | grep -v ">" | sed 's/-//g' | grep "^$" | wc -l)" -gt 0 ]
         then
              cp per_gene/EOG091G0C7Y/ALICUT_EOG091G0C7Y.clustalo.fasta per_gene/EOG091G0C7Y/ALICUT_EOG091G0C7Y.clustalo.fasta.backup
              bash ../scripts/remove_empty.sh per_gene/EOG091G0C7Y/ALICUT_EOG091G0C7Y.clustalo.fasta.backup > per_gene/EOG091G0C7Y/ALICUT_EOG091G0C7Y.clustalo.fasta
         fi
         touch per_gene/EOG091G0C7Y/empty_check.done
         
[Sun Jul  5 23:41:15 2020]
Finished job 1947.
2337 of 3292 steps (71%) done

[Sun Jul  5 23:41:15 2020]
rule find_best_model:
    input: per_gene/EOG091G0C7Y/ALICUT_EOG091G0C7Y.clustalo.fasta, per_gene/EOG091G0C7Y/empty_check.done
    output: per_gene/EOG091G0C7Y/EOG091G0C7Y.best_model
    log: per_gene/EOG091G0C7Y/find_best_model.stderr.txt
    jobid: 1124
    wildcards: BUSCO=EOG091G0C7Y
    threads: 2


        cd per_gene/EOG091G0C7Y
        if [ ! -d find_best_model ]
        then
            mkdir find_best_model
        fi
        cd find_best_model
        ln -s ../../../per_gene/EOG091G0C7Y/ALICUT_EOG091G0C7Y.clustalo.fasta EOG091G0C7Y.fasta
        ProteinModelSelection.pl EOG091G0C7Y.fasta 1> ../../../per_gene/EOG091G0C7Y/EOG091G0C7Y.best_model 2> ../../../per_gene/EOG091G0C7Y/find_best_model.stderr.txt
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/c0c09ee657b1e27f2c5687e0e9aa8d70.simg
[Sun Jul  5 23:41:16 2020]
Finished job 981.
2338 of 3292 steps (71%) done

[Sun Jul  5 23:41:16 2020]
rule remove_empty:
    input: per_gene/EOG091G0ZLQ/ALICUT_EOG091G0ZLQ.clustalo.fasta
    output: per_gene/EOG091G0ZLQ/empty_check.done
    jobid: 1803
    wildcards: BUSCO=EOG091G0ZLQ


         if [ "$(cat per_gene/EOG091G0ZLQ/ALICUT_EOG091G0ZLQ.clustalo.fasta | grep -v ">" | sed 's/-//g' | grep "^$" | wc -l)" -gt 0 ]
         then
              cp per_gene/EOG091G0ZLQ/ALICUT_EOG091G0ZLQ.clustalo.fasta per_gene/EOG091G0ZLQ/ALICUT_EOG091G0ZLQ.clustalo.fasta.backup
              bash ../scripts/remove_empty.sh per_gene/EOG091G0ZLQ/ALICUT_EOG091G0ZLQ.clustalo.fasta.backup > per_gene/EOG091G0ZLQ/ALICUT_EOG091G0ZLQ.clustalo.fasta
         fi
         touch per_gene/EOG091G0ZLQ/empty_check.done
         
[Sun Jul  5 23:41:16 2020]
Finished job 1803.
2339 of 3292 steps (71%) done

[Sun Jul  5 23:41:16 2020]
rule find_best_model:
    input: per_gene/EOG091G0ZLQ/ALICUT_EOG091G0ZLQ.clustalo.fasta, per_gene/EOG091G0ZLQ/empty_check.done
    output: per_gene/EOG091G0ZLQ/EOG091G0ZLQ.best_model
    log: per_gene/EOG091G0ZLQ/find_best_model.stderr.txt
    jobid: 980
    wildcards: BUSCO=EOG091G0ZLQ
    threads: 2


        cd per_gene/EOG091G0ZLQ
        if [ ! -d find_best_model ]
        then
            mkdir find_best_model
        fi
        cd find_best_model
        ln -s ../../../per_gene/EOG091G0ZLQ/ALICUT_EOG091G0ZLQ.clustalo.fasta EOG091G0ZLQ.fasta
        ProteinModelSelection.pl EOG091G0ZLQ.fasta 1> ../../../per_gene/EOG091G0ZLQ/EOG091G0ZLQ.best_model 2> ../../../per_gene/EOG091G0ZLQ/find_best_model.stderr.txt
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/c0c09ee657b1e27f2c5687e0e9aa8d70.simg
[Sun Jul  5 23:41:27 2020]
Finished job 70.
2340 of 3292 steps (71%) done

[Sun Jul  5 23:41:27 2020]
rule get_seqs:
    input: /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ingroup.txt, /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/outgroup.txt
    output: per_gene/EOG091G19WY/EOG091G19WY.ingroup.fasta
    log: per_gene/EOG091G19WY/get_seqs.stdout.txt, per_gene/EOG091G19WY/get_seqs.stderr.txt
    jobid: 3106
    wildcards: BUSCO=EOG091G19WY
    threads: 2


	basedir=$(pwd)
        cd per_gene/EOG091G19WY
        
        bash $basedir/../scripts/fetch_seqs.sh EOG091G19WY /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ingroup.txt /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/outgroup.txt 1> ../../per_gene/EOG091G19WY/get_seqs.stdout.txt 2> ../../per_gene/EOG091G19WY/get_seqs.stderr.txt
	mv EOG091G19WY.fasta $basedir/per_gene/EOG091G19WY/EOG091G19WY.ingroup.fasta
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/72476f9d9a5bd0627b4d721143a21354.simg
[Sun Jul  5 23:41:38 2020]
Finished job 980.
2341 of 3292 steps (71%) done

[Sun Jul  5 23:41:38 2020]
rule infer_single_ML:
    input: per_gene/EOG091G0ZLQ/EOG091G0ZLQ.best_model, per_gene/EOG091G0ZLQ/ALICUT_EOG091G0ZLQ.clustalo.fasta
    output: per_gene/EOG091G0ZLQ/EOG091G0ZLQ.raxml.done
    log: per_gene/EOG091G0ZLQ/infer_single_ML.stdout.txt, per_gene/EOG091G0ZLQ/infer_single_ML.stderr.txt
    jobid: 284
    wildcards: BUSCO=EOG091G0ZLQ
    threads: 2


        cd per_gene/EOG091G0ZLQ
	count=$(cat ../../per_gene/EOG091G0ZLQ/ALICUT_EOG091G0ZLQ.clustalo.fasta | grep ">" | wc -l)
	if [ "$count" -gt 5 ]
        then
		RAxMLmodel=$(cat ../../per_gene/EOG091G0ZLQ/EOG091G0ZLQ.best_model | grep "Best" | cut -d ":" -f 2 | tr -d '[:space:]')
                if [ "$(ls -1 | grep "^RAxML" | wc -l)" -ne 0 ]
		then
			rm RAxML*
		fi
        	raxml -f a -T 2 -m PROTGAMMA$RAxMLmodel         	-p 12345 -x 12345 -# 100         	-s ../../per_gene/EOG091G0ZLQ/ALICUT_EOG091G0ZLQ.clustalo.fasta -n EOG091G0ZLQ.clustalo.aln.ALICUT.$RAxMLmodel 		1> ../../per_gene/EOG091G0ZLQ/infer_single_ML.stdout.txt 2> ../../per_gene/EOG091G0ZLQ/infer_single_ML.stderr.txt
	else
		echo "fasta file per_gene/EOG091G0ZLQ/ALICUT_EOG091G0ZLQ.clustalo.fasta contains fewer than 5 sequences - skipped" > ../../per_gene/EOG091G0ZLQ/infer_single_ML.stdout.txt
		touch raxml.skipped
	fi
        touch ../../per_gene/EOG091G0ZLQ/EOG091G0ZLQ.raxml.done
        
[Sun Jul  5 23:41:40 2020]
Finished job 3106.
2342 of 3292 steps (71%) done

[Sun Jul  5 23:41:40 2020]
rule get_outgroups:
    input: per_gene/EOG091G19WY/EOG091G19WY.ingroup.fasta
    output: per_gene/EOG091G19WY/EOG091G19WY.orthodb.fasta, per_gene/EOG091G19WY/EOG091G19WY.outgroup.fasta
    log: per_gene/EOG091G19WY/get_outgroups.stdout.txt, per_gene/EOG091G19WY/get_outgroups.stderr.txt
    jobid: 3107
    wildcards: BUSCO=EOG091G19WY


        #download fastas from Orhtodb for BUSCO id
        for i in {1..5}
        do
             wget "http://www.orthodb.org/fasta?query=EOG091G19WY&level=33208" -O per_gene/EOG091G19WY/EOG091G19WY.orthodb.fasta 1> per_gene/EOG091G19WY/get_outgroups.stdout.txt 2> per_gene/EOG091G19WY/get_outgroups.stderr.txt && break || echo -e "try again ($i)" && sleep 15
        done

	#This is quick an dirty for now and just takes the first protein if there is more than one for an outgroup taxon
        bash ../scripts/download_outgroups.sh taxids.txt per_gene/EOG091G19WY/EOG091G19WY.orthodb.fasta > per_gene/EOG091G19WY/EOG091G19WY.outgroup.fasta
        
[33mJob counts:
	count	jobs
	1	infer_single_ML
	1[0m
[33m
        cd per_gene/EOG091G0ZLQ
	count=$(cat ../../per_gene/EOG091G0ZLQ/ALICUT_EOG091G0ZLQ.clustalo.fasta | grep ">" | wc -l)
	if [ "$count" -gt 5 ]
        then
		RAxMLmodel=$(cat ../../per_gene/EOG091G0ZLQ/EOG091G0ZLQ.best_model | grep "Best" | cut -d ":" -f 2 | tr -d '[:space:]')
                if [ "$(ls -1 | grep "^RAxML" | wc -l)" -ne 0 ]
		then
			rm RAxML*
		fi
        	raxml -f a -T 2 -m PROTGAMMA$RAxMLmodel         	-p 12345 -x 12345 -# 100         	-s ../../per_gene/EOG091G0ZLQ/ALICUT_EOG091G0ZLQ.clustalo.fasta -n EOG091G0ZLQ.clustalo.aln.ALICUT.$RAxMLmodel 		1> ../../per_gene/EOG091G0ZLQ/infer_single_ML.stdout.txt 2> ../../per_gene/EOG091G0ZLQ/infer_single_ML.stderr.txt
	else
		echo "fasta file per_gene/EOG091G0ZLQ/ALICUT_EOG091G0ZLQ.clustalo.fasta contains fewer than 5 sequences - skipped" > ../../per_gene/EOG091G0ZLQ/infer_single_ML.stdout.txt
		touch raxml.skipped
	fi
        touch ../../per_gene/EOG091G0ZLQ/EOG091G0ZLQ.raxml.done
        [0m
[Sun Jul  5 23:41:41 2020]
Finished job 972.
2343 of 3292 steps (71%) done

[Sun Jul  5 23:41:41 2020]
rule infer_single_ML:
    input: per_gene/EOG091G0UB5/EOG091G0UB5.best_model, per_gene/EOG091G0UB5/ALICUT_EOG091G0UB5.clustalo.fasta
    output: per_gene/EOG091G0UB5/EOG091G0UB5.raxml.done
    log: per_gene/EOG091G0UB5/infer_single_ML.stdout.txt, per_gene/EOG091G0UB5/infer_single_ML.stderr.txt
    jobid: 280
    wildcards: BUSCO=EOG091G0UB5
    threads: 2


        cd per_gene/EOG091G0UB5
	count=$(cat ../../per_gene/EOG091G0UB5/ALICUT_EOG091G0UB5.clustalo.fasta | grep ">" | wc -l)
	if [ "$count" -gt 5 ]
        then
		RAxMLmodel=$(cat ../../per_gene/EOG091G0UB5/EOG091G0UB5.best_model | grep "Best" | cut -d ":" -f 2 | tr -d '[:space:]')
                if [ "$(ls -1 | grep "^RAxML" | wc -l)" -ne 0 ]
		then
			rm RAxML*
		fi
        	raxml -f a -T 2 -m PROTGAMMA$RAxMLmodel         	-p 12345 -x 12345 -# 100         	-s ../../per_gene/EOG091G0UB5/ALICUT_EOG091G0UB5.clustalo.fasta -n EOG091G0UB5.clustalo.aln.ALICUT.$RAxMLmodel 		1> ../../per_gene/EOG091G0UB5/infer_single_ML.stdout.txt 2> ../../per_gene/EOG091G0UB5/infer_single_ML.stderr.txt
	else
		echo "fasta file per_gene/EOG091G0UB5/ALICUT_EOG091G0UB5.clustalo.fasta contains fewer than 5 sequences - skipped" > ../../per_gene/EOG091G0UB5/infer_single_ML.stdout.txt
		touch raxml.skipped
	fi
        touch ../../per_gene/EOG091G0UB5/EOG091G0UB5.raxml.done
        
[Sun Jul  5 23:41:41 2020]
Finished job 3107.
2344 of 3292 steps (71%) done

[Sun Jul  5 23:41:41 2020]
rule join_groups:
    input: per_gene/EOG091G19WY/EOG091G19WY.ingroup.fasta, per_gene/EOG091G19WY/EOG091G19WY.outgroup.fasta
    output: per_gene/EOG091G19WY/EOG091G19WY.fasta
    jobid: 2377
    wildcards: BUSCO=EOG091G19WY


        cat per_gene/EOG091G19WY/EOG091G19WY.ingroup.fasta per_gene/EOG091G19WY/EOG091G19WY.outgroup.fasta > per_gene/EOG091G19WY/EOG091G19WY.fasta
        
[Sun Jul  5 23:41:41 2020]
Finished job 2377.
2345 of 3292 steps (71%) done

[Sun Jul  5 23:41:41 2020]
rule MSA:
    input: per_gene/EOG091G19WY/EOG091G19WY.fasta
    output: per_gene/EOG091G19WY/EOG091G19WY.clustalo.fasta
    log: per_gene/EOG091G19WY/MSA.stdout.txt, per_gene/EOG091G19WY/MSA.stderr.txt
    jobid: 1874
    wildcards: BUSCO=EOG091G19WY
    threads: 2


        clustalo -i per_gene/EOG091G19WY/EOG091G19WY.fasta -o per_gene/EOG091G19WY/EOG091G19WY.clustalo.fasta --threads=2 1> per_gene/EOG091G19WY/MSA.stdout.txt 2> per_gene/EOG091G19WY/MSA.stderr.txt
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/d68c9691725a7401923680874285c430.simg
[33mJob counts:
	count	jobs
	1	infer_single_ML
	1[0m
[33m
        cd per_gene/EOG091G0UB5
	count=$(cat ../../per_gene/EOG091G0UB5/ALICUT_EOG091G0UB5.clustalo.fasta | grep ">" | wc -l)
	if [ "$count" -gt 5 ]
        then
		RAxMLmodel=$(cat ../../per_gene/EOG091G0UB5/EOG091G0UB5.best_model | grep "Best" | cut -d ":" -f 2 | tr -d '[:space:]')
                if [ "$(ls -1 | grep "^RAxML" | wc -l)" -ne 0 ]
		then
			rm RAxML*
		fi
        	raxml -f a -T 2 -m PROTGAMMA$RAxMLmodel         	-p 12345 -x 12345 -# 100         	-s ../../per_gene/EOG091G0UB5/ALICUT_EOG091G0UB5.clustalo.fasta -n EOG091G0UB5.clustalo.aln.ALICUT.$RAxMLmodel 		1> ../../per_gene/EOG091G0UB5/infer_single_ML.stdout.txt 2> ../../per_gene/EOG091G0UB5/infer_single_ML.stderr.txt
	else
		echo "fasta file per_gene/EOG091G0UB5/ALICUT_EOG091G0UB5.clustalo.fasta contains fewer than 5 sequences - skipped" > ../../per_gene/EOG091G0UB5/infer_single_ML.stdout.txt
		touch raxml.skipped
	fi
        touch ../../per_gene/EOG091G0UB5/EOG091G0UB5.raxml.done
        [0m
[Sun Jul  5 23:41:42 2020]
Finished job 1874.
2346 of 3292 steps (71%) done

[Sun Jul  5 23:41:42 2020]
rule score_and_cut:
    input: per_gene/EOG091G19WY/EOG091G19WY.clustalo.fasta
    output: per_gene/EOG091G19WY/ALICUT_EOG091G19WY.clustalo.fasta
    jobid: 1051
    wildcards: BUSCO=EOG091G19WY
    threads: 2


        cd per_gene/EOG091G19WY
        Aliscore.pl -N -r 200000000000000000 -i ../../per_gene/EOG091G19WY/EOG091G19WY.clustalo.fasta &> aliscore.log
        ALICUT.pl -s &> alicut.log
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/63c88c27a0fa300f57066b0ef65fefcb.simg
[Sun Jul  5 23:41:45 2020]
Finished job 1124.
2347 of 3292 steps (71%) done

[Sun Jul  5 23:41:45 2020]
rule infer_single_ML:
    input: per_gene/EOG091G0C7Y/EOG091G0C7Y.best_model, per_gene/EOG091G0C7Y/ALICUT_EOG091G0C7Y.clustalo.fasta
    output: per_gene/EOG091G0C7Y/EOG091G0C7Y.raxml.done
    log: per_gene/EOG091G0C7Y/infer_single_ML.stdout.txt, per_gene/EOG091G0C7Y/infer_single_ML.stderr.txt
    jobid: 356
    wildcards: BUSCO=EOG091G0C7Y
    threads: 2


        cd per_gene/EOG091G0C7Y
	count=$(cat ../../per_gene/EOG091G0C7Y/ALICUT_EOG091G0C7Y.clustalo.fasta | grep ">" | wc -l)
	if [ "$count" -gt 5 ]
        then
		RAxMLmodel=$(cat ../../per_gene/EOG091G0C7Y/EOG091G0C7Y.best_model | grep "Best" | cut -d ":" -f 2 | tr -d '[:space:]')
                if [ "$(ls -1 | grep "^RAxML" | wc -l)" -ne 0 ]
		then
			rm RAxML*
		fi
        	raxml -f a -T 2 -m PROTGAMMA$RAxMLmodel         	-p 12345 -x 12345 -# 100         	-s ../../per_gene/EOG091G0C7Y/ALICUT_EOG091G0C7Y.clustalo.fasta -n EOG091G0C7Y.clustalo.aln.ALICUT.$RAxMLmodel 		1> ../../per_gene/EOG091G0C7Y/infer_single_ML.stdout.txt 2> ../../per_gene/EOG091G0C7Y/infer_single_ML.stderr.txt
	else
		echo "fasta file per_gene/EOG091G0C7Y/ALICUT_EOG091G0C7Y.clustalo.fasta contains fewer than 5 sequences - skipped" > ../../per_gene/EOG091G0C7Y/infer_single_ML.stdout.txt
		touch raxml.skipped
	fi
        touch ../../per_gene/EOG091G0C7Y/EOG091G0C7Y.raxml.done
        
[33mJob counts:
	count	jobs
	1	infer_single_ML
	1[0m
[33m
        cd per_gene/EOG091G0C7Y
	count=$(cat ../../per_gene/EOG091G0C7Y/ALICUT_EOG091G0C7Y.clustalo.fasta | grep ">" | wc -l)
	if [ "$count" -gt 5 ]
        then
		RAxMLmodel=$(cat ../../per_gene/EOG091G0C7Y/EOG091G0C7Y.best_model | grep "Best" | cut -d ":" -f 2 | tr -d '[:space:]')
                if [ "$(ls -1 | grep "^RAxML" | wc -l)" -ne 0 ]
		then
			rm RAxML*
		fi
        	raxml -f a -T 2 -m PROTGAMMA$RAxMLmodel         	-p 12345 -x 12345 -# 100         	-s ../../per_gene/EOG091G0C7Y/ALICUT_EOG091G0C7Y.clustalo.fasta -n EOG091G0C7Y.clustalo.aln.ALICUT.$RAxMLmodel 		1> ../../per_gene/EOG091G0C7Y/infer_single_ML.stdout.txt 2> ../../per_gene/EOG091G0C7Y/infer_single_ML.stderr.txt
	else
		echo "fasta file per_gene/EOG091G0C7Y/ALICUT_EOG091G0C7Y.clustalo.fasta contains fewer than 5 sequences - skipped" > ../../per_gene/EOG091G0C7Y/infer_single_ML.stdout.txt
		touch raxml.skipped
	fi
        touch ../../per_gene/EOG091G0C7Y/EOG091G0C7Y.raxml.done
        [0m
[Sun Jul  5 23:41:51 2020]
Finished job 1051.
2348 of 3292 steps (71%) done

[Sun Jul  5 23:41:51 2020]
rule remove_empty:
    input: per_gene/EOG091G19WY/ALICUT_EOG091G19WY.clustalo.fasta
    output: per_gene/EOG091G19WY/empty_check.done
    jobid: 1873
    wildcards: BUSCO=EOG091G19WY


         if [ "$(cat per_gene/EOG091G19WY/ALICUT_EOG091G19WY.clustalo.fasta | grep -v ">" | sed 's/-//g' | grep "^$" | wc -l)" -gt 0 ]
         then
              cp per_gene/EOG091G19WY/ALICUT_EOG091G19WY.clustalo.fasta per_gene/EOG091G19WY/ALICUT_EOG091G19WY.clustalo.fasta.backup
              bash ../scripts/remove_empty.sh per_gene/EOG091G19WY/ALICUT_EOG091G19WY.clustalo.fasta.backup > per_gene/EOG091G19WY/ALICUT_EOG091G19WY.clustalo.fasta
         fi
         touch per_gene/EOG091G19WY/empty_check.done
         
[Sun Jul  5 23:41:51 2020]
Finished job 1873.
2349 of 3292 steps (71%) done

[Sun Jul  5 23:41:51 2020]
rule find_best_model:
    input: per_gene/EOG091G19WY/ALICUT_EOG091G19WY.clustalo.fasta, per_gene/EOG091G19WY/empty_check.done
    output: per_gene/EOG091G19WY/EOG091G19WY.best_model
    log: per_gene/EOG091G19WY/find_best_model.stderr.txt
    jobid: 1050
    wildcards: BUSCO=EOG091G19WY
    threads: 2


        cd per_gene/EOG091G19WY
        if [ ! -d find_best_model ]
        then
            mkdir find_best_model
        fi
        cd find_best_model
        ln -s ../../../per_gene/EOG091G19WY/ALICUT_EOG091G19WY.clustalo.fasta EOG091G19WY.fasta
        ProteinModelSelection.pl EOG091G19WY.fasta 1> ../../../per_gene/EOG091G19WY/EOG091G19WY.best_model 2> ../../../per_gene/EOG091G19WY/find_best_model.stderr.txt
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/c0c09ee657b1e27f2c5687e0e9aa8d70.simg
[Sun Jul  5 23:41:58 2020]
Finished job 502.
2350 of 3292 steps (71%) done

[Sun Jul  5 23:41:58 2020]
rule infer_single_ML:
    input: per_gene/EOG091G06M8/EOG091G06M8.best_model, per_gene/EOG091G06M8/ALICUT_EOG091G06M8.clustalo.fasta
    output: per_gene/EOG091G06M8/EOG091G06M8.raxml.done
    log: per_gene/EOG091G06M8/infer_single_ML.stdout.txt, per_gene/EOG091G06M8/infer_single_ML.stderr.txt
    jobid: 45
    wildcards: BUSCO=EOG091G06M8
    threads: 2


        cd per_gene/EOG091G06M8
	count=$(cat ../../per_gene/EOG091G06M8/ALICUT_EOG091G06M8.clustalo.fasta | grep ">" | wc -l)
	if [ "$count" -gt 5 ]
        then
		RAxMLmodel=$(cat ../../per_gene/EOG091G06M8/EOG091G06M8.best_model | grep "Best" | cut -d ":" -f 2 | tr -d '[:space:]')
                if [ "$(ls -1 | grep "^RAxML" | wc -l)" -ne 0 ]
		then
			rm RAxML*
		fi
        	raxml -f a -T 2 -m PROTGAMMA$RAxMLmodel         	-p 12345 -x 12345 -# 100         	-s ../../per_gene/EOG091G06M8/ALICUT_EOG091G06M8.clustalo.fasta -n EOG091G06M8.clustalo.aln.ALICUT.$RAxMLmodel 		1> ../../per_gene/EOG091G06M8/infer_single_ML.stdout.txt 2> ../../per_gene/EOG091G06M8/infer_single_ML.stderr.txt
	else
		echo "fasta file per_gene/EOG091G06M8/ALICUT_EOG091G06M8.clustalo.fasta contains fewer than 5 sequences - skipped" > ../../per_gene/EOG091G06M8/infer_single_ML.stdout.txt
		touch raxml.skipped
	fi
        touch ../../per_gene/EOG091G06M8/EOG091G06M8.raxml.done
        
[33mJob counts:
	count	jobs
	1	infer_single_ML
	1[0m
[33m
        cd per_gene/EOG091G06M8
	count=$(cat ../../per_gene/EOG091G06M8/ALICUT_EOG091G06M8.clustalo.fasta | grep ">" | wc -l)
	if [ "$count" -gt 5 ]
        then
		RAxMLmodel=$(cat ../../per_gene/EOG091G06M8/EOG091G06M8.best_model | grep "Best" | cut -d ":" -f 2 | tr -d '[:space:]')
                if [ "$(ls -1 | grep "^RAxML" | wc -l)" -ne 0 ]
		then
			rm RAxML*
		fi
        	raxml -f a -T 2 -m PROTGAMMA$RAxMLmodel         	-p 12345 -x 12345 -# 100         	-s ../../per_gene/EOG091G06M8/ALICUT_EOG091G06M8.clustalo.fasta -n EOG091G06M8.clustalo.aln.ALICUT.$RAxMLmodel 		1> ../../per_gene/EOG091G06M8/infer_single_ML.stdout.txt 2> ../../per_gene/EOG091G06M8/infer_single_ML.stderr.txt
	else
		echo "fasta file per_gene/EOG091G06M8/ALICUT_EOG091G06M8.clustalo.fasta contains fewer than 5 sequences - skipped" > ../../per_gene/EOG091G06M8/infer_single_ML.stdout.txt
		touch raxml.skipped
	fi
        touch ../../per_gene/EOG091G06M8/EOG091G06M8.raxml.done
        [0m
[Sun Jul  5 23:42:03 2020]
Finished job 486.
2351 of 3292 steps (71%) done

[Sun Jul  5 23:42:03 2020]
rule infer_single_ML:
    input: per_gene/EOG091G05KR/EOG091G05KR.best_model, per_gene/EOG091G05KR/ALICUT_EOG091G05KR.clustalo.fasta
    output: per_gene/EOG091G05KR/EOG091G05KR.raxml.done
    log: per_gene/EOG091G05KR/infer_single_ML.stdout.txt, per_gene/EOG091G05KR/infer_single_ML.stderr.txt
    jobid: 37
    wildcards: BUSCO=EOG091G05KR
    threads: 2


        cd per_gene/EOG091G05KR
	count=$(cat ../../per_gene/EOG091G05KR/ALICUT_EOG091G05KR.clustalo.fasta | grep ">" | wc -l)
	if [ "$count" -gt 5 ]
        then
		RAxMLmodel=$(cat ../../per_gene/EOG091G05KR/EOG091G05KR.best_model | grep "Best" | cut -d ":" -f 2 | tr -d '[:space:]')
                if [ "$(ls -1 | grep "^RAxML" | wc -l)" -ne 0 ]
		then
			rm RAxML*
		fi
        	raxml -f a -T 2 -m PROTGAMMA$RAxMLmodel         	-p 12345 -x 12345 -# 100         	-s ../../per_gene/EOG091G05KR/ALICUT_EOG091G05KR.clustalo.fasta -n EOG091G05KR.clustalo.aln.ALICUT.$RAxMLmodel 		1> ../../per_gene/EOG091G05KR/infer_single_ML.stdout.txt 2> ../../per_gene/EOG091G05KR/infer_single_ML.stderr.txt
	else
		echo "fasta file per_gene/EOG091G05KR/ALICUT_EOG091G05KR.clustalo.fasta contains fewer than 5 sequences - skipped" > ../../per_gene/EOG091G05KR/infer_single_ML.stdout.txt
		touch raxml.skipped
	fi
        touch ../../per_gene/EOG091G05KR/EOG091G05KR.raxml.done
        
[33mJob counts:
	count	jobs
	1	infer_single_ML
	1[0m
[33m
        cd per_gene/EOG091G05KR
	count=$(cat ../../per_gene/EOG091G05KR/ALICUT_EOG091G05KR.clustalo.fasta | grep ">" | wc -l)
	if [ "$count" -gt 5 ]
        then
		RAxMLmodel=$(cat ../../per_gene/EOG091G05KR/EOG091G05KR.best_model | grep "Best" | cut -d ":" -f 2 | tr -d '[:space:]')
                if [ "$(ls -1 | grep "^RAxML" | wc -l)" -ne 0 ]
		then
			rm RAxML*
		fi
        	raxml -f a -T 2 -m PROTGAMMA$RAxMLmodel         	-p 12345 -x 12345 -# 100         	-s ../../per_gene/EOG091G05KR/ALICUT_EOG091G05KR.clustalo.fasta -n EOG091G05KR.clustalo.aln.ALICUT.$RAxMLmodel 		1> ../../per_gene/EOG091G05KR/infer_single_ML.stdout.txt 2> ../../per_gene/EOG091G05KR/infer_single_ML.stderr.txt
	else
		echo "fasta file per_gene/EOG091G05KR/ALICUT_EOG091G05KR.clustalo.fasta contains fewer than 5 sequences - skipped" > ../../per_gene/EOG091G05KR/infer_single_ML.stdout.txt
		touch raxml.skipped
	fi
        touch ../../per_gene/EOG091G05KR/EOG091G05KR.raxml.done
        [0m
[Sun Jul  5 23:42:12 2020]
Finished job 1050.
2352 of 3292 steps (71%) done

[Sun Jul  5 23:42:12 2020]
rule infer_single_ML:
    input: per_gene/EOG091G19WY/EOG091G19WY.best_model, per_gene/EOG091G19WY/ALICUT_EOG091G19WY.clustalo.fasta
    output: per_gene/EOG091G19WY/EOG091G19WY.raxml.done
    log: per_gene/EOG091G19WY/infer_single_ML.stdout.txt, per_gene/EOG091G19WY/infer_single_ML.stderr.txt
    jobid: 319
    wildcards: BUSCO=EOG091G19WY
    threads: 2


        cd per_gene/EOG091G19WY
	count=$(cat ../../per_gene/EOG091G19WY/ALICUT_EOG091G19WY.clustalo.fasta | grep ">" | wc -l)
	if [ "$count" -gt 5 ]
        then
		RAxMLmodel=$(cat ../../per_gene/EOG091G19WY/EOG091G19WY.best_model | grep "Best" | cut -d ":" -f 2 | tr -d '[:space:]')
                if [ "$(ls -1 | grep "^RAxML" | wc -l)" -ne 0 ]
		then
			rm RAxML*
		fi
        	raxml -f a -T 2 -m PROTGAMMA$RAxMLmodel         	-p 12345 -x 12345 -# 100         	-s ../../per_gene/EOG091G19WY/ALICUT_EOG091G19WY.clustalo.fasta -n EOG091G19WY.clustalo.aln.ALICUT.$RAxMLmodel 		1> ../../per_gene/EOG091G19WY/infer_single_ML.stdout.txt 2> ../../per_gene/EOG091G19WY/infer_single_ML.stderr.txt
	else
		echo "fasta file per_gene/EOG091G19WY/ALICUT_EOG091G19WY.clustalo.fasta contains fewer than 5 sequences - skipped" > ../../per_gene/EOG091G19WY/infer_single_ML.stdout.txt
		touch raxml.skipped
	fi
        touch ../../per_gene/EOG091G19WY/EOG091G19WY.raxml.done
        
[33mJob counts:
	count	jobs
	1	infer_single_ML
	1[0m
[33m
        cd per_gene/EOG091G19WY
	count=$(cat ../../per_gene/EOG091G19WY/ALICUT_EOG091G19WY.clustalo.fasta | grep ">" | wc -l)
	if [ "$count" -gt 5 ]
        then
		RAxMLmodel=$(cat ../../per_gene/EOG091G19WY/EOG091G19WY.best_model | grep "Best" | cut -d ":" -f 2 | tr -d '[:space:]')
                if [ "$(ls -1 | grep "^RAxML" | wc -l)" -ne 0 ]
		then
			rm RAxML*
		fi
        	raxml -f a -T 2 -m PROTGAMMA$RAxMLmodel         	-p 12345 -x 12345 -# 100         	-s ../../per_gene/EOG091G19WY/ALICUT_EOG091G19WY.clustalo.fasta -n EOG091G19WY.clustalo.aln.ALICUT.$RAxMLmodel 		1> ../../per_gene/EOG091G19WY/infer_single_ML.stdout.txt 2> ../../per_gene/EOG091G19WY/infer_single_ML.stderr.txt
	else
		echo "fasta file per_gene/EOG091G19WY/ALICUT_EOG091G19WY.clustalo.fasta contains fewer than 5 sequences - skipped" > ../../per_gene/EOG091G19WY/infer_single_ML.stdout.txt
		touch raxml.skipped
	fi
        touch ../../per_gene/EOG091G19WY/EOG091G19WY.raxml.done
        [0m
[Sun Jul  5 23:42:39 2020]
Finished job 77.
2353 of 3292 steps (71%) done

[Sun Jul  5 23:42:39 2020]
rule get_seqs:
    input: /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ingroup.txt, /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/outgroup.txt
    output: per_gene/EOG091G0RA2/EOG091G0RA2.ingroup.fasta
    log: per_gene/EOG091G0RA2/get_seqs.stdout.txt, per_gene/EOG091G0RA2/get_seqs.stderr.txt
    jobid: 2832
    wildcards: BUSCO=EOG091G0RA2
    threads: 2


	basedir=$(pwd)
        cd per_gene/EOG091G0RA2
        
        bash $basedir/../scripts/fetch_seqs.sh EOG091G0RA2 /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ingroup.txt /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/outgroup.txt 1> ../../per_gene/EOG091G0RA2/get_seqs.stdout.txt 2> ../../per_gene/EOG091G0RA2/get_seqs.stderr.txt
	mv EOG091G0RA2.fasta $basedir/per_gene/EOG091G0RA2/EOG091G0RA2.ingroup.fasta
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/72476f9d9a5bd0627b4d721143a21354.simg
[Sun Jul  5 23:42:52 2020]
Finished job 2832.
2354 of 3292 steps (72%) done

[Sun Jul  5 23:42:52 2020]
rule get_outgroups:
    input: per_gene/EOG091G0RA2/EOG091G0RA2.ingroup.fasta
    output: per_gene/EOG091G0RA2/EOG091G0RA2.orthodb.fasta, per_gene/EOG091G0RA2/EOG091G0RA2.outgroup.fasta
    log: per_gene/EOG091G0RA2/get_outgroups.stdout.txt, per_gene/EOG091G0RA2/get_outgroups.stderr.txt
    jobid: 2833
    wildcards: BUSCO=EOG091G0RA2


        #download fastas from Orhtodb for BUSCO id
        for i in {1..5}
        do
             wget "http://www.orthodb.org/fasta?query=EOG091G0RA2&level=33208" -O per_gene/EOG091G0RA2/EOG091G0RA2.orthodb.fasta 1> per_gene/EOG091G0RA2/get_outgroups.stdout.txt 2> per_gene/EOG091G0RA2/get_outgroups.stderr.txt && break || echo -e "try again ($i)" && sleep 15
        done

	#This is quick an dirty for now and just takes the first protein if there is more than one for an outgroup taxon
        bash ../scripts/download_outgroups.sh taxids.txt per_gene/EOG091G0RA2/EOG091G0RA2.orthodb.fasta > per_gene/EOG091G0RA2/EOG091G0RA2.outgroup.fasta
        
[Sun Jul  5 23:42:53 2020]
Finished job 2833.
2355 of 3292 steps (72%) done

[Sun Jul  5 23:42:53 2020]
rule join_groups:
    input: per_gene/EOG091G0RA2/EOG091G0RA2.ingroup.fasta, per_gene/EOG091G0RA2/EOG091G0RA2.outgroup.fasta
    output: per_gene/EOG091G0RA2/EOG091G0RA2.fasta
    jobid: 2240
    wildcards: BUSCO=EOG091G0RA2


        cat per_gene/EOG091G0RA2/EOG091G0RA2.ingroup.fasta per_gene/EOG091G0RA2/EOG091G0RA2.outgroup.fasta > per_gene/EOG091G0RA2/EOG091G0RA2.fasta
        
[Sun Jul  5 23:42:53 2020]
Finished job 2240.
2356 of 3292 steps (72%) done

[Sun Jul  5 23:42:53 2020]
rule MSA:
    input: per_gene/EOG091G0RA2/EOG091G0RA2.fasta
    output: per_gene/EOG091G0RA2/EOG091G0RA2.clustalo.fasta
    log: per_gene/EOG091G0RA2/MSA.stdout.txt, per_gene/EOG091G0RA2/MSA.stderr.txt
    jobid: 1600
    wildcards: BUSCO=EOG091G0RA2
    threads: 2


        clustalo -i per_gene/EOG091G0RA2/EOG091G0RA2.fasta -o per_gene/EOG091G0RA2/EOG091G0RA2.clustalo.fasta --threads=2 1> per_gene/EOG091G0RA2/MSA.stdout.txt 2> per_gene/EOG091G0RA2/MSA.stderr.txt
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/d68c9691725a7401923680874285c430.simg
[Sun Jul  5 23:42:54 2020]
Finished job 1600.
2357 of 3292 steps (72%) done

[Sun Jul  5 23:42:54 2020]
rule score_and_cut:
    input: per_gene/EOG091G0RA2/EOG091G0RA2.clustalo.fasta
    output: per_gene/EOG091G0RA2/ALICUT_EOG091G0RA2.clustalo.fasta
    jobid: 777
    wildcards: BUSCO=EOG091G0RA2
    threads: 2


        cd per_gene/EOG091G0RA2
        Aliscore.pl -N -r 200000000000000000 -i ../../per_gene/EOG091G0RA2/EOG091G0RA2.clustalo.fasta &> aliscore.log
        ALICUT.pl -s &> alicut.log
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/63c88c27a0fa300f57066b0ef65fefcb.simg
[Sun Jul  5 23:43:04 2020]
Finished job 777.
2358 of 3292 steps (72%) done

[Sun Jul  5 23:43:04 2020]
rule remove_empty:
    input: per_gene/EOG091G0RA2/ALICUT_EOG091G0RA2.clustalo.fasta
    output: per_gene/EOG091G0RA2/empty_check.done
    jobid: 1599
    wildcards: BUSCO=EOG091G0RA2


         if [ "$(cat per_gene/EOG091G0RA2/ALICUT_EOG091G0RA2.clustalo.fasta | grep -v ">" | sed 's/-//g' | grep "^$" | wc -l)" -gt 0 ]
         then
              cp per_gene/EOG091G0RA2/ALICUT_EOG091G0RA2.clustalo.fasta per_gene/EOG091G0RA2/ALICUT_EOG091G0RA2.clustalo.fasta.backup
              bash ../scripts/remove_empty.sh per_gene/EOG091G0RA2/ALICUT_EOG091G0RA2.clustalo.fasta.backup > per_gene/EOG091G0RA2/ALICUT_EOG091G0RA2.clustalo.fasta
         fi
         touch per_gene/EOG091G0RA2/empty_check.done
         
[Sun Jul  5 23:43:04 2020]
Finished job 1599.
2359 of 3292 steps (72%) done

[Sun Jul  5 23:43:04 2020]
rule find_best_model:
    input: per_gene/EOG091G0RA2/ALICUT_EOG091G0RA2.clustalo.fasta, per_gene/EOG091G0RA2/empty_check.done
    output: per_gene/EOG091G0RA2/EOG091G0RA2.best_model
    log: per_gene/EOG091G0RA2/find_best_model.stderr.txt
    jobid: 776
    wildcards: BUSCO=EOG091G0RA2
    threads: 2


        cd per_gene/EOG091G0RA2
        if [ ! -d find_best_model ]
        then
            mkdir find_best_model
        fi
        cd find_best_model
        ln -s ../../../per_gene/EOG091G0RA2/ALICUT_EOG091G0RA2.clustalo.fasta EOG091G0RA2.fasta
        ProteinModelSelection.pl EOG091G0RA2.fasta 1> ../../../per_gene/EOG091G0RA2/EOG091G0RA2.best_model 2> ../../../per_gene/EOG091G0RA2/find_best_model.stderr.txt
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/c0c09ee657b1e27f2c5687e0e9aa8d70.simg
[Sun Jul  5 23:43:19 2020]
Finished job 251.
2360 of 3292 steps (72%) done

[Sun Jul  5 23:43:19 2020]
rule get_seqs:
    input: /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ingroup.txt, /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/outgroup.txt
    output: per_gene/EOG091G0CFP/EOG091G0CFP.ingroup.fasta
    log: per_gene/EOG091G0CFP/get_seqs.stdout.txt, per_gene/EOG091G0CFP/get_seqs.stderr.txt
    jobid: 2648
    wildcards: BUSCO=EOG091G0CFP
    threads: 2


	basedir=$(pwd)
        cd per_gene/EOG091G0CFP
        
        bash $basedir/../scripts/fetch_seqs.sh EOG091G0CFP /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ingroup.txt /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/outgroup.txt 1> ../../per_gene/EOG091G0CFP/get_seqs.stdout.txt 2> ../../per_gene/EOG091G0CFP/get_seqs.stderr.txt
	mv EOG091G0CFP.fasta $basedir/per_gene/EOG091G0CFP/EOG091G0CFP.ingroup.fasta
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/72476f9d9a5bd0627b4d721143a21354.simg
[Sun Jul  5 23:43:29 2020]
Finished job 74.
2361 of 3292 steps (72%) done

[Sun Jul  5 23:43:29 2020]
rule get_seqs:
    input: /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ingroup.txt, /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/outgroup.txt
    output: per_gene/EOG091G0LIN/EOG091G0LIN.ingroup.fasta
    log: per_gene/EOG091G0LIN/get_seqs.stdout.txt, per_gene/EOG091G0LIN/get_seqs.stderr.txt
    jobid: 3224
    wildcards: BUSCO=EOG091G0LIN
    threads: 2


	basedir=$(pwd)
        cd per_gene/EOG091G0LIN
        
        bash $basedir/../scripts/fetch_seqs.sh EOG091G0LIN /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ingroup.txt /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/outgroup.txt 1> ../../per_gene/EOG091G0LIN/get_seqs.stdout.txt 2> ../../per_gene/EOG091G0LIN/get_seqs.stderr.txt
	mv EOG091G0LIN.fasta $basedir/per_gene/EOG091G0LIN/EOG091G0LIN.ingroup.fasta
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/72476f9d9a5bd0627b4d721143a21354.simg
[Sun Jul  5 23:43:33 2020]
Finished job 776.
2362 of 3292 steps (72%) done

[Sun Jul  5 23:43:33 2020]
rule infer_single_ML:
    input: per_gene/EOG091G0RA2/EOG091G0RA2.best_model, per_gene/EOG091G0RA2/ALICUT_EOG091G0RA2.clustalo.fasta
    output: per_gene/EOG091G0RA2/EOG091G0RA2.raxml.done
    log: per_gene/EOG091G0RA2/infer_single_ML.stdout.txt, per_gene/EOG091G0RA2/infer_single_ML.stderr.txt
    jobid: 182
    wildcards: BUSCO=EOG091G0RA2
    threads: 2


        cd per_gene/EOG091G0RA2
	count=$(cat ../../per_gene/EOG091G0RA2/ALICUT_EOG091G0RA2.clustalo.fasta | grep ">" | wc -l)
	if [ "$count" -gt 5 ]
        then
		RAxMLmodel=$(cat ../../per_gene/EOG091G0RA2/EOG091G0RA2.best_model | grep "Best" | cut -d ":" -f 2 | tr -d '[:space:]')
                if [ "$(ls -1 | grep "^RAxML" | wc -l)" -ne 0 ]
		then
			rm RAxML*
		fi
        	raxml -f a -T 2 -m PROTGAMMA$RAxMLmodel         	-p 12345 -x 12345 -# 100         	-s ../../per_gene/EOG091G0RA2/ALICUT_EOG091G0RA2.clustalo.fasta -n EOG091G0RA2.clustalo.aln.ALICUT.$RAxMLmodel 		1> ../../per_gene/EOG091G0RA2/infer_single_ML.stdout.txt 2> ../../per_gene/EOG091G0RA2/infer_single_ML.stderr.txt
	else
		echo "fasta file per_gene/EOG091G0RA2/ALICUT_EOG091G0RA2.clustalo.fasta contains fewer than 5 sequences - skipped" > ../../per_gene/EOG091G0RA2/infer_single_ML.stdout.txt
		touch raxml.skipped
	fi
        touch ../../per_gene/EOG091G0RA2/EOG091G0RA2.raxml.done
        
[33mJob counts:
	count	jobs
	1	infer_single_ML
	1[0m
[33m
        cd per_gene/EOG091G0RA2
	count=$(cat ../../per_gene/EOG091G0RA2/ALICUT_EOG091G0RA2.clustalo.fasta | grep ">" | wc -l)
	if [ "$count" -gt 5 ]
        then
		RAxMLmodel=$(cat ../../per_gene/EOG091G0RA2/EOG091G0RA2.best_model | grep "Best" | cut -d ":" -f 2 | tr -d '[:space:]')
                if [ "$(ls -1 | grep "^RAxML" | wc -l)" -ne 0 ]
		then
			rm RAxML*
		fi
        	raxml -f a -T 2 -m PROTGAMMA$RAxMLmodel         	-p 12345 -x 12345 -# 100         	-s ../../per_gene/EOG091G0RA2/ALICUT_EOG091G0RA2.clustalo.fasta -n EOG091G0RA2.clustalo.aln.ALICUT.$RAxMLmodel 		1> ../../per_gene/EOG091G0RA2/infer_single_ML.stdout.txt 2> ../../per_gene/EOG091G0RA2/infer_single_ML.stderr.txt
	else
		echo "fasta file per_gene/EOG091G0RA2/ALICUT_EOG091G0RA2.clustalo.fasta contains fewer than 5 sequences - skipped" > ../../per_gene/EOG091G0RA2/infer_single_ML.stdout.txt
		touch raxml.skipped
	fi
        touch ../../per_gene/EOG091G0RA2/EOG091G0RA2.raxml.done
        [0m
[Sun Jul  5 23:43:36 2020]
Finished job 2648.
2363 of 3292 steps (72%) done

[Sun Jul  5 23:43:36 2020]
rule get_outgroups:
    input: per_gene/EOG091G0CFP/EOG091G0CFP.ingroup.fasta
    output: per_gene/EOG091G0CFP/EOG091G0CFP.orthodb.fasta, per_gene/EOG091G0CFP/EOG091G0CFP.outgroup.fasta
    log: per_gene/EOG091G0CFP/get_outgroups.stdout.txt, per_gene/EOG091G0CFP/get_outgroups.stderr.txt
    jobid: 2649
    wildcards: BUSCO=EOG091G0CFP


        #download fastas from Orhtodb for BUSCO id
        for i in {1..5}
        do
             wget "http://www.orthodb.org/fasta?query=EOG091G0CFP&level=33208" -O per_gene/EOG091G0CFP/EOG091G0CFP.orthodb.fasta 1> per_gene/EOG091G0CFP/get_outgroups.stdout.txt 2> per_gene/EOG091G0CFP/get_outgroups.stderr.txt && break || echo -e "try again ($i)" && sleep 15
        done

	#This is quick an dirty for now and just takes the first protein if there is more than one for an outgroup taxon
        bash ../scripts/download_outgroups.sh taxids.txt per_gene/EOG091G0CFP/EOG091G0CFP.orthodb.fasta > per_gene/EOG091G0CFP/EOG091G0CFP.outgroup.fasta
        
[Sun Jul  5 23:43:37 2020]
Finished job 2649.
2364 of 3292 steps (72%) done

[Sun Jul  5 23:43:37 2020]
rule join_groups:
    input: per_gene/EOG091G0CFP/EOG091G0CFP.ingroup.fasta, per_gene/EOG091G0CFP/EOG091G0CFP.outgroup.fasta
    output: per_gene/EOG091G0CFP/EOG091G0CFP.fasta
    jobid: 2148
    wildcards: BUSCO=EOG091G0CFP


        cat per_gene/EOG091G0CFP/EOG091G0CFP.ingroup.fasta per_gene/EOG091G0CFP/EOG091G0CFP.outgroup.fasta > per_gene/EOG091G0CFP/EOG091G0CFP.fasta
        
[Sun Jul  5 23:43:37 2020]
Finished job 2148.
2365 of 3292 steps (72%) done

[Sun Jul  5 23:43:37 2020]
rule MSA:
    input: per_gene/EOG091G0CFP/EOG091G0CFP.fasta
    output: per_gene/EOG091G0CFP/EOG091G0CFP.clustalo.fasta
    log: per_gene/EOG091G0CFP/MSA.stdout.txt, per_gene/EOG091G0CFP/MSA.stderr.txt
    jobid: 1416
    wildcards: BUSCO=EOG091G0CFP
    threads: 2


        clustalo -i per_gene/EOG091G0CFP/EOG091G0CFP.fasta -o per_gene/EOG091G0CFP/EOG091G0CFP.clustalo.fasta --threads=2 1> per_gene/EOG091G0CFP/MSA.stdout.txt 2> per_gene/EOG091G0CFP/MSA.stderr.txt
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/d68c9691725a7401923680874285c430.simg
[Sun Jul  5 23:43:38 2020]
Finished job 1416.
2366 of 3292 steps (72%) done

[Sun Jul  5 23:43:38 2020]
rule score_and_cut:
    input: per_gene/EOG091G0CFP/EOG091G0CFP.clustalo.fasta
    output: per_gene/EOG091G0CFP/ALICUT_EOG091G0CFP.clustalo.fasta
    jobid: 593
    wildcards: BUSCO=EOG091G0CFP
    threads: 2


        cd per_gene/EOG091G0CFP
        Aliscore.pl -N -r 200000000000000000 -i ../../per_gene/EOG091G0CFP/EOG091G0CFP.clustalo.fasta &> aliscore.log
        ALICUT.pl -s &> alicut.log
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/63c88c27a0fa300f57066b0ef65fefcb.simg
[Sun Jul  5 23:43:44 2020]
Finished job 3224.
2367 of 3292 steps (72%) done

[Sun Jul  5 23:43:44 2020]
rule get_outgroups:
    input: per_gene/EOG091G0LIN/EOG091G0LIN.ingroup.fasta
    output: per_gene/EOG091G0LIN/EOG091G0LIN.orthodb.fasta, per_gene/EOG091G0LIN/EOG091G0LIN.outgroup.fasta
    log: per_gene/EOG091G0LIN/get_outgroups.stdout.txt, per_gene/EOG091G0LIN/get_outgroups.stderr.txt
    jobid: 3225
    wildcards: BUSCO=EOG091G0LIN


        #download fastas from Orhtodb for BUSCO id
        for i in {1..5}
        do
             wget "http://www.orthodb.org/fasta?query=EOG091G0LIN&level=33208" -O per_gene/EOG091G0LIN/EOG091G0LIN.orthodb.fasta 1> per_gene/EOG091G0LIN/get_outgroups.stdout.txt 2> per_gene/EOG091G0LIN/get_outgroups.stderr.txt && break || echo -e "try again ($i)" && sleep 15
        done

	#This is quick an dirty for now and just takes the first protein if there is more than one for an outgroup taxon
        bash ../scripts/download_outgroups.sh taxids.txt per_gene/EOG091G0LIN/EOG091G0LIN.orthodb.fasta > per_gene/EOG091G0LIN/EOG091G0LIN.outgroup.fasta
        
[Sun Jul  5 23:43:45 2020]
Finished job 3225.
2368 of 3292 steps (72%) done

[Sun Jul  5 23:43:45 2020]
rule join_groups:
    input: per_gene/EOG091G0LIN/EOG091G0LIN.ingroup.fasta, per_gene/EOG091G0LIN/EOG091G0LIN.outgroup.fasta
    output: per_gene/EOG091G0LIN/EOG091G0LIN.fasta
    jobid: 2436
    wildcards: BUSCO=EOG091G0LIN


        cat per_gene/EOG091G0LIN/EOG091G0LIN.ingroup.fasta per_gene/EOG091G0LIN/EOG091G0LIN.outgroup.fasta > per_gene/EOG091G0LIN/EOG091G0LIN.fasta
        
[Sun Jul  5 23:43:45 2020]
Finished job 2436.
2369 of 3292 steps (72%) done

[Sun Jul  5 23:43:45 2020]
rule MSA:
    input: per_gene/EOG091G0LIN/EOG091G0LIN.fasta
    output: per_gene/EOG091G0LIN/EOG091G0LIN.clustalo.fasta
    log: per_gene/EOG091G0LIN/MSA.stdout.txt, per_gene/EOG091G0LIN/MSA.stderr.txt
    jobid: 1992
    wildcards: BUSCO=EOG091G0LIN
    threads: 2


        clustalo -i per_gene/EOG091G0LIN/EOG091G0LIN.fasta -o per_gene/EOG091G0LIN/EOG091G0LIN.clustalo.fasta --threads=2 1> per_gene/EOG091G0LIN/MSA.stdout.txt 2> per_gene/EOG091G0LIN/MSA.stderr.txt
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/d68c9691725a7401923680874285c430.simg
[Sun Jul  5 23:43:46 2020]
Finished job 1992.
2370 of 3292 steps (72%) done

[Sun Jul  5 23:43:46 2020]
rule score_and_cut:
    input: per_gene/EOG091G0LIN/EOG091G0LIN.clustalo.fasta
    output: per_gene/EOG091G0LIN/ALICUT_EOG091G0LIN.clustalo.fasta
    jobid: 1169
    wildcards: BUSCO=EOG091G0LIN
    threads: 2


        cd per_gene/EOG091G0LIN
        Aliscore.pl -N -r 200000000000000000 -i ../../per_gene/EOG091G0LIN/EOG091G0LIN.clustalo.fasta &> aliscore.log
        ALICUT.pl -s &> alicut.log
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/63c88c27a0fa300f57066b0ef65fefcb.simg
[Sun Jul  5 23:43:47 2020]
Finished job 318.
2371 of 3292 steps (72%) done

[Sun Jul  5 23:43:47 2020]
rule get_seqs:
    input: /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ingroup.txt, /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/outgroup.txt
    output: per_gene/EOG091G0VNB/EOG091G0VNB.ingroup.fasta
    log: per_gene/EOG091G0VNB/get_seqs.stdout.txt, per_gene/EOG091G0VNB/get_seqs.stderr.txt
    jobid: 2876
    wildcards: BUSCO=EOG091G0VNB
    threads: 2


	basedir=$(pwd)
        cd per_gene/EOG091G0VNB
        
        bash $basedir/../scripts/fetch_seqs.sh EOG091G0VNB /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ingroup.txt /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/outgroup.txt 1> ../../per_gene/EOG091G0VNB/get_seqs.stdout.txt 2> ../../per_gene/EOG091G0VNB/get_seqs.stderr.txt
	mv EOG091G0VNB.fasta $basedir/per_gene/EOG091G0VNB/EOG091G0VNB.ingroup.fasta
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/72476f9d9a5bd0627b4d721143a21354.simg
[Sun Jul  5 23:43:47 2020]
Finished job 593.
2372 of 3292 steps (72%) done

[Sun Jul  5 23:43:47 2020]
rule remove_empty:
    input: per_gene/EOG091G0CFP/ALICUT_EOG091G0CFP.clustalo.fasta
    output: per_gene/EOG091G0CFP/empty_check.done
    jobid: 1415
    wildcards: BUSCO=EOG091G0CFP


         if [ "$(cat per_gene/EOG091G0CFP/ALICUT_EOG091G0CFP.clustalo.fasta | grep -v ">" | sed 's/-//g' | grep "^$" | wc -l)" -gt 0 ]
         then
              cp per_gene/EOG091G0CFP/ALICUT_EOG091G0CFP.clustalo.fasta per_gene/EOG091G0CFP/ALICUT_EOG091G0CFP.clustalo.fasta.backup
              bash ../scripts/remove_empty.sh per_gene/EOG091G0CFP/ALICUT_EOG091G0CFP.clustalo.fasta.backup > per_gene/EOG091G0CFP/ALICUT_EOG091G0CFP.clustalo.fasta
         fi
         touch per_gene/EOG091G0CFP/empty_check.done
         
[Sun Jul  5 23:43:47 2020]
Finished job 1415.
2373 of 3292 steps (72%) done

[Sun Jul  5 23:43:47 2020]
rule find_best_model:
    input: per_gene/EOG091G0CFP/ALICUT_EOG091G0CFP.clustalo.fasta, per_gene/EOG091G0CFP/empty_check.done
    output: per_gene/EOG091G0CFP/EOG091G0CFP.best_model
    log: per_gene/EOG091G0CFP/find_best_model.stderr.txt
    jobid: 592
    wildcards: BUSCO=EOG091G0CFP
    threads: 2


        cd per_gene/EOG091G0CFP
        if [ ! -d find_best_model ]
        then
            mkdir find_best_model
        fi
        cd find_best_model
        ln -s ../../../per_gene/EOG091G0CFP/ALICUT_EOG091G0CFP.clustalo.fasta EOG091G0CFP.fasta
        ProteinModelSelection.pl EOG091G0CFP.fasta 1> ../../../per_gene/EOG091G0CFP/EOG091G0CFP.best_model 2> ../../../per_gene/EOG091G0CFP/find_best_model.stderr.txt
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/c0c09ee657b1e27f2c5687e0e9aa8d70.simg
[Sun Jul  5 23:43:56 2020]
Finished job 1169.
2374 of 3292 steps (72%) done

[Sun Jul  5 23:43:56 2020]
rule remove_empty:
    input: per_gene/EOG091G0LIN/ALICUT_EOG091G0LIN.clustalo.fasta
    output: per_gene/EOG091G0LIN/empty_check.done
    jobid: 1991
    wildcards: BUSCO=EOG091G0LIN


         if [ "$(cat per_gene/EOG091G0LIN/ALICUT_EOG091G0LIN.clustalo.fasta | grep -v ">" | sed 's/-//g' | grep "^$" | wc -l)" -gt 0 ]
         then
              cp per_gene/EOG091G0LIN/ALICUT_EOG091G0LIN.clustalo.fasta per_gene/EOG091G0LIN/ALICUT_EOG091G0LIN.clustalo.fasta.backup
              bash ../scripts/remove_empty.sh per_gene/EOG091G0LIN/ALICUT_EOG091G0LIN.clustalo.fasta.backup > per_gene/EOG091G0LIN/ALICUT_EOG091G0LIN.clustalo.fasta
         fi
         touch per_gene/EOG091G0LIN/empty_check.done
         
[Sun Jul  5 23:43:57 2020]
Finished job 1991.
2375 of 3292 steps (72%) done

[Sun Jul  5 23:43:57 2020]
rule find_best_model:
    input: per_gene/EOG091G0LIN/ALICUT_EOG091G0LIN.clustalo.fasta, per_gene/EOG091G0LIN/empty_check.done
    output: per_gene/EOG091G0LIN/EOG091G0LIN.best_model
    log: per_gene/EOG091G0LIN/find_best_model.stderr.txt
    jobid: 1168
    wildcards: BUSCO=EOG091G0LIN
    threads: 2


        cd per_gene/EOG091G0LIN
        if [ ! -d find_best_model ]
        then
            mkdir find_best_model
        fi
        cd find_best_model
        ln -s ../../../per_gene/EOG091G0LIN/ALICUT_EOG091G0LIN.clustalo.fasta EOG091G0LIN.fasta
        ProteinModelSelection.pl EOG091G0LIN.fasta 1> ../../../per_gene/EOG091G0LIN/EOG091G0LIN.best_model 2> ../../../per_gene/EOG091G0LIN/find_best_model.stderr.txt
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/c0c09ee657b1e27f2c5687e0e9aa8d70.simg
[Sun Jul  5 23:43:58 2020]
Finished job 2876.
2376 of 3292 steps (72%) done

[Sun Jul  5 23:43:58 2020]
rule get_outgroups:
    input: per_gene/EOG091G0VNB/EOG091G0VNB.ingroup.fasta
    output: per_gene/EOG091G0VNB/EOG091G0VNB.orthodb.fasta, per_gene/EOG091G0VNB/EOG091G0VNB.outgroup.fasta
    log: per_gene/EOG091G0VNB/get_outgroups.stdout.txt, per_gene/EOG091G0VNB/get_outgroups.stderr.txt
    jobid: 2877
    wildcards: BUSCO=EOG091G0VNB


        #download fastas from Orhtodb for BUSCO id
        for i in {1..5}
        do
             wget "http://www.orthodb.org/fasta?query=EOG091G0VNB&level=33208" -O per_gene/EOG091G0VNB/EOG091G0VNB.orthodb.fasta 1> per_gene/EOG091G0VNB/get_outgroups.stdout.txt 2> per_gene/EOG091G0VNB/get_outgroups.stderr.txt && break || echo -e "try again ($i)" && sleep 15
        done

	#This is quick an dirty for now and just takes the first protein if there is more than one for an outgroup taxon
        bash ../scripts/download_outgroups.sh taxids.txt per_gene/EOG091G0VNB/EOG091G0VNB.orthodb.fasta > per_gene/EOG091G0VNB/EOG091G0VNB.outgroup.fasta
        
[Sun Jul  5 23:44:00 2020]
Finished job 2877.
2377 of 3292 steps (72%) done

[Sun Jul  5 23:44:00 2020]
rule join_groups:
    input: per_gene/EOG091G0VNB/EOG091G0VNB.ingroup.fasta, per_gene/EOG091G0VNB/EOG091G0VNB.outgroup.fasta
    output: per_gene/EOG091G0VNB/EOG091G0VNB.fasta
    jobid: 2262
    wildcards: BUSCO=EOG091G0VNB


        cat per_gene/EOG091G0VNB/EOG091G0VNB.ingroup.fasta per_gene/EOG091G0VNB/EOG091G0VNB.outgroup.fasta > per_gene/EOG091G0VNB/EOG091G0VNB.fasta
        
[Sun Jul  5 23:44:00 2020]
Finished job 2262.
2378 of 3292 steps (72%) done

[Sun Jul  5 23:44:00 2020]
rule MSA:
    input: per_gene/EOG091G0VNB/EOG091G0VNB.fasta
    output: per_gene/EOG091G0VNB/EOG091G0VNB.clustalo.fasta
    log: per_gene/EOG091G0VNB/MSA.stdout.txt, per_gene/EOG091G0VNB/MSA.stderr.txt
    jobid: 1644
    wildcards: BUSCO=EOG091G0VNB
    threads: 2


        clustalo -i per_gene/EOG091G0VNB/EOG091G0VNB.fasta -o per_gene/EOG091G0VNB/EOG091G0VNB.clustalo.fasta --threads=2 1> per_gene/EOG091G0VNB/MSA.stdout.txt 2> per_gene/EOG091G0VNB/MSA.stderr.txt
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/d68c9691725a7401923680874285c430.simg
[Sun Jul  5 23:44:00 2020]
Finished job 1644.
2379 of 3292 steps (72%) done

[Sun Jul  5 23:44:00 2020]
rule score_and_cut:
    input: per_gene/EOG091G0VNB/EOG091G0VNB.clustalo.fasta
    output: per_gene/EOG091G0VNB/ALICUT_EOG091G0VNB.clustalo.fasta
    jobid: 821
    wildcards: BUSCO=EOG091G0VNB
    threads: 2


        cd per_gene/EOG091G0VNB
        Aliscore.pl -N -r 200000000000000000 -i ../../per_gene/EOG091G0VNB/EOG091G0VNB.clustalo.fasta &> aliscore.log
        ALICUT.pl -s &> alicut.log
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/63c88c27a0fa300f57066b0ef65fefcb.simg
[Sun Jul  5 23:44:06 2020]
Finished job 319.
2380 of 3292 steps (72%) done

[Sun Jul  5 23:44:06 2020]
rule get_seqs:
    input: /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ingroup.txt, /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/outgroup.txt
    output: per_gene/EOG091G0M4K/EOG091G0M4K.ingroup.fasta
    log: per_gene/EOG091G0M4K/get_seqs.stdout.txt, per_gene/EOG091G0M4K/get_seqs.stderr.txt
    jobid: 2760
    wildcards: BUSCO=EOG091G0M4K
    threads: 2


	basedir=$(pwd)
        cd per_gene/EOG091G0M4K
        
        bash $basedir/../scripts/fetch_seqs.sh EOG091G0M4K /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ingroup.txt /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/outgroup.txt 1> ../../per_gene/EOG091G0M4K/get_seqs.stdout.txt 2> ../../per_gene/EOG091G0M4K/get_seqs.stderr.txt
	mv EOG091G0M4K.fasta $basedir/per_gene/EOG091G0M4K/EOG091G0M4K.ingroup.fasta
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/72476f9d9a5bd0627b4d721143a21354.simg
[Sun Jul  5 23:44:09 2020]
Finished job 821.
2381 of 3292 steps (72%) done

[Sun Jul  5 23:44:09 2020]
rule remove_empty:
    input: per_gene/EOG091G0VNB/ALICUT_EOG091G0VNB.clustalo.fasta
    output: per_gene/EOG091G0VNB/empty_check.done
    jobid: 1643
    wildcards: BUSCO=EOG091G0VNB


         if [ "$(cat per_gene/EOG091G0VNB/ALICUT_EOG091G0VNB.clustalo.fasta | grep -v ">" | sed 's/-//g' | grep "^$" | wc -l)" -gt 0 ]
         then
              cp per_gene/EOG091G0VNB/ALICUT_EOG091G0VNB.clustalo.fasta per_gene/EOG091G0VNB/ALICUT_EOG091G0VNB.clustalo.fasta.backup
              bash ../scripts/remove_empty.sh per_gene/EOG091G0VNB/ALICUT_EOG091G0VNB.clustalo.fasta.backup > per_gene/EOG091G0VNB/ALICUT_EOG091G0VNB.clustalo.fasta
         fi
         touch per_gene/EOG091G0VNB/empty_check.done
         
[Sun Jul  5 23:44:09 2020]
Finished job 1643.
2382 of 3292 steps (72%) done

[Sun Jul  5 23:44:09 2020]
rule find_best_model:
    input: per_gene/EOG091G0VNB/ALICUT_EOG091G0VNB.clustalo.fasta, per_gene/EOG091G0VNB/empty_check.done
    output: per_gene/EOG091G0VNB/EOG091G0VNB.best_model
    log: per_gene/EOG091G0VNB/find_best_model.stderr.txt
    jobid: 820
    wildcards: BUSCO=EOG091G0VNB
    threads: 2


        cd per_gene/EOG091G0VNB
        if [ ! -d find_best_model ]
        then
            mkdir find_best_model
        fi
        cd find_best_model
        ln -s ../../../per_gene/EOG091G0VNB/ALICUT_EOG091G0VNB.clustalo.fasta EOG091G0VNB.fasta
        ProteinModelSelection.pl EOG091G0VNB.fasta 1> ../../../per_gene/EOG091G0VNB/EOG091G0VNB.best_model 2> ../../../per_gene/EOG091G0VNB/find_best_model.stderr.txt
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/c0c09ee657b1e27f2c5687e0e9aa8d70.simg
[Sun Jul  5 23:44:19 2020]
Finished job 2760.
2383 of 3292 steps (72%) done

[Sun Jul  5 23:44:19 2020]
rule get_outgroups:
    input: per_gene/EOG091G0M4K/EOG091G0M4K.ingroup.fasta
    output: per_gene/EOG091G0M4K/EOG091G0M4K.orthodb.fasta, per_gene/EOG091G0M4K/EOG091G0M4K.outgroup.fasta
    log: per_gene/EOG091G0M4K/get_outgroups.stdout.txt, per_gene/EOG091G0M4K/get_outgroups.stderr.txt
    jobid: 2761
    wildcards: BUSCO=EOG091G0M4K


        #download fastas from Orhtodb for BUSCO id
        for i in {1..5}
        do
             wget "http://www.orthodb.org/fasta?query=EOG091G0M4K&level=33208" -O per_gene/EOG091G0M4K/EOG091G0M4K.orthodb.fasta 1> per_gene/EOG091G0M4K/get_outgroups.stdout.txt 2> per_gene/EOG091G0M4K/get_outgroups.stderr.txt && break || echo -e "try again ($i)" && sleep 15
        done

	#This is quick an dirty for now and just takes the first protein if there is more than one for an outgroup taxon
        bash ../scripts/download_outgroups.sh taxids.txt per_gene/EOG091G0M4K/EOG091G0M4K.orthodb.fasta > per_gene/EOG091G0M4K/EOG091G0M4K.outgroup.fasta
        
[Sun Jul  5 23:44:19 2020]
Finished job 592.
2384 of 3292 steps (72%) done

[Sun Jul  5 23:44:19 2020]
rule infer_single_ML:
    input: per_gene/EOG091G0CFP/EOG091G0CFP.best_model, per_gene/EOG091G0CFP/ALICUT_EOG091G0CFP.clustalo.fasta
    output: per_gene/EOG091G0CFP/EOG091G0CFP.raxml.done
    log: per_gene/EOG091G0CFP/infer_single_ML.stdout.txt, per_gene/EOG091G0CFP/infer_single_ML.stderr.txt
    jobid: 90
    wildcards: BUSCO=EOG091G0CFP
    threads: 2


        cd per_gene/EOG091G0CFP
	count=$(cat ../../per_gene/EOG091G0CFP/ALICUT_EOG091G0CFP.clustalo.fasta | grep ">" | wc -l)
	if [ "$count" -gt 5 ]
        then
		RAxMLmodel=$(cat ../../per_gene/EOG091G0CFP/EOG091G0CFP.best_model | grep "Best" | cut -d ":" -f 2 | tr -d '[:space:]')
                if [ "$(ls -1 | grep "^RAxML" | wc -l)" -ne 0 ]
		then
			rm RAxML*
		fi
        	raxml -f a -T 2 -m PROTGAMMA$RAxMLmodel         	-p 12345 -x 12345 -# 100         	-s ../../per_gene/EOG091G0CFP/ALICUT_EOG091G0CFP.clustalo.fasta -n EOG091G0CFP.clustalo.aln.ALICUT.$RAxMLmodel 		1> ../../per_gene/EOG091G0CFP/infer_single_ML.stdout.txt 2> ../../per_gene/EOG091G0CFP/infer_single_ML.stderr.txt
	else
		echo "fasta file per_gene/EOG091G0CFP/ALICUT_EOG091G0CFP.clustalo.fasta contains fewer than 5 sequences - skipped" > ../../per_gene/EOG091G0CFP/infer_single_ML.stdout.txt
		touch raxml.skipped
	fi
        touch ../../per_gene/EOG091G0CFP/EOG091G0CFP.raxml.done
        
[Sun Jul  5 23:44:20 2020]
Finished job 2761.
2385 of 3292 steps (72%) done

[Sun Jul  5 23:44:20 2020]
rule join_groups:
    input: per_gene/EOG091G0M4K/EOG091G0M4K.ingroup.fasta, per_gene/EOG091G0M4K/EOG091G0M4K.outgroup.fasta
    output: per_gene/EOG091G0M4K/EOG091G0M4K.fasta
    jobid: 2204
    wildcards: BUSCO=EOG091G0M4K


        cat per_gene/EOG091G0M4K/EOG091G0M4K.ingroup.fasta per_gene/EOG091G0M4K/EOG091G0M4K.outgroup.fasta > per_gene/EOG091G0M4K/EOG091G0M4K.fasta
        
[Sun Jul  5 23:44:20 2020]
Finished job 2204.
2386 of 3292 steps (72%) done

[Sun Jul  5 23:44:20 2020]
rule MSA:
    input: per_gene/EOG091G0M4K/EOG091G0M4K.fasta
    output: per_gene/EOG091G0M4K/EOG091G0M4K.clustalo.fasta
    log: per_gene/EOG091G0M4K/MSA.stdout.txt, per_gene/EOG091G0M4K/MSA.stderr.txt
    jobid: 1528
    wildcards: BUSCO=EOG091G0M4K
    threads: 2


        clustalo -i per_gene/EOG091G0M4K/EOG091G0M4K.fasta -o per_gene/EOG091G0M4K/EOG091G0M4K.clustalo.fasta --threads=2 1> per_gene/EOG091G0M4K/MSA.stdout.txt 2> per_gene/EOG091G0M4K/MSA.stderr.txt
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/d68c9691725a7401923680874285c430.simg
[33mJob counts:
	count	jobs
	1	infer_single_ML
	1[0m
[33m
        cd per_gene/EOG091G0CFP
	count=$(cat ../../per_gene/EOG091G0CFP/ALICUT_EOG091G0CFP.clustalo.fasta | grep ">" | wc -l)
	if [ "$count" -gt 5 ]
        then
		RAxMLmodel=$(cat ../../per_gene/EOG091G0CFP/EOG091G0CFP.best_model | grep "Best" | cut -d ":" -f 2 | tr -d '[:space:]')
                if [ "$(ls -1 | grep "^RAxML" | wc -l)" -ne 0 ]
		then
			rm RAxML*
		fi
        	raxml -f a -T 2 -m PROTGAMMA$RAxMLmodel         	-p 12345 -x 12345 -# 100         	-s ../../per_gene/EOG091G0CFP/ALICUT_EOG091G0CFP.clustalo.fasta -n EOG091G0CFP.clustalo.aln.ALICUT.$RAxMLmodel 		1> ../../per_gene/EOG091G0CFP/infer_single_ML.stdout.txt 2> ../../per_gene/EOG091G0CFP/infer_single_ML.stderr.txt
	else
		echo "fasta file per_gene/EOG091G0CFP/ALICUT_EOG091G0CFP.clustalo.fasta contains fewer than 5 sequences - skipped" > ../../per_gene/EOG091G0CFP/infer_single_ML.stdout.txt
		touch raxml.skipped
	fi
        touch ../../per_gene/EOG091G0CFP/EOG091G0CFP.raxml.done
        [0m
[Sun Jul  5 23:44:21 2020]
Finished job 1528.
2387 of 3292 steps (73%) done

[Sun Jul  5 23:44:21 2020]
rule score_and_cut:
    input: per_gene/EOG091G0M4K/EOG091G0M4K.clustalo.fasta
    output: per_gene/EOG091G0M4K/ALICUT_EOG091G0M4K.clustalo.fasta
    jobid: 705
    wildcards: BUSCO=EOG091G0M4K
    threads: 2


        cd per_gene/EOG091G0M4K
        Aliscore.pl -N -r 200000000000000000 -i ../../per_gene/EOG091G0M4K/EOG091G0M4K.clustalo.fasta &> aliscore.log
        ALICUT.pl -s &> alicut.log
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/63c88c27a0fa300f57066b0ef65fefcb.simg
[Sun Jul  5 23:44:25 2020]
Finished job 1168.
2388 of 3292 steps (73%) done

[Sun Jul  5 23:44:25 2020]
rule infer_single_ML:
    input: per_gene/EOG091G0LIN/EOG091G0LIN.best_model, per_gene/EOG091G0LIN/ALICUT_EOG091G0LIN.clustalo.fasta
    output: per_gene/EOG091G0LIN/EOG091G0LIN.raxml.done
    log: per_gene/EOG091G0LIN/infer_single_ML.stdout.txt, per_gene/EOG091G0LIN/infer_single_ML.stderr.txt
    jobid: 378
    wildcards: BUSCO=EOG091G0LIN
    threads: 2


        cd per_gene/EOG091G0LIN
	count=$(cat ../../per_gene/EOG091G0LIN/ALICUT_EOG091G0LIN.clustalo.fasta | grep ">" | wc -l)
	if [ "$count" -gt 5 ]
        then
		RAxMLmodel=$(cat ../../per_gene/EOG091G0LIN/EOG091G0LIN.best_model | grep "Best" | cut -d ":" -f 2 | tr -d '[:space:]')
                if [ "$(ls -1 | grep "^RAxML" | wc -l)" -ne 0 ]
		then
			rm RAxML*
		fi
        	raxml -f a -T 2 -m PROTGAMMA$RAxMLmodel         	-p 12345 -x 12345 -# 100         	-s ../../per_gene/EOG091G0LIN/ALICUT_EOG091G0LIN.clustalo.fasta -n EOG091G0LIN.clustalo.aln.ALICUT.$RAxMLmodel 		1> ../../per_gene/EOG091G0LIN/infer_single_ML.stdout.txt 2> ../../per_gene/EOG091G0LIN/infer_single_ML.stderr.txt
	else
		echo "fasta file per_gene/EOG091G0LIN/ALICUT_EOG091G0LIN.clustalo.fasta contains fewer than 5 sequences - skipped" > ../../per_gene/EOG091G0LIN/infer_single_ML.stdout.txt
		touch raxml.skipped
	fi
        touch ../../per_gene/EOG091G0LIN/EOG091G0LIN.raxml.done
        
[33mJob counts:
	count	jobs
	1	infer_single_ML
	1[0m
[33m
        cd per_gene/EOG091G0LIN
	count=$(cat ../../per_gene/EOG091G0LIN/ALICUT_EOG091G0LIN.clustalo.fasta | grep ">" | wc -l)
	if [ "$count" -gt 5 ]
        then
		RAxMLmodel=$(cat ../../per_gene/EOG091G0LIN/EOG091G0LIN.best_model | grep "Best" | cut -d ":" -f 2 | tr -d '[:space:]')
                if [ "$(ls -1 | grep "^RAxML" | wc -l)" -ne 0 ]
		then
			rm RAxML*
		fi
        	raxml -f a -T 2 -m PROTGAMMA$RAxMLmodel         	-p 12345 -x 12345 -# 100         	-s ../../per_gene/EOG091G0LIN/ALICUT_EOG091G0LIN.clustalo.fasta -n EOG091G0LIN.clustalo.aln.ALICUT.$RAxMLmodel 		1> ../../per_gene/EOG091G0LIN/infer_single_ML.stdout.txt 2> ../../per_gene/EOG091G0LIN/infer_single_ML.stderr.txt
	else
		echo "fasta file per_gene/EOG091G0LIN/ALICUT_EOG091G0LIN.clustalo.fasta contains fewer than 5 sequences - skipped" > ../../per_gene/EOG091G0LIN/infer_single_ML.stdout.txt
		touch raxml.skipped
	fi
        touch ../../per_gene/EOG091G0LIN/EOG091G0LIN.raxml.done
        [0m
[Sun Jul  5 23:44:30 2020]
Finished job 820.
2389 of 3292 steps (73%) done

[Sun Jul  5 23:44:30 2020]
rule infer_single_ML:
    input: per_gene/EOG091G0VNB/EOG091G0VNB.best_model, per_gene/EOG091G0VNB/ALICUT_EOG091G0VNB.clustalo.fasta
    output: per_gene/EOG091G0VNB/EOG091G0VNB.raxml.done
    log: per_gene/EOG091G0VNB/infer_single_ML.stdout.txt, per_gene/EOG091G0VNB/infer_single_ML.stderr.txt
    jobid: 204
    wildcards: BUSCO=EOG091G0VNB
    threads: 2


        cd per_gene/EOG091G0VNB
	count=$(cat ../../per_gene/EOG091G0VNB/ALICUT_EOG091G0VNB.clustalo.fasta | grep ">" | wc -l)
	if [ "$count" -gt 5 ]
        then
		RAxMLmodel=$(cat ../../per_gene/EOG091G0VNB/EOG091G0VNB.best_model | grep "Best" | cut -d ":" -f 2 | tr -d '[:space:]')
                if [ "$(ls -1 | grep "^RAxML" | wc -l)" -ne 0 ]
		then
			rm RAxML*
		fi
        	raxml -f a -T 2 -m PROTGAMMA$RAxMLmodel         	-p 12345 -x 12345 -# 100         	-s ../../per_gene/EOG091G0VNB/ALICUT_EOG091G0VNB.clustalo.fasta -n EOG091G0VNB.clustalo.aln.ALICUT.$RAxMLmodel 		1> ../../per_gene/EOG091G0VNB/infer_single_ML.stdout.txt 2> ../../per_gene/EOG091G0VNB/infer_single_ML.stderr.txt
	else
		echo "fasta file per_gene/EOG091G0VNB/ALICUT_EOG091G0VNB.clustalo.fasta contains fewer than 5 sequences - skipped" > ../../per_gene/EOG091G0VNB/infer_single_ML.stdout.txt
		touch raxml.skipped
	fi
        touch ../../per_gene/EOG091G0VNB/EOG091G0VNB.raxml.done
        
[Sun Jul  5 23:44:31 2020]
Finished job 705.
2390 of 3292 steps (73%) done

[Sun Jul  5 23:44:31 2020]
rule remove_empty:
    input: per_gene/EOG091G0M4K/ALICUT_EOG091G0M4K.clustalo.fasta
    output: per_gene/EOG091G0M4K/empty_check.done
    jobid: 1527
    wildcards: BUSCO=EOG091G0M4K


         if [ "$(cat per_gene/EOG091G0M4K/ALICUT_EOG091G0M4K.clustalo.fasta | grep -v ">" | sed 's/-//g' | grep "^$" | wc -l)" -gt 0 ]
         then
              cp per_gene/EOG091G0M4K/ALICUT_EOG091G0M4K.clustalo.fasta per_gene/EOG091G0M4K/ALICUT_EOG091G0M4K.clustalo.fasta.backup
              bash ../scripts/remove_empty.sh per_gene/EOG091G0M4K/ALICUT_EOG091G0M4K.clustalo.fasta.backup > per_gene/EOG091G0M4K/ALICUT_EOG091G0M4K.clustalo.fasta
         fi
         touch per_gene/EOG091G0M4K/empty_check.done
         
[Sun Jul  5 23:44:31 2020]
Finished job 1527.
2391 of 3292 steps (73%) done

[Sun Jul  5 23:44:31 2020]
rule find_best_model:
    input: per_gene/EOG091G0M4K/ALICUT_EOG091G0M4K.clustalo.fasta, per_gene/EOG091G0M4K/empty_check.done
    output: per_gene/EOG091G0M4K/EOG091G0M4K.best_model
    log: per_gene/EOG091G0M4K/find_best_model.stderr.txt
    jobid: 704
    wildcards: BUSCO=EOG091G0M4K
    threads: 2


        cd per_gene/EOG091G0M4K
        if [ ! -d find_best_model ]
        then
            mkdir find_best_model
        fi
        cd find_best_model
        ln -s ../../../per_gene/EOG091G0M4K/ALICUT_EOG091G0M4K.clustalo.fasta EOG091G0M4K.fasta
        ProteinModelSelection.pl EOG091G0M4K.fasta 1> ../../../per_gene/EOG091G0M4K/EOG091G0M4K.best_model 2> ../../../per_gene/EOG091G0M4K/find_best_model.stderr.txt
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/c0c09ee657b1e27f2c5687e0e9aa8d70.simg
[33mJob counts:
	count	jobs
	1	infer_single_ML
	1[0m
[33m
        cd per_gene/EOG091G0VNB
	count=$(cat ../../per_gene/EOG091G0VNB/ALICUT_EOG091G0VNB.clustalo.fasta | grep ">" | wc -l)
	if [ "$count" -gt 5 ]
        then
		RAxMLmodel=$(cat ../../per_gene/EOG091G0VNB/EOG091G0VNB.best_model | grep "Best" | cut -d ":" -f 2 | tr -d '[:space:]')
                if [ "$(ls -1 | grep "^RAxML" | wc -l)" -ne 0 ]
		then
			rm RAxML*
		fi
        	raxml -f a -T 2 -m PROTGAMMA$RAxMLmodel         	-p 12345 -x 12345 -# 100         	-s ../../per_gene/EOG091G0VNB/ALICUT_EOG091G0VNB.clustalo.fasta -n EOG091G0VNB.clustalo.aln.ALICUT.$RAxMLmodel 		1> ../../per_gene/EOG091G0VNB/infer_single_ML.stdout.txt 2> ../../per_gene/EOG091G0VNB/infer_single_ML.stderr.txt
	else
		echo "fasta file per_gene/EOG091G0VNB/ALICUT_EOG091G0VNB.clustalo.fasta contains fewer than 5 sequences - skipped" > ../../per_gene/EOG091G0VNB/infer_single_ML.stdout.txt
		touch raxml.skipped
	fi
        touch ../../per_gene/EOG091G0VNB/EOG091G0VNB.raxml.done
        [0m
[Sun Jul  5 23:44:36 2020]
Finished job 280.
2392 of 3292 steps (73%) done

[Sun Jul  5 23:44:36 2020]
rule get_seqs:
    input: /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ingroup.txt, /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/outgroup.txt
    output: per_gene/EOG091G0ILG/EOG091G0ILG.ingroup.fasta
    log: per_gene/EOG091G0ILG/get_seqs.stdout.txt, per_gene/EOG091G0ILG/get_seqs.stderr.txt
    jobid: 2714
    wildcards: BUSCO=EOG091G0ILG
    threads: 2


	basedir=$(pwd)
        cd per_gene/EOG091G0ILG
        
        bash $basedir/../scripts/fetch_seqs.sh EOG091G0ILG /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ingroup.txt /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/outgroup.txt 1> ../../per_gene/EOG091G0ILG/get_seqs.stdout.txt 2> ../../per_gene/EOG091G0ILG/get_seqs.stderr.txt
	mv EOG091G0ILG.fasta $basedir/per_gene/EOG091G0ILG/EOG091G0ILG.ingroup.fasta
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/72476f9d9a5bd0627b4d721143a21354.simg
[Sun Jul  5 23:44:39 2020]
Finished job 284.
2393 of 3292 steps (73%) done

[Sun Jul  5 23:44:39 2020]
rule get_seqs:
    input: /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ingroup.txt, /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/outgroup.txt
    output: per_gene/EOG091G0DTD/EOG091G0DTD.ingroup.fasta
    log: per_gene/EOG091G0DTD/get_seqs.stdout.txt, per_gene/EOG091G0DTD/get_seqs.stderr.txt
    jobid: 3186
    wildcards: BUSCO=EOG091G0DTD
    threads: 2


	basedir=$(pwd)
        cd per_gene/EOG091G0DTD
        
        bash $basedir/../scripts/fetch_seqs.sh EOG091G0DTD /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ingroup.txt /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/outgroup.txt 1> ../../per_gene/EOG091G0DTD/get_seqs.stdout.txt 2> ../../per_gene/EOG091G0DTD/get_seqs.stderr.txt
	mv EOG091G0DTD.fasta $basedir/per_gene/EOG091G0DTD/EOG091G0DTD.ingroup.fasta
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/72476f9d9a5bd0627b4d721143a21354.simg
[Sun Jul  5 23:44:48 2020]
Finished job 2714.
2394 of 3292 steps (73%) done

[Sun Jul  5 23:44:48 2020]
rule get_outgroups:
    input: per_gene/EOG091G0ILG/EOG091G0ILG.ingroup.fasta
    output: per_gene/EOG091G0ILG/EOG091G0ILG.orthodb.fasta, per_gene/EOG091G0ILG/EOG091G0ILG.outgroup.fasta
    log: per_gene/EOG091G0ILG/get_outgroups.stdout.txt, per_gene/EOG091G0ILG/get_outgroups.stderr.txt
    jobid: 2715
    wildcards: BUSCO=EOG091G0ILG


        #download fastas from Orhtodb for BUSCO id
        for i in {1..5}
        do
             wget "http://www.orthodb.org/fasta?query=EOG091G0ILG&level=33208" -O per_gene/EOG091G0ILG/EOG091G0ILG.orthodb.fasta 1> per_gene/EOG091G0ILG/get_outgroups.stdout.txt 2> per_gene/EOG091G0ILG/get_outgroups.stderr.txt && break || echo -e "try again ($i)" && sleep 15
        done

	#This is quick an dirty for now and just takes the first protein if there is more than one for an outgroup taxon
        bash ../scripts/download_outgroups.sh taxids.txt per_gene/EOG091G0ILG/EOG091G0ILG.orthodb.fasta > per_gene/EOG091G0ILG/EOG091G0ILG.outgroup.fasta
        
[Sun Jul  5 23:44:49 2020]
Finished job 2715.
2395 of 3292 steps (73%) done

[Sun Jul  5 23:44:49 2020]
rule join_groups:
    input: per_gene/EOG091G0ILG/EOG091G0ILG.ingroup.fasta, per_gene/EOG091G0ILG/EOG091G0ILG.outgroup.fasta
    output: per_gene/EOG091G0ILG/EOG091G0ILG.fasta
    jobid: 2181
    wildcards: BUSCO=EOG091G0ILG


        cat per_gene/EOG091G0ILG/EOG091G0ILG.ingroup.fasta per_gene/EOG091G0ILG/EOG091G0ILG.outgroup.fasta > per_gene/EOG091G0ILG/EOG091G0ILG.fasta
        
[Sun Jul  5 23:44:49 2020]
Finished job 2181.
2396 of 3292 steps (73%) done

[Sun Jul  5 23:44:49 2020]
rule MSA:
    input: per_gene/EOG091G0ILG/EOG091G0ILG.fasta
    output: per_gene/EOG091G0ILG/EOG091G0ILG.clustalo.fasta
    log: per_gene/EOG091G0ILG/MSA.stdout.txt, per_gene/EOG091G0ILG/MSA.stderr.txt
    jobid: 1482
    wildcards: BUSCO=EOG091G0ILG
    threads: 2


        clustalo -i per_gene/EOG091G0ILG/EOG091G0ILG.fasta -o per_gene/EOG091G0ILG/EOG091G0ILG.clustalo.fasta --threads=2 1> per_gene/EOG091G0ILG/MSA.stdout.txt 2> per_gene/EOG091G0ILG/MSA.stderr.txt
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/d68c9691725a7401923680874285c430.simg
[Sun Jul  5 23:44:50 2020]
Finished job 1482.
2397 of 3292 steps (73%) done

[Sun Jul  5 23:44:50 2020]
rule score_and_cut:
    input: per_gene/EOG091G0ILG/EOG091G0ILG.clustalo.fasta
    output: per_gene/EOG091G0ILG/ALICUT_EOG091G0ILG.clustalo.fasta
    jobid: 659
    wildcards: BUSCO=EOG091G0ILG
    threads: 2


        cd per_gene/EOG091G0ILG
        Aliscore.pl -N -r 200000000000000000 -i ../../per_gene/EOG091G0ILG/EOG091G0ILG.clustalo.fasta &> aliscore.log
        ALICUT.pl -s &> alicut.log
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/63c88c27a0fa300f57066b0ef65fefcb.simg
[Sun Jul  5 23:44:52 2020]
Finished job 3186.
2398 of 3292 steps (73%) done

[Sun Jul  5 23:44:52 2020]
rule get_outgroups:
    input: per_gene/EOG091G0DTD/EOG091G0DTD.ingroup.fasta
    output: per_gene/EOG091G0DTD/EOG091G0DTD.orthodb.fasta, per_gene/EOG091G0DTD/EOG091G0DTD.outgroup.fasta
    log: per_gene/EOG091G0DTD/get_outgroups.stdout.txt, per_gene/EOG091G0DTD/get_outgroups.stderr.txt
    jobid: 3187
    wildcards: BUSCO=EOG091G0DTD


        #download fastas from Orhtodb for BUSCO id
        for i in {1..5}
        do
             wget "http://www.orthodb.org/fasta?query=EOG091G0DTD&level=33208" -O per_gene/EOG091G0DTD/EOG091G0DTD.orthodb.fasta 1> per_gene/EOG091G0DTD/get_outgroups.stdout.txt 2> per_gene/EOG091G0DTD/get_outgroups.stderr.txt && break || echo -e "try again ($i)" && sleep 15
        done

	#This is quick an dirty for now and just takes the first protein if there is more than one for an outgroup taxon
        bash ../scripts/download_outgroups.sh taxids.txt per_gene/EOG091G0DTD/EOG091G0DTD.orthodb.fasta > per_gene/EOG091G0DTD/EOG091G0DTD.outgroup.fasta
        
[Sun Jul  5 23:44:53 2020]
Finished job 3187.
2399 of 3292 steps (73%) done

[Sun Jul  5 23:44:53 2020]
rule join_groups:
    input: per_gene/EOG091G0DTD/EOG091G0DTD.ingroup.fasta, per_gene/EOG091G0DTD/EOG091G0DTD.outgroup.fasta
    output: per_gene/EOG091G0DTD/EOG091G0DTD.fasta
    jobid: 2417
    wildcards: BUSCO=EOG091G0DTD


        cat per_gene/EOG091G0DTD/EOG091G0DTD.ingroup.fasta per_gene/EOG091G0DTD/EOG091G0DTD.outgroup.fasta > per_gene/EOG091G0DTD/EOG091G0DTD.fasta
        
[Sun Jul  5 23:44:53 2020]
Finished job 2417.
2400 of 3292 steps (73%) done

[Sun Jul  5 23:44:53 2020]
rule MSA:
    input: per_gene/EOG091G0DTD/EOG091G0DTD.fasta
    output: per_gene/EOG091G0DTD/EOG091G0DTD.clustalo.fasta
    log: per_gene/EOG091G0DTD/MSA.stdout.txt, per_gene/EOG091G0DTD/MSA.stderr.txt
    jobid: 1954
    wildcards: BUSCO=EOG091G0DTD
    threads: 2


        clustalo -i per_gene/EOG091G0DTD/EOG091G0DTD.fasta -o per_gene/EOG091G0DTD/EOG091G0DTD.clustalo.fasta --threads=2 1> per_gene/EOG091G0DTD/MSA.stdout.txt 2> per_gene/EOG091G0DTD/MSA.stderr.txt
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/d68c9691725a7401923680874285c430.simg
[Sun Jul  5 23:44:54 2020]
Finished job 1954.
2401 of 3292 steps (73%) done

[Sun Jul  5 23:44:54 2020]
rule score_and_cut:
    input: per_gene/EOG091G0DTD/EOG091G0DTD.clustalo.fasta
    output: per_gene/EOG091G0DTD/ALICUT_EOG091G0DTD.clustalo.fasta
    jobid: 1131
    wildcards: BUSCO=EOG091G0DTD
    threads: 2


        cd per_gene/EOG091G0DTD
        Aliscore.pl -N -r 200000000000000000 -i ../../per_gene/EOG091G0DTD/EOG091G0DTD.clustalo.fasta &> aliscore.log
        ALICUT.pl -s &> alicut.log
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/63c88c27a0fa300f57066b0ef65fefcb.simg
[Sun Jul  5 23:44:59 2020]
Finished job 659.
2402 of 3292 steps (73%) done

[Sun Jul  5 23:44:59 2020]
rule remove_empty:
    input: per_gene/EOG091G0ILG/ALICUT_EOG091G0ILG.clustalo.fasta
    output: per_gene/EOG091G0ILG/empty_check.done
    jobid: 1481
    wildcards: BUSCO=EOG091G0ILG


         if [ "$(cat per_gene/EOG091G0ILG/ALICUT_EOG091G0ILG.clustalo.fasta | grep -v ">" | sed 's/-//g' | grep "^$" | wc -l)" -gt 0 ]
         then
              cp per_gene/EOG091G0ILG/ALICUT_EOG091G0ILG.clustalo.fasta per_gene/EOG091G0ILG/ALICUT_EOG091G0ILG.clustalo.fasta.backup
              bash ../scripts/remove_empty.sh per_gene/EOG091G0ILG/ALICUT_EOG091G0ILG.clustalo.fasta.backup > per_gene/EOG091G0ILG/ALICUT_EOG091G0ILG.clustalo.fasta
         fi
         touch per_gene/EOG091G0ILG/empty_check.done
         
[Sun Jul  5 23:44:59 2020]
Finished job 1481.
2403 of 3292 steps (73%) done

[Sun Jul  5 23:44:59 2020]
rule find_best_model:
    input: per_gene/EOG091G0ILG/ALICUT_EOG091G0ILG.clustalo.fasta, per_gene/EOG091G0ILG/empty_check.done
    output: per_gene/EOG091G0ILG/EOG091G0ILG.best_model
    log: per_gene/EOG091G0ILG/find_best_model.stderr.txt
    jobid: 658
    wildcards: BUSCO=EOG091G0ILG
    threads: 2


        cd per_gene/EOG091G0ILG
        if [ ! -d find_best_model ]
        then
            mkdir find_best_model
        fi
        cd find_best_model
        ln -s ../../../per_gene/EOG091G0ILG/ALICUT_EOG091G0ILG.clustalo.fasta EOG091G0ILG.fasta
        ProteinModelSelection.pl EOG091G0ILG.fasta 1> ../../../per_gene/EOG091G0ILG/EOG091G0ILG.best_model 2> ../../../per_gene/EOG091G0ILG/find_best_model.stderr.txt
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/c0c09ee657b1e27f2c5687e0e9aa8d70.simg
[Sun Jul  5 23:45:02 2020]
Finished job 704.
2404 of 3292 steps (73%) done

[Sun Jul  5 23:45:02 2020]
rule infer_single_ML:
    input: per_gene/EOG091G0M4K/EOG091G0M4K.best_model, per_gene/EOG091G0M4K/ALICUT_EOG091G0M4K.clustalo.fasta
    output: per_gene/EOG091G0M4K/EOG091G0M4K.raxml.done
    log: per_gene/EOG091G0M4K/infer_single_ML.stdout.txt, per_gene/EOG091G0M4K/infer_single_ML.stderr.txt
    jobid: 146
    wildcards: BUSCO=EOG091G0M4K
    threads: 2


        cd per_gene/EOG091G0M4K
	count=$(cat ../../per_gene/EOG091G0M4K/ALICUT_EOG091G0M4K.clustalo.fasta | grep ">" | wc -l)
	if [ "$count" -gt 5 ]
        then
		RAxMLmodel=$(cat ../../per_gene/EOG091G0M4K/EOG091G0M4K.best_model | grep "Best" | cut -d ":" -f 2 | tr -d '[:space:]')
                if [ "$(ls -1 | grep "^RAxML" | wc -l)" -ne 0 ]
		then
			rm RAxML*
		fi
        	raxml -f a -T 2 -m PROTGAMMA$RAxMLmodel         	-p 12345 -x 12345 -# 100         	-s ../../per_gene/EOG091G0M4K/ALICUT_EOG091G0M4K.clustalo.fasta -n EOG091G0M4K.clustalo.aln.ALICUT.$RAxMLmodel 		1> ../../per_gene/EOG091G0M4K/infer_single_ML.stdout.txt 2> ../../per_gene/EOG091G0M4K/infer_single_ML.stderr.txt
	else
		echo "fasta file per_gene/EOG091G0M4K/ALICUT_EOG091G0M4K.clustalo.fasta contains fewer than 5 sequences - skipped" > ../../per_gene/EOG091G0M4K/infer_single_ML.stdout.txt
		touch raxml.skipped
	fi
        touch ../../per_gene/EOG091G0M4K/EOG091G0M4K.raxml.done
        
[Sun Jul  5 23:45:03 2020]
Finished job 4.
2405 of 3292 steps (73%) done

[Sun Jul  5 23:45:03 2020]
rule get_seqs:
    input: /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ingroup.txt, /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/outgroup.txt
    output: per_gene/EOG091G0K6O/EOG091G0K6O.ingroup.fasta
    log: per_gene/EOG091G0K6O/get_seqs.stdout.txt, per_gene/EOG091G0K6O/get_seqs.stderr.txt
    jobid: 2992
    wildcards: BUSCO=EOG091G0K6O
    threads: 2


	basedir=$(pwd)
        cd per_gene/EOG091G0K6O
        
        bash $basedir/../scripts/fetch_seqs.sh EOG091G0K6O /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ingroup.txt /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/outgroup.txt 1> ../../per_gene/EOG091G0K6O/get_seqs.stdout.txt 2> ../../per_gene/EOG091G0K6O/get_seqs.stderr.txt
	mv EOG091G0K6O.fasta $basedir/per_gene/EOG091G0K6O/EOG091G0K6O.ingroup.fasta
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/72476f9d9a5bd0627b4d721143a21354.simg
[Sun Jul  5 23:45:04 2020]
Finished job 1131.
2406 of 3292 steps (73%) done

[Sun Jul  5 23:45:04 2020]
rule remove_empty:
    input: per_gene/EOG091G0DTD/ALICUT_EOG091G0DTD.clustalo.fasta
    output: per_gene/EOG091G0DTD/empty_check.done
    jobid: 1953
    wildcards: BUSCO=EOG091G0DTD


         if [ "$(cat per_gene/EOG091G0DTD/ALICUT_EOG091G0DTD.clustalo.fasta | grep -v ">" | sed 's/-//g' | grep "^$" | wc -l)" -gt 0 ]
         then
              cp per_gene/EOG091G0DTD/ALICUT_EOG091G0DTD.clustalo.fasta per_gene/EOG091G0DTD/ALICUT_EOG091G0DTD.clustalo.fasta.backup
              bash ../scripts/remove_empty.sh per_gene/EOG091G0DTD/ALICUT_EOG091G0DTD.clustalo.fasta.backup > per_gene/EOG091G0DTD/ALICUT_EOG091G0DTD.clustalo.fasta
         fi
         touch per_gene/EOG091G0DTD/empty_check.done
         
[Sun Jul  5 23:45:04 2020]
Finished job 1953.
2407 of 3292 steps (73%) done

[Sun Jul  5 23:45:04 2020]
rule find_best_model:
    input: per_gene/EOG091G0DTD/ALICUT_EOG091G0DTD.clustalo.fasta, per_gene/EOG091G0DTD/empty_check.done
    output: per_gene/EOG091G0DTD/EOG091G0DTD.best_model
    log: per_gene/EOG091G0DTD/find_best_model.stderr.txt
    jobid: 1130
    wildcards: BUSCO=EOG091G0DTD
    threads: 2


        cd per_gene/EOG091G0DTD
        if [ ! -d find_best_model ]
        then
            mkdir find_best_model
        fi
        cd find_best_model
        ln -s ../../../per_gene/EOG091G0DTD/ALICUT_EOG091G0DTD.clustalo.fasta EOG091G0DTD.fasta
        ProteinModelSelection.pl EOG091G0DTD.fasta 1> ../../../per_gene/EOG091G0DTD/EOG091G0DTD.best_model 2> ../../../per_gene/EOG091G0DTD/find_best_model.stderr.txt
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/c0c09ee657b1e27f2c5687e0e9aa8d70.simg
[33mJob counts:
	count	jobs
	1	infer_single_ML
	1[0m
[33m
        cd per_gene/EOG091G0M4K
	count=$(cat ../../per_gene/EOG091G0M4K/ALICUT_EOG091G0M4K.clustalo.fasta | grep ">" | wc -l)
	if [ "$count" -gt 5 ]
        then
		RAxMLmodel=$(cat ../../per_gene/EOG091G0M4K/EOG091G0M4K.best_model | grep "Best" | cut -d ":" -f 2 | tr -d '[:space:]')
                if [ "$(ls -1 | grep "^RAxML" | wc -l)" -ne 0 ]
		then
			rm RAxML*
		fi
        	raxml -f a -T 2 -m PROTGAMMA$RAxMLmodel         	-p 12345 -x 12345 -# 100         	-s ../../per_gene/EOG091G0M4K/ALICUT_EOG091G0M4K.clustalo.fasta -n EOG091G0M4K.clustalo.aln.ALICUT.$RAxMLmodel 		1> ../../per_gene/EOG091G0M4K/infer_single_ML.stdout.txt 2> ../../per_gene/EOG091G0M4K/infer_single_ML.stderr.txt
	else
		echo "fasta file per_gene/EOG091G0M4K/ALICUT_EOG091G0M4K.clustalo.fasta contains fewer than 5 sequences - skipped" > ../../per_gene/EOG091G0M4K/infer_single_ML.stdout.txt
		touch raxml.skipped
	fi
        touch ../../per_gene/EOG091G0M4K/EOG091G0M4K.raxml.done
        [0m
[Sun Jul  5 23:45:16 2020]
Finished job 2992.
2408 of 3292 steps (73%) done

[Sun Jul  5 23:45:16 2020]
rule get_outgroups:
    input: per_gene/EOG091G0K6O/EOG091G0K6O.ingroup.fasta
    output: per_gene/EOG091G0K6O/EOG091G0K6O.orthodb.fasta, per_gene/EOG091G0K6O/EOG091G0K6O.outgroup.fasta
    log: per_gene/EOG091G0K6O/get_outgroups.stdout.txt, per_gene/EOG091G0K6O/get_outgroups.stderr.txt
    jobid: 2993
    wildcards: BUSCO=EOG091G0K6O


        #download fastas from Orhtodb for BUSCO id
        for i in {1..5}
        do
             wget "http://www.orthodb.org/fasta?query=EOG091G0K6O&level=33208" -O per_gene/EOG091G0K6O/EOG091G0K6O.orthodb.fasta 1> per_gene/EOG091G0K6O/get_outgroups.stdout.txt 2> per_gene/EOG091G0K6O/get_outgroups.stderr.txt && break || echo -e "try again ($i)" && sleep 15
        done

	#This is quick an dirty for now and just takes the first protein if there is more than one for an outgroup taxon
        bash ../scripts/download_outgroups.sh taxids.txt per_gene/EOG091G0K6O/EOG091G0K6O.orthodb.fasta > per_gene/EOG091G0K6O/EOG091G0K6O.outgroup.fasta
        
[Sun Jul  5 23:45:17 2020]
Finished job 2993.
2409 of 3292 steps (73%) done

[Sun Jul  5 23:45:17 2020]
rule join_groups:
    input: per_gene/EOG091G0K6O/EOG091G0K6O.ingroup.fasta, per_gene/EOG091G0K6O/EOG091G0K6O.outgroup.fasta
    output: per_gene/EOG091G0K6O/EOG091G0K6O.fasta
    jobid: 2320
    wildcards: BUSCO=EOG091G0K6O


        cat per_gene/EOG091G0K6O/EOG091G0K6O.ingroup.fasta per_gene/EOG091G0K6O/EOG091G0K6O.outgroup.fasta > per_gene/EOG091G0K6O/EOG091G0K6O.fasta
        
[Sun Jul  5 23:45:17 2020]
Finished job 2320.
2410 of 3292 steps (73%) done

[Sun Jul  5 23:45:17 2020]
rule MSA:
    input: per_gene/EOG091G0K6O/EOG091G0K6O.fasta
    output: per_gene/EOG091G0K6O/EOG091G0K6O.clustalo.fasta
    log: per_gene/EOG091G0K6O/MSA.stdout.txt, per_gene/EOG091G0K6O/MSA.stderr.txt
    jobid: 1760
    wildcards: BUSCO=EOG091G0K6O
    threads: 2


        clustalo -i per_gene/EOG091G0K6O/EOG091G0K6O.fasta -o per_gene/EOG091G0K6O/EOG091G0K6O.clustalo.fasta --threads=2 1> per_gene/EOG091G0K6O/MSA.stdout.txt 2> per_gene/EOG091G0K6O/MSA.stderr.txt
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/d68c9691725a7401923680874285c430.simg
[Sun Jul  5 23:45:18 2020]
Finished job 1760.
2411 of 3292 steps (73%) done

[Sun Jul  5 23:45:18 2020]
rule score_and_cut:
    input: per_gene/EOG091G0K6O/EOG091G0K6O.clustalo.fasta
    output: per_gene/EOG091G0K6O/ALICUT_EOG091G0K6O.clustalo.fasta
    jobid: 937
    wildcards: BUSCO=EOG091G0K6O
    threads: 2


        cd per_gene/EOG091G0K6O
        Aliscore.pl -N -r 200000000000000000 -i ../../per_gene/EOG091G0K6O/EOG091G0K6O.clustalo.fasta &> aliscore.log
        ALICUT.pl -s &> alicut.log
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/63c88c27a0fa300f57066b0ef65fefcb.simg
[Sun Jul  5 23:45:28 2020]
Finished job 937.
2412 of 3292 steps (73%) done

[Sun Jul  5 23:45:28 2020]
rule remove_empty:
    input: per_gene/EOG091G0K6O/ALICUT_EOG091G0K6O.clustalo.fasta
    output: per_gene/EOG091G0K6O/empty_check.done
    jobid: 1759
    wildcards: BUSCO=EOG091G0K6O


         if [ "$(cat per_gene/EOG091G0K6O/ALICUT_EOG091G0K6O.clustalo.fasta | grep -v ">" | sed 's/-//g' | grep "^$" | wc -l)" -gt 0 ]
         then
              cp per_gene/EOG091G0K6O/ALICUT_EOG091G0K6O.clustalo.fasta per_gene/EOG091G0K6O/ALICUT_EOG091G0K6O.clustalo.fasta.backup
              bash ../scripts/remove_empty.sh per_gene/EOG091G0K6O/ALICUT_EOG091G0K6O.clustalo.fasta.backup > per_gene/EOG091G0K6O/ALICUT_EOG091G0K6O.clustalo.fasta
         fi
         touch per_gene/EOG091G0K6O/empty_check.done
         
[Sun Jul  5 23:45:30 2020]
Finished job 1759.
2413 of 3292 steps (73%) done

[Sun Jul  5 23:45:30 2020]
rule find_best_model:
    input: per_gene/EOG091G0K6O/ALICUT_EOG091G0K6O.clustalo.fasta, per_gene/EOG091G0K6O/empty_check.done
    output: per_gene/EOG091G0K6O/EOG091G0K6O.best_model
    log: per_gene/EOG091G0K6O/find_best_model.stderr.txt
    jobid: 936
    wildcards: BUSCO=EOG091G0K6O
    threads: 2


        cd per_gene/EOG091G0K6O
        if [ ! -d find_best_model ]
        then
            mkdir find_best_model
        fi
        cd find_best_model
        ln -s ../../../per_gene/EOG091G0K6O/ALICUT_EOG091G0K6O.clustalo.fasta EOG091G0K6O.fasta
        ProteinModelSelection.pl EOG091G0K6O.fasta 1> ../../../per_gene/EOG091G0K6O/EOG091G0K6O.best_model 2> ../../../per_gene/EOG091G0K6O/find_best_model.stderr.txt
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/c0c09ee657b1e27f2c5687e0e9aa8d70.simg
[Sun Jul  5 23:45:30 2020]
Finished job 658.
2414 of 3292 steps (73%) done

[Sun Jul  5 23:45:30 2020]
rule infer_single_ML:
    input: per_gene/EOG091G0ILG/EOG091G0ILG.best_model, per_gene/EOG091G0ILG/ALICUT_EOG091G0ILG.clustalo.fasta
    output: per_gene/EOG091G0ILG/EOG091G0ILG.raxml.done
    log: per_gene/EOG091G0ILG/infer_single_ML.stdout.txt, per_gene/EOG091G0ILG/infer_single_ML.stderr.txt
    jobid: 123
    wildcards: BUSCO=EOG091G0ILG
    threads: 2


        cd per_gene/EOG091G0ILG
	count=$(cat ../../per_gene/EOG091G0ILG/ALICUT_EOG091G0ILG.clustalo.fasta | grep ">" | wc -l)
	if [ "$count" -gt 5 ]
        then
		RAxMLmodel=$(cat ../../per_gene/EOG091G0ILG/EOG091G0ILG.best_model | grep "Best" | cut -d ":" -f 2 | tr -d '[:space:]')
                if [ "$(ls -1 | grep "^RAxML" | wc -l)" -ne 0 ]
		then
			rm RAxML*
		fi
        	raxml -f a -T 2 -m PROTGAMMA$RAxMLmodel         	-p 12345 -x 12345 -# 100         	-s ../../per_gene/EOG091G0ILG/ALICUT_EOG091G0ILG.clustalo.fasta -n EOG091G0ILG.clustalo.aln.ALICUT.$RAxMLmodel 		1> ../../per_gene/EOG091G0ILG/infer_single_ML.stdout.txt 2> ../../per_gene/EOG091G0ILG/infer_single_ML.stderr.txt
	else
		echo "fasta file per_gene/EOG091G0ILG/ALICUT_EOG091G0ILG.clustalo.fasta contains fewer than 5 sequences - skipped" > ../../per_gene/EOG091G0ILG/infer_single_ML.stdout.txt
		touch raxml.skipped
	fi
        touch ../../per_gene/EOG091G0ILG/EOG091G0ILG.raxml.done
        
[33mJob counts:
	count	jobs
	1	infer_single_ML
	1[0m
[33m
        cd per_gene/EOG091G0ILG
	count=$(cat ../../per_gene/EOG091G0ILG/ALICUT_EOG091G0ILG.clustalo.fasta | grep ">" | wc -l)
	if [ "$count" -gt 5 ]
        then
		RAxMLmodel=$(cat ../../per_gene/EOG091G0ILG/EOG091G0ILG.best_model | grep "Best" | cut -d ":" -f 2 | tr -d '[:space:]')
                if [ "$(ls -1 | grep "^RAxML" | wc -l)" -ne 0 ]
		then
			rm RAxML*
		fi
        	raxml -f a -T 2 -m PROTGAMMA$RAxMLmodel         	-p 12345 -x 12345 -# 100         	-s ../../per_gene/EOG091G0ILG/ALICUT_EOG091G0ILG.clustalo.fasta -n EOG091G0ILG.clustalo.aln.ALICUT.$RAxMLmodel 		1> ../../per_gene/EOG091G0ILG/infer_single_ML.stdout.txt 2> ../../per_gene/EOG091G0ILG/infer_single_ML.stderr.txt
	else
		echo "fasta file per_gene/EOG091G0ILG/ALICUT_EOG091G0ILG.clustalo.fasta contains fewer than 5 sequences - skipped" > ../../per_gene/EOG091G0ILG/infer_single_ML.stdout.txt
		touch raxml.skipped
	fi
        touch ../../per_gene/EOG091G0ILG/EOG091G0ILG.raxml.done
        [0m
[Sun Jul  5 23:45:40 2020]
Finished job 1130.
2415 of 3292 steps (73%) done

[Sun Jul  5 23:45:40 2020]
rule infer_single_ML:
    input: per_gene/EOG091G0DTD/EOG091G0DTD.best_model, per_gene/EOG091G0DTD/ALICUT_EOG091G0DTD.clustalo.fasta
    output: per_gene/EOG091G0DTD/EOG091G0DTD.raxml.done
    log: per_gene/EOG091G0DTD/infer_single_ML.stdout.txt, per_gene/EOG091G0DTD/infer_single_ML.stderr.txt
    jobid: 359
    wildcards: BUSCO=EOG091G0DTD
    threads: 2


        cd per_gene/EOG091G0DTD
	count=$(cat ../../per_gene/EOG091G0DTD/ALICUT_EOG091G0DTD.clustalo.fasta | grep ">" | wc -l)
	if [ "$count" -gt 5 ]
        then
		RAxMLmodel=$(cat ../../per_gene/EOG091G0DTD/EOG091G0DTD.best_model | grep "Best" | cut -d ":" -f 2 | tr -d '[:space:]')
                if [ "$(ls -1 | grep "^RAxML" | wc -l)" -ne 0 ]
		then
			rm RAxML*
		fi
        	raxml -f a -T 2 -m PROTGAMMA$RAxMLmodel         	-p 12345 -x 12345 -# 100         	-s ../../per_gene/EOG091G0DTD/ALICUT_EOG091G0DTD.clustalo.fasta -n EOG091G0DTD.clustalo.aln.ALICUT.$RAxMLmodel 		1> ../../per_gene/EOG091G0DTD/infer_single_ML.stdout.txt 2> ../../per_gene/EOG091G0DTD/infer_single_ML.stderr.txt
	else
		echo "fasta file per_gene/EOG091G0DTD/ALICUT_EOG091G0DTD.clustalo.fasta contains fewer than 5 sequences - skipped" > ../../per_gene/EOG091G0DTD/infer_single_ML.stdout.txt
		touch raxml.skipped
	fi
        touch ../../per_gene/EOG091G0DTD/EOG091G0DTD.raxml.done
        
[33mJob counts:
	count	jobs
	1	infer_single_ML
	1[0m
[33m
        cd per_gene/EOG091G0DTD
	count=$(cat ../../per_gene/EOG091G0DTD/ALICUT_EOG091G0DTD.clustalo.fasta | grep ">" | wc -l)
	if [ "$count" -gt 5 ]
        then
		RAxMLmodel=$(cat ../../per_gene/EOG091G0DTD/EOG091G0DTD.best_model | grep "Best" | cut -d ":" -f 2 | tr -d '[:space:]')
                if [ "$(ls -1 | grep "^RAxML" | wc -l)" -ne 0 ]
		then
			rm RAxML*
		fi
        	raxml -f a -T 2 -m PROTGAMMA$RAxMLmodel         	-p 12345 -x 12345 -# 100         	-s ../../per_gene/EOG091G0DTD/ALICUT_EOG091G0DTD.clustalo.fasta -n EOG091G0DTD.clustalo.aln.ALICUT.$RAxMLmodel 		1> ../../per_gene/EOG091G0DTD/infer_single_ML.stdout.txt 2> ../../per_gene/EOG091G0DTD/infer_single_ML.stderr.txt
	else
		echo "fasta file per_gene/EOG091G0DTD/ALICUT_EOG091G0DTD.clustalo.fasta contains fewer than 5 sequences - skipped" > ../../per_gene/EOG091G0DTD/infer_single_ML.stdout.txt
		touch raxml.skipped
	fi
        touch ../../per_gene/EOG091G0DTD/EOG091G0DTD.raxml.done
        [0m
[Sun Jul  5 23:45:52 2020]
Finished job 936.
2416 of 3292 steps (73%) done

[Sun Jul  5 23:45:52 2020]
rule infer_single_ML:
    input: per_gene/EOG091G0K6O/EOG091G0K6O.best_model, per_gene/EOG091G0K6O/ALICUT_EOG091G0K6O.clustalo.fasta
    output: per_gene/EOG091G0K6O/EOG091G0K6O.raxml.done
    log: per_gene/EOG091G0K6O/infer_single_ML.stdout.txt, per_gene/EOG091G0K6O/infer_single_ML.stderr.txt
    jobid: 262
    wildcards: BUSCO=EOG091G0K6O
    threads: 2


        cd per_gene/EOG091G0K6O
	count=$(cat ../../per_gene/EOG091G0K6O/ALICUT_EOG091G0K6O.clustalo.fasta | grep ">" | wc -l)
	if [ "$count" -gt 5 ]
        then
		RAxMLmodel=$(cat ../../per_gene/EOG091G0K6O/EOG091G0K6O.best_model | grep "Best" | cut -d ":" -f 2 | tr -d '[:space:]')
                if [ "$(ls -1 | grep "^RAxML" | wc -l)" -ne 0 ]
		then
			rm RAxML*
		fi
        	raxml -f a -T 2 -m PROTGAMMA$RAxMLmodel         	-p 12345 -x 12345 -# 100         	-s ../../per_gene/EOG091G0K6O/ALICUT_EOG091G0K6O.clustalo.fasta -n EOG091G0K6O.clustalo.aln.ALICUT.$RAxMLmodel 		1> ../../per_gene/EOG091G0K6O/infer_single_ML.stdout.txt 2> ../../per_gene/EOG091G0K6O/infer_single_ML.stderr.txt
	else
		echo "fasta file per_gene/EOG091G0K6O/ALICUT_EOG091G0K6O.clustalo.fasta contains fewer than 5 sequences - skipped" > ../../per_gene/EOG091G0K6O/infer_single_ML.stdout.txt
		touch raxml.skipped
	fi
        touch ../../per_gene/EOG091G0K6O/EOG091G0K6O.raxml.done
        
[33mJob counts:
	count	jobs
	1	infer_single_ML
	1[0m
[33m
        cd per_gene/EOG091G0K6O
	count=$(cat ../../per_gene/EOG091G0K6O/ALICUT_EOG091G0K6O.clustalo.fasta | grep ">" | wc -l)
	if [ "$count" -gt 5 ]
        then
		RAxMLmodel=$(cat ../../per_gene/EOG091G0K6O/EOG091G0K6O.best_model | grep "Best" | cut -d ":" -f 2 | tr -d '[:space:]')
                if [ "$(ls -1 | grep "^RAxML" | wc -l)" -ne 0 ]
		then
			rm RAxML*
		fi
        	raxml -f a -T 2 -m PROTGAMMA$RAxMLmodel         	-p 12345 -x 12345 -# 100         	-s ../../per_gene/EOG091G0K6O/ALICUT_EOG091G0K6O.clustalo.fasta -n EOG091G0K6O.clustalo.aln.ALICUT.$RAxMLmodel 		1> ../../per_gene/EOG091G0K6O/infer_single_ML.stdout.txt 2> ../../per_gene/EOG091G0K6O/infer_single_ML.stderr.txt
	else
		echo "fasta file per_gene/EOG091G0K6O/ALICUT_EOG091G0K6O.clustalo.fasta contains fewer than 5 sequences - skipped" > ../../per_gene/EOG091G0K6O/infer_single_ML.stdout.txt
		touch raxml.skipped
	fi
        touch ../../per_gene/EOG091G0K6O/EOG091G0K6O.raxml.done
        [0m
[Sun Jul  5 23:45:54 2020]
Finished job 388.
2417 of 3292 steps (73%) done

[Sun Jul  5 23:45:54 2020]
rule get_seqs:
    input: /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ingroup.txt, /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/outgroup.txt
    output: per_gene/EOG091G07CE/EOG091G07CE.ingroup.fasta
    log: per_gene/EOG091G07CE/get_seqs.stdout.txt, per_gene/EOG091G07CE/get_seqs.stderr.txt
    jobid: 3152
    wildcards: BUSCO=EOG091G07CE
    threads: 2


	basedir=$(pwd)
        cd per_gene/EOG091G07CE
        
        bash $basedir/../scripts/fetch_seqs.sh EOG091G07CE /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ingroup.txt /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/outgroup.txt 1> ../../per_gene/EOG091G07CE/get_seqs.stdout.txt 2> ../../per_gene/EOG091G07CE/get_seqs.stderr.txt
	mv EOG091G07CE.fasta $basedir/per_gene/EOG091G07CE/EOG091G07CE.ingroup.fasta
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/72476f9d9a5bd0627b4d721143a21354.simg
[Sun Jul  5 23:45:55 2020]
Finished job 356.
2418 of 3292 steps (73%) done

[Sun Jul  5 23:45:55 2020]
rule get_seqs:
    input: /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ingroup.txt, /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/outgroup.txt
    output: per_gene/EOG091G134K/EOG091G134K.ingroup.fasta
    log: per_gene/EOG091G134K/get_seqs.stdout.txt, per_gene/EOG091G134K/get_seqs.stderr.txt
    jobid: 3044
    wildcards: BUSCO=EOG091G134K
    threads: 2


	basedir=$(pwd)
        cd per_gene/EOG091G134K
        
        bash $basedir/../scripts/fetch_seqs.sh EOG091G134K /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ingroup.txt /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/outgroup.txt 1> ../../per_gene/EOG091G134K/get_seqs.stdout.txt 2> ../../per_gene/EOG091G134K/get_seqs.stderr.txt
	mv EOG091G134K.fasta $basedir/per_gene/EOG091G134K/EOG091G134K.ingroup.fasta
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/72476f9d9a5bd0627b4d721143a21354.simg
[Sun Jul  5 23:46:07 2020]
Finished job 3152.
2419 of 3292 steps (73%) done

[Sun Jul  5 23:46:07 2020]
rule get_outgroups:
    input: per_gene/EOG091G07CE/EOG091G07CE.ingroup.fasta
    output: per_gene/EOG091G07CE/EOG091G07CE.orthodb.fasta, per_gene/EOG091G07CE/EOG091G07CE.outgroup.fasta
    log: per_gene/EOG091G07CE/get_outgroups.stdout.txt, per_gene/EOG091G07CE/get_outgroups.stderr.txt
    jobid: 3153
    wildcards: BUSCO=EOG091G07CE


        #download fastas from Orhtodb for BUSCO id
        for i in {1..5}
        do
             wget "http://www.orthodb.org/fasta?query=EOG091G07CE&level=33208" -O per_gene/EOG091G07CE/EOG091G07CE.orthodb.fasta 1> per_gene/EOG091G07CE/get_outgroups.stdout.txt 2> per_gene/EOG091G07CE/get_outgroups.stderr.txt && break || echo -e "try again ($i)" && sleep 15
        done

	#This is quick an dirty for now and just takes the first protein if there is more than one for an outgroup taxon
        bash ../scripts/download_outgroups.sh taxids.txt per_gene/EOG091G07CE/EOG091G07CE.orthodb.fasta > per_gene/EOG091G07CE/EOG091G07CE.outgroup.fasta
        
[Sun Jul  5 23:46:08 2020]
Finished job 3153.
2420 of 3292 steps (74%) done

[Sun Jul  5 23:46:08 2020]
rule join_groups:
    input: per_gene/EOG091G07CE/EOG091G07CE.ingroup.fasta, per_gene/EOG091G07CE/EOG091G07CE.outgroup.fasta
    output: per_gene/EOG091G07CE/EOG091G07CE.fasta
    jobid: 2400
    wildcards: BUSCO=EOG091G07CE


        cat per_gene/EOG091G07CE/EOG091G07CE.ingroup.fasta per_gene/EOG091G07CE/EOG091G07CE.outgroup.fasta > per_gene/EOG091G07CE/EOG091G07CE.fasta
        
[Sun Jul  5 23:46:08 2020]
Finished job 3044.
2421 of 3292 steps (74%) done

[Sun Jul  5 23:46:08 2020]
rule get_seqs:
    input: /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ingroup.txt, /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/outgroup.txt
    output: per_gene/EOG091G0TZX/EOG091G0TZX.ingroup.fasta
    log: per_gene/EOG091G0TZX/get_seqs.stdout.txt, per_gene/EOG091G0TZX/get_seqs.stderr.txt
    jobid: 2862
    wildcards: BUSCO=EOG091G0TZX
    threads: 2


	basedir=$(pwd)
        cd per_gene/EOG091G0TZX
        
        bash $basedir/../scripts/fetch_seqs.sh EOG091G0TZX /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ingroup.txt /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/outgroup.txt 1> ../../per_gene/EOG091G0TZX/get_seqs.stdout.txt 2> ../../per_gene/EOG091G0TZX/get_seqs.stderr.txt
	mv EOG091G0TZX.fasta $basedir/per_gene/EOG091G0TZX/EOG091G0TZX.ingroup.fasta
        

[Sun Jul  5 23:46:08 2020]
[Sun Jul  5 23:46:08 2020]
Finished job 2400.
rule get_outgroups:
    input: per_gene/EOG091G134K/EOG091G134K.ingroup.fasta
    output: per_gene/EOG091G134K/EOG091G134K.orthodb.fasta, per_gene/EOG091G134K/EOG091G134K.outgroup.fasta
    log: per_gene/EOG091G134K/get_outgroups.stdout.txt, per_gene/EOG091G134K/get_outgroups.stderr.txt
    jobid: 3045
    wildcards: BUSCO=EOG091G134K
2422 of 3292 steps (74%) done

Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/72476f9d9a5bd0627b4d721143a21354.simg

        #download fastas from Orhtodb for BUSCO id
        for i in {1..5}
        do
             wget "http://www.orthodb.org/fasta?query=EOG091G134K&level=33208" -O per_gene/EOG091G134K/EOG091G134K.orthodb.fasta 1> per_gene/EOG091G134K/get_outgroups.stdout.txt 2> per_gene/EOG091G134K/get_outgroups.stderr.txt && break || echo -e "try again ($i)" && sleep 15
        done

	#This is quick an dirty for now and just takes the first protein if there is more than one for an outgroup taxon
        bash ../scripts/download_outgroups.sh taxids.txt per_gene/EOG091G134K/EOG091G134K.orthodb.fasta > per_gene/EOG091G134K/EOG091G134K.outgroup.fasta
        
[Sun Jul  5 23:46:09 2020]
Finished job 3045.
2423 of 3292 steps (74%) done

[Sun Jul  5 23:46:09 2020]
rule MSA:
    input: per_gene/EOG091G07CE/EOG091G07CE.fasta
    output: per_gene/EOG091G07CE/EOG091G07CE.clustalo.fasta
    log: per_gene/EOG091G07CE/MSA.stdout.txt, per_gene/EOG091G07CE/MSA.stderr.txt
    jobid: 1920
    wildcards: BUSCO=EOG091G07CE
    threads: 2


        clustalo -i per_gene/EOG091G07CE/EOG091G07CE.fasta -o per_gene/EOG091G07CE/EOG091G07CE.clustalo.fasta --threads=2 1> per_gene/EOG091G07CE/MSA.stdout.txt 2> per_gene/EOG091G07CE/MSA.stderr.txt
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/d68c9691725a7401923680874285c430.simg
[Sun Jul  5 23:46:11 2020]
Finished job 1920.
2424 of 3292 steps (74%) done
[Sun Jul  5 23:46:11 2020]
Finished job 128.
2425 of 3292 steps (74%) done

[Sun Jul  5 23:46:11 2020]
rule join_groups:
    input: per_gene/EOG091G134K/EOG091G134K.ingroup.fasta, per_gene/EOG091G134K/EOG091G134K.outgroup.fasta
    output: per_gene/EOG091G134K/EOG091G134K.fasta
    jobid: 2346
    wildcards: BUSCO=EOG091G134K


        cat per_gene/EOG091G134K/EOG091G134K.ingroup.fasta per_gene/EOG091G134K/EOG091G134K.outgroup.fasta > per_gene/EOG091G134K/EOG091G134K.fasta
        

[Sun Jul  5 23:46:11 2020]
rule score_and_cut:
    input: per_gene/EOG091G07CE/EOG091G07CE.clustalo.fasta
    output: per_gene/EOG091G07CE/ALICUT_EOG091G07CE.clustalo.fasta
    jobid: 1097
    wildcards: BUSCO=EOG091G07CE
    threads: 2


        cd per_gene/EOG091G07CE
        Aliscore.pl -N -r 200000000000000000 -i ../../per_gene/EOG091G07CE/EOG091G07CE.clustalo.fasta &> aliscore.log
        ALICUT.pl -s &> alicut.log
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/63c88c27a0fa300f57066b0ef65fefcb.simg
[Sun Jul  5 23:46:11 2020]
Finished job 2346.
2426 of 3292 steps (74%) done

[Sun Jul  5 23:46:11 2020]
rule MSA:
    input: per_gene/EOG091G134K/EOG091G134K.fasta
    output: per_gene/EOG091G134K/EOG091G134K.clustalo.fasta
    log: per_gene/EOG091G134K/MSA.stdout.txt, per_gene/EOG091G134K/MSA.stderr.txt
    jobid: 1812
    wildcards: BUSCO=EOG091G134K
    threads: 2


        clustalo -i per_gene/EOG091G134K/EOG091G134K.fasta -o per_gene/EOG091G134K/EOG091G134K.clustalo.fasta --threads=2 1> per_gene/EOG091G134K/MSA.stdout.txt 2> per_gene/EOG091G134K/MSA.stderr.txt
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/d68c9691725a7401923680874285c430.simg
[Sun Jul  5 23:46:12 2020]
Finished job 1812.
2427 of 3292 steps (74%) done

[Sun Jul  5 23:46:12 2020]
rule score_and_cut:
    input: per_gene/EOG091G134K/EOG091G134K.clustalo.fasta
    output: per_gene/EOG091G134K/ALICUT_EOG091G134K.clustalo.fasta
    jobid: 989
    wildcards: BUSCO=EOG091G134K
    threads: 2


        cd per_gene/EOG091G134K
        Aliscore.pl -N -r 200000000000000000 -i ../../per_gene/EOG091G134K/EOG091G134K.clustalo.fasta &> aliscore.log
        ALICUT.pl -s &> alicut.log
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/63c88c27a0fa300f57066b0ef65fefcb.simg
[Sun Jul  5 23:46:21 2020]
Finished job 989.
2428 of 3292 steps (74%) done

[Sun Jul  5 23:46:21 2020]
rule remove_empty:
    input: per_gene/EOG091G134K/ALICUT_EOG091G134K.clustalo.fasta
    output: per_gene/EOG091G134K/empty_check.done
    jobid: 1811
    wildcards: BUSCO=EOG091G134K


         if [ "$(cat per_gene/EOG091G134K/ALICUT_EOG091G134K.clustalo.fasta | grep -v ">" | sed 's/-//g' | grep "^$" | wc -l)" -gt 0 ]
         then
              cp per_gene/EOG091G134K/ALICUT_EOG091G134K.clustalo.fasta per_gene/EOG091G134K/ALICUT_EOG091G134K.clustalo.fasta.backup
              bash ../scripts/remove_empty.sh per_gene/EOG091G134K/ALICUT_EOG091G134K.clustalo.fasta.backup > per_gene/EOG091G134K/ALICUT_EOG091G134K.clustalo.fasta
         fi
         touch per_gene/EOG091G134K/empty_check.done
         
[Sun Jul  5 23:46:21 2020]
Finished job 1811.
2429 of 3292 steps (74%) done

[Sun Jul  5 23:46:21 2020]
rule find_best_model:
    input: per_gene/EOG091G134K/ALICUT_EOG091G134K.clustalo.fasta, per_gene/EOG091G134K/empty_check.done
    output: per_gene/EOG091G134K/EOG091G134K.best_model
    log: per_gene/EOG091G134K/find_best_model.stderr.txt
    jobid: 988
    wildcards: BUSCO=EOG091G134K
    threads: 2


        cd per_gene/EOG091G134K
        if [ ! -d find_best_model ]
        then
            mkdir find_best_model
        fi
        cd find_best_model
        ln -s ../../../per_gene/EOG091G134K/ALICUT_EOG091G134K.clustalo.fasta EOG091G134K.fasta
        ProteinModelSelection.pl EOG091G134K.fasta 1> ../../../per_gene/EOG091G134K/EOG091G134K.best_model 2> ../../../per_gene/EOG091G134K/find_best_model.stderr.txt
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/c0c09ee657b1e27f2c5687e0e9aa8d70.simg
[Sun Jul  5 23:46:21 2020]
Finished job 1097.
2430 of 3292 steps (74%) done

[Sun Jul  5 23:46:21 2020]
rule remove_empty:
    input: per_gene/EOG091G07CE/ALICUT_EOG091G07CE.clustalo.fasta
    output: per_gene/EOG091G07CE/empty_check.done
    jobid: 1919
    wildcards: BUSCO=EOG091G07CE


         if [ "$(cat per_gene/EOG091G07CE/ALICUT_EOG091G07CE.clustalo.fasta | grep -v ">" | sed 's/-//g' | grep "^$" | wc -l)" -gt 0 ]
         then
              cp per_gene/EOG091G07CE/ALICUT_EOG091G07CE.clustalo.fasta per_gene/EOG091G07CE/ALICUT_EOG091G07CE.clustalo.fasta.backup
              bash ../scripts/remove_empty.sh per_gene/EOG091G07CE/ALICUT_EOG091G07CE.clustalo.fasta.backup > per_gene/EOG091G07CE/ALICUT_EOG091G07CE.clustalo.fasta
         fi
         touch per_gene/EOG091G07CE/empty_check.done
         
[Sun Jul  5 23:46:21 2020]
Finished job 1919.
2431 of 3292 steps (74%) done

[Sun Jul  5 23:46:21 2020]
rule find_best_model:
    input: per_gene/EOG091G07CE/ALICUT_EOG091G07CE.clustalo.fasta, per_gene/EOG091G07CE/empty_check.done
    output: per_gene/EOG091G07CE/EOG091G07CE.best_model
    log: per_gene/EOG091G07CE/find_best_model.stderr.txt
    jobid: 1096
    wildcards: BUSCO=EOG091G07CE
    threads: 2


        cd per_gene/EOG091G07CE
        if [ ! -d find_best_model ]
        then
            mkdir find_best_model
        fi
        cd find_best_model
        ln -s ../../../per_gene/EOG091G07CE/ALICUT_EOG091G07CE.clustalo.fasta EOG091G07CE.fasta
        ProteinModelSelection.pl EOG091G07CE.fasta 1> ../../../per_gene/EOG091G07CE/EOG091G07CE.best_model 2> ../../../per_gene/EOG091G07CE/find_best_model.stderr.txt
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/c0c09ee657b1e27f2c5687e0e9aa8d70.simg
[Sun Jul  5 23:46:23 2020]
Finished job 2862.
2432 of 3292 steps (74%) done

[Sun Jul  5 23:46:23 2020]
rule get_outgroups:
    input: per_gene/EOG091G0TZX/EOG091G0TZX.ingroup.fasta
    output: per_gene/EOG091G0TZX/EOG091G0TZX.orthodb.fasta, per_gene/EOG091G0TZX/EOG091G0TZX.outgroup.fasta
    log: per_gene/EOG091G0TZX/get_outgroups.stdout.txt, per_gene/EOG091G0TZX/get_outgroups.stderr.txt
    jobid: 2863
    wildcards: BUSCO=EOG091G0TZX


        #download fastas from Orhtodb for BUSCO id
        for i in {1..5}
        do
             wget "http://www.orthodb.org/fasta?query=EOG091G0TZX&level=33208" -O per_gene/EOG091G0TZX/EOG091G0TZX.orthodb.fasta 1> per_gene/EOG091G0TZX/get_outgroups.stdout.txt 2> per_gene/EOG091G0TZX/get_outgroups.stderr.txt && break || echo -e "try again ($i)" && sleep 15
        done

	#This is quick an dirty for now and just takes the first protein if there is more than one for an outgroup taxon
        bash ../scripts/download_outgroups.sh taxids.txt per_gene/EOG091G0TZX/EOG091G0TZX.orthodb.fasta > per_gene/EOG091G0TZX/EOG091G0TZX.outgroup.fasta
        
[Sun Jul  5 23:46:23 2020]
Finished job 2863.
2433 of 3292 steps (74%) done

[Sun Jul  5 23:46:23 2020]
rule join_groups:
    input: per_gene/EOG091G0TZX/EOG091G0TZX.ingroup.fasta, per_gene/EOG091G0TZX/EOG091G0TZX.outgroup.fasta
    output: per_gene/EOG091G0TZX/EOG091G0TZX.fasta
    jobid: 2255
    wildcards: BUSCO=EOG091G0TZX


        cat per_gene/EOG091G0TZX/EOG091G0TZX.ingroup.fasta per_gene/EOG091G0TZX/EOG091G0TZX.outgroup.fasta > per_gene/EOG091G0TZX/EOG091G0TZX.fasta
        
[Sun Jul  5 23:46:23 2020]
Finished job 2255.
2434 of 3292 steps (74%) done

[Sun Jul  5 23:46:23 2020]
rule MSA:
    input: per_gene/EOG091G0TZX/EOG091G0TZX.fasta
    output: per_gene/EOG091G0TZX/EOG091G0TZX.clustalo.fasta
    log: per_gene/EOG091G0TZX/MSA.stdout.txt, per_gene/EOG091G0TZX/MSA.stderr.txt
    jobid: 1630
    wildcards: BUSCO=EOG091G0TZX
    threads: 2


        clustalo -i per_gene/EOG091G0TZX/EOG091G0TZX.fasta -o per_gene/EOG091G0TZX/EOG091G0TZX.clustalo.fasta --threads=2 1> per_gene/EOG091G0TZX/MSA.stdout.txt 2> per_gene/EOG091G0TZX/MSA.stderr.txt
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/d68c9691725a7401923680874285c430.simg
[Sun Jul  5 23:46:24 2020]
Finished job 1630.
2435 of 3292 steps (74%) done

[Sun Jul  5 23:46:24 2020]
rule score_and_cut:
    input: per_gene/EOG091G0TZX/EOG091G0TZX.clustalo.fasta
    output: per_gene/EOG091G0TZX/ALICUT_EOG091G0TZX.clustalo.fasta
    jobid: 807
    wildcards: BUSCO=EOG091G0TZX
    threads: 2


        cd per_gene/EOG091G0TZX
        Aliscore.pl -N -r 200000000000000000 -i ../../per_gene/EOG091G0TZX/EOG091G0TZX.clustalo.fasta &> aliscore.log
        ALICUT.pl -s &> alicut.log
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/63c88c27a0fa300f57066b0ef65fefcb.simg
[Sun Jul  5 23:46:34 2020]
Finished job 807.
2436 of 3292 steps (74%) done

[Sun Jul  5 23:46:34 2020]
rule remove_empty:
    input: per_gene/EOG091G0TZX/ALICUT_EOG091G0TZX.clustalo.fasta
    output: per_gene/EOG091G0TZX/empty_check.done
    jobid: 1629
    wildcards: BUSCO=EOG091G0TZX


         if [ "$(cat per_gene/EOG091G0TZX/ALICUT_EOG091G0TZX.clustalo.fasta | grep -v ">" | sed 's/-//g' | grep "^$" | wc -l)" -gt 0 ]
         then
              cp per_gene/EOG091G0TZX/ALICUT_EOG091G0TZX.clustalo.fasta per_gene/EOG091G0TZX/ALICUT_EOG091G0TZX.clustalo.fasta.backup
              bash ../scripts/remove_empty.sh per_gene/EOG091G0TZX/ALICUT_EOG091G0TZX.clustalo.fasta.backup > per_gene/EOG091G0TZX/ALICUT_EOG091G0TZX.clustalo.fasta
         fi
         touch per_gene/EOG091G0TZX/empty_check.done
         
[Sun Jul  5 23:46:34 2020]
Finished job 1629.
2437 of 3292 steps (74%) done

[Sun Jul  5 23:46:34 2020]
rule find_best_model:
    input: per_gene/EOG091G0TZX/ALICUT_EOG091G0TZX.clustalo.fasta, per_gene/EOG091G0TZX/empty_check.done
    output: per_gene/EOG091G0TZX/EOG091G0TZX.best_model
    log: per_gene/EOG091G0TZX/find_best_model.stderr.txt
    jobid: 806
    wildcards: BUSCO=EOG091G0TZX
    threads: 2


        cd per_gene/EOG091G0TZX
        if [ ! -d find_best_model ]
        then
            mkdir find_best_model
        fi
        cd find_best_model
        ln -s ../../../per_gene/EOG091G0TZX/ALICUT_EOG091G0TZX.clustalo.fasta EOG091G0TZX.fasta
        ProteinModelSelection.pl EOG091G0TZX.fasta 1> ../../../per_gene/EOG091G0TZX/EOG091G0TZX.best_model 2> ../../../per_gene/EOG091G0TZX/find_best_model.stderr.txt
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/c0c09ee657b1e27f2c5687e0e9aa8d70.simg
[Sun Jul  5 23:46:44 2020]
Finished job 988.
2438 of 3292 steps (74%) done

[Sun Jul  5 23:46:44 2020]
rule infer_single_ML:
    input: per_gene/EOG091G134K/EOG091G134K.best_model, per_gene/EOG091G134K/ALICUT_EOG091G134K.clustalo.fasta
    output: per_gene/EOG091G134K/EOG091G134K.raxml.done
    log: per_gene/EOG091G134K/infer_single_ML.stdout.txt, per_gene/EOG091G134K/infer_single_ML.stderr.txt
    jobid: 288
    wildcards: BUSCO=EOG091G134K
    threads: 2


        cd per_gene/EOG091G134K
	count=$(cat ../../per_gene/EOG091G134K/ALICUT_EOG091G134K.clustalo.fasta | grep ">" | wc -l)
	if [ "$count" -gt 5 ]
        then
		RAxMLmodel=$(cat ../../per_gene/EOG091G134K/EOG091G134K.best_model | grep "Best" | cut -d ":" -f 2 | tr -d '[:space:]')
                if [ "$(ls -1 | grep "^RAxML" | wc -l)" -ne 0 ]
		then
			rm RAxML*
		fi
        	raxml -f a -T 2 -m PROTGAMMA$RAxMLmodel         	-p 12345 -x 12345 -# 100         	-s ../../per_gene/EOG091G134K/ALICUT_EOG091G134K.clustalo.fasta -n EOG091G134K.clustalo.aln.ALICUT.$RAxMLmodel 		1> ../../per_gene/EOG091G134K/infer_single_ML.stdout.txt 2> ../../per_gene/EOG091G134K/infer_single_ML.stderr.txt
	else
		echo "fasta file per_gene/EOG091G134K/ALICUT_EOG091G134K.clustalo.fasta contains fewer than 5 sequences - skipped" > ../../per_gene/EOG091G134K/infer_single_ML.stdout.txt
		touch raxml.skipped
	fi
        touch ../../per_gene/EOG091G134K/EOG091G134K.raxml.done
        
[Sun Jul  5 23:46:48 2020]
Finished job 63.
2439 of 3292 steps (74%) done

[Sun Jul  5 23:46:48 2020]
rule get_seqs:
    input: /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ingroup.txt, /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/outgroup.txt
    output: per_gene/EOG091G02V5/EOG091G02V5.ingroup.fasta
    log: per_gene/EOG091G02V5/get_seqs.stdout.txt, per_gene/EOG091G02V5/get_seqs.stderr.txt
    jobid: 2496
    wildcards: BUSCO=EOG091G02V5
    threads: 2


	basedir=$(pwd)
        cd per_gene/EOG091G02V5
        
        bash $basedir/../scripts/fetch_seqs.sh EOG091G02V5 /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ingroup.txt /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/outgroup.txt 1> ../../per_gene/EOG091G02V5/get_seqs.stdout.txt 2> ../../per_gene/EOG091G02V5/get_seqs.stderr.txt
	mv EOG091G02V5.fasta $basedir/per_gene/EOG091G02V5/EOG091G02V5.ingroup.fasta
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/72476f9d9a5bd0627b4d721143a21354.simg
[33mJob counts:
	count	jobs
	1	infer_single_ML
	1[0m
[33m
        cd per_gene/EOG091G134K
	count=$(cat ../../per_gene/EOG091G134K/ALICUT_EOG091G134K.clustalo.fasta | grep ">" | wc -l)
	if [ "$count" -gt 5 ]
        then
		RAxMLmodel=$(cat ../../per_gene/EOG091G134K/EOG091G134K.best_model | grep "Best" | cut -d ":" -f 2 | tr -d '[:space:]')
                if [ "$(ls -1 | grep "^RAxML" | wc -l)" -ne 0 ]
		then
			rm RAxML*
		fi
        	raxml -f a -T 2 -m PROTGAMMA$RAxMLmodel         	-p 12345 -x 12345 -# 100         	-s ../../per_gene/EOG091G134K/ALICUT_EOG091G134K.clustalo.fasta -n EOG091G134K.clustalo.aln.ALICUT.$RAxMLmodel 		1> ../../per_gene/EOG091G134K/infer_single_ML.stdout.txt 2> ../../per_gene/EOG091G134K/infer_single_ML.stderr.txt
	else
		echo "fasta file per_gene/EOG091G134K/ALICUT_EOG091G134K.clustalo.fasta contains fewer than 5 sequences - skipped" > ../../per_gene/EOG091G134K/infer_single_ML.stdout.txt
		touch raxml.skipped
	fi
        touch ../../per_gene/EOG091G134K/EOG091G134K.raxml.done
        [0m
[Sun Jul  5 23:46:57 2020]
Finished job 806.
2440 of 3292 steps (74%) done

[Sun Jul  5 23:46:57 2020]
rule infer_single_ML:
    input: per_gene/EOG091G0TZX/EOG091G0TZX.best_model, per_gene/EOG091G0TZX/ALICUT_EOG091G0TZX.clustalo.fasta
    output: per_gene/EOG091G0TZX/EOG091G0TZX.raxml.done
    log: per_gene/EOG091G0TZX/infer_single_ML.stdout.txt, per_gene/EOG091G0TZX/infer_single_ML.stderr.txt
    jobid: 197
    wildcards: BUSCO=EOG091G0TZX
    threads: 2


        cd per_gene/EOG091G0TZX
	count=$(cat ../../per_gene/EOG091G0TZX/ALICUT_EOG091G0TZX.clustalo.fasta | grep ">" | wc -l)
	if [ "$count" -gt 5 ]
        then
		RAxMLmodel=$(cat ../../per_gene/EOG091G0TZX/EOG091G0TZX.best_model | grep "Best" | cut -d ":" -f 2 | tr -d '[:space:]')
                if [ "$(ls -1 | grep "^RAxML" | wc -l)" -ne 0 ]
		then
			rm RAxML*
		fi
        	raxml -f a -T 2 -m PROTGAMMA$RAxMLmodel         	-p 12345 -x 12345 -# 100         	-s ../../per_gene/EOG091G0TZX/ALICUT_EOG091G0TZX.clustalo.fasta -n EOG091G0TZX.clustalo.aln.ALICUT.$RAxMLmodel 		1> ../../per_gene/EOG091G0TZX/infer_single_ML.stdout.txt 2> ../../per_gene/EOG091G0TZX/infer_single_ML.stderr.txt
	else
		echo "fasta file per_gene/EOG091G0TZX/ALICUT_EOG091G0TZX.clustalo.fasta contains fewer than 5 sequences - skipped" > ../../per_gene/EOG091G0TZX/infer_single_ML.stdout.txt
		touch raxml.skipped
	fi
        touch ../../per_gene/EOG091G0TZX/EOG091G0TZX.raxml.done
        
[33mJob counts:
	count	jobs
	1	infer_single_ML
	1[0m
[33m
        cd per_gene/EOG091G0TZX
	count=$(cat ../../per_gene/EOG091G0TZX/ALICUT_EOG091G0TZX.clustalo.fasta | grep ">" | wc -l)
	if [ "$count" -gt 5 ]
        then
		RAxMLmodel=$(cat ../../per_gene/EOG091G0TZX/EOG091G0TZX.best_model | grep "Best" | cut -d ":" -f 2 | tr -d '[:space:]')
                if [ "$(ls -1 | grep "^RAxML" | wc -l)" -ne 0 ]
		then
			rm RAxML*
		fi
        	raxml -f a -T 2 -m PROTGAMMA$RAxMLmodel         	-p 12345 -x 12345 -# 100         	-s ../../per_gene/EOG091G0TZX/ALICUT_EOG091G0TZX.clustalo.fasta -n EOG091G0TZX.clustalo.aln.ALICUT.$RAxMLmodel 		1> ../../per_gene/EOG091G0TZX/infer_single_ML.stdout.txt 2> ../../per_gene/EOG091G0TZX/infer_single_ML.stderr.txt
	else
		echo "fasta file per_gene/EOG091G0TZX/ALICUT_EOG091G0TZX.clustalo.fasta contains fewer than 5 sequences - skipped" > ../../per_gene/EOG091G0TZX/infer_single_ML.stdout.txt
		touch raxml.skipped
	fi
        touch ../../per_gene/EOG091G0TZX/EOG091G0TZX.raxml.done
        [0m
[Sun Jul  5 23:47:01 2020]
Finished job 2496.
2441 of 3292 steps (74%) done

[Sun Jul  5 23:47:01 2020]
rule get_outgroups:
    input: per_gene/EOG091G02V5/EOG091G02V5.ingroup.fasta
    output: per_gene/EOG091G02V5/EOG091G02V5.orthodb.fasta, per_gene/EOG091G02V5/EOG091G02V5.outgroup.fasta
    log: per_gene/EOG091G02V5/get_outgroups.stdout.txt, per_gene/EOG091G02V5/get_outgroups.stderr.txt
    jobid: 2497
    wildcards: BUSCO=EOG091G02V5


        #download fastas from Orhtodb for BUSCO id
        for i in {1..5}
        do
             wget "http://www.orthodb.org/fasta?query=EOG091G02V5&level=33208" -O per_gene/EOG091G02V5/EOG091G02V5.orthodb.fasta 1> per_gene/EOG091G02V5/get_outgroups.stdout.txt 2> per_gene/EOG091G02V5/get_outgroups.stderr.txt && break || echo -e "try again ($i)" && sleep 15
        done

	#This is quick an dirty for now and just takes the first protein if there is more than one for an outgroup taxon
        bash ../scripts/download_outgroups.sh taxids.txt per_gene/EOG091G02V5/EOG091G02V5.orthodb.fasta > per_gene/EOG091G02V5/EOG091G02V5.outgroup.fasta
        
[Sun Jul  5 23:47:02 2020]
Finished job 2497.
2442 of 3292 steps (74%) done

[Sun Jul  5 23:47:02 2020]
rule join_groups:
    input: per_gene/EOG091G02V5/EOG091G02V5.ingroup.fasta, per_gene/EOG091G02V5/EOG091G02V5.outgroup.fasta
    output: per_gene/EOG091G02V5/EOG091G02V5.fasta
    jobid: 2072
    wildcards: BUSCO=EOG091G02V5


        cat per_gene/EOG091G02V5/EOG091G02V5.ingroup.fasta per_gene/EOG091G02V5/EOG091G02V5.outgroup.fasta > per_gene/EOG091G02V5/EOG091G02V5.fasta
        
[Sun Jul  5 23:47:02 2020]
Finished job 2072.
2443 of 3292 steps (74%) done

[Sun Jul  5 23:47:02 2020]
rule MSA:
    input: per_gene/EOG091G02V5/EOG091G02V5.fasta
    output: per_gene/EOG091G02V5/EOG091G02V5.clustalo.fasta
    log: per_gene/EOG091G02V5/MSA.stdout.txt, per_gene/EOG091G02V5/MSA.stderr.txt
    jobid: 1264
    wildcards: BUSCO=EOG091G02V5
    threads: 2


        clustalo -i per_gene/EOG091G02V5/EOG091G02V5.fasta -o per_gene/EOG091G02V5/EOG091G02V5.clustalo.fasta --threads=2 1> per_gene/EOG091G02V5/MSA.stdout.txt 2> per_gene/EOG091G02V5/MSA.stderr.txt
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/d68c9691725a7401923680874285c430.simg
[Sun Jul  5 23:47:02 2020]
Finished job 182.
2444 of 3292 steps (74%) done

[Sun Jul  5 23:47:02 2020]
rule get_seqs:
    input: /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ingroup.txt, /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/outgroup.txt
    output: per_gene/EOG091G0BAM/EOG091G0BAM.ingroup.fasta
    log: per_gene/EOG091G0BAM/get_seqs.stdout.txt, per_gene/EOG091G0BAM/get_seqs.stderr.txt
    jobid: 2968
    wildcards: BUSCO=EOG091G0BAM
    threads: 2


	basedir=$(pwd)
        cd per_gene/EOG091G0BAM
        
        bash $basedir/../scripts/fetch_seqs.sh EOG091G0BAM /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ingroup.txt /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/outgroup.txt 1> ../../per_gene/EOG091G0BAM/get_seqs.stdout.txt 2> ../../per_gene/EOG091G0BAM/get_seqs.stderr.txt
	mv EOG091G0BAM.fasta $basedir/per_gene/EOG091G0BAM/EOG091G0BAM.ingroup.fasta
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/72476f9d9a5bd0627b4d721143a21354.simg
[Sun Jul  5 23:47:05 2020]
Finished job 1264.
2445 of 3292 steps (74%) done

[Sun Jul  5 23:47:05 2020]
rule score_and_cut:
    input: per_gene/EOG091G02V5/EOG091G02V5.clustalo.fasta
    output: per_gene/EOG091G02V5/ALICUT_EOG091G02V5.clustalo.fasta
    jobid: 441
    wildcards: BUSCO=EOG091G02V5
    threads: 2


        cd per_gene/EOG091G02V5
        Aliscore.pl -N -r 200000000000000000 -i ../../per_gene/EOG091G02V5/EOG091G02V5.clustalo.fasta &> aliscore.log
        ALICUT.pl -s &> alicut.log
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/63c88c27a0fa300f57066b0ef65fefcb.simg
[Sun Jul  5 23:47:14 2020]
Finished job 2968.
2446 of 3292 steps (74%) done

[Sun Jul  5 23:47:14 2020]
rule get_outgroups:
    input: per_gene/EOG091G0BAM/EOG091G0BAM.ingroup.fasta
    output: per_gene/EOG091G0BAM/EOG091G0BAM.orthodb.fasta, per_gene/EOG091G0BAM/EOG091G0BAM.outgroup.fasta
    log: per_gene/EOG091G0BAM/get_outgroups.stdout.txt, per_gene/EOG091G0BAM/get_outgroups.stderr.txt
    jobid: 2969
    wildcards: BUSCO=EOG091G0BAM


        #download fastas from Orhtodb for BUSCO id
        for i in {1..5}
        do
             wget "http://www.orthodb.org/fasta?query=EOG091G0BAM&level=33208" -O per_gene/EOG091G0BAM/EOG091G0BAM.orthodb.fasta 1> per_gene/EOG091G0BAM/get_outgroups.stdout.txt 2> per_gene/EOG091G0BAM/get_outgroups.stderr.txt && break || echo -e "try again ($i)" && sleep 15
        done

	#This is quick an dirty for now and just takes the first protein if there is more than one for an outgroup taxon
        bash ../scripts/download_outgroups.sh taxids.txt per_gene/EOG091G0BAM/EOG091G0BAM.orthodb.fasta > per_gene/EOG091G0BAM/EOG091G0BAM.outgroup.fasta
        
[Sun Jul  5 23:47:15 2020]
Finished job 2969.
2447 of 3292 steps (74%) done

[Sun Jul  5 23:47:15 2020]
rule join_groups:
    input: per_gene/EOG091G0BAM/EOG091G0BAM.ingroup.fasta, per_gene/EOG091G0BAM/EOG091G0BAM.outgroup.fasta
    output: per_gene/EOG091G0BAM/EOG091G0BAM.fasta
    jobid: 2308
    wildcards: BUSCO=EOG091G0BAM


        cat per_gene/EOG091G0BAM/EOG091G0BAM.ingroup.fasta per_gene/EOG091G0BAM/EOG091G0BAM.outgroup.fasta > per_gene/EOG091G0BAM/EOG091G0BAM.fasta
        
[Sun Jul  5 23:47:15 2020]
Finished job 2308.
2448 of 3292 steps (74%) done

[Sun Jul  5 23:47:15 2020]
rule MSA:
    input: per_gene/EOG091G0BAM/EOG091G0BAM.fasta
    output: per_gene/EOG091G0BAM/EOG091G0BAM.clustalo.fasta
    log: per_gene/EOG091G0BAM/MSA.stdout.txt, per_gene/EOG091G0BAM/MSA.stderr.txt
    jobid: 1736
    wildcards: BUSCO=EOG091G0BAM
    threads: 2


        clustalo -i per_gene/EOG091G0BAM/EOG091G0BAM.fasta -o per_gene/EOG091G0BAM/EOG091G0BAM.clustalo.fasta --threads=2 1> per_gene/EOG091G0BAM/MSA.stdout.txt 2> per_gene/EOG091G0BAM/MSA.stderr.txt
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/d68c9691725a7401923680874285c430.simg
[Sun Jul  5 23:47:15 2020]
Finished job 1736.
2449 of 3292 steps (74%) done

[Sun Jul  5 23:47:15 2020]
rule score_and_cut:
    input: per_gene/EOG091G0BAM/EOG091G0BAM.clustalo.fasta
    output: per_gene/EOG091G0BAM/ALICUT_EOG091G0BAM.clustalo.fasta
    jobid: 913
    wildcards: BUSCO=EOG091G0BAM
    threads: 2


        cd per_gene/EOG091G0BAM
        Aliscore.pl -N -r 200000000000000000 -i ../../per_gene/EOG091G0BAM/EOG091G0BAM.clustalo.fasta &> aliscore.log
        ALICUT.pl -s &> alicut.log
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/63c88c27a0fa300f57066b0ef65fefcb.simg
[Sun Jul  5 23:47:16 2020]
Finished job 441.
2450 of 3292 steps (74%) done

[Sun Jul  5 23:47:16 2020]
rule remove_empty:
    input: per_gene/EOG091G02V5/ALICUT_EOG091G02V5.clustalo.fasta
    output: per_gene/EOG091G02V5/empty_check.done
    jobid: 1263
    wildcards: BUSCO=EOG091G02V5


         if [ "$(cat per_gene/EOG091G02V5/ALICUT_EOG091G02V5.clustalo.fasta | grep -v ">" | sed 's/-//g' | grep "^$" | wc -l)" -gt 0 ]
         then
              cp per_gene/EOG091G02V5/ALICUT_EOG091G02V5.clustalo.fasta per_gene/EOG091G02V5/ALICUT_EOG091G02V5.clustalo.fasta.backup
              bash ../scripts/remove_empty.sh per_gene/EOG091G02V5/ALICUT_EOG091G02V5.clustalo.fasta.backup > per_gene/EOG091G02V5/ALICUT_EOG091G02V5.clustalo.fasta
         fi
         touch per_gene/EOG091G02V5/empty_check.done
         
[Sun Jul  5 23:47:16 2020]
Finished job 1263.
2451 of 3292 steps (74%) done

[Sun Jul  5 23:47:16 2020]
rule find_best_model:
    input: per_gene/EOG091G02V5/ALICUT_EOG091G02V5.clustalo.fasta, per_gene/EOG091G02V5/empty_check.done
    output: per_gene/EOG091G02V5/EOG091G02V5.best_model
    log: per_gene/EOG091G02V5/find_best_model.stderr.txt
    jobid: 440
    wildcards: BUSCO=EOG091G02V5
    threads: 2


        cd per_gene/EOG091G02V5
        if [ ! -d find_best_model ]
        then
            mkdir find_best_model
        fi
        cd find_best_model
        ln -s ../../../per_gene/EOG091G02V5/ALICUT_EOG091G02V5.clustalo.fasta EOG091G02V5.fasta
        ProteinModelSelection.pl EOG091G02V5.fasta 1> ../../../per_gene/EOG091G02V5/EOG091G02V5.best_model 2> ../../../per_gene/EOG091G02V5/find_best_model.stderr.txt
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/c0c09ee657b1e27f2c5687e0e9aa8d70.simg
[Sun Jul  5 23:47:21 2020]
Finished job 1096.
2452 of 3292 steps (74%) done

[Sun Jul  5 23:47:21 2020]
rule infer_single_ML:
    input: per_gene/EOG091G07CE/EOG091G07CE.best_model, per_gene/EOG091G07CE/ALICUT_EOG091G07CE.clustalo.fasta
    output: per_gene/EOG091G07CE/EOG091G07CE.raxml.done
    log: per_gene/EOG091G07CE/infer_single_ML.stdout.txt, per_gene/EOG091G07CE/infer_single_ML.stderr.txt
    jobid: 342
    wildcards: BUSCO=EOG091G07CE
    threads: 2


        cd per_gene/EOG091G07CE
	count=$(cat ../../per_gene/EOG091G07CE/ALICUT_EOG091G07CE.clustalo.fasta | grep ">" | wc -l)
	if [ "$count" -gt 5 ]
        then
		RAxMLmodel=$(cat ../../per_gene/EOG091G07CE/EOG091G07CE.best_model | grep "Best" | cut -d ":" -f 2 | tr -d '[:space:]')
                if [ "$(ls -1 | grep "^RAxML" | wc -l)" -ne 0 ]
		then
			rm RAxML*
		fi
        	raxml -f a -T 2 -m PROTGAMMA$RAxMLmodel         	-p 12345 -x 12345 -# 100         	-s ../../per_gene/EOG091G07CE/ALICUT_EOG091G07CE.clustalo.fasta -n EOG091G07CE.clustalo.aln.ALICUT.$RAxMLmodel 		1> ../../per_gene/EOG091G07CE/infer_single_ML.stdout.txt 2> ../../per_gene/EOG091G07CE/infer_single_ML.stderr.txt
	else
		echo "fasta file per_gene/EOG091G07CE/ALICUT_EOG091G07CE.clustalo.fasta contains fewer than 5 sequences - skipped" > ../../per_gene/EOG091G07CE/infer_single_ML.stdout.txt
		touch raxml.skipped
	fi
        touch ../../per_gene/EOG091G07CE/EOG091G07CE.raxml.done
        
[33mJob counts:
	count	jobs
	1	infer_single_ML
	1[0m
[33m
        cd per_gene/EOG091G07CE
	count=$(cat ../../per_gene/EOG091G07CE/ALICUT_EOG091G07CE.clustalo.fasta | grep ">" | wc -l)
	if [ "$count" -gt 5 ]
        then
		RAxMLmodel=$(cat ../../per_gene/EOG091G07CE/EOG091G07CE.best_model | grep "Best" | cut -d ":" -f 2 | tr -d '[:space:]')
                if [ "$(ls -1 | grep "^RAxML" | wc -l)" -ne 0 ]
		then
			rm RAxML*
		fi
        	raxml -f a -T 2 -m PROTGAMMA$RAxMLmodel         	-p 12345 -x 12345 -# 100         	-s ../../per_gene/EOG091G07CE/ALICUT_EOG091G07CE.clustalo.fasta -n EOG091G07CE.clustalo.aln.ALICUT.$RAxMLmodel 		1> ../../per_gene/EOG091G07CE/infer_single_ML.stdout.txt 2> ../../per_gene/EOG091G07CE/infer_single_ML.stderr.txt
	else
		echo "fasta file per_gene/EOG091G07CE/ALICUT_EOG091G07CE.clustalo.fasta contains fewer than 5 sequences - skipped" > ../../per_gene/EOG091G07CE/infer_single_ML.stdout.txt
		touch raxml.skipped
	fi
        touch ../../per_gene/EOG091G07CE/EOG091G07CE.raxml.done
        [0m
[Sun Jul  5 23:47:25 2020]
Finished job 913.
2453 of 3292 steps (75%) done

[Sun Jul  5 23:47:25 2020]
rule remove_empty:
    input: per_gene/EOG091G0BAM/ALICUT_EOG091G0BAM.clustalo.fasta
    output: per_gene/EOG091G0BAM/empty_check.done
    jobid: 1735
    wildcards: BUSCO=EOG091G0BAM


         if [ "$(cat per_gene/EOG091G0BAM/ALICUT_EOG091G0BAM.clustalo.fasta | grep -v ">" | sed 's/-//g' | grep "^$" | wc -l)" -gt 0 ]
         then
              cp per_gene/EOG091G0BAM/ALICUT_EOG091G0BAM.clustalo.fasta per_gene/EOG091G0BAM/ALICUT_EOG091G0BAM.clustalo.fasta.backup
              bash ../scripts/remove_empty.sh per_gene/EOG091G0BAM/ALICUT_EOG091G0BAM.clustalo.fasta.backup > per_gene/EOG091G0BAM/ALICUT_EOG091G0BAM.clustalo.fasta
         fi
         touch per_gene/EOG091G0BAM/empty_check.done
         
[Sun Jul  5 23:47:25 2020]
Finished job 1735.
2454 of 3292 steps (75%) done

[Sun Jul  5 23:47:25 2020]
rule find_best_model:
    input: per_gene/EOG091G0BAM/ALICUT_EOG091G0BAM.clustalo.fasta, per_gene/EOG091G0BAM/empty_check.done
    output: per_gene/EOG091G0BAM/EOG091G0BAM.best_model
    log: per_gene/EOG091G0BAM/find_best_model.stderr.txt
    jobid: 912
    wildcards: BUSCO=EOG091G0BAM
    threads: 2


        cd per_gene/EOG091G0BAM
        if [ ! -d find_best_model ]
        then
            mkdir find_best_model
        fi
        cd find_best_model
        ln -s ../../../per_gene/EOG091G0BAM/ALICUT_EOG091G0BAM.clustalo.fasta EOG091G0BAM.fasta
        ProteinModelSelection.pl EOG091G0BAM.fasta 1> ../../../per_gene/EOG091G0BAM/EOG091G0BAM.best_model 2> ../../../per_gene/EOG091G0BAM/find_best_model.stderr.txt
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/c0c09ee657b1e27f2c5687e0e9aa8d70.simg
[Sun Jul  5 23:47:33 2020]
Finished job 204.
2455 of 3292 steps (75%) done

[Sun Jul  5 23:47:33 2020]
rule get_seqs:
    input: /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ingroup.txt, /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/outgroup.txt
    output: per_gene/EOG091G0MJA/EOG091G0MJA.ingroup.fasta
    log: per_gene/EOG091G0MJA/get_seqs.stdout.txt, per_gene/EOG091G0MJA/get_seqs.stderr.txt
    jobid: 3234
    wildcards: BUSCO=EOG091G0MJA
    threads: 2


	basedir=$(pwd)
        cd per_gene/EOG091G0MJA
        
        bash $basedir/../scripts/fetch_seqs.sh EOG091G0MJA /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ingroup.txt /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/outgroup.txt 1> ../../per_gene/EOG091G0MJA/get_seqs.stdout.txt 2> ../../per_gene/EOG091G0MJA/get_seqs.stderr.txt
	mv EOG091G0MJA.fasta $basedir/per_gene/EOG091G0MJA/EOG091G0MJA.ingroup.fasta
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/72476f9d9a5bd0627b4d721143a21354.simg
[Sun Jul  5 23:47:45 2020]
Finished job 3234.
2456 of 3292 steps (75%) done

[Sun Jul  5 23:47:45 2020]
rule get_outgroups:
    input: per_gene/EOG091G0MJA/EOG091G0MJA.ingroup.fasta
    output: per_gene/EOG091G0MJA/EOG091G0MJA.orthodb.fasta, per_gene/EOG091G0MJA/EOG091G0MJA.outgroup.fasta
    log: per_gene/EOG091G0MJA/get_outgroups.stdout.txt, per_gene/EOG091G0MJA/get_outgroups.stderr.txt
    jobid: 3235
    wildcards: BUSCO=EOG091G0MJA


        #download fastas from Orhtodb for BUSCO id
        for i in {1..5}
        do
             wget "http://www.orthodb.org/fasta?query=EOG091G0MJA&level=33208" -O per_gene/EOG091G0MJA/EOG091G0MJA.orthodb.fasta 1> per_gene/EOG091G0MJA/get_outgroups.stdout.txt 2> per_gene/EOG091G0MJA/get_outgroups.stderr.txt && break || echo -e "try again ($i)" && sleep 15
        done

	#This is quick an dirty for now and just takes the first protein if there is more than one for an outgroup taxon
        bash ../scripts/download_outgroups.sh taxids.txt per_gene/EOG091G0MJA/EOG091G0MJA.orthodb.fasta > per_gene/EOG091G0MJA/EOG091G0MJA.outgroup.fasta
        
[Sun Jul  5 23:47:46 2020]
Finished job 3235.
2457 of 3292 steps (75%) done

[Sun Jul  5 23:47:46 2020]
rule join_groups:
    input: per_gene/EOG091G0MJA/EOG091G0MJA.ingroup.fasta, per_gene/EOG091G0MJA/EOG091G0MJA.outgroup.fasta
    output: per_gene/EOG091G0MJA/EOG091G0MJA.fasta
    jobid: 2441
    wildcards: BUSCO=EOG091G0MJA


        cat per_gene/EOG091G0MJA/EOG091G0MJA.ingroup.fasta per_gene/EOG091G0MJA/EOG091G0MJA.outgroup.fasta > per_gene/EOG091G0MJA/EOG091G0MJA.fasta
        
[Sun Jul  5 23:47:46 2020]
Finished job 2441.
2458 of 3292 steps (75%) done

[Sun Jul  5 23:47:46 2020]
rule MSA:
    input: per_gene/EOG091G0MJA/EOG091G0MJA.fasta
    output: per_gene/EOG091G0MJA/EOG091G0MJA.clustalo.fasta
    log: per_gene/EOG091G0MJA/MSA.stdout.txt, per_gene/EOG091G0MJA/MSA.stderr.txt
    jobid: 2002
    wildcards: BUSCO=EOG091G0MJA
    threads: 2


        clustalo -i per_gene/EOG091G0MJA/EOG091G0MJA.fasta -o per_gene/EOG091G0MJA/EOG091G0MJA.clustalo.fasta --threads=2 1> per_gene/EOG091G0MJA/MSA.stdout.txt 2> per_gene/EOG091G0MJA/MSA.stderr.txt
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/d68c9691725a7401923680874285c430.simg
[Sun Jul  5 23:47:47 2020]
Finished job 2002.
2459 of 3292 steps (75%) done

[Sun Jul  5 23:47:47 2020]
rule score_and_cut:
    input: per_gene/EOG091G0MJA/EOG091G0MJA.clustalo.fasta
    output: per_gene/EOG091G0MJA/ALICUT_EOG091G0MJA.clustalo.fasta
    jobid: 1179
    wildcards: BUSCO=EOG091G0MJA
    threads: 2


        cd per_gene/EOG091G0MJA
        Aliscore.pl -N -r 200000000000000000 -i ../../per_gene/EOG091G0MJA/EOG091G0MJA.clustalo.fasta &> aliscore.log
        ALICUT.pl -s &> alicut.log
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/63c88c27a0fa300f57066b0ef65fefcb.simg
[Sun Jul  5 23:47:53 2020]
Finished job 912.
2460 of 3292 steps (75%) done

[Sun Jul  5 23:47:53 2020]
rule infer_single_ML:
    input: per_gene/EOG091G0BAM/EOG091G0BAM.best_model, per_gene/EOG091G0BAM/ALICUT_EOG091G0BAM.clustalo.fasta
    output: per_gene/EOG091G0BAM/EOG091G0BAM.raxml.done
    log: per_gene/EOG091G0BAM/infer_single_ML.stdout.txt, per_gene/EOG091G0BAM/infer_single_ML.stderr.txt
    jobid: 250
    wildcards: BUSCO=EOG091G0BAM
    threads: 2


        cd per_gene/EOG091G0BAM
	count=$(cat ../../per_gene/EOG091G0BAM/ALICUT_EOG091G0BAM.clustalo.fasta | grep ">" | wc -l)
	if [ "$count" -gt 5 ]
        then
		RAxMLmodel=$(cat ../../per_gene/EOG091G0BAM/EOG091G0BAM.best_model | grep "Best" | cut -d ":" -f 2 | tr -d '[:space:]')
                if [ "$(ls -1 | grep "^RAxML" | wc -l)" -ne 0 ]
		then
			rm RAxML*
		fi
        	raxml -f a -T 2 -m PROTGAMMA$RAxMLmodel         	-p 12345 -x 12345 -# 100         	-s ../../per_gene/EOG091G0BAM/ALICUT_EOG091G0BAM.clustalo.fasta -n EOG091G0BAM.clustalo.aln.ALICUT.$RAxMLmodel 		1> ../../per_gene/EOG091G0BAM/infer_single_ML.stdout.txt 2> ../../per_gene/EOG091G0BAM/infer_single_ML.stderr.txt
	else
		echo "fasta file per_gene/EOG091G0BAM/ALICUT_EOG091G0BAM.clustalo.fasta contains fewer than 5 sequences - skipped" > ../../per_gene/EOG091G0BAM/infer_single_ML.stdout.txt
		touch raxml.skipped
	fi
        touch ../../per_gene/EOG091G0BAM/EOG091G0BAM.raxml.done
        
[33mJob counts:
	count	jobs
	1	infer_single_ML
	1[0m
[33m
        cd per_gene/EOG091G0BAM
	count=$(cat ../../per_gene/EOG091G0BAM/ALICUT_EOG091G0BAM.clustalo.fasta | grep ">" | wc -l)
	if [ "$count" -gt 5 ]
        then
		RAxMLmodel=$(cat ../../per_gene/EOG091G0BAM/EOG091G0BAM.best_model | grep "Best" | cut -d ":" -f 2 | tr -d '[:space:]')
                if [ "$(ls -1 | grep "^RAxML" | wc -l)" -ne 0 ]
		then
			rm RAxML*
		fi
        	raxml -f a -T 2 -m PROTGAMMA$RAxMLmodel         	-p 12345 -x 12345 -# 100         	-s ../../per_gene/EOG091G0BAM/ALICUT_EOG091G0BAM.clustalo.fasta -n EOG091G0BAM.clustalo.aln.ALICUT.$RAxMLmodel 		1> ../../per_gene/EOG091G0BAM/infer_single_ML.stdout.txt 2> ../../per_gene/EOG091G0BAM/infer_single_ML.stderr.txt
	else
		echo "fasta file per_gene/EOG091G0BAM/ALICUT_EOG091G0BAM.clustalo.fasta contains fewer than 5 sequences - skipped" > ../../per_gene/EOG091G0BAM/infer_single_ML.stdout.txt
		touch raxml.skipped
	fi
        touch ../../per_gene/EOG091G0BAM/EOG091G0BAM.raxml.done
        [0m
[Sun Jul  5 23:47:57 2020]
Finished job 1179.
2461 of 3292 steps (75%) done

[Sun Jul  5 23:47:57 2020]
rule remove_empty:
    input: per_gene/EOG091G0MJA/ALICUT_EOG091G0MJA.clustalo.fasta
    output: per_gene/EOG091G0MJA/empty_check.done
    jobid: 2001
    wildcards: BUSCO=EOG091G0MJA


         if [ "$(cat per_gene/EOG091G0MJA/ALICUT_EOG091G0MJA.clustalo.fasta | grep -v ">" | sed 's/-//g' | grep "^$" | wc -l)" -gt 0 ]
         then
              cp per_gene/EOG091G0MJA/ALICUT_EOG091G0MJA.clustalo.fasta per_gene/EOG091G0MJA/ALICUT_EOG091G0MJA.clustalo.fasta.backup
              bash ../scripts/remove_empty.sh per_gene/EOG091G0MJA/ALICUT_EOG091G0MJA.clustalo.fasta.backup > per_gene/EOG091G0MJA/ALICUT_EOG091G0MJA.clustalo.fasta
         fi
         touch per_gene/EOG091G0MJA/empty_check.done
         
[Sun Jul  5 23:47:57 2020]
Finished job 2001.
2462 of 3292 steps (75%) done

[Sun Jul  5 23:47:57 2020]
rule find_best_model:
    input: per_gene/EOG091G0MJA/ALICUT_EOG091G0MJA.clustalo.fasta, per_gene/EOG091G0MJA/empty_check.done
    output: per_gene/EOG091G0MJA/EOG091G0MJA.best_model
    log: per_gene/EOG091G0MJA/find_best_model.stderr.txt
    jobid: 1178
    wildcards: BUSCO=EOG091G0MJA
    threads: 2


        cd per_gene/EOG091G0MJA
        if [ ! -d find_best_model ]
        then
            mkdir find_best_model
        fi
        cd find_best_model
        ln -s ../../../per_gene/EOG091G0MJA/ALICUT_EOG091G0MJA.clustalo.fasta EOG091G0MJA.fasta
        ProteinModelSelection.pl EOG091G0MJA.fasta 1> ../../../per_gene/EOG091G0MJA/EOG091G0MJA.best_model 2> ../../../per_gene/EOG091G0MJA/find_best_model.stderr.txt
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/c0c09ee657b1e27f2c5687e0e9aa8d70.simg
[Sun Jul  5 23:48:21 2020]
Finished job 1178.
2463 of 3292 steps (75%) done

[Sun Jul  5 23:48:21 2020]
rule infer_single_ML:
    input: per_gene/EOG091G0MJA/EOG091G0MJA.best_model, per_gene/EOG091G0MJA/ALICUT_EOG091G0MJA.clustalo.fasta
    output: per_gene/EOG091G0MJA/EOG091G0MJA.raxml.done
    log: per_gene/EOG091G0MJA/infer_single_ML.stdout.txt, per_gene/EOG091G0MJA/infer_single_ML.stderr.txt
    jobid: 383
    wildcards: BUSCO=EOG091G0MJA
    threads: 2


        cd per_gene/EOG091G0MJA
	count=$(cat ../../per_gene/EOG091G0MJA/ALICUT_EOG091G0MJA.clustalo.fasta | grep ">" | wc -l)
	if [ "$count" -gt 5 ]
        then
		RAxMLmodel=$(cat ../../per_gene/EOG091G0MJA/EOG091G0MJA.best_model | grep "Best" | cut -d ":" -f 2 | tr -d '[:space:]')
                if [ "$(ls -1 | grep "^RAxML" | wc -l)" -ne 0 ]
		then
			rm RAxML*
		fi
        	raxml -f a -T 2 -m PROTGAMMA$RAxMLmodel         	-p 12345 -x 12345 -# 100         	-s ../../per_gene/EOG091G0MJA/ALICUT_EOG091G0MJA.clustalo.fasta -n EOG091G0MJA.clustalo.aln.ALICUT.$RAxMLmodel 		1> ../../per_gene/EOG091G0MJA/infer_single_ML.stdout.txt 2> ../../per_gene/EOG091G0MJA/infer_single_ML.stderr.txt
	else
		echo "fasta file per_gene/EOG091G0MJA/ALICUT_EOG091G0MJA.clustalo.fasta contains fewer than 5 sequences - skipped" > ../../per_gene/EOG091G0MJA/infer_single_ML.stdout.txt
		touch raxml.skipped
	fi
        touch ../../per_gene/EOG091G0MJA/EOG091G0MJA.raxml.done
        
[33mJob counts:
	count	jobs
	1	infer_single_ML
	1[0m
[33m
        cd per_gene/EOG091G0MJA
	count=$(cat ../../per_gene/EOG091G0MJA/ALICUT_EOG091G0MJA.clustalo.fasta | grep ">" | wc -l)
	if [ "$count" -gt 5 ]
        then
		RAxMLmodel=$(cat ../../per_gene/EOG091G0MJA/EOG091G0MJA.best_model | grep "Best" | cut -d ":" -f 2 | tr -d '[:space:]')
                if [ "$(ls -1 | grep "^RAxML" | wc -l)" -ne 0 ]
		then
			rm RAxML*
		fi
        	raxml -f a -T 2 -m PROTGAMMA$RAxMLmodel         	-p 12345 -x 12345 -# 100         	-s ../../per_gene/EOG091G0MJA/ALICUT_EOG091G0MJA.clustalo.fasta -n EOG091G0MJA.clustalo.aln.ALICUT.$RAxMLmodel 		1> ../../per_gene/EOG091G0MJA/infer_single_ML.stdout.txt 2> ../../per_gene/EOG091G0MJA/infer_single_ML.stderr.txt
	else
		echo "fasta file per_gene/EOG091G0MJA/ALICUT_EOG091G0MJA.clustalo.fasta contains fewer than 5 sequences - skipped" > ../../per_gene/EOG091G0MJA/infer_single_ML.stdout.txt
		touch raxml.skipped
	fi
        touch ../../per_gene/EOG091G0MJA/EOG091G0MJA.raxml.done
        [0m
[Sun Jul  5 23:48:31 2020]
Finished job 440.
2464 of 3292 steps (75%) done

[Sun Jul  5 23:48:31 2020]
rule infer_single_ML:
    input: per_gene/EOG091G02V5/EOG091G02V5.best_model, per_gene/EOG091G02V5/ALICUT_EOG091G02V5.clustalo.fasta
    output: per_gene/EOG091G02V5/EOG091G02V5.raxml.done
    log: per_gene/EOG091G02V5/infer_single_ML.stdout.txt, per_gene/EOG091G02V5/infer_single_ML.stderr.txt
    jobid: 14
    wildcards: BUSCO=EOG091G02V5
    threads: 2


        cd per_gene/EOG091G02V5
	count=$(cat ../../per_gene/EOG091G02V5/ALICUT_EOG091G02V5.clustalo.fasta | grep ">" | wc -l)
	if [ "$count" -gt 5 ]
        then
		RAxMLmodel=$(cat ../../per_gene/EOG091G02V5/EOG091G02V5.best_model | grep "Best" | cut -d ":" -f 2 | tr -d '[:space:]')
                if [ "$(ls -1 | grep "^RAxML" | wc -l)" -ne 0 ]
		then
			rm RAxML*
		fi
        	raxml -f a -T 2 -m PROTGAMMA$RAxMLmodel         	-p 12345 -x 12345 -# 100         	-s ../../per_gene/EOG091G02V5/ALICUT_EOG091G02V5.clustalo.fasta -n EOG091G02V5.clustalo.aln.ALICUT.$RAxMLmodel 		1> ../../per_gene/EOG091G02V5/infer_single_ML.stdout.txt 2> ../../per_gene/EOG091G02V5/infer_single_ML.stderr.txt
	else
		echo "fasta file per_gene/EOG091G02V5/ALICUT_EOG091G02V5.clustalo.fasta contains fewer than 5 sequences - skipped" > ../../per_gene/EOG091G02V5/infer_single_ML.stdout.txt
		touch raxml.skipped
	fi
        touch ../../per_gene/EOG091G02V5/EOG091G02V5.raxml.done
        
[33mJob counts:
	count	jobs
	1	infer_single_ML
	1[0m
[33m
        cd per_gene/EOG091G02V5
	count=$(cat ../../per_gene/EOG091G02V5/ALICUT_EOG091G02V5.clustalo.fasta | grep ">" | wc -l)
	if [ "$count" -gt 5 ]
        then
		RAxMLmodel=$(cat ../../per_gene/EOG091G02V5/EOG091G02V5.best_model | grep "Best" | cut -d ":" -f 2 | tr -d '[:space:]')
                if [ "$(ls -1 | grep "^RAxML" | wc -l)" -ne 0 ]
		then
			rm RAxML*
		fi
        	raxml -f a -T 2 -m PROTGAMMA$RAxMLmodel         	-p 12345 -x 12345 -# 100         	-s ../../per_gene/EOG091G02V5/ALICUT_EOG091G02V5.clustalo.fasta -n EOG091G02V5.clustalo.aln.ALICUT.$RAxMLmodel 		1> ../../per_gene/EOG091G02V5/infer_single_ML.stdout.txt 2> ../../per_gene/EOG091G02V5/infer_single_ML.stderr.txt
	else
		echo "fasta file per_gene/EOG091G02V5/ALICUT_EOG091G02V5.clustalo.fasta contains fewer than 5 sequences - skipped" > ../../per_gene/EOG091G02V5/infer_single_ML.stdout.txt
		touch raxml.skipped
	fi
        touch ../../per_gene/EOG091G02V5/EOG091G02V5.raxml.done
        [0m
[Sun Jul  5 23:49:18 2020]
Finished job 347.
2465 of 3292 steps (75%) done

[Sun Jul  5 23:49:18 2020]
rule get_seqs:
    input: /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ingroup.txt, /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/outgroup.txt
    output: per_gene/EOG091G0LFF/EOG091G0LFF.ingroup.fasta
    log: per_gene/EOG091G0LFF/get_seqs.stdout.txt, per_gene/EOG091G0LFF/get_seqs.stderr.txt
    jobid: 3098
    wildcards: BUSCO=EOG091G0LFF
    threads: 2


	basedir=$(pwd)
        cd per_gene/EOG091G0LFF
        
        bash $basedir/../scripts/fetch_seqs.sh EOG091G0LFF /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ingroup.txt /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/outgroup.txt 1> ../../per_gene/EOG091G0LFF/get_seqs.stdout.txt 2> ../../per_gene/EOG091G0LFF/get_seqs.stderr.txt
	mv EOG091G0LFF.fasta $basedir/per_gene/EOG091G0LFF/EOG091G0LFF.ingroup.fasta
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/72476f9d9a5bd0627b4d721143a21354.simg
[Sun Jul  5 23:49:19 2020]
Finished job 262.
2466 of 3292 steps (75%) done

[Sun Jul  5 23:49:19 2020]
rule get_seqs:
    input: /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ingroup.txt, /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/outgroup.txt
    output: per_gene/EOG091G050Q/EOG091G050Q.ingroup.fasta
    log: per_gene/EOG091G050Q/get_seqs.stdout.txt, per_gene/EOG091G050Q/get_seqs.stderr.txt
    jobid: 3136
    wildcards: BUSCO=EOG091G050Q
    threads: 2


	basedir=$(pwd)
        cd per_gene/EOG091G050Q
        
        bash $basedir/../scripts/fetch_seqs.sh EOG091G050Q /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ingroup.txt /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/outgroup.txt 1> ../../per_gene/EOG091G050Q/get_seqs.stdout.txt 2> ../../per_gene/EOG091G050Q/get_seqs.stderr.txt
	mv EOG091G050Q.fasta $basedir/per_gene/EOG091G050Q/EOG091G050Q.ingroup.fasta
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/72476f9d9a5bd0627b4d721143a21354.simg
[Sun Jul  5 23:49:28 2020]
Finished job 45.
2467 of 3292 steps (75%) done

[Sun Jul  5 23:49:28 2020]
rule get_seqs:
    input: /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ingroup.txt, /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/outgroup.txt
    output: per_gene/EOG091G0K9M/EOG091G0K9M.ingroup.fasta
    log: per_gene/EOG091G0K9M/get_seqs.stdout.txt, per_gene/EOG091G0K9M/get_seqs.stderr.txt
    jobid: 2736
    wildcards: BUSCO=EOG091G0K9M
    threads: 2


	basedir=$(pwd)
        cd per_gene/EOG091G0K9M
        
        bash $basedir/../scripts/fetch_seqs.sh EOG091G0K9M /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ingroup.txt /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/outgroup.txt 1> ../../per_gene/EOG091G0K9M/get_seqs.stdout.txt 2> ../../per_gene/EOG091G0K9M/get_seqs.stderr.txt
	mv EOG091G0K9M.fasta $basedir/per_gene/EOG091G0K9M/EOG091G0K9M.ingroup.fasta
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/72476f9d9a5bd0627b4d721143a21354.simg
[Sun Jul  5 23:49:29 2020]
Finished job 378.
2468 of 3292 steps (75%) done

[Sun Jul  5 23:49:29 2020]
rule get_seqs:
    input: /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ingroup.txt, /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/outgroup.txt
    output: per_gene/EOG091G0E5O/EOG091G0E5O.ingroup.fasta
    log: per_gene/EOG091G0E5O/get_seqs.stdout.txt, per_gene/EOG091G0E5O/get_seqs.stderr.txt
    jobid: 3092
    wildcards: BUSCO=EOG091G0E5O
    threads: 2


	basedir=$(pwd)
        cd per_gene/EOG091G0E5O
        
        bash $basedir/../scripts/fetch_seqs.sh EOG091G0E5O /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ingroup.txt /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/outgroup.txt 1> ../../per_gene/EOG091G0E5O/get_seqs.stdout.txt 2> ../../per_gene/EOG091G0E5O/get_seqs.stderr.txt
	mv EOG091G0E5O.fasta $basedir/per_gene/EOG091G0E5O/EOG091G0E5O.ingroup.fasta
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/72476f9d9a5bd0627b4d721143a21354.simg
[Sun Jul  5 23:49:35 2020]
Finished job 3136.
2469 of 3292 steps (75%) done
[Sun Jul  5 23:49:35 2020]
Finished job 3098.
2470 of 3292 steps (75%) done

[Sun Jul  5 23:49:35 2020]
rule get_outgroups:
    input: per_gene/EOG091G050Q/EOG091G050Q.ingroup.fasta
    output: per_gene/EOG091G050Q/EOG091G050Q.orthodb.fasta, per_gene/EOG091G050Q/EOG091G050Q.outgroup.fasta
    log: per_gene/EOG091G050Q/get_outgroups.stdout.txt, per_gene/EOG091G050Q/get_outgroups.stderr.txt
    jobid: 3137
    wildcards: BUSCO=EOG091G050Q


        #download fastas from Orhtodb for BUSCO id
        for i in {1..5}
        do
             wget "http://www.orthodb.org/fasta?query=EOG091G050Q&level=33208" -O per_gene/EOG091G050Q/EOG091G050Q.orthodb.fasta 1> per_gene/EOG091G050Q/get_outgroups.stdout.txt 2> per_gene/EOG091G050Q/get_outgroups.stderr.txt && break || echo -e "try again ($i)" && sleep 15
        done

	#This is quick an dirty for now and just takes the first protein if there is more than one for an outgroup taxon
        bash ../scripts/download_outgroups.sh taxids.txt per_gene/EOG091G050Q/EOG091G050Q.orthodb.fasta > per_gene/EOG091G050Q/EOG091G050Q.outgroup.fasta
        

[Sun Jul  5 23:49:35 2020]
rule get_outgroups:
    input: per_gene/EOG091G0LFF/EOG091G0LFF.ingroup.fasta
    output: per_gene/EOG091G0LFF/EOG091G0LFF.orthodb.fasta, per_gene/EOG091G0LFF/EOG091G0LFF.outgroup.fasta
    log: per_gene/EOG091G0LFF/get_outgroups.stdout.txt, per_gene/EOG091G0LFF/get_outgroups.stderr.txt
    jobid: 3099
    wildcards: BUSCO=EOG091G0LFF


        #download fastas from Orhtodb for BUSCO id
        for i in {1..5}
        do
             wget "http://www.orthodb.org/fasta?query=EOG091G0LFF&level=33208" -O per_gene/EOG091G0LFF/EOG091G0LFF.orthodb.fasta 1> per_gene/EOG091G0LFF/get_outgroups.stdout.txt 2> per_gene/EOG091G0LFF/get_outgroups.stderr.txt && break || echo -e "try again ($i)" && sleep 15
        done

	#This is quick an dirty for now and just takes the first protein if there is more than one for an outgroup taxon
        bash ../scripts/download_outgroups.sh taxids.txt per_gene/EOG091G0LFF/EOG091G0LFF.orthodb.fasta > per_gene/EOG091G0LFF/EOG091G0LFF.outgroup.fasta
        

[Sun Jul  5 23:49:35 2020]
rule get_seqs:
    input: /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ingroup.txt, /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/outgroup.txt
    output: per_gene/EOG091G0WPV/EOG091G0WPV.ingroup.fasta
    log: per_gene/EOG091G0WPV/get_seqs.stdout.txt, per_gene/EOG091G0WPV/get_seqs.stderr.txt
    jobid: 3286
    wildcards: BUSCO=EOG091G0WPV
    threads: 2


	basedir=$(pwd)
        cd per_gene/EOG091G0WPV
        
        bash $basedir/../scripts/fetch_seqs.sh EOG091G0WPV /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ingroup.txt /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/outgroup.txt 1> ../../per_gene/EOG091G0WPV/get_seqs.stdout.txt 2> ../../per_gene/EOG091G0WPV/get_seqs.stderr.txt
	mv EOG091G0WPV.fasta $basedir/per_gene/EOG091G0WPV/EOG091G0WPV.ingroup.fasta
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/72476f9d9a5bd0627b4d721143a21354.simg
[Sun Jul  5 23:49:36 2020]
Finished job 3099.
2471 of 3292 steps (75%) done

[Sun Jul  5 23:49:36 2020]
rule join_groups:
    input: per_gene/EOG091G0LFF/EOG091G0LFF.ingroup.fasta, per_gene/EOG091G0LFF/EOG091G0LFF.outgroup.fasta
    output: per_gene/EOG091G0LFF/EOG091G0LFF.fasta
    jobid: 2373
    wildcards: BUSCO=EOG091G0LFF


        cat per_gene/EOG091G0LFF/EOG091G0LFF.ingroup.fasta per_gene/EOG091G0LFF/EOG091G0LFF.outgroup.fasta > per_gene/EOG091G0LFF/EOG091G0LFF.fasta
        
[Sun Jul  5 23:49:36 2020]
Finished job 2373.
2472 of 3292 steps (75%) done
[Sun Jul  5 23:49:37 2020]
Finished job 3137.
2473 of 3292 steps (75%) done

[Sun Jul  5 23:49:37 2020]
rule join_groups:
    input: per_gene/EOG091G050Q/EOG091G050Q.ingroup.fasta, per_gene/EOG091G050Q/EOG091G050Q.outgroup.fasta
    output: per_gene/EOG091G050Q/EOG091G050Q.fasta
    jobid: 2392
    wildcards: BUSCO=EOG091G050Q


        cat per_gene/EOG091G050Q/EOG091G050Q.ingroup.fasta per_gene/EOG091G050Q/EOG091G050Q.outgroup.fasta > per_gene/EOG091G050Q/EOG091G050Q.fasta
        
[Sun Jul  5 23:49:37 2020]
Finished job 2392.
2474 of 3292 steps (75%) done

[Sun Jul  5 23:49:37 2020]
rule MSA:
    input: per_gene/EOG091G050Q/EOG091G050Q.fasta
    output: per_gene/EOG091G050Q/EOG091G050Q.clustalo.fasta
    log: per_gene/EOG091G050Q/MSA.stdout.txt, per_gene/EOG091G050Q/MSA.stderr.txt
    jobid: 1904
    wildcards: BUSCO=EOG091G050Q
    threads: 2


        clustalo -i per_gene/EOG091G050Q/EOG091G050Q.fasta -o per_gene/EOG091G050Q/EOG091G050Q.clustalo.fasta --threads=2 1> per_gene/EOG091G050Q/MSA.stdout.txt 2> per_gene/EOG091G050Q/MSA.stderr.txt
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/d68c9691725a7401923680874285c430.simg
[Sun Jul  5 23:49:38 2020]
Finished job 1904.
2475 of 3292 steps (75%) done

[Sun Jul  5 23:49:38 2020]
rule score_and_cut:
    input: per_gene/EOG091G050Q/EOG091G050Q.clustalo.fasta
    output: per_gene/EOG091G050Q/ALICUT_EOG091G050Q.clustalo.fasta
    jobid: 1081
    wildcards: BUSCO=EOG091G050Q
    threads: 2


        cd per_gene/EOG091G050Q
        Aliscore.pl -N -r 200000000000000000 -i ../../per_gene/EOG091G050Q/EOG091G050Q.clustalo.fasta &> aliscore.log
        ALICUT.pl -s &> alicut.log
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/63c88c27a0fa300f57066b0ef65fefcb.simg
[Sun Jul  5 23:49:43 2020]
Finished job 2736.
2476 of 3292 steps (75%) done

[Sun Jul  5 23:49:43 2020]
rule MSA:
    input: per_gene/EOG091G0LFF/EOG091G0LFF.fasta
    output: per_gene/EOG091G0LFF/EOG091G0LFF.clustalo.fasta
    log: per_gene/EOG091G0LFF/MSA.stdout.txt, per_gene/EOG091G0LFF/MSA.stderr.txt
    jobid: 1866
    wildcards: BUSCO=EOG091G0LFF
    threads: 2


        clustalo -i per_gene/EOG091G0LFF/EOG091G0LFF.fasta -o per_gene/EOG091G0LFF/EOG091G0LFF.clustalo.fasta --threads=2 1> per_gene/EOG091G0LFF/MSA.stdout.txt 2> per_gene/EOG091G0LFF/MSA.stderr.txt
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/d68c9691725a7401923680874285c430.simg
[Sun Jul  5 23:49:43 2020]
Finished job 1866.
2477 of 3292 steps (75%) done

[Sun Jul  5 23:49:43 2020]
rule score_and_cut:
    input: per_gene/EOG091G0LFF/EOG091G0LFF.clustalo.fasta
    output: per_gene/EOG091G0LFF/ALICUT_EOG091G0LFF.clustalo.fasta
    jobid: 1043
    wildcards: BUSCO=EOG091G0LFF
    threads: 2


        cd per_gene/EOG091G0LFF
        Aliscore.pl -N -r 200000000000000000 -i ../../per_gene/EOG091G0LFF/EOG091G0LFF.clustalo.fasta &> aliscore.log
        ALICUT.pl -s &> alicut.log
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/63c88c27a0fa300f57066b0ef65fefcb.simg
[Sun Jul  5 23:49:44 2020]
Finished job 3092.
2478 of 3292 steps (75%) done

[Sun Jul  5 23:49:44 2020]
rule get_outgroups:
    input: per_gene/EOG091G0E5O/EOG091G0E5O.ingroup.fasta
    output: per_gene/EOG091G0E5O/EOG091G0E5O.orthodb.fasta, per_gene/EOG091G0E5O/EOG091G0E5O.outgroup.fasta
    log: per_gene/EOG091G0E5O/get_outgroups.stdout.txt, per_gene/EOG091G0E5O/get_outgroups.stderr.txt
    jobid: 3093
    wildcards: BUSCO=EOG091G0E5O


        #download fastas from Orhtodb for BUSCO id
        for i in {1..5}
        do
             wget "http://www.orthodb.org/fasta?query=EOG091G0E5O&level=33208" -O per_gene/EOG091G0E5O/EOG091G0E5O.orthodb.fasta 1> per_gene/EOG091G0E5O/get_outgroups.stdout.txt 2> per_gene/EOG091G0E5O/get_outgroups.stderr.txt && break || echo -e "try again ($i)" && sleep 15
        done

	#This is quick an dirty for now and just takes the first protein if there is more than one for an outgroup taxon
        bash ../scripts/download_outgroups.sh taxids.txt per_gene/EOG091G0E5O/EOG091G0E5O.orthodb.fasta > per_gene/EOG091G0E5O/EOG091G0E5O.outgroup.fasta
        

[Sun Jul  5 23:49:44 2020]
rule get_outgroups:
    input: per_gene/EOG091G0K9M/EOG091G0K9M.ingroup.fasta
    output: per_gene/EOG091G0K9M/EOG091G0K9M.orthodb.fasta, per_gene/EOG091G0K9M/EOG091G0K9M.outgroup.fasta
    log: per_gene/EOG091G0K9M/get_outgroups.stdout.txt, per_gene/EOG091G0K9M/get_outgroups.stderr.txt
    jobid: 2737
    wildcards: BUSCO=EOG091G0K9M


        #download fastas from Orhtodb for BUSCO id
        for i in {1..5}
        do
             wget "http://www.orthodb.org/fasta?query=EOG091G0K9M&level=33208" -O per_gene/EOG091G0K9M/EOG091G0K9M.orthodb.fasta 1> per_gene/EOG091G0K9M/get_outgroups.stdout.txt 2> per_gene/EOG091G0K9M/get_outgroups.stderr.txt && break || echo -e "try again ($i)" && sleep 15
        done

	#This is quick an dirty for now and just takes the first protein if there is more than one for an outgroup taxon
        bash ../scripts/download_outgroups.sh taxids.txt per_gene/EOG091G0K9M/EOG091G0K9M.orthodb.fasta > per_gene/EOG091G0K9M/EOG091G0K9M.outgroup.fasta
        
[Sun Jul  5 23:49:45 2020]
Finished job 3093.
2479 of 3292 steps (75%) done

[Sun Jul  5 23:49:45 2020]
rule join_groups:
    input: per_gene/EOG091G0E5O/EOG091G0E5O.ingroup.fasta, per_gene/EOG091G0E5O/EOG091G0E5O.outgroup.fasta
    output: per_gene/EOG091G0E5O/EOG091G0E5O.fasta
    jobid: 2370
    wildcards: BUSCO=EOG091G0E5O


        cat per_gene/EOG091G0E5O/EOG091G0E5O.ingroup.fasta per_gene/EOG091G0E5O/EOG091G0E5O.outgroup.fasta > per_gene/EOG091G0E5O/EOG091G0E5O.fasta
        
[Sun Jul  5 23:49:45 2020]
Finished job 2370.
2480 of 3292 steps (75%) done
[Sun Jul  5 23:49:46 2020]
Finished job 2737.
2481 of 3292 steps (75%) done

[Sun Jul  5 23:49:46 2020]
rule MSA:
    input: per_gene/EOG091G0E5O/EOG091G0E5O.fasta
    output: per_gene/EOG091G0E5O/EOG091G0E5O.clustalo.fasta
    log: per_gene/EOG091G0E5O/MSA.stdout.txt, per_gene/EOG091G0E5O/MSA.stderr.txt
    jobid: 1860
    wildcards: BUSCO=EOG091G0E5O
    threads: 2


        clustalo -i per_gene/EOG091G0E5O/EOG091G0E5O.fasta -o per_gene/EOG091G0E5O/EOG091G0E5O.clustalo.fasta --threads=2 1> per_gene/EOG091G0E5O/MSA.stdout.txt 2> per_gene/EOG091G0E5O/MSA.stderr.txt
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/d68c9691725a7401923680874285c430.simg
[Sun Jul  5 23:49:47 2020]
Finished job 1860.
2482 of 3292 steps (75%) done

[Sun Jul  5 23:49:47 2020]
rule score_and_cut:
    input: per_gene/EOG091G0E5O/EOG091G0E5O.clustalo.fasta
    output: per_gene/EOG091G0E5O/ALICUT_EOG091G0E5O.clustalo.fasta
    jobid: 1037
    wildcards: BUSCO=EOG091G0E5O
    threads: 2


        cd per_gene/EOG091G0E5O
        Aliscore.pl -N -r 200000000000000000 -i ../../per_gene/EOG091G0E5O/EOG091G0E5O.clustalo.fasta &> aliscore.log
        ALICUT.pl -s &> alicut.log
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/63c88c27a0fa300f57066b0ef65fefcb.simg
[Sun Jul  5 23:49:48 2020]
Finished job 1081.
2483 of 3292 steps (75%) done

[Sun Jul  5 23:49:48 2020]
rule join_groups:
    input: per_gene/EOG091G0K9M/EOG091G0K9M.ingroup.fasta, per_gene/EOG091G0K9M/EOG091G0K9M.outgroup.fasta
    output: per_gene/EOG091G0K9M/EOG091G0K9M.fasta
    jobid: 2192
    wildcards: BUSCO=EOG091G0K9M


        cat per_gene/EOG091G0K9M/EOG091G0K9M.ingroup.fasta per_gene/EOG091G0K9M/EOG091G0K9M.outgroup.fasta > per_gene/EOG091G0K9M/EOG091G0K9M.fasta
        

[Sun Jul  5 23:49:48 2020]
rule remove_empty:
    input: per_gene/EOG091G050Q/ALICUT_EOG091G050Q.clustalo.fasta
    output: per_gene/EOG091G050Q/empty_check.done
    jobid: 1903
    wildcards: BUSCO=EOG091G050Q


         if [ "$(cat per_gene/EOG091G050Q/ALICUT_EOG091G050Q.clustalo.fasta | grep -v ">" | sed 's/-//g' | grep "^$" | wc -l)" -gt 0 ]
         then
              cp per_gene/EOG091G050Q/ALICUT_EOG091G050Q.clustalo.fasta per_gene/EOG091G050Q/ALICUT_EOG091G050Q.clustalo.fasta.backup
              bash ../scripts/remove_empty.sh per_gene/EOG091G050Q/ALICUT_EOG091G050Q.clustalo.fasta.backup > per_gene/EOG091G050Q/ALICUT_EOG091G050Q.clustalo.fasta
         fi
         touch per_gene/EOG091G050Q/empty_check.done
         
[Sun Jul  5 23:49:48 2020]
Finished job 2192.
2484 of 3292 steps (75%) done
[Sun Jul  5 23:49:48 2020]
Finished job 1903.
2485 of 3292 steps (75%) done

[Sun Jul  5 23:49:48 2020]
rule find_best_model:
    input: per_gene/EOG091G050Q/ALICUT_EOG091G050Q.clustalo.fasta, per_gene/EOG091G050Q/empty_check.done
    output: per_gene/EOG091G050Q/EOG091G050Q.best_model
    log: per_gene/EOG091G050Q/find_best_model.stderr.txt
    jobid: 1080
    wildcards: BUSCO=EOG091G050Q
    threads: 2


        cd per_gene/EOG091G050Q
        if [ ! -d find_best_model ]
        then
            mkdir find_best_model
        fi
        cd find_best_model
        ln -s ../../../per_gene/EOG091G050Q/ALICUT_EOG091G050Q.clustalo.fasta EOG091G050Q.fasta
        ProteinModelSelection.pl EOG091G050Q.fasta 1> ../../../per_gene/EOG091G050Q/EOG091G050Q.best_model 2> ../../../per_gene/EOG091G050Q/find_best_model.stderr.txt
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/c0c09ee657b1e27f2c5687e0e9aa8d70.simg
[Sun Jul  5 23:49:48 2020]
Finished job 3286.
2486 of 3292 steps (76%) done

[Sun Jul  5 23:49:48 2020]
rule MSA:
    input: per_gene/EOG091G0K9M/EOG091G0K9M.fasta
    output: per_gene/EOG091G0K9M/EOG091G0K9M.clustalo.fasta
    log: per_gene/EOG091G0K9M/MSA.stdout.txt, per_gene/EOG091G0K9M/MSA.stderr.txt
    jobid: 1504
    wildcards: BUSCO=EOG091G0K9M
    threads: 2


        clustalo -i per_gene/EOG091G0K9M/EOG091G0K9M.fasta -o per_gene/EOG091G0K9M/EOG091G0K9M.clustalo.fasta --threads=2 1> per_gene/EOG091G0K9M/MSA.stdout.txt 2> per_gene/EOG091G0K9M/MSA.stderr.txt
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/d68c9691725a7401923680874285c430.simg
[Sun Jul  5 23:49:50 2020]
Finished job 1504.
2487 of 3292 steps (76%) done

[Sun Jul  5 23:49:50 2020]
rule score_and_cut:
    input: per_gene/EOG091G0K9M/EOG091G0K9M.clustalo.fasta
    output: per_gene/EOG091G0K9M/ALICUT_EOG091G0K9M.clustalo.fasta
    jobid: 681
    wildcards: BUSCO=EOG091G0K9M
    threads: 2


        cd per_gene/EOG091G0K9M
        Aliscore.pl -N -r 200000000000000000 -i ../../per_gene/EOG091G0K9M/EOG091G0K9M.clustalo.fasta &> aliscore.log
        ALICUT.pl -s &> alicut.log
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/63c88c27a0fa300f57066b0ef65fefcb.simg
[Sun Jul  5 23:49:53 2020]
Finished job 1043.
2488 of 3292 steps (76%) done

[Sun Jul  5 23:49:53 2020]
rule remove_empty:
    input: per_gene/EOG091G0LFF/ALICUT_EOG091G0LFF.clustalo.fasta
    output: per_gene/EOG091G0LFF/empty_check.done
    jobid: 1865
    wildcards: BUSCO=EOG091G0LFF


         if [ "$(cat per_gene/EOG091G0LFF/ALICUT_EOG091G0LFF.clustalo.fasta | grep -v ">" | sed 's/-//g' | grep "^$" | wc -l)" -gt 0 ]
         then
              cp per_gene/EOG091G0LFF/ALICUT_EOG091G0LFF.clustalo.fasta per_gene/EOG091G0LFF/ALICUT_EOG091G0LFF.clustalo.fasta.backup
              bash ../scripts/remove_empty.sh per_gene/EOG091G0LFF/ALICUT_EOG091G0LFF.clustalo.fasta.backup > per_gene/EOG091G0LFF/ALICUT_EOG091G0LFF.clustalo.fasta
         fi
         touch per_gene/EOG091G0LFF/empty_check.done
         

[Sun Jul  5 23:49:53 2020]
rule get_outgroups:
    input: per_gene/EOG091G0WPV/EOG091G0WPV.ingroup.fasta
    output: per_gene/EOG091G0WPV/EOG091G0WPV.orthodb.fasta, per_gene/EOG091G0WPV/EOG091G0WPV.outgroup.fasta
    log: per_gene/EOG091G0WPV/get_outgroups.stdout.txt, per_gene/EOG091G0WPV/get_outgroups.stderr.txt
    jobid: 3287
    wildcards: BUSCO=EOG091G0WPV


        #download fastas from Orhtodb for BUSCO id
        for i in {1..5}
        do
             wget "http://www.orthodb.org/fasta?query=EOG091G0WPV&level=33208" -O per_gene/EOG091G0WPV/EOG091G0WPV.orthodb.fasta 1> per_gene/EOG091G0WPV/get_outgroups.stdout.txt 2> per_gene/EOG091G0WPV/get_outgroups.stderr.txt && break || echo -e "try again ($i)" && sleep 15
        done

	#This is quick an dirty for now and just takes the first protein if there is more than one for an outgroup taxon
        bash ../scripts/download_outgroups.sh taxids.txt per_gene/EOG091G0WPV/EOG091G0WPV.orthodb.fasta > per_gene/EOG091G0WPV/EOG091G0WPV.outgroup.fasta
        
[Sun Jul  5 23:49:53 2020]
Finished job 1865.
2489 of 3292 steps (76%) done
[Sun Jul  5 23:49:54 2020]
Finished job 3287.
2490 of 3292 steps (76%) done

[Sun Jul  5 23:49:54 2020]
rule find_best_model:
    input: per_gene/EOG091G0LFF/ALICUT_EOG091G0LFF.clustalo.fasta, per_gene/EOG091G0LFF/empty_check.done
    output: per_gene/EOG091G0LFF/EOG091G0LFF.best_model
    log: per_gene/EOG091G0LFF/find_best_model.stderr.txt
    jobid: 1042
    wildcards: BUSCO=EOG091G0LFF
    threads: 2


        cd per_gene/EOG091G0LFF
        if [ ! -d find_best_model ]
        then
            mkdir find_best_model
        fi
        cd find_best_model
        ln -s ../../../per_gene/EOG091G0LFF/ALICUT_EOG091G0LFF.clustalo.fasta EOG091G0LFF.fasta
        ProteinModelSelection.pl EOG091G0LFF.fasta 1> ../../../per_gene/EOG091G0LFF/EOG091G0LFF.best_model 2> ../../../per_gene/EOG091G0LFF/find_best_model.stderr.txt
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/c0c09ee657b1e27f2c5687e0e9aa8d70.simg
[Sun Jul  5 23:49:55 2020]
Finished job 301.
2491 of 3292 steps (76%) done

[Sun Jul  5 23:49:55 2020]
rule join_groups:
    input: per_gene/EOG091G0WPV/EOG091G0WPV.ingroup.fasta, per_gene/EOG091G0WPV/EOG091G0WPV.outgroup.fasta
    output: per_gene/EOG091G0WPV/EOG091G0WPV.fasta
    jobid: 2467
    wildcards: BUSCO=EOG091G0WPV


        cat per_gene/EOG091G0WPV/EOG091G0WPV.ingroup.fasta per_gene/EOG091G0WPV/EOG091G0WPV.outgroup.fasta > per_gene/EOG091G0WPV/EOG091G0WPV.fasta
        
[Sun Jul  5 23:49:55 2020]
Finished job 2467.
2492 of 3292 steps (76%) done

[Sun Jul  5 23:49:55 2020]
rule MSA:
    input: per_gene/EOG091G0WPV/EOG091G0WPV.fasta
    output: per_gene/EOG091G0WPV/EOG091G0WPV.clustalo.fasta
    log: per_gene/EOG091G0WPV/MSA.stdout.txt, per_gene/EOG091G0WPV/MSA.stderr.txt
    jobid: 2054
    wildcards: BUSCO=EOG091G0WPV
    threads: 2


        clustalo -i per_gene/EOG091G0WPV/EOG091G0WPV.fasta -o per_gene/EOG091G0WPV/EOG091G0WPV.clustalo.fasta --threads=2 1> per_gene/EOG091G0WPV/MSA.stdout.txt 2> per_gene/EOG091G0WPV/MSA.stderr.txt
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/d68c9691725a7401923680874285c430.simg
[Sun Jul  5 23:49:55 2020]
Finished job 2054.
2493 of 3292 steps (76%) done

[Sun Jul  5 23:49:55 2020]
rule score_and_cut:
    input: per_gene/EOG091G0WPV/EOG091G0WPV.clustalo.fasta
    output: per_gene/EOG091G0WPV/ALICUT_EOG091G0WPV.clustalo.fasta
    jobid: 1231
    wildcards: BUSCO=EOG091G0WPV
    threads: 2


        cd per_gene/EOG091G0WPV
        Aliscore.pl -N -r 200000000000000000 -i ../../per_gene/EOG091G0WPV/EOG091G0WPV.clustalo.fasta &> aliscore.log
        ALICUT.pl -s &> alicut.log
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/63c88c27a0fa300f57066b0ef65fefcb.simg
[Sun Jul  5 23:49:57 2020]
Finished job 1037.
2494 of 3292 steps (76%) done

[Sun Jul  5 23:49:57 2020]
rule remove_empty:
    input: per_gene/EOG091G0E5O/ALICUT_EOG091G0E5O.clustalo.fasta
    output: per_gene/EOG091G0E5O/empty_check.done
    jobid: 1859
    wildcards: BUSCO=EOG091G0E5O


         if [ "$(cat per_gene/EOG091G0E5O/ALICUT_EOG091G0E5O.clustalo.fasta | grep -v ">" | sed 's/-//g' | grep "^$" | wc -l)" -gt 0 ]
         then
              cp per_gene/EOG091G0E5O/ALICUT_EOG091G0E5O.clustalo.fasta per_gene/EOG091G0E5O/ALICUT_EOG091G0E5O.clustalo.fasta.backup
              bash ../scripts/remove_empty.sh per_gene/EOG091G0E5O/ALICUT_EOG091G0E5O.clustalo.fasta.backup > per_gene/EOG091G0E5O/ALICUT_EOG091G0E5O.clustalo.fasta
         fi
         touch per_gene/EOG091G0E5O/empty_check.done
         
[Sun Jul  5 23:49:57 2020]
Finished job 1859.
2495 of 3292 steps (76%) done

[Sun Jul  5 23:49:57 2020]
rule find_best_model:
    input: per_gene/EOG091G0E5O/ALICUT_EOG091G0E5O.clustalo.fasta, per_gene/EOG091G0E5O/empty_check.done
    output: per_gene/EOG091G0E5O/EOG091G0E5O.best_model
    log: per_gene/EOG091G0E5O/find_best_model.stderr.txt
    jobid: 1036
    wildcards: BUSCO=EOG091G0E5O
    threads: 2


        cd per_gene/EOG091G0E5O
        if [ ! -d find_best_model ]
        then
            mkdir find_best_model
        fi
        cd find_best_model
        ln -s ../../../per_gene/EOG091G0E5O/ALICUT_EOG091G0E5O.clustalo.fasta EOG091G0E5O.fasta
        ProteinModelSelection.pl EOG091G0E5O.fasta 1> ../../../per_gene/EOG091G0E5O/EOG091G0E5O.best_model 2> ../../../per_gene/EOG091G0E5O/find_best_model.stderr.txt
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/c0c09ee657b1e27f2c5687e0e9aa8d70.simg
[Sun Jul  5 23:49:59 2020]
Finished job 681.
2496 of 3292 steps (76%) done

[Sun Jul  5 23:49:59 2020]
rule remove_empty:
    input: per_gene/EOG091G0K9M/ALICUT_EOG091G0K9M.clustalo.fasta
    output: per_gene/EOG091G0K9M/empty_check.done
    jobid: 1503
    wildcards: BUSCO=EOG091G0K9M


         if [ "$(cat per_gene/EOG091G0K9M/ALICUT_EOG091G0K9M.clustalo.fasta | grep -v ">" | sed 's/-//g' | grep "^$" | wc -l)" -gt 0 ]
         then
              cp per_gene/EOG091G0K9M/ALICUT_EOG091G0K9M.clustalo.fasta per_gene/EOG091G0K9M/ALICUT_EOG091G0K9M.clustalo.fasta.backup
              bash ../scripts/remove_empty.sh per_gene/EOG091G0K9M/ALICUT_EOG091G0K9M.clustalo.fasta.backup > per_gene/EOG091G0K9M/ALICUT_EOG091G0K9M.clustalo.fasta
         fi
         touch per_gene/EOG091G0K9M/empty_check.done
         
[Sun Jul  5 23:49:59 2020]
Finished job 1503.
2497 of 3292 steps (76%) done

[Sun Jul  5 23:49:59 2020]
rule find_best_model:
    input: per_gene/EOG091G0K9M/ALICUT_EOG091G0K9M.clustalo.fasta, per_gene/EOG091G0K9M/empty_check.done
    output: per_gene/EOG091G0K9M/EOG091G0K9M.best_model
    log: per_gene/EOG091G0K9M/find_best_model.stderr.txt
    jobid: 680
    wildcards: BUSCO=EOG091G0K9M
    threads: 2


        cd per_gene/EOG091G0K9M
        if [ ! -d find_best_model ]
        then
            mkdir find_best_model
        fi
        cd find_best_model
        ln -s ../../../per_gene/EOG091G0K9M/ALICUT_EOG091G0K9M.clustalo.fasta EOG091G0K9M.fasta
        ProteinModelSelection.pl EOG091G0K9M.fasta 1> ../../../per_gene/EOG091G0K9M/EOG091G0K9M.best_model 2> ../../../per_gene/EOG091G0K9M/find_best_model.stderr.txt
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/c0c09ee657b1e27f2c5687e0e9aa8d70.simg
[Sun Jul  5 23:50:05 2020]
Finished job 1231.
2498 of 3292 steps (76%) done

[Sun Jul  5 23:50:05 2020]
rule remove_empty:
    input: per_gene/EOG091G0WPV/ALICUT_EOG091G0WPV.clustalo.fasta
    output: per_gene/EOG091G0WPV/empty_check.done
    jobid: 2053
    wildcards: BUSCO=EOG091G0WPV


         if [ "$(cat per_gene/EOG091G0WPV/ALICUT_EOG091G0WPV.clustalo.fasta | grep -v ">" | sed 's/-//g' | grep "^$" | wc -l)" -gt 0 ]
         then
              cp per_gene/EOG091G0WPV/ALICUT_EOG091G0WPV.clustalo.fasta per_gene/EOG091G0WPV/ALICUT_EOG091G0WPV.clustalo.fasta.backup
              bash ../scripts/remove_empty.sh per_gene/EOG091G0WPV/ALICUT_EOG091G0WPV.clustalo.fasta.backup > per_gene/EOG091G0WPV/ALICUT_EOG091G0WPV.clustalo.fasta
         fi
         touch per_gene/EOG091G0WPV/empty_check.done
         
[Sun Jul  5 23:50:05 2020]
Finished job 2053.
2499 of 3292 steps (76%) done

[Sun Jul  5 23:50:05 2020]
rule find_best_model:
    input: per_gene/EOG091G0WPV/ALICUT_EOG091G0WPV.clustalo.fasta, per_gene/EOG091G0WPV/empty_check.done
    output: per_gene/EOG091G0WPV/EOG091G0WPV.best_model
    log: per_gene/EOG091G0WPV/find_best_model.stderr.txt
    jobid: 1230
    wildcards: BUSCO=EOG091G0WPV
    threads: 2


        cd per_gene/EOG091G0WPV
        if [ ! -d find_best_model ]
        then
            mkdir find_best_model
        fi
        cd find_best_model
        ln -s ../../../per_gene/EOG091G0WPV/ALICUT_EOG091G0WPV.clustalo.fasta EOG091G0WPV.fasta
        ProteinModelSelection.pl EOG091G0WPV.fasta 1> ../../../per_gene/EOG091G0WPV/EOG091G0WPV.best_model 2> ../../../per_gene/EOG091G0WPV/find_best_model.stderr.txt
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/c0c09ee657b1e27f2c5687e0e9aa8d70.simg
[Sun Jul  5 23:50:21 2020]
Finished job 1080.
2500 of 3292 steps (76%) done

[Sun Jul  5 23:50:21 2020]
rule infer_single_ML:
    input: per_gene/EOG091G050Q/EOG091G050Q.best_model, per_gene/EOG091G050Q/ALICUT_EOG091G050Q.clustalo.fasta
    output: per_gene/EOG091G050Q/EOG091G050Q.raxml.done
    log: per_gene/EOG091G050Q/infer_single_ML.stdout.txt, per_gene/EOG091G050Q/infer_single_ML.stderr.txt
    jobid: 334
    wildcards: BUSCO=EOG091G050Q
    threads: 2


        cd per_gene/EOG091G050Q
	count=$(cat ../../per_gene/EOG091G050Q/ALICUT_EOG091G050Q.clustalo.fasta | grep ">" | wc -l)
	if [ "$count" -gt 5 ]
        then
		RAxMLmodel=$(cat ../../per_gene/EOG091G050Q/EOG091G050Q.best_model | grep "Best" | cut -d ":" -f 2 | tr -d '[:space:]')
                if [ "$(ls -1 | grep "^RAxML" | wc -l)" -ne 0 ]
		then
			rm RAxML*
		fi
        	raxml -f a -T 2 -m PROTGAMMA$RAxMLmodel         	-p 12345 -x 12345 -# 100         	-s ../../per_gene/EOG091G050Q/ALICUT_EOG091G050Q.clustalo.fasta -n EOG091G050Q.clustalo.aln.ALICUT.$RAxMLmodel 		1> ../../per_gene/EOG091G050Q/infer_single_ML.stdout.txt 2> ../../per_gene/EOG091G050Q/infer_single_ML.stderr.txt
	else
		echo "fasta file per_gene/EOG091G050Q/ALICUT_EOG091G050Q.clustalo.fasta contains fewer than 5 sequences - skipped" > ../../per_gene/EOG091G050Q/infer_single_ML.stdout.txt
		touch raxml.skipped
	fi
        touch ../../per_gene/EOG091G050Q/EOG091G050Q.raxml.done
        
[Sun Jul  5 23:50:21 2020]
Finished job 1042.
2501 of 3292 steps (76%) done

[Sun Jul  5 23:50:21 2020]
rule infer_single_ML:
    input: per_gene/EOG091G0LFF/EOG091G0LFF.best_model, per_gene/EOG091G0LFF/ALICUT_EOG091G0LFF.clustalo.fasta
    output: per_gene/EOG091G0LFF/EOG091G0LFF.raxml.done
    log: per_gene/EOG091G0LFF/infer_single_ML.stdout.txt, per_gene/EOG091G0LFF/infer_single_ML.stderr.txt
    jobid: 315
    wildcards: BUSCO=EOG091G0LFF
    threads: 2


        cd per_gene/EOG091G0LFF
	count=$(cat ../../per_gene/EOG091G0LFF/ALICUT_EOG091G0LFF.clustalo.fasta | grep ">" | wc -l)
	if [ "$count" -gt 5 ]
        then
		RAxMLmodel=$(cat ../../per_gene/EOG091G0LFF/EOG091G0LFF.best_model | grep "Best" | cut -d ":" -f 2 | tr -d '[:space:]')
                if [ "$(ls -1 | grep "^RAxML" | wc -l)" -ne 0 ]
		then
			rm RAxML*
		fi
        	raxml -f a -T 2 -m PROTGAMMA$RAxMLmodel         	-p 12345 -x 12345 -# 100         	-s ../../per_gene/EOG091G0LFF/ALICUT_EOG091G0LFF.clustalo.fasta -n EOG091G0LFF.clustalo.aln.ALICUT.$RAxMLmodel 		1> ../../per_gene/EOG091G0LFF/infer_single_ML.stdout.txt 2> ../../per_gene/EOG091G0LFF/infer_single_ML.stderr.txt
	else
		echo "fasta file per_gene/EOG091G0LFF/ALICUT_EOG091G0LFF.clustalo.fasta contains fewer than 5 sequences - skipped" > ../../per_gene/EOG091G0LFF/infer_single_ML.stdout.txt
		touch raxml.skipped
	fi
        touch ../../per_gene/EOG091G0LFF/EOG091G0LFF.raxml.done
        
[Sun Jul  5 23:50:27 2020]
Finished job 1230.
2502 of 3292 steps (76%) done

[Sun Jul  5 23:50:27 2020]
rule infer_single_ML:
    input: per_gene/EOG091G0WPV/EOG091G0WPV.best_model, per_gene/EOG091G0WPV/ALICUT_EOG091G0WPV.clustalo.fasta
    output: per_gene/EOG091G0WPV/EOG091G0WPV.raxml.done
    log: per_gene/EOG091G0WPV/infer_single_ML.stdout.txt, per_gene/EOG091G0WPV/infer_single_ML.stderr.txt
    jobid: 409
    wildcards: BUSCO=EOG091G0WPV
    threads: 2


        cd per_gene/EOG091G0WPV
	count=$(cat ../../per_gene/EOG091G0WPV/ALICUT_EOG091G0WPV.clustalo.fasta | grep ">" | wc -l)
	if [ "$count" -gt 5 ]
        then
		RAxMLmodel=$(cat ../../per_gene/EOG091G0WPV/EOG091G0WPV.best_model | grep "Best" | cut -d ":" -f 2 | tr -d '[:space:]')
                if [ "$(ls -1 | grep "^RAxML" | wc -l)" -ne 0 ]
		then
			rm RAxML*
		fi
        	raxml -f a -T 2 -m PROTGAMMA$RAxMLmodel         	-p 12345 -x 12345 -# 100         	-s ../../per_gene/EOG091G0WPV/ALICUT_EOG091G0WPV.clustalo.fasta -n EOG091G0WPV.clustalo.aln.ALICUT.$RAxMLmodel 		1> ../../per_gene/EOG091G0WPV/infer_single_ML.stdout.txt 2> ../../per_gene/EOG091G0WPV/infer_single_ML.stderr.txt
	else
		echo "fasta file per_gene/EOG091G0WPV/ALICUT_EOG091G0WPV.clustalo.fasta contains fewer than 5 sequences - skipped" > ../../per_gene/EOG091G0WPV/infer_single_ML.stdout.txt
		touch raxml.skipped
	fi
        touch ../../per_gene/EOG091G0WPV/EOG091G0WPV.raxml.done
        
[Sun Jul  5 23:50:30 2020]
Finished job 680.
2503 of 3292 steps (76%) done

[Sun Jul  5 23:50:30 2020]
rule infer_single_ML:
    input: per_gene/EOG091G0K9M/EOG091G0K9M.best_model, per_gene/EOG091G0K9M/ALICUT_EOG091G0K9M.clustalo.fasta
    output: per_gene/EOG091G0K9M/EOG091G0K9M.raxml.done
    log: per_gene/EOG091G0K9M/infer_single_ML.stdout.txt, per_gene/EOG091G0K9M/infer_single_ML.stderr.txt
    jobid: 134
    wildcards: BUSCO=EOG091G0K9M
    threads: 2


        cd per_gene/EOG091G0K9M
	count=$(cat ../../per_gene/EOG091G0K9M/ALICUT_EOG091G0K9M.clustalo.fasta | grep ">" | wc -l)
	if [ "$count" -gt 5 ]
        then
		RAxMLmodel=$(cat ../../per_gene/EOG091G0K9M/EOG091G0K9M.best_model | grep "Best" | cut -d ":" -f 2 | tr -d '[:space:]')
                if [ "$(ls -1 | grep "^RAxML" | wc -l)" -ne 0 ]
		then
			rm RAxML*
		fi
        	raxml -f a -T 2 -m PROTGAMMA$RAxMLmodel         	-p 12345 -x 12345 -# 100         	-s ../../per_gene/EOG091G0K9M/ALICUT_EOG091G0K9M.clustalo.fasta -n EOG091G0K9M.clustalo.aln.ALICUT.$RAxMLmodel 		1> ../../per_gene/EOG091G0K9M/infer_single_ML.stdout.txt 2> ../../per_gene/EOG091G0K9M/infer_single_ML.stderr.txt
	else
		echo "fasta file per_gene/EOG091G0K9M/ALICUT_EOG091G0K9M.clustalo.fasta contains fewer than 5 sequences - skipped" > ../../per_gene/EOG091G0K9M/infer_single_ML.stdout.txt
		touch raxml.skipped
	fi
        touch ../../per_gene/EOG091G0K9M/EOG091G0K9M.raxml.done
        
[Sun Jul  5 23:50:30 2020]
Finished job 288.
2504 of 3292 steps (76%) done

[Sun Jul  5 23:50:30 2020]
rule get_seqs:
    input: /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ingroup.txt, /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/outgroup.txt
    output: per_gene/EOG091G0MZC/EOG091G0MZC.ingroup.fasta
    log: per_gene/EOG091G0MZC/get_seqs.stdout.txt, per_gene/EOG091G0MZC/get_seqs.stderr.txt
    jobid: 2778
    wildcards: BUSCO=EOG091G0MZC
    threads: 2


	basedir=$(pwd)
        cd per_gene/EOG091G0MZC
        
        bash $basedir/../scripts/fetch_seqs.sh EOG091G0MZC /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ingroup.txt /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/outgroup.txt 1> ../../per_gene/EOG091G0MZC/get_seqs.stdout.txt 2> ../../per_gene/EOG091G0MZC/get_seqs.stderr.txt
	mv EOG091G0MZC.fasta $basedir/per_gene/EOG091G0MZC/EOG091G0MZC.ingroup.fasta
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/72476f9d9a5bd0627b4d721143a21354.simg
[Sun Jul  5 23:50:37 2020]
Finished job 1036.
2505 of 3292 steps (76%) done

[Sun Jul  5 23:50:37 2020]
rule infer_single_ML:
    input: per_gene/EOG091G0E5O/EOG091G0E5O.best_model, per_gene/EOG091G0E5O/ALICUT_EOG091G0E5O.clustalo.fasta
    output: per_gene/EOG091G0E5O/EOG091G0E5O.raxml.done
    log: per_gene/EOG091G0E5O/infer_single_ML.stdout.txt, per_gene/EOG091G0E5O/infer_single_ML.stderr.txt
    jobid: 312
    wildcards: BUSCO=EOG091G0E5O
    threads: 2


        cd per_gene/EOG091G0E5O
	count=$(cat ../../per_gene/EOG091G0E5O/ALICUT_EOG091G0E5O.clustalo.fasta | grep ">" | wc -l)
	if [ "$count" -gt 5 ]
        then
		RAxMLmodel=$(cat ../../per_gene/EOG091G0E5O/EOG091G0E5O.best_model | grep "Best" | cut -d ":" -f 2 | tr -d '[:space:]')
                if [ "$(ls -1 | grep "^RAxML" | wc -l)" -ne 0 ]
		then
			rm RAxML*
		fi
        	raxml -f a -T 2 -m PROTGAMMA$RAxMLmodel         	-p 12345 -x 12345 -# 100         	-s ../../per_gene/EOG091G0E5O/ALICUT_EOG091G0E5O.clustalo.fasta -n EOG091G0E5O.clustalo.aln.ALICUT.$RAxMLmodel 		1> ../../per_gene/EOG091G0E5O/infer_single_ML.stdout.txt 2> ../../per_gene/EOG091G0E5O/infer_single_ML.stderr.txt
	else
		echo "fasta file per_gene/EOG091G0E5O/ALICUT_EOG091G0E5O.clustalo.fasta contains fewer than 5 sequences - skipped" > ../../per_gene/EOG091G0E5O/infer_single_ML.stdout.txt
		touch raxml.skipped
	fi
        touch ../../per_gene/EOG091G0E5O/EOG091G0E5O.raxml.done
        
[Sun Jul  5 23:50:44 2020]
Finished job 2778.
2506 of 3292 steps (76%) done

[Sun Jul  5 23:50:44 2020]
rule get_outgroups:
    input: per_gene/EOG091G0MZC/EOG091G0MZC.ingroup.fasta
    output: per_gene/EOG091G0MZC/EOG091G0MZC.orthodb.fasta, per_gene/EOG091G0MZC/EOG091G0MZC.outgroup.fasta
    log: per_gene/EOG091G0MZC/get_outgroups.stdout.txt, per_gene/EOG091G0MZC/get_outgroups.stderr.txt
    jobid: 2779
    wildcards: BUSCO=EOG091G0MZC


        #download fastas from Orhtodb for BUSCO id
        for i in {1..5}
        do
             wget "http://www.orthodb.org/fasta?query=EOG091G0MZC&level=33208" -O per_gene/EOG091G0MZC/EOG091G0MZC.orthodb.fasta 1> per_gene/EOG091G0MZC/get_outgroups.stdout.txt 2> per_gene/EOG091G0MZC/get_outgroups.stderr.txt && break || echo -e "try again ($i)" && sleep 15
        done

	#This is quick an dirty for now and just takes the first protein if there is more than one for an outgroup taxon
        bash ../scripts/download_outgroups.sh taxids.txt per_gene/EOG091G0MZC/EOG091G0MZC.orthodb.fasta > per_gene/EOG091G0MZC/EOG091G0MZC.outgroup.fasta
        
[Sun Jul  5 23:50:45 2020]
Finished job 2779.
2507 of 3292 steps (76%) done

[Sun Jul  5 23:50:45 2020]
rule join_groups:
    input: per_gene/EOG091G0MZC/EOG091G0MZC.ingroup.fasta, per_gene/EOG091G0MZC/EOG091G0MZC.outgroup.fasta
    output: per_gene/EOG091G0MZC/EOG091G0MZC.fasta
    jobid: 2213
    wildcards: BUSCO=EOG091G0MZC


        cat per_gene/EOG091G0MZC/EOG091G0MZC.ingroup.fasta per_gene/EOG091G0MZC/EOG091G0MZC.outgroup.fasta > per_gene/EOG091G0MZC/EOG091G0MZC.fasta
        
[Sun Jul  5 23:50:45 2020]
Finished job 2213.
2508 of 3292 steps (76%) done

[Sun Jul  5 23:50:45 2020]
rule MSA:
    input: per_gene/EOG091G0MZC/EOG091G0MZC.fasta
    output: per_gene/EOG091G0MZC/EOG091G0MZC.clustalo.fasta
    log: per_gene/EOG091G0MZC/MSA.stdout.txt, per_gene/EOG091G0MZC/MSA.stderr.txt
    jobid: 1546
    wildcards: BUSCO=EOG091G0MZC
    threads: 2


        clustalo -i per_gene/EOG091G0MZC/EOG091G0MZC.fasta -o per_gene/EOG091G0MZC/EOG091G0MZC.clustalo.fasta --threads=2 1> per_gene/EOG091G0MZC/MSA.stdout.txt 2> per_gene/EOG091G0MZC/MSA.stderr.txt
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/d68c9691725a7401923680874285c430.simg
[Sun Jul  5 23:50:46 2020]
Finished job 1546.
2509 of 3292 steps (76%) done

[Sun Jul  5 23:50:46 2020]
rule score_and_cut:
    input: per_gene/EOG091G0MZC/EOG091G0MZC.clustalo.fasta
    output: per_gene/EOG091G0MZC/ALICUT_EOG091G0MZC.clustalo.fasta
    jobid: 723
    wildcards: BUSCO=EOG091G0MZC
    threads: 2


        cd per_gene/EOG091G0MZC
        Aliscore.pl -N -r 200000000000000000 -i ../../per_gene/EOG091G0MZC/EOG091G0MZC.clustalo.fasta &> aliscore.log
        ALICUT.pl -s &> alicut.log
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/63c88c27a0fa300f57066b0ef65fefcb.simg
[Sun Jul  5 23:50:53 2020]
Finished job 123.
2510 of 3292 steps (76%) done

[Sun Jul  5 23:50:53 2020]
rule get_seqs:
    input: /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ingroup.txt, /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/outgroup.txt
    output: per_gene/EOG091G0II3/EOG091G0II3.ingroup.fasta
    log: per_gene/EOG091G0II3/get_seqs.stdout.txt, per_gene/EOG091G0II3/get_seqs.stderr.txt
    jobid: 2712
    wildcards: BUSCO=EOG091G0II3
    threads: 2


	basedir=$(pwd)
        cd per_gene/EOG091G0II3
        
        bash $basedir/../scripts/fetch_seqs.sh EOG091G0II3 /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ingroup.txt /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/outgroup.txt 1> ../../per_gene/EOG091G0II3/get_seqs.stdout.txt 2> ../../per_gene/EOG091G0II3/get_seqs.stderr.txt
	mv EOG091G0II3.fasta $basedir/per_gene/EOG091G0II3/EOG091G0II3.ingroup.fasta
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/72476f9d9a5bd0627b4d721143a21354.simg
[Sun Jul  5 23:50:55 2020]
Finished job 723.
2511 of 3292 steps (76%) done

[Sun Jul  5 23:50:55 2020]
rule remove_empty:
    input: per_gene/EOG091G0MZC/ALICUT_EOG091G0MZC.clustalo.fasta
    output: per_gene/EOG091G0MZC/empty_check.done
    jobid: 1545
    wildcards: BUSCO=EOG091G0MZC


         if [ "$(cat per_gene/EOG091G0MZC/ALICUT_EOG091G0MZC.clustalo.fasta | grep -v ">" | sed 's/-//g' | grep "^$" | wc -l)" -gt 0 ]
         then
              cp per_gene/EOG091G0MZC/ALICUT_EOG091G0MZC.clustalo.fasta per_gene/EOG091G0MZC/ALICUT_EOG091G0MZC.clustalo.fasta.backup
              bash ../scripts/remove_empty.sh per_gene/EOG091G0MZC/ALICUT_EOG091G0MZC.clustalo.fasta.backup > per_gene/EOG091G0MZC/ALICUT_EOG091G0MZC.clustalo.fasta
         fi
         touch per_gene/EOG091G0MZC/empty_check.done
         
[Sun Jul  5 23:50:55 2020]
Finished job 1545.
2512 of 3292 steps (76%) done

[Sun Jul  5 23:50:55 2020]
rule find_best_model:
    input: per_gene/EOG091G0MZC/ALICUT_EOG091G0MZC.clustalo.fasta, per_gene/EOG091G0MZC/empty_check.done
    output: per_gene/EOG091G0MZC/EOG091G0MZC.best_model
    log: per_gene/EOG091G0MZC/find_best_model.stderr.txt
    jobid: 722
    wildcards: BUSCO=EOG091G0MZC
    threads: 2


        cd per_gene/EOG091G0MZC
        if [ ! -d find_best_model ]
        then
            mkdir find_best_model
        fi
        cd find_best_model
        ln -s ../../../per_gene/EOG091G0MZC/ALICUT_EOG091G0MZC.clustalo.fasta EOG091G0MZC.fasta
        ProteinModelSelection.pl EOG091G0MZC.fasta 1> ../../../per_gene/EOG091G0MZC/EOG091G0MZC.best_model 2> ../../../per_gene/EOG091G0MZC/find_best_model.stderr.txt
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/c0c09ee657b1e27f2c5687e0e9aa8d70.simg
[Sun Jul  5 23:51:05 2020]
Finished job 2712.
2513 of 3292 steps (76%) done

[Sun Jul  5 23:51:05 2020]
rule get_outgroups:
    input: per_gene/EOG091G0II3/EOG091G0II3.ingroup.fasta
    output: per_gene/EOG091G0II3/EOG091G0II3.orthodb.fasta, per_gene/EOG091G0II3/EOG091G0II3.outgroup.fasta
    log: per_gene/EOG091G0II3/get_outgroups.stdout.txt, per_gene/EOG091G0II3/get_outgroups.stderr.txt
    jobid: 2713
    wildcards: BUSCO=EOG091G0II3


        #download fastas from Orhtodb for BUSCO id
        for i in {1..5}
        do
             wget "http://www.orthodb.org/fasta?query=EOG091G0II3&level=33208" -O per_gene/EOG091G0II3/EOG091G0II3.orthodb.fasta 1> per_gene/EOG091G0II3/get_outgroups.stdout.txt 2> per_gene/EOG091G0II3/get_outgroups.stderr.txt && break || echo -e "try again ($i)" && sleep 15
        done

	#This is quick an dirty for now and just takes the first protein if there is more than one for an outgroup taxon
        bash ../scripts/download_outgroups.sh taxids.txt per_gene/EOG091G0II3/EOG091G0II3.orthodb.fasta > per_gene/EOG091G0II3/EOG091G0II3.outgroup.fasta
        
[Sun Jul  5 23:51:05 2020]
Finished job 2713.
2514 of 3292 steps (76%) done

[Sun Jul  5 23:51:05 2020]
rule join_groups:
    input: per_gene/EOG091G0II3/EOG091G0II3.ingroup.fasta, per_gene/EOG091G0II3/EOG091G0II3.outgroup.fasta
    output: per_gene/EOG091G0II3/EOG091G0II3.fasta
    jobid: 2180
    wildcards: BUSCO=EOG091G0II3


        cat per_gene/EOG091G0II3/EOG091G0II3.ingroup.fasta per_gene/EOG091G0II3/EOG091G0II3.outgroup.fasta > per_gene/EOG091G0II3/EOG091G0II3.fasta
        
[Sun Jul  5 23:51:05 2020]
Finished job 2180.
2515 of 3292 steps (76%) done

[Sun Jul  5 23:51:05 2020]
rule MSA:
    input: per_gene/EOG091G0II3/EOG091G0II3.fasta
    output: per_gene/EOG091G0II3/EOG091G0II3.clustalo.fasta
    log: per_gene/EOG091G0II3/MSA.stdout.txt, per_gene/EOG091G0II3/MSA.stderr.txt
    jobid: 1480
    wildcards: BUSCO=EOG091G0II3
    threads: 2


        clustalo -i per_gene/EOG091G0II3/EOG091G0II3.fasta -o per_gene/EOG091G0II3/EOG091G0II3.clustalo.fasta --threads=2 1> per_gene/EOG091G0II3/MSA.stdout.txt 2> per_gene/EOG091G0II3/MSA.stderr.txt
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/d68c9691725a7401923680874285c430.simg
[Sun Jul  5 23:51:06 2020]
Finished job 1480.
2516 of 3292 steps (76%) done

[Sun Jul  5 23:51:06 2020]
rule score_and_cut:
    input: per_gene/EOG091G0II3/EOG091G0II3.clustalo.fasta
    output: per_gene/EOG091G0II3/ALICUT_EOG091G0II3.clustalo.fasta
    jobid: 657
    wildcards: BUSCO=EOG091G0II3
    threads: 2


        cd per_gene/EOG091G0II3
        Aliscore.pl -N -r 200000000000000000 -i ../../per_gene/EOG091G0II3/EOG091G0II3.clustalo.fasta &> aliscore.log
        ALICUT.pl -s &> alicut.log
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/63c88c27a0fa300f57066b0ef65fefcb.simg
[Sun Jul  5 23:51:07 2020]
Finished job 146.
2517 of 3292 steps (76%) done

[Sun Jul  5 23:51:07 2020]
rule get_seqs:
    input: /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ingroup.txt, /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/outgroup.txt
    output: per_gene/EOG091G0K82/EOG091G0K82.ingroup.fasta
    log: per_gene/EOG091G0K82/get_seqs.stdout.txt, per_gene/EOG091G0K82/get_seqs.stderr.txt
    jobid: 2732
    wildcards: BUSCO=EOG091G0K82
    threads: 2


	basedir=$(pwd)
        cd per_gene/EOG091G0K82
        
        bash $basedir/../scripts/fetch_seqs.sh EOG091G0K82 /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ingroup.txt /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/outgroup.txt 1> ../../per_gene/EOG091G0K82/get_seqs.stdout.txt 2> ../../per_gene/EOG091G0K82/get_seqs.stderr.txt
	mv EOG091G0K82.fasta $basedir/per_gene/EOG091G0K82/EOG091G0K82.ingroup.fasta
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/72476f9d9a5bd0627b4d721143a21354.simg
[Sun Jul  5 23:51:14 2020]
Finished job 657.
2518 of 3292 steps (76%) done

[Sun Jul  5 23:51:14 2020]
rule remove_empty:
    input: per_gene/EOG091G0II3/ALICUT_EOG091G0II3.clustalo.fasta
    output: per_gene/EOG091G0II3/empty_check.done
    jobid: 1479
    wildcards: BUSCO=EOG091G0II3


         if [ "$(cat per_gene/EOG091G0II3/ALICUT_EOG091G0II3.clustalo.fasta | grep -v ">" | sed 's/-//g' | grep "^$" | wc -l)" -gt 0 ]
         then
              cp per_gene/EOG091G0II3/ALICUT_EOG091G0II3.clustalo.fasta per_gene/EOG091G0II3/ALICUT_EOG091G0II3.clustalo.fasta.backup
              bash ../scripts/remove_empty.sh per_gene/EOG091G0II3/ALICUT_EOG091G0II3.clustalo.fasta.backup > per_gene/EOG091G0II3/ALICUT_EOG091G0II3.clustalo.fasta
         fi
         touch per_gene/EOG091G0II3/empty_check.done
         
[Sun Jul  5 23:51:14 2020]
Finished job 1479.
2519 of 3292 steps (77%) done

[Sun Jul  5 23:51:14 2020]
rule find_best_model:
    input: per_gene/EOG091G0II3/ALICUT_EOG091G0II3.clustalo.fasta, per_gene/EOG091G0II3/empty_check.done
    output: per_gene/EOG091G0II3/EOG091G0II3.best_model
    log: per_gene/EOG091G0II3/find_best_model.stderr.txt
    jobid: 656
    wildcards: BUSCO=EOG091G0II3
    threads: 2


        cd per_gene/EOG091G0II3
        if [ ! -d find_best_model ]
        then
            mkdir find_best_model
        fi
        cd find_best_model
        ln -s ../../../per_gene/EOG091G0II3/ALICUT_EOG091G0II3.clustalo.fasta EOG091G0II3.fasta
        ProteinModelSelection.pl EOG091G0II3.fasta 1> ../../../per_gene/EOG091G0II3/EOG091G0II3.best_model 2> ../../../per_gene/EOG091G0II3/find_best_model.stderr.txt
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/c0c09ee657b1e27f2c5687e0e9aa8d70.simg
[33mJob counts:
	count	jobs
	1	infer_single_ML
	1[0m
[33m
        cd per_gene/EOG091G0LFF
	count=$(cat ../../per_gene/EOG091G0LFF/ALICUT_EOG091G0LFF.clustalo.fasta | grep ">" | wc -l)
	if [ "$count" -gt 5 ]
        then
		RAxMLmodel=$(cat ../../per_gene/EOG091G0LFF/EOG091G0LFF.best_model | grep "Best" | cut -d ":" -f 2 | tr -d '[:space:]')
                if [ "$(ls -1 | grep "^RAxML" | wc -l)" -ne 0 ]
		then
			rm RAxML*
		fi
        	raxml -f a -T 2 -m PROTGAMMA$RAxMLmodel         	-p 12345 -x 12345 -# 100         	-s ../../per_gene/EOG091G0LFF/ALICUT_EOG091G0LFF.clustalo.fasta -n EOG091G0LFF.clustalo.aln.ALICUT.$RAxMLmodel 		1> ../../per_gene/EOG091G0LFF/infer_single_ML.stdout.txt 2> ../../per_gene/EOG091G0LFF/infer_single_ML.stderr.txt
	else
		echo "fasta file per_gene/EOG091G0LFF/ALICUT_EOG091G0LFF.clustalo.fasta contains fewer than 5 sequences - skipped" > ../../per_gene/EOG091G0LFF/infer_single_ML.stdout.txt
		touch raxml.skipped
	fi
        touch ../../per_gene/EOG091G0LFF/EOG091G0LFF.raxml.done
        [0m
[33mJob counts:
	count	jobs
	1	infer_single_ML
	1[0m
[33m
        cd per_gene/EOG091G0K9M
	count=$(cat ../../per_gene/EOG091G0K9M/ALICUT_EOG091G0K9M.clustalo.fasta | grep ">" | wc -l)
	if [ "$count" -gt 5 ]
        then
		RAxMLmodel=$(cat ../../per_gene/EOG091G0K9M/EOG091G0K9M.best_model | grep "Best" | cut -d ":" -f 2 | tr -d '[:space:]')
                if [ "$(ls -1 | grep "^RAxML" | wc -l)" -ne 0 ]
		then
			rm RAxML*
		fi
        	raxml -f a -T 2 -m PROTGAMMA$RAxMLmodel         	-p 12345 -x 12345 -# 100         	-s ../../per_gene/EOG091G0K9M/ALICUT_EOG091G0K9M.clustalo.fasta -n EOG091G0K9M.clustalo.aln.ALICUT.$RAxMLmodel 		1> ../../per_gene/EOG091G0K9M/infer_single_ML.stdout.txt 2> ../../per_gene/EOG091G0K9M/infer_single_ML.stderr.txt
	else
		echo "fasta file per_gene/EOG091G0K9M/ALICUT_EOG091G0K9M.clustalo.fasta contains fewer than 5 sequences - skipped" > ../../per_gene/EOG091G0K9M/infer_single_ML.stdout.txt
		touch raxml.skipped
	fi
        touch ../../per_gene/EOG091G0K9M/EOG091G0K9M.raxml.done
        [0m
[33mJob counts:
	count	jobs
	1	infer_single_ML
	1[0m
[33m
        cd per_gene/EOG091G0WPV
	count=$(cat ../../per_gene/EOG091G0WPV/ALICUT_EOG091G0WPV.clustalo.fasta | grep ">" | wc -l)
	if [ "$count" -gt 5 ]
        then
		RAxMLmodel=$(cat ../../per_gene/EOG091G0WPV/EOG091G0WPV.best_model | grep "Best" | cut -d ":" -f 2 | tr -d '[:space:]')
                if [ "$(ls -1 | grep "^RAxML" | wc -l)" -ne 0 ]
		then
			rm RAxML*
		fi
        	raxml -f a -T 2 -m PROTGAMMA$RAxMLmodel         	-p 12345 -x 12345 -# 100         	-s ../../per_gene/EOG091G0WPV/ALICUT_EOG091G0WPV.clustalo.fasta -n EOG091G0WPV.clustalo.aln.ALICUT.$RAxMLmodel 		1> ../../per_gene/EOG091G0WPV/infer_single_ML.stdout.txt 2> ../../per_gene/EOG091G0WPV/infer_single_ML.stderr.txt
	else
		echo "fasta file per_gene/EOG091G0WPV/ALICUT_EOG091G0WPV.clustalo.fasta contains fewer than 5 sequences - skipped" > ../../per_gene/EOG091G0WPV/infer_single_ML.stdout.txt
		touch raxml.skipped
	fi
        touch ../../per_gene/EOG091G0WPV/EOG091G0WPV.raxml.done
        [0m
[33mJob counts:
	count	jobs
	1	infer_single_ML
	1[0m
[33m
        cd per_gene/EOG091G0E5O
	count=$(cat ../../per_gene/EOG091G0E5O/ALICUT_EOG091G0E5O.clustalo.fasta | grep ">" | wc -l)
	if [ "$count" -gt 5 ]
        then
		RAxMLmodel=$(cat ../../per_gene/EOG091G0E5O/EOG091G0E5O.best_model | grep "Best" | cut -d ":" -f 2 | tr -d '[:space:]')
                if [ "$(ls -1 | grep "^RAxML" | wc -l)" -ne 0 ]
		then
			rm RAxML*
		fi
        	raxml -f a -T 2 -m PROTGAMMA$RAxMLmodel         	-p 12345 -x 12345 -# 100         	-s ../../per_gene/EOG091G0E5O/ALICUT_EOG091G0E5O.clustalo.fasta -n EOG091G0E5O.clustalo.aln.ALICUT.$RAxMLmodel 		1> ../../per_gene/EOG091G0E5O/infer_single_ML.stdout.txt 2> ../../per_gene/EOG091G0E5O/infer_single_ML.stderr.txt
	else
		echo "fasta file per_gene/EOG091G0E5O/ALICUT_EOG091G0E5O.clustalo.fasta contains fewer than 5 sequences - skipped" > ../../per_gene/EOG091G0E5O/infer_single_ML.stdout.txt
		touch raxml.skipped
	fi
        touch ../../per_gene/EOG091G0E5O/EOG091G0E5O.raxml.done
        [0m
[33mJob counts:
	count	jobs
	1	infer_single_ML
	1[0m
[33m
        cd per_gene/EOG091G050Q
	count=$(cat ../../per_gene/EOG091G050Q/ALICUT_EOG091G050Q.clustalo.fasta | grep ">" | wc -l)
	if [ "$count" -gt 5 ]
        then
		RAxMLmodel=$(cat ../../per_gene/EOG091G050Q/EOG091G050Q.best_model | grep "Best" | cut -d ":" -f 2 | tr -d '[:space:]')
                if [ "$(ls -1 | grep "^RAxML" | wc -l)" -ne 0 ]
		then
			rm RAxML*
		fi
        	raxml -f a -T 2 -m PROTGAMMA$RAxMLmodel         	-p 12345 -x 12345 -# 100         	-s ../../per_gene/EOG091G050Q/ALICUT_EOG091G050Q.clustalo.fasta -n EOG091G050Q.clustalo.aln.ALICUT.$RAxMLmodel 		1> ../../per_gene/EOG091G050Q/infer_single_ML.stdout.txt 2> ../../per_gene/EOG091G050Q/infer_single_ML.stderr.txt
	else
		echo "fasta file per_gene/EOG091G050Q/ALICUT_EOG091G050Q.clustalo.fasta contains fewer than 5 sequences - skipped" > ../../per_gene/EOG091G050Q/infer_single_ML.stdout.txt
		touch raxml.skipped
	fi
        touch ../../per_gene/EOG091G050Q/EOG091G050Q.raxml.done
        [0m
[Sun Jul  5 23:51:19 2020]
Finished job 722.
2520 of 3292 steps (77%) done

[Sun Jul  5 23:51:19 2020]
rule infer_single_ML:
    input: per_gene/EOG091G0MZC/EOG091G0MZC.best_model, per_gene/EOG091G0MZC/ALICUT_EOG091G0MZC.clustalo.fasta
    output: per_gene/EOG091G0MZC/EOG091G0MZC.raxml.done
    log: per_gene/EOG091G0MZC/infer_single_ML.stdout.txt, per_gene/EOG091G0MZC/infer_single_ML.stderr.txt
    jobid: 155
    wildcards: BUSCO=EOG091G0MZC
    threads: 2


        cd per_gene/EOG091G0MZC
	count=$(cat ../../per_gene/EOG091G0MZC/ALICUT_EOG091G0MZC.clustalo.fasta | grep ">" | wc -l)
	if [ "$count" -gt 5 ]
        then
		RAxMLmodel=$(cat ../../per_gene/EOG091G0MZC/EOG091G0MZC.best_model | grep "Best" | cut -d ":" -f 2 | tr -d '[:space:]')
                if [ "$(ls -1 | grep "^RAxML" | wc -l)" -ne 0 ]
		then
			rm RAxML*
		fi
        	raxml -f a -T 2 -m PROTGAMMA$RAxMLmodel         	-p 12345 -x 12345 -# 100         	-s ../../per_gene/EOG091G0MZC/ALICUT_EOG091G0MZC.clustalo.fasta -n EOG091G0MZC.clustalo.aln.ALICUT.$RAxMLmodel 		1> ../../per_gene/EOG091G0MZC/infer_single_ML.stdout.txt 2> ../../per_gene/EOG091G0MZC/infer_single_ML.stderr.txt
	else
		echo "fasta file per_gene/EOG091G0MZC/ALICUT_EOG091G0MZC.clustalo.fasta contains fewer than 5 sequences - skipped" > ../../per_gene/EOG091G0MZC/infer_single_ML.stdout.txt
		touch raxml.skipped
	fi
        touch ../../per_gene/EOG091G0MZC/EOG091G0MZC.raxml.done
        
[Sun Jul  5 23:51:20 2020]
Finished job 2732.
2521 of 3292 steps (77%) done

[Sun Jul  5 23:51:20 2020]
rule get_outgroups:
    input: per_gene/EOG091G0K82/EOG091G0K82.ingroup.fasta
    output: per_gene/EOG091G0K82/EOG091G0K82.orthodb.fasta, per_gene/EOG091G0K82/EOG091G0K82.outgroup.fasta
    log: per_gene/EOG091G0K82/get_outgroups.stdout.txt, per_gene/EOG091G0K82/get_outgroups.stderr.txt
    jobid: 2733
    wildcards: BUSCO=EOG091G0K82


        #download fastas from Orhtodb for BUSCO id
        for i in {1..5}
        do
             wget "http://www.orthodb.org/fasta?query=EOG091G0K82&level=33208" -O per_gene/EOG091G0K82/EOG091G0K82.orthodb.fasta 1> per_gene/EOG091G0K82/get_outgroups.stdout.txt 2> per_gene/EOG091G0K82/get_outgroups.stderr.txt && break || echo -e "try again ($i)" && sleep 15
        done

	#This is quick an dirty for now and just takes the first protein if there is more than one for an outgroup taxon
        bash ../scripts/download_outgroups.sh taxids.txt per_gene/EOG091G0K82/EOG091G0K82.orthodb.fasta > per_gene/EOG091G0K82/EOG091G0K82.outgroup.fasta
        
[Sun Jul  5 23:51:21 2020]
Finished job 2733.
2522 of 3292 steps (77%) done

[Sun Jul  5 23:51:21 2020]
rule join_groups:
    input: per_gene/EOG091G0K82/EOG091G0K82.ingroup.fasta, per_gene/EOG091G0K82/EOG091G0K82.outgroup.fasta
    output: per_gene/EOG091G0K82/EOG091G0K82.fasta
    jobid: 2190
    wildcards: BUSCO=EOG091G0K82


        cat per_gene/EOG091G0K82/EOG091G0K82.ingroup.fasta per_gene/EOG091G0K82/EOG091G0K82.outgroup.fasta > per_gene/EOG091G0K82/EOG091G0K82.fasta
        
[Sun Jul  5 23:51:22 2020]
Finished job 2190.
2523 of 3292 steps (77%) done

[Sun Jul  5 23:51:22 2020]
rule MSA:
    input: per_gene/EOG091G0K82/EOG091G0K82.fasta
    output: per_gene/EOG091G0K82/EOG091G0K82.clustalo.fasta
    log: per_gene/EOG091G0K82/MSA.stdout.txt, per_gene/EOG091G0K82/MSA.stderr.txt
    jobid: 1500
    wildcards: BUSCO=EOG091G0K82
    threads: 2


        clustalo -i per_gene/EOG091G0K82/EOG091G0K82.fasta -o per_gene/EOG091G0K82/EOG091G0K82.clustalo.fasta --threads=2 1> per_gene/EOG091G0K82/MSA.stdout.txt 2> per_gene/EOG091G0K82/MSA.stderr.txt
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/d68c9691725a7401923680874285c430.simg
[33mJob counts:
	count	jobs
	1	infer_single_ML
	1[0m
[33m
        cd per_gene/EOG091G0MZC
	count=$(cat ../../per_gene/EOG091G0MZC/ALICUT_EOG091G0MZC.clustalo.fasta | grep ">" | wc -l)
	if [ "$count" -gt 5 ]
        then
		RAxMLmodel=$(cat ../../per_gene/EOG091G0MZC/EOG091G0MZC.best_model | grep "Best" | cut -d ":" -f 2 | tr -d '[:space:]')
                if [ "$(ls -1 | grep "^RAxML" | wc -l)" -ne 0 ]
		then
			rm RAxML*
		fi
        	raxml -f a -T 2 -m PROTGAMMA$RAxMLmodel         	-p 12345 -x 12345 -# 100         	-s ../../per_gene/EOG091G0MZC/ALICUT_EOG091G0MZC.clustalo.fasta -n EOG091G0MZC.clustalo.aln.ALICUT.$RAxMLmodel 		1> ../../per_gene/EOG091G0MZC/infer_single_ML.stdout.txt 2> ../../per_gene/EOG091G0MZC/infer_single_ML.stderr.txt
	else
		echo "fasta file per_gene/EOG091G0MZC/ALICUT_EOG091G0MZC.clustalo.fasta contains fewer than 5 sequences - skipped" > ../../per_gene/EOG091G0MZC/infer_single_ML.stdout.txt
		touch raxml.skipped
	fi
        touch ../../per_gene/EOG091G0MZC/EOG091G0MZC.raxml.done
        [0m
[Sun Jul  5 23:51:23 2020]
Finished job 1500.
2524 of 3292 steps (77%) done

[Sun Jul  5 23:51:23 2020]
rule score_and_cut:
    input: per_gene/EOG091G0K82/EOG091G0K82.clustalo.fasta
    output: per_gene/EOG091G0K82/ALICUT_EOG091G0K82.clustalo.fasta
    jobid: 677
    wildcards: BUSCO=EOG091G0K82
    threads: 2


        cd per_gene/EOG091G0K82
        Aliscore.pl -N -r 200000000000000000 -i ../../per_gene/EOG091G0K82/EOG091G0K82.clustalo.fasta &> aliscore.log
        ALICUT.pl -s &> alicut.log
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/63c88c27a0fa300f57066b0ef65fefcb.simg
[Sun Jul  5 23:51:29 2020]
Finished job 197.
2525 of 3292 steps (77%) done

[Sun Jul  5 23:51:29 2020]
rule get_seqs:
    input: /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ingroup.txt, /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/outgroup.txt
    output: per_gene/EOG091G07Z0/EOG091G07Z0.ingroup.fasta
    log: per_gene/EOG091G07Z0/get_seqs.stdout.txt, per_gene/EOG091G07Z0/get_seqs.stderr.txt
    jobid: 2960
    wildcards: BUSCO=EOG091G07Z0
    threads: 2


	basedir=$(pwd)
        cd per_gene/EOG091G07Z0
        
        bash $basedir/../scripts/fetch_seqs.sh EOG091G07Z0 /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ingroup.txt /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/outgroup.txt 1> ../../per_gene/EOG091G07Z0/get_seqs.stdout.txt 2> ../../per_gene/EOG091G07Z0/get_seqs.stderr.txt
	mv EOG091G07Z0.fasta $basedir/per_gene/EOG091G07Z0/EOG091G07Z0.ingroup.fasta
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/72476f9d9a5bd0627b4d721143a21354.simg
[Sun Jul  5 23:51:32 2020]
Finished job 90.
2526 of 3292 steps (77%) done

[Sun Jul  5 23:51:32 2020]
rule get_seqs:
    input: /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ingroup.txt, /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/outgroup.txt
    output: per_gene/EOG091G05OR/EOG091G05OR.ingroup.fasta
    log: per_gene/EOG091G05OR/get_seqs.stdout.txt, per_gene/EOG091G05OR/get_seqs.stderr.txt
    jobid: 2548
    wildcards: BUSCO=EOG091G05OR
    threads: 2


	basedir=$(pwd)
        cd per_gene/EOG091G05OR
        
        bash $basedir/../scripts/fetch_seqs.sh EOG091G05OR /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ingroup.txt /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/outgroup.txt 1> ../../per_gene/EOG091G05OR/get_seqs.stdout.txt 2> ../../per_gene/EOG091G05OR/get_seqs.stderr.txt
	mv EOG091G05OR.fasta $basedir/per_gene/EOG091G05OR/EOG091G05OR.ingroup.fasta
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/72476f9d9a5bd0627b4d721143a21354.simg
[Sun Jul  5 23:51:33 2020]
Finished job 677.
2527 of 3292 steps (77%) done

[Sun Jul  5 23:51:33 2020]
rule remove_empty:
    input: per_gene/EOG091G0K82/ALICUT_EOG091G0K82.clustalo.fasta
    output: per_gene/EOG091G0K82/empty_check.done
    jobid: 1499
    wildcards: BUSCO=EOG091G0K82


         if [ "$(cat per_gene/EOG091G0K82/ALICUT_EOG091G0K82.clustalo.fasta | grep -v ">" | sed 's/-//g' | grep "^$" | wc -l)" -gt 0 ]
         then
              cp per_gene/EOG091G0K82/ALICUT_EOG091G0K82.clustalo.fasta per_gene/EOG091G0K82/ALICUT_EOG091G0K82.clustalo.fasta.backup
              bash ../scripts/remove_empty.sh per_gene/EOG091G0K82/ALICUT_EOG091G0K82.clustalo.fasta.backup > per_gene/EOG091G0K82/ALICUT_EOG091G0K82.clustalo.fasta
         fi
         touch per_gene/EOG091G0K82/empty_check.done
         
[Sun Jul  5 23:51:33 2020]
Finished job 1499.
2528 of 3292 steps (77%) done

[Sun Jul  5 23:51:33 2020]
rule find_best_model:
    input: per_gene/EOG091G0K82/ALICUT_EOG091G0K82.clustalo.fasta, per_gene/EOG091G0K82/empty_check.done
    output: per_gene/EOG091G0K82/EOG091G0K82.best_model
    log: per_gene/EOG091G0K82/find_best_model.stderr.txt
    jobid: 676
    wildcards: BUSCO=EOG091G0K82
    threads: 2


        cd per_gene/EOG091G0K82
        if [ ! -d find_best_model ]
        then
            mkdir find_best_model
        fi
        cd find_best_model
        ln -s ../../../per_gene/EOG091G0K82/ALICUT_EOG091G0K82.clustalo.fasta EOG091G0K82.fasta
        ProteinModelSelection.pl EOG091G0K82.fasta 1> ../../../per_gene/EOG091G0K82/EOG091G0K82.best_model 2> ../../../per_gene/EOG091G0K82/find_best_model.stderr.txt
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/c0c09ee657b1e27f2c5687e0e9aa8d70.simg
[Sun Jul  5 23:51:37 2020]
Finished job 656.
2529 of 3292 steps (77%) done

[Sun Jul  5 23:51:37 2020]
rule infer_single_ML:
    input: per_gene/EOG091G0II3/EOG091G0II3.best_model, per_gene/EOG091G0II3/ALICUT_EOG091G0II3.clustalo.fasta
    output: per_gene/EOG091G0II3/EOG091G0II3.raxml.done
    log: per_gene/EOG091G0II3/infer_single_ML.stdout.txt, per_gene/EOG091G0II3/infer_single_ML.stderr.txt
    jobid: 122
    wildcards: BUSCO=EOG091G0II3
    threads: 2


        cd per_gene/EOG091G0II3
	count=$(cat ../../per_gene/EOG091G0II3/ALICUT_EOG091G0II3.clustalo.fasta | grep ">" | wc -l)
	if [ "$count" -gt 5 ]
        then
		RAxMLmodel=$(cat ../../per_gene/EOG091G0II3/EOG091G0II3.best_model | grep "Best" | cut -d ":" -f 2 | tr -d '[:space:]')
                if [ "$(ls -1 | grep "^RAxML" | wc -l)" -ne 0 ]
		then
			rm RAxML*
		fi
        	raxml -f a -T 2 -m PROTGAMMA$RAxMLmodel         	-p 12345 -x 12345 -# 100         	-s ../../per_gene/EOG091G0II3/ALICUT_EOG091G0II3.clustalo.fasta -n EOG091G0II3.clustalo.aln.ALICUT.$RAxMLmodel 		1> ../../per_gene/EOG091G0II3/infer_single_ML.stdout.txt 2> ../../per_gene/EOG091G0II3/infer_single_ML.stderr.txt
	else
		echo "fasta file per_gene/EOG091G0II3/ALICUT_EOG091G0II3.clustalo.fasta contains fewer than 5 sequences - skipped" > ../../per_gene/EOG091G0II3/infer_single_ML.stdout.txt
		touch raxml.skipped
	fi
        touch ../../per_gene/EOG091G0II3/EOG091G0II3.raxml.done
        
[33mJob counts:
	count	jobs
	1	infer_single_ML
	1[0m
[33m
        cd per_gene/EOG091G0II3
	count=$(cat ../../per_gene/EOG091G0II3/ALICUT_EOG091G0II3.clustalo.fasta | grep ">" | wc -l)
	if [ "$count" -gt 5 ]
        then
		RAxMLmodel=$(cat ../../per_gene/EOG091G0II3/EOG091G0II3.best_model | grep "Best" | cut -d ":" -f 2 | tr -d '[:space:]')
                if [ "$(ls -1 | grep "^RAxML" | wc -l)" -ne 0 ]
		then
			rm RAxML*
		fi
        	raxml -f a -T 2 -m PROTGAMMA$RAxMLmodel         	-p 12345 -x 12345 -# 100         	-s ../../per_gene/EOG091G0II3/ALICUT_EOG091G0II3.clustalo.fasta -n EOG091G0II3.clustalo.aln.ALICUT.$RAxMLmodel 		1> ../../per_gene/EOG091G0II3/infer_single_ML.stdout.txt 2> ../../per_gene/EOG091G0II3/infer_single_ML.stderr.txt
	else
		echo "fasta file per_gene/EOG091G0II3/ALICUT_EOG091G0II3.clustalo.fasta contains fewer than 5 sequences - skipped" > ../../per_gene/EOG091G0II3/infer_single_ML.stdout.txt
		touch raxml.skipped
	fi
        touch ../../per_gene/EOG091G0II3/EOG091G0II3.raxml.done
        [0m
[Sun Jul  5 23:51:42 2020]
Finished job 2960.
2530 of 3292 steps (77%) done

[Sun Jul  5 23:51:42 2020]
rule get_outgroups:
    input: per_gene/EOG091G07Z0/EOG091G07Z0.ingroup.fasta
    output: per_gene/EOG091G07Z0/EOG091G07Z0.orthodb.fasta, per_gene/EOG091G07Z0/EOG091G07Z0.outgroup.fasta
    log: per_gene/EOG091G07Z0/get_outgroups.stdout.txt, per_gene/EOG091G07Z0/get_outgroups.stderr.txt
    jobid: 2961
    wildcards: BUSCO=EOG091G07Z0


        #download fastas from Orhtodb for BUSCO id
        for i in {1..5}
        do
             wget "http://www.orthodb.org/fasta?query=EOG091G07Z0&level=33208" -O per_gene/EOG091G07Z0/EOG091G07Z0.orthodb.fasta 1> per_gene/EOG091G07Z0/get_outgroups.stdout.txt 2> per_gene/EOG091G07Z0/get_outgroups.stderr.txt && break || echo -e "try again ($i)" && sleep 15
        done

	#This is quick an dirty for now and just takes the first protein if there is more than one for an outgroup taxon
        bash ../scripts/download_outgroups.sh taxids.txt per_gene/EOG091G07Z0/EOG091G07Z0.orthodb.fasta > per_gene/EOG091G07Z0/EOG091G07Z0.outgroup.fasta
        
[Sun Jul  5 23:51:43 2020]
Finished job 2961.
2531 of 3292 steps (77%) done

[Sun Jul  5 23:51:43 2020]
rule join_groups:
    input: per_gene/EOG091G07Z0/EOG091G07Z0.ingroup.fasta, per_gene/EOG091G07Z0/EOG091G07Z0.outgroup.fasta
    output: per_gene/EOG091G07Z0/EOG091G07Z0.fasta
    jobid: 2304
    wildcards: BUSCO=EOG091G07Z0


        cat per_gene/EOG091G07Z0/EOG091G07Z0.ingroup.fasta per_gene/EOG091G07Z0/EOG091G07Z0.outgroup.fasta > per_gene/EOG091G07Z0/EOG091G07Z0.fasta
        
[Sun Jul  5 23:51:43 2020]
Finished job 2304.
2532 of 3292 steps (77%) done

[Sun Jul  5 23:51:43 2020]
rule MSA:
    input: per_gene/EOG091G07Z0/EOG091G07Z0.fasta
    output: per_gene/EOG091G07Z0/EOG091G07Z0.clustalo.fasta
    log: per_gene/EOG091G07Z0/MSA.stdout.txt, per_gene/EOG091G07Z0/MSA.stderr.txt
    jobid: 1728
    wildcards: BUSCO=EOG091G07Z0
    threads: 2


        clustalo -i per_gene/EOG091G07Z0/EOG091G07Z0.fasta -o per_gene/EOG091G07Z0/EOG091G07Z0.clustalo.fasta --threads=2 1> per_gene/EOG091G07Z0/MSA.stdout.txt 2> per_gene/EOG091G07Z0/MSA.stderr.txt
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/d68c9691725a7401923680874285c430.simg
[Sun Jul  5 23:51:45 2020]
Finished job 1728.
2533 of 3292 steps (77%) done

[Sun Jul  5 23:51:45 2020]
rule score_and_cut:
    input: per_gene/EOG091G07Z0/EOG091G07Z0.clustalo.fasta
    output: per_gene/EOG091G07Z0/ALICUT_EOG091G07Z0.clustalo.fasta
    jobid: 905
    wildcards: BUSCO=EOG091G07Z0
    threads: 2


        cd per_gene/EOG091G07Z0
        Aliscore.pl -N -r 200000000000000000 -i ../../per_gene/EOG091G07Z0/EOG091G07Z0.clustalo.fasta &> aliscore.log
        ALICUT.pl -s &> alicut.log
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/63c88c27a0fa300f57066b0ef65fefcb.simg
[Sun Jul  5 23:51:45 2020]
Finished job 2548.
2534 of 3292 steps (77%) done

[Sun Jul  5 23:51:45 2020]
rule get_outgroups:
    input: per_gene/EOG091G05OR/EOG091G05OR.ingroup.fasta
    output: per_gene/EOG091G05OR/EOG091G05OR.orthodb.fasta, per_gene/EOG091G05OR/EOG091G05OR.outgroup.fasta
    log: per_gene/EOG091G05OR/get_outgroups.stdout.txt, per_gene/EOG091G05OR/get_outgroups.stderr.txt
    jobid: 2549
    wildcards: BUSCO=EOG091G05OR


        #download fastas from Orhtodb for BUSCO id
        for i in {1..5}
        do
             wget "http://www.orthodb.org/fasta?query=EOG091G05OR&level=33208" -O per_gene/EOG091G05OR/EOG091G05OR.orthodb.fasta 1> per_gene/EOG091G05OR/get_outgroups.stdout.txt 2> per_gene/EOG091G05OR/get_outgroups.stderr.txt && break || echo -e "try again ($i)" && sleep 15
        done

	#This is quick an dirty for now and just takes the first protein if there is more than one for an outgroup taxon
        bash ../scripts/download_outgroups.sh taxids.txt per_gene/EOG091G05OR/EOG091G05OR.orthodb.fasta > per_gene/EOG091G05OR/EOG091G05OR.outgroup.fasta
        
[Sun Jul  5 23:51:46 2020]
Finished job 2549.
2535 of 3292 steps (77%) done

[Sun Jul  5 23:51:46 2020]
rule join_groups:
    input: per_gene/EOG091G05OR/EOG091G05OR.ingroup.fasta, per_gene/EOG091G05OR/EOG091G05OR.outgroup.fasta
    output: per_gene/EOG091G05OR/EOG091G05OR.fasta
    jobid: 2098
    wildcards: BUSCO=EOG091G05OR


        cat per_gene/EOG091G05OR/EOG091G05OR.ingroup.fasta per_gene/EOG091G05OR/EOG091G05OR.outgroup.fasta > per_gene/EOG091G05OR/EOG091G05OR.fasta
        
[Sun Jul  5 23:51:46 2020]
Finished job 2098.
2536 of 3292 steps (77%) done

[Sun Jul  5 23:51:46 2020]
rule MSA:
    input: per_gene/EOG091G05OR/EOG091G05OR.fasta
    output: per_gene/EOG091G05OR/EOG091G05OR.clustalo.fasta
    log: per_gene/EOG091G05OR/MSA.stdout.txt, per_gene/EOG091G05OR/MSA.stderr.txt
    jobid: 1316
    wildcards: BUSCO=EOG091G05OR
    threads: 2


        clustalo -i per_gene/EOG091G05OR/EOG091G05OR.fasta -o per_gene/EOG091G05OR/EOG091G05OR.clustalo.fasta --threads=2 1> per_gene/EOG091G05OR/MSA.stdout.txt 2> per_gene/EOG091G05OR/MSA.stderr.txt
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/d68c9691725a7401923680874285c430.simg
[Sun Jul  5 23:51:48 2020]
Finished job 1316.
2537 of 3292 steps (77%) done

[Sun Jul  5 23:51:48 2020]
rule score_and_cut:
    input: per_gene/EOG091G05OR/EOG091G05OR.clustalo.fasta
    output: per_gene/EOG091G05OR/ALICUT_EOG091G05OR.clustalo.fasta
    jobid: 493
    wildcards: BUSCO=EOG091G05OR
    threads: 2


        cd per_gene/EOG091G05OR
        Aliscore.pl -N -r 200000000000000000 -i ../../per_gene/EOG091G05OR/EOG091G05OR.clustalo.fasta &> aliscore.log
        ALICUT.pl -s &> alicut.log
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/63c88c27a0fa300f57066b0ef65fefcb.simg
[Sun Jul  5 23:51:52 2020]
Finished job 383.
2538 of 3292 steps (77%) done

[Sun Jul  5 23:51:52 2020]
rule get_seqs:
    input: /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ingroup.txt, /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/outgroup.txt
    output: per_gene/EOG091G0FPM/EOG091G0FPM.ingroup.fasta
    log: per_gene/EOG091G0FPM/get_seqs.stdout.txt, per_gene/EOG091G0FPM/get_seqs.stderr.txt
    jobid: 3192
    wildcards: BUSCO=EOG091G0FPM
    threads: 2


	basedir=$(pwd)
        cd per_gene/EOG091G0FPM
        
        bash $basedir/../scripts/fetch_seqs.sh EOG091G0FPM /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ingroup.txt /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/outgroup.txt 1> ../../per_gene/EOG091G0FPM/get_seqs.stdout.txt 2> ../../per_gene/EOG091G0FPM/get_seqs.stderr.txt
	mv EOG091G0FPM.fasta $basedir/per_gene/EOG091G0FPM/EOG091G0FPM.ingroup.fasta
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/72476f9d9a5bd0627b4d721143a21354.simg
[Sun Jul  5 23:51:55 2020]
Finished job 905.
2539 of 3292 steps (77%) done

[Sun Jul  5 23:51:55 2020]
rule remove_empty:
    input: per_gene/EOG091G07Z0/ALICUT_EOG091G07Z0.clustalo.fasta
    output: per_gene/EOG091G07Z0/empty_check.done
    jobid: 1727
    wildcards: BUSCO=EOG091G07Z0


         if [ "$(cat per_gene/EOG091G07Z0/ALICUT_EOG091G07Z0.clustalo.fasta | grep -v ">" | sed 's/-//g' | grep "^$" | wc -l)" -gt 0 ]
         then
              cp per_gene/EOG091G07Z0/ALICUT_EOG091G07Z0.clustalo.fasta per_gene/EOG091G07Z0/ALICUT_EOG091G07Z0.clustalo.fasta.backup
              bash ../scripts/remove_empty.sh per_gene/EOG091G07Z0/ALICUT_EOG091G07Z0.clustalo.fasta.backup > per_gene/EOG091G07Z0/ALICUT_EOG091G07Z0.clustalo.fasta
         fi
         touch per_gene/EOG091G07Z0/empty_check.done
         
[Sun Jul  5 23:51:55 2020]
Finished job 1727.
2540 of 3292 steps (77%) done

[Sun Jul  5 23:51:55 2020]
rule find_best_model:
    input: per_gene/EOG091G07Z0/ALICUT_EOG091G07Z0.clustalo.fasta, per_gene/EOG091G07Z0/empty_check.done
    output: per_gene/EOG091G07Z0/EOG091G07Z0.best_model
    log: per_gene/EOG091G07Z0/find_best_model.stderr.txt
    jobid: 904
    wildcards: BUSCO=EOG091G07Z0
    threads: 2


        cd per_gene/EOG091G07Z0
        if [ ! -d find_best_model ]
        then
            mkdir find_best_model
        fi
        cd find_best_model
        ln -s ../../../per_gene/EOG091G07Z0/ALICUT_EOG091G07Z0.clustalo.fasta EOG091G07Z0.fasta
        ProteinModelSelection.pl EOG091G07Z0.fasta 1> ../../../per_gene/EOG091G07Z0/EOG091G07Z0.best_model 2> ../../../per_gene/EOG091G07Z0/find_best_model.stderr.txt
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/c0c09ee657b1e27f2c5687e0e9aa8d70.simg
[Sun Jul  5 23:51:59 2020]
Finished job 493.
2541 of 3292 steps (77%) done

[Sun Jul  5 23:51:59 2020]
rule remove_empty:
    input: per_gene/EOG091G05OR/ALICUT_EOG091G05OR.clustalo.fasta
    output: per_gene/EOG091G05OR/empty_check.done
    jobid: 1315
    wildcards: BUSCO=EOG091G05OR


         if [ "$(cat per_gene/EOG091G05OR/ALICUT_EOG091G05OR.clustalo.fasta | grep -v ">" | sed 's/-//g' | grep "^$" | wc -l)" -gt 0 ]
         then
              cp per_gene/EOG091G05OR/ALICUT_EOG091G05OR.clustalo.fasta per_gene/EOG091G05OR/ALICUT_EOG091G05OR.clustalo.fasta.backup
              bash ../scripts/remove_empty.sh per_gene/EOG091G05OR/ALICUT_EOG091G05OR.clustalo.fasta.backup > per_gene/EOG091G05OR/ALICUT_EOG091G05OR.clustalo.fasta
         fi
         touch per_gene/EOG091G05OR/empty_check.done
         
[Sun Jul  5 23:51:59 2020]
Finished job 1315.
2542 of 3292 steps (77%) done

[Sun Jul  5 23:51:59 2020]
rule find_best_model:
    input: per_gene/EOG091G05OR/ALICUT_EOG091G05OR.clustalo.fasta, per_gene/EOG091G05OR/empty_check.done
    output: per_gene/EOG091G05OR/EOG091G05OR.best_model
    log: per_gene/EOG091G05OR/find_best_model.stderr.txt
    jobid: 492
    wildcards: BUSCO=EOG091G05OR
    threads: 2


        cd per_gene/EOG091G05OR
        if [ ! -d find_best_model ]
        then
            mkdir find_best_model
        fi
        cd find_best_model
        ln -s ../../../per_gene/EOG091G05OR/ALICUT_EOG091G05OR.clustalo.fasta EOG091G05OR.fasta
        ProteinModelSelection.pl EOG091G05OR.fasta 1> ../../../per_gene/EOG091G05OR/EOG091G05OR.best_model 2> ../../../per_gene/EOG091G05OR/find_best_model.stderr.txt
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/c0c09ee657b1e27f2c5687e0e9aa8d70.simg
[Sun Jul  5 23:52:04 2020]
Finished job 3192.
2543 of 3292 steps (77%) done

[Sun Jul  5 23:52:04 2020]
rule get_outgroups:
    input: per_gene/EOG091G0FPM/EOG091G0FPM.ingroup.fasta
    output: per_gene/EOG091G0FPM/EOG091G0FPM.orthodb.fasta, per_gene/EOG091G0FPM/EOG091G0FPM.outgroup.fasta
    log: per_gene/EOG091G0FPM/get_outgroups.stdout.txt, per_gene/EOG091G0FPM/get_outgroups.stderr.txt
    jobid: 3193
    wildcards: BUSCO=EOG091G0FPM


        #download fastas from Orhtodb for BUSCO id
        for i in {1..5}
        do
             wget "http://www.orthodb.org/fasta?query=EOG091G0FPM&level=33208" -O per_gene/EOG091G0FPM/EOG091G0FPM.orthodb.fasta 1> per_gene/EOG091G0FPM/get_outgroups.stdout.txt 2> per_gene/EOG091G0FPM/get_outgroups.stderr.txt && break || echo -e "try again ($i)" && sleep 15
        done

	#This is quick an dirty for now and just takes the first protein if there is more than one for an outgroup taxon
        bash ../scripts/download_outgroups.sh taxids.txt per_gene/EOG091G0FPM/EOG091G0FPM.orthodb.fasta > per_gene/EOG091G0FPM/EOG091G0FPM.outgroup.fasta
        
[Sun Jul  5 23:52:04 2020]
Finished job 3193.
2544 of 3292 steps (77%) done

[Sun Jul  5 23:52:04 2020]
rule join_groups:
    input: per_gene/EOG091G0FPM/EOG091G0FPM.ingroup.fasta, per_gene/EOG091G0FPM/EOG091G0FPM.outgroup.fasta
    output: per_gene/EOG091G0FPM/EOG091G0FPM.fasta
    jobid: 2420
    wildcards: BUSCO=EOG091G0FPM


        cat per_gene/EOG091G0FPM/EOG091G0FPM.ingroup.fasta per_gene/EOG091G0FPM/EOG091G0FPM.outgroup.fasta > per_gene/EOG091G0FPM/EOG091G0FPM.fasta
        
[Sun Jul  5 23:52:04 2020]
Finished job 2420.
2545 of 3292 steps (77%) done

[Sun Jul  5 23:52:04 2020]
rule MSA:
    input: per_gene/EOG091G0FPM/EOG091G0FPM.fasta
    output: per_gene/EOG091G0FPM/EOG091G0FPM.clustalo.fasta
    log: per_gene/EOG091G0FPM/MSA.stdout.txt, per_gene/EOG091G0FPM/MSA.stderr.txt
    jobid: 1960
    wildcards: BUSCO=EOG091G0FPM
    threads: 2


        clustalo -i per_gene/EOG091G0FPM/EOG091G0FPM.fasta -o per_gene/EOG091G0FPM/EOG091G0FPM.clustalo.fasta --threads=2 1> per_gene/EOG091G0FPM/MSA.stdout.txt 2> per_gene/EOG091G0FPM/MSA.stderr.txt
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/d68c9691725a7401923680874285c430.simg
[Sun Jul  5 23:52:05 2020]
Finished job 676.
2546 of 3292 steps (77%) done

[Sun Jul  5 23:52:05 2020]
rule infer_single_ML:
    input: per_gene/EOG091G0K82/EOG091G0K82.best_model, per_gene/EOG091G0K82/ALICUT_EOG091G0K82.clustalo.fasta
    output: per_gene/EOG091G0K82/EOG091G0K82.raxml.done
    log: per_gene/EOG091G0K82/infer_single_ML.stdout.txt, per_gene/EOG091G0K82/infer_single_ML.stderr.txt
    jobid: 132
    wildcards: BUSCO=EOG091G0K82
    threads: 2


        cd per_gene/EOG091G0K82
	count=$(cat ../../per_gene/EOG091G0K82/ALICUT_EOG091G0K82.clustalo.fasta | grep ">" | wc -l)
	if [ "$count" -gt 5 ]
        then
		RAxMLmodel=$(cat ../../per_gene/EOG091G0K82/EOG091G0K82.best_model | grep "Best" | cut -d ":" -f 2 | tr -d '[:space:]')
                if [ "$(ls -1 | grep "^RAxML" | wc -l)" -ne 0 ]
		then
			rm RAxML*
		fi
        	raxml -f a -T 2 -m PROTGAMMA$RAxMLmodel         	-p 12345 -x 12345 -# 100         	-s ../../per_gene/EOG091G0K82/ALICUT_EOG091G0K82.clustalo.fasta -n EOG091G0K82.clustalo.aln.ALICUT.$RAxMLmodel 		1> ../../per_gene/EOG091G0K82/infer_single_ML.stdout.txt 2> ../../per_gene/EOG091G0K82/infer_single_ML.stderr.txt
	else
		echo "fasta file per_gene/EOG091G0K82/ALICUT_EOG091G0K82.clustalo.fasta contains fewer than 5 sequences - skipped" > ../../per_gene/EOG091G0K82/infer_single_ML.stdout.txt
		touch raxml.skipped
	fi
        touch ../../per_gene/EOG091G0K82/EOG091G0K82.raxml.done
        
[Sun Jul  5 23:52:07 2020]
Finished job 1960.
2547 of 3292 steps (77%) done

[Sun Jul  5 23:52:07 2020]
rule score_and_cut:
    input: per_gene/EOG091G0FPM/EOG091G0FPM.clustalo.fasta
    output: per_gene/EOG091G0FPM/ALICUT_EOG091G0FPM.clustalo.fasta
    jobid: 1137
    wildcards: BUSCO=EOG091G0FPM
    threads: 2


        cd per_gene/EOG091G0FPM
        Aliscore.pl -N -r 200000000000000000 -i ../../per_gene/EOG091G0FPM/EOG091G0FPM.clustalo.fasta &> aliscore.log
        ALICUT.pl -s &> alicut.log
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/63c88c27a0fa300f57066b0ef65fefcb.simg
[33mJob counts:
	count	jobs
	1	infer_single_ML
	1[0m
[33m
        cd per_gene/EOG091G0K82
	count=$(cat ../../per_gene/EOG091G0K82/ALICUT_EOG091G0K82.clustalo.fasta | grep ">" | wc -l)
	if [ "$count" -gt 5 ]
        then
		RAxMLmodel=$(cat ../../per_gene/EOG091G0K82/EOG091G0K82.best_model | grep "Best" | cut -d ":" -f 2 | tr -d '[:space:]')
                if [ "$(ls -1 | grep "^RAxML" | wc -l)" -ne 0 ]
		then
			rm RAxML*
		fi
        	raxml -f a -T 2 -m PROTGAMMA$RAxMLmodel         	-p 12345 -x 12345 -# 100         	-s ../../per_gene/EOG091G0K82/ALICUT_EOG091G0K82.clustalo.fasta -n EOG091G0K82.clustalo.aln.ALICUT.$RAxMLmodel 		1> ../../per_gene/EOG091G0K82/infer_single_ML.stdout.txt 2> ../../per_gene/EOG091G0K82/infer_single_ML.stderr.txt
	else
		echo "fasta file per_gene/EOG091G0K82/ALICUT_EOG091G0K82.clustalo.fasta contains fewer than 5 sequences - skipped" > ../../per_gene/EOG091G0K82/infer_single_ML.stdout.txt
		touch raxml.skipped
	fi
        touch ../../per_gene/EOG091G0K82/EOG091G0K82.raxml.done
        [0m
[Sun Jul  5 23:52:19 2020]
Finished job 1137.
2548 of 3292 steps (77%) done

[Sun Jul  5 23:52:19 2020]
rule remove_empty:
    input: per_gene/EOG091G0FPM/ALICUT_EOG091G0FPM.clustalo.fasta
    output: per_gene/EOG091G0FPM/empty_check.done
    jobid: 1959
    wildcards: BUSCO=EOG091G0FPM


         if [ "$(cat per_gene/EOG091G0FPM/ALICUT_EOG091G0FPM.clustalo.fasta | grep -v ">" | sed 's/-//g' | grep "^$" | wc -l)" -gt 0 ]
         then
              cp per_gene/EOG091G0FPM/ALICUT_EOG091G0FPM.clustalo.fasta per_gene/EOG091G0FPM/ALICUT_EOG091G0FPM.clustalo.fasta.backup
              bash ../scripts/remove_empty.sh per_gene/EOG091G0FPM/ALICUT_EOG091G0FPM.clustalo.fasta.backup > per_gene/EOG091G0FPM/ALICUT_EOG091G0FPM.clustalo.fasta
         fi
         touch per_gene/EOG091G0FPM/empty_check.done
         
[Sun Jul  5 23:52:19 2020]
Finished job 1959.
2549 of 3292 steps (77%) done

[Sun Jul  5 23:52:19 2020]
rule find_best_model:
    input: per_gene/EOG091G0FPM/ALICUT_EOG091G0FPM.clustalo.fasta, per_gene/EOG091G0FPM/empty_check.done
    output: per_gene/EOG091G0FPM/EOG091G0FPM.best_model
    log: per_gene/EOG091G0FPM/find_best_model.stderr.txt
    jobid: 1136
    wildcards: BUSCO=EOG091G0FPM
    threads: 2


        cd per_gene/EOG091G0FPM
        if [ ! -d find_best_model ]
        then
            mkdir find_best_model
        fi
        cd find_best_model
        ln -s ../../../per_gene/EOG091G0FPM/ALICUT_EOG091G0FPM.clustalo.fasta EOG091G0FPM.fasta
        ProteinModelSelection.pl EOG091G0FPM.fasta 1> ../../../per_gene/EOG091G0FPM/EOG091G0FPM.best_model 2> ../../../per_gene/EOG091G0FPM/find_best_model.stderr.txt
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/c0c09ee657b1e27f2c5687e0e9aa8d70.simg
[Sun Jul  5 23:52:40 2020]
Finished job 904.
2550 of 3292 steps (77%) done

[Sun Jul  5 23:52:40 2020]
rule infer_single_ML:
    input: per_gene/EOG091G07Z0/EOG091G07Z0.best_model, per_gene/EOG091G07Z0/ALICUT_EOG091G07Z0.clustalo.fasta
    output: per_gene/EOG091G07Z0/EOG091G07Z0.raxml.done
    log: per_gene/EOG091G07Z0/infer_single_ML.stdout.txt, per_gene/EOG091G07Z0/infer_single_ML.stderr.txt
    jobid: 246
    wildcards: BUSCO=EOG091G07Z0
    threads: 2


        cd per_gene/EOG091G07Z0
	count=$(cat ../../per_gene/EOG091G07Z0/ALICUT_EOG091G07Z0.clustalo.fasta | grep ">" | wc -l)
	if [ "$count" -gt 5 ]
        then
		RAxMLmodel=$(cat ../../per_gene/EOG091G07Z0/EOG091G07Z0.best_model | grep "Best" | cut -d ":" -f 2 | tr -d '[:space:]')
                if [ "$(ls -1 | grep "^RAxML" | wc -l)" -ne 0 ]
		then
			rm RAxML*
		fi
        	raxml -f a -T 2 -m PROTGAMMA$RAxMLmodel         	-p 12345 -x 12345 -# 100         	-s ../../per_gene/EOG091G07Z0/ALICUT_EOG091G07Z0.clustalo.fasta -n EOG091G07Z0.clustalo.aln.ALICUT.$RAxMLmodel 		1> ../../per_gene/EOG091G07Z0/infer_single_ML.stdout.txt 2> ../../per_gene/EOG091G07Z0/infer_single_ML.stderr.txt
	else
		echo "fasta file per_gene/EOG091G07Z0/ALICUT_EOG091G07Z0.clustalo.fasta contains fewer than 5 sequences - skipped" > ../../per_gene/EOG091G07Z0/infer_single_ML.stdout.txt
		touch raxml.skipped
	fi
        touch ../../per_gene/EOG091G07Z0/EOG091G07Z0.raxml.done
        
[33mJob counts:
	count	jobs
	1	infer_single_ML
	1[0m
[33m
        cd per_gene/EOG091G07Z0
	count=$(cat ../../per_gene/EOG091G07Z0/ALICUT_EOG091G07Z0.clustalo.fasta | grep ">" | wc -l)
	if [ "$count" -gt 5 ]
        then
		RAxMLmodel=$(cat ../../per_gene/EOG091G07Z0/EOG091G07Z0.best_model | grep "Best" | cut -d ":" -f 2 | tr -d '[:space:]')
                if [ "$(ls -1 | grep "^RAxML" | wc -l)" -ne 0 ]
		then
			rm RAxML*
		fi
        	raxml -f a -T 2 -m PROTGAMMA$RAxMLmodel         	-p 12345 -x 12345 -# 100         	-s ../../per_gene/EOG091G07Z0/ALICUT_EOG091G07Z0.clustalo.fasta -n EOG091G07Z0.clustalo.aln.ALICUT.$RAxMLmodel 		1> ../../per_gene/EOG091G07Z0/infer_single_ML.stdout.txt 2> ../../per_gene/EOG091G07Z0/infer_single_ML.stderr.txt
	else
		echo "fasta file per_gene/EOG091G07Z0/ALICUT_EOG091G07Z0.clustalo.fasta contains fewer than 5 sequences - skipped" > ../../per_gene/EOG091G07Z0/infer_single_ML.stdout.txt
		touch raxml.skipped
	fi
        touch ../../per_gene/EOG091G07Z0/EOG091G07Z0.raxml.done
        [0m
[Sun Jul  5 23:52:47 2020]
Finished job 1136.
2551 of 3292 steps (77%) done

[Sun Jul  5 23:52:47 2020]
rule infer_single_ML:
    input: per_gene/EOG091G0FPM/EOG091G0FPM.best_model, per_gene/EOG091G0FPM/ALICUT_EOG091G0FPM.clustalo.fasta
    output: per_gene/EOG091G0FPM/EOG091G0FPM.raxml.done
    log: per_gene/EOG091G0FPM/infer_single_ML.stdout.txt, per_gene/EOG091G0FPM/infer_single_ML.stderr.txt
    jobid: 362
    wildcards: BUSCO=EOG091G0FPM
    threads: 2


        cd per_gene/EOG091G0FPM
	count=$(cat ../../per_gene/EOG091G0FPM/ALICUT_EOG091G0FPM.clustalo.fasta | grep ">" | wc -l)
	if [ "$count" -gt 5 ]
        then
		RAxMLmodel=$(cat ../../per_gene/EOG091G0FPM/EOG091G0FPM.best_model | grep "Best" | cut -d ":" -f 2 | tr -d '[:space:]')
                if [ "$(ls -1 | grep "^RAxML" | wc -l)" -ne 0 ]
		then
			rm RAxML*
		fi
        	raxml -f a -T 2 -m PROTGAMMA$RAxMLmodel         	-p 12345 -x 12345 -# 100         	-s ../../per_gene/EOG091G0FPM/ALICUT_EOG091G0FPM.clustalo.fasta -n EOG091G0FPM.clustalo.aln.ALICUT.$RAxMLmodel 		1> ../../per_gene/EOG091G0FPM/infer_single_ML.stdout.txt 2> ../../per_gene/EOG091G0FPM/infer_single_ML.stderr.txt
	else
		echo "fasta file per_gene/EOG091G0FPM/ALICUT_EOG091G0FPM.clustalo.fasta contains fewer than 5 sequences - skipped" > ../../per_gene/EOG091G0FPM/infer_single_ML.stdout.txt
		touch raxml.skipped
	fi
        touch ../../per_gene/EOG091G0FPM/EOG091G0FPM.raxml.done
        
[Sun Jul  5 23:52:48 2020]
Finished job 492.
2552 of 3292 steps (78%) done

[Sun Jul  5 23:52:48 2020]
rule infer_single_ML:
    input: per_gene/EOG091G05OR/EOG091G05OR.best_model, per_gene/EOG091G05OR/ALICUT_EOG091G05OR.clustalo.fasta
    output: per_gene/EOG091G05OR/EOG091G05OR.raxml.done
    log: per_gene/EOG091G05OR/infer_single_ML.stdout.txt, per_gene/EOG091G05OR/infer_single_ML.stderr.txt
    jobid: 40
    wildcards: BUSCO=EOG091G05OR
    threads: 2


        cd per_gene/EOG091G05OR
	count=$(cat ../../per_gene/EOG091G05OR/ALICUT_EOG091G05OR.clustalo.fasta | grep ">" | wc -l)
	if [ "$count" -gt 5 ]
        then
		RAxMLmodel=$(cat ../../per_gene/EOG091G05OR/EOG091G05OR.best_model | grep "Best" | cut -d ":" -f 2 | tr -d '[:space:]')
                if [ "$(ls -1 | grep "^RAxML" | wc -l)" -ne 0 ]
		then
			rm RAxML*
		fi
        	raxml -f a -T 2 -m PROTGAMMA$RAxMLmodel         	-p 12345 -x 12345 -# 100         	-s ../../per_gene/EOG091G05OR/ALICUT_EOG091G05OR.clustalo.fasta -n EOG091G05OR.clustalo.aln.ALICUT.$RAxMLmodel 		1> ../../per_gene/EOG091G05OR/infer_single_ML.stdout.txt 2> ../../per_gene/EOG091G05OR/infer_single_ML.stderr.txt
	else
		echo "fasta file per_gene/EOG091G05OR/ALICUT_EOG091G05OR.clustalo.fasta contains fewer than 5 sequences - skipped" > ../../per_gene/EOG091G05OR/infer_single_ML.stdout.txt
		touch raxml.skipped
	fi
        touch ../../per_gene/EOG091G05OR/EOG091G05OR.raxml.done
        
[33mJob counts:
	count	jobs
	1	infer_single_ML
	1[0m
[33m
        cd per_gene/EOG091G0FPM
	count=$(cat ../../per_gene/EOG091G0FPM/ALICUT_EOG091G0FPM.clustalo.fasta | grep ">" | wc -l)
	if [ "$count" -gt 5 ]
        then
		RAxMLmodel=$(cat ../../per_gene/EOG091G0FPM/EOG091G0FPM.best_model | grep "Best" | cut -d ":" -f 2 | tr -d '[:space:]')
                if [ "$(ls -1 | grep "^RAxML" | wc -l)" -ne 0 ]
		then
			rm RAxML*
		fi
        	raxml -f a -T 2 -m PROTGAMMA$RAxMLmodel         	-p 12345 -x 12345 -# 100         	-s ../../per_gene/EOG091G0FPM/ALICUT_EOG091G0FPM.clustalo.fasta -n EOG091G0FPM.clustalo.aln.ALICUT.$RAxMLmodel 		1> ../../per_gene/EOG091G0FPM/infer_single_ML.stdout.txt 2> ../../per_gene/EOG091G0FPM/infer_single_ML.stderr.txt
	else
		echo "fasta file per_gene/EOG091G0FPM/ALICUT_EOG091G0FPM.clustalo.fasta contains fewer than 5 sequences - skipped" > ../../per_gene/EOG091G0FPM/infer_single_ML.stdout.txt
		touch raxml.skipped
	fi
        touch ../../per_gene/EOG091G0FPM/EOG091G0FPM.raxml.done
        [0m
[33mJob counts:
	count	jobs
	1	infer_single_ML
	1[0m
[33m
        cd per_gene/EOG091G05OR
	count=$(cat ../../per_gene/EOG091G05OR/ALICUT_EOG091G05OR.clustalo.fasta | grep ">" | wc -l)
	if [ "$count" -gt 5 ]
        then
		RAxMLmodel=$(cat ../../per_gene/EOG091G05OR/EOG091G05OR.best_model | grep "Best" | cut -d ":" -f 2 | tr -d '[:space:]')
                if [ "$(ls -1 | grep "^RAxML" | wc -l)" -ne 0 ]
		then
			rm RAxML*
		fi
        	raxml -f a -T 2 -m PROTGAMMA$RAxMLmodel         	-p 12345 -x 12345 -# 100         	-s ../../per_gene/EOG091G05OR/ALICUT_EOG091G05OR.clustalo.fasta -n EOG091G05OR.clustalo.aln.ALICUT.$RAxMLmodel 		1> ../../per_gene/EOG091G05OR/infer_single_ML.stdout.txt 2> ../../per_gene/EOG091G05OR/infer_single_ML.stderr.txt
	else
		echo "fasta file per_gene/EOG091G05OR/ALICUT_EOG091G05OR.clustalo.fasta contains fewer than 5 sequences - skipped" > ../../per_gene/EOG091G05OR/infer_single_ML.stdout.txt
		touch raxml.skipped
	fi
        touch ../../per_gene/EOG091G05OR/EOG091G05OR.raxml.done
        [0m
[Sun Jul  5 23:52:51 2020]
Finished job 250.
2553 of 3292 steps (78%) done

[Sun Jul  5 23:52:51 2020]
rule get_seqs:
    input: /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ingroup.txt, /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/outgroup.txt
    output: per_gene/EOG091G0KC3/EOG091G0KC3.ingroup.fasta
    log: per_gene/EOG091G0KC3/get_seqs.stdout.txt, per_gene/EOG091G0KC3/get_seqs.stderr.txt
    jobid: 3220
    wildcards: BUSCO=EOG091G0KC3
    threads: 2


	basedir=$(pwd)
        cd per_gene/EOG091G0KC3
        
        bash $basedir/../scripts/fetch_seqs.sh EOG091G0KC3 /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ingroup.txt /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/outgroup.txt 1> ../../per_gene/EOG091G0KC3/get_seqs.stdout.txt 2> ../../per_gene/EOG091G0KC3/get_seqs.stderr.txt
	mv EOG091G0KC3.fasta $basedir/per_gene/EOG091G0KC3/EOG091G0KC3.ingroup.fasta
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/72476f9d9a5bd0627b4d721143a21354.simg
[Sun Jul  5 23:53:04 2020]
Finished job 3220.
2554 of 3292 steps (78%) done

[Sun Jul  5 23:53:04 2020]
rule get_outgroups:
    input: per_gene/EOG091G0KC3/EOG091G0KC3.ingroup.fasta
    output: per_gene/EOG091G0KC3/EOG091G0KC3.orthodb.fasta, per_gene/EOG091G0KC3/EOG091G0KC3.outgroup.fasta
    log: per_gene/EOG091G0KC3/get_outgroups.stdout.txt, per_gene/EOG091G0KC3/get_outgroups.stderr.txt
    jobid: 3221
    wildcards: BUSCO=EOG091G0KC3


        #download fastas from Orhtodb for BUSCO id
        for i in {1..5}
        do
             wget "http://www.orthodb.org/fasta?query=EOG091G0KC3&level=33208" -O per_gene/EOG091G0KC3/EOG091G0KC3.orthodb.fasta 1> per_gene/EOG091G0KC3/get_outgroups.stdout.txt 2> per_gene/EOG091G0KC3/get_outgroups.stderr.txt && break || echo -e "try again ($i)" && sleep 15
        done

	#This is quick an dirty for now and just takes the first protein if there is more than one for an outgroup taxon
        bash ../scripts/download_outgroups.sh taxids.txt per_gene/EOG091G0KC3/EOG091G0KC3.orthodb.fasta > per_gene/EOG091G0KC3/EOG091G0KC3.outgroup.fasta
        
[Sun Jul  5 23:53:05 2020]
Finished job 3221.
2555 of 3292 steps (78%) done

[Sun Jul  5 23:53:05 2020]
rule join_groups:
    input: per_gene/EOG091G0KC3/EOG091G0KC3.ingroup.fasta, per_gene/EOG091G0KC3/EOG091G0KC3.outgroup.fasta
    output: per_gene/EOG091G0KC3/EOG091G0KC3.fasta
    jobid: 2434
    wildcards: BUSCO=EOG091G0KC3


        cat per_gene/EOG091G0KC3/EOG091G0KC3.ingroup.fasta per_gene/EOG091G0KC3/EOG091G0KC3.outgroup.fasta > per_gene/EOG091G0KC3/EOG091G0KC3.fasta
        
[Sun Jul  5 23:53:05 2020]
Finished job 2434.
2556 of 3292 steps (78%) done

[Sun Jul  5 23:53:05 2020]
rule MSA:
    input: per_gene/EOG091G0KC3/EOG091G0KC3.fasta
    output: per_gene/EOG091G0KC3/EOG091G0KC3.clustalo.fasta
    log: per_gene/EOG091G0KC3/MSA.stdout.txt, per_gene/EOG091G0KC3/MSA.stderr.txt
    jobid: 1988
    wildcards: BUSCO=EOG091G0KC3
    threads: 2


        clustalo -i per_gene/EOG091G0KC3/EOG091G0KC3.fasta -o per_gene/EOG091G0KC3/EOG091G0KC3.clustalo.fasta --threads=2 1> per_gene/EOG091G0KC3/MSA.stdout.txt 2> per_gene/EOG091G0KC3/MSA.stderr.txt
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/d68c9691725a7401923680874285c430.simg
[Sun Jul  5 23:53:06 2020]
Finished job 1988.
2557 of 3292 steps (78%) done

[Sun Jul  5 23:53:06 2020]
rule score_and_cut:
    input: per_gene/EOG091G0KC3/EOG091G0KC3.clustalo.fasta
    output: per_gene/EOG091G0KC3/ALICUT_EOG091G0KC3.clustalo.fasta
    jobid: 1165
    wildcards: BUSCO=EOG091G0KC3
    threads: 2


        cd per_gene/EOG091G0KC3
        Aliscore.pl -N -r 200000000000000000 -i ../../per_gene/EOG091G0KC3/EOG091G0KC3.clustalo.fasta &> aliscore.log
        ALICUT.pl -s &> alicut.log
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/63c88c27a0fa300f57066b0ef65fefcb.simg
[Sun Jul  5 23:53:17 2020]
Finished job 1165.
2558 of 3292 steps (78%) done

[Sun Jul  5 23:53:17 2020]
rule remove_empty:
    input: per_gene/EOG091G0KC3/ALICUT_EOG091G0KC3.clustalo.fasta
    output: per_gene/EOG091G0KC3/empty_check.done
    jobid: 1987
    wildcards: BUSCO=EOG091G0KC3


         if [ "$(cat per_gene/EOG091G0KC3/ALICUT_EOG091G0KC3.clustalo.fasta | grep -v ">" | sed 's/-//g' | grep "^$" | wc -l)" -gt 0 ]
         then
              cp per_gene/EOG091G0KC3/ALICUT_EOG091G0KC3.clustalo.fasta per_gene/EOG091G0KC3/ALICUT_EOG091G0KC3.clustalo.fasta.backup
              bash ../scripts/remove_empty.sh per_gene/EOG091G0KC3/ALICUT_EOG091G0KC3.clustalo.fasta.backup > per_gene/EOG091G0KC3/ALICUT_EOG091G0KC3.clustalo.fasta
         fi
         touch per_gene/EOG091G0KC3/empty_check.done
         
[Sun Jul  5 23:53:18 2020]
Finished job 1987.
2559 of 3292 steps (78%) done

[Sun Jul  5 23:53:18 2020]
rule find_best_model:
    input: per_gene/EOG091G0KC3/ALICUT_EOG091G0KC3.clustalo.fasta, per_gene/EOG091G0KC3/empty_check.done
    output: per_gene/EOG091G0KC3/EOG091G0KC3.best_model
    log: per_gene/EOG091G0KC3/find_best_model.stderr.txt
    jobid: 1164
    wildcards: BUSCO=EOG091G0KC3
    threads: 2


        cd per_gene/EOG091G0KC3
        if [ ! -d find_best_model ]
        then
            mkdir find_best_model
        fi
        cd find_best_model
        ln -s ../../../per_gene/EOG091G0KC3/ALICUT_EOG091G0KC3.clustalo.fasta EOG091G0KC3.fasta
        ProteinModelSelection.pl EOG091G0KC3.fasta 1> ../../../per_gene/EOG091G0KC3/EOG091G0KC3.best_model 2> ../../../per_gene/EOG091G0KC3/find_best_model.stderr.txt
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/c0c09ee657b1e27f2c5687e0e9aa8d70.simg
[Sun Jul  5 23:53:37 2020]
Finished job 359.
2560 of 3292 steps (78%) done

[Sun Jul  5 23:53:37 2020]
rule get_seqs:
    input: /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ingroup.txt, /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/outgroup.txt
    output: per_gene/EOG091G07OD/EOG091G07OD.ingroup.fasta
    log: per_gene/EOG091G07OD/get_seqs.stdout.txt, per_gene/EOG091G07OD/get_seqs.stderr.txt
    jobid: 2580
    wildcards: BUSCO=EOG091G07OD
    threads: 2


	basedir=$(pwd)
        cd per_gene/EOG091G07OD
        
        bash $basedir/../scripts/fetch_seqs.sh EOG091G07OD /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ingroup.txt /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/outgroup.txt 1> ../../per_gene/EOG091G07OD/get_seqs.stdout.txt 2> ../../per_gene/EOG091G07OD/get_seqs.stderr.txt
	mv EOG091G07OD.fasta $basedir/per_gene/EOG091G07OD/EOG091G07OD.ingroup.fasta
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/72476f9d9a5bd0627b4d721143a21354.simg
[Sun Jul  5 23:53:41 2020]
Finished job 1164.
2561 of 3292 steps (78%) done

[Sun Jul  5 23:53:41 2020]
rule infer_single_ML:
    input: per_gene/EOG091G0KC3/EOG091G0KC3.best_model, per_gene/EOG091G0KC3/ALICUT_EOG091G0KC3.clustalo.fasta
    output: per_gene/EOG091G0KC3/EOG091G0KC3.raxml.done
    log: per_gene/EOG091G0KC3/infer_single_ML.stdout.txt, per_gene/EOG091G0KC3/infer_single_ML.stderr.txt
    jobid: 376
    wildcards: BUSCO=EOG091G0KC3
    threads: 2


        cd per_gene/EOG091G0KC3
	count=$(cat ../../per_gene/EOG091G0KC3/ALICUT_EOG091G0KC3.clustalo.fasta | grep ">" | wc -l)
	if [ "$count" -gt 5 ]
        then
		RAxMLmodel=$(cat ../../per_gene/EOG091G0KC3/EOG091G0KC3.best_model | grep "Best" | cut -d ":" -f 2 | tr -d '[:space:]')
                if [ "$(ls -1 | grep "^RAxML" | wc -l)" -ne 0 ]
		then
			rm RAxML*
		fi
        	raxml -f a -T 2 -m PROTGAMMA$RAxMLmodel         	-p 12345 -x 12345 -# 100         	-s ../../per_gene/EOG091G0KC3/ALICUT_EOG091G0KC3.clustalo.fasta -n EOG091G0KC3.clustalo.aln.ALICUT.$RAxMLmodel 		1> ../../per_gene/EOG091G0KC3/infer_single_ML.stdout.txt 2> ../../per_gene/EOG091G0KC3/infer_single_ML.stderr.txt
	else
		echo "fasta file per_gene/EOG091G0KC3/ALICUT_EOG091G0KC3.clustalo.fasta contains fewer than 5 sequences - skipped" > ../../per_gene/EOG091G0KC3/infer_single_ML.stdout.txt
		touch raxml.skipped
	fi
        touch ../../per_gene/EOG091G0KC3/EOG091G0KC3.raxml.done
        
[33mJob counts:
	count	jobs
	1	infer_single_ML
	1[0m
[33m
        cd per_gene/EOG091G0KC3
	count=$(cat ../../per_gene/EOG091G0KC3/ALICUT_EOG091G0KC3.clustalo.fasta | grep ">" | wc -l)
	if [ "$count" -gt 5 ]
        then
		RAxMLmodel=$(cat ../../per_gene/EOG091G0KC3/EOG091G0KC3.best_model | grep "Best" | cut -d ":" -f 2 | tr -d '[:space:]')
                if [ "$(ls -1 | grep "^RAxML" | wc -l)" -ne 0 ]
		then
			rm RAxML*
		fi
        	raxml -f a -T 2 -m PROTGAMMA$RAxMLmodel         	-p 12345 -x 12345 -# 100         	-s ../../per_gene/EOG091G0KC3/ALICUT_EOG091G0KC3.clustalo.fasta -n EOG091G0KC3.clustalo.aln.ALICUT.$RAxMLmodel 		1> ../../per_gene/EOG091G0KC3/infer_single_ML.stdout.txt 2> ../../per_gene/EOG091G0KC3/infer_single_ML.stderr.txt
	else
		echo "fasta file per_gene/EOG091G0KC3/ALICUT_EOG091G0KC3.clustalo.fasta contains fewer than 5 sequences - skipped" > ../../per_gene/EOG091G0KC3/infer_single_ML.stdout.txt
		touch raxml.skipped
	fi
        touch ../../per_gene/EOG091G0KC3/EOG091G0KC3.raxml.done
        [0m
[Sun Jul  5 23:53:51 2020]
Finished job 2580.
2562 of 3292 steps (78%) done

[Sun Jul  5 23:53:51 2020]
rule get_outgroups:
    input: per_gene/EOG091G07OD/EOG091G07OD.ingroup.fasta
    output: per_gene/EOG091G07OD/EOG091G07OD.orthodb.fasta, per_gene/EOG091G07OD/EOG091G07OD.outgroup.fasta
    log: per_gene/EOG091G07OD/get_outgroups.stdout.txt, per_gene/EOG091G07OD/get_outgroups.stderr.txt
    jobid: 2581
    wildcards: BUSCO=EOG091G07OD


        #download fastas from Orhtodb for BUSCO id
        for i in {1..5}
        do
             wget "http://www.orthodb.org/fasta?query=EOG091G07OD&level=33208" -O per_gene/EOG091G07OD/EOG091G07OD.orthodb.fasta 1> per_gene/EOG091G07OD/get_outgroups.stdout.txt 2> per_gene/EOG091G07OD/get_outgroups.stderr.txt && break || echo -e "try again ($i)" && sleep 15
        done

	#This is quick an dirty for now and just takes the first protein if there is more than one for an outgroup taxon
        bash ../scripts/download_outgroups.sh taxids.txt per_gene/EOG091G07OD/EOG091G07OD.orthodb.fasta > per_gene/EOG091G07OD/EOG091G07OD.outgroup.fasta
        
[Sun Jul  5 23:53:52 2020]
Finished job 2581.
2563 of 3292 steps (78%) done

[Sun Jul  5 23:53:52 2020]
rule join_groups:
    input: per_gene/EOG091G07OD/EOG091G07OD.ingroup.fasta, per_gene/EOG091G07OD/EOG091G07OD.outgroup.fasta
    output: per_gene/EOG091G07OD/EOG091G07OD.fasta
    jobid: 2114
    wildcards: BUSCO=EOG091G07OD


        cat per_gene/EOG091G07OD/EOG091G07OD.ingroup.fasta per_gene/EOG091G07OD/EOG091G07OD.outgroup.fasta > per_gene/EOG091G07OD/EOG091G07OD.fasta
        
[Sun Jul  5 23:53:52 2020]
Finished job 2114.
2564 of 3292 steps (78%) done

[Sun Jul  5 23:53:52 2020]
rule MSA:
    input: per_gene/EOG091G07OD/EOG091G07OD.fasta
    output: per_gene/EOG091G07OD/EOG091G07OD.clustalo.fasta
    log: per_gene/EOG091G07OD/MSA.stdout.txt, per_gene/EOG091G07OD/MSA.stderr.txt
    jobid: 1348
    wildcards: BUSCO=EOG091G07OD
    threads: 2


        clustalo -i per_gene/EOG091G07OD/EOG091G07OD.fasta -o per_gene/EOG091G07OD/EOG091G07OD.clustalo.fasta --threads=2 1> per_gene/EOG091G07OD/MSA.stdout.txt 2> per_gene/EOG091G07OD/MSA.stderr.txt
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/d68c9691725a7401923680874285c430.simg
[Sun Jul  5 23:53:54 2020]
Finished job 1348.
2565 of 3292 steps (78%) done

[Sun Jul  5 23:53:54 2020]
rule score_and_cut:
    input: per_gene/EOG091G07OD/EOG091G07OD.clustalo.fasta
    output: per_gene/EOG091G07OD/ALICUT_EOG091G07OD.clustalo.fasta
    jobid: 525
    wildcards: BUSCO=EOG091G07OD
    threads: 2


        cd per_gene/EOG091G07OD
        Aliscore.pl -N -r 200000000000000000 -i ../../per_gene/EOG091G07OD/EOG091G07OD.clustalo.fasta &> aliscore.log
        ALICUT.pl -s &> alicut.log
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/63c88c27a0fa300f57066b0ef65fefcb.simg
[Sun Jul  5 23:54:05 2020]
Finished job 525.
2566 of 3292 steps (78%) done

[Sun Jul  5 23:54:05 2020]
rule remove_empty:
    input: per_gene/EOG091G07OD/ALICUT_EOG091G07OD.clustalo.fasta
    output: per_gene/EOG091G07OD/empty_check.done
    jobid: 1347
    wildcards: BUSCO=EOG091G07OD


         if [ "$(cat per_gene/EOG091G07OD/ALICUT_EOG091G07OD.clustalo.fasta | grep -v ">" | sed 's/-//g' | grep "^$" | wc -l)" -gt 0 ]
         then
              cp per_gene/EOG091G07OD/ALICUT_EOG091G07OD.clustalo.fasta per_gene/EOG091G07OD/ALICUT_EOG091G07OD.clustalo.fasta.backup
              bash ../scripts/remove_empty.sh per_gene/EOG091G07OD/ALICUT_EOG091G07OD.clustalo.fasta.backup > per_gene/EOG091G07OD/ALICUT_EOG091G07OD.clustalo.fasta
         fi
         touch per_gene/EOG091G07OD/empty_check.done
         
[Sun Jul  5 23:54:05 2020]
Finished job 1347.
2567 of 3292 steps (78%) done

[Sun Jul  5 23:54:05 2020]
rule find_best_model:
    input: per_gene/EOG091G07OD/ALICUT_EOG091G07OD.clustalo.fasta, per_gene/EOG091G07OD/empty_check.done
    output: per_gene/EOG091G07OD/EOG091G07OD.best_model
    log: per_gene/EOG091G07OD/find_best_model.stderr.txt
    jobid: 524
    wildcards: BUSCO=EOG091G07OD
    threads: 2


        cd per_gene/EOG091G07OD
        if [ ! -d find_best_model ]
        then
            mkdir find_best_model
        fi
        cd find_best_model
        ln -s ../../../per_gene/EOG091G07OD/ALICUT_EOG091G07OD.clustalo.fasta EOG091G07OD.fasta
        ProteinModelSelection.pl EOG091G07OD.fasta 1> ../../../per_gene/EOG091G07OD/EOG091G07OD.best_model 2> ../../../per_gene/EOG091G07OD/find_best_model.stderr.txt
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/c0c09ee657b1e27f2c5687e0e9aa8d70.simg
[Sun Jul  5 23:54:29 2020]
Finished job 409.
2568 of 3292 steps (78%) done

[Sun Jul  5 23:54:29 2020]
rule get_seqs:
    input: /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ingroup.txt, /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/outgroup.txt
    output: per_gene/EOG091G0G3M/EOG091G0G3M.ingroup.fasta
    log: per_gene/EOG091G0G3M/get_seqs.stdout.txt, per_gene/EOG091G0G3M/get_seqs.stderr.txt
    jobid: 2680
    wildcards: BUSCO=EOG091G0G3M
    threads: 2


	basedir=$(pwd)
        cd per_gene/EOG091G0G3M
        
        bash $basedir/../scripts/fetch_seqs.sh EOG091G0G3M /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ingroup.txt /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/outgroup.txt 1> ../../per_gene/EOG091G0G3M/get_seqs.stdout.txt 2> ../../per_gene/EOG091G0G3M/get_seqs.stderr.txt
	mv EOG091G0G3M.fasta $basedir/per_gene/EOG091G0G3M/EOG091G0G3M.ingroup.fasta
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/72476f9d9a5bd0627b4d721143a21354.simg
[Sun Jul  5 23:54:40 2020]
Finished job 2680.
2569 of 3292 steps (78%) done

[Sun Jul  5 23:54:40 2020]
rule get_outgroups:
    input: per_gene/EOG091G0G3M/EOG091G0G3M.ingroup.fasta
    output: per_gene/EOG091G0G3M/EOG091G0G3M.orthodb.fasta, per_gene/EOG091G0G3M/EOG091G0G3M.outgroup.fasta
    log: per_gene/EOG091G0G3M/get_outgroups.stdout.txt, per_gene/EOG091G0G3M/get_outgroups.stderr.txt
    jobid: 2681
    wildcards: BUSCO=EOG091G0G3M


        #download fastas from Orhtodb for BUSCO id
        for i in {1..5}
        do
             wget "http://www.orthodb.org/fasta?query=EOG091G0G3M&level=33208" -O per_gene/EOG091G0G3M/EOG091G0G3M.orthodb.fasta 1> per_gene/EOG091G0G3M/get_outgroups.stdout.txt 2> per_gene/EOG091G0G3M/get_outgroups.stderr.txt && break || echo -e "try again ($i)" && sleep 15
        done

	#This is quick an dirty for now and just takes the first protein if there is more than one for an outgroup taxon
        bash ../scripts/download_outgroups.sh taxids.txt per_gene/EOG091G0G3M/EOG091G0G3M.orthodb.fasta > per_gene/EOG091G0G3M/EOG091G0G3M.outgroup.fasta
        
[Sun Jul  5 23:54:41 2020]
Finished job 2681.
2570 of 3292 steps (78%) done

[Sun Jul  5 23:54:41 2020]
rule join_groups:
    input: per_gene/EOG091G0G3M/EOG091G0G3M.ingroup.fasta, per_gene/EOG091G0G3M/EOG091G0G3M.outgroup.fasta
    output: per_gene/EOG091G0G3M/EOG091G0G3M.fasta
    jobid: 2164
    wildcards: BUSCO=EOG091G0G3M


        cat per_gene/EOG091G0G3M/EOG091G0G3M.ingroup.fasta per_gene/EOG091G0G3M/EOG091G0G3M.outgroup.fasta > per_gene/EOG091G0G3M/EOG091G0G3M.fasta
        
[Sun Jul  5 23:54:41 2020]
Finished job 2164.
2571 of 3292 steps (78%) done

[Sun Jul  5 23:54:41 2020]
rule MSA:
    input: per_gene/EOG091G0G3M/EOG091G0G3M.fasta
    output: per_gene/EOG091G0G3M/EOG091G0G3M.clustalo.fasta
    log: per_gene/EOG091G0G3M/MSA.stdout.txt, per_gene/EOG091G0G3M/MSA.stderr.txt
    jobid: 1448
    wildcards: BUSCO=EOG091G0G3M
    threads: 2


        clustalo -i per_gene/EOG091G0G3M/EOG091G0G3M.fasta -o per_gene/EOG091G0G3M/EOG091G0G3M.clustalo.fasta --threads=2 1> per_gene/EOG091G0G3M/MSA.stdout.txt 2> per_gene/EOG091G0G3M/MSA.stderr.txt
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/d68c9691725a7401923680874285c430.simg
[Sun Jul  5 23:54:42 2020]
Finished job 1448.
2572 of 3292 steps (78%) done

[Sun Jul  5 23:54:42 2020]
rule score_and_cut:
    input: per_gene/EOG091G0G3M/EOG091G0G3M.clustalo.fasta
    output: per_gene/EOG091G0G3M/ALICUT_EOG091G0G3M.clustalo.fasta
    jobid: 625
    wildcards: BUSCO=EOG091G0G3M
    threads: 2


        cd per_gene/EOG091G0G3M
        Aliscore.pl -N -r 200000000000000000 -i ../../per_gene/EOG091G0G3M/EOG091G0G3M.clustalo.fasta &> aliscore.log
        ALICUT.pl -s &> alicut.log
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/63c88c27a0fa300f57066b0ef65fefcb.simg
[Sun Jul  5 23:54:46 2020]
Finished job 524.
2573 of 3292 steps (78%) done

[Sun Jul  5 23:54:46 2020]
rule infer_single_ML:
    input: per_gene/EOG091G07OD/EOG091G07OD.best_model, per_gene/EOG091G07OD/ALICUT_EOG091G07OD.clustalo.fasta
    output: per_gene/EOG091G07OD/EOG091G07OD.raxml.done
    log: per_gene/EOG091G07OD/infer_single_ML.stdout.txt, per_gene/EOG091G07OD/infer_single_ML.stderr.txt
    jobid: 56
    wildcards: BUSCO=EOG091G07OD
    threads: 2


        cd per_gene/EOG091G07OD
	count=$(cat ../../per_gene/EOG091G07OD/ALICUT_EOG091G07OD.clustalo.fasta | grep ">" | wc -l)
	if [ "$count" -gt 5 ]
        then
		RAxMLmodel=$(cat ../../per_gene/EOG091G07OD/EOG091G07OD.best_model | grep "Best" | cut -d ":" -f 2 | tr -d '[:space:]')
                if [ "$(ls -1 | grep "^RAxML" | wc -l)" -ne 0 ]
		then
			rm RAxML*
		fi
        	raxml -f a -T 2 -m PROTGAMMA$RAxMLmodel         	-p 12345 -x 12345 -# 100         	-s ../../per_gene/EOG091G07OD/ALICUT_EOG091G07OD.clustalo.fasta -n EOG091G07OD.clustalo.aln.ALICUT.$RAxMLmodel 		1> ../../per_gene/EOG091G07OD/infer_single_ML.stdout.txt 2> ../../per_gene/EOG091G07OD/infer_single_ML.stderr.txt
	else
		echo "fasta file per_gene/EOG091G07OD/ALICUT_EOG091G07OD.clustalo.fasta contains fewer than 5 sequences - skipped" > ../../per_gene/EOG091G07OD/infer_single_ML.stdout.txt
		touch raxml.skipped
	fi
        touch ../../per_gene/EOG091G07OD/EOG091G07OD.raxml.done
        
[Sun Jul  5 23:54:53 2020]
Finished job 625.
2574 of 3292 steps (78%) done

[Sun Jul  5 23:54:53 2020]
rule remove_empty:
    input: per_gene/EOG091G0G3M/ALICUT_EOG091G0G3M.clustalo.fasta
    output: per_gene/EOG091G0G3M/empty_check.done
    jobid: 1447
    wildcards: BUSCO=EOG091G0G3M


         if [ "$(cat per_gene/EOG091G0G3M/ALICUT_EOG091G0G3M.clustalo.fasta | grep -v ">" | sed 's/-//g' | grep "^$" | wc -l)" -gt 0 ]
         then
              cp per_gene/EOG091G0G3M/ALICUT_EOG091G0G3M.clustalo.fasta per_gene/EOG091G0G3M/ALICUT_EOG091G0G3M.clustalo.fasta.backup
              bash ../scripts/remove_empty.sh per_gene/EOG091G0G3M/ALICUT_EOG091G0G3M.clustalo.fasta.backup > per_gene/EOG091G0G3M/ALICUT_EOG091G0G3M.clustalo.fasta
         fi
         touch per_gene/EOG091G0G3M/empty_check.done
         
[Sun Jul  5 23:54:54 2020]
Finished job 1447.
2575 of 3292 steps (78%) done

[Sun Jul  5 23:54:54 2020]
rule find_best_model:
    input: per_gene/EOG091G0G3M/ALICUT_EOG091G0G3M.clustalo.fasta, per_gene/EOG091G0G3M/empty_check.done
    output: per_gene/EOG091G0G3M/EOG091G0G3M.best_model
    log: per_gene/EOG091G0G3M/find_best_model.stderr.txt
    jobid: 624
    wildcards: BUSCO=EOG091G0G3M
    threads: 2


        cd per_gene/EOG091G0G3M
        if [ ! -d find_best_model ]
        then
            mkdir find_best_model
        fi
        cd find_best_model
        ln -s ../../../per_gene/EOG091G0G3M/ALICUT_EOG091G0G3M.clustalo.fasta EOG091G0G3M.fasta
        ProteinModelSelection.pl EOG091G0G3M.fasta 1> ../../../per_gene/EOG091G0G3M/EOG091G0G3M.best_model 2> ../../../per_gene/EOG091G0G3M/find_best_model.stderr.txt
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/c0c09ee657b1e27f2c5687e0e9aa8d70.simg
[Sun Jul  5 23:54:59 2020]
Finished job 155.
2576 of 3292 steps (78%) done

[Sun Jul  5 23:54:59 2020]
rule get_seqs:
    input: /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ingroup.txt, /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/outgroup.txt
    output: per_gene/EOG091G01EW/EOG091G01EW.ingroup.fasta
    log: per_gene/EOG091G01EW/get_seqs.stdout.txt, per_gene/EOG091G01EW/get_seqs.stderr.txt
    jobid: 2482
    wildcards: BUSCO=EOG091G01EW
    threads: 2


	basedir=$(pwd)
        cd per_gene/EOG091G01EW
        
        bash $basedir/../scripts/fetch_seqs.sh EOG091G01EW /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ingroup.txt /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/outgroup.txt 1> ../../per_gene/EOG091G01EW/get_seqs.stdout.txt 2> ../../per_gene/EOG091G01EW/get_seqs.stderr.txt
	mv EOG091G01EW.fasta $basedir/per_gene/EOG091G01EW/EOG091G01EW.ingroup.fasta
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/72476f9d9a5bd0627b4d721143a21354.simg
[33mJob counts:
	count	jobs
	1	infer_single_ML
	1[0m
[33m
        cd per_gene/EOG091G07OD
	count=$(cat ../../per_gene/EOG091G07OD/ALICUT_EOG091G07OD.clustalo.fasta | grep ">" | wc -l)
	if [ "$count" -gt 5 ]
        then
		RAxMLmodel=$(cat ../../per_gene/EOG091G07OD/EOG091G07OD.best_model | grep "Best" | cut -d ":" -f 2 | tr -d '[:space:]')
                if [ "$(ls -1 | grep "^RAxML" | wc -l)" -ne 0 ]
		then
			rm RAxML*
		fi
        	raxml -f a -T 2 -m PROTGAMMA$RAxMLmodel         	-p 12345 -x 12345 -# 100         	-s ../../per_gene/EOG091G07OD/ALICUT_EOG091G07OD.clustalo.fasta -n EOG091G07OD.clustalo.aln.ALICUT.$RAxMLmodel 		1> ../../per_gene/EOG091G07OD/infer_single_ML.stdout.txt 2> ../../per_gene/EOG091G07OD/infer_single_ML.stderr.txt
	else
		echo "fasta file per_gene/EOG091G07OD/ALICUT_EOG091G07OD.clustalo.fasta contains fewer than 5 sequences - skipped" > ../../per_gene/EOG091G07OD/infer_single_ML.stdout.txt
		touch raxml.skipped
	fi
        touch ../../per_gene/EOG091G07OD/EOG091G07OD.raxml.done
        [0m
[Sun Jul  5 23:55:10 2020]
Finished job 122.
2577 of 3292 steps (78%) done

[Sun Jul  5 23:55:10 2020]
rule get_seqs:
    input: /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ingroup.txt, /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/outgroup.txt
    output: per_gene/EOG091G08RU/EOG091G08RU.ingroup.fasta
    log: per_gene/EOG091G08RU/get_seqs.stdout.txt, per_gene/EOG091G08RU/get_seqs.stderr.txt
    jobid: 2596
    wildcards: BUSCO=EOG091G08RU
    threads: 2


	basedir=$(pwd)
        cd per_gene/EOG091G08RU
        
        bash $basedir/../scripts/fetch_seqs.sh EOG091G08RU /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ingroup.txt /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/outgroup.txt 1> ../../per_gene/EOG091G08RU/get_seqs.stdout.txt 2> ../../per_gene/EOG091G08RU/get_seqs.stderr.txt
	mv EOG091G08RU.fasta $basedir/per_gene/EOG091G08RU/EOG091G08RU.ingroup.fasta
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/72476f9d9a5bd0627b4d721143a21354.simg
[Sun Jul  5 23:55:13 2020]
Finished job 2482.
2578 of 3292 steps (78%) done

[Sun Jul  5 23:55:13 2020]
rule get_outgroups:
    input: per_gene/EOG091G01EW/EOG091G01EW.ingroup.fasta
    output: per_gene/EOG091G01EW/EOG091G01EW.orthodb.fasta, per_gene/EOG091G01EW/EOG091G01EW.outgroup.fasta
    log: per_gene/EOG091G01EW/get_outgroups.stdout.txt, per_gene/EOG091G01EW/get_outgroups.stderr.txt
    jobid: 2483
    wildcards: BUSCO=EOG091G01EW


        #download fastas from Orhtodb for BUSCO id
        for i in {1..5}
        do
             wget "http://www.orthodb.org/fasta?query=EOG091G01EW&level=33208" -O per_gene/EOG091G01EW/EOG091G01EW.orthodb.fasta 1> per_gene/EOG091G01EW/get_outgroups.stdout.txt 2> per_gene/EOG091G01EW/get_outgroups.stderr.txt && break || echo -e "try again ($i)" && sleep 15
        done

	#This is quick an dirty for now and just takes the first protein if there is more than one for an outgroup taxon
        bash ../scripts/download_outgroups.sh taxids.txt per_gene/EOG091G01EW/EOG091G01EW.orthodb.fasta > per_gene/EOG091G01EW/EOG091G01EW.outgroup.fasta
        
[Sun Jul  5 23:55:14 2020]
Finished job 2483.
2579 of 3292 steps (78%) done

[Sun Jul  5 23:55:14 2020]
rule join_groups:
    input: per_gene/EOG091G01EW/EOG091G01EW.ingroup.fasta, per_gene/EOG091G01EW/EOG091G01EW.outgroup.fasta
    output: per_gene/EOG091G01EW/EOG091G01EW.fasta
    jobid: 2065
    wildcards: BUSCO=EOG091G01EW


        cat per_gene/EOG091G01EW/EOG091G01EW.ingroup.fasta per_gene/EOG091G01EW/EOG091G01EW.outgroup.fasta > per_gene/EOG091G01EW/EOG091G01EW.fasta
        
[Sun Jul  5 23:55:14 2020]
Finished job 2065.
2580 of 3292 steps (78%) done

[Sun Jul  5 23:55:14 2020]
rule MSA:
    input: per_gene/EOG091G01EW/EOG091G01EW.fasta
    output: per_gene/EOG091G01EW/EOG091G01EW.clustalo.fasta
    log: per_gene/EOG091G01EW/MSA.stdout.txt, per_gene/EOG091G01EW/MSA.stderr.txt
    jobid: 1250
    wildcards: BUSCO=EOG091G01EW
    threads: 2


        clustalo -i per_gene/EOG091G01EW/EOG091G01EW.fasta -o per_gene/EOG091G01EW/EOG091G01EW.clustalo.fasta --threads=2 1> per_gene/EOG091G01EW/MSA.stdout.txt 2> per_gene/EOG091G01EW/MSA.stderr.txt
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/d68c9691725a7401923680874285c430.simg
[Sun Jul  5 23:55:18 2020]
Finished job 1250.
2581 of 3292 steps (78%) done

[Sun Jul  5 23:55:18 2020]
rule score_and_cut:
    input: per_gene/EOG091G01EW/EOG091G01EW.clustalo.fasta
    output: per_gene/EOG091G01EW/ALICUT_EOG091G01EW.clustalo.fasta
    jobid: 427
    wildcards: BUSCO=EOG091G01EW
    threads: 2


        cd per_gene/EOG091G01EW
        Aliscore.pl -N -r 200000000000000000 -i ../../per_gene/EOG091G01EW/EOG091G01EW.clustalo.fasta &> aliscore.log
        ALICUT.pl -s &> alicut.log
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/63c88c27a0fa300f57066b0ef65fefcb.simg
[Sun Jul  5 23:55:22 2020]
Finished job 2596.
2582 of 3292 steps (78%) done

[Sun Jul  5 23:55:22 2020]
rule get_outgroups:
    input: per_gene/EOG091G08RU/EOG091G08RU.ingroup.fasta
    output: per_gene/EOG091G08RU/EOG091G08RU.orthodb.fasta, per_gene/EOG091G08RU/EOG091G08RU.outgroup.fasta
    log: per_gene/EOG091G08RU/get_outgroups.stdout.txt, per_gene/EOG091G08RU/get_outgroups.stderr.txt
    jobid: 2597
    wildcards: BUSCO=EOG091G08RU


        #download fastas from Orhtodb for BUSCO id
        for i in {1..5}
        do
             wget "http://www.orthodb.org/fasta?query=EOG091G08RU&level=33208" -O per_gene/EOG091G08RU/EOG091G08RU.orthodb.fasta 1> per_gene/EOG091G08RU/get_outgroups.stdout.txt 2> per_gene/EOG091G08RU/get_outgroups.stderr.txt && break || echo -e "try again ($i)" && sleep 15
        done

	#This is quick an dirty for now and just takes the first protein if there is more than one for an outgroup taxon
        bash ../scripts/download_outgroups.sh taxids.txt per_gene/EOG091G08RU/EOG091G08RU.orthodb.fasta > per_gene/EOG091G08RU/EOG091G08RU.outgroup.fasta
        
[Sun Jul  5 23:55:23 2020]
Finished job 2597.
2583 of 3292 steps (78%) done

[Sun Jul  5 23:55:23 2020]
rule join_groups:
    input: per_gene/EOG091G08RU/EOG091G08RU.ingroup.fasta, per_gene/EOG091G08RU/EOG091G08RU.outgroup.fasta
    output: per_gene/EOG091G08RU/EOG091G08RU.fasta
    jobid: 2122
    wildcards: BUSCO=EOG091G08RU


        cat per_gene/EOG091G08RU/EOG091G08RU.ingroup.fasta per_gene/EOG091G08RU/EOG091G08RU.outgroup.fasta > per_gene/EOG091G08RU/EOG091G08RU.fasta
        
[Sun Jul  5 23:55:23 2020]
Finished job 2122.
2584 of 3292 steps (78%) done

[Sun Jul  5 23:55:23 2020]
rule MSA:
    input: per_gene/EOG091G08RU/EOG091G08RU.fasta
    output: per_gene/EOG091G08RU/EOG091G08RU.clustalo.fasta
    log: per_gene/EOG091G08RU/MSA.stdout.txt, per_gene/EOG091G08RU/MSA.stderr.txt
    jobid: 1364
    wildcards: BUSCO=EOG091G08RU
    threads: 2


        clustalo -i per_gene/EOG091G08RU/EOG091G08RU.fasta -o per_gene/EOG091G08RU/EOG091G08RU.clustalo.fasta --threads=2 1> per_gene/EOG091G08RU/MSA.stdout.txt 2> per_gene/EOG091G08RU/MSA.stderr.txt
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/d68c9691725a7401923680874285c430.simg
[Sun Jul  5 23:55:23 2020]
Finished job 37.
2585 of 3292 steps (79%) done

[Sun Jul  5 23:55:23 2020]
rule get_seqs:
    input: /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ingroup.txt, /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/outgroup.txt
    output: per_gene/EOG091G08VB/EOG091G08VB.ingroup.fasta
    log: per_gene/EOG091G08VB/get_seqs.stdout.txt, per_gene/EOG091G08VB/get_seqs.stderr.txt
    jobid: 3078
    wildcards: BUSCO=EOG091G08VB
    threads: 2


	basedir=$(pwd)
        cd per_gene/EOG091G08VB
        
        bash $basedir/../scripts/fetch_seqs.sh EOG091G08VB /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ingroup.txt /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/outgroup.txt 1> ../../per_gene/EOG091G08VB/get_seqs.stdout.txt 2> ../../per_gene/EOG091G08VB/get_seqs.stderr.txt
	mv EOG091G08VB.fasta $basedir/per_gene/EOG091G08VB/EOG091G08VB.ingroup.fasta
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/72476f9d9a5bd0627b4d721143a21354.simg
[Sun Jul  5 23:55:24 2020]
Finished job 624.
2586 of 3292 steps (79%) done

[Sun Jul  5 23:55:24 2020]
rule infer_single_ML:
    input: per_gene/EOG091G0G3M/EOG091G0G3M.best_model, per_gene/EOG091G0G3M/ALICUT_EOG091G0G3M.clustalo.fasta
    output: per_gene/EOG091G0G3M/EOG091G0G3M.raxml.done
    log: per_gene/EOG091G0G3M/infer_single_ML.stdout.txt, per_gene/EOG091G0G3M/infer_single_ML.stderr.txt
    jobid: 106
    wildcards: BUSCO=EOG091G0G3M
    threads: 2


        cd per_gene/EOG091G0G3M
	count=$(cat ../../per_gene/EOG091G0G3M/ALICUT_EOG091G0G3M.clustalo.fasta | grep ">" | wc -l)
	if [ "$count" -gt 5 ]
        then
		RAxMLmodel=$(cat ../../per_gene/EOG091G0G3M/EOG091G0G3M.best_model | grep "Best" | cut -d ":" -f 2 | tr -d '[:space:]')
                if [ "$(ls -1 | grep "^RAxML" | wc -l)" -ne 0 ]
		then
			rm RAxML*
		fi
        	raxml -f a -T 2 -m PROTGAMMA$RAxMLmodel         	-p 12345 -x 12345 -# 100         	-s ../../per_gene/EOG091G0G3M/ALICUT_EOG091G0G3M.clustalo.fasta -n EOG091G0G3M.clustalo.aln.ALICUT.$RAxMLmodel 		1> ../../per_gene/EOG091G0G3M/infer_single_ML.stdout.txt 2> ../../per_gene/EOG091G0G3M/infer_single_ML.stderr.txt
	else
		echo "fasta file per_gene/EOG091G0G3M/ALICUT_EOG091G0G3M.clustalo.fasta contains fewer than 5 sequences - skipped" > ../../per_gene/EOG091G0G3M/infer_single_ML.stdout.txt
		touch raxml.skipped
	fi
        touch ../../per_gene/EOG091G0G3M/EOG091G0G3M.raxml.done
        
[Sun Jul  5 23:55:25 2020]
Finished job 1364.
2587 of 3292 steps (79%) done

[Sun Jul  5 23:55:25 2020]
rule score_and_cut:
    input: per_gene/EOG091G08RU/EOG091G08RU.clustalo.fasta
    output: per_gene/EOG091G08RU/ALICUT_EOG091G08RU.clustalo.fasta
    jobid: 541
    wildcards: BUSCO=EOG091G08RU
    threads: 2


        cd per_gene/EOG091G08RU
        Aliscore.pl -N -r 200000000000000000 -i ../../per_gene/EOG091G08RU/EOG091G08RU.clustalo.fasta &> aliscore.log
        ALICUT.pl -s &> alicut.log
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/63c88c27a0fa300f57066b0ef65fefcb.simg
[33mJob counts:
	count	jobs
	1	infer_single_ML
	1[0m
[33m
        cd per_gene/EOG091G0G3M
	count=$(cat ../../per_gene/EOG091G0G3M/ALICUT_EOG091G0G3M.clustalo.fasta | grep ">" | wc -l)
	if [ "$count" -gt 5 ]
        then
		RAxMLmodel=$(cat ../../per_gene/EOG091G0G3M/EOG091G0G3M.best_model | grep "Best" | cut -d ":" -f 2 | tr -d '[:space:]')
                if [ "$(ls -1 | grep "^RAxML" | wc -l)" -ne 0 ]
		then
			rm RAxML*
		fi
        	raxml -f a -T 2 -m PROTGAMMA$RAxMLmodel         	-p 12345 -x 12345 -# 100         	-s ../../per_gene/EOG091G0G3M/ALICUT_EOG091G0G3M.clustalo.fasta -n EOG091G0G3M.clustalo.aln.ALICUT.$RAxMLmodel 		1> ../../per_gene/EOG091G0G3M/infer_single_ML.stdout.txt 2> ../../per_gene/EOG091G0G3M/infer_single_ML.stderr.txt
	else
		echo "fasta file per_gene/EOG091G0G3M/ALICUT_EOG091G0G3M.clustalo.fasta contains fewer than 5 sequences - skipped" > ../../per_gene/EOG091G0G3M/infer_single_ML.stdout.txt
		touch raxml.skipped
	fi
        touch ../../per_gene/EOG091G0G3M/EOG091G0G3M.raxml.done
        [0m
[Sun Jul  5 23:55:29 2020]
Finished job 427.
2588 of 3292 steps (79%) done

[Sun Jul  5 23:55:29 2020]
rule remove_empty:
    input: per_gene/EOG091G01EW/ALICUT_EOG091G01EW.clustalo.fasta
    output: per_gene/EOG091G01EW/empty_check.done
    jobid: 1249
    wildcards: BUSCO=EOG091G01EW


         if [ "$(cat per_gene/EOG091G01EW/ALICUT_EOG091G01EW.clustalo.fasta | grep -v ">" | sed 's/-//g' | grep "^$" | wc -l)" -gt 0 ]
         then
              cp per_gene/EOG091G01EW/ALICUT_EOG091G01EW.clustalo.fasta per_gene/EOG091G01EW/ALICUT_EOG091G01EW.clustalo.fasta.backup
              bash ../scripts/remove_empty.sh per_gene/EOG091G01EW/ALICUT_EOG091G01EW.clustalo.fasta.backup > per_gene/EOG091G01EW/ALICUT_EOG091G01EW.clustalo.fasta
         fi
         touch per_gene/EOG091G01EW/empty_check.done
         
[Sun Jul  5 23:55:29 2020]
Finished job 1249.
2589 of 3292 steps (79%) done

[Sun Jul  5 23:55:29 2020]
rule find_best_model:
    input: per_gene/EOG091G01EW/ALICUT_EOG091G01EW.clustalo.fasta, per_gene/EOG091G01EW/empty_check.done
    output: per_gene/EOG091G01EW/EOG091G01EW.best_model
    log: per_gene/EOG091G01EW/find_best_model.stderr.txt
    jobid: 426
    wildcards: BUSCO=EOG091G01EW
    threads: 2


        cd per_gene/EOG091G01EW
        if [ ! -d find_best_model ]
        then
            mkdir find_best_model
        fi
        cd find_best_model
        ln -s ../../../per_gene/EOG091G01EW/ALICUT_EOG091G01EW.clustalo.fasta EOG091G01EW.fasta
        ProteinModelSelection.pl EOG091G01EW.fasta 1> ../../../per_gene/EOG091G01EW/EOG091G01EW.best_model 2> ../../../per_gene/EOG091G01EW/find_best_model.stderr.txt
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/c0c09ee657b1e27f2c5687e0e9aa8d70.simg
[Sun Jul  5 23:55:35 2020]
Finished job 3078.
2590 of 3292 steps (79%) done

[Sun Jul  5 23:55:35 2020]
rule get_outgroups:
    input: per_gene/EOG091G08VB/EOG091G08VB.ingroup.fasta
    output: per_gene/EOG091G08VB/EOG091G08VB.orthodb.fasta, per_gene/EOG091G08VB/EOG091G08VB.outgroup.fasta
    log: per_gene/EOG091G08VB/get_outgroups.stdout.txt, per_gene/EOG091G08VB/get_outgroups.stderr.txt
    jobid: 3079
    wildcards: BUSCO=EOG091G08VB


        #download fastas from Orhtodb for BUSCO id
        for i in {1..5}
        do
             wget "http://www.orthodb.org/fasta?query=EOG091G08VB&level=33208" -O per_gene/EOG091G08VB/EOG091G08VB.orthodb.fasta 1> per_gene/EOG091G08VB/get_outgroups.stdout.txt 2> per_gene/EOG091G08VB/get_outgroups.stderr.txt && break || echo -e "try again ($i)" && sleep 15
        done

	#This is quick an dirty for now and just takes the first protein if there is more than one for an outgroup taxon
        bash ../scripts/download_outgroups.sh taxids.txt per_gene/EOG091G08VB/EOG091G08VB.orthodb.fasta > per_gene/EOG091G08VB/EOG091G08VB.outgroup.fasta
        
[Sun Jul  5 23:55:36 2020]
Finished job 3079.
2591 of 3292 steps (79%) done

[Sun Jul  5 23:55:36 2020]
rule join_groups:
    input: per_gene/EOG091G08VB/EOG091G08VB.ingroup.fasta, per_gene/EOG091G08VB/EOG091G08VB.outgroup.fasta
    output: per_gene/EOG091G08VB/EOG091G08VB.fasta
    jobid: 2363
    wildcards: BUSCO=EOG091G08VB


        cat per_gene/EOG091G08VB/EOG091G08VB.ingroup.fasta per_gene/EOG091G08VB/EOG091G08VB.outgroup.fasta > per_gene/EOG091G08VB/EOG091G08VB.fasta
        
[Sun Jul  5 23:55:36 2020]
Finished job 2363.
2592 of 3292 steps (79%) done

[Sun Jul  5 23:55:36 2020]
rule MSA:
    input: per_gene/EOG091G08VB/EOG091G08VB.fasta
    output: per_gene/EOG091G08VB/EOG091G08VB.clustalo.fasta
    log: per_gene/EOG091G08VB/MSA.stdout.txt, per_gene/EOG091G08VB/MSA.stderr.txt
    jobid: 1846
    wildcards: BUSCO=EOG091G08VB
    threads: 2


        clustalo -i per_gene/EOG091G08VB/EOG091G08VB.fasta -o per_gene/EOG091G08VB/EOG091G08VB.clustalo.fasta --threads=2 1> per_gene/EOG091G08VB/MSA.stdout.txt 2> per_gene/EOG091G08VB/MSA.stderr.txt
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/d68c9691725a7401923680874285c430.simg
[Sun Jul  5 23:55:37 2020]
Finished job 541.
2593 of 3292 steps (79%) done

[Sun Jul  5 23:55:37 2020]
rule remove_empty:
    input: per_gene/EOG091G08RU/ALICUT_EOG091G08RU.clustalo.fasta
    output: per_gene/EOG091G08RU/empty_check.done
    jobid: 1363
    wildcards: BUSCO=EOG091G08RU


         if [ "$(cat per_gene/EOG091G08RU/ALICUT_EOG091G08RU.clustalo.fasta | grep -v ">" | sed 's/-//g' | grep "^$" | wc -l)" -gt 0 ]
         then
              cp per_gene/EOG091G08RU/ALICUT_EOG091G08RU.clustalo.fasta per_gene/EOG091G08RU/ALICUT_EOG091G08RU.clustalo.fasta.backup
              bash ../scripts/remove_empty.sh per_gene/EOG091G08RU/ALICUT_EOG091G08RU.clustalo.fasta.backup > per_gene/EOG091G08RU/ALICUT_EOG091G08RU.clustalo.fasta
         fi
         touch per_gene/EOG091G08RU/empty_check.done
         
[Sun Jul  5 23:55:37 2020]
Finished job 1363.
2594 of 3292 steps (79%) done

[Sun Jul  5 23:55:37 2020]
rule find_best_model:
    input: per_gene/EOG091G08RU/ALICUT_EOG091G08RU.clustalo.fasta, per_gene/EOG091G08RU/empty_check.done
    output: per_gene/EOG091G08RU/EOG091G08RU.best_model
    log: per_gene/EOG091G08RU/find_best_model.stderr.txt
    jobid: 540
    wildcards: BUSCO=EOG091G08RU
    threads: 2


        cd per_gene/EOG091G08RU
        if [ ! -d find_best_model ]
        then
            mkdir find_best_model
        fi
        cd find_best_model
        ln -s ../../../per_gene/EOG091G08RU/ALICUT_EOG091G08RU.clustalo.fasta EOG091G08RU.fasta
        ProteinModelSelection.pl EOG091G08RU.fasta 1> ../../../per_gene/EOG091G08RU/EOG091G08RU.best_model 2> ../../../per_gene/EOG091G08RU/find_best_model.stderr.txt
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/c0c09ee657b1e27f2c5687e0e9aa8d70.simg
[Sun Jul  5 23:55:39 2020]
Finished job 1846.
2595 of 3292 steps (79%) done

[Sun Jul  5 23:55:39 2020]
rule score_and_cut:
    input: per_gene/EOG091G08VB/EOG091G08VB.clustalo.fasta
    output: per_gene/EOG091G08VB/ALICUT_EOG091G08VB.clustalo.fasta
    jobid: 1023
    wildcards: BUSCO=EOG091G08VB
    threads: 2


        cd per_gene/EOG091G08VB
        Aliscore.pl -N -r 200000000000000000 -i ../../per_gene/EOG091G08VB/EOG091G08VB.clustalo.fasta &> aliscore.log
        ALICUT.pl -s &> alicut.log
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/63c88c27a0fa300f57066b0ef65fefcb.simg
[Sun Jul  5 23:55:43 2020]
Finished job 315.
2596 of 3292 steps (79%) done

[Sun Jul  5 23:55:43 2020]
rule get_seqs:
    input: /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ingroup.txt, /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/outgroup.txt
    output: per_gene/EOG091G0A98/EOG091G0A98.ingroup.fasta
    log: per_gene/EOG091G0A98/get_seqs.stdout.txt, per_gene/EOG091G0A98/get_seqs.stderr.txt
    jobid: 2618
    wildcards: BUSCO=EOG091G0A98
    threads: 2


	basedir=$(pwd)
        cd per_gene/EOG091G0A98
        
        bash $basedir/../scripts/fetch_seqs.sh EOG091G0A98 /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ingroup.txt /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/outgroup.txt 1> ../../per_gene/EOG091G0A98/get_seqs.stdout.txt 2> ../../per_gene/EOG091G0A98/get_seqs.stderr.txt
	mv EOG091G0A98.fasta $basedir/per_gene/EOG091G0A98/EOG091G0A98.ingroup.fasta
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/72476f9d9a5bd0627b4d721143a21354.simg
[Sun Jul  5 23:55:49 2020]
Finished job 1023.
2597 of 3292 steps (79%) done

[Sun Jul  5 23:55:49 2020]
rule remove_empty:
    input: per_gene/EOG091G08VB/ALICUT_EOG091G08VB.clustalo.fasta
    output: per_gene/EOG091G08VB/empty_check.done
    jobid: 1845
    wildcards: BUSCO=EOG091G08VB


         if [ "$(cat per_gene/EOG091G08VB/ALICUT_EOG091G08VB.clustalo.fasta | grep -v ">" | sed 's/-//g' | grep "^$" | wc -l)" -gt 0 ]
         then
              cp per_gene/EOG091G08VB/ALICUT_EOG091G08VB.clustalo.fasta per_gene/EOG091G08VB/ALICUT_EOG091G08VB.clustalo.fasta.backup
              bash ../scripts/remove_empty.sh per_gene/EOG091G08VB/ALICUT_EOG091G08VB.clustalo.fasta.backup > per_gene/EOG091G08VB/ALICUT_EOG091G08VB.clustalo.fasta
         fi
         touch per_gene/EOG091G08VB/empty_check.done
         
[Sun Jul  5 23:55:49 2020]
Finished job 1845.
2598 of 3292 steps (79%) done

[Sun Jul  5 23:55:49 2020]
rule find_best_model:
    input: per_gene/EOG091G08VB/ALICUT_EOG091G08VB.clustalo.fasta, per_gene/EOG091G08VB/empty_check.done
    output: per_gene/EOG091G08VB/EOG091G08VB.best_model
    log: per_gene/EOG091G08VB/find_best_model.stderr.txt
    jobid: 1022
    wildcards: BUSCO=EOG091G08VB
    threads: 2


        cd per_gene/EOG091G08VB
        if [ ! -d find_best_model ]
        then
            mkdir find_best_model
        fi
        cd find_best_model
        ln -s ../../../per_gene/EOG091G08VB/ALICUT_EOG091G08VB.clustalo.fasta EOG091G08VB.fasta
        ProteinModelSelection.pl EOG091G08VB.fasta 1> ../../../per_gene/EOG091G08VB/EOG091G08VB.best_model 2> ../../../per_gene/EOG091G08VB/find_best_model.stderr.txt
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/c0c09ee657b1e27f2c5687e0e9aa8d70.simg
[Sun Jul  5 23:55:55 2020]
Finished job 2618.
2599 of 3292 steps (79%) done

[Sun Jul  5 23:55:55 2020]
rule get_outgroups:
    input: per_gene/EOG091G0A98/EOG091G0A98.ingroup.fasta
    output: per_gene/EOG091G0A98/EOG091G0A98.orthodb.fasta, per_gene/EOG091G0A98/EOG091G0A98.outgroup.fasta
    log: per_gene/EOG091G0A98/get_outgroups.stdout.txt, per_gene/EOG091G0A98/get_outgroups.stderr.txt
    jobid: 2619
    wildcards: BUSCO=EOG091G0A98


        #download fastas from Orhtodb for BUSCO id
        for i in {1..5}
        do
             wget "http://www.orthodb.org/fasta?query=EOG091G0A98&level=33208" -O per_gene/EOG091G0A98/EOG091G0A98.orthodb.fasta 1> per_gene/EOG091G0A98/get_outgroups.stdout.txt 2> per_gene/EOG091G0A98/get_outgroups.stderr.txt && break || echo -e "try again ($i)" && sleep 15
        done

	#This is quick an dirty for now and just takes the first protein if there is more than one for an outgroup taxon
        bash ../scripts/download_outgroups.sh taxids.txt per_gene/EOG091G0A98/EOG091G0A98.orthodb.fasta > per_gene/EOG091G0A98/EOG091G0A98.outgroup.fasta
        
[Sun Jul  5 23:55:56 2020]
Finished job 2619.
2600 of 3292 steps (79%) done

[Sun Jul  5 23:55:56 2020]
rule join_groups:
    input: per_gene/EOG091G0A98/EOG091G0A98.ingroup.fasta, per_gene/EOG091G0A98/EOG091G0A98.outgroup.fasta
    output: per_gene/EOG091G0A98/EOG091G0A98.fasta
    jobid: 2133
    wildcards: BUSCO=EOG091G0A98


        cat per_gene/EOG091G0A98/EOG091G0A98.ingroup.fasta per_gene/EOG091G0A98/EOG091G0A98.outgroup.fasta > per_gene/EOG091G0A98/EOG091G0A98.fasta
        
[Sun Jul  5 23:55:56 2020]
Finished job 2133.
2601 of 3292 steps (79%) done

[Sun Jul  5 23:55:56 2020]
rule MSA:
    input: per_gene/EOG091G0A98/EOG091G0A98.fasta
    output: per_gene/EOG091G0A98/EOG091G0A98.clustalo.fasta
    log: per_gene/EOG091G0A98/MSA.stdout.txt, per_gene/EOG091G0A98/MSA.stderr.txt
    jobid: 1386
    wildcards: BUSCO=EOG091G0A98
    threads: 2


        clustalo -i per_gene/EOG091G0A98/EOG091G0A98.fasta -o per_gene/EOG091G0A98/EOG091G0A98.clustalo.fasta --threads=2 1> per_gene/EOG091G0A98/MSA.stdout.txt 2> per_gene/EOG091G0A98/MSA.stderr.txt
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/d68c9691725a7401923680874285c430.simg
[Sun Jul  5 23:55:57 2020]
Finished job 1386.
2602 of 3292 steps (79%) done

[Sun Jul  5 23:55:57 2020]
rule score_and_cut:
    input: per_gene/EOG091G0A98/EOG091G0A98.clustalo.fasta
    output: per_gene/EOG091G0A98/ALICUT_EOG091G0A98.clustalo.fasta
    jobid: 563
    wildcards: BUSCO=EOG091G0A98
    threads: 2


        cd per_gene/EOG091G0A98
        Aliscore.pl -N -r 200000000000000000 -i ../../per_gene/EOG091G0A98/EOG091G0A98.clustalo.fasta &> aliscore.log
        ALICUT.pl -s &> alicut.log
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/63c88c27a0fa300f57066b0ef65fefcb.simg
[Sun Jul  5 23:56:07 2020]
Finished job 563.
2603 of 3292 steps (79%) done

[Sun Jul  5 23:56:07 2020]
rule remove_empty:
    input: per_gene/EOG091G0A98/ALICUT_EOG091G0A98.clustalo.fasta
    output: per_gene/EOG091G0A98/empty_check.done
    jobid: 1385
    wildcards: BUSCO=EOG091G0A98


         if [ "$(cat per_gene/EOG091G0A98/ALICUT_EOG091G0A98.clustalo.fasta | grep -v ">" | sed 's/-//g' | grep "^$" | wc -l)" -gt 0 ]
         then
              cp per_gene/EOG091G0A98/ALICUT_EOG091G0A98.clustalo.fasta per_gene/EOG091G0A98/ALICUT_EOG091G0A98.clustalo.fasta.backup
              bash ../scripts/remove_empty.sh per_gene/EOG091G0A98/ALICUT_EOG091G0A98.clustalo.fasta.backup > per_gene/EOG091G0A98/ALICUT_EOG091G0A98.clustalo.fasta
         fi
         touch per_gene/EOG091G0A98/empty_check.done
         
[Sun Jul  5 23:56:07 2020]
Finished job 1385.
2604 of 3292 steps (79%) done

[Sun Jul  5 23:56:07 2020]
rule find_best_model:
    input: per_gene/EOG091G0A98/ALICUT_EOG091G0A98.clustalo.fasta, per_gene/EOG091G0A98/empty_check.done
    output: per_gene/EOG091G0A98/EOG091G0A98.best_model
    log: per_gene/EOG091G0A98/find_best_model.stderr.txt
    jobid: 562
    wildcards: BUSCO=EOG091G0A98
    threads: 2


        cd per_gene/EOG091G0A98
        if [ ! -d find_best_model ]
        then
            mkdir find_best_model
        fi
        cd find_best_model
        ln -s ../../../per_gene/EOG091G0A98/ALICUT_EOG091G0A98.clustalo.fasta EOG091G0A98.fasta
        ProteinModelSelection.pl EOG091G0A98.fasta 1> ../../../per_gene/EOG091G0A98/EOG091G0A98.best_model 2> ../../../per_gene/EOG091G0A98/find_best_model.stderr.txt
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/c0c09ee657b1e27f2c5687e0e9aa8d70.simg
[Sun Jul  5 23:56:14 2020]
Finished job 426.
2605 of 3292 steps (79%) done

[Sun Jul  5 23:56:14 2020]
rule infer_single_ML:
    input: per_gene/EOG091G01EW/EOG091G01EW.best_model, per_gene/EOG091G01EW/ALICUT_EOG091G01EW.clustalo.fasta
    output: per_gene/EOG091G01EW/EOG091G01EW.raxml.done
    log: per_gene/EOG091G01EW/infer_single_ML.stdout.txt, per_gene/EOG091G01EW/infer_single_ML.stderr.txt
    jobid: 7
    wildcards: BUSCO=EOG091G01EW
    threads: 2


        cd per_gene/EOG091G01EW
	count=$(cat ../../per_gene/EOG091G01EW/ALICUT_EOG091G01EW.clustalo.fasta | grep ">" | wc -l)
	if [ "$count" -gt 5 ]
        then
		RAxMLmodel=$(cat ../../per_gene/EOG091G01EW/EOG091G01EW.best_model | grep "Best" | cut -d ":" -f 2 | tr -d '[:space:]')
                if [ "$(ls -1 | grep "^RAxML" | wc -l)" -ne 0 ]
		then
			rm RAxML*
		fi
        	raxml -f a -T 2 -m PROTGAMMA$RAxMLmodel         	-p 12345 -x 12345 -# 100         	-s ../../per_gene/EOG091G01EW/ALICUT_EOG091G01EW.clustalo.fasta -n EOG091G01EW.clustalo.aln.ALICUT.$RAxMLmodel 		1> ../../per_gene/EOG091G01EW/infer_single_ML.stdout.txt 2> ../../per_gene/EOG091G01EW/infer_single_ML.stderr.txt
	else
		echo "fasta file per_gene/EOG091G01EW/ALICUT_EOG091G01EW.clustalo.fasta contains fewer than 5 sequences - skipped" > ../../per_gene/EOG091G01EW/infer_single_ML.stdout.txt
		touch raxml.skipped
	fi
        touch ../../per_gene/EOG091G01EW/EOG091G01EW.raxml.done
        
[33mJob counts:
	count	jobs
	1	infer_single_ML
	1[0m
[33m
        cd per_gene/EOG091G01EW
	count=$(cat ../../per_gene/EOG091G01EW/ALICUT_EOG091G01EW.clustalo.fasta | grep ">" | wc -l)
	if [ "$count" -gt 5 ]
        then
		RAxMLmodel=$(cat ../../per_gene/EOG091G01EW/EOG091G01EW.best_model | grep "Best" | cut -d ":" -f 2 | tr -d '[:space:]')
                if [ "$(ls -1 | grep "^RAxML" | wc -l)" -ne 0 ]
		then
			rm RAxML*
		fi
        	raxml -f a -T 2 -m PROTGAMMA$RAxMLmodel         	-p 12345 -x 12345 -# 100         	-s ../../per_gene/EOG091G01EW/ALICUT_EOG091G01EW.clustalo.fasta -n EOG091G01EW.clustalo.aln.ALICUT.$RAxMLmodel 		1> ../../per_gene/EOG091G01EW/infer_single_ML.stdout.txt 2> ../../per_gene/EOG091G01EW/infer_single_ML.stderr.txt
	else
		echo "fasta file per_gene/EOG091G01EW/ALICUT_EOG091G01EW.clustalo.fasta contains fewer than 5 sequences - skipped" > ../../per_gene/EOG091G01EW/infer_single_ML.stdout.txt
		touch raxml.skipped
	fi
        touch ../../per_gene/EOG091G01EW/EOG091G01EW.raxml.done
        [0m
[Sun Jul  5 23:56:20 2020]
Finished job 134.
2606 of 3292 steps (79%) done

[Sun Jul  5 23:56:20 2020]
rule get_seqs:
    input: /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ingroup.txt, /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/outgroup.txt
    output: per_gene/EOG091G0XQ3/EOG091G0XQ3.ingroup.fasta
    log: per_gene/EOG091G0XQ3/get_seqs.stdout.txt, per_gene/EOG091G0XQ3/get_seqs.stderr.txt
    jobid: 2892
    wildcards: BUSCO=EOG091G0XQ3
    threads: 2


	basedir=$(pwd)
        cd per_gene/EOG091G0XQ3
        
        bash $basedir/../scripts/fetch_seqs.sh EOG091G0XQ3 /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ingroup.txt /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/outgroup.txt 1> ../../per_gene/EOG091G0XQ3/get_seqs.stdout.txt 2> ../../per_gene/EOG091G0XQ3/get_seqs.stderr.txt
	mv EOG091G0XQ3.fasta $basedir/per_gene/EOG091G0XQ3/EOG091G0XQ3.ingroup.fasta
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/72476f9d9a5bd0627b4d721143a21354.simg
[Sun Jul  5 23:56:21 2020]
Finished job 540.
2607 of 3292 steps (79%) done

[Sun Jul  5 23:56:21 2020]
rule infer_single_ML:
    input: per_gene/EOG091G08RU/EOG091G08RU.best_model, per_gene/EOG091G08RU/ALICUT_EOG091G08RU.clustalo.fasta
    output: per_gene/EOG091G08RU/EOG091G08RU.raxml.done
    log: per_gene/EOG091G08RU/infer_single_ML.stdout.txt, per_gene/EOG091G08RU/infer_single_ML.stderr.txt
    jobid: 64
    wildcards: BUSCO=EOG091G08RU
    threads: 2


        cd per_gene/EOG091G08RU
	count=$(cat ../../per_gene/EOG091G08RU/ALICUT_EOG091G08RU.clustalo.fasta | grep ">" | wc -l)
	if [ "$count" -gt 5 ]
        then
		RAxMLmodel=$(cat ../../per_gene/EOG091G08RU/EOG091G08RU.best_model | grep "Best" | cut -d ":" -f 2 | tr -d '[:space:]')
                if [ "$(ls -1 | grep "^RAxML" | wc -l)" -ne 0 ]
		then
			rm RAxML*
		fi
        	raxml -f a -T 2 -m PROTGAMMA$RAxMLmodel         	-p 12345 -x 12345 -# 100         	-s ../../per_gene/EOG091G08RU/ALICUT_EOG091G08RU.clustalo.fasta -n EOG091G08RU.clustalo.aln.ALICUT.$RAxMLmodel 		1> ../../per_gene/EOG091G08RU/infer_single_ML.stdout.txt 2> ../../per_gene/EOG091G08RU/infer_single_ML.stderr.txt
	else
		echo "fasta file per_gene/EOG091G08RU/ALICUT_EOG091G08RU.clustalo.fasta contains fewer than 5 sequences - skipped" > ../../per_gene/EOG091G08RU/infer_single_ML.stdout.txt
		touch raxml.skipped
	fi
        touch ../../per_gene/EOG091G08RU/EOG091G08RU.raxml.done
        
[33mJob counts:
	count	jobs
	1	infer_single_ML
	1[0m
[33m
        cd per_gene/EOG091G08RU
	count=$(cat ../../per_gene/EOG091G08RU/ALICUT_EOG091G08RU.clustalo.fasta | grep ">" | wc -l)
	if [ "$count" -gt 5 ]
        then
		RAxMLmodel=$(cat ../../per_gene/EOG091G08RU/EOG091G08RU.best_model | grep "Best" | cut -d ":" -f 2 | tr -d '[:space:]')
                if [ "$(ls -1 | grep "^RAxML" | wc -l)" -ne 0 ]
		then
			rm RAxML*
		fi
        	raxml -f a -T 2 -m PROTGAMMA$RAxMLmodel         	-p 12345 -x 12345 -# 100         	-s ../../per_gene/EOG091G08RU/ALICUT_EOG091G08RU.clustalo.fasta -n EOG091G08RU.clustalo.aln.ALICUT.$RAxMLmodel 		1> ../../per_gene/EOG091G08RU/infer_single_ML.stdout.txt 2> ../../per_gene/EOG091G08RU/infer_single_ML.stderr.txt
	else
		echo "fasta file per_gene/EOG091G08RU/ALICUT_EOG091G08RU.clustalo.fasta contains fewer than 5 sequences - skipped" > ../../per_gene/EOG091G08RU/infer_single_ML.stdout.txt
		touch raxml.skipped
	fi
        touch ../../per_gene/EOG091G08RU/EOG091G08RU.raxml.done
        [0m
[Sun Jul  5 23:56:33 2020]
Finished job 2892.
2608 of 3292 steps (79%) done

[Sun Jul  5 23:56:33 2020]
rule get_outgroups:
    input: per_gene/EOG091G0XQ3/EOG091G0XQ3.ingroup.fasta
    output: per_gene/EOG091G0XQ3/EOG091G0XQ3.orthodb.fasta, per_gene/EOG091G0XQ3/EOG091G0XQ3.outgroup.fasta
    log: per_gene/EOG091G0XQ3/get_outgroups.stdout.txt, per_gene/EOG091G0XQ3/get_outgroups.stderr.txt
    jobid: 2893
    wildcards: BUSCO=EOG091G0XQ3


        #download fastas from Orhtodb for BUSCO id
        for i in {1..5}
        do
             wget "http://www.orthodb.org/fasta?query=EOG091G0XQ3&level=33208" -O per_gene/EOG091G0XQ3/EOG091G0XQ3.orthodb.fasta 1> per_gene/EOG091G0XQ3/get_outgroups.stdout.txt 2> per_gene/EOG091G0XQ3/get_outgroups.stderr.txt && break || echo -e "try again ($i)" && sleep 15
        done

	#This is quick an dirty for now and just takes the first protein if there is more than one for an outgroup taxon
        bash ../scripts/download_outgroups.sh taxids.txt per_gene/EOG091G0XQ3/EOG091G0XQ3.orthodb.fasta > per_gene/EOG091G0XQ3/EOG091G0XQ3.outgroup.fasta
        
[Sun Jul  5 23:56:34 2020]
Finished job 2893.
2609 of 3292 steps (79%) done

[Sun Jul  5 23:56:34 2020]
rule join_groups:
    input: per_gene/EOG091G0XQ3/EOG091G0XQ3.ingroup.fasta, per_gene/EOG091G0XQ3/EOG091G0XQ3.outgroup.fasta
    output: per_gene/EOG091G0XQ3/EOG091G0XQ3.fasta
    jobid: 2270
    wildcards: BUSCO=EOG091G0XQ3


        cat per_gene/EOG091G0XQ3/EOG091G0XQ3.ingroup.fasta per_gene/EOG091G0XQ3/EOG091G0XQ3.outgroup.fasta > per_gene/EOG091G0XQ3/EOG091G0XQ3.fasta
        
[Sun Jul  5 23:56:34 2020]
Finished job 2270.
2610 of 3292 steps (79%) done

[Sun Jul  5 23:56:34 2020]
rule MSA:
    input: per_gene/EOG091G0XQ3/EOG091G0XQ3.fasta
    output: per_gene/EOG091G0XQ3/EOG091G0XQ3.clustalo.fasta
    log: per_gene/EOG091G0XQ3/MSA.stdout.txt, per_gene/EOG091G0XQ3/MSA.stderr.txt
    jobid: 1660
    wildcards: BUSCO=EOG091G0XQ3
    threads: 2


        clustalo -i per_gene/EOG091G0XQ3/EOG091G0XQ3.fasta -o per_gene/EOG091G0XQ3/EOG091G0XQ3.clustalo.fasta --threads=2 1> per_gene/EOG091G0XQ3/MSA.stdout.txt 2> per_gene/EOG091G0XQ3/MSA.stderr.txt
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/d68c9691725a7401923680874285c430.simg
[Sun Jul  5 23:56:35 2020]
Finished job 1660.
2611 of 3292 steps (79%) done

[Sun Jul  5 23:56:35 2020]
rule score_and_cut:
    input: per_gene/EOG091G0XQ3/EOG091G0XQ3.clustalo.fasta
    output: per_gene/EOG091G0XQ3/ALICUT_EOG091G0XQ3.clustalo.fasta
    jobid: 837
    wildcards: BUSCO=EOG091G0XQ3
    threads: 2


        cd per_gene/EOG091G0XQ3
        Aliscore.pl -N -r 200000000000000000 -i ../../per_gene/EOG091G0XQ3/EOG091G0XQ3.clustalo.fasta &> aliscore.log
        ALICUT.pl -s &> alicut.log
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/63c88c27a0fa300f57066b0ef65fefcb.simg
[Sun Jul  5 23:56:36 2020]
Finished job 376.
2612 of 3292 steps (79%) done

[Sun Jul  5 23:56:36 2020]
rule get_seqs:
    input: /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ingroup.txt, /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/outgroup.txt
    output: per_gene/EOG091G0OWI/EOG091G0OWI.ingroup.fasta
    log: per_gene/EOG091G0OWI/get_seqs.stdout.txt, per_gene/EOG091G0OWI/get_seqs.stderr.txt
    jobid: 2798
    wildcards: BUSCO=EOG091G0OWI
    threads: 2


	basedir=$(pwd)
        cd per_gene/EOG091G0OWI
        
        bash $basedir/../scripts/fetch_seqs.sh EOG091G0OWI /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ingroup.txt /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/outgroup.txt 1> ../../per_gene/EOG091G0OWI/get_seqs.stdout.txt 2> ../../per_gene/EOG091G0OWI/get_seqs.stderr.txt
	mv EOG091G0OWI.fasta $basedir/per_gene/EOG091G0OWI/EOG091G0OWI.ingroup.fasta
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/72476f9d9a5bd0627b4d721143a21354.simg
[Sun Jul  5 23:56:38 2020]
Finished job 562.
2613 of 3292 steps (79%) done

[Sun Jul  5 23:56:39 2020]
rule infer_single_ML:
    input: per_gene/EOG091G0A98/EOG091G0A98.best_model, per_gene/EOG091G0A98/ALICUT_EOG091G0A98.clustalo.fasta
    output: per_gene/EOG091G0A98/EOG091G0A98.raxml.done
    log: per_gene/EOG091G0A98/infer_single_ML.stdout.txt, per_gene/EOG091G0A98/infer_single_ML.stderr.txt
    jobid: 75
    wildcards: BUSCO=EOG091G0A98
    threads: 2


        cd per_gene/EOG091G0A98
	count=$(cat ../../per_gene/EOG091G0A98/ALICUT_EOG091G0A98.clustalo.fasta | grep ">" | wc -l)
	if [ "$count" -gt 5 ]
        then
		RAxMLmodel=$(cat ../../per_gene/EOG091G0A98/EOG091G0A98.best_model | grep "Best" | cut -d ":" -f 2 | tr -d '[:space:]')
                if [ "$(ls -1 | grep "^RAxML" | wc -l)" -ne 0 ]
		then
			rm RAxML*
		fi
        	raxml -f a -T 2 -m PROTGAMMA$RAxMLmodel         	-p 12345 -x 12345 -# 100         	-s ../../per_gene/EOG091G0A98/ALICUT_EOG091G0A98.clustalo.fasta -n EOG091G0A98.clustalo.aln.ALICUT.$RAxMLmodel 		1> ../../per_gene/EOG091G0A98/infer_single_ML.stdout.txt 2> ../../per_gene/EOG091G0A98/infer_single_ML.stderr.txt
	else
		echo "fasta file per_gene/EOG091G0A98/ALICUT_EOG091G0A98.clustalo.fasta contains fewer than 5 sequences - skipped" > ../../per_gene/EOG091G0A98/infer_single_ML.stdout.txt
		touch raxml.skipped
	fi
        touch ../../per_gene/EOG091G0A98/EOG091G0A98.raxml.done
        
[33mJob counts:
	count	jobs
	1	infer_single_ML
	1[0m
[33m
        cd per_gene/EOG091G0A98
	count=$(cat ../../per_gene/EOG091G0A98/ALICUT_EOG091G0A98.clustalo.fasta | grep ">" | wc -l)
	if [ "$count" -gt 5 ]
        then
		RAxMLmodel=$(cat ../../per_gene/EOG091G0A98/EOG091G0A98.best_model | grep "Best" | cut -d ":" -f 2 | tr -d '[:space:]')
                if [ "$(ls -1 | grep "^RAxML" | wc -l)" -ne 0 ]
		then
			rm RAxML*
		fi
        	raxml -f a -T 2 -m PROTGAMMA$RAxMLmodel         	-p 12345 -x 12345 -# 100         	-s ../../per_gene/EOG091G0A98/ALICUT_EOG091G0A98.clustalo.fasta -n EOG091G0A98.clustalo.aln.ALICUT.$RAxMLmodel 		1> ../../per_gene/EOG091G0A98/infer_single_ML.stdout.txt 2> ../../per_gene/EOG091G0A98/infer_single_ML.stderr.txt
	else
		echo "fasta file per_gene/EOG091G0A98/ALICUT_EOG091G0A98.clustalo.fasta contains fewer than 5 sequences - skipped" > ../../per_gene/EOG091G0A98/infer_single_ML.stdout.txt
		touch raxml.skipped
	fi
        touch ../../per_gene/EOG091G0A98/EOG091G0A98.raxml.done
        [0m
[Sun Jul  5 23:56:45 2020]
Finished job 837.
2614 of 3292 steps (79%) done

[Sun Jul  5 23:56:45 2020]
rule remove_empty:
    input: per_gene/EOG091G0XQ3/ALICUT_EOG091G0XQ3.clustalo.fasta
    output: per_gene/EOG091G0XQ3/empty_check.done
    jobid: 1659
    wildcards: BUSCO=EOG091G0XQ3


         if [ "$(cat per_gene/EOG091G0XQ3/ALICUT_EOG091G0XQ3.clustalo.fasta | grep -v ">" | sed 's/-//g' | grep "^$" | wc -l)" -gt 0 ]
         then
              cp per_gene/EOG091G0XQ3/ALICUT_EOG091G0XQ3.clustalo.fasta per_gene/EOG091G0XQ3/ALICUT_EOG091G0XQ3.clustalo.fasta.backup
              bash ../scripts/remove_empty.sh per_gene/EOG091G0XQ3/ALICUT_EOG091G0XQ3.clustalo.fasta.backup > per_gene/EOG091G0XQ3/ALICUT_EOG091G0XQ3.clustalo.fasta
         fi
         touch per_gene/EOG091G0XQ3/empty_check.done
         
[Sun Jul  5 23:56:46 2020]
Finished job 1659.
2615 of 3292 steps (79%) done

[Sun Jul  5 23:56:46 2020]
rule find_best_model:
    input: per_gene/EOG091G0XQ3/ALICUT_EOG091G0XQ3.clustalo.fasta, per_gene/EOG091G0XQ3/empty_check.done
    output: per_gene/EOG091G0XQ3/EOG091G0XQ3.best_model
    log: per_gene/EOG091G0XQ3/find_best_model.stderr.txt
    jobid: 836
    wildcards: BUSCO=EOG091G0XQ3
    threads: 2


        cd per_gene/EOG091G0XQ3
        if [ ! -d find_best_model ]
        then
            mkdir find_best_model
        fi
        cd find_best_model
        ln -s ../../../per_gene/EOG091G0XQ3/ALICUT_EOG091G0XQ3.clustalo.fasta EOG091G0XQ3.fasta
        ProteinModelSelection.pl EOG091G0XQ3.fasta 1> ../../../per_gene/EOG091G0XQ3/EOG091G0XQ3.best_model 2> ../../../per_gene/EOG091G0XQ3/find_best_model.stderr.txt
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/c0c09ee657b1e27f2c5687e0e9aa8d70.simg
[Sun Jul  5 23:56:49 2020]
Finished job 2798.
2616 of 3292 steps (79%) done

[Sun Jul  5 23:56:49 2020]
rule get_outgroups:
    input: per_gene/EOG091G0OWI/EOG091G0OWI.ingroup.fasta
    output: per_gene/EOG091G0OWI/EOG091G0OWI.orthodb.fasta, per_gene/EOG091G0OWI/EOG091G0OWI.outgroup.fasta
    log: per_gene/EOG091G0OWI/get_outgroups.stdout.txt, per_gene/EOG091G0OWI/get_outgroups.stderr.txt
    jobid: 2799
    wildcards: BUSCO=EOG091G0OWI


        #download fastas from Orhtodb for BUSCO id
        for i in {1..5}
        do
             wget "http://www.orthodb.org/fasta?query=EOG091G0OWI&level=33208" -O per_gene/EOG091G0OWI/EOG091G0OWI.orthodb.fasta 1> per_gene/EOG091G0OWI/get_outgroups.stdout.txt 2> per_gene/EOG091G0OWI/get_outgroups.stderr.txt && break || echo -e "try again ($i)" && sleep 15
        done

	#This is quick an dirty for now and just takes the first protein if there is more than one for an outgroup taxon
        bash ../scripts/download_outgroups.sh taxids.txt per_gene/EOG091G0OWI/EOG091G0OWI.orthodb.fasta > per_gene/EOG091G0OWI/EOG091G0OWI.outgroup.fasta
        
[Sun Jul  5 23:56:50 2020]
Finished job 2799.
2617 of 3292 steps (79%) done

[Sun Jul  5 23:56:50 2020]
rule join_groups:
    input: per_gene/EOG091G0OWI/EOG091G0OWI.ingroup.fasta, per_gene/EOG091G0OWI/EOG091G0OWI.outgroup.fasta
    output: per_gene/EOG091G0OWI/EOG091G0OWI.fasta
    jobid: 2223
    wildcards: BUSCO=EOG091G0OWI


        cat per_gene/EOG091G0OWI/EOG091G0OWI.ingroup.fasta per_gene/EOG091G0OWI/EOG091G0OWI.outgroup.fasta > per_gene/EOG091G0OWI/EOG091G0OWI.fasta
        
[Sun Jul  5 23:56:50 2020]
Finished job 2223.
2618 of 3292 steps (80%) done

[Sun Jul  5 23:56:50 2020]
rule MSA:
    input: per_gene/EOG091G0OWI/EOG091G0OWI.fasta
    output: per_gene/EOG091G0OWI/EOG091G0OWI.clustalo.fasta
    log: per_gene/EOG091G0OWI/MSA.stdout.txt, per_gene/EOG091G0OWI/MSA.stderr.txt
    jobid: 1566
    wildcards: BUSCO=EOG091G0OWI
    threads: 2


        clustalo -i per_gene/EOG091G0OWI/EOG091G0OWI.fasta -o per_gene/EOG091G0OWI/EOG091G0OWI.clustalo.fasta --threads=2 1> per_gene/EOG091G0OWI/MSA.stdout.txt 2> per_gene/EOG091G0OWI/MSA.stderr.txt
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/d68c9691725a7401923680874285c430.simg
[Sun Jul  5 23:56:51 2020]
Finished job 1566.
2619 of 3292 steps (80%) done

[Sun Jul  5 23:56:51 2020]
rule score_and_cut:
    input: per_gene/EOG091G0OWI/EOG091G0OWI.clustalo.fasta
    output: per_gene/EOG091G0OWI/ALICUT_EOG091G0OWI.clustalo.fasta
    jobid: 743
    wildcards: BUSCO=EOG091G0OWI
    threads: 2


        cd per_gene/EOG091G0OWI
        Aliscore.pl -N -r 200000000000000000 -i ../../per_gene/EOG091G0OWI/EOG091G0OWI.clustalo.fasta &> aliscore.log
        ALICUT.pl -s &> alicut.log
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/63c88c27a0fa300f57066b0ef65fefcb.simg
[Sun Jul  5 23:56:53 2020]
Finished job 1022.
2620 of 3292 steps (80%) done

[Sun Jul  5 23:56:53 2020]
rule infer_single_ML:
    input: per_gene/EOG091G08VB/EOG091G08VB.best_model, per_gene/EOG091G08VB/ALICUT_EOG091G08VB.clustalo.fasta
    output: per_gene/EOG091G08VB/EOG091G08VB.raxml.done
    log: per_gene/EOG091G08VB/infer_single_ML.stdout.txt, per_gene/EOG091G08VB/infer_single_ML.stderr.txt
    jobid: 305
    wildcards: BUSCO=EOG091G08VB
    threads: 2


        cd per_gene/EOG091G08VB
	count=$(cat ../../per_gene/EOG091G08VB/ALICUT_EOG091G08VB.clustalo.fasta | grep ">" | wc -l)
	if [ "$count" -gt 5 ]
        then
		RAxMLmodel=$(cat ../../per_gene/EOG091G08VB/EOG091G08VB.best_model | grep "Best" | cut -d ":" -f 2 | tr -d '[:space:]')
                if [ "$(ls -1 | grep "^RAxML" | wc -l)" -ne 0 ]
		then
			rm RAxML*
		fi
        	raxml -f a -T 2 -m PROTGAMMA$RAxMLmodel         	-p 12345 -x 12345 -# 100         	-s ../../per_gene/EOG091G08VB/ALICUT_EOG091G08VB.clustalo.fasta -n EOG091G08VB.clustalo.aln.ALICUT.$RAxMLmodel 		1> ../../per_gene/EOG091G08VB/infer_single_ML.stdout.txt 2> ../../per_gene/EOG091G08VB/infer_single_ML.stderr.txt
	else
		echo "fasta file per_gene/EOG091G08VB/ALICUT_EOG091G08VB.clustalo.fasta contains fewer than 5 sequences - skipped" > ../../per_gene/EOG091G08VB/infer_single_ML.stdout.txt
		touch raxml.skipped
	fi
        touch ../../per_gene/EOG091G08VB/EOG091G08VB.raxml.done
        
[33mJob counts:
	count	jobs
	1	infer_single_ML
	1[0m
[33m
        cd per_gene/EOG091G08VB
	count=$(cat ../../per_gene/EOG091G08VB/ALICUT_EOG091G08VB.clustalo.fasta | grep ">" | wc -l)
	if [ "$count" -gt 5 ]
        then
		RAxMLmodel=$(cat ../../per_gene/EOG091G08VB/EOG091G08VB.best_model | grep "Best" | cut -d ":" -f 2 | tr -d '[:space:]')
                if [ "$(ls -1 | grep "^RAxML" | wc -l)" -ne 0 ]
		then
			rm RAxML*
		fi
        	raxml -f a -T 2 -m PROTGAMMA$RAxMLmodel         	-p 12345 -x 12345 -# 100         	-s ../../per_gene/EOG091G08VB/ALICUT_EOG091G08VB.clustalo.fasta -n EOG091G08VB.clustalo.aln.ALICUT.$RAxMLmodel 		1> ../../per_gene/EOG091G08VB/infer_single_ML.stdout.txt 2> ../../per_gene/EOG091G08VB/infer_single_ML.stderr.txt
	else
		echo "fasta file per_gene/EOG091G08VB/ALICUT_EOG091G08VB.clustalo.fasta contains fewer than 5 sequences - skipped" > ../../per_gene/EOG091G08VB/infer_single_ML.stdout.txt
		touch raxml.skipped
	fi
        touch ../../per_gene/EOG091G08VB/EOG091G08VB.raxml.done
        [0m
[Sun Jul  5 23:57:01 2020]
Finished job 743.
2621 of 3292 steps (80%) done

[Sun Jul  5 23:57:01 2020]
rule remove_empty:
    input: per_gene/EOG091G0OWI/ALICUT_EOG091G0OWI.clustalo.fasta
    output: per_gene/EOG091G0OWI/empty_check.done
    jobid: 1565
    wildcards: BUSCO=EOG091G0OWI


         if [ "$(cat per_gene/EOG091G0OWI/ALICUT_EOG091G0OWI.clustalo.fasta | grep -v ">" | sed 's/-//g' | grep "^$" | wc -l)" -gt 0 ]
         then
              cp per_gene/EOG091G0OWI/ALICUT_EOG091G0OWI.clustalo.fasta per_gene/EOG091G0OWI/ALICUT_EOG091G0OWI.clustalo.fasta.backup
              bash ../scripts/remove_empty.sh per_gene/EOG091G0OWI/ALICUT_EOG091G0OWI.clustalo.fasta.backup > per_gene/EOG091G0OWI/ALICUT_EOG091G0OWI.clustalo.fasta
         fi
         touch per_gene/EOG091G0OWI/empty_check.done
         
[Sun Jul  5 23:57:01 2020]
Finished job 1565.
2622 of 3292 steps (80%) done

[Sun Jul  5 23:57:01 2020]
rule find_best_model:
    input: per_gene/EOG091G0OWI/ALICUT_EOG091G0OWI.clustalo.fasta, per_gene/EOG091G0OWI/empty_check.done
    output: per_gene/EOG091G0OWI/EOG091G0OWI.best_model
    log: per_gene/EOG091G0OWI/find_best_model.stderr.txt
    jobid: 742
    wildcards: BUSCO=EOG091G0OWI
    threads: 2


        cd per_gene/EOG091G0OWI
        if [ ! -d find_best_model ]
        then
            mkdir find_best_model
        fi
        cd find_best_model
        ln -s ../../../per_gene/EOG091G0OWI/ALICUT_EOG091G0OWI.clustalo.fasta EOG091G0OWI.fasta
        ProteinModelSelection.pl EOG091G0OWI.fasta 1> ../../../per_gene/EOG091G0OWI/EOG091G0OWI.best_model 2> ../../../per_gene/EOG091G0OWI/find_best_model.stderr.txt
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/c0c09ee657b1e27f2c5687e0e9aa8d70.simg
[Sun Jul  5 23:57:08 2020]
Finished job 836.
2623 of 3292 steps (80%) done

[Sun Jul  5 23:57:08 2020]
rule infer_single_ML:
    input: per_gene/EOG091G0XQ3/EOG091G0XQ3.best_model, per_gene/EOG091G0XQ3/ALICUT_EOG091G0XQ3.clustalo.fasta
    output: per_gene/EOG091G0XQ3/EOG091G0XQ3.raxml.done
    log: per_gene/EOG091G0XQ3/infer_single_ML.stdout.txt, per_gene/EOG091G0XQ3/infer_single_ML.stderr.txt
    jobid: 212
    wildcards: BUSCO=EOG091G0XQ3
    threads: 2


        cd per_gene/EOG091G0XQ3
	count=$(cat ../../per_gene/EOG091G0XQ3/ALICUT_EOG091G0XQ3.clustalo.fasta | grep ">" | wc -l)
	if [ "$count" -gt 5 ]
        then
		RAxMLmodel=$(cat ../../per_gene/EOG091G0XQ3/EOG091G0XQ3.best_model | grep "Best" | cut -d ":" -f 2 | tr -d '[:space:]')
                if [ "$(ls -1 | grep "^RAxML" | wc -l)" -ne 0 ]
		then
			rm RAxML*
		fi
        	raxml -f a -T 2 -m PROTGAMMA$RAxMLmodel         	-p 12345 -x 12345 -# 100         	-s ../../per_gene/EOG091G0XQ3/ALICUT_EOG091G0XQ3.clustalo.fasta -n EOG091G0XQ3.clustalo.aln.ALICUT.$RAxMLmodel 		1> ../../per_gene/EOG091G0XQ3/infer_single_ML.stdout.txt 2> ../../per_gene/EOG091G0XQ3/infer_single_ML.stderr.txt
	else
		echo "fasta file per_gene/EOG091G0XQ3/ALICUT_EOG091G0XQ3.clustalo.fasta contains fewer than 5 sequences - skipped" > ../../per_gene/EOG091G0XQ3/infer_single_ML.stdout.txt
		touch raxml.skipped
	fi
        touch ../../per_gene/EOG091G0XQ3/EOG091G0XQ3.raxml.done
        
[33mJob counts:
	count	jobs
	1	infer_single_ML
	1[0m
[33m
        cd per_gene/EOG091G0XQ3
	count=$(cat ../../per_gene/EOG091G0XQ3/ALICUT_EOG091G0XQ3.clustalo.fasta | grep ">" | wc -l)
	if [ "$count" -gt 5 ]
        then
		RAxMLmodel=$(cat ../../per_gene/EOG091G0XQ3/EOG091G0XQ3.best_model | grep "Best" | cut -d ":" -f 2 | tr -d '[:space:]')
                if [ "$(ls -1 | grep "^RAxML" | wc -l)" -ne 0 ]
		then
			rm RAxML*
		fi
        	raxml -f a -T 2 -m PROTGAMMA$RAxMLmodel         	-p 12345 -x 12345 -# 100         	-s ../../per_gene/EOG091G0XQ3/ALICUT_EOG091G0XQ3.clustalo.fasta -n EOG091G0XQ3.clustalo.aln.ALICUT.$RAxMLmodel 		1> ../../per_gene/EOG091G0XQ3/infer_single_ML.stdout.txt 2> ../../per_gene/EOG091G0XQ3/infer_single_ML.stderr.txt
	else
		echo "fasta file per_gene/EOG091G0XQ3/ALICUT_EOG091G0XQ3.clustalo.fasta contains fewer than 5 sequences - skipped" > ../../per_gene/EOG091G0XQ3/infer_single_ML.stdout.txt
		touch raxml.skipped
	fi
        touch ../../per_gene/EOG091G0XQ3/EOG091G0XQ3.raxml.done
        [0m
[Sun Jul  5 23:57:26 2020]
Finished job 312.
2624 of 3292 steps (80%) done

[Sun Jul  5 23:57:26 2020]
rule get_seqs:
    input: /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ingroup.txt, /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/outgroup.txt
    output: per_gene/EOG091G0MHM/EOG091G0MHM.ingroup.fasta
    log: per_gene/EOG091G0MHM/get_seqs.stdout.txt, per_gene/EOG091G0MHM/get_seqs.stderr.txt
    jobid: 3230
    wildcards: BUSCO=EOG091G0MHM
    threads: 2


	basedir=$(pwd)
        cd per_gene/EOG091G0MHM
        
        bash $basedir/../scripts/fetch_seqs.sh EOG091G0MHM /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ingroup.txt /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/outgroup.txt 1> ../../per_gene/EOG091G0MHM/get_seqs.stdout.txt 2> ../../per_gene/EOG091G0MHM/get_seqs.stderr.txt
	mv EOG091G0MHM.fasta $basedir/per_gene/EOG091G0MHM/EOG091G0MHM.ingroup.fasta
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/72476f9d9a5bd0627b4d721143a21354.simg
[Sun Jul  5 23:57:31 2020]
Finished job 742.
2625 of 3292 steps (80%) done

[Sun Jul  5 23:57:31 2020]
rule infer_single_ML:
    input: per_gene/EOG091G0OWI/EOG091G0OWI.best_model, per_gene/EOG091G0OWI/ALICUT_EOG091G0OWI.clustalo.fasta
    output: per_gene/EOG091G0OWI/EOG091G0OWI.raxml.done
    log: per_gene/EOG091G0OWI/infer_single_ML.stdout.txt, per_gene/EOG091G0OWI/infer_single_ML.stderr.txt
    jobid: 165
    wildcards: BUSCO=EOG091G0OWI
    threads: 2


        cd per_gene/EOG091G0OWI
	count=$(cat ../../per_gene/EOG091G0OWI/ALICUT_EOG091G0OWI.clustalo.fasta | grep ">" | wc -l)
	if [ "$count" -gt 5 ]
        then
		RAxMLmodel=$(cat ../../per_gene/EOG091G0OWI/EOG091G0OWI.best_model | grep "Best" | cut -d ":" -f 2 | tr -d '[:space:]')
                if [ "$(ls -1 | grep "^RAxML" | wc -l)" -ne 0 ]
		then
			rm RAxML*
		fi
        	raxml -f a -T 2 -m PROTGAMMA$RAxMLmodel         	-p 12345 -x 12345 -# 100         	-s ../../per_gene/EOG091G0OWI/ALICUT_EOG091G0OWI.clustalo.fasta -n EOG091G0OWI.clustalo.aln.ALICUT.$RAxMLmodel 		1> ../../per_gene/EOG091G0OWI/infer_single_ML.stdout.txt 2> ../../per_gene/EOG091G0OWI/infer_single_ML.stderr.txt
	else
		echo "fasta file per_gene/EOG091G0OWI/ALICUT_EOG091G0OWI.clustalo.fasta contains fewer than 5 sequences - skipped" > ../../per_gene/EOG091G0OWI/infer_single_ML.stdout.txt
		touch raxml.skipped
	fi
        touch ../../per_gene/EOG091G0OWI/EOG091G0OWI.raxml.done
        
[33mJob counts:
	count	jobs
	1	infer_single_ML
	1[0m
[33m
        cd per_gene/EOG091G0OWI
	count=$(cat ../../per_gene/EOG091G0OWI/ALICUT_EOG091G0OWI.clustalo.fasta | grep ">" | wc -l)
	if [ "$count" -gt 5 ]
        then
		RAxMLmodel=$(cat ../../per_gene/EOG091G0OWI/EOG091G0OWI.best_model | grep "Best" | cut -d ":" -f 2 | tr -d '[:space:]')
                if [ "$(ls -1 | grep "^RAxML" | wc -l)" -ne 0 ]
		then
			rm RAxML*
		fi
        	raxml -f a -T 2 -m PROTGAMMA$RAxMLmodel         	-p 12345 -x 12345 -# 100         	-s ../../per_gene/EOG091G0OWI/ALICUT_EOG091G0OWI.clustalo.fasta -n EOG091G0OWI.clustalo.aln.ALICUT.$RAxMLmodel 		1> ../../per_gene/EOG091G0OWI/infer_single_ML.stdout.txt 2> ../../per_gene/EOG091G0OWI/infer_single_ML.stderr.txt
	else
		echo "fasta file per_gene/EOG091G0OWI/ALICUT_EOG091G0OWI.clustalo.fasta contains fewer than 5 sequences - skipped" > ../../per_gene/EOG091G0OWI/infer_single_ML.stdout.txt
		touch raxml.skipped
	fi
        touch ../../per_gene/EOG091G0OWI/EOG091G0OWI.raxml.done
        [0m
[Sun Jul  5 23:57:35 2020]
Finished job 362.
2626 of 3292 steps (80%) done

[Sun Jul  5 23:57:35 2020]
rule get_seqs:
    input: /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ingroup.txt, /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/outgroup.txt
    output: per_gene/EOG091G06ON/EOG091G06ON.ingroup.fasta
    log: per_gene/EOG091G06ON/get_seqs.stdout.txt, per_gene/EOG091G06ON/get_seqs.stderr.txt
    jobid: 2560
    wildcards: BUSCO=EOG091G06ON
    threads: 2


	basedir=$(pwd)
        cd per_gene/EOG091G06ON
        
        bash $basedir/../scripts/fetch_seqs.sh EOG091G06ON /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ingroup.txt /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/outgroup.txt 1> ../../per_gene/EOG091G06ON/get_seqs.stdout.txt 2> ../../per_gene/EOG091G06ON/get_seqs.stderr.txt
	mv EOG091G06ON.fasta $basedir/per_gene/EOG091G06ON/EOG091G06ON.ingroup.fasta
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/72476f9d9a5bd0627b4d721143a21354.simg
[Sun Jul  5 23:57:39 2020]
Finished job 3230.
2627 of 3292 steps (80%) done

[Sun Jul  5 23:57:39 2020]
rule get_outgroups:
    input: per_gene/EOG091G0MHM/EOG091G0MHM.ingroup.fasta
    output: per_gene/EOG091G0MHM/EOG091G0MHM.orthodb.fasta, per_gene/EOG091G0MHM/EOG091G0MHM.outgroup.fasta
    log: per_gene/EOG091G0MHM/get_outgroups.stdout.txt, per_gene/EOG091G0MHM/get_outgroups.stderr.txt
    jobid: 3231
    wildcards: BUSCO=EOG091G0MHM


        #download fastas from Orhtodb for BUSCO id
        for i in {1..5}
        do
             wget "http://www.orthodb.org/fasta?query=EOG091G0MHM&level=33208" -O per_gene/EOG091G0MHM/EOG091G0MHM.orthodb.fasta 1> per_gene/EOG091G0MHM/get_outgroups.stdout.txt 2> per_gene/EOG091G0MHM/get_outgroups.stderr.txt && break || echo -e "try again ($i)" && sleep 15
        done

	#This is quick an dirty for now and just takes the first protein if there is more than one for an outgroup taxon
        bash ../scripts/download_outgroups.sh taxids.txt per_gene/EOG091G0MHM/EOG091G0MHM.orthodb.fasta > per_gene/EOG091G0MHM/EOG091G0MHM.outgroup.fasta
        
[Sun Jul  5 23:57:40 2020]
Finished job 3231.
2628 of 3292 steps (80%) done

[Sun Jul  5 23:57:40 2020]
rule join_groups:
    input: per_gene/EOG091G0MHM/EOG091G0MHM.ingroup.fasta, per_gene/EOG091G0MHM/EOG091G0MHM.outgroup.fasta
    output: per_gene/EOG091G0MHM/EOG091G0MHM.fasta
    jobid: 2439
    wildcards: BUSCO=EOG091G0MHM


        cat per_gene/EOG091G0MHM/EOG091G0MHM.ingroup.fasta per_gene/EOG091G0MHM/EOG091G0MHM.outgroup.fasta > per_gene/EOG091G0MHM/EOG091G0MHM.fasta
        
[Sun Jul  5 23:57:40 2020]
Finished job 2439.
2629 of 3292 steps (80%) done

[Sun Jul  5 23:57:40 2020]
rule MSA:
    input: per_gene/EOG091G0MHM/EOG091G0MHM.fasta
    output: per_gene/EOG091G0MHM/EOG091G0MHM.clustalo.fasta
    log: per_gene/EOG091G0MHM/MSA.stdout.txt, per_gene/EOG091G0MHM/MSA.stderr.txt
    jobid: 1998
    wildcards: BUSCO=EOG091G0MHM
    threads: 2


        clustalo -i per_gene/EOG091G0MHM/EOG091G0MHM.fasta -o per_gene/EOG091G0MHM/EOG091G0MHM.clustalo.fasta --threads=2 1> per_gene/EOG091G0MHM/MSA.stdout.txt 2> per_gene/EOG091G0MHM/MSA.stderr.txt
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/d68c9691725a7401923680874285c430.simg
[Sun Jul  5 23:57:41 2020]
Finished job 1998.
2630 of 3292 steps (80%) done

[Sun Jul  5 23:57:41 2020]
rule score_and_cut:
    input: per_gene/EOG091G0MHM/EOG091G0MHM.clustalo.fasta
    output: per_gene/EOG091G0MHM/ALICUT_EOG091G0MHM.clustalo.fasta
    jobid: 1175
    wildcards: BUSCO=EOG091G0MHM
    threads: 2


        cd per_gene/EOG091G0MHM
        Aliscore.pl -N -r 200000000000000000 -i ../../per_gene/EOG091G0MHM/EOG091G0MHM.clustalo.fasta &> aliscore.log
        ALICUT.pl -s &> alicut.log
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/63c88c27a0fa300f57066b0ef65fefcb.simg
[Sun Jul  5 23:57:49 2020]
Finished job 2560.
2631 of 3292 steps (80%) done

[Sun Jul  5 23:57:49 2020]
rule get_outgroups:
    input: per_gene/EOG091G06ON/EOG091G06ON.ingroup.fasta
    output: per_gene/EOG091G06ON/EOG091G06ON.orthodb.fasta, per_gene/EOG091G06ON/EOG091G06ON.outgroup.fasta
    log: per_gene/EOG091G06ON/get_outgroups.stdout.txt, per_gene/EOG091G06ON/get_outgroups.stderr.txt
    jobid: 2561
    wildcards: BUSCO=EOG091G06ON


        #download fastas from Orhtodb for BUSCO id
        for i in {1..5}
        do
             wget "http://www.orthodb.org/fasta?query=EOG091G06ON&level=33208" -O per_gene/EOG091G06ON/EOG091G06ON.orthodb.fasta 1> per_gene/EOG091G06ON/get_outgroups.stdout.txt 2> per_gene/EOG091G06ON/get_outgroups.stderr.txt && break || echo -e "try again ($i)" && sleep 15
        done

	#This is quick an dirty for now and just takes the first protein if there is more than one for an outgroup taxon
        bash ../scripts/download_outgroups.sh taxids.txt per_gene/EOG091G06ON/EOG091G06ON.orthodb.fasta > per_gene/EOG091G06ON/EOG091G06ON.outgroup.fasta
        
[Sun Jul  5 23:57:50 2020]
Finished job 2561.
2632 of 3292 steps (80%) done

[Sun Jul  5 23:57:50 2020]
rule join_groups:
    input: per_gene/EOG091G06ON/EOG091G06ON.ingroup.fasta, per_gene/EOG091G06ON/EOG091G06ON.outgroup.fasta
    output: per_gene/EOG091G06ON/EOG091G06ON.fasta
    jobid: 2104
    wildcards: BUSCO=EOG091G06ON


        cat per_gene/EOG091G06ON/EOG091G06ON.ingroup.fasta per_gene/EOG091G06ON/EOG091G06ON.outgroup.fasta > per_gene/EOG091G06ON/EOG091G06ON.fasta
        
[Sun Jul  5 23:57:50 2020]
Finished job 2104.
2633 of 3292 steps (80%) done

[Sun Jul  5 23:57:50 2020]
rule MSA:
    input: per_gene/EOG091G06ON/EOG091G06ON.fasta
    output: per_gene/EOG091G06ON/EOG091G06ON.clustalo.fasta
    log: per_gene/EOG091G06ON/MSA.stdout.txt, per_gene/EOG091G06ON/MSA.stderr.txt
    jobid: 1328
    wildcards: BUSCO=EOG091G06ON
    threads: 2


        clustalo -i per_gene/EOG091G06ON/EOG091G06ON.fasta -o per_gene/EOG091G06ON/EOG091G06ON.clustalo.fasta --threads=2 1> per_gene/EOG091G06ON/MSA.stdout.txt 2> per_gene/EOG091G06ON/MSA.stderr.txt
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/d68c9691725a7401923680874285c430.simg
[Sun Jul  5 23:57:51 2020]
Finished job 1175.
2634 of 3292 steps (80%) done

[Sun Jul  5 23:57:51 2020]
rule remove_empty:
    input: per_gene/EOG091G0MHM/ALICUT_EOG091G0MHM.clustalo.fasta
    output: per_gene/EOG091G0MHM/empty_check.done
    jobid: 1997
    wildcards: BUSCO=EOG091G0MHM


         if [ "$(cat per_gene/EOG091G0MHM/ALICUT_EOG091G0MHM.clustalo.fasta | grep -v ">" | sed 's/-//g' | grep "^$" | wc -l)" -gt 0 ]
         then
              cp per_gene/EOG091G0MHM/ALICUT_EOG091G0MHM.clustalo.fasta per_gene/EOG091G0MHM/ALICUT_EOG091G0MHM.clustalo.fasta.backup
              bash ../scripts/remove_empty.sh per_gene/EOG091G0MHM/ALICUT_EOG091G0MHM.clustalo.fasta.backup > per_gene/EOG091G0MHM/ALICUT_EOG091G0MHM.clustalo.fasta
         fi
         touch per_gene/EOG091G0MHM/empty_check.done
         
[Sun Jul  5 23:57:51 2020]
Finished job 1997.
2635 of 3292 steps (80%) done

[Sun Jul  5 23:57:51 2020]
rule find_best_model:
    input: per_gene/EOG091G0MHM/ALICUT_EOG091G0MHM.clustalo.fasta, per_gene/EOG091G0MHM/empty_check.done
    output: per_gene/EOG091G0MHM/EOG091G0MHM.best_model
    log: per_gene/EOG091G0MHM/find_best_model.stderr.txt
    jobid: 1174
    wildcards: BUSCO=EOG091G0MHM
    threads: 2


        cd per_gene/EOG091G0MHM
        if [ ! -d find_best_model ]
        then
            mkdir find_best_model
        fi
        cd find_best_model
        ln -s ../../../per_gene/EOG091G0MHM/ALICUT_EOG091G0MHM.clustalo.fasta EOG091G0MHM.fasta
        ProteinModelSelection.pl EOG091G0MHM.fasta 1> ../../../per_gene/EOG091G0MHM/EOG091G0MHM.best_model 2> ../../../per_gene/EOG091G0MHM/find_best_model.stderr.txt
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/c0c09ee657b1e27f2c5687e0e9aa8d70.simg
[Sun Jul  5 23:57:52 2020]
Finished job 1328.
2636 of 3292 steps (80%) done

[Sun Jul  5 23:57:52 2020]
rule score_and_cut:
    input: per_gene/EOG091G06ON/EOG091G06ON.clustalo.fasta
    output: per_gene/EOG091G06ON/ALICUT_EOG091G06ON.clustalo.fasta
    jobid: 505
    wildcards: BUSCO=EOG091G06ON
    threads: 2


        cd per_gene/EOG091G06ON
        Aliscore.pl -N -r 200000000000000000 -i ../../per_gene/EOG091G06ON/EOG091G06ON.clustalo.fasta &> aliscore.log
        ALICUT.pl -s &> alicut.log
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/63c88c27a0fa300f57066b0ef65fefcb.simg
[Sun Jul  5 23:58:02 2020]
Finished job 505.
2637 of 3292 steps (80%) done

[Sun Jul  5 23:58:02 2020]
rule remove_empty:
    input: per_gene/EOG091G06ON/ALICUT_EOG091G06ON.clustalo.fasta
    output: per_gene/EOG091G06ON/empty_check.done
    jobid: 1327
    wildcards: BUSCO=EOG091G06ON


         if [ "$(cat per_gene/EOG091G06ON/ALICUT_EOG091G06ON.clustalo.fasta | grep -v ">" | sed 's/-//g' | grep "^$" | wc -l)" -gt 0 ]
         then
              cp per_gene/EOG091G06ON/ALICUT_EOG091G06ON.clustalo.fasta per_gene/EOG091G06ON/ALICUT_EOG091G06ON.clustalo.fasta.backup
              bash ../scripts/remove_empty.sh per_gene/EOG091G06ON/ALICUT_EOG091G06ON.clustalo.fasta.backup > per_gene/EOG091G06ON/ALICUT_EOG091G06ON.clustalo.fasta
         fi
         touch per_gene/EOG091G06ON/empty_check.done
         
[Sun Jul  5 23:58:02 2020]
Finished job 1327.
2638 of 3292 steps (80%) done

[Sun Jul  5 23:58:02 2020]
rule find_best_model:
    input: per_gene/EOG091G06ON/ALICUT_EOG091G06ON.clustalo.fasta, per_gene/EOG091G06ON/empty_check.done
    output: per_gene/EOG091G06ON/EOG091G06ON.best_model
    log: per_gene/EOG091G06ON/find_best_model.stderr.txt
    jobid: 504
    wildcards: BUSCO=EOG091G06ON
    threads: 2


        cd per_gene/EOG091G06ON
        if [ ! -d find_best_model ]
        then
            mkdir find_best_model
        fi
        cd find_best_model
        ln -s ../../../per_gene/EOG091G06ON/ALICUT_EOG091G06ON.clustalo.fasta EOG091G06ON.fasta
        ProteinModelSelection.pl EOG091G06ON.fasta 1> ../../../per_gene/EOG091G06ON/EOG091G06ON.best_model 2> ../../../per_gene/EOG091G06ON/find_best_model.stderr.txt
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/c0c09ee657b1e27f2c5687e0e9aa8d70.simg
[Sun Jul  5 23:58:14 2020]
Finished job 1174.
2639 of 3292 steps (80%) done

[Sun Jul  5 23:58:14 2020]
rule infer_single_ML:
    input: per_gene/EOG091G0MHM/EOG091G0MHM.best_model, per_gene/EOG091G0MHM/ALICUT_EOG091G0MHM.clustalo.fasta
    output: per_gene/EOG091G0MHM/EOG091G0MHM.raxml.done
    log: per_gene/EOG091G0MHM/infer_single_ML.stdout.txt, per_gene/EOG091G0MHM/infer_single_ML.stderr.txt
    jobid: 381
    wildcards: BUSCO=EOG091G0MHM
    threads: 2


        cd per_gene/EOG091G0MHM
	count=$(cat ../../per_gene/EOG091G0MHM/ALICUT_EOG091G0MHM.clustalo.fasta | grep ">" | wc -l)
	if [ "$count" -gt 5 ]
        then
		RAxMLmodel=$(cat ../../per_gene/EOG091G0MHM/EOG091G0MHM.best_model | grep "Best" | cut -d ":" -f 2 | tr -d '[:space:]')
                if [ "$(ls -1 | grep "^RAxML" | wc -l)" -ne 0 ]
		then
			rm RAxML*
		fi
        	raxml -f a -T 2 -m PROTGAMMA$RAxMLmodel         	-p 12345 -x 12345 -# 100         	-s ../../per_gene/EOG091G0MHM/ALICUT_EOG091G0MHM.clustalo.fasta -n EOG091G0MHM.clustalo.aln.ALICUT.$RAxMLmodel 		1> ../../per_gene/EOG091G0MHM/infer_single_ML.stdout.txt 2> ../../per_gene/EOG091G0MHM/infer_single_ML.stderr.txt
	else
		echo "fasta file per_gene/EOG091G0MHM/ALICUT_EOG091G0MHM.clustalo.fasta contains fewer than 5 sequences - skipped" > ../../per_gene/EOG091G0MHM/infer_single_ML.stdout.txt
		touch raxml.skipped
	fi
        touch ../../per_gene/EOG091G0MHM/EOG091G0MHM.raxml.done
        
[33mJob counts:
	count	jobs
	1	infer_single_ML
	1[0m
[33m
        cd per_gene/EOG091G0MHM
	count=$(cat ../../per_gene/EOG091G0MHM/ALICUT_EOG091G0MHM.clustalo.fasta | grep ">" | wc -l)
	if [ "$count" -gt 5 ]
        then
		RAxMLmodel=$(cat ../../per_gene/EOG091G0MHM/EOG091G0MHM.best_model | grep "Best" | cut -d ":" -f 2 | tr -d '[:space:]')
                if [ "$(ls -1 | grep "^RAxML" | wc -l)" -ne 0 ]
		then
			rm RAxML*
		fi
        	raxml -f a -T 2 -m PROTGAMMA$RAxMLmodel         	-p 12345 -x 12345 -# 100         	-s ../../per_gene/EOG091G0MHM/ALICUT_EOG091G0MHM.clustalo.fasta -n EOG091G0MHM.clustalo.aln.ALICUT.$RAxMLmodel 		1> ../../per_gene/EOG091G0MHM/infer_single_ML.stdout.txt 2> ../../per_gene/EOG091G0MHM/infer_single_ML.stderr.txt
	else
		echo "fasta file per_gene/EOG091G0MHM/ALICUT_EOG091G0MHM.clustalo.fasta contains fewer than 5 sequences - skipped" > ../../per_gene/EOG091G0MHM/infer_single_ML.stdout.txt
		touch raxml.skipped
	fi
        touch ../../per_gene/EOG091G0MHM/EOG091G0MHM.raxml.done
        [0m
[Sun Jul  5 23:58:32 2020]
Finished job 334.
2640 of 3292 steps (80%) done

[Sun Jul  5 23:58:32 2020]
rule get_seqs:
    input: /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ingroup.txt, /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/outgroup.txt
    output: per_gene/EOG091G08LT/EOG091G08LT.ingroup.fasta
    log: per_gene/EOG091G08LT/get_seqs.stdout.txt, per_gene/EOG091G08LT/get_seqs.stderr.txt
    jobid: 2592
    wildcards: BUSCO=EOG091G08LT
    threads: 2


	basedir=$(pwd)
        cd per_gene/EOG091G08LT
        
        bash $basedir/../scripts/fetch_seqs.sh EOG091G08LT /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ingroup.txt /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/outgroup.txt 1> ../../per_gene/EOG091G08LT/get_seqs.stdout.txt 2> ../../per_gene/EOG091G08LT/get_seqs.stderr.txt
	mv EOG091G08LT.fasta $basedir/per_gene/EOG091G08LT/EOG091G08LT.ingroup.fasta
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/72476f9d9a5bd0627b4d721143a21354.simg
[Sun Jul  5 23:58:37 2020]
Finished job 504.
2641 of 3292 steps (80%) done

[Sun Jul  5 23:58:37 2020]
rule infer_single_ML:
    input: per_gene/EOG091G06ON/EOG091G06ON.best_model, per_gene/EOG091G06ON/ALICUT_EOG091G06ON.clustalo.fasta
    output: per_gene/EOG091G06ON/EOG091G06ON.raxml.done
    log: per_gene/EOG091G06ON/infer_single_ML.stdout.txt, per_gene/EOG091G06ON/infer_single_ML.stderr.txt
    jobid: 46
    wildcards: BUSCO=EOG091G06ON
    threads: 2


        cd per_gene/EOG091G06ON
	count=$(cat ../../per_gene/EOG091G06ON/ALICUT_EOG091G06ON.clustalo.fasta | grep ">" | wc -l)
	if [ "$count" -gt 5 ]
        then
		RAxMLmodel=$(cat ../../per_gene/EOG091G06ON/EOG091G06ON.best_model | grep "Best" | cut -d ":" -f 2 | tr -d '[:space:]')
                if [ "$(ls -1 | grep "^RAxML" | wc -l)" -ne 0 ]
		then
			rm RAxML*
		fi
        	raxml -f a -T 2 -m PROTGAMMA$RAxMLmodel         	-p 12345 -x 12345 -# 100         	-s ../../per_gene/EOG091G06ON/ALICUT_EOG091G06ON.clustalo.fasta -n EOG091G06ON.clustalo.aln.ALICUT.$RAxMLmodel 		1> ../../per_gene/EOG091G06ON/infer_single_ML.stdout.txt 2> ../../per_gene/EOG091G06ON/infer_single_ML.stderr.txt
	else
		echo "fasta file per_gene/EOG091G06ON/ALICUT_EOG091G06ON.clustalo.fasta contains fewer than 5 sequences - skipped" > ../../per_gene/EOG091G06ON/infer_single_ML.stdout.txt
		touch raxml.skipped
	fi
        touch ../../per_gene/EOG091G06ON/EOG091G06ON.raxml.done
        
[33mJob counts:
	count	jobs
	1	infer_single_ML
	1[0m
[33m
        cd per_gene/EOG091G06ON
	count=$(cat ../../per_gene/EOG091G06ON/ALICUT_EOG091G06ON.clustalo.fasta | grep ">" | wc -l)
	if [ "$count" -gt 5 ]
        then
		RAxMLmodel=$(cat ../../per_gene/EOG091G06ON/EOG091G06ON.best_model | grep "Best" | cut -d ":" -f 2 | tr -d '[:space:]')
                if [ "$(ls -1 | grep "^RAxML" | wc -l)" -ne 0 ]
		then
			rm RAxML*
		fi
        	raxml -f a -T 2 -m PROTGAMMA$RAxMLmodel         	-p 12345 -x 12345 -# 100         	-s ../../per_gene/EOG091G06ON/ALICUT_EOG091G06ON.clustalo.fasta -n EOG091G06ON.clustalo.aln.ALICUT.$RAxMLmodel 		1> ../../per_gene/EOG091G06ON/infer_single_ML.stdout.txt 2> ../../per_gene/EOG091G06ON/infer_single_ML.stderr.txt
	else
		echo "fasta file per_gene/EOG091G06ON/ALICUT_EOG091G06ON.clustalo.fasta contains fewer than 5 sequences - skipped" > ../../per_gene/EOG091G06ON/infer_single_ML.stdout.txt
		touch raxml.skipped
	fi
        touch ../../per_gene/EOG091G06ON/EOG091G06ON.raxml.done
        [0m
[Sun Jul  5 23:58:44 2020]
Finished job 2592.
2642 of 3292 steps (80%) done

[Sun Jul  5 23:58:44 2020]
rule get_outgroups:
    input: per_gene/EOG091G08LT/EOG091G08LT.ingroup.fasta
    output: per_gene/EOG091G08LT/EOG091G08LT.orthodb.fasta, per_gene/EOG091G08LT/EOG091G08LT.outgroup.fasta
    log: per_gene/EOG091G08LT/get_outgroups.stdout.txt, per_gene/EOG091G08LT/get_outgroups.stderr.txt
    jobid: 2593
    wildcards: BUSCO=EOG091G08LT


        #download fastas from Orhtodb for BUSCO id
        for i in {1..5}
        do
             wget "http://www.orthodb.org/fasta?query=EOG091G08LT&level=33208" -O per_gene/EOG091G08LT/EOG091G08LT.orthodb.fasta 1> per_gene/EOG091G08LT/get_outgroups.stdout.txt 2> per_gene/EOG091G08LT/get_outgroups.stderr.txt && break || echo -e "try again ($i)" && sleep 15
        done

	#This is quick an dirty for now and just takes the first protein if there is more than one for an outgroup taxon
        bash ../scripts/download_outgroups.sh taxids.txt per_gene/EOG091G08LT/EOG091G08LT.orthodb.fasta > per_gene/EOG091G08LT/EOG091G08LT.outgroup.fasta
        
[Sun Jul  5 23:58:45 2020]
Finished job 2593.
2643 of 3292 steps (80%) done

[Sun Jul  5 23:58:45 2020]
rule join_groups:
    input: per_gene/EOG091G08LT/EOG091G08LT.ingroup.fasta, per_gene/EOG091G08LT/EOG091G08LT.outgroup.fasta
    output: per_gene/EOG091G08LT/EOG091G08LT.fasta
    jobid: 2120
    wildcards: BUSCO=EOG091G08LT


        cat per_gene/EOG091G08LT/EOG091G08LT.ingroup.fasta per_gene/EOG091G08LT/EOG091G08LT.outgroup.fasta > per_gene/EOG091G08LT/EOG091G08LT.fasta
        
[Sun Jul  5 23:58:45 2020]
Finished job 2120.
2644 of 3292 steps (80%) done

[Sun Jul  5 23:58:45 2020]
rule MSA:
    input: per_gene/EOG091G08LT/EOG091G08LT.fasta
    output: per_gene/EOG091G08LT/EOG091G08LT.clustalo.fasta
    log: per_gene/EOG091G08LT/MSA.stdout.txt, per_gene/EOG091G08LT/MSA.stderr.txt
    jobid: 1360
    wildcards: BUSCO=EOG091G08LT
    threads: 2


        clustalo -i per_gene/EOG091G08LT/EOG091G08LT.fasta -o per_gene/EOG091G08LT/EOG091G08LT.clustalo.fasta --threads=2 1> per_gene/EOG091G08LT/MSA.stdout.txt 2> per_gene/EOG091G08LT/MSA.stderr.txt
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/d68c9691725a7401923680874285c430.simg
[Sun Jul  5 23:58:48 2020]
Finished job 1360.
2645 of 3292 steps (80%) done

[Sun Jul  5 23:58:48 2020]
rule score_and_cut:
    input: per_gene/EOG091G08LT/EOG091G08LT.clustalo.fasta
    output: per_gene/EOG091G08LT/ALICUT_EOG091G08LT.clustalo.fasta
    jobid: 537
    wildcards: BUSCO=EOG091G08LT
    threads: 2


        cd per_gene/EOG091G08LT
        Aliscore.pl -N -r 200000000000000000 -i ../../per_gene/EOG091G08LT/EOG091G08LT.clustalo.fasta &> aliscore.log
        ALICUT.pl -s &> alicut.log
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/63c88c27a0fa300f57066b0ef65fefcb.simg
[Sun Jul  5 23:58:58 2020]
Finished job 537.
2646 of 3292 steps (80%) done

[Sun Jul  5 23:58:58 2020]
rule remove_empty:
    input: per_gene/EOG091G08LT/ALICUT_EOG091G08LT.clustalo.fasta
    output: per_gene/EOG091G08LT/empty_check.done
    jobid: 1359
    wildcards: BUSCO=EOG091G08LT


         if [ "$(cat per_gene/EOG091G08LT/ALICUT_EOG091G08LT.clustalo.fasta | grep -v ">" | sed 's/-//g' | grep "^$" | wc -l)" -gt 0 ]
         then
              cp per_gene/EOG091G08LT/ALICUT_EOG091G08LT.clustalo.fasta per_gene/EOG091G08LT/ALICUT_EOG091G08LT.clustalo.fasta.backup
              bash ../scripts/remove_empty.sh per_gene/EOG091G08LT/ALICUT_EOG091G08LT.clustalo.fasta.backup > per_gene/EOG091G08LT/ALICUT_EOG091G08LT.clustalo.fasta
         fi
         touch per_gene/EOG091G08LT/empty_check.done
         
[Sun Jul  5 23:58:58 2020]
Finished job 1359.
2647 of 3292 steps (80%) done

[Sun Jul  5 23:58:58 2020]
rule find_best_model:
    input: per_gene/EOG091G08LT/ALICUT_EOG091G08LT.clustalo.fasta, per_gene/EOG091G08LT/empty_check.done
    output: per_gene/EOG091G08LT/EOG091G08LT.best_model
    log: per_gene/EOG091G08LT/find_best_model.stderr.txt
    jobid: 536
    wildcards: BUSCO=EOG091G08LT
    threads: 2


        cd per_gene/EOG091G08LT
        if [ ! -d find_best_model ]
        then
            mkdir find_best_model
        fi
        cd find_best_model
        ln -s ../../../per_gene/EOG091G08LT/ALICUT_EOG091G08LT.clustalo.fasta EOG091G08LT.fasta
        ProteinModelSelection.pl EOG091G08LT.fasta 1> ../../../per_gene/EOG091G08LT/EOG091G08LT.best_model 2> ../../../per_gene/EOG091G08LT/find_best_model.stderr.txt
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/c0c09ee657b1e27f2c5687e0e9aa8d70.simg
[Sun Jul  5 23:59:24 2020]
Finished job 536.
2648 of 3292 steps (80%) done

[Sun Jul  5 23:59:24 2020]
rule infer_single_ML:
    input: per_gene/EOG091G08LT/EOG091G08LT.best_model, per_gene/EOG091G08LT/ALICUT_EOG091G08LT.clustalo.fasta
    output: per_gene/EOG091G08LT/EOG091G08LT.raxml.done
    log: per_gene/EOG091G08LT/infer_single_ML.stdout.txt, per_gene/EOG091G08LT/infer_single_ML.stderr.txt
    jobid: 62
    wildcards: BUSCO=EOG091G08LT
    threads: 2


        cd per_gene/EOG091G08LT
	count=$(cat ../../per_gene/EOG091G08LT/ALICUT_EOG091G08LT.clustalo.fasta | grep ">" | wc -l)
	if [ "$count" -gt 5 ]
        then
		RAxMLmodel=$(cat ../../per_gene/EOG091G08LT/EOG091G08LT.best_model | grep "Best" | cut -d ":" -f 2 | tr -d '[:space:]')
                if [ "$(ls -1 | grep "^RAxML" | wc -l)" -ne 0 ]
		then
			rm RAxML*
		fi
        	raxml -f a -T 2 -m PROTGAMMA$RAxMLmodel         	-p 12345 -x 12345 -# 100         	-s ../../per_gene/EOG091G08LT/ALICUT_EOG091G08LT.clustalo.fasta -n EOG091G08LT.clustalo.aln.ALICUT.$RAxMLmodel 		1> ../../per_gene/EOG091G08LT/infer_single_ML.stdout.txt 2> ../../per_gene/EOG091G08LT/infer_single_ML.stderr.txt
	else
		echo "fasta file per_gene/EOG091G08LT/ALICUT_EOG091G08LT.clustalo.fasta contains fewer than 5 sequences - skipped" > ../../per_gene/EOG091G08LT/infer_single_ML.stdout.txt
		touch raxml.skipped
	fi
        touch ../../per_gene/EOG091G08LT/EOG091G08LT.raxml.done
        
[33mJob counts:
	count	jobs
	1	infer_single_ML
	1[0m
[33m
        cd per_gene/EOG091G08LT
	count=$(cat ../../per_gene/EOG091G08LT/ALICUT_EOG091G08LT.clustalo.fasta | grep ">" | wc -l)
	if [ "$count" -gt 5 ]
        then
		RAxMLmodel=$(cat ../../per_gene/EOG091G08LT/EOG091G08LT.best_model | grep "Best" | cut -d ":" -f 2 | tr -d '[:space:]')
                if [ "$(ls -1 | grep "^RAxML" | wc -l)" -ne 0 ]
		then
			rm RAxML*
		fi
        	raxml -f a -T 2 -m PROTGAMMA$RAxMLmodel         	-p 12345 -x 12345 -# 100         	-s ../../per_gene/EOG091G08LT/ALICUT_EOG091G08LT.clustalo.fasta -n EOG091G08LT.clustalo.aln.ALICUT.$RAxMLmodel 		1> ../../per_gene/EOG091G08LT/infer_single_ML.stdout.txt 2> ../../per_gene/EOG091G08LT/infer_single_ML.stderr.txt
	else
		echo "fasta file per_gene/EOG091G08LT/ALICUT_EOG091G08LT.clustalo.fasta contains fewer than 5 sequences - skipped" > ../../per_gene/EOG091G08LT/infer_single_ML.stdout.txt
		touch raxml.skipped
	fi
        touch ../../per_gene/EOG091G08LT/EOG091G08LT.raxml.done
        [0m
[Sun Jul  5 23:59:48 2020]
Finished job 132.
2649 of 3292 steps (80%) done

[Sun Jul  5 23:59:48 2020]
rule get_seqs:
    input: /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ingroup.txt, /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/outgroup.txt
    output: per_gene/EOG091G057L/EOG091G057L.ingroup.fasta
    log: per_gene/EOG091G057L/get_seqs.stdout.txt, per_gene/EOG091G057L/get_seqs.stderr.txt
    jobid: 2530
    wildcards: BUSCO=EOG091G057L
    threads: 2


	basedir=$(pwd)
        cd per_gene/EOG091G057L
        
        bash $basedir/../scripts/fetch_seqs.sh EOG091G057L /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ingroup.txt /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/outgroup.txt 1> ../../per_gene/EOG091G057L/get_seqs.stdout.txt 2> ../../per_gene/EOG091G057L/get_seqs.stderr.txt
	mv EOG091G057L.fasta $basedir/per_gene/EOG091G057L/EOG091G057L.ingroup.fasta
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/72476f9d9a5bd0627b4d721143a21354.simg
[Mon Jul  6 00:00:02 2020]
Finished job 2530.
2650 of 3292 steps (80%) done

[Mon Jul  6 00:00:02 2020]
rule get_outgroups:
    input: per_gene/EOG091G057L/EOG091G057L.ingroup.fasta
    output: per_gene/EOG091G057L/EOG091G057L.orthodb.fasta, per_gene/EOG091G057L/EOG091G057L.outgroup.fasta
    log: per_gene/EOG091G057L/get_outgroups.stdout.txt, per_gene/EOG091G057L/get_outgroups.stderr.txt
    jobid: 2531
    wildcards: BUSCO=EOG091G057L


        #download fastas from Orhtodb for BUSCO id
        for i in {1..5}
        do
             wget "http://www.orthodb.org/fasta?query=EOG091G057L&level=33208" -O per_gene/EOG091G057L/EOG091G057L.orthodb.fasta 1> per_gene/EOG091G057L/get_outgroups.stdout.txt 2> per_gene/EOG091G057L/get_outgroups.stderr.txt && break || echo -e "try again ($i)" && sleep 15
        done

	#This is quick an dirty for now and just takes the first protein if there is more than one for an outgroup taxon
        bash ../scripts/download_outgroups.sh taxids.txt per_gene/EOG091G057L/EOG091G057L.orthodb.fasta > per_gene/EOG091G057L/EOG091G057L.outgroup.fasta
        
[Mon Jul  6 00:00:03 2020]
Finished job 2531.
2651 of 3292 steps (81%) done

[Mon Jul  6 00:00:03 2020]
rule join_groups:
    input: per_gene/EOG091G057L/EOG091G057L.ingroup.fasta, per_gene/EOG091G057L/EOG091G057L.outgroup.fasta
    output: per_gene/EOG091G057L/EOG091G057L.fasta
    jobid: 2089
    wildcards: BUSCO=EOG091G057L


        cat per_gene/EOG091G057L/EOG091G057L.ingroup.fasta per_gene/EOG091G057L/EOG091G057L.outgroup.fasta > per_gene/EOG091G057L/EOG091G057L.fasta
        
[Mon Jul  6 00:00:03 2020]
Finished job 2089.
2652 of 3292 steps (81%) done

[Mon Jul  6 00:00:03 2020]
rule MSA:
    input: per_gene/EOG091G057L/EOG091G057L.fasta
    output: per_gene/EOG091G057L/EOG091G057L.clustalo.fasta
    log: per_gene/EOG091G057L/MSA.stdout.txt, per_gene/EOG091G057L/MSA.stderr.txt
    jobid: 1298
    wildcards: BUSCO=EOG091G057L
    threads: 2


        clustalo -i per_gene/EOG091G057L/EOG091G057L.fasta -o per_gene/EOG091G057L/EOG091G057L.clustalo.fasta --threads=2 1> per_gene/EOG091G057L/MSA.stdout.txt 2> per_gene/EOG091G057L/MSA.stderr.txt
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/d68c9691725a7401923680874285c430.simg
[Mon Jul  6 00:00:08 2020]
Finished job 1298.
2653 of 3292 steps (81%) done

[Mon Jul  6 00:00:08 2020]
rule score_and_cut:
    input: per_gene/EOG091G057L/EOG091G057L.clustalo.fasta
    output: per_gene/EOG091G057L/ALICUT_EOG091G057L.clustalo.fasta
    jobid: 475
    wildcards: BUSCO=EOG091G057L
    threads: 2


        cd per_gene/EOG091G057L
        Aliscore.pl -N -r 200000000000000000 -i ../../per_gene/EOG091G057L/EOG091G057L.clustalo.fasta &> aliscore.log
        ALICUT.pl -s &> alicut.log
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/63c88c27a0fa300f57066b0ef65fefcb.simg
[Mon Jul  6 00:00:20 2020]
Finished job 475.
2654 of 3292 steps (81%) done

[Mon Jul  6 00:00:20 2020]
rule remove_empty:
    input: per_gene/EOG091G057L/ALICUT_EOG091G057L.clustalo.fasta
    output: per_gene/EOG091G057L/empty_check.done
    jobid: 1297
    wildcards: BUSCO=EOG091G057L


         if [ "$(cat per_gene/EOG091G057L/ALICUT_EOG091G057L.clustalo.fasta | grep -v ">" | sed 's/-//g' | grep "^$" | wc -l)" -gt 0 ]
         then
              cp per_gene/EOG091G057L/ALICUT_EOG091G057L.clustalo.fasta per_gene/EOG091G057L/ALICUT_EOG091G057L.clustalo.fasta.backup
              bash ../scripts/remove_empty.sh per_gene/EOG091G057L/ALICUT_EOG091G057L.clustalo.fasta.backup > per_gene/EOG091G057L/ALICUT_EOG091G057L.clustalo.fasta
         fi
         touch per_gene/EOG091G057L/empty_check.done
         
[Mon Jul  6 00:00:20 2020]
Finished job 1297.
2655 of 3292 steps (81%) done

[Mon Jul  6 00:00:20 2020]
rule find_best_model:
    input: per_gene/EOG091G057L/ALICUT_EOG091G057L.clustalo.fasta, per_gene/EOG091G057L/empty_check.done
    output: per_gene/EOG091G057L/EOG091G057L.best_model
    log: per_gene/EOG091G057L/find_best_model.stderr.txt
    jobid: 474
    wildcards: BUSCO=EOG091G057L
    threads: 2


        cd per_gene/EOG091G057L
        if [ ! -d find_best_model ]
        then
            mkdir find_best_model
        fi
        cd find_best_model
        ln -s ../../../per_gene/EOG091G057L/ALICUT_EOG091G057L.clustalo.fasta EOG091G057L.fasta
        ProteinModelSelection.pl EOG091G057L.fasta 1> ../../../per_gene/EOG091G057L/EOG091G057L.best_model 2> ../../../per_gene/EOG091G057L/find_best_model.stderr.txt
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/c0c09ee657b1e27f2c5687e0e9aa8d70.simg
[Mon Jul  6 00:00:22 2020]
Finished job 212.
2656 of 3292 steps (81%) done

[Mon Jul  6 00:00:22 2020]
rule get_seqs:
    input: /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ingroup.txt, /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/outgroup.txt
    output: per_gene/EOG091G0321/EOG091G0321.ingroup.fasta
    log: per_gene/EOG091G0321/get_seqs.stdout.txt, per_gene/EOG091G0321/get_seqs.stderr.txt
    jobid: 2502
    wildcards: BUSCO=EOG091G0321
    threads: 2


	basedir=$(pwd)
        cd per_gene/EOG091G0321
        
        bash $basedir/../scripts/fetch_seqs.sh EOG091G0321 /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ingroup.txt /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/outgroup.txt 1> ../../per_gene/EOG091G0321/get_seqs.stdout.txt 2> ../../per_gene/EOG091G0321/get_seqs.stderr.txt
	mv EOG091G0321.fasta $basedir/per_gene/EOG091G0321/EOG091G0321.ingroup.fasta
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/72476f9d9a5bd0627b4d721143a21354.simg
[Mon Jul  6 00:00:30 2020]
Finished job 342.
2657 of 3292 steps (81%) done

[Mon Jul  6 00:00:30 2020]
rule get_seqs:
    input: /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ingroup.txt, /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/outgroup.txt
    output: per_gene/EOG091G0TWR/EOG091G0TWR.ingroup.fasta
    log: per_gene/EOG091G0TWR/get_seqs.stdout.txt, per_gene/EOG091G0TWR/get_seqs.stderr.txt
    jobid: 2860
    wildcards: BUSCO=EOG091G0TWR
    threads: 2


	basedir=$(pwd)
        cd per_gene/EOG091G0TWR
        
        bash $basedir/../scripts/fetch_seqs.sh EOG091G0TWR /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ingroup.txt /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/outgroup.txt 1> ../../per_gene/EOG091G0TWR/get_seqs.stdout.txt 2> ../../per_gene/EOG091G0TWR/get_seqs.stderr.txt
	mv EOG091G0TWR.fasta $basedir/per_gene/EOG091G0TWR/EOG091G0TWR.ingroup.fasta
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/72476f9d9a5bd0627b4d721143a21354.simg
[Mon Jul  6 00:00:35 2020]
Finished job 2502.
2658 of 3292 steps (81%) done

[Mon Jul  6 00:00:35 2020]
rule get_outgroups:
    input: per_gene/EOG091G0321/EOG091G0321.ingroup.fasta
    output: per_gene/EOG091G0321/EOG091G0321.orthodb.fasta, per_gene/EOG091G0321/EOG091G0321.outgroup.fasta
    log: per_gene/EOG091G0321/get_outgroups.stdout.txt, per_gene/EOG091G0321/get_outgroups.stderr.txt
    jobid: 2503
    wildcards: BUSCO=EOG091G0321


        #download fastas from Orhtodb for BUSCO id
        for i in {1..5}
        do
             wget "http://www.orthodb.org/fasta?query=EOG091G0321&level=33208" -O per_gene/EOG091G0321/EOG091G0321.orthodb.fasta 1> per_gene/EOG091G0321/get_outgroups.stdout.txt 2> per_gene/EOG091G0321/get_outgroups.stderr.txt && break || echo -e "try again ($i)" && sleep 15
        done

	#This is quick an dirty for now and just takes the first protein if there is more than one for an outgroup taxon
        bash ../scripts/download_outgroups.sh taxids.txt per_gene/EOG091G0321/EOG091G0321.orthodb.fasta > per_gene/EOG091G0321/EOG091G0321.outgroup.fasta
        
[Mon Jul  6 00:00:36 2020]
Finished job 2503.
2659 of 3292 steps (81%) done

[Mon Jul  6 00:00:36 2020]
rule join_groups:
    input: per_gene/EOG091G0321/EOG091G0321.ingroup.fasta, per_gene/EOG091G0321/EOG091G0321.outgroup.fasta
    output: per_gene/EOG091G0321/EOG091G0321.fasta
    jobid: 2075
    wildcards: BUSCO=EOG091G0321


        cat per_gene/EOG091G0321/EOG091G0321.ingroup.fasta per_gene/EOG091G0321/EOG091G0321.outgroup.fasta > per_gene/EOG091G0321/EOG091G0321.fasta
        
[Mon Jul  6 00:00:36 2020]
Finished job 2075.
2660 of 3292 steps (81%) done

[Mon Jul  6 00:00:36 2020]
rule MSA:
    input: per_gene/EOG091G0321/EOG091G0321.fasta
    output: per_gene/EOG091G0321/EOG091G0321.clustalo.fasta
    log: per_gene/EOG091G0321/MSA.stdout.txt, per_gene/EOG091G0321/MSA.stderr.txt
    jobid: 1270
    wildcards: BUSCO=EOG091G0321
    threads: 2


        clustalo -i per_gene/EOG091G0321/EOG091G0321.fasta -o per_gene/EOG091G0321/EOG091G0321.clustalo.fasta --threads=2 1> per_gene/EOG091G0321/MSA.stdout.txt 2> per_gene/EOG091G0321/MSA.stderr.txt
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/d68c9691725a7401923680874285c430.simg
[Mon Jul  6 00:00:38 2020]
Finished job 1270.
2661 of 3292 steps (81%) done

[Mon Jul  6 00:00:38 2020]
rule score_and_cut:
    input: per_gene/EOG091G0321/EOG091G0321.clustalo.fasta
    output: per_gene/EOG091G0321/ALICUT_EOG091G0321.clustalo.fasta
    jobid: 447
    wildcards: BUSCO=EOG091G0321
    threads: 2


        cd per_gene/EOG091G0321
        Aliscore.pl -N -r 200000000000000000 -i ../../per_gene/EOG091G0321/EOG091G0321.clustalo.fasta &> aliscore.log
        ALICUT.pl -s &> alicut.log
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/63c88c27a0fa300f57066b0ef65fefcb.simg
[Mon Jul  6 00:00:45 2020]
Finished job 2860.
2662 of 3292 steps (81%) done

[Mon Jul  6 00:00:45 2020]
rule get_outgroups:
    input: per_gene/EOG091G0TWR/EOG091G0TWR.ingroup.fasta
    output: per_gene/EOG091G0TWR/EOG091G0TWR.orthodb.fasta, per_gene/EOG091G0TWR/EOG091G0TWR.outgroup.fasta
    log: per_gene/EOG091G0TWR/get_outgroups.stdout.txt, per_gene/EOG091G0TWR/get_outgroups.stderr.txt
    jobid: 2861
    wildcards: BUSCO=EOG091G0TWR


        #download fastas from Orhtodb for BUSCO id
        for i in {1..5}
        do
             wget "http://www.orthodb.org/fasta?query=EOG091G0TWR&level=33208" -O per_gene/EOG091G0TWR/EOG091G0TWR.orthodb.fasta 1> per_gene/EOG091G0TWR/get_outgroups.stdout.txt 2> per_gene/EOG091G0TWR/get_outgroups.stderr.txt && break || echo -e "try again ($i)" && sleep 15
        done

	#This is quick an dirty for now and just takes the first protein if there is more than one for an outgroup taxon
        bash ../scripts/download_outgroups.sh taxids.txt per_gene/EOG091G0TWR/EOG091G0TWR.orthodb.fasta > per_gene/EOG091G0TWR/EOG091G0TWR.outgroup.fasta
        
[Mon Jul  6 00:00:45 2020]
Finished job 2861.
2663 of 3292 steps (81%) done

[Mon Jul  6 00:00:45 2020]
rule join_groups:
    input: per_gene/EOG091G0TWR/EOG091G0TWR.ingroup.fasta, per_gene/EOG091G0TWR/EOG091G0TWR.outgroup.fasta
    output: per_gene/EOG091G0TWR/EOG091G0TWR.fasta
    jobid: 2254
    wildcards: BUSCO=EOG091G0TWR


        cat per_gene/EOG091G0TWR/EOG091G0TWR.ingroup.fasta per_gene/EOG091G0TWR/EOG091G0TWR.outgroup.fasta > per_gene/EOG091G0TWR/EOG091G0TWR.fasta
        
[Mon Jul  6 00:00:46 2020]
Finished job 2254.
2664 of 3292 steps (81%) done

[Mon Jul  6 00:00:46 2020]
rule MSA:
    input: per_gene/EOG091G0TWR/EOG091G0TWR.fasta
    output: per_gene/EOG091G0TWR/EOG091G0TWR.clustalo.fasta
    log: per_gene/EOG091G0TWR/MSA.stdout.txt, per_gene/EOG091G0TWR/MSA.stderr.txt
    jobid: 1628
    wildcards: BUSCO=EOG091G0TWR
    threads: 2


        clustalo -i per_gene/EOG091G0TWR/EOG091G0TWR.fasta -o per_gene/EOG091G0TWR/EOG091G0TWR.clustalo.fasta --threads=2 1> per_gene/EOG091G0TWR/MSA.stdout.txt 2> per_gene/EOG091G0TWR/MSA.stderr.txt
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/d68c9691725a7401923680874285c430.simg
[Mon Jul  6 00:00:46 2020]
Finished job 474.
2665 of 3292 steps (81%) done

[Mon Jul  6 00:00:46 2020]
rule infer_single_ML:
    input: per_gene/EOG091G057L/EOG091G057L.best_model, per_gene/EOG091G057L/ALICUT_EOG091G057L.clustalo.fasta
    output: per_gene/EOG091G057L/EOG091G057L.raxml.done
    log: per_gene/EOG091G057L/infer_single_ML.stdout.txt, per_gene/EOG091G057L/infer_single_ML.stderr.txt
    jobid: 31
    wildcards: BUSCO=EOG091G057L
    threads: 2


        cd per_gene/EOG091G057L
	count=$(cat ../../per_gene/EOG091G057L/ALICUT_EOG091G057L.clustalo.fasta | grep ">" | wc -l)
	if [ "$count" -gt 5 ]
        then
		RAxMLmodel=$(cat ../../per_gene/EOG091G057L/EOG091G057L.best_model | grep "Best" | cut -d ":" -f 2 | tr -d '[:space:]')
                if [ "$(ls -1 | grep "^RAxML" | wc -l)" -ne 0 ]
		then
			rm RAxML*
		fi
        	raxml -f a -T 2 -m PROTGAMMA$RAxMLmodel         	-p 12345 -x 12345 -# 100         	-s ../../per_gene/EOG091G057L/ALICUT_EOG091G057L.clustalo.fasta -n EOG091G057L.clustalo.aln.ALICUT.$RAxMLmodel 		1> ../../per_gene/EOG091G057L/infer_single_ML.stdout.txt 2> ../../per_gene/EOG091G057L/infer_single_ML.stderr.txt
	else
		echo "fasta file per_gene/EOG091G057L/ALICUT_EOG091G057L.clustalo.fasta contains fewer than 5 sequences - skipped" > ../../per_gene/EOG091G057L/infer_single_ML.stdout.txt
		touch raxml.skipped
	fi
        touch ../../per_gene/EOG091G057L/EOG091G057L.raxml.done
        
[Mon Jul  6 00:00:46 2020]
Finished job 106.
2666 of 3292 steps (81%) done

[Mon Jul  6 00:00:46 2020]
rule get_seqs:
    input: /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ingroup.txt, /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/outgroup.txt
    output: per_gene/EOG091G0UKA/EOG091G0UKA.ingroup.fasta
    log: per_gene/EOG091G0UKA/get_seqs.stdout.txt, per_gene/EOG091G0UKA/get_seqs.stderr.txt
    jobid: 3284
    wildcards: BUSCO=EOG091G0UKA
    threads: 2


	basedir=$(pwd)
        cd per_gene/EOG091G0UKA
        
        bash $basedir/../scripts/fetch_seqs.sh EOG091G0UKA /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ingroup.txt /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/outgroup.txt 1> ../../per_gene/EOG091G0UKA/get_seqs.stdout.txt 2> ../../per_gene/EOG091G0UKA/get_seqs.stderr.txt
	mv EOG091G0UKA.fasta $basedir/per_gene/EOG091G0UKA/EOG091G0UKA.ingroup.fasta
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/72476f9d9a5bd0627b4d721143a21354.simg
[Mon Jul  6 00:00:46 2020]
Finished job 1628.
2667 of 3292 steps (81%) done

[Mon Jul  6 00:00:46 2020]
rule score_and_cut:
    input: per_gene/EOG091G0TWR/EOG091G0TWR.clustalo.fasta
    output: per_gene/EOG091G0TWR/ALICUT_EOG091G0TWR.clustalo.fasta
    jobid: 805
    wildcards: BUSCO=EOG091G0TWR
    threads: 2


        cd per_gene/EOG091G0TWR
        Aliscore.pl -N -r 200000000000000000 -i ../../per_gene/EOG091G0TWR/EOG091G0TWR.clustalo.fasta &> aliscore.log
        ALICUT.pl -s &> alicut.log
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/63c88c27a0fa300f57066b0ef65fefcb.simg
[Mon Jul  6 00:00:48 2020]
Finished job 447.
2668 of 3292 steps (81%) done

[Mon Jul  6 00:00:48 2020]
rule remove_empty:
    input: per_gene/EOG091G0321/ALICUT_EOG091G0321.clustalo.fasta
    output: per_gene/EOG091G0321/empty_check.done
    jobid: 1269
    wildcards: BUSCO=EOG091G0321


         if [ "$(cat per_gene/EOG091G0321/ALICUT_EOG091G0321.clustalo.fasta | grep -v ">" | sed 's/-//g' | grep "^$" | wc -l)" -gt 0 ]
         then
              cp per_gene/EOG091G0321/ALICUT_EOG091G0321.clustalo.fasta per_gene/EOG091G0321/ALICUT_EOG091G0321.clustalo.fasta.backup
              bash ../scripts/remove_empty.sh per_gene/EOG091G0321/ALICUT_EOG091G0321.clustalo.fasta.backup > per_gene/EOG091G0321/ALICUT_EOG091G0321.clustalo.fasta
         fi
         touch per_gene/EOG091G0321/empty_check.done
         
[Mon Jul  6 00:00:48 2020]
Finished job 1269.
2669 of 3292 steps (81%) done

[Mon Jul  6 00:00:48 2020]
rule find_best_model:
    input: per_gene/EOG091G0321/ALICUT_EOG091G0321.clustalo.fasta, per_gene/EOG091G0321/empty_check.done
    output: per_gene/EOG091G0321/EOG091G0321.best_model
    log: per_gene/EOG091G0321/find_best_model.stderr.txt
    jobid: 446
    wildcards: BUSCO=EOG091G0321
    threads: 2


        cd per_gene/EOG091G0321
        if [ ! -d find_best_model ]
        then
            mkdir find_best_model
        fi
        cd find_best_model
        ln -s ../../../per_gene/EOG091G0321/ALICUT_EOG091G0321.clustalo.fasta EOG091G0321.fasta
        ProteinModelSelection.pl EOG091G0321.fasta 1> ../../../per_gene/EOG091G0321/EOG091G0321.best_model 2> ../../../per_gene/EOG091G0321/find_best_model.stderr.txt
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/c0c09ee657b1e27f2c5687e0e9aa8d70.simg
[Mon Jul  6 00:00:56 2020]
Finished job 805.
2670 of 3292 steps (81%) done

[Mon Jul  6 00:00:56 2020]
rule remove_empty:
    input: per_gene/EOG091G0TWR/ALICUT_EOG091G0TWR.clustalo.fasta
    output: per_gene/EOG091G0TWR/empty_check.done
    jobid: 1627
    wildcards: BUSCO=EOG091G0TWR


         if [ "$(cat per_gene/EOG091G0TWR/ALICUT_EOG091G0TWR.clustalo.fasta | grep -v ">" | sed 's/-//g' | grep "^$" | wc -l)" -gt 0 ]
         then
              cp per_gene/EOG091G0TWR/ALICUT_EOG091G0TWR.clustalo.fasta per_gene/EOG091G0TWR/ALICUT_EOG091G0TWR.clustalo.fasta.backup
              bash ../scripts/remove_empty.sh per_gene/EOG091G0TWR/ALICUT_EOG091G0TWR.clustalo.fasta.backup > per_gene/EOG091G0TWR/ALICUT_EOG091G0TWR.clustalo.fasta
         fi
         touch per_gene/EOG091G0TWR/empty_check.done
         
[Mon Jul  6 00:00:56 2020]
Finished job 1627.
2671 of 3292 steps (81%) done

[Mon Jul  6 00:00:56 2020]
rule find_best_model:
    input: per_gene/EOG091G0TWR/ALICUT_EOG091G0TWR.clustalo.fasta, per_gene/EOG091G0TWR/empty_check.done
    output: per_gene/EOG091G0TWR/EOG091G0TWR.best_model
    log: per_gene/EOG091G0TWR/find_best_model.stderr.txt
    jobid: 804
    wildcards: BUSCO=EOG091G0TWR
    threads: 2


        cd per_gene/EOG091G0TWR
        if [ ! -d find_best_model ]
        then
            mkdir find_best_model
        fi
        cd find_best_model
        ln -s ../../../per_gene/EOG091G0TWR/ALICUT_EOG091G0TWR.clustalo.fasta EOG091G0TWR.fasta
        ProteinModelSelection.pl EOG091G0TWR.fasta 1> ../../../per_gene/EOG091G0TWR/EOG091G0TWR.best_model 2> ../../../per_gene/EOG091G0TWR/find_best_model.stderr.txt
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/c0c09ee657b1e27f2c5687e0e9aa8d70.simg
[Mon Jul  6 00:00:58 2020]
Finished job 3284.
2672 of 3292 steps (81%) done

[Mon Jul  6 00:00:58 2020]
rule get_outgroups:
    input: per_gene/EOG091G0UKA/EOG091G0UKA.ingroup.fasta
    output: per_gene/EOG091G0UKA/EOG091G0UKA.orthodb.fasta, per_gene/EOG091G0UKA/EOG091G0UKA.outgroup.fasta
    log: per_gene/EOG091G0UKA/get_outgroups.stdout.txt, per_gene/EOG091G0UKA/get_outgroups.stderr.txt
    jobid: 3285
    wildcards: BUSCO=EOG091G0UKA


        #download fastas from Orhtodb for BUSCO id
        for i in {1..5}
        do
             wget "http://www.orthodb.org/fasta?query=EOG091G0UKA&level=33208" -O per_gene/EOG091G0UKA/EOG091G0UKA.orthodb.fasta 1> per_gene/EOG091G0UKA/get_outgroups.stdout.txt 2> per_gene/EOG091G0UKA/get_outgroups.stderr.txt && break || echo -e "try again ($i)" && sleep 15
        done

	#This is quick an dirty for now and just takes the first protein if there is more than one for an outgroup taxon
        bash ../scripts/download_outgroups.sh taxids.txt per_gene/EOG091G0UKA/EOG091G0UKA.orthodb.fasta > per_gene/EOG091G0UKA/EOG091G0UKA.outgroup.fasta
        
[Mon Jul  6 00:00:59 2020]
Finished job 3285.
2673 of 3292 steps (81%) done

[Mon Jul  6 00:00:59 2020]
rule join_groups:
    input: per_gene/EOG091G0UKA/EOG091G0UKA.ingroup.fasta, per_gene/EOG091G0UKA/EOG091G0UKA.outgroup.fasta
    output: per_gene/EOG091G0UKA/EOG091G0UKA.fasta
    jobid: 2466
    wildcards: BUSCO=EOG091G0UKA


        cat per_gene/EOG091G0UKA/EOG091G0UKA.ingroup.fasta per_gene/EOG091G0UKA/EOG091G0UKA.outgroup.fasta > per_gene/EOG091G0UKA/EOG091G0UKA.fasta
        
[Mon Jul  6 00:00:59 2020]
Finished job 2466.
2674 of 3292 steps (81%) done

[Mon Jul  6 00:00:59 2020]
rule MSA:
    input: per_gene/EOG091G0UKA/EOG091G0UKA.fasta
    output: per_gene/EOG091G0UKA/EOG091G0UKA.clustalo.fasta
    log: per_gene/EOG091G0UKA/MSA.stdout.txt, per_gene/EOG091G0UKA/MSA.stderr.txt
    jobid: 2052
    wildcards: BUSCO=EOG091G0UKA
    threads: 2


        clustalo -i per_gene/EOG091G0UKA/EOG091G0UKA.fasta -o per_gene/EOG091G0UKA/EOG091G0UKA.clustalo.fasta --threads=2 1> per_gene/EOG091G0UKA/MSA.stdout.txt 2> per_gene/EOG091G0UKA/MSA.stderr.txt
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/d68c9691725a7401923680874285c430.simg
[Mon Jul  6 00:01:00 2020]
Finished job 2052.
2675 of 3292 steps (81%) done

[Mon Jul  6 00:01:00 2020]
rule score_and_cut:
    input: per_gene/EOG091G0UKA/EOG091G0UKA.clustalo.fasta
    output: per_gene/EOG091G0UKA/ALICUT_EOG091G0UKA.clustalo.fasta
    jobid: 1229
    wildcards: BUSCO=EOG091G0UKA
    threads: 2


        cd per_gene/EOG091G0UKA
        Aliscore.pl -N -r 200000000000000000 -i ../../per_gene/EOG091G0UKA/EOG091G0UKA.clustalo.fasta &> aliscore.log
        ALICUT.pl -s &> alicut.log
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/63c88c27a0fa300f57066b0ef65fefcb.simg
[33mJob counts:
	count	jobs
	1	infer_single_ML
	1[0m
[33m
        cd per_gene/EOG091G057L
	count=$(cat ../../per_gene/EOG091G057L/ALICUT_EOG091G057L.clustalo.fasta | grep ">" | wc -l)
	if [ "$count" -gt 5 ]
        then
		RAxMLmodel=$(cat ../../per_gene/EOG091G057L/EOG091G057L.best_model | grep "Best" | cut -d ":" -f 2 | tr -d '[:space:]')
                if [ "$(ls -1 | grep "^RAxML" | wc -l)" -ne 0 ]
		then
			rm RAxML*
		fi
        	raxml -f a -T 2 -m PROTGAMMA$RAxMLmodel         	-p 12345 -x 12345 -# 100         	-s ../../per_gene/EOG091G057L/ALICUT_EOG091G057L.clustalo.fasta -n EOG091G057L.clustalo.aln.ALICUT.$RAxMLmodel 		1> ../../per_gene/EOG091G057L/infer_single_ML.stdout.txt 2> ../../per_gene/EOG091G057L/infer_single_ML.stderr.txt
	else
		echo "fasta file per_gene/EOG091G057L/ALICUT_EOG091G057L.clustalo.fasta contains fewer than 5 sequences - skipped" > ../../per_gene/EOG091G057L/infer_single_ML.stdout.txt
		touch raxml.skipped
	fi
        touch ../../per_gene/EOG091G057L/EOG091G057L.raxml.done
        [0m
[Mon Jul  6 00:01:09 2020]
Finished job 381.
2676 of 3292 steps (81%) done

[Mon Jul  6 00:01:09 2020]
rule get_seqs:
    input: /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ingroup.txt, /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/outgroup.txt
    output: per_gene/EOG091G0LKE/EOG091G0LKE.ingroup.fasta
    log: per_gene/EOG091G0LKE/get_seqs.stdout.txt, per_gene/EOG091G0LKE/get_seqs.stderr.txt
    jobid: 2746
    wildcards: BUSCO=EOG091G0LKE
    threads: 2


	basedir=$(pwd)
        cd per_gene/EOG091G0LKE
        
        bash $basedir/../scripts/fetch_seqs.sh EOG091G0LKE /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ingroup.txt /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/outgroup.txt 1> ../../per_gene/EOG091G0LKE/get_seqs.stdout.txt 2> ../../per_gene/EOG091G0LKE/get_seqs.stderr.txt
	mv EOG091G0LKE.fasta $basedir/per_gene/EOG091G0LKE/EOG091G0LKE.ingroup.fasta
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/72476f9d9a5bd0627b4d721143a21354.simg
[Mon Jul  6 00:01:10 2020]
Finished job 1229.
2677 of 3292 steps (81%) done

[Mon Jul  6 00:01:10 2020]
rule remove_empty:
    input: per_gene/EOG091G0UKA/ALICUT_EOG091G0UKA.clustalo.fasta
    output: per_gene/EOG091G0UKA/empty_check.done
    jobid: 2051
    wildcards: BUSCO=EOG091G0UKA


         if [ "$(cat per_gene/EOG091G0UKA/ALICUT_EOG091G0UKA.clustalo.fasta | grep -v ">" | sed 's/-//g' | grep "^$" | wc -l)" -gt 0 ]
         then
              cp per_gene/EOG091G0UKA/ALICUT_EOG091G0UKA.clustalo.fasta per_gene/EOG091G0UKA/ALICUT_EOG091G0UKA.clustalo.fasta.backup
              bash ../scripts/remove_empty.sh per_gene/EOG091G0UKA/ALICUT_EOG091G0UKA.clustalo.fasta.backup > per_gene/EOG091G0UKA/ALICUT_EOG091G0UKA.clustalo.fasta
         fi
         touch per_gene/EOG091G0UKA/empty_check.done
         
[Mon Jul  6 00:01:10 2020]
Finished job 2051.
2678 of 3292 steps (81%) done

[Mon Jul  6 00:01:10 2020]
rule find_best_model:
    input: per_gene/EOG091G0UKA/ALICUT_EOG091G0UKA.clustalo.fasta, per_gene/EOG091G0UKA/empty_check.done
    output: per_gene/EOG091G0UKA/EOG091G0UKA.best_model
    log: per_gene/EOG091G0UKA/find_best_model.stderr.txt
    jobid: 1228
    wildcards: BUSCO=EOG091G0UKA
    threads: 2


        cd per_gene/EOG091G0UKA
        if [ ! -d find_best_model ]
        then
            mkdir find_best_model
        fi
        cd find_best_model
        ln -s ../../../per_gene/EOG091G0UKA/ALICUT_EOG091G0UKA.clustalo.fasta EOG091G0UKA.fasta
        ProteinModelSelection.pl EOG091G0UKA.fasta 1> ../../../per_gene/EOG091G0UKA/EOG091G0UKA.best_model 2> ../../../per_gene/EOG091G0UKA/find_best_model.stderr.txt
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/c0c09ee657b1e27f2c5687e0e9aa8d70.simg
[Mon Jul  6 00:01:17 2020]
Finished job 446.
2679 of 3292 steps (81%) done

[Mon Jul  6 00:01:17 2020]
rule infer_single_ML:
    input: per_gene/EOG091G0321/EOG091G0321.best_model, per_gene/EOG091G0321/ALICUT_EOG091G0321.clustalo.fasta
    output: per_gene/EOG091G0321/EOG091G0321.raxml.done
    log: per_gene/EOG091G0321/infer_single_ML.stdout.txt, per_gene/EOG091G0321/infer_single_ML.stderr.txt
    jobid: 17
    wildcards: BUSCO=EOG091G0321
    threads: 2


        cd per_gene/EOG091G0321
	count=$(cat ../../per_gene/EOG091G0321/ALICUT_EOG091G0321.clustalo.fasta | grep ">" | wc -l)
	if [ "$count" -gt 5 ]
        then
		RAxMLmodel=$(cat ../../per_gene/EOG091G0321/EOG091G0321.best_model | grep "Best" | cut -d ":" -f 2 | tr -d '[:space:]')
                if [ "$(ls -1 | grep "^RAxML" | wc -l)" -ne 0 ]
		then
			rm RAxML*
		fi
        	raxml -f a -T 2 -m PROTGAMMA$RAxMLmodel         	-p 12345 -x 12345 -# 100         	-s ../../per_gene/EOG091G0321/ALICUT_EOG091G0321.clustalo.fasta -n EOG091G0321.clustalo.aln.ALICUT.$RAxMLmodel 		1> ../../per_gene/EOG091G0321/infer_single_ML.stdout.txt 2> ../../per_gene/EOG091G0321/infer_single_ML.stderr.txt
	else
		echo "fasta file per_gene/EOG091G0321/ALICUT_EOG091G0321.clustalo.fasta contains fewer than 5 sequences - skipped" > ../../per_gene/EOG091G0321/infer_single_ML.stdout.txt
		touch raxml.skipped
	fi
        touch ../../per_gene/EOG091G0321/EOG091G0321.raxml.done
        
[33mJob counts:
	count	jobs
	1	infer_single_ML
	1[0m
[33m
        cd per_gene/EOG091G0321
	count=$(cat ../../per_gene/EOG091G0321/ALICUT_EOG091G0321.clustalo.fasta | grep ">" | wc -l)
	if [ "$count" -gt 5 ]
        then
		RAxMLmodel=$(cat ../../per_gene/EOG091G0321/EOG091G0321.best_model | grep "Best" | cut -d ":" -f 2 | tr -d '[:space:]')
                if [ "$(ls -1 | grep "^RAxML" | wc -l)" -ne 0 ]
		then
			rm RAxML*
		fi
        	raxml -f a -T 2 -m PROTGAMMA$RAxMLmodel         	-p 12345 -x 12345 -# 100         	-s ../../per_gene/EOG091G0321/ALICUT_EOG091G0321.clustalo.fasta -n EOG091G0321.clustalo.aln.ALICUT.$RAxMLmodel 		1> ../../per_gene/EOG091G0321/infer_single_ML.stdout.txt 2> ../../per_gene/EOG091G0321/infer_single_ML.stderr.txt
	else
		echo "fasta file per_gene/EOG091G0321/ALICUT_EOG091G0321.clustalo.fasta contains fewer than 5 sequences - skipped" > ../../per_gene/EOG091G0321/infer_single_ML.stdout.txt
		touch raxml.skipped
	fi
        touch ../../per_gene/EOG091G0321/EOG091G0321.raxml.done
        [0m
[Mon Jul  6 00:01:19 2020]
Finished job 804.
2680 of 3292 steps (81%) done

[Mon Jul  6 00:01:19 2020]
rule infer_single_ML:
    input: per_gene/EOG091G0TWR/EOG091G0TWR.best_model, per_gene/EOG091G0TWR/ALICUT_EOG091G0TWR.clustalo.fasta
    output: per_gene/EOG091G0TWR/EOG091G0TWR.raxml.done
    log: per_gene/EOG091G0TWR/infer_single_ML.stdout.txt, per_gene/EOG091G0TWR/infer_single_ML.stderr.txt
    jobid: 196
    wildcards: BUSCO=EOG091G0TWR
    threads: 2


        cd per_gene/EOG091G0TWR
	count=$(cat ../../per_gene/EOG091G0TWR/ALICUT_EOG091G0TWR.clustalo.fasta | grep ">" | wc -l)
	if [ "$count" -gt 5 ]
        then
		RAxMLmodel=$(cat ../../per_gene/EOG091G0TWR/EOG091G0TWR.best_model | grep "Best" | cut -d ":" -f 2 | tr -d '[:space:]')
                if [ "$(ls -1 | grep "^RAxML" | wc -l)" -ne 0 ]
		then
			rm RAxML*
		fi
        	raxml -f a -T 2 -m PROTGAMMA$RAxMLmodel         	-p 12345 -x 12345 -# 100         	-s ../../per_gene/EOG091G0TWR/ALICUT_EOG091G0TWR.clustalo.fasta -n EOG091G0TWR.clustalo.aln.ALICUT.$RAxMLmodel 		1> ../../per_gene/EOG091G0TWR/infer_single_ML.stdout.txt 2> ../../per_gene/EOG091G0TWR/infer_single_ML.stderr.txt
	else
		echo "fasta file per_gene/EOG091G0TWR/ALICUT_EOG091G0TWR.clustalo.fasta contains fewer than 5 sequences - skipped" > ../../per_gene/EOG091G0TWR/infer_single_ML.stdout.txt
		touch raxml.skipped
	fi
        touch ../../per_gene/EOG091G0TWR/EOG091G0TWR.raxml.done
        
[33mJob counts:
	count	jobs
	1	infer_single_ML
	1[0m
[33m
        cd per_gene/EOG091G0TWR
	count=$(cat ../../per_gene/EOG091G0TWR/ALICUT_EOG091G0TWR.clustalo.fasta | grep ">" | wc -l)
	if [ "$count" -gt 5 ]
        then
		RAxMLmodel=$(cat ../../per_gene/EOG091G0TWR/EOG091G0TWR.best_model | grep "Best" | cut -d ":" -f 2 | tr -d '[:space:]')
                if [ "$(ls -1 | grep "^RAxML" | wc -l)" -ne 0 ]
		then
			rm RAxML*
		fi
        	raxml -f a -T 2 -m PROTGAMMA$RAxMLmodel         	-p 12345 -x 12345 -# 100         	-s ../../per_gene/EOG091G0TWR/ALICUT_EOG091G0TWR.clustalo.fasta -n EOG091G0TWR.clustalo.aln.ALICUT.$RAxMLmodel 		1> ../../per_gene/EOG091G0TWR/infer_single_ML.stdout.txt 2> ../../per_gene/EOG091G0TWR/infer_single_ML.stderr.txt
	else
		echo "fasta file per_gene/EOG091G0TWR/ALICUT_EOG091G0TWR.clustalo.fasta contains fewer than 5 sequences - skipped" > ../../per_gene/EOG091G0TWR/infer_single_ML.stdout.txt
		touch raxml.skipped
	fi
        touch ../../per_gene/EOG091G0TWR/EOG091G0TWR.raxml.done
        [0m
[Mon Jul  6 00:01:25 2020]
Finished job 2746.
2681 of 3292 steps (81%) done

[Mon Jul  6 00:01:25 2020]
rule get_outgroups:
    input: per_gene/EOG091G0LKE/EOG091G0LKE.ingroup.fasta
    output: per_gene/EOG091G0LKE/EOG091G0LKE.orthodb.fasta, per_gene/EOG091G0LKE/EOG091G0LKE.outgroup.fasta
    log: per_gene/EOG091G0LKE/get_outgroups.stdout.txt, per_gene/EOG091G0LKE/get_outgroups.stderr.txt
    jobid: 2747
    wildcards: BUSCO=EOG091G0LKE


        #download fastas from Orhtodb for BUSCO id
        for i in {1..5}
        do
             wget "http://www.orthodb.org/fasta?query=EOG091G0LKE&level=33208" -O per_gene/EOG091G0LKE/EOG091G0LKE.orthodb.fasta 1> per_gene/EOG091G0LKE/get_outgroups.stdout.txt 2> per_gene/EOG091G0LKE/get_outgroups.stderr.txt && break || echo -e "try again ($i)" && sleep 15
        done

	#This is quick an dirty for now and just takes the first protein if there is more than one for an outgroup taxon
        bash ../scripts/download_outgroups.sh taxids.txt per_gene/EOG091G0LKE/EOG091G0LKE.orthodb.fasta > per_gene/EOG091G0LKE/EOG091G0LKE.outgroup.fasta
        
[Mon Jul  6 00:01:26 2020]
Finished job 2747.
2682 of 3292 steps (81%) done

[Mon Jul  6 00:01:26 2020]
rule join_groups:
    input: per_gene/EOG091G0LKE/EOG091G0LKE.ingroup.fasta, per_gene/EOG091G0LKE/EOG091G0LKE.outgroup.fasta
    output: per_gene/EOG091G0LKE/EOG091G0LKE.fasta
    jobid: 2197
    wildcards: BUSCO=EOG091G0LKE


        cat per_gene/EOG091G0LKE/EOG091G0LKE.ingroup.fasta per_gene/EOG091G0LKE/EOG091G0LKE.outgroup.fasta > per_gene/EOG091G0LKE/EOG091G0LKE.fasta
        
[Mon Jul  6 00:01:26 2020]
Finished job 2197.
2683 of 3292 steps (82%) done

[Mon Jul  6 00:01:26 2020]
rule MSA:
    input: per_gene/EOG091G0LKE/EOG091G0LKE.fasta
    output: per_gene/EOG091G0LKE/EOG091G0LKE.clustalo.fasta
    log: per_gene/EOG091G0LKE/MSA.stdout.txt, per_gene/EOG091G0LKE/MSA.stderr.txt
    jobid: 1514
    wildcards: BUSCO=EOG091G0LKE
    threads: 2


        clustalo -i per_gene/EOG091G0LKE/EOG091G0LKE.fasta -o per_gene/EOG091G0LKE/EOG091G0LKE.clustalo.fasta --threads=2 1> per_gene/EOG091G0LKE/MSA.stdout.txt 2> per_gene/EOG091G0LKE/MSA.stderr.txt
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/d68c9691725a7401923680874285c430.simg
[Mon Jul  6 00:01:28 2020]
Finished job 1514.
2684 of 3292 steps (82%) done

[Mon Jul  6 00:01:28 2020]
rule score_and_cut:
    input: per_gene/EOG091G0LKE/EOG091G0LKE.clustalo.fasta
    output: per_gene/EOG091G0LKE/ALICUT_EOG091G0LKE.clustalo.fasta
    jobid: 691
    wildcards: BUSCO=EOG091G0LKE
    threads: 2


        cd per_gene/EOG091G0LKE
        Aliscore.pl -N -r 200000000000000000 -i ../../per_gene/EOG091G0LKE/EOG091G0LKE.clustalo.fasta &> aliscore.log
        ALICUT.pl -s &> alicut.log
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/63c88c27a0fa300f57066b0ef65fefcb.simg
[Mon Jul  6 00:01:34 2020]
Finished job 1228.
2685 of 3292 steps (82%) done

[Mon Jul  6 00:01:34 2020]
rule infer_single_ML:
    input: per_gene/EOG091G0UKA/EOG091G0UKA.best_model, per_gene/EOG091G0UKA/ALICUT_EOG091G0UKA.clustalo.fasta
    output: per_gene/EOG091G0UKA/EOG091G0UKA.raxml.done
    log: per_gene/EOG091G0UKA/infer_single_ML.stdout.txt, per_gene/EOG091G0UKA/infer_single_ML.stderr.txt
    jobid: 408
    wildcards: BUSCO=EOG091G0UKA
    threads: 2


        cd per_gene/EOG091G0UKA
	count=$(cat ../../per_gene/EOG091G0UKA/ALICUT_EOG091G0UKA.clustalo.fasta | grep ">" | wc -l)
	if [ "$count" -gt 5 ]
        then
		RAxMLmodel=$(cat ../../per_gene/EOG091G0UKA/EOG091G0UKA.best_model | grep "Best" | cut -d ":" -f 2 | tr -d '[:space:]')
                if [ "$(ls -1 | grep "^RAxML" | wc -l)" -ne 0 ]
		then
			rm RAxML*
		fi
        	raxml -f a -T 2 -m PROTGAMMA$RAxMLmodel         	-p 12345 -x 12345 -# 100         	-s ../../per_gene/EOG091G0UKA/ALICUT_EOG091G0UKA.clustalo.fasta -n EOG091G0UKA.clustalo.aln.ALICUT.$RAxMLmodel 		1> ../../per_gene/EOG091G0UKA/infer_single_ML.stdout.txt 2> ../../per_gene/EOG091G0UKA/infer_single_ML.stderr.txt
	else
		echo "fasta file per_gene/EOG091G0UKA/ALICUT_EOG091G0UKA.clustalo.fasta contains fewer than 5 sequences - skipped" > ../../per_gene/EOG091G0UKA/infer_single_ML.stdout.txt
		touch raxml.skipped
	fi
        touch ../../per_gene/EOG091G0UKA/EOG091G0UKA.raxml.done
        
[33mJob counts:
	count	jobs
	1	infer_single_ML
	1[0m
[33m
        cd per_gene/EOG091G0UKA
	count=$(cat ../../per_gene/EOG091G0UKA/ALICUT_EOG091G0UKA.clustalo.fasta | grep ">" | wc -l)
	if [ "$count" -gt 5 ]
        then
		RAxMLmodel=$(cat ../../per_gene/EOG091G0UKA/EOG091G0UKA.best_model | grep "Best" | cut -d ":" -f 2 | tr -d '[:space:]')
                if [ "$(ls -1 | grep "^RAxML" | wc -l)" -ne 0 ]
		then
			rm RAxML*
		fi
        	raxml -f a -T 2 -m PROTGAMMA$RAxMLmodel         	-p 12345 -x 12345 -# 100         	-s ../../per_gene/EOG091G0UKA/ALICUT_EOG091G0UKA.clustalo.fasta -n EOG091G0UKA.clustalo.aln.ALICUT.$RAxMLmodel 		1> ../../per_gene/EOG091G0UKA/infer_single_ML.stdout.txt 2> ../../per_gene/EOG091G0UKA/infer_single_ML.stderr.txt
	else
		echo "fasta file per_gene/EOG091G0UKA/ALICUT_EOG091G0UKA.clustalo.fasta contains fewer than 5 sequences - skipped" > ../../per_gene/EOG091G0UKA/infer_single_ML.stdout.txt
		touch raxml.skipped
	fi
        touch ../../per_gene/EOG091G0UKA/EOG091G0UKA.raxml.done
        [0m
[Mon Jul  6 00:01:38 2020]
Finished job 691.
2686 of 3292 steps (82%) done

[Mon Jul  6 00:01:38 2020]
rule remove_empty:
    input: per_gene/EOG091G0LKE/ALICUT_EOG091G0LKE.clustalo.fasta
    output: per_gene/EOG091G0LKE/empty_check.done
    jobid: 1513
    wildcards: BUSCO=EOG091G0LKE


         if [ "$(cat per_gene/EOG091G0LKE/ALICUT_EOG091G0LKE.clustalo.fasta | grep -v ">" | sed 's/-//g' | grep "^$" | wc -l)" -gt 0 ]
         then
              cp per_gene/EOG091G0LKE/ALICUT_EOG091G0LKE.clustalo.fasta per_gene/EOG091G0LKE/ALICUT_EOG091G0LKE.clustalo.fasta.backup
              bash ../scripts/remove_empty.sh per_gene/EOG091G0LKE/ALICUT_EOG091G0LKE.clustalo.fasta.backup > per_gene/EOG091G0LKE/ALICUT_EOG091G0LKE.clustalo.fasta
         fi
         touch per_gene/EOG091G0LKE/empty_check.done
         
[Mon Jul  6 00:01:56 2020]
Finished job 1513.
2687 of 3292 steps (82%) done

[Mon Jul  6 00:01:56 2020]
rule find_best_model:
    input: per_gene/EOG091G0LKE/ALICUT_EOG091G0LKE.clustalo.fasta, per_gene/EOG091G0LKE/empty_check.done
    output: per_gene/EOG091G0LKE/EOG091G0LKE.best_model
    log: per_gene/EOG091G0LKE/find_best_model.stderr.txt
    jobid: 690
    wildcards: BUSCO=EOG091G0LKE
    threads: 2


        cd per_gene/EOG091G0LKE
        if [ ! -d find_best_model ]
        then
            mkdir find_best_model
        fi
        cd find_best_model
        ln -s ../../../per_gene/EOG091G0LKE/ALICUT_EOG091G0LKE.clustalo.fasta EOG091G0LKE.fasta
        ProteinModelSelection.pl EOG091G0LKE.fasta 1> ../../../per_gene/EOG091G0LKE/EOG091G0LKE.best_model 2> ../../../per_gene/EOG091G0LKE/find_best_model.stderr.txt
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/c0c09ee657b1e27f2c5687e0e9aa8d70.simg
[Mon Jul  6 00:02:25 2020]
Finished job 690.
2688 of 3292 steps (82%) done

[Mon Jul  6 00:02:25 2020]
rule infer_single_ML:
    input: per_gene/EOG091G0LKE/EOG091G0LKE.best_model, per_gene/EOG091G0LKE/ALICUT_EOG091G0LKE.clustalo.fasta
    output: per_gene/EOG091G0LKE/EOG091G0LKE.raxml.done
    log: per_gene/EOG091G0LKE/infer_single_ML.stdout.txt, per_gene/EOG091G0LKE/infer_single_ML.stderr.txt
    jobid: 139
    wildcards: BUSCO=EOG091G0LKE
    threads: 2


        cd per_gene/EOG091G0LKE
	count=$(cat ../../per_gene/EOG091G0LKE/ALICUT_EOG091G0LKE.clustalo.fasta | grep ">" | wc -l)
	if [ "$count" -gt 5 ]
        then
		RAxMLmodel=$(cat ../../per_gene/EOG091G0LKE/EOG091G0LKE.best_model | grep "Best" | cut -d ":" -f 2 | tr -d '[:space:]')
                if [ "$(ls -1 | grep "^RAxML" | wc -l)" -ne 0 ]
		then
			rm RAxML*
		fi
        	raxml -f a -T 2 -m PROTGAMMA$RAxMLmodel         	-p 12345 -x 12345 -# 100         	-s ../../per_gene/EOG091G0LKE/ALICUT_EOG091G0LKE.clustalo.fasta -n EOG091G0LKE.clustalo.aln.ALICUT.$RAxMLmodel 		1> ../../per_gene/EOG091G0LKE/infer_single_ML.stdout.txt 2> ../../per_gene/EOG091G0LKE/infer_single_ML.stderr.txt
	else
		echo "fasta file per_gene/EOG091G0LKE/ALICUT_EOG091G0LKE.clustalo.fasta contains fewer than 5 sequences - skipped" > ../../per_gene/EOG091G0LKE/infer_single_ML.stdout.txt
		touch raxml.skipped
	fi
        touch ../../per_gene/EOG091G0LKE/EOG091G0LKE.raxml.done
        
[33mJob counts:
	count	jobs
	1	infer_single_ML
	1[0m
[33m
        cd per_gene/EOG091G0LKE
	count=$(cat ../../per_gene/EOG091G0LKE/ALICUT_EOG091G0LKE.clustalo.fasta | grep ">" | wc -l)
	if [ "$count" -gt 5 ]
        then
		RAxMLmodel=$(cat ../../per_gene/EOG091G0LKE/EOG091G0LKE.best_model | grep "Best" | cut -d ":" -f 2 | tr -d '[:space:]')
                if [ "$(ls -1 | grep "^RAxML" | wc -l)" -ne 0 ]
		then
			rm RAxML*
		fi
        	raxml -f a -T 2 -m PROTGAMMA$RAxMLmodel         	-p 12345 -x 12345 -# 100         	-s ../../per_gene/EOG091G0LKE/ALICUT_EOG091G0LKE.clustalo.fasta -n EOG091G0LKE.clustalo.aln.ALICUT.$RAxMLmodel 		1> ../../per_gene/EOG091G0LKE/infer_single_ML.stdout.txt 2> ../../per_gene/EOG091G0LKE/infer_single_ML.stderr.txt
	else
		echo "fasta file per_gene/EOG091G0LKE/ALICUT_EOG091G0LKE.clustalo.fasta contains fewer than 5 sequences - skipped" > ../../per_gene/EOG091G0LKE/infer_single_ML.stdout.txt
		touch raxml.skipped
	fi
        touch ../../per_gene/EOG091G0LKE/EOG091G0LKE.raxml.done
        [0m
[Mon Jul  6 00:02:30 2020]
Finished job 165.
2689 of 3292 steps (82%) done

[Mon Jul  6 00:02:30 2020]
rule get_seqs:
    input: /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ingroup.txt, /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/outgroup.txt
    output: per_gene/EOG091G0G8R/EOG091G0G8R.ingroup.fasta
    log: per_gene/EOG091G0G8R/get_seqs.stdout.txt, per_gene/EOG091G0G8R/get_seqs.stderr.txt
    jobid: 2686
    wildcards: BUSCO=EOG091G0G8R
    threads: 2


	basedir=$(pwd)
        cd per_gene/EOG091G0G8R
        
        bash $basedir/../scripts/fetch_seqs.sh EOG091G0G8R /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ingroup.txt /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/outgroup.txt 1> ../../per_gene/EOG091G0G8R/get_seqs.stdout.txt 2> ../../per_gene/EOG091G0G8R/get_seqs.stderr.txt
	mv EOG091G0G8R.fasta $basedir/per_gene/EOG091G0G8R/EOG091G0G8R.ingroup.fasta
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/72476f9d9a5bd0627b4d721143a21354.simg
[Mon Jul  6 00:02:47 2020]
Finished job 2686.
2690 of 3292 steps (82%) done

[Mon Jul  6 00:02:47 2020]
rule get_outgroups:
    input: per_gene/EOG091G0G8R/EOG091G0G8R.ingroup.fasta
    output: per_gene/EOG091G0G8R/EOG091G0G8R.orthodb.fasta, per_gene/EOG091G0G8R/EOG091G0G8R.outgroup.fasta
    log: per_gene/EOG091G0G8R/get_outgroups.stdout.txt, per_gene/EOG091G0G8R/get_outgroups.stderr.txt
    jobid: 2687
    wildcards: BUSCO=EOG091G0G8R


        #download fastas from Orhtodb for BUSCO id
        for i in {1..5}
        do
             wget "http://www.orthodb.org/fasta?query=EOG091G0G8R&level=33208" -O per_gene/EOG091G0G8R/EOG091G0G8R.orthodb.fasta 1> per_gene/EOG091G0G8R/get_outgroups.stdout.txt 2> per_gene/EOG091G0G8R/get_outgroups.stderr.txt && break || echo -e "try again ($i)" && sleep 15
        done

	#This is quick an dirty for now and just takes the first protein if there is more than one for an outgroup taxon
        bash ../scripts/download_outgroups.sh taxids.txt per_gene/EOG091G0G8R/EOG091G0G8R.orthodb.fasta > per_gene/EOG091G0G8R/EOG091G0G8R.outgroup.fasta
        
[Mon Jul  6 00:02:48 2020]
Finished job 2687.
2691 of 3292 steps (82%) done

[Mon Jul  6 00:02:48 2020]
rule join_groups:
    input: per_gene/EOG091G0G8R/EOG091G0G8R.ingroup.fasta, per_gene/EOG091G0G8R/EOG091G0G8R.outgroup.fasta
    output: per_gene/EOG091G0G8R/EOG091G0G8R.fasta
    jobid: 2167
    wildcards: BUSCO=EOG091G0G8R


        cat per_gene/EOG091G0G8R/EOG091G0G8R.ingroup.fasta per_gene/EOG091G0G8R/EOG091G0G8R.outgroup.fasta > per_gene/EOG091G0G8R/EOG091G0G8R.fasta
        
[Mon Jul  6 00:02:48 2020]
Finished job 2167.
2692 of 3292 steps (82%) done

[Mon Jul  6 00:02:48 2020]
rule MSA:
    input: per_gene/EOG091G0G8R/EOG091G0G8R.fasta
    output: per_gene/EOG091G0G8R/EOG091G0G8R.clustalo.fasta
    log: per_gene/EOG091G0G8R/MSA.stdout.txt, per_gene/EOG091G0G8R/MSA.stderr.txt
    jobid: 1454
    wildcards: BUSCO=EOG091G0G8R
    threads: 2


        clustalo -i per_gene/EOG091G0G8R/EOG091G0G8R.fasta -o per_gene/EOG091G0G8R/EOG091G0G8R.clustalo.fasta --threads=2 1> per_gene/EOG091G0G8R/MSA.stdout.txt 2> per_gene/EOG091G0G8R/MSA.stderr.txt
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/d68c9691725a7401923680874285c430.simg
[Mon Jul  6 00:02:49 2020]
Finished job 1454.
2693 of 3292 steps (82%) done

[Mon Jul  6 00:02:49 2020]
rule score_and_cut:
    input: per_gene/EOG091G0G8R/EOG091G0G8R.clustalo.fasta
    output: per_gene/EOG091G0G8R/ALICUT_EOG091G0G8R.clustalo.fasta
    jobid: 631
    wildcards: BUSCO=EOG091G0G8R
    threads: 2


        cd per_gene/EOG091G0G8R
        Aliscore.pl -N -r 200000000000000000 -i ../../per_gene/EOG091G0G8R/EOG091G0G8R.clustalo.fasta &> aliscore.log
        ALICUT.pl -s &> alicut.log
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/63c88c27a0fa300f57066b0ef65fefcb.simg
[Mon Jul  6 00:03:00 2020]
Finished job 631.
2694 of 3292 steps (82%) done

[Mon Jul  6 00:03:00 2020]
rule remove_empty:
    input: per_gene/EOG091G0G8R/ALICUT_EOG091G0G8R.clustalo.fasta
    output: per_gene/EOG091G0G8R/empty_check.done
    jobid: 1453
    wildcards: BUSCO=EOG091G0G8R


         if [ "$(cat per_gene/EOG091G0G8R/ALICUT_EOG091G0G8R.clustalo.fasta | grep -v ">" | sed 's/-//g' | grep "^$" | wc -l)" -gt 0 ]
         then
              cp per_gene/EOG091G0G8R/ALICUT_EOG091G0G8R.clustalo.fasta per_gene/EOG091G0G8R/ALICUT_EOG091G0G8R.clustalo.fasta.backup
              bash ../scripts/remove_empty.sh per_gene/EOG091G0G8R/ALICUT_EOG091G0G8R.clustalo.fasta.backup > per_gene/EOG091G0G8R/ALICUT_EOG091G0G8R.clustalo.fasta
         fi
         touch per_gene/EOG091G0G8R/empty_check.done
         
[Mon Jul  6 00:03:00 2020]
Finished job 1453.
2695 of 3292 steps (82%) done

[Mon Jul  6 00:03:00 2020]
rule find_best_model:
    input: per_gene/EOG091G0G8R/ALICUT_EOG091G0G8R.clustalo.fasta, per_gene/EOG091G0G8R/empty_check.done
    output: per_gene/EOG091G0G8R/EOG091G0G8R.best_model
    log: per_gene/EOG091G0G8R/find_best_model.stderr.txt
    jobid: 630
    wildcards: BUSCO=EOG091G0G8R
    threads: 2


        cd per_gene/EOG091G0G8R
        if [ ! -d find_best_model ]
        then
            mkdir find_best_model
        fi
        cd find_best_model
        ln -s ../../../per_gene/EOG091G0G8R/ALICUT_EOG091G0G8R.clustalo.fasta EOG091G0G8R.fasta
        ProteinModelSelection.pl EOG091G0G8R.fasta 1> ../../../per_gene/EOG091G0G8R/EOG091G0G8R.best_model 2> ../../../per_gene/EOG091G0G8R/find_best_model.stderr.txt
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/c0c09ee657b1e27f2c5687e0e9aa8d70.simg
[Mon Jul  6 00:03:25 2020]
Finished job 630.
2696 of 3292 steps (82%) done

[Mon Jul  6 00:03:25 2020]
rule infer_single_ML:
    input: per_gene/EOG091G0G8R/EOG091G0G8R.best_model, per_gene/EOG091G0G8R/ALICUT_EOG091G0G8R.clustalo.fasta
    output: per_gene/EOG091G0G8R/EOG091G0G8R.raxml.done
    log: per_gene/EOG091G0G8R/infer_single_ML.stdout.txt, per_gene/EOG091G0G8R/infer_single_ML.stderr.txt
    jobid: 109
    wildcards: BUSCO=EOG091G0G8R
    threads: 2


        cd per_gene/EOG091G0G8R
	count=$(cat ../../per_gene/EOG091G0G8R/ALICUT_EOG091G0G8R.clustalo.fasta | grep ">" | wc -l)
	if [ "$count" -gt 5 ]
        then
		RAxMLmodel=$(cat ../../per_gene/EOG091G0G8R/EOG091G0G8R.best_model | grep "Best" | cut -d ":" -f 2 | tr -d '[:space:]')
                if [ "$(ls -1 | grep "^RAxML" | wc -l)" -ne 0 ]
		then
			rm RAxML*
		fi
        	raxml -f a -T 2 -m PROTGAMMA$RAxMLmodel         	-p 12345 -x 12345 -# 100         	-s ../../per_gene/EOG091G0G8R/ALICUT_EOG091G0G8R.clustalo.fasta -n EOG091G0G8R.clustalo.aln.ALICUT.$RAxMLmodel 		1> ../../per_gene/EOG091G0G8R/infer_single_ML.stdout.txt 2> ../../per_gene/EOG091G0G8R/infer_single_ML.stderr.txt
	else
		echo "fasta file per_gene/EOG091G0G8R/ALICUT_EOG091G0G8R.clustalo.fasta contains fewer than 5 sequences - skipped" > ../../per_gene/EOG091G0G8R/infer_single_ML.stdout.txt
		touch raxml.skipped
	fi
        touch ../../per_gene/EOG091G0G8R/EOG091G0G8R.raxml.done
        
[Mon Jul  6 00:03:26 2020]
Finished job 75.
2697 of 3292 steps (82%) done

[Mon Jul  6 00:03:26 2020]
rule get_seqs:
    input: /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ingroup.txt, /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/outgroup.txt
    output: per_gene/EOG091G0ZUA/EOG091G0ZUA.ingroup.fasta
    log: per_gene/EOG091G0ZUA/get_seqs.stdout.txt, per_gene/EOG091G0ZUA/get_seqs.stderr.txt
    jobid: 2908
    wildcards: BUSCO=EOG091G0ZUA
    threads: 2


	basedir=$(pwd)
        cd per_gene/EOG091G0ZUA
        
        bash $basedir/../scripts/fetch_seqs.sh EOG091G0ZUA /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ingroup.txt /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/outgroup.txt 1> ../../per_gene/EOG091G0ZUA/get_seqs.stdout.txt 2> ../../per_gene/EOG091G0ZUA/get_seqs.stderr.txt
	mv EOG091G0ZUA.fasta $basedir/per_gene/EOG091G0ZUA/EOG091G0ZUA.ingroup.fasta
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/72476f9d9a5bd0627b4d721143a21354.simg
[Mon Jul  6 00:03:29 2020]
Finished job 62.
2698 of 3292 steps (82%) done

[Mon Jul  6 00:03:29 2020]
rule get_seqs:
    input: /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ingroup.txt, /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/outgroup.txt
    output: per_gene/EOG091G05NZ/EOG091G05NZ.ingroup.fasta
    log: per_gene/EOG091G05NZ/get_seqs.stdout.txt, per_gene/EOG091G05NZ/get_seqs.stderr.txt
    jobid: 2546
    wildcards: BUSCO=EOG091G05NZ
    threads: 2


	basedir=$(pwd)
        cd per_gene/EOG091G05NZ
        
        bash $basedir/../scripts/fetch_seqs.sh EOG091G05NZ /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ingroup.txt /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/outgroup.txt 1> ../../per_gene/EOG091G05NZ/get_seqs.stdout.txt 2> ../../per_gene/EOG091G05NZ/get_seqs.stderr.txt
	mv EOG091G05NZ.fasta $basedir/per_gene/EOG091G05NZ/EOG091G05NZ.ingroup.fasta
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/72476f9d9a5bd0627b4d721143a21354.simg
[33mJob counts:
	count	jobs
	1	infer_single_ML
	1[0m
[33m
        cd per_gene/EOG091G0G8R
	count=$(cat ../../per_gene/EOG091G0G8R/ALICUT_EOG091G0G8R.clustalo.fasta | grep ">" | wc -l)
	if [ "$count" -gt 5 ]
        then
		RAxMLmodel=$(cat ../../per_gene/EOG091G0G8R/EOG091G0G8R.best_model | grep "Best" | cut -d ":" -f 2 | tr -d '[:space:]')
                if [ "$(ls -1 | grep "^RAxML" | wc -l)" -ne 0 ]
		then
			rm RAxML*
		fi
        	raxml -f a -T 2 -m PROTGAMMA$RAxMLmodel         	-p 12345 -x 12345 -# 100         	-s ../../per_gene/EOG091G0G8R/ALICUT_EOG091G0G8R.clustalo.fasta -n EOG091G0G8R.clustalo.aln.ALICUT.$RAxMLmodel 		1> ../../per_gene/EOG091G0G8R/infer_single_ML.stdout.txt 2> ../../per_gene/EOG091G0G8R/infer_single_ML.stderr.txt
	else
		echo "fasta file per_gene/EOG091G0G8R/ALICUT_EOG091G0G8R.clustalo.fasta contains fewer than 5 sequences - skipped" > ../../per_gene/EOG091G0G8R/infer_single_ML.stdout.txt
		touch raxml.skipped
	fi
        touch ../../per_gene/EOG091G0G8R/EOG091G0G8R.raxml.done
        [0m
[Mon Jul  6 00:03:40 2020]
Finished job 2908.
2699 of 3292 steps (82%) done

[Mon Jul  6 00:03:40 2020]
rule get_outgroups:
    input: per_gene/EOG091G0ZUA/EOG091G0ZUA.ingroup.fasta
    output: per_gene/EOG091G0ZUA/EOG091G0ZUA.orthodb.fasta, per_gene/EOG091G0ZUA/EOG091G0ZUA.outgroup.fasta
    log: per_gene/EOG091G0ZUA/get_outgroups.stdout.txt, per_gene/EOG091G0ZUA/get_outgroups.stderr.txt
    jobid: 2909
    wildcards: BUSCO=EOG091G0ZUA


        #download fastas from Orhtodb for BUSCO id
        for i in {1..5}
        do
             wget "http://www.orthodb.org/fasta?query=EOG091G0ZUA&level=33208" -O per_gene/EOG091G0ZUA/EOG091G0ZUA.orthodb.fasta 1> per_gene/EOG091G0ZUA/get_outgroups.stdout.txt 2> per_gene/EOG091G0ZUA/get_outgroups.stderr.txt && break || echo -e "try again ($i)" && sleep 15
        done

	#This is quick an dirty for now and just takes the first protein if there is more than one for an outgroup taxon
        bash ../scripts/download_outgroups.sh taxids.txt per_gene/EOG091G0ZUA/EOG091G0ZUA.orthodb.fasta > per_gene/EOG091G0ZUA/EOG091G0ZUA.outgroup.fasta
        
[Mon Jul  6 00:03:41 2020]
Finished job 2909.
2700 of 3292 steps (82%) done

[Mon Jul  6 00:03:41 2020]
rule join_groups:
    input: per_gene/EOG091G0ZUA/EOG091G0ZUA.ingroup.fasta, per_gene/EOG091G0ZUA/EOG091G0ZUA.outgroup.fasta
    output: per_gene/EOG091G0ZUA/EOG091G0ZUA.fasta
    jobid: 2278
    wildcards: BUSCO=EOG091G0ZUA


        cat per_gene/EOG091G0ZUA/EOG091G0ZUA.ingroup.fasta per_gene/EOG091G0ZUA/EOG091G0ZUA.outgroup.fasta > per_gene/EOG091G0ZUA/EOG091G0ZUA.fasta
        
[Mon Jul  6 00:03:41 2020]
Finished job 2278.
2701 of 3292 steps (82%) done

[Mon Jul  6 00:03:41 2020]
rule MSA:
    input: per_gene/EOG091G0ZUA/EOG091G0ZUA.fasta
    output: per_gene/EOG091G0ZUA/EOG091G0ZUA.clustalo.fasta
    log: per_gene/EOG091G0ZUA/MSA.stdout.txt, per_gene/EOG091G0ZUA/MSA.stderr.txt
    jobid: 1676
    wildcards: BUSCO=EOG091G0ZUA
    threads: 2


        clustalo -i per_gene/EOG091G0ZUA/EOG091G0ZUA.fasta -o per_gene/EOG091G0ZUA/EOG091G0ZUA.clustalo.fasta --threads=2 1> per_gene/EOG091G0ZUA/MSA.stdout.txt 2> per_gene/EOG091G0ZUA/MSA.stderr.txt
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/d68c9691725a7401923680874285c430.simg
[Mon Jul  6 00:03:41 2020]
Finished job 1676.
2702 of 3292 steps (82%) done

[Mon Jul  6 00:03:41 2020]
rule score_and_cut:
    input: per_gene/EOG091G0ZUA/EOG091G0ZUA.clustalo.fasta
    output: per_gene/EOG091G0ZUA/ALICUT_EOG091G0ZUA.clustalo.fasta
    jobid: 853
    wildcards: BUSCO=EOG091G0ZUA
    threads: 2


        cd per_gene/EOG091G0ZUA
        Aliscore.pl -N -r 200000000000000000 -i ../../per_gene/EOG091G0ZUA/EOG091G0ZUA.clustalo.fasta &> aliscore.log
        ALICUT.pl -s &> alicut.log
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/63c88c27a0fa300f57066b0ef65fefcb.simg
[Mon Jul  6 00:03:42 2020]
Finished job 2546.
2703 of 3292 steps (82%) done

[Mon Jul  6 00:03:42 2020]
rule get_outgroups:
    input: per_gene/EOG091G05NZ/EOG091G05NZ.ingroup.fasta
    output: per_gene/EOG091G05NZ/EOG091G05NZ.orthodb.fasta, per_gene/EOG091G05NZ/EOG091G05NZ.outgroup.fasta
    log: per_gene/EOG091G05NZ/get_outgroups.stdout.txt, per_gene/EOG091G05NZ/get_outgroups.stderr.txt
    jobid: 2547
    wildcards: BUSCO=EOG091G05NZ


        #download fastas from Orhtodb for BUSCO id
        for i in {1..5}
        do
             wget "http://www.orthodb.org/fasta?query=EOG091G05NZ&level=33208" -O per_gene/EOG091G05NZ/EOG091G05NZ.orthodb.fasta 1> per_gene/EOG091G05NZ/get_outgroups.stdout.txt 2> per_gene/EOG091G05NZ/get_outgroups.stderr.txt && break || echo -e "try again ($i)" && sleep 15
        done

	#This is quick an dirty for now and just takes the first protein if there is more than one for an outgroup taxon
        bash ../scripts/download_outgroups.sh taxids.txt per_gene/EOG091G05NZ/EOG091G05NZ.orthodb.fasta > per_gene/EOG091G05NZ/EOG091G05NZ.outgroup.fasta
        
[Mon Jul  6 00:03:43 2020]
Finished job 2547.
2704 of 3292 steps (82%) done

[Mon Jul  6 00:03:43 2020]
rule join_groups:
    input: per_gene/EOG091G05NZ/EOG091G05NZ.ingroup.fasta, per_gene/EOG091G05NZ/EOG091G05NZ.outgroup.fasta
    output: per_gene/EOG091G05NZ/EOG091G05NZ.fasta
    jobid: 2097
    wildcards: BUSCO=EOG091G05NZ


        cat per_gene/EOG091G05NZ/EOG091G05NZ.ingroup.fasta per_gene/EOG091G05NZ/EOG091G05NZ.outgroup.fasta > per_gene/EOG091G05NZ/EOG091G05NZ.fasta
        
[Mon Jul  6 00:03:43 2020]
Finished job 2097.
2705 of 3292 steps (82%) done

[Mon Jul  6 00:03:43 2020]
rule MSA:
    input: per_gene/EOG091G05NZ/EOG091G05NZ.fasta
    output: per_gene/EOG091G05NZ/EOG091G05NZ.clustalo.fasta
    log: per_gene/EOG091G05NZ/MSA.stdout.txt, per_gene/EOG091G05NZ/MSA.stderr.txt
    jobid: 1314
    wildcards: BUSCO=EOG091G05NZ
    threads: 2


        clustalo -i per_gene/EOG091G05NZ/EOG091G05NZ.fasta -o per_gene/EOG091G05NZ/EOG091G05NZ.clustalo.fasta --threads=2 1> per_gene/EOG091G05NZ/MSA.stdout.txt 2> per_gene/EOG091G05NZ/MSA.stderr.txt
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/d68c9691725a7401923680874285c430.simg
[Mon Jul  6 00:03:45 2020]
Finished job 246.
2706 of 3292 steps (82%) done

[Mon Jul  6 00:03:45 2020]
rule get_seqs:
    input: /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ingroup.txt, /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/outgroup.txt
    output: per_gene/EOG091G0EH8/EOG091G0EH8.ingroup.fasta
    log: per_gene/EOG091G0EH8/get_seqs.stdout.txt, per_gene/EOG091G0EH8/get_seqs.stderr.txt
    jobid: 2668
    wildcards: BUSCO=EOG091G0EH8
    threads: 2


	basedir=$(pwd)
        cd per_gene/EOG091G0EH8
        
        bash $basedir/../scripts/fetch_seqs.sh EOG091G0EH8 /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ingroup.txt /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/outgroup.txt 1> ../../per_gene/EOG091G0EH8/get_seqs.stdout.txt 2> ../../per_gene/EOG091G0EH8/get_seqs.stderr.txt
	mv EOG091G0EH8.fasta $basedir/per_gene/EOG091G0EH8/EOG091G0EH8.ingroup.fasta
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/72476f9d9a5bd0627b4d721143a21354.simg
[Mon Jul  6 00:03:45 2020]
Finished job 1314.
2707 of 3292 steps (82%) done

[Mon Jul  6 00:03:45 2020]
rule score_and_cut:
    input: per_gene/EOG091G05NZ/EOG091G05NZ.clustalo.fasta
    output: per_gene/EOG091G05NZ/ALICUT_EOG091G05NZ.clustalo.fasta
    jobid: 491
    wildcards: BUSCO=EOG091G05NZ
    threads: 2


        cd per_gene/EOG091G05NZ
        Aliscore.pl -N -r 200000000000000000 -i ../../per_gene/EOG091G05NZ/EOG091G05NZ.clustalo.fasta &> aliscore.log
        ALICUT.pl -s &> alicut.log
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/63c88c27a0fa300f57066b0ef65fefcb.simg
[Mon Jul  6 00:03:51 2020]
Finished job 853.
2708 of 3292 steps (82%) done

[Mon Jul  6 00:03:51 2020]
rule remove_empty:
    input: per_gene/EOG091G0ZUA/ALICUT_EOG091G0ZUA.clustalo.fasta
    output: per_gene/EOG091G0ZUA/empty_check.done
    jobid: 1675
    wildcards: BUSCO=EOG091G0ZUA


         if [ "$(cat per_gene/EOG091G0ZUA/ALICUT_EOG091G0ZUA.clustalo.fasta | grep -v ">" | sed 's/-//g' | grep "^$" | wc -l)" -gt 0 ]
         then
              cp per_gene/EOG091G0ZUA/ALICUT_EOG091G0ZUA.clustalo.fasta per_gene/EOG091G0ZUA/ALICUT_EOG091G0ZUA.clustalo.fasta.backup
              bash ../scripts/remove_empty.sh per_gene/EOG091G0ZUA/ALICUT_EOG091G0ZUA.clustalo.fasta.backup > per_gene/EOG091G0ZUA/ALICUT_EOG091G0ZUA.clustalo.fasta
         fi
         touch per_gene/EOG091G0ZUA/empty_check.done
         
[Mon Jul  6 00:03:51 2020]
Finished job 1675.
2709 of 3292 steps (82%) done

[Mon Jul  6 00:03:51 2020]
rule find_best_model:
    input: per_gene/EOG091G0ZUA/ALICUT_EOG091G0ZUA.clustalo.fasta, per_gene/EOG091G0ZUA/empty_check.done
    output: per_gene/EOG091G0ZUA/EOG091G0ZUA.best_model
    log: per_gene/EOG091G0ZUA/find_best_model.stderr.txt
    jobid: 852
    wildcards: BUSCO=EOG091G0ZUA
    threads: 2


        cd per_gene/EOG091G0ZUA
        if [ ! -d find_best_model ]
        then
            mkdir find_best_model
        fi
        cd find_best_model
        ln -s ../../../per_gene/EOG091G0ZUA/ALICUT_EOG091G0ZUA.clustalo.fasta EOG091G0ZUA.fasta
        ProteinModelSelection.pl EOG091G0ZUA.fasta 1> ../../../per_gene/EOG091G0ZUA/EOG091G0ZUA.best_model 2> ../../../per_gene/EOG091G0ZUA/find_best_model.stderr.txt
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/c0c09ee657b1e27f2c5687e0e9aa8d70.simg
[Mon Jul  6 00:03:56 2020]
Finished job 491.
2710 of 3292 steps (82%) done

[Mon Jul  6 00:03:56 2020]
rule remove_empty:
    input: per_gene/EOG091G05NZ/ALICUT_EOG091G05NZ.clustalo.fasta
    output: per_gene/EOG091G05NZ/empty_check.done
    jobid: 1313
    wildcards: BUSCO=EOG091G05NZ


         if [ "$(cat per_gene/EOG091G05NZ/ALICUT_EOG091G05NZ.clustalo.fasta | grep -v ">" | sed 's/-//g' | grep "^$" | wc -l)" -gt 0 ]
         then
              cp per_gene/EOG091G05NZ/ALICUT_EOG091G05NZ.clustalo.fasta per_gene/EOG091G05NZ/ALICUT_EOG091G05NZ.clustalo.fasta.backup
              bash ../scripts/remove_empty.sh per_gene/EOG091G05NZ/ALICUT_EOG091G05NZ.clustalo.fasta.backup > per_gene/EOG091G05NZ/ALICUT_EOG091G05NZ.clustalo.fasta
         fi
         touch per_gene/EOG091G05NZ/empty_check.done
         
[Mon Jul  6 00:03:56 2020]
Finished job 1313.
2711 of 3292 steps (82%) done

[Mon Jul  6 00:03:56 2020]
rule find_best_model:
    input: per_gene/EOG091G05NZ/ALICUT_EOG091G05NZ.clustalo.fasta, per_gene/EOG091G05NZ/empty_check.done
    output: per_gene/EOG091G05NZ/EOG091G05NZ.best_model
    log: per_gene/EOG091G05NZ/find_best_model.stderr.txt
    jobid: 490
    wildcards: BUSCO=EOG091G05NZ
    threads: 2


        cd per_gene/EOG091G05NZ
        if [ ! -d find_best_model ]
        then
            mkdir find_best_model
        fi
        cd find_best_model
        ln -s ../../../per_gene/EOG091G05NZ/ALICUT_EOG091G05NZ.clustalo.fasta EOG091G05NZ.fasta
        ProteinModelSelection.pl EOG091G05NZ.fasta 1> ../../../per_gene/EOG091G05NZ/EOG091G05NZ.best_model 2> ../../../per_gene/EOG091G05NZ/find_best_model.stderr.txt
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/c0c09ee657b1e27f2c5687e0e9aa8d70.simg
[Mon Jul  6 00:03:57 2020]
Finished job 2668.
2712 of 3292 steps (82%) done

[Mon Jul  6 00:03:58 2020]
rule get_outgroups:
    input: per_gene/EOG091G0EH8/EOG091G0EH8.ingroup.fasta
    output: per_gene/EOG091G0EH8/EOG091G0EH8.orthodb.fasta, per_gene/EOG091G0EH8/EOG091G0EH8.outgroup.fasta
    log: per_gene/EOG091G0EH8/get_outgroups.stdout.txt, per_gene/EOG091G0EH8/get_outgroups.stderr.txt
    jobid: 2669
    wildcards: BUSCO=EOG091G0EH8


        #download fastas from Orhtodb for BUSCO id
        for i in {1..5}
        do
             wget "http://www.orthodb.org/fasta?query=EOG091G0EH8&level=33208" -O per_gene/EOG091G0EH8/EOG091G0EH8.orthodb.fasta 1> per_gene/EOG091G0EH8/get_outgroups.stdout.txt 2> per_gene/EOG091G0EH8/get_outgroups.stderr.txt && break || echo -e "try again ($i)" && sleep 15
        done

	#This is quick an dirty for now and just takes the first protein if there is more than one for an outgroup taxon
        bash ../scripts/download_outgroups.sh taxids.txt per_gene/EOG091G0EH8/EOG091G0EH8.orthodb.fasta > per_gene/EOG091G0EH8/EOG091G0EH8.outgroup.fasta
        
[Mon Jul  6 00:03:58 2020]
Finished job 2669.
2713 of 3292 steps (82%) done

[Mon Jul  6 00:03:58 2020]
rule join_groups:
    input: per_gene/EOG091G0EH8/EOG091G0EH8.ingroup.fasta, per_gene/EOG091G0EH8/EOG091G0EH8.outgroup.fasta
    output: per_gene/EOG091G0EH8/EOG091G0EH8.fasta
    jobid: 2158
    wildcards: BUSCO=EOG091G0EH8


        cat per_gene/EOG091G0EH8/EOG091G0EH8.ingroup.fasta per_gene/EOG091G0EH8/EOG091G0EH8.outgroup.fasta > per_gene/EOG091G0EH8/EOG091G0EH8.fasta
        
[Mon Jul  6 00:03:58 2020]
Finished job 2158.
2714 of 3292 steps (82%) done

[Mon Jul  6 00:03:58 2020]
rule MSA:
    input: per_gene/EOG091G0EH8/EOG091G0EH8.fasta
    output: per_gene/EOG091G0EH8/EOG091G0EH8.clustalo.fasta
    log: per_gene/EOG091G0EH8/MSA.stdout.txt, per_gene/EOG091G0EH8/MSA.stderr.txt
    jobid: 1436
    wildcards: BUSCO=EOG091G0EH8
    threads: 2


        clustalo -i per_gene/EOG091G0EH8/EOG091G0EH8.fasta -o per_gene/EOG091G0EH8/EOG091G0EH8.clustalo.fasta --threads=2 1> per_gene/EOG091G0EH8/MSA.stdout.txt 2> per_gene/EOG091G0EH8/MSA.stderr.txt
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/d68c9691725a7401923680874285c430.simg
[Mon Jul  6 00:03:59 2020]
Finished job 1436.
2715 of 3292 steps (82%) done

[Mon Jul  6 00:03:59 2020]
rule score_and_cut:
    input: per_gene/EOG091G0EH8/EOG091G0EH8.clustalo.fasta
    output: per_gene/EOG091G0EH8/ALICUT_EOG091G0EH8.clustalo.fasta
    jobid: 613
    wildcards: BUSCO=EOG091G0EH8
    threads: 2


        cd per_gene/EOG091G0EH8
        Aliscore.pl -N -r 200000000000000000 -i ../../per_gene/EOG091G0EH8/EOG091G0EH8.clustalo.fasta &> aliscore.log
        ALICUT.pl -s &> alicut.log
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/63c88c27a0fa300f57066b0ef65fefcb.simg
[Mon Jul  6 00:04:09 2020]
Finished job 613.
2716 of 3292 steps (83%) done

[Mon Jul  6 00:04:09 2020]
rule remove_empty:
    input: per_gene/EOG091G0EH8/ALICUT_EOG091G0EH8.clustalo.fasta
    output: per_gene/EOG091G0EH8/empty_check.done
    jobid: 1435
    wildcards: BUSCO=EOG091G0EH8


         if [ "$(cat per_gene/EOG091G0EH8/ALICUT_EOG091G0EH8.clustalo.fasta | grep -v ">" | sed 's/-//g' | grep "^$" | wc -l)" -gt 0 ]
         then
              cp per_gene/EOG091G0EH8/ALICUT_EOG091G0EH8.clustalo.fasta per_gene/EOG091G0EH8/ALICUT_EOG091G0EH8.clustalo.fasta.backup
              bash ../scripts/remove_empty.sh per_gene/EOG091G0EH8/ALICUT_EOG091G0EH8.clustalo.fasta.backup > per_gene/EOG091G0EH8/ALICUT_EOG091G0EH8.clustalo.fasta
         fi
         touch per_gene/EOG091G0EH8/empty_check.done
         
[Mon Jul  6 00:04:09 2020]
Finished job 1435.
2717 of 3292 steps (83%) done

[Mon Jul  6 00:04:09 2020]
rule find_best_model:
    input: per_gene/EOG091G0EH8/ALICUT_EOG091G0EH8.clustalo.fasta, per_gene/EOG091G0EH8/empty_check.done
    output: per_gene/EOG091G0EH8/EOG091G0EH8.best_model
    log: per_gene/EOG091G0EH8/find_best_model.stderr.txt
    jobid: 612
    wildcards: BUSCO=EOG091G0EH8
    threads: 2


        cd per_gene/EOG091G0EH8
        if [ ! -d find_best_model ]
        then
            mkdir find_best_model
        fi
        cd find_best_model
        ln -s ../../../per_gene/EOG091G0EH8/ALICUT_EOG091G0EH8.clustalo.fasta EOG091G0EH8.fasta
        ProteinModelSelection.pl EOG091G0EH8.fasta 1> ../../../per_gene/EOG091G0EH8/EOG091G0EH8.best_model 2> ../../../per_gene/EOG091G0EH8/find_best_model.stderr.txt
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/c0c09ee657b1e27f2c5687e0e9aa8d70.simg
[Mon Jul  6 00:04:13 2020]
Finished job 852.
2718 of 3292 steps (83%) done

[Mon Jul  6 00:04:13 2020]
rule infer_single_ML:
    input: per_gene/EOG091G0ZUA/EOG091G0ZUA.best_model, per_gene/EOG091G0ZUA/ALICUT_EOG091G0ZUA.clustalo.fasta
    output: per_gene/EOG091G0ZUA/EOG091G0ZUA.raxml.done
    log: per_gene/EOG091G0ZUA/infer_single_ML.stdout.txt, per_gene/EOG091G0ZUA/infer_single_ML.stderr.txt
    jobid: 220
    wildcards: BUSCO=EOG091G0ZUA
    threads: 2


        cd per_gene/EOG091G0ZUA
	count=$(cat ../../per_gene/EOG091G0ZUA/ALICUT_EOG091G0ZUA.clustalo.fasta | grep ">" | wc -l)
	if [ "$count" -gt 5 ]
        then
		RAxMLmodel=$(cat ../../per_gene/EOG091G0ZUA/EOG091G0ZUA.best_model | grep "Best" | cut -d ":" -f 2 | tr -d '[:space:]')
                if [ "$(ls -1 | grep "^RAxML" | wc -l)" -ne 0 ]
		then
			rm RAxML*
		fi
        	raxml -f a -T 2 -m PROTGAMMA$RAxMLmodel         	-p 12345 -x 12345 -# 100         	-s ../../per_gene/EOG091G0ZUA/ALICUT_EOG091G0ZUA.clustalo.fasta -n EOG091G0ZUA.clustalo.aln.ALICUT.$RAxMLmodel 		1> ../../per_gene/EOG091G0ZUA/infer_single_ML.stdout.txt 2> ../../per_gene/EOG091G0ZUA/infer_single_ML.stderr.txt
	else
		echo "fasta file per_gene/EOG091G0ZUA/ALICUT_EOG091G0ZUA.clustalo.fasta contains fewer than 5 sequences - skipped" > ../../per_gene/EOG091G0ZUA/infer_single_ML.stdout.txt
		touch raxml.skipped
	fi
        touch ../../per_gene/EOG091G0ZUA/EOG091G0ZUA.raxml.done
        
[33mJob counts:
	count	jobs
	1	infer_single_ML
	1[0m
[33m
        cd per_gene/EOG091G0ZUA
	count=$(cat ../../per_gene/EOG091G0ZUA/ALICUT_EOG091G0ZUA.clustalo.fasta | grep ">" | wc -l)
	if [ "$count" -gt 5 ]
        then
		RAxMLmodel=$(cat ../../per_gene/EOG091G0ZUA/EOG091G0ZUA.best_model | grep "Best" | cut -d ":" -f 2 | tr -d '[:space:]')
                if [ "$(ls -1 | grep "^RAxML" | wc -l)" -ne 0 ]
		then
			rm RAxML*
		fi
        	raxml -f a -T 2 -m PROTGAMMA$RAxMLmodel         	-p 12345 -x 12345 -# 100         	-s ../../per_gene/EOG091G0ZUA/ALICUT_EOG091G0ZUA.clustalo.fasta -n EOG091G0ZUA.clustalo.aln.ALICUT.$RAxMLmodel 		1> ../../per_gene/EOG091G0ZUA/infer_single_ML.stdout.txt 2> ../../per_gene/EOG091G0ZUA/infer_single_ML.stderr.txt
	else
		echo "fasta file per_gene/EOG091G0ZUA/ALICUT_EOG091G0ZUA.clustalo.fasta contains fewer than 5 sequences - skipped" > ../../per_gene/EOG091G0ZUA/infer_single_ML.stdout.txt
		touch raxml.skipped
	fi
        touch ../../per_gene/EOG091G0ZUA/EOG091G0ZUA.raxml.done
        [0m
[Mon Jul  6 00:04:24 2020]
Finished job 408.
2719 of 3292 steps (83%) done

[Mon Jul  6 00:04:24 2020]
rule get_seqs:
    input: /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ingroup.txt, /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/outgroup.txt
    output: per_gene/EOG091G03LI/EOG091G03LI.ingroup.fasta
    log: per_gene/EOG091G03LI/get_seqs.stdout.txt, per_gene/EOG091G03LI/get_seqs.stderr.txt
    jobid: 3124
    wildcards: BUSCO=EOG091G03LI
    threads: 2


	basedir=$(pwd)
        cd per_gene/EOG091G03LI
        
        bash $basedir/../scripts/fetch_seqs.sh EOG091G03LI /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ingroup.txt /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/outgroup.txt 1> ../../per_gene/EOG091G03LI/get_seqs.stdout.txt 2> ../../per_gene/EOG091G03LI/get_seqs.stderr.txt
	mv EOG091G03LI.fasta $basedir/per_gene/EOG091G03LI/EOG091G03LI.ingroup.fasta
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/72476f9d9a5bd0627b4d721143a21354.simg
[Mon Jul  6 00:04:36 2020]
Finished job 40.
2720 of 3292 steps (83%) done

[Mon Jul  6 00:04:36 2020]
rule get_seqs:
    input: /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ingroup.txt, /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/outgroup.txt
    output: per_gene/EOG091G0PD3/EOG091G0PD3.ingroup.fasta
    log: per_gene/EOG091G0PD3/get_seqs.stdout.txt, per_gene/EOG091G0PD3/get_seqs.stderr.txt
    jobid: 3242
    wildcards: BUSCO=EOG091G0PD3
    threads: 2


	basedir=$(pwd)
        cd per_gene/EOG091G0PD3
        
        bash $basedir/../scripts/fetch_seqs.sh EOG091G0PD3 /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ingroup.txt /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/outgroup.txt 1> ../../per_gene/EOG091G0PD3/get_seqs.stdout.txt 2> ../../per_gene/EOG091G0PD3/get_seqs.stderr.txt
	mv EOG091G0PD3.fasta $basedir/per_gene/EOG091G0PD3/EOG091G0PD3.ingroup.fasta
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/72476f9d9a5bd0627b4d721143a21354.simg
[Mon Jul  6 00:04:37 2020]
Finished job 3124.
2721 of 3292 steps (83%) done

[Mon Jul  6 00:04:37 2020]
rule get_outgroups:
    input: per_gene/EOG091G03LI/EOG091G03LI.ingroup.fasta
    output: per_gene/EOG091G03LI/EOG091G03LI.orthodb.fasta, per_gene/EOG091G03LI/EOG091G03LI.outgroup.fasta
    log: per_gene/EOG091G03LI/get_outgroups.stdout.txt, per_gene/EOG091G03LI/get_outgroups.stderr.txt
    jobid: 3125
    wildcards: BUSCO=EOG091G03LI


        #download fastas from Orhtodb for BUSCO id
        for i in {1..5}
        do
             wget "http://www.orthodb.org/fasta?query=EOG091G03LI&level=33208" -O per_gene/EOG091G03LI/EOG091G03LI.orthodb.fasta 1> per_gene/EOG091G03LI/get_outgroups.stdout.txt 2> per_gene/EOG091G03LI/get_outgroups.stderr.txt && break || echo -e "try again ($i)" && sleep 15
        done

	#This is quick an dirty for now and just takes the first protein if there is more than one for an outgroup taxon
        bash ../scripts/download_outgroups.sh taxids.txt per_gene/EOG091G03LI/EOG091G03LI.orthodb.fasta > per_gene/EOG091G03LI/EOG091G03LI.outgroup.fasta
        
[Mon Jul  6 00:04:38 2020]
Finished job 3125.
2722 of 3292 steps (83%) done

[Mon Jul  6 00:04:38 2020]
rule join_groups:
    input: per_gene/EOG091G03LI/EOG091G03LI.ingroup.fasta, per_gene/EOG091G03LI/EOG091G03LI.outgroup.fasta
    output: per_gene/EOG091G03LI/EOG091G03LI.fasta
    jobid: 2386
    wildcards: BUSCO=EOG091G03LI


        cat per_gene/EOG091G03LI/EOG091G03LI.ingroup.fasta per_gene/EOG091G03LI/EOG091G03LI.outgroup.fasta > per_gene/EOG091G03LI/EOG091G03LI.fasta
        
[Mon Jul  6 00:04:38 2020]
Finished job 2386.
2723 of 3292 steps (83%) done

[Mon Jul  6 00:04:38 2020]
rule MSA:
    input: per_gene/EOG091G03LI/EOG091G03LI.fasta
    output: per_gene/EOG091G03LI/EOG091G03LI.clustalo.fasta
    log: per_gene/EOG091G03LI/MSA.stdout.txt, per_gene/EOG091G03LI/MSA.stderr.txt
    jobid: 1892
    wildcards: BUSCO=EOG091G03LI
    threads: 2


        clustalo -i per_gene/EOG091G03LI/EOG091G03LI.fasta -o per_gene/EOG091G03LI/EOG091G03LI.clustalo.fasta --threads=2 1> per_gene/EOG091G03LI/MSA.stdout.txt 2> per_gene/EOG091G03LI/MSA.stderr.txt
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/d68c9691725a7401923680874285c430.simg
[Mon Jul  6 00:04:41 2020]
Finished job 1892.
2724 of 3292 steps (83%) done

[Mon Jul  6 00:04:41 2020]
rule score_and_cut:
    input: per_gene/EOG091G03LI/EOG091G03LI.clustalo.fasta
    output: per_gene/EOG091G03LI/ALICUT_EOG091G03LI.clustalo.fasta
    jobid: 1069
    wildcards: BUSCO=EOG091G03LI
    threads: 2


        cd per_gene/EOG091G03LI
        Aliscore.pl -N -r 200000000000000000 -i ../../per_gene/EOG091G03LI/EOG091G03LI.clustalo.fasta &> aliscore.log
        ALICUT.pl -s &> alicut.log
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/63c88c27a0fa300f57066b0ef65fefcb.simg
[Mon Jul  6 00:04:43 2020]
Finished job 612.
2725 of 3292 steps (83%) done

[Mon Jul  6 00:04:43 2020]
rule infer_single_ML:
    input: per_gene/EOG091G0EH8/EOG091G0EH8.best_model, per_gene/EOG091G0EH8/ALICUT_EOG091G0EH8.clustalo.fasta
    output: per_gene/EOG091G0EH8/EOG091G0EH8.raxml.done
    log: per_gene/EOG091G0EH8/infer_single_ML.stdout.txt, per_gene/EOG091G0EH8/infer_single_ML.stderr.txt
    jobid: 100
    wildcards: BUSCO=EOG091G0EH8
    threads: 2


        cd per_gene/EOG091G0EH8
	count=$(cat ../../per_gene/EOG091G0EH8/ALICUT_EOG091G0EH8.clustalo.fasta | grep ">" | wc -l)
	if [ "$count" -gt 5 ]
        then
		RAxMLmodel=$(cat ../../per_gene/EOG091G0EH8/EOG091G0EH8.best_model | grep "Best" | cut -d ":" -f 2 | tr -d '[:space:]')
                if [ "$(ls -1 | grep "^RAxML" | wc -l)" -ne 0 ]
		then
			rm RAxML*
		fi
        	raxml -f a -T 2 -m PROTGAMMA$RAxMLmodel         	-p 12345 -x 12345 -# 100         	-s ../../per_gene/EOG091G0EH8/ALICUT_EOG091G0EH8.clustalo.fasta -n EOG091G0EH8.clustalo.aln.ALICUT.$RAxMLmodel 		1> ../../per_gene/EOG091G0EH8/infer_single_ML.stdout.txt 2> ../../per_gene/EOG091G0EH8/infer_single_ML.stderr.txt
	else
		echo "fasta file per_gene/EOG091G0EH8/ALICUT_EOG091G0EH8.clustalo.fasta contains fewer than 5 sequences - skipped" > ../../per_gene/EOG091G0EH8/infer_single_ML.stdout.txt
		touch raxml.skipped
	fi
        touch ../../per_gene/EOG091G0EH8/EOG091G0EH8.raxml.done
        
[33mJob counts:
	count	jobs
	1	infer_single_ML
	1[0m
[33m
        cd per_gene/EOG091G0EH8
	count=$(cat ../../per_gene/EOG091G0EH8/ALICUT_EOG091G0EH8.clustalo.fasta | grep ">" | wc -l)
	if [ "$count" -gt 5 ]
        then
		RAxMLmodel=$(cat ../../per_gene/EOG091G0EH8/EOG091G0EH8.best_model | grep "Best" | cut -d ":" -f 2 | tr -d '[:space:]')
                if [ "$(ls -1 | grep "^RAxML" | wc -l)" -ne 0 ]
		then
			rm RAxML*
		fi
        	raxml -f a -T 2 -m PROTGAMMA$RAxMLmodel         	-p 12345 -x 12345 -# 100         	-s ../../per_gene/EOG091G0EH8/ALICUT_EOG091G0EH8.clustalo.fasta -n EOG091G0EH8.clustalo.aln.ALICUT.$RAxMLmodel 		1> ../../per_gene/EOG091G0EH8/infer_single_ML.stdout.txt 2> ../../per_gene/EOG091G0EH8/infer_single_ML.stderr.txt
	else
		echo "fasta file per_gene/EOG091G0EH8/ALICUT_EOG091G0EH8.clustalo.fasta contains fewer than 5 sequences - skipped" > ../../per_gene/EOG091G0EH8/infer_single_ML.stdout.txt
		touch raxml.skipped
	fi
        touch ../../per_gene/EOG091G0EH8/EOG091G0EH8.raxml.done
        [0m
[Mon Jul  6 00:04:49 2020]
Finished job 3242.
2726 of 3292 steps (83%) done

[Mon Jul  6 00:04:49 2020]
rule get_outgroups:
    input: per_gene/EOG091G0PD3/EOG091G0PD3.ingroup.fasta
    output: per_gene/EOG091G0PD3/EOG091G0PD3.orthodb.fasta, per_gene/EOG091G0PD3/EOG091G0PD3.outgroup.fasta
    log: per_gene/EOG091G0PD3/get_outgroups.stdout.txt, per_gene/EOG091G0PD3/get_outgroups.stderr.txt
    jobid: 3243
    wildcards: BUSCO=EOG091G0PD3


        #download fastas from Orhtodb for BUSCO id
        for i in {1..5}
        do
             wget "http://www.orthodb.org/fasta?query=EOG091G0PD3&level=33208" -O per_gene/EOG091G0PD3/EOG091G0PD3.orthodb.fasta 1> per_gene/EOG091G0PD3/get_outgroups.stdout.txt 2> per_gene/EOG091G0PD3/get_outgroups.stderr.txt && break || echo -e "try again ($i)" && sleep 15
        done

	#This is quick an dirty for now and just takes the first protein if there is more than one for an outgroup taxon
        bash ../scripts/download_outgroups.sh taxids.txt per_gene/EOG091G0PD3/EOG091G0PD3.orthodb.fasta > per_gene/EOG091G0PD3/EOG091G0PD3.outgroup.fasta
        
[Mon Jul  6 00:04:50 2020]
Finished job 3243.
2727 of 3292 steps (83%) done

[Mon Jul  6 00:04:50 2020]
rule join_groups:
    input: per_gene/EOG091G0PD3/EOG091G0PD3.ingroup.fasta, per_gene/EOG091G0PD3/EOG091G0PD3.outgroup.fasta
    output: per_gene/EOG091G0PD3/EOG091G0PD3.fasta
    jobid: 2445
    wildcards: BUSCO=EOG091G0PD3


        cat per_gene/EOG091G0PD3/EOG091G0PD3.ingroup.fasta per_gene/EOG091G0PD3/EOG091G0PD3.outgroup.fasta > per_gene/EOG091G0PD3/EOG091G0PD3.fasta
        
[Mon Jul  6 00:04:50 2020]
Finished job 2445.
2728 of 3292 steps (83%) done

[Mon Jul  6 00:04:50 2020]
rule MSA:
    input: per_gene/EOG091G0PD3/EOG091G0PD3.fasta
    output: per_gene/EOG091G0PD3/EOG091G0PD3.clustalo.fasta
    log: per_gene/EOG091G0PD3/MSA.stdout.txt, per_gene/EOG091G0PD3/MSA.stderr.txt
    jobid: 2010
    wildcards: BUSCO=EOG091G0PD3
    threads: 2


        clustalo -i per_gene/EOG091G0PD3/EOG091G0PD3.fasta -o per_gene/EOG091G0PD3/EOG091G0PD3.clustalo.fasta --threads=2 1> per_gene/EOG091G0PD3/MSA.stdout.txt 2> per_gene/EOG091G0PD3/MSA.stderr.txt
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/d68c9691725a7401923680874285c430.simg
[Mon Jul  6 00:04:50 2020]
Finished job 2010.
2729 of 3292 steps (83%) done

[Mon Jul  6 00:04:50 2020]
rule score_and_cut:
    input: per_gene/EOG091G0PD3/EOG091G0PD3.clustalo.fasta
    output: per_gene/EOG091G0PD3/ALICUT_EOG091G0PD3.clustalo.fasta
    jobid: 1187
    wildcards: BUSCO=EOG091G0PD3
    threads: 2


        cd per_gene/EOG091G0PD3
        Aliscore.pl -N -r 200000000000000000 -i ../../per_gene/EOG091G0PD3/EOG091G0PD3.clustalo.fasta &> aliscore.log
        ALICUT.pl -s &> alicut.log
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/63c88c27a0fa300f57066b0ef65fefcb.simg
[Mon Jul  6 00:04:51 2020]
Finished job 1069.
2730 of 3292 steps (83%) done

[Mon Jul  6 00:04:51 2020]
rule remove_empty:
    input: per_gene/EOG091G03LI/ALICUT_EOG091G03LI.clustalo.fasta
    output: per_gene/EOG091G03LI/empty_check.done
    jobid: 1891
    wildcards: BUSCO=EOG091G03LI


         if [ "$(cat per_gene/EOG091G03LI/ALICUT_EOG091G03LI.clustalo.fasta | grep -v ">" | sed 's/-//g' | grep "^$" | wc -l)" -gt 0 ]
         then
              cp per_gene/EOG091G03LI/ALICUT_EOG091G03LI.clustalo.fasta per_gene/EOG091G03LI/ALICUT_EOG091G03LI.clustalo.fasta.backup
              bash ../scripts/remove_empty.sh per_gene/EOG091G03LI/ALICUT_EOG091G03LI.clustalo.fasta.backup > per_gene/EOG091G03LI/ALICUT_EOG091G03LI.clustalo.fasta
         fi
         touch per_gene/EOG091G03LI/empty_check.done
         
[Mon Jul  6 00:04:51 2020]
Finished job 1891.
2731 of 3292 steps (83%) done

[Mon Jul  6 00:04:51 2020]
rule find_best_model:
    input: per_gene/EOG091G03LI/ALICUT_EOG091G03LI.clustalo.fasta, per_gene/EOG091G03LI/empty_check.done
    output: per_gene/EOG091G03LI/EOG091G03LI.best_model
    log: per_gene/EOG091G03LI/find_best_model.stderr.txt
    jobid: 1068
    wildcards: BUSCO=EOG091G03LI
    threads: 2


        cd per_gene/EOG091G03LI
        if [ ! -d find_best_model ]
        then
            mkdir find_best_model
        fi
        cd find_best_model
        ln -s ../../../per_gene/EOG091G03LI/ALICUT_EOG091G03LI.clustalo.fasta EOG091G03LI.fasta
        ProteinModelSelection.pl EOG091G03LI.fasta 1> ../../../per_gene/EOG091G03LI/EOG091G03LI.best_model 2> ../../../per_gene/EOG091G03LI/find_best_model.stderr.txt
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/c0c09ee657b1e27f2c5687e0e9aa8d70.simg
[Mon Jul  6 00:04:52 2020]
Finished job 56.
2732 of 3292 steps (83%) done

[Mon Jul  6 00:04:52 2020]
rule get_seqs:
    input: /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ingroup.txt, /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/outgroup.txt
    output: per_gene/EOG091G0CNT/EOG091G0CNT.ingroup.fasta
    log: per_gene/EOG091G0CNT/get_seqs.stdout.txt, per_gene/EOG091G0CNT/get_seqs.stderr.txt
    jobid: 2650
    wildcards: BUSCO=EOG091G0CNT
    threads: 2


	basedir=$(pwd)
        cd per_gene/EOG091G0CNT
        
        bash $basedir/../scripts/fetch_seqs.sh EOG091G0CNT /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ingroup.txt /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/outgroup.txt 1> ../../per_gene/EOG091G0CNT/get_seqs.stdout.txt 2> ../../per_gene/EOG091G0CNT/get_seqs.stderr.txt
	mv EOG091G0CNT.fasta $basedir/per_gene/EOG091G0CNT/EOG091G0CNT.ingroup.fasta
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/72476f9d9a5bd0627b4d721143a21354.simg
[Mon Jul  6 00:04:56 2020]
Finished job 490.
2733 of 3292 steps (83%) done

[Mon Jul  6 00:04:56 2020]
rule infer_single_ML:
    input: per_gene/EOG091G05NZ/EOG091G05NZ.best_model, per_gene/EOG091G05NZ/ALICUT_EOG091G05NZ.clustalo.fasta
    output: per_gene/EOG091G05NZ/EOG091G05NZ.raxml.done
    log: per_gene/EOG091G05NZ/infer_single_ML.stdout.txt, per_gene/EOG091G05NZ/infer_single_ML.stderr.txt
    jobid: 39
    wildcards: BUSCO=EOG091G05NZ
    threads: 2


        cd per_gene/EOG091G05NZ
	count=$(cat ../../per_gene/EOG091G05NZ/ALICUT_EOG091G05NZ.clustalo.fasta | grep ">" | wc -l)
	if [ "$count" -gt 5 ]
        then
		RAxMLmodel=$(cat ../../per_gene/EOG091G05NZ/EOG091G05NZ.best_model | grep "Best" | cut -d ":" -f 2 | tr -d '[:space:]')
                if [ "$(ls -1 | grep "^RAxML" | wc -l)" -ne 0 ]
		then
			rm RAxML*
		fi
        	raxml -f a -T 2 -m PROTGAMMA$RAxMLmodel         	-p 12345 -x 12345 -# 100         	-s ../../per_gene/EOG091G05NZ/ALICUT_EOG091G05NZ.clustalo.fasta -n EOG091G05NZ.clustalo.aln.ALICUT.$RAxMLmodel 		1> ../../per_gene/EOG091G05NZ/infer_single_ML.stdout.txt 2> ../../per_gene/EOG091G05NZ/infer_single_ML.stderr.txt
	else
		echo "fasta file per_gene/EOG091G05NZ/ALICUT_EOG091G05NZ.clustalo.fasta contains fewer than 5 sequences - skipped" > ../../per_gene/EOG091G05NZ/infer_single_ML.stdout.txt
		touch raxml.skipped
	fi
        touch ../../per_gene/EOG091G05NZ/EOG091G05NZ.raxml.done
        
[33mJob counts:
	count	jobs
	1	infer_single_ML
	1[0m
[33m
        cd per_gene/EOG091G05NZ
	count=$(cat ../../per_gene/EOG091G05NZ/ALICUT_EOG091G05NZ.clustalo.fasta | grep ">" | wc -l)
	if [ "$count" -gt 5 ]
        then
		RAxMLmodel=$(cat ../../per_gene/EOG091G05NZ/EOG091G05NZ.best_model | grep "Best" | cut -d ":" -f 2 | tr -d '[:space:]')
                if [ "$(ls -1 | grep "^RAxML" | wc -l)" -ne 0 ]
		then
			rm RAxML*
		fi
        	raxml -f a -T 2 -m PROTGAMMA$RAxMLmodel         	-p 12345 -x 12345 -# 100         	-s ../../per_gene/EOG091G05NZ/ALICUT_EOG091G05NZ.clustalo.fasta -n EOG091G05NZ.clustalo.aln.ALICUT.$RAxMLmodel 		1> ../../per_gene/EOG091G05NZ/infer_single_ML.stdout.txt 2> ../../per_gene/EOG091G05NZ/infer_single_ML.stderr.txt
	else
		echo "fasta file per_gene/EOG091G05NZ/ALICUT_EOG091G05NZ.clustalo.fasta contains fewer than 5 sequences - skipped" > ../../per_gene/EOG091G05NZ/infer_single_ML.stdout.txt
		touch raxml.skipped
	fi
        touch ../../per_gene/EOG091G05NZ/EOG091G05NZ.raxml.done
        [0m
[Mon Jul  6 00:04:57 2020]
Finished job 196.
2734 of 3292 steps (83%) done

[Mon Jul  6 00:04:57 2020]
rule get_seqs:
    input: /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ingroup.txt, /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/outgroup.txt
    output: per_gene/EOG091G07D9/EOG091G07D9.ingroup.fasta
    log: per_gene/EOG091G07D9/get_seqs.stdout.txt, per_gene/EOG091G07D9/get_seqs.stderr.txt
    jobid: 3154
    wildcards: BUSCO=EOG091G07D9
    threads: 2


	basedir=$(pwd)
        cd per_gene/EOG091G07D9
        
        bash $basedir/../scripts/fetch_seqs.sh EOG091G07D9 /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ingroup.txt /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/outgroup.txt 1> ../../per_gene/EOG091G07D9/get_seqs.stdout.txt 2> ../../per_gene/EOG091G07D9/get_seqs.stderr.txt
	mv EOG091G07D9.fasta $basedir/per_gene/EOG091G07D9/EOG091G07D9.ingroup.fasta
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/72476f9d9a5bd0627b4d721143a21354.simg
[Mon Jul  6 00:05:00 2020]
Finished job 1187.
2735 of 3292 steps (83%) done

[Mon Jul  6 00:05:00 2020]
rule remove_empty:
    input: per_gene/EOG091G0PD3/ALICUT_EOG091G0PD3.clustalo.fasta
    output: per_gene/EOG091G0PD3/empty_check.done
    jobid: 2009
    wildcards: BUSCO=EOG091G0PD3


         if [ "$(cat per_gene/EOG091G0PD3/ALICUT_EOG091G0PD3.clustalo.fasta | grep -v ">" | sed 's/-//g' | grep "^$" | wc -l)" -gt 0 ]
         then
              cp per_gene/EOG091G0PD3/ALICUT_EOG091G0PD3.clustalo.fasta per_gene/EOG091G0PD3/ALICUT_EOG091G0PD3.clustalo.fasta.backup
              bash ../scripts/remove_empty.sh per_gene/EOG091G0PD3/ALICUT_EOG091G0PD3.clustalo.fasta.backup > per_gene/EOG091G0PD3/ALICUT_EOG091G0PD3.clustalo.fasta
         fi
         touch per_gene/EOG091G0PD3/empty_check.done
         
[Mon Jul  6 00:05:00 2020]
Finished job 2009.
2736 of 3292 steps (83%) done

[Mon Jul  6 00:05:00 2020]
rule find_best_model:
    input: per_gene/EOG091G0PD3/ALICUT_EOG091G0PD3.clustalo.fasta, per_gene/EOG091G0PD3/empty_check.done
    output: per_gene/EOG091G0PD3/EOG091G0PD3.best_model
    log: per_gene/EOG091G0PD3/find_best_model.stderr.txt
    jobid: 1186
    wildcards: BUSCO=EOG091G0PD3
    threads: 2


        cd per_gene/EOG091G0PD3
        if [ ! -d find_best_model ]
        then
            mkdir find_best_model
        fi
        cd find_best_model
        ln -s ../../../per_gene/EOG091G0PD3/ALICUT_EOG091G0PD3.clustalo.fasta EOG091G0PD3.fasta
        ProteinModelSelection.pl EOG091G0PD3.fasta 1> ../../../per_gene/EOG091G0PD3/EOG091G0PD3.best_model 2> ../../../per_gene/EOG091G0PD3/find_best_model.stderr.txt
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/c0c09ee657b1e27f2c5687e0e9aa8d70.simg
[Mon Jul  6 00:05:06 2020]
Finished job 2650.
2737 of 3292 steps (83%) done

[Mon Jul  6 00:05:06 2020]
rule get_outgroups:
    input: per_gene/EOG091G0CNT/EOG091G0CNT.ingroup.fasta
    output: per_gene/EOG091G0CNT/EOG091G0CNT.orthodb.fasta, per_gene/EOG091G0CNT/EOG091G0CNT.outgroup.fasta
    log: per_gene/EOG091G0CNT/get_outgroups.stdout.txt, per_gene/EOG091G0CNT/get_outgroups.stderr.txt
    jobid: 2651
    wildcards: BUSCO=EOG091G0CNT


        #download fastas from Orhtodb for BUSCO id
        for i in {1..5}
        do
             wget "http://www.orthodb.org/fasta?query=EOG091G0CNT&level=33208" -O per_gene/EOG091G0CNT/EOG091G0CNT.orthodb.fasta 1> per_gene/EOG091G0CNT/get_outgroups.stdout.txt 2> per_gene/EOG091G0CNT/get_outgroups.stderr.txt && break || echo -e "try again ($i)" && sleep 15
        done

	#This is quick an dirty for now and just takes the first protein if there is more than one for an outgroup taxon
        bash ../scripts/download_outgroups.sh taxids.txt per_gene/EOG091G0CNT/EOG091G0CNT.orthodb.fasta > per_gene/EOG091G0CNT/EOG091G0CNT.outgroup.fasta
        
[Mon Jul  6 00:05:07 2020]
Finished job 2651.
2738 of 3292 steps (83%) done

[Mon Jul  6 00:05:07 2020]
rule join_groups:
    input: per_gene/EOG091G0CNT/EOG091G0CNT.ingroup.fasta, per_gene/EOG091G0CNT/EOG091G0CNT.outgroup.fasta
    output: per_gene/EOG091G0CNT/EOG091G0CNT.fasta
    jobid: 2149
    wildcards: BUSCO=EOG091G0CNT


        cat per_gene/EOG091G0CNT/EOG091G0CNT.ingroup.fasta per_gene/EOG091G0CNT/EOG091G0CNT.outgroup.fasta > per_gene/EOG091G0CNT/EOG091G0CNT.fasta
        
[Mon Jul  6 00:05:07 2020]
Finished job 2149.
2739 of 3292 steps (83%) done

[Mon Jul  6 00:05:07 2020]
rule MSA:
    input: per_gene/EOG091G0CNT/EOG091G0CNT.fasta
    output: per_gene/EOG091G0CNT/EOG091G0CNT.clustalo.fasta
    log: per_gene/EOG091G0CNT/MSA.stdout.txt, per_gene/EOG091G0CNT/MSA.stderr.txt
    jobid: 1418
    wildcards: BUSCO=EOG091G0CNT
    threads: 2


        clustalo -i per_gene/EOG091G0CNT/EOG091G0CNT.fasta -o per_gene/EOG091G0CNT/EOG091G0CNT.clustalo.fasta --threads=2 1> per_gene/EOG091G0CNT/MSA.stdout.txt 2> per_gene/EOG091G0CNT/MSA.stderr.txt
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/d68c9691725a7401923680874285c430.simg
[Mon Jul  6 00:05:08 2020]
Finished job 1418.
2740 of 3292 steps (83%) done

[Mon Jul  6 00:05:08 2020]
rule score_and_cut:
    input: per_gene/EOG091G0CNT/EOG091G0CNT.clustalo.fasta
    output: per_gene/EOG091G0CNT/ALICUT_EOG091G0CNT.clustalo.fasta
    jobid: 595
    wildcards: BUSCO=EOG091G0CNT
    threads: 2


        cd per_gene/EOG091G0CNT
        Aliscore.pl -N -r 200000000000000000 -i ../../per_gene/EOG091G0CNT/EOG091G0CNT.clustalo.fasta &> aliscore.log
        ALICUT.pl -s &> alicut.log
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/63c88c27a0fa300f57066b0ef65fefcb.simg
[Mon Jul  6 00:05:13 2020]
Finished job 3154.
2741 of 3292 steps (83%) done

[Mon Jul  6 00:05:13 2020]
rule get_outgroups:
    input: per_gene/EOG091G07D9/EOG091G07D9.ingroup.fasta
    output: per_gene/EOG091G07D9/EOG091G07D9.orthodb.fasta, per_gene/EOG091G07D9/EOG091G07D9.outgroup.fasta
    log: per_gene/EOG091G07D9/get_outgroups.stdout.txt, per_gene/EOG091G07D9/get_outgroups.stderr.txt
    jobid: 3155
    wildcards: BUSCO=EOG091G07D9


        #download fastas from Orhtodb for BUSCO id
        for i in {1..5}
        do
             wget "http://www.orthodb.org/fasta?query=EOG091G07D9&level=33208" -O per_gene/EOG091G07D9/EOG091G07D9.orthodb.fasta 1> per_gene/EOG091G07D9/get_outgroups.stdout.txt 2> per_gene/EOG091G07D9/get_outgroups.stderr.txt && break || echo -e "try again ($i)" && sleep 15
        done

	#This is quick an dirty for now and just takes the first protein if there is more than one for an outgroup taxon
        bash ../scripts/download_outgroups.sh taxids.txt per_gene/EOG091G07D9/EOG091G07D9.orthodb.fasta > per_gene/EOG091G07D9/EOG091G07D9.outgroup.fasta
        
[Mon Jul  6 00:05:14 2020]
Finished job 3155.
2742 of 3292 steps (83%) done

[Mon Jul  6 00:05:14 2020]
rule join_groups:
    input: per_gene/EOG091G07D9/EOG091G07D9.ingroup.fasta, per_gene/EOG091G07D9/EOG091G07D9.outgroup.fasta
    output: per_gene/EOG091G07D9/EOG091G07D9.fasta
    jobid: 2401
    wildcards: BUSCO=EOG091G07D9


        cat per_gene/EOG091G07D9/EOG091G07D9.ingroup.fasta per_gene/EOG091G07D9/EOG091G07D9.outgroup.fasta > per_gene/EOG091G07D9/EOG091G07D9.fasta
        
[Mon Jul  6 00:05:14 2020]
Finished job 2401.
2743 of 3292 steps (83%) done

[Mon Jul  6 00:05:14 2020]
rule MSA:
    input: per_gene/EOG091G07D9/EOG091G07D9.fasta
    output: per_gene/EOG091G07D9/EOG091G07D9.clustalo.fasta
    log: per_gene/EOG091G07D9/MSA.stdout.txt, per_gene/EOG091G07D9/MSA.stderr.txt
    jobid: 1922
    wildcards: BUSCO=EOG091G07D9
    threads: 2


        clustalo -i per_gene/EOG091G07D9/EOG091G07D9.fasta -o per_gene/EOG091G07D9/EOG091G07D9.clustalo.fasta --threads=2 1> per_gene/EOG091G07D9/MSA.stdout.txt 2> per_gene/EOG091G07D9/MSA.stderr.txt
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/d68c9691725a7401923680874285c430.simg
[Mon Jul  6 00:05:15 2020]
Finished job 1922.
2744 of 3292 steps (83%) done

[Mon Jul  6 00:05:15 2020]
rule score_and_cut:
    input: per_gene/EOG091G07D9/EOG091G07D9.clustalo.fasta
    output: per_gene/EOG091G07D9/ALICUT_EOG091G07D9.clustalo.fasta
    jobid: 1099
    wildcards: BUSCO=EOG091G07D9
    threads: 2


        cd per_gene/EOG091G07D9
        Aliscore.pl -N -r 200000000000000000 -i ../../per_gene/EOG091G07D9/EOG091G07D9.clustalo.fasta &> aliscore.log
        ALICUT.pl -s &> alicut.log
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/63c88c27a0fa300f57066b0ef65fefcb.simg
[Mon Jul  6 00:05:18 2020]
Finished job 595.
2745 of 3292 steps (83%) done

[Mon Jul  6 00:05:18 2020]
rule remove_empty:
    input: per_gene/EOG091G0CNT/ALICUT_EOG091G0CNT.clustalo.fasta
    output: per_gene/EOG091G0CNT/empty_check.done
    jobid: 1417
    wildcards: BUSCO=EOG091G0CNT


         if [ "$(cat per_gene/EOG091G0CNT/ALICUT_EOG091G0CNT.clustalo.fasta | grep -v ">" | sed 's/-//g' | grep "^$" | wc -l)" -gt 0 ]
         then
              cp per_gene/EOG091G0CNT/ALICUT_EOG091G0CNT.clustalo.fasta per_gene/EOG091G0CNT/ALICUT_EOG091G0CNT.clustalo.fasta.backup
              bash ../scripts/remove_empty.sh per_gene/EOG091G0CNT/ALICUT_EOG091G0CNT.clustalo.fasta.backup > per_gene/EOG091G0CNT/ALICUT_EOG091G0CNT.clustalo.fasta
         fi
         touch per_gene/EOG091G0CNT/empty_check.done
         
[Mon Jul  6 00:05:18 2020]
Finished job 1417.
2746 of 3292 steps (83%) done

[Mon Jul  6 00:05:18 2020]
rule find_best_model:
    input: per_gene/EOG091G0CNT/ALICUT_EOG091G0CNT.clustalo.fasta, per_gene/EOG091G0CNT/empty_check.done
    output: per_gene/EOG091G0CNT/EOG091G0CNT.best_model
    log: per_gene/EOG091G0CNT/find_best_model.stderr.txt
    jobid: 594
    wildcards: BUSCO=EOG091G0CNT
    threads: 2


        cd per_gene/EOG091G0CNT
        if [ ! -d find_best_model ]
        then
            mkdir find_best_model
        fi
        cd find_best_model
        ln -s ../../../per_gene/EOG091G0CNT/ALICUT_EOG091G0CNT.clustalo.fasta EOG091G0CNT.fasta
        ProteinModelSelection.pl EOG091G0CNT.fasta 1> ../../../per_gene/EOG091G0CNT/EOG091G0CNT.best_model 2> ../../../per_gene/EOG091G0CNT/find_best_model.stderr.txt
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/c0c09ee657b1e27f2c5687e0e9aa8d70.simg
[Mon Jul  6 00:05:24 2020]
Finished job 1099.
2747 of 3292 steps (83%) done

[Mon Jul  6 00:05:24 2020]
rule remove_empty:
    input: per_gene/EOG091G07D9/ALICUT_EOG091G07D9.clustalo.fasta
    output: per_gene/EOG091G07D9/empty_check.done
    jobid: 1921
    wildcards: BUSCO=EOG091G07D9


         if [ "$(cat per_gene/EOG091G07D9/ALICUT_EOG091G07D9.clustalo.fasta | grep -v ">" | sed 's/-//g' | grep "^$" | wc -l)" -gt 0 ]
         then
              cp per_gene/EOG091G07D9/ALICUT_EOG091G07D9.clustalo.fasta per_gene/EOG091G07D9/ALICUT_EOG091G07D9.clustalo.fasta.backup
              bash ../scripts/remove_empty.sh per_gene/EOG091G07D9/ALICUT_EOG091G07D9.clustalo.fasta.backup > per_gene/EOG091G07D9/ALICUT_EOG091G07D9.clustalo.fasta
         fi
         touch per_gene/EOG091G07D9/empty_check.done
         
[Mon Jul  6 00:05:24 2020]
Finished job 1921.
2748 of 3292 steps (83%) done

[Mon Jul  6 00:05:24 2020]
rule find_best_model:
    input: per_gene/EOG091G07D9/ALICUT_EOG091G07D9.clustalo.fasta, per_gene/EOG091G07D9/empty_check.done
    output: per_gene/EOG091G07D9/EOG091G07D9.best_model
    log: per_gene/EOG091G07D9/find_best_model.stderr.txt
    jobid: 1098
    wildcards: BUSCO=EOG091G07D9
    threads: 2


        cd per_gene/EOG091G07D9
        if [ ! -d find_best_model ]
        then
            mkdir find_best_model
        fi
        cd find_best_model
        ln -s ../../../per_gene/EOG091G07D9/ALICUT_EOG091G07D9.clustalo.fasta EOG091G07D9.fasta
        ProteinModelSelection.pl EOG091G07D9.fasta 1> ../../../per_gene/EOG091G07D9/EOG091G07D9.best_model 2> ../../../per_gene/EOG091G07D9/find_best_model.stderr.txt
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/c0c09ee657b1e27f2c5687e0e9aa8d70.simg
[Mon Jul  6 00:05:29 2020]
Finished job 1186.
2749 of 3292 steps (84%) done

[Mon Jul  6 00:05:29 2020]
rule infer_single_ML:
    input: per_gene/EOG091G0PD3/EOG091G0PD3.best_model, per_gene/EOG091G0PD3/ALICUT_EOG091G0PD3.clustalo.fasta
    output: per_gene/EOG091G0PD3/EOG091G0PD3.raxml.done
    log: per_gene/EOG091G0PD3/infer_single_ML.stdout.txt, per_gene/EOG091G0PD3/infer_single_ML.stderr.txt
    jobid: 387
    wildcards: BUSCO=EOG091G0PD3
    threads: 2


        cd per_gene/EOG091G0PD3
	count=$(cat ../../per_gene/EOG091G0PD3/ALICUT_EOG091G0PD3.clustalo.fasta | grep ">" | wc -l)
	if [ "$count" -gt 5 ]
        then
		RAxMLmodel=$(cat ../../per_gene/EOG091G0PD3/EOG091G0PD3.best_model | grep "Best" | cut -d ":" -f 2 | tr -d '[:space:]')
                if [ "$(ls -1 | grep "^RAxML" | wc -l)" -ne 0 ]
		then
			rm RAxML*
		fi
        	raxml -f a -T 2 -m PROTGAMMA$RAxMLmodel         	-p 12345 -x 12345 -# 100         	-s ../../per_gene/EOG091G0PD3/ALICUT_EOG091G0PD3.clustalo.fasta -n EOG091G0PD3.clustalo.aln.ALICUT.$RAxMLmodel 		1> ../../per_gene/EOG091G0PD3/infer_single_ML.stdout.txt 2> ../../per_gene/EOG091G0PD3/infer_single_ML.stderr.txt
	else
		echo "fasta file per_gene/EOG091G0PD3/ALICUT_EOG091G0PD3.clustalo.fasta contains fewer than 5 sequences - skipped" > ../../per_gene/EOG091G0PD3/infer_single_ML.stdout.txt
		touch raxml.skipped
	fi
        touch ../../per_gene/EOG091G0PD3/EOG091G0PD3.raxml.done
        
[Mon Jul  6 00:05:40 2020]
Finished job 1068.
2750 of 3292 steps (84%) done

[Mon Jul  6 00:05:40 2020]
rule infer_single_ML:
    input: per_gene/EOG091G03LI/EOG091G03LI.best_model, per_gene/EOG091G03LI/ALICUT_EOG091G03LI.clustalo.fasta
    output: per_gene/EOG091G03LI/EOG091G03LI.raxml.done
    log: per_gene/EOG091G03LI/infer_single_ML.stdout.txt, per_gene/EOG091G03LI/infer_single_ML.stderr.txt
    jobid: 328
    wildcards: BUSCO=EOG091G03LI
    threads: 2


        cd per_gene/EOG091G03LI
	count=$(cat ../../per_gene/EOG091G03LI/ALICUT_EOG091G03LI.clustalo.fasta | grep ">" | wc -l)
	if [ "$count" -gt 5 ]
        then
		RAxMLmodel=$(cat ../../per_gene/EOG091G03LI/EOG091G03LI.best_model | grep "Best" | cut -d ":" -f 2 | tr -d '[:space:]')
                if [ "$(ls -1 | grep "^RAxML" | wc -l)" -ne 0 ]
		then
			rm RAxML*
		fi
        	raxml -f a -T 2 -m PROTGAMMA$RAxMLmodel         	-p 12345 -x 12345 -# 100         	-s ../../per_gene/EOG091G03LI/ALICUT_EOG091G03LI.clustalo.fasta -n EOG091G03LI.clustalo.aln.ALICUT.$RAxMLmodel 		1> ../../per_gene/EOG091G03LI/infer_single_ML.stdout.txt 2> ../../per_gene/EOG091G03LI/infer_single_ML.stderr.txt
	else
		echo "fasta file per_gene/EOG091G03LI/ALICUT_EOG091G03LI.clustalo.fasta contains fewer than 5 sequences - skipped" > ../../per_gene/EOG091G03LI/infer_single_ML.stdout.txt
		touch raxml.skipped
	fi
        touch ../../per_gene/EOG091G03LI/EOG091G03LI.raxml.done
        
[Mon Jul  6 00:05:49 2020]
Finished job 594.
2751 of 3292 steps (84%) done

[Mon Jul  6 00:05:49 2020]
rule infer_single_ML:
    input: per_gene/EOG091G0CNT/EOG091G0CNT.best_model, per_gene/EOG091G0CNT/ALICUT_EOG091G0CNT.clustalo.fasta
    output: per_gene/EOG091G0CNT/EOG091G0CNT.raxml.done
    log: per_gene/EOG091G0CNT/infer_single_ML.stdout.txt, per_gene/EOG091G0CNT/infer_single_ML.stderr.txt
    jobid: 91
    wildcards: BUSCO=EOG091G0CNT
    threads: 2


        cd per_gene/EOG091G0CNT
	count=$(cat ../../per_gene/EOG091G0CNT/ALICUT_EOG091G0CNT.clustalo.fasta | grep ">" | wc -l)
	if [ "$count" -gt 5 ]
        then
		RAxMLmodel=$(cat ../../per_gene/EOG091G0CNT/EOG091G0CNT.best_model | grep "Best" | cut -d ":" -f 2 | tr -d '[:space:]')
                if [ "$(ls -1 | grep "^RAxML" | wc -l)" -ne 0 ]
		then
			rm RAxML*
		fi
        	raxml -f a -T 2 -m PROTGAMMA$RAxMLmodel         	-p 12345 -x 12345 -# 100         	-s ../../per_gene/EOG091G0CNT/ALICUT_EOG091G0CNT.clustalo.fasta -n EOG091G0CNT.clustalo.aln.ALICUT.$RAxMLmodel 		1> ../../per_gene/EOG091G0CNT/infer_single_ML.stdout.txt 2> ../../per_gene/EOG091G0CNT/infer_single_ML.stderr.txt
	else
		echo "fasta file per_gene/EOG091G0CNT/ALICUT_EOG091G0CNT.clustalo.fasta contains fewer than 5 sequences - skipped" > ../../per_gene/EOG091G0CNT/infer_single_ML.stdout.txt
		touch raxml.skipped
	fi
        touch ../../per_gene/EOG091G0CNT/EOG091G0CNT.raxml.done
        
[Mon Jul  6 00:05:49 2020]
Finished job 14.
2752 of 3292 steps (84%) done

[Mon Jul  6 00:05:49 2020]
rule get_seqs:
    input: /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ingroup.txt, /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/outgroup.txt
    output: per_gene/EOG091G0GVZ/EOG091G0GVZ.ingroup.fasta
    log: per_gene/EOG091G0GVZ/get_seqs.stdout.txt, per_gene/EOG091G0GVZ/get_seqs.stderr.txt
    jobid: 2696
    wildcards: BUSCO=EOG091G0GVZ
    threads: 2


	basedir=$(pwd)
        cd per_gene/EOG091G0GVZ
        
        bash $basedir/../scripts/fetch_seqs.sh EOG091G0GVZ /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ingroup.txt /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/outgroup.txt 1> ../../per_gene/EOG091G0GVZ/get_seqs.stdout.txt 2> ../../per_gene/EOG091G0GVZ/get_seqs.stderr.txt
	mv EOG091G0GVZ.fasta $basedir/per_gene/EOG091G0GVZ/EOG091G0GVZ.ingroup.fasta
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/72476f9d9a5bd0627b4d721143a21354.simg
[33mJob counts:
	count	jobs
	1	infer_single_ML
	1[0m
[33mJob counts:
	count	jobs
	1	infer_single_ML
	1[0m
[33mJob counts:
	count	jobs
	1	infer_single_ML
	1[0m
[33m
        cd per_gene/EOG091G0CNT
	count=$(cat ../../per_gene/EOG091G0CNT/ALICUT_EOG091G0CNT.clustalo.fasta | grep ">" | wc -l)
	if [ "$count" -gt 5 ]
        then
		RAxMLmodel=$(cat ../../per_gene/EOG091G0CNT/EOG091G0CNT.best_model | grep "Best" | cut -d ":" -f 2 | tr -d '[:space:]')
                if [ "$(ls -1 | grep "^RAxML" | wc -l)" -ne 0 ]
		then
			rm RAxML*
		fi
        	raxml -f a -T 2 -m PROTGAMMA$RAxMLmodel         	-p 12345 -x 12345 -# 100         	-s ../../per_gene/EOG091G0CNT/ALICUT_EOG091G0CNT.clustalo.fasta -n EOG091G0CNT.clustalo.aln.ALICUT.$RAxMLmodel 		1> ../../per_gene/EOG091G0CNT/infer_single_ML.stdout.txt 2> ../../per_gene/EOG091G0CNT/infer_single_ML.stderr.txt
	else
		echo "fasta file per_gene/EOG091G0CNT/ALICUT_EOG091G0CNT.clustalo.fasta contains fewer than 5 sequences - skipped" > ../../per_gene/EOG091G0CNT/infer_single_ML.stdout.txt
		touch raxml.skipped
	fi
        touch ../../per_gene/EOG091G0CNT/EOG091G0CNT.raxml.done
        [0m
[33m
        cd per_gene/EOG091G0PD3
	count=$(cat ../../per_gene/EOG091G0PD3/ALICUT_EOG091G0PD3.clustalo.fasta | grep ">" | wc -l)
	if [ "$count" -gt 5 ]
        then
		RAxMLmodel=$(cat ../../per_gene/EOG091G0PD3/EOG091G0PD3.best_model | grep "Best" | cut -d ":" -f 2 | tr -d '[:space:]')
                if [ "$(ls -1 | grep "^RAxML" | wc -l)" -ne 0 ]
		then
			rm RAxML*
		fi
        	raxml -f a -T 2 -m PROTGAMMA$RAxMLmodel         	-p 12345 -x 12345 -# 100         	-s ../../per_gene/EOG091G0PD3/ALICUT_EOG091G0PD3.clustalo.fasta -n EOG091G0PD3.clustalo.aln.ALICUT.$RAxMLmodel 		1> ../../per_gene/EOG091G0PD3/infer_single_ML.stdout.txt 2> ../../per_gene/EOG091G0PD3/infer_single_ML.stderr.txt
	else
		echo "fasta file per_gene/EOG091G0PD3/ALICUT_EOG091G0PD3.clustalo.fasta contains fewer than 5 sequences - skipped" > ../../per_gene/EOG091G0PD3/infer_single_ML.stdout.txt
		touch raxml.skipped
	fi
        touch ../../per_gene/EOG091G0PD3/EOG091G0PD3.raxml.done
        [0m
[33m
        cd per_gene/EOG091G03LI
	count=$(cat ../../per_gene/EOG091G03LI/ALICUT_EOG091G03LI.clustalo.fasta | grep ">" | wc -l)
	if [ "$count" -gt 5 ]
        then
		RAxMLmodel=$(cat ../../per_gene/EOG091G03LI/EOG091G03LI.best_model | grep "Best" | cut -d ":" -f 2 | tr -d '[:space:]')
                if [ "$(ls -1 | grep "^RAxML" | wc -l)" -ne 0 ]
		then
			rm RAxML*
		fi
        	raxml -f a -T 2 -m PROTGAMMA$RAxMLmodel         	-p 12345 -x 12345 -# 100         	-s ../../per_gene/EOG091G03LI/ALICUT_EOG091G03LI.clustalo.fasta -n EOG091G03LI.clustalo.aln.ALICUT.$RAxMLmodel 		1> ../../per_gene/EOG091G03LI/infer_single_ML.stdout.txt 2> ../../per_gene/EOG091G03LI/infer_single_ML.stderr.txt
	else
		echo "fasta file per_gene/EOG091G03LI/ALICUT_EOG091G03LI.clustalo.fasta contains fewer than 5 sequences - skipped" > ../../per_gene/EOG091G03LI/infer_single_ML.stdout.txt
		touch raxml.skipped
	fi
        touch ../../per_gene/EOG091G03LI/EOG091G03LI.raxml.done
        [0m
[Mon Jul  6 00:05:59 2020]
Finished job 1098.
2753 of 3292 steps (84%) done

[Mon Jul  6 00:05:59 2020]
rule infer_single_ML:
    input: per_gene/EOG091G07D9/EOG091G07D9.best_model, per_gene/EOG091G07D9/ALICUT_EOG091G07D9.clustalo.fasta
    output: per_gene/EOG091G07D9/EOG091G07D9.raxml.done
    log: per_gene/EOG091G07D9/infer_single_ML.stdout.txt, per_gene/EOG091G07D9/infer_single_ML.stderr.txt
    jobid: 343
    wildcards: BUSCO=EOG091G07D9
    threads: 2


        cd per_gene/EOG091G07D9
	count=$(cat ../../per_gene/EOG091G07D9/ALICUT_EOG091G07D9.clustalo.fasta | grep ">" | wc -l)
	if [ "$count" -gt 5 ]
        then
		RAxMLmodel=$(cat ../../per_gene/EOG091G07D9/EOG091G07D9.best_model | grep "Best" | cut -d ":" -f 2 | tr -d '[:space:]')
                if [ "$(ls -1 | grep "^RAxML" | wc -l)" -ne 0 ]
		then
			rm RAxML*
		fi
        	raxml -f a -T 2 -m PROTGAMMA$RAxMLmodel         	-p 12345 -x 12345 -# 100         	-s ../../per_gene/EOG091G07D9/ALICUT_EOG091G07D9.clustalo.fasta -n EOG091G07D9.clustalo.aln.ALICUT.$RAxMLmodel 		1> ../../per_gene/EOG091G07D9/infer_single_ML.stdout.txt 2> ../../per_gene/EOG091G07D9/infer_single_ML.stderr.txt
	else
		echo "fasta file per_gene/EOG091G07D9/ALICUT_EOG091G07D9.clustalo.fasta contains fewer than 5 sequences - skipped" > ../../per_gene/EOG091G07D9/infer_single_ML.stdout.txt
		touch raxml.skipped
	fi
        touch ../../per_gene/EOG091G07D9/EOG091G07D9.raxml.done
        
[33mJob counts:
	count	jobs
	1	infer_single_ML
	1[0m
[33m
        cd per_gene/EOG091G07D9
	count=$(cat ../../per_gene/EOG091G07D9/ALICUT_EOG091G07D9.clustalo.fasta | grep ">" | wc -l)
	if [ "$count" -gt 5 ]
        then
		RAxMLmodel=$(cat ../../per_gene/EOG091G07D9/EOG091G07D9.best_model | grep "Best" | cut -d ":" -f 2 | tr -d '[:space:]')
                if [ "$(ls -1 | grep "^RAxML" | wc -l)" -ne 0 ]
		then
			rm RAxML*
		fi
        	raxml -f a -T 2 -m PROTGAMMA$RAxMLmodel         	-p 12345 -x 12345 -# 100         	-s ../../per_gene/EOG091G07D9/ALICUT_EOG091G07D9.clustalo.fasta -n EOG091G07D9.clustalo.aln.ALICUT.$RAxMLmodel 		1> ../../per_gene/EOG091G07D9/infer_single_ML.stdout.txt 2> ../../per_gene/EOG091G07D9/infer_single_ML.stderr.txt
	else
		echo "fasta file per_gene/EOG091G07D9/ALICUT_EOG091G07D9.clustalo.fasta contains fewer than 5 sequences - skipped" > ../../per_gene/EOG091G07D9/infer_single_ML.stdout.txt
		touch raxml.skipped
	fi
        touch ../../per_gene/EOG091G07D9/EOG091G07D9.raxml.done
        [0m
[Mon Jul  6 00:06:02 2020]
Finished job 2696.
2754 of 3292 steps (84%) done

[Mon Jul  6 00:06:02 2020]
rule get_outgroups:
    input: per_gene/EOG091G0GVZ/EOG091G0GVZ.ingroup.fasta
    output: per_gene/EOG091G0GVZ/EOG091G0GVZ.orthodb.fasta, per_gene/EOG091G0GVZ/EOG091G0GVZ.outgroup.fasta
    log: per_gene/EOG091G0GVZ/get_outgroups.stdout.txt, per_gene/EOG091G0GVZ/get_outgroups.stderr.txt
    jobid: 2697
    wildcards: BUSCO=EOG091G0GVZ


        #download fastas from Orhtodb for BUSCO id
        for i in {1..5}
        do
             wget "http://www.orthodb.org/fasta?query=EOG091G0GVZ&level=33208" -O per_gene/EOG091G0GVZ/EOG091G0GVZ.orthodb.fasta 1> per_gene/EOG091G0GVZ/get_outgroups.stdout.txt 2> per_gene/EOG091G0GVZ/get_outgroups.stderr.txt && break || echo -e "try again ($i)" && sleep 15
        done

	#This is quick an dirty for now and just takes the first protein if there is more than one for an outgroup taxon
        bash ../scripts/download_outgroups.sh taxids.txt per_gene/EOG091G0GVZ/EOG091G0GVZ.orthodb.fasta > per_gene/EOG091G0GVZ/EOG091G0GVZ.outgroup.fasta
        
[Mon Jul  6 00:06:03 2020]
Finished job 2697.
2755 of 3292 steps (84%) done

[Mon Jul  6 00:06:03 2020]
rule join_groups:
    input: per_gene/EOG091G0GVZ/EOG091G0GVZ.ingroup.fasta, per_gene/EOG091G0GVZ/EOG091G0GVZ.outgroup.fasta
    output: per_gene/EOG091G0GVZ/EOG091G0GVZ.fasta
    jobid: 2172
    wildcards: BUSCO=EOG091G0GVZ


        cat per_gene/EOG091G0GVZ/EOG091G0GVZ.ingroup.fasta per_gene/EOG091G0GVZ/EOG091G0GVZ.outgroup.fasta > per_gene/EOG091G0GVZ/EOG091G0GVZ.fasta
        
[Mon Jul  6 00:06:03 2020]
Finished job 2172.
2756 of 3292 steps (84%) done

[Mon Jul  6 00:06:03 2020]
rule MSA:
    input: per_gene/EOG091G0GVZ/EOG091G0GVZ.fasta
    output: per_gene/EOG091G0GVZ/EOG091G0GVZ.clustalo.fasta
    log: per_gene/EOG091G0GVZ/MSA.stdout.txt, per_gene/EOG091G0GVZ/MSA.stderr.txt
    jobid: 1464
    wildcards: BUSCO=EOG091G0GVZ
    threads: 2


        clustalo -i per_gene/EOG091G0GVZ/EOG091G0GVZ.fasta -o per_gene/EOG091G0GVZ/EOG091G0GVZ.clustalo.fasta --threads=2 1> per_gene/EOG091G0GVZ/MSA.stdout.txt 2> per_gene/EOG091G0GVZ/MSA.stderr.txt
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/d68c9691725a7401923680874285c430.simg
[Mon Jul  6 00:06:05 2020]
Finished job 1464.
2757 of 3292 steps (84%) done

[Mon Jul  6 00:06:05 2020]
rule score_and_cut:
    input: per_gene/EOG091G0GVZ/EOG091G0GVZ.clustalo.fasta
    output: per_gene/EOG091G0GVZ/ALICUT_EOG091G0GVZ.clustalo.fasta
    jobid: 641
    wildcards: BUSCO=EOG091G0GVZ
    threads: 2


        cd per_gene/EOG091G0GVZ
        Aliscore.pl -N -r 200000000000000000 -i ../../per_gene/EOG091G0GVZ/EOG091G0GVZ.clustalo.fasta &> aliscore.log
        ALICUT.pl -s &> alicut.log
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/63c88c27a0fa300f57066b0ef65fefcb.simg
[Mon Jul  6 00:06:16 2020]
Finished job 641.
2758 of 3292 steps (84%) done

[Mon Jul  6 00:06:16 2020]
rule remove_empty:
    input: per_gene/EOG091G0GVZ/ALICUT_EOG091G0GVZ.clustalo.fasta
    output: per_gene/EOG091G0GVZ/empty_check.done
    jobid: 1463
    wildcards: BUSCO=EOG091G0GVZ


         if [ "$(cat per_gene/EOG091G0GVZ/ALICUT_EOG091G0GVZ.clustalo.fasta | grep -v ">" | sed 's/-//g' | grep "^$" | wc -l)" -gt 0 ]
         then
              cp per_gene/EOG091G0GVZ/ALICUT_EOG091G0GVZ.clustalo.fasta per_gene/EOG091G0GVZ/ALICUT_EOG091G0GVZ.clustalo.fasta.backup
              bash ../scripts/remove_empty.sh per_gene/EOG091G0GVZ/ALICUT_EOG091G0GVZ.clustalo.fasta.backup > per_gene/EOG091G0GVZ/ALICUT_EOG091G0GVZ.clustalo.fasta
         fi
         touch per_gene/EOG091G0GVZ/empty_check.done
         
[Mon Jul  6 00:06:16 2020]
Finished job 1463.
2759 of 3292 steps (84%) done

[Mon Jul  6 00:06:16 2020]
rule find_best_model:
    input: per_gene/EOG091G0GVZ/ALICUT_EOG091G0GVZ.clustalo.fasta, per_gene/EOG091G0GVZ/empty_check.done
    output: per_gene/EOG091G0GVZ/EOG091G0GVZ.best_model
    log: per_gene/EOG091G0GVZ/find_best_model.stderr.txt
    jobid: 640
    wildcards: BUSCO=EOG091G0GVZ
    threads: 2


        cd per_gene/EOG091G0GVZ
        if [ ! -d find_best_model ]
        then
            mkdir find_best_model
        fi
        cd find_best_model
        ln -s ../../../per_gene/EOG091G0GVZ/ALICUT_EOG091G0GVZ.clustalo.fasta EOG091G0GVZ.fasta
        ProteinModelSelection.pl EOG091G0GVZ.fasta 1> ../../../per_gene/EOG091G0GVZ/EOG091G0GVZ.best_model 2> ../../../per_gene/EOG091G0GVZ/find_best_model.stderr.txt
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/c0c09ee657b1e27f2c5687e0e9aa8d70.simg
[Mon Jul  6 00:06:24 2020]
Finished job 31.
2760 of 3292 steps (84%) done

[Mon Jul  6 00:06:24 2020]
rule get_seqs:
    input: /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ingroup.txt, /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/outgroup.txt
    output: per_gene/EOG091G10FG/EOG091G10FG.ingroup.fasta
    log: per_gene/EOG091G10FG/get_seqs.stdout.txt, per_gene/EOG091G10FG/get_seqs.stderr.txt
    jobid: 2912
    wildcards: BUSCO=EOG091G10FG
    threads: 2


	basedir=$(pwd)
        cd per_gene/EOG091G10FG
        
        bash $basedir/../scripts/fetch_seqs.sh EOG091G10FG /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ingroup.txt /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/outgroup.txt 1> ../../per_gene/EOG091G10FG/get_seqs.stdout.txt 2> ../../per_gene/EOG091G10FG/get_seqs.stderr.txt
	mv EOG091G10FG.fasta $basedir/per_gene/EOG091G10FG/EOG091G10FG.ingroup.fasta
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/72476f9d9a5bd0627b4d721143a21354.simg
[Mon Jul  6 00:06:37 2020]
Finished job 2912.
2761 of 3292 steps (84%) done

[Mon Jul  6 00:06:37 2020]
rule get_outgroups:
    input: per_gene/EOG091G10FG/EOG091G10FG.ingroup.fasta
    output: per_gene/EOG091G10FG/EOG091G10FG.orthodb.fasta, per_gene/EOG091G10FG/EOG091G10FG.outgroup.fasta
    log: per_gene/EOG091G10FG/get_outgroups.stdout.txt, per_gene/EOG091G10FG/get_outgroups.stderr.txt
    jobid: 2913
    wildcards: BUSCO=EOG091G10FG


        #download fastas from Orhtodb for BUSCO id
        for i in {1..5}
        do
             wget "http://www.orthodb.org/fasta?query=EOG091G10FG&level=33208" -O per_gene/EOG091G10FG/EOG091G10FG.orthodb.fasta 1> per_gene/EOG091G10FG/get_outgroups.stdout.txt 2> per_gene/EOG091G10FG/get_outgroups.stderr.txt && break || echo -e "try again ($i)" && sleep 15
        done

	#This is quick an dirty for now and just takes the first protein if there is more than one for an outgroup taxon
        bash ../scripts/download_outgroups.sh taxids.txt per_gene/EOG091G10FG/EOG091G10FG.orthodb.fasta > per_gene/EOG091G10FG/EOG091G10FG.outgroup.fasta
        
[Mon Jul  6 00:06:39 2020]
Finished job 2913.
2762 of 3292 steps (84%) done

[Mon Jul  6 00:06:39 2020]
rule join_groups:
    input: per_gene/EOG091G10FG/EOG091G10FG.ingroup.fasta, per_gene/EOG091G10FG/EOG091G10FG.outgroup.fasta
    output: per_gene/EOG091G10FG/EOG091G10FG.fasta
    jobid: 2280
    wildcards: BUSCO=EOG091G10FG


        cat per_gene/EOG091G10FG/EOG091G10FG.ingroup.fasta per_gene/EOG091G10FG/EOG091G10FG.outgroup.fasta > per_gene/EOG091G10FG/EOG091G10FG.fasta
        
[Mon Jul  6 00:06:39 2020]
Finished job 2280.
2763 of 3292 steps (84%) done

[Mon Jul  6 00:06:39 2020]
rule MSA:
    input: per_gene/EOG091G10FG/EOG091G10FG.fasta
    output: per_gene/EOG091G10FG/EOG091G10FG.clustalo.fasta
    log: per_gene/EOG091G10FG/MSA.stdout.txt, per_gene/EOG091G10FG/MSA.stderr.txt
    jobid: 1680
    wildcards: BUSCO=EOG091G10FG
    threads: 2


        clustalo -i per_gene/EOG091G10FG/EOG091G10FG.fasta -o per_gene/EOG091G10FG/EOG091G10FG.clustalo.fasta --threads=2 1> per_gene/EOG091G10FG/MSA.stdout.txt 2> per_gene/EOG091G10FG/MSA.stderr.txt
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/d68c9691725a7401923680874285c430.simg
[Mon Jul  6 00:06:40 2020]
Finished job 1680.
2764 of 3292 steps (84%) done

[Mon Jul  6 00:06:40 2020]
rule score_and_cut:
    input: per_gene/EOG091G10FG/EOG091G10FG.clustalo.fasta
    output: per_gene/EOG091G10FG/ALICUT_EOG091G10FG.clustalo.fasta
    jobid: 857
    wildcards: BUSCO=EOG091G10FG
    threads: 2


        cd per_gene/EOG091G10FG
        Aliscore.pl -N -r 200000000000000000 -i ../../per_gene/EOG091G10FG/EOG091G10FG.clustalo.fasta &> aliscore.log
        ALICUT.pl -s &> alicut.log
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/63c88c27a0fa300f57066b0ef65fefcb.simg
[Mon Jul  6 00:06:42 2020]
Finished job 64.
2765 of 3292 steps (84%) done

[Mon Jul  6 00:06:42 2020]
rule get_seqs:
    input: /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ingroup.txt, /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/outgroup.txt
    output: per_gene/EOG091G0QS6/EOG091G0QS6.ingroup.fasta
    log: per_gene/EOG091G0QS6/get_seqs.stdout.txt, per_gene/EOG091G0QS6/get_seqs.stderr.txt
    jobid: 3012
    wildcards: BUSCO=EOG091G0QS6
    threads: 2


	basedir=$(pwd)
        cd per_gene/EOG091G0QS6
        
        bash $basedir/../scripts/fetch_seqs.sh EOG091G0QS6 /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ingroup.txt /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/outgroup.txt 1> ../../per_gene/EOG091G0QS6/get_seqs.stdout.txt 2> ../../per_gene/EOG091G0QS6/get_seqs.stderr.txt
	mv EOG091G0QS6.fasta $basedir/per_gene/EOG091G0QS6/EOG091G0QS6.ingroup.fasta
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/72476f9d9a5bd0627b4d721143a21354.simg
[Mon Jul  6 00:06:42 2020]
Finished job 17.
2766 of 3292 steps (84%) done

[Mon Jul  6 00:06:42 2020]
rule get_seqs:
    input: /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ingroup.txt, /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/outgroup.txt
    output: per_gene/EOG091G05K5/EOG091G05K5.ingroup.fasta
    log: per_gene/EOG091G05K5/get_seqs.stdout.txt, per_gene/EOG091G05K5/get_seqs.stderr.txt
    jobid: 2540
    wildcards: BUSCO=EOG091G05K5
    threads: 2


	basedir=$(pwd)
        cd per_gene/EOG091G05K5
        
        bash $basedir/../scripts/fetch_seqs.sh EOG091G05K5 /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ingroup.txt /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/outgroup.txt 1> ../../per_gene/EOG091G05K5/get_seqs.stdout.txt 2> ../../per_gene/EOG091G05K5/get_seqs.stderr.txt
	mv EOG091G05K5.fasta $basedir/per_gene/EOG091G05K5/EOG091G05K5.ingroup.fasta
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/72476f9d9a5bd0627b4d721143a21354.simg
[Mon Jul  6 00:06:43 2020]
Finished job 640.
2767 of 3292 steps (84%) done

[Mon Jul  6 00:06:43 2020]
rule infer_single_ML:
    input: per_gene/EOG091G0GVZ/EOG091G0GVZ.best_model, per_gene/EOG091G0GVZ/ALICUT_EOG091G0GVZ.clustalo.fasta
    output: per_gene/EOG091G0GVZ/EOG091G0GVZ.raxml.done
    log: per_gene/EOG091G0GVZ/infer_single_ML.stdout.txt, per_gene/EOG091G0GVZ/infer_single_ML.stderr.txt
    jobid: 114
    wildcards: BUSCO=EOG091G0GVZ
    threads: 2


        cd per_gene/EOG091G0GVZ
	count=$(cat ../../per_gene/EOG091G0GVZ/ALICUT_EOG091G0GVZ.clustalo.fasta | grep ">" | wc -l)
	if [ "$count" -gt 5 ]
        then
		RAxMLmodel=$(cat ../../per_gene/EOG091G0GVZ/EOG091G0GVZ.best_model | grep "Best" | cut -d ":" -f 2 | tr -d '[:space:]')
                if [ "$(ls -1 | grep "^RAxML" | wc -l)" -ne 0 ]
		then
			rm RAxML*
		fi
        	raxml -f a -T 2 -m PROTGAMMA$RAxMLmodel         	-p 12345 -x 12345 -# 100         	-s ../../per_gene/EOG091G0GVZ/ALICUT_EOG091G0GVZ.clustalo.fasta -n EOG091G0GVZ.clustalo.aln.ALICUT.$RAxMLmodel 		1> ../../per_gene/EOG091G0GVZ/infer_single_ML.stdout.txt 2> ../../per_gene/EOG091G0GVZ/infer_single_ML.stderr.txt
	else
		echo "fasta file per_gene/EOG091G0GVZ/ALICUT_EOG091G0GVZ.clustalo.fasta contains fewer than 5 sequences - skipped" > ../../per_gene/EOG091G0GVZ/infer_single_ML.stdout.txt
		touch raxml.skipped
	fi
        touch ../../per_gene/EOG091G0GVZ/EOG091G0GVZ.raxml.done
        
[33mJob counts:
	count	jobs
	1	infer_single_ML
	1[0m
[33m
        cd per_gene/EOG091G0GVZ
	count=$(cat ../../per_gene/EOG091G0GVZ/ALICUT_EOG091G0GVZ.clustalo.fasta | grep ">" | wc -l)
	if [ "$count" -gt 5 ]
        then
		RAxMLmodel=$(cat ../../per_gene/EOG091G0GVZ/EOG091G0GVZ.best_model | grep "Best" | cut -d ":" -f 2 | tr -d '[:space:]')
                if [ "$(ls -1 | grep "^RAxML" | wc -l)" -ne 0 ]
		then
			rm RAxML*
		fi
        	raxml -f a -T 2 -m PROTGAMMA$RAxMLmodel         	-p 12345 -x 12345 -# 100         	-s ../../per_gene/EOG091G0GVZ/ALICUT_EOG091G0GVZ.clustalo.fasta -n EOG091G0GVZ.clustalo.aln.ALICUT.$RAxMLmodel 		1> ../../per_gene/EOG091G0GVZ/infer_single_ML.stdout.txt 2> ../../per_gene/EOG091G0GVZ/infer_single_ML.stderr.txt
	else
		echo "fasta file per_gene/EOG091G0GVZ/ALICUT_EOG091G0GVZ.clustalo.fasta contains fewer than 5 sequences - skipped" > ../../per_gene/EOG091G0GVZ/infer_single_ML.stdout.txt
		touch raxml.skipped
	fi
        touch ../../per_gene/EOG091G0GVZ/EOG091G0GVZ.raxml.done
        [0m
[Mon Jul  6 00:06:51 2020]
Finished job 857.
2768 of 3292 steps (84%) done

[Mon Jul  6 00:06:51 2020]
rule remove_empty:
    input: per_gene/EOG091G10FG/ALICUT_EOG091G10FG.clustalo.fasta
    output: per_gene/EOG091G10FG/empty_check.done
    jobid: 1679
    wildcards: BUSCO=EOG091G10FG


         if [ "$(cat per_gene/EOG091G10FG/ALICUT_EOG091G10FG.clustalo.fasta | grep -v ">" | sed 's/-//g' | grep "^$" | wc -l)" -gt 0 ]
         then
              cp per_gene/EOG091G10FG/ALICUT_EOG091G10FG.clustalo.fasta per_gene/EOG091G10FG/ALICUT_EOG091G10FG.clustalo.fasta.backup
              bash ../scripts/remove_empty.sh per_gene/EOG091G10FG/ALICUT_EOG091G10FG.clustalo.fasta.backup > per_gene/EOG091G10FG/ALICUT_EOG091G10FG.clustalo.fasta
         fi
         touch per_gene/EOG091G10FG/empty_check.done
         
[Mon Jul  6 00:06:51 2020]
Finished job 1679.
2769 of 3292 steps (84%) done

[Mon Jul  6 00:06:51 2020]
rule find_best_model:
    input: per_gene/EOG091G10FG/ALICUT_EOG091G10FG.clustalo.fasta, per_gene/EOG091G10FG/empty_check.done
    output: per_gene/EOG091G10FG/EOG091G10FG.best_model
    log: per_gene/EOG091G10FG/find_best_model.stderr.txt
    jobid: 856
    wildcards: BUSCO=EOG091G10FG
    threads: 2


        cd per_gene/EOG091G10FG
        if [ ! -d find_best_model ]
        then
            mkdir find_best_model
        fi
        cd find_best_model
        ln -s ../../../per_gene/EOG091G10FG/ALICUT_EOG091G10FG.clustalo.fasta EOG091G10FG.fasta
        ProteinModelSelection.pl EOG091G10FG.fasta 1> ../../../per_gene/EOG091G10FG/EOG091G10FG.best_model 2> ../../../per_gene/EOG091G10FG/find_best_model.stderr.txt
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/c0c09ee657b1e27f2c5687e0e9aa8d70.simg
[Mon Jul  6 00:06:56 2020]
Finished job 3012.
2770 of 3292 steps (84%) done

[Mon Jul  6 00:06:57 2020]
rule get_outgroups:
    input: per_gene/EOG091G0QS6/EOG091G0QS6.ingroup.fasta
    output: per_gene/EOG091G0QS6/EOG091G0QS6.orthodb.fasta, per_gene/EOG091G0QS6/EOG091G0QS6.outgroup.fasta
    log: per_gene/EOG091G0QS6/get_outgroups.stdout.txt, per_gene/EOG091G0QS6/get_outgroups.stderr.txt
    jobid: 3013
    wildcards: BUSCO=EOG091G0QS6


        #download fastas from Orhtodb for BUSCO id
        for i in {1..5}
        do
             wget "http://www.orthodb.org/fasta?query=EOG091G0QS6&level=33208" -O per_gene/EOG091G0QS6/EOG091G0QS6.orthodb.fasta 1> per_gene/EOG091G0QS6/get_outgroups.stdout.txt 2> per_gene/EOG091G0QS6/get_outgroups.stderr.txt && break || echo -e "try again ($i)" && sleep 15
        done

	#This is quick an dirty for now and just takes the first protein if there is more than one for an outgroup taxon
        bash ../scripts/download_outgroups.sh taxids.txt per_gene/EOG091G0QS6/EOG091G0QS6.orthodb.fasta > per_gene/EOG091G0QS6/EOG091G0QS6.outgroup.fasta
        
[Mon Jul  6 00:06:57 2020]
Finished job 2540.
2771 of 3292 steps (84%) done

[Mon Jul  6 00:06:57 2020]
rule get_outgroups:
    input: per_gene/EOG091G05K5/EOG091G05K5.ingroup.fasta
    output: per_gene/EOG091G05K5/EOG091G05K5.orthodb.fasta, per_gene/EOG091G05K5/EOG091G05K5.outgroup.fasta
    log: per_gene/EOG091G05K5/get_outgroups.stdout.txt, per_gene/EOG091G05K5/get_outgroups.stderr.txt
    jobid: 2541
    wildcards: BUSCO=EOG091G05K5


        #download fastas from Orhtodb for BUSCO id
        for i in {1..5}
        do
             wget "http://www.orthodb.org/fasta?query=EOG091G05K5&level=33208" -O per_gene/EOG091G05K5/EOG091G05K5.orthodb.fasta 1> per_gene/EOG091G05K5/get_outgroups.stdout.txt 2> per_gene/EOG091G05K5/get_outgroups.stderr.txt && break || echo -e "try again ($i)" && sleep 15
        done

	#This is quick an dirty for now and just takes the first protein if there is more than one for an outgroup taxon
        bash ../scripts/download_outgroups.sh taxids.txt per_gene/EOG091G05K5/EOG091G05K5.orthodb.fasta > per_gene/EOG091G05K5/EOG091G05K5.outgroup.fasta
        

[Mon Jul  6 00:06:57 2020]
rule get_seqs:
    input: /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ingroup.txt, /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/outgroup.txt
    output: per_gene/EOG091G0MY0/EOG091G0MY0.ingroup.fasta
    log: per_gene/EOG091G0MY0/get_seqs.stdout.txt, per_gene/EOG091G0MY0/get_seqs.stderr.txt
    jobid: 2774
    wildcards: BUSCO=EOG091G0MY0
    threads: 2


	basedir=$(pwd)
        cd per_gene/EOG091G0MY0
        
        bash $basedir/../scripts/fetch_seqs.sh EOG091G0MY0 /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ingroup.txt /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/outgroup.txt 1> ../../per_gene/EOG091G0MY0/get_seqs.stdout.txt 2> ../../per_gene/EOG091G0MY0/get_seqs.stderr.txt
	mv EOG091G0MY0.fasta $basedir/per_gene/EOG091G0MY0/EOG091G0MY0.ingroup.fasta
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/72476f9d9a5bd0627b4d721143a21354.simg
[Mon Jul  6 00:06:57 2020]
Finished job 3013.
2772 of 3292 steps (84%) done

[Mon Jul  6 00:06:57 2020]
rule join_groups:
    input: per_gene/EOG091G0QS6/EOG091G0QS6.ingroup.fasta, per_gene/EOG091G0QS6/EOG091G0QS6.outgroup.fasta
    output: per_gene/EOG091G0QS6/EOG091G0QS6.fasta
    jobid: 2330
    wildcards: BUSCO=EOG091G0QS6


        cat per_gene/EOG091G0QS6/EOG091G0QS6.ingroup.fasta per_gene/EOG091G0QS6/EOG091G0QS6.outgroup.fasta > per_gene/EOG091G0QS6/EOG091G0QS6.fasta
        
[Mon Jul  6 00:06:57 2020]
Finished job 2330.
2773 of 3292 steps (84%) done
[Mon Jul  6 00:06:58 2020]
Finished job 2541.
2774 of 3292 steps (84%) done

[Mon Jul  6 00:06:58 2020]
rule join_groups:
    input: per_gene/EOG091G05K5/EOG091G05K5.ingroup.fasta, per_gene/EOG091G05K5/EOG091G05K5.outgroup.fasta
    output: per_gene/EOG091G05K5/EOG091G05K5.fasta
    jobid: 2094
    wildcards: BUSCO=EOG091G05K5


        cat per_gene/EOG091G05K5/EOG091G05K5.ingroup.fasta per_gene/EOG091G05K5/EOG091G05K5.outgroup.fasta > per_gene/EOG091G05K5/EOG091G05K5.fasta
        
[Mon Jul  6 00:06:58 2020]
Finished job 2094.
2775 of 3292 steps (84%) done

[Mon Jul  6 00:06:58 2020]
rule MSA:
    input: per_gene/EOG091G05K5/EOG091G05K5.fasta
    output: per_gene/EOG091G05K5/EOG091G05K5.clustalo.fasta
    log: per_gene/EOG091G05K5/MSA.stdout.txt, per_gene/EOG091G05K5/MSA.stderr.txt
    jobid: 1308
    wildcards: BUSCO=EOG091G05K5
    threads: 2


        clustalo -i per_gene/EOG091G05K5/EOG091G05K5.fasta -o per_gene/EOG091G05K5/EOG091G05K5.clustalo.fasta --threads=2 1> per_gene/EOG091G05K5/MSA.stdout.txt 2> per_gene/EOG091G05K5/MSA.stderr.txt
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/d68c9691725a7401923680874285c430.simg
[Mon Jul  6 00:07:00 2020]
Finished job 1308.
2776 of 3292 steps (84%) done

[Mon Jul  6 00:07:00 2020]
rule score_and_cut:
    input: per_gene/EOG091G05K5/EOG091G05K5.clustalo.fasta
    output: per_gene/EOG091G05K5/ALICUT_EOG091G05K5.clustalo.fasta
    jobid: 485
    wildcards: BUSCO=EOG091G05K5
    threads: 2


        cd per_gene/EOG091G05K5
        Aliscore.pl -N -r 200000000000000000 -i ../../per_gene/EOG091G05K5/EOG091G05K5.clustalo.fasta &> aliscore.log
        ALICUT.pl -s &> alicut.log
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/63c88c27a0fa300f57066b0ef65fefcb.simg
[Mon Jul  6 00:07:12 2020]
Finished job 485.
2777 of 3292 steps (84%) done

[Mon Jul  6 00:07:12 2020]
rule remove_empty:
    input: per_gene/EOG091G05K5/ALICUT_EOG091G05K5.clustalo.fasta
    output: per_gene/EOG091G05K5/empty_check.done
    jobid: 1307
    wildcards: BUSCO=EOG091G05K5


         if [ "$(cat per_gene/EOG091G05K5/ALICUT_EOG091G05K5.clustalo.fasta | grep -v ">" | sed 's/-//g' | grep "^$" | wc -l)" -gt 0 ]
         then
              cp per_gene/EOG091G05K5/ALICUT_EOG091G05K5.clustalo.fasta per_gene/EOG091G05K5/ALICUT_EOG091G05K5.clustalo.fasta.backup
              bash ../scripts/remove_empty.sh per_gene/EOG091G05K5/ALICUT_EOG091G05K5.clustalo.fasta.backup > per_gene/EOG091G05K5/ALICUT_EOG091G05K5.clustalo.fasta
         fi
         touch per_gene/EOG091G05K5/empty_check.done
         
[Mon Jul  6 00:07:12 2020]
Finished job 1307.
2778 of 3292 steps (84%) done

[Mon Jul  6 00:07:12 2020]
rule find_best_model:
    input: per_gene/EOG091G05K5/ALICUT_EOG091G05K5.clustalo.fasta, per_gene/EOG091G05K5/empty_check.done
    output: per_gene/EOG091G05K5/EOG091G05K5.best_model
    log: per_gene/EOG091G05K5/find_best_model.stderr.txt
    jobid: 484
    wildcards: BUSCO=EOG091G05K5
    threads: 2


        cd per_gene/EOG091G05K5
        if [ ! -d find_best_model ]
        then
            mkdir find_best_model
        fi
        cd find_best_model
        ln -s ../../../per_gene/EOG091G05K5/ALICUT_EOG091G05K5.clustalo.fasta EOG091G05K5.fasta
        ProteinModelSelection.pl EOG091G05K5.fasta 1> ../../../per_gene/EOG091G05K5/EOG091G05K5.best_model 2> ../../../per_gene/EOG091G05K5/find_best_model.stderr.txt
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/c0c09ee657b1e27f2c5687e0e9aa8d70.simg
[Mon Jul  6 00:07:13 2020]
Finished job 2774.
2779 of 3292 steps (84%) done

[Mon Jul  6 00:07:13 2020]
rule get_outgroups:
    input: per_gene/EOG091G0MY0/EOG091G0MY0.ingroup.fasta
    output: per_gene/EOG091G0MY0/EOG091G0MY0.orthodb.fasta, per_gene/EOG091G0MY0/EOG091G0MY0.outgroup.fasta
    log: per_gene/EOG091G0MY0/get_outgroups.stdout.txt, per_gene/EOG091G0MY0/get_outgroups.stderr.txt
    jobid: 2775
    wildcards: BUSCO=EOG091G0MY0


        #download fastas from Orhtodb for BUSCO id
        for i in {1..5}
        do
             wget "http://www.orthodb.org/fasta?query=EOG091G0MY0&level=33208" -O per_gene/EOG091G0MY0/EOG091G0MY0.orthodb.fasta 1> per_gene/EOG091G0MY0/get_outgroups.stdout.txt 2> per_gene/EOG091G0MY0/get_outgroups.stderr.txt && break || echo -e "try again ($i)" && sleep 15
        done

	#This is quick an dirty for now and just takes the first protein if there is more than one for an outgroup taxon
        bash ../scripts/download_outgroups.sh taxids.txt per_gene/EOG091G0MY0/EOG091G0MY0.orthodb.fasta > per_gene/EOG091G0MY0/EOG091G0MY0.outgroup.fasta
        
[Mon Jul  6 00:07:13 2020]
Finished job 856.
2780 of 3292 steps (84%) done

[Mon Jul  6 00:07:13 2020]
rule MSA:
    input: per_gene/EOG091G0QS6/EOG091G0QS6.fasta
    output: per_gene/EOG091G0QS6/EOG091G0QS6.clustalo.fasta
    log: per_gene/EOG091G0QS6/MSA.stdout.txt, per_gene/EOG091G0QS6/MSA.stderr.txt
    jobid: 1780
    wildcards: BUSCO=EOG091G0QS6
    threads: 2


        clustalo -i per_gene/EOG091G0QS6/EOG091G0QS6.fasta -o per_gene/EOG091G0QS6/EOG091G0QS6.clustalo.fasta --threads=2 1> per_gene/EOG091G0QS6/MSA.stdout.txt 2> per_gene/EOG091G0QS6/MSA.stderr.txt
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/d68c9691725a7401923680874285c430.simg
[Mon Jul  6 00:07:13 2020]
Finished job 2775.
2781 of 3292 steps (84%) done

[Mon Jul  6 00:07:13 2020]
rule join_groups:
    input: per_gene/EOG091G0MY0/EOG091G0MY0.ingroup.fasta, per_gene/EOG091G0MY0/EOG091G0MY0.outgroup.fasta
    output: per_gene/EOG091G0MY0/EOG091G0MY0.fasta
    jobid: 2211
    wildcards: BUSCO=EOG091G0MY0


        cat per_gene/EOG091G0MY0/EOG091G0MY0.ingroup.fasta per_gene/EOG091G0MY0/EOG091G0MY0.outgroup.fasta > per_gene/EOG091G0MY0/EOG091G0MY0.fasta
        
[Mon Jul  6 00:07:14 2020]
Finished job 2211.
2782 of 3292 steps (85%) done

[Mon Jul  6 00:07:14 2020]
rule MSA:
    input: per_gene/EOG091G0MY0/EOG091G0MY0.fasta
    output: per_gene/EOG091G0MY0/EOG091G0MY0.clustalo.fasta
    log: per_gene/EOG091G0MY0/MSA.stdout.txt, per_gene/EOG091G0MY0/MSA.stderr.txt
    jobid: 1542
    wildcards: BUSCO=EOG091G0MY0
    threads: 2


        clustalo -i per_gene/EOG091G0MY0/EOG091G0MY0.fasta -o per_gene/EOG091G0MY0/EOG091G0MY0.clustalo.fasta --threads=2 1> per_gene/EOG091G0MY0/MSA.stdout.txt 2> per_gene/EOG091G0MY0/MSA.stderr.txt
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/d68c9691725a7401923680874285c430.simg
[Mon Jul  6 00:07:14 2020]
Finished job 1780.
2783 of 3292 steps (85%) done

[Mon Jul  6 00:07:14 2020]
rule score_and_cut:
    input: per_gene/EOG091G0QS6/EOG091G0QS6.clustalo.fasta
    output: per_gene/EOG091G0QS6/ALICUT_EOG091G0QS6.clustalo.fasta
    jobid: 957
    wildcards: BUSCO=EOG091G0QS6
    threads: 2


        cd per_gene/EOG091G0QS6
        Aliscore.pl -N -r 200000000000000000 -i ../../per_gene/EOG091G0QS6/EOG091G0QS6.clustalo.fasta &> aliscore.log
        ALICUT.pl -s &> alicut.log
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/63c88c27a0fa300f57066b0ef65fefcb.simg
[Mon Jul  6 00:07:14 2020]
Finished job 1542.
2784 of 3292 steps (85%) done

[Mon Jul  6 00:07:14 2020]
rule score_and_cut:
    input: per_gene/EOG091G0MY0/EOG091G0MY0.clustalo.fasta
    output: per_gene/EOG091G0MY0/ALICUT_EOG091G0MY0.clustalo.fasta
    jobid: 719
    wildcards: BUSCO=EOG091G0MY0
    threads: 2


        cd per_gene/EOG091G0MY0
        Aliscore.pl -N -r 200000000000000000 -i ../../per_gene/EOG091G0MY0/EOG091G0MY0.clustalo.fasta &> aliscore.log
        ALICUT.pl -s &> alicut.log
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/63c88c27a0fa300f57066b0ef65fefcb.simg
[Mon Jul  6 00:07:20 2020]
Finished job 139.
2785 of 3292 steps (85%) done

[Mon Jul  6 00:07:20 2020]
rule infer_single_ML:
    input: per_gene/EOG091G10FG/EOG091G10FG.best_model, per_gene/EOG091G10FG/ALICUT_EOG091G10FG.clustalo.fasta
    output: per_gene/EOG091G10FG/EOG091G10FG.raxml.done
    log: per_gene/EOG091G10FG/infer_single_ML.stdout.txt, per_gene/EOG091G10FG/infer_single_ML.stderr.txt
    jobid: 222
    wildcards: BUSCO=EOG091G10FG
    threads: 2


        cd per_gene/EOG091G10FG
	count=$(cat ../../per_gene/EOG091G10FG/ALICUT_EOG091G10FG.clustalo.fasta | grep ">" | wc -l)
	if [ "$count" -gt 5 ]
        then
		RAxMLmodel=$(cat ../../per_gene/EOG091G10FG/EOG091G10FG.best_model | grep "Best" | cut -d ":" -f 2 | tr -d '[:space:]')
                if [ "$(ls -1 | grep "^RAxML" | wc -l)" -ne 0 ]
		then
			rm RAxML*
		fi
        	raxml -f a -T 2 -m PROTGAMMA$RAxMLmodel         	-p 12345 -x 12345 -# 100         	-s ../../per_gene/EOG091G10FG/ALICUT_EOG091G10FG.clustalo.fasta -n EOG091G10FG.clustalo.aln.ALICUT.$RAxMLmodel 		1> ../../per_gene/EOG091G10FG/infer_single_ML.stdout.txt 2> ../../per_gene/EOG091G10FG/infer_single_ML.stderr.txt
	else
		echo "fasta file per_gene/EOG091G10FG/ALICUT_EOG091G10FG.clustalo.fasta contains fewer than 5 sequences - skipped" > ../../per_gene/EOG091G10FG/infer_single_ML.stdout.txt
		touch raxml.skipped
	fi
        touch ../../per_gene/EOG091G10FG/EOG091G10FG.raxml.done
        
[Mon Jul  6 00:07:22 2020]
Finished job 46.
2786 of 3292 steps (85%) done

[Mon Jul  6 00:07:22 2020]
rule get_seqs:
    input: /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ingroup.txt, /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/outgroup.txt
    output: per_gene/EOG091G0QJA/EOG091G0QJA.ingroup.fasta
    log: per_gene/EOG091G0QJA/get_seqs.stdout.txt, per_gene/EOG091G0QJA/get_seqs.stderr.txt
    jobid: 2814
    wildcards: BUSCO=EOG091G0QJA
    threads: 2


	basedir=$(pwd)
        cd per_gene/EOG091G0QJA
        
        bash $basedir/../scripts/fetch_seqs.sh EOG091G0QJA /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ingroup.txt /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/outgroup.txt 1> ../../per_gene/EOG091G0QJA/get_seqs.stdout.txt 2> ../../per_gene/EOG091G0QJA/get_seqs.stderr.txt
	mv EOG091G0QJA.fasta $basedir/per_gene/EOG091G0QJA/EOG091G0QJA.ingroup.fasta
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/72476f9d9a5bd0627b4d721143a21354.simg
[33mJob counts:
	count	jobs
	1	infer_single_ML
	1[0m
[33m
        cd per_gene/EOG091G10FG
	count=$(cat ../../per_gene/EOG091G10FG/ALICUT_EOG091G10FG.clustalo.fasta | grep ">" | wc -l)
	if [ "$count" -gt 5 ]
        then
		RAxMLmodel=$(cat ../../per_gene/EOG091G10FG/EOG091G10FG.best_model | grep "Best" | cut -d ":" -f 2 | tr -d '[:space:]')
                if [ "$(ls -1 | grep "^RAxML" | wc -l)" -ne 0 ]
		then
			rm RAxML*
		fi
        	raxml -f a -T 2 -m PROTGAMMA$RAxMLmodel         	-p 12345 -x 12345 -# 100         	-s ../../per_gene/EOG091G10FG/ALICUT_EOG091G10FG.clustalo.fasta -n EOG091G10FG.clustalo.aln.ALICUT.$RAxMLmodel 		1> ../../per_gene/EOG091G10FG/infer_single_ML.stdout.txt 2> ../../per_gene/EOG091G10FG/infer_single_ML.stderr.txt
	else
		echo "fasta file per_gene/EOG091G10FG/ALICUT_EOG091G10FG.clustalo.fasta contains fewer than 5 sequences - skipped" > ../../per_gene/EOG091G10FG/infer_single_ML.stdout.txt
		touch raxml.skipped
	fi
        touch ../../per_gene/EOG091G10FG/EOG091G10FG.raxml.done
        [0m
[Mon Jul  6 00:07:25 2020]
Finished job 957.
2787 of 3292 steps (85%) done

[Mon Jul  6 00:07:25 2020]
rule remove_empty:
    input: per_gene/EOG091G0QS6/ALICUT_EOG091G0QS6.clustalo.fasta
    output: per_gene/EOG091G0QS6/empty_check.done
    jobid: 1779
    wildcards: BUSCO=EOG091G0QS6


         if [ "$(cat per_gene/EOG091G0QS6/ALICUT_EOG091G0QS6.clustalo.fasta | grep -v ">" | sed 's/-//g' | grep "^$" | wc -l)" -gt 0 ]
         then
              cp per_gene/EOG091G0QS6/ALICUT_EOG091G0QS6.clustalo.fasta per_gene/EOG091G0QS6/ALICUT_EOG091G0QS6.clustalo.fasta.backup
              bash ../scripts/remove_empty.sh per_gene/EOG091G0QS6/ALICUT_EOG091G0QS6.clustalo.fasta.backup > per_gene/EOG091G0QS6/ALICUT_EOG091G0QS6.clustalo.fasta
         fi
         touch per_gene/EOG091G0QS6/empty_check.done
         
[Mon Jul  6 00:07:25 2020]
Finished job 1779.
2788 of 3292 steps (85%) done

[Mon Jul  6 00:07:25 2020]
rule find_best_model:
    input: per_gene/EOG091G0QS6/ALICUT_EOG091G0QS6.clustalo.fasta, per_gene/EOG091G0QS6/empty_check.done
    output: per_gene/EOG091G0QS6/EOG091G0QS6.best_model
    log: per_gene/EOG091G0QS6/find_best_model.stderr.txt
    jobid: 956
    wildcards: BUSCO=EOG091G0QS6
    threads: 2


        cd per_gene/EOG091G0QS6
        if [ ! -d find_best_model ]
        then
            mkdir find_best_model
        fi
        cd find_best_model
        ln -s ../../../per_gene/EOG091G0QS6/ALICUT_EOG091G0QS6.clustalo.fasta EOG091G0QS6.fasta
        ProteinModelSelection.pl EOG091G0QS6.fasta 1> ../../../per_gene/EOG091G0QS6/EOG091G0QS6.best_model 2> ../../../per_gene/EOG091G0QS6/find_best_model.stderr.txt
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/c0c09ee657b1e27f2c5687e0e9aa8d70.simg
[Mon Jul  6 00:07:27 2020]
Finished job 719.
2789 of 3292 steps (85%) done

[Mon Jul  6 00:07:27 2020]
rule remove_empty:
    input: per_gene/EOG091G0MY0/ALICUT_EOG091G0MY0.clustalo.fasta
    output: per_gene/EOG091G0MY0/empty_check.done
    jobid: 1541
    wildcards: BUSCO=EOG091G0MY0


         if [ "$(cat per_gene/EOG091G0MY0/ALICUT_EOG091G0MY0.clustalo.fasta | grep -v ">" | sed 's/-//g' | grep "^$" | wc -l)" -gt 0 ]
         then
              cp per_gene/EOG091G0MY0/ALICUT_EOG091G0MY0.clustalo.fasta per_gene/EOG091G0MY0/ALICUT_EOG091G0MY0.clustalo.fasta.backup
              bash ../scripts/remove_empty.sh per_gene/EOG091G0MY0/ALICUT_EOG091G0MY0.clustalo.fasta.backup > per_gene/EOG091G0MY0/ALICUT_EOG091G0MY0.clustalo.fasta
         fi
         touch per_gene/EOG091G0MY0/empty_check.done
         
[Mon Jul  6 00:07:27 2020]
Finished job 1541.
2790 of 3292 steps (85%) done

[Mon Jul  6 00:07:27 2020]
rule find_best_model:
    input: per_gene/EOG091G0MY0/ALICUT_EOG091G0MY0.clustalo.fasta, per_gene/EOG091G0MY0/empty_check.done
    output: per_gene/EOG091G0MY0/EOG091G0MY0.best_model
    log: per_gene/EOG091G0MY0/find_best_model.stderr.txt
    jobid: 718
    wildcards: BUSCO=EOG091G0MY0
    threads: 2


        cd per_gene/EOG091G0MY0
        if [ ! -d find_best_model ]
        then
            mkdir find_best_model
        fi
        cd find_best_model
        ln -s ../../../per_gene/EOG091G0MY0/ALICUT_EOG091G0MY0.clustalo.fasta EOG091G0MY0.fasta
        ProteinModelSelection.pl EOG091G0MY0.fasta 1> ../../../per_gene/EOG091G0MY0/EOG091G0MY0.best_model 2> ../../../per_gene/EOG091G0MY0/find_best_model.stderr.txt
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/c0c09ee657b1e27f2c5687e0e9aa8d70.simg
[Mon Jul  6 00:07:39 2020]
Finished job 2814.
2791 of 3292 steps (85%) done

[Mon Jul  6 00:07:39 2020]
rule get_outgroups:
    input: per_gene/EOG091G0QJA/EOG091G0QJA.ingroup.fasta
    output: per_gene/EOG091G0QJA/EOG091G0QJA.orthodb.fasta, per_gene/EOG091G0QJA/EOG091G0QJA.outgroup.fasta
    log: per_gene/EOG091G0QJA/get_outgroups.stdout.txt, per_gene/EOG091G0QJA/get_outgroups.stderr.txt
    jobid: 2815
    wildcards: BUSCO=EOG091G0QJA


        #download fastas from Orhtodb for BUSCO id
        for i in {1..5}
        do
             wget "http://www.orthodb.org/fasta?query=EOG091G0QJA&level=33208" -O per_gene/EOG091G0QJA/EOG091G0QJA.orthodb.fasta 1> per_gene/EOG091G0QJA/get_outgroups.stdout.txt 2> per_gene/EOG091G0QJA/get_outgroups.stderr.txt && break || echo -e "try again ($i)" && sleep 15
        done

	#This is quick an dirty for now and just takes the first protein if there is more than one for an outgroup taxon
        bash ../scripts/download_outgroups.sh taxids.txt per_gene/EOG091G0QJA/EOG091G0QJA.orthodb.fasta > per_gene/EOG091G0QJA/EOG091G0QJA.outgroup.fasta
        
[Mon Jul  6 00:07:39 2020]
Finished job 220.
2792 of 3292 steps (85%) done

[Mon Jul  6 00:07:39 2020]
rule get_seqs:
    input: /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ingroup.txt, /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/outgroup.txt
    output: per_gene/EOG091G04EX/EOG091G04EX.ingroup.fasta
    log: per_gene/EOG091G04EX/get_seqs.stdout.txt, per_gene/EOG091G04EX/get_seqs.stderr.txt
    jobid: 2524
    wildcards: BUSCO=EOG091G04EX
    threads: 2


	basedir=$(pwd)
        cd per_gene/EOG091G04EX
        
        bash $basedir/../scripts/fetch_seqs.sh EOG091G04EX /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ingroup.txt /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/outgroup.txt 1> ../../per_gene/EOG091G04EX/get_seqs.stdout.txt 2> ../../per_gene/EOG091G04EX/get_seqs.stderr.txt
	mv EOG091G04EX.fasta $basedir/per_gene/EOG091G04EX/EOG091G04EX.ingroup.fasta
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/72476f9d9a5bd0627b4d721143a21354.simg
[Mon Jul  6 00:07:40 2020]
Finished job 2815.
2793 of 3292 steps (85%) done

[Mon Jul  6 00:07:40 2020]
rule join_groups:
    input: per_gene/EOG091G0QJA/EOG091G0QJA.ingroup.fasta, per_gene/EOG091G0QJA/EOG091G0QJA.outgroup.fasta
    output: per_gene/EOG091G0QJA/EOG091G0QJA.fasta
    jobid: 2231
    wildcards: BUSCO=EOG091G0QJA


        cat per_gene/EOG091G0QJA/EOG091G0QJA.ingroup.fasta per_gene/EOG091G0QJA/EOG091G0QJA.outgroup.fasta > per_gene/EOG091G0QJA/EOG091G0QJA.fasta
        
[Mon Jul  6 00:07:40 2020]
Finished job 2231.
2794 of 3292 steps (85%) done

[Mon Jul  6 00:07:40 2020]
rule MSA:
    input: per_gene/EOG091G0QJA/EOG091G0QJA.fasta
    output: per_gene/EOG091G0QJA/EOG091G0QJA.clustalo.fasta
    log: per_gene/EOG091G0QJA/MSA.stdout.txt, per_gene/EOG091G0QJA/MSA.stderr.txt
    jobid: 1582
    wildcards: BUSCO=EOG091G0QJA
    threads: 2


        clustalo -i per_gene/EOG091G0QJA/EOG091G0QJA.fasta -o per_gene/EOG091G0QJA/EOG091G0QJA.clustalo.fasta --threads=2 1> per_gene/EOG091G0QJA/MSA.stdout.txt 2> per_gene/EOG091G0QJA/MSA.stderr.txt
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/d68c9691725a7401923680874285c430.simg
[Mon Jul  6 00:07:40 2020]
Finished job 1582.
2795 of 3292 steps (85%) done

[Mon Jul  6 00:07:40 2020]
rule score_and_cut:
    input: per_gene/EOG091G0QJA/EOG091G0QJA.clustalo.fasta
    output: per_gene/EOG091G0QJA/ALICUT_EOG091G0QJA.clustalo.fasta
    jobid: 759
    wildcards: BUSCO=EOG091G0QJA
    threads: 2


        cd per_gene/EOG091G0QJA
        Aliscore.pl -N -r 200000000000000000 -i ../../per_gene/EOG091G0QJA/EOG091G0QJA.clustalo.fasta &> aliscore.log
        ALICUT.pl -s &> alicut.log
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/63c88c27a0fa300f57066b0ef65fefcb.simg
[Mon Jul  6 00:07:50 2020]
Finished job 759.
2796 of 3292 steps (85%) done

[Mon Jul  6 00:07:50 2020]
rule remove_empty:
    input: per_gene/EOG091G0QJA/ALICUT_EOG091G0QJA.clustalo.fasta
    output: per_gene/EOG091G0QJA/empty_check.done
    jobid: 1581
    wildcards: BUSCO=EOG091G0QJA


         if [ "$(cat per_gene/EOG091G0QJA/ALICUT_EOG091G0QJA.clustalo.fasta | grep -v ">" | sed 's/-//g' | grep "^$" | wc -l)" -gt 0 ]
         then
              cp per_gene/EOG091G0QJA/ALICUT_EOG091G0QJA.clustalo.fasta per_gene/EOG091G0QJA/ALICUT_EOG091G0QJA.clustalo.fasta.backup
              bash ../scripts/remove_empty.sh per_gene/EOG091G0QJA/ALICUT_EOG091G0QJA.clustalo.fasta.backup > per_gene/EOG091G0QJA/ALICUT_EOG091G0QJA.clustalo.fasta
         fi
         touch per_gene/EOG091G0QJA/empty_check.done
         
[Mon Jul  6 00:07:50 2020]
Finished job 1581.
2797 of 3292 steps (85%) done

[Mon Jul  6 00:07:50 2020]
rule find_best_model:
    input: per_gene/EOG091G0QJA/ALICUT_EOG091G0QJA.clustalo.fasta, per_gene/EOG091G0QJA/empty_check.done
    output: per_gene/EOG091G0QJA/EOG091G0QJA.best_model
    log: per_gene/EOG091G0QJA/find_best_model.stderr.txt
    jobid: 758
    wildcards: BUSCO=EOG091G0QJA
    threads: 2


        cd per_gene/EOG091G0QJA
        if [ ! -d find_best_model ]
        then
            mkdir find_best_model
        fi
        cd find_best_model
        ln -s ../../../per_gene/EOG091G0QJA/ALICUT_EOG091G0QJA.clustalo.fasta EOG091G0QJA.fasta
        ProteinModelSelection.pl EOG091G0QJA.fasta 1> ../../../per_gene/EOG091G0QJA/EOG091G0QJA.best_model 2> ../../../per_gene/EOG091G0QJA/find_best_model.stderr.txt
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/c0c09ee657b1e27f2c5687e0e9aa8d70.simg
[Mon Jul  6 00:07:51 2020]
Finished job 956.
2798 of 3292 steps (85%) done

[Mon Jul  6 00:07:51 2020]
rule infer_single_ML:
    input: per_gene/EOG091G0QS6/EOG091G0QS6.best_model, per_gene/EOG091G0QS6/ALICUT_EOG091G0QS6.clustalo.fasta
    output: per_gene/EOG091G0QS6/EOG091G0QS6.raxml.done
    log: per_gene/EOG091G0QS6/infer_single_ML.stdout.txt, per_gene/EOG091G0QS6/infer_single_ML.stderr.txt
    jobid: 272
    wildcards: BUSCO=EOG091G0QS6
    threads: 2


        cd per_gene/EOG091G0QS6
	count=$(cat ../../per_gene/EOG091G0QS6/ALICUT_EOG091G0QS6.clustalo.fasta | grep ">" | wc -l)
	if [ "$count" -gt 5 ]
        then
		RAxMLmodel=$(cat ../../per_gene/EOG091G0QS6/EOG091G0QS6.best_model | grep "Best" | cut -d ":" -f 2 | tr -d '[:space:]')
                if [ "$(ls -1 | grep "^RAxML" | wc -l)" -ne 0 ]
		then
			rm RAxML*
		fi
        	raxml -f a -T 2 -m PROTGAMMA$RAxMLmodel         	-p 12345 -x 12345 -# 100         	-s ../../per_gene/EOG091G0QS6/ALICUT_EOG091G0QS6.clustalo.fasta -n EOG091G0QS6.clustalo.aln.ALICUT.$RAxMLmodel 		1> ../../per_gene/EOG091G0QS6/infer_single_ML.stdout.txt 2> ../../per_gene/EOG091G0QS6/infer_single_ML.stderr.txt
	else
		echo "fasta file per_gene/EOG091G0QS6/ALICUT_EOG091G0QS6.clustalo.fasta contains fewer than 5 sequences - skipped" > ../../per_gene/EOG091G0QS6/infer_single_ML.stdout.txt
		touch raxml.skipped
	fi
        touch ../../per_gene/EOG091G0QS6/EOG091G0QS6.raxml.done
        
[33mJob counts:
	count	jobs
	1	infer_single_ML
	1[0m
[33m
        cd per_gene/EOG091G0QS6
	count=$(cat ../../per_gene/EOG091G0QS6/ALICUT_EOG091G0QS6.clustalo.fasta | grep ">" | wc -l)
	if [ "$count" -gt 5 ]
        then
		RAxMLmodel=$(cat ../../per_gene/EOG091G0QS6/EOG091G0QS6.best_model | grep "Best" | cut -d ":" -f 2 | tr -d '[:space:]')
                if [ "$(ls -1 | grep "^RAxML" | wc -l)" -ne 0 ]
		then
			rm RAxML*
		fi
        	raxml -f a -T 2 -m PROTGAMMA$RAxMLmodel         	-p 12345 -x 12345 -# 100         	-s ../../per_gene/EOG091G0QS6/ALICUT_EOG091G0QS6.clustalo.fasta -n EOG091G0QS6.clustalo.aln.ALICUT.$RAxMLmodel 		1> ../../per_gene/EOG091G0QS6/infer_single_ML.stdout.txt 2> ../../per_gene/EOG091G0QS6/infer_single_ML.stderr.txt
	else
		echo "fasta file per_gene/EOG091G0QS6/ALICUT_EOG091G0QS6.clustalo.fasta contains fewer than 5 sequences - skipped" > ../../per_gene/EOG091G0QS6/infer_single_ML.stdout.txt
		touch raxml.skipped
	fi
        touch ../../per_gene/EOG091G0QS6/EOG091G0QS6.raxml.done
        [0m
[Mon Jul  6 00:07:57 2020]
Finished job 2524.
2799 of 3292 steps (85%) done

[Mon Jul  6 00:07:57 2020]
rule get_outgroups:
    input: per_gene/EOG091G04EX/EOG091G04EX.ingroup.fasta
    output: per_gene/EOG091G04EX/EOG091G04EX.orthodb.fasta, per_gene/EOG091G04EX/EOG091G04EX.outgroup.fasta
    log: per_gene/EOG091G04EX/get_outgroups.stdout.txt, per_gene/EOG091G04EX/get_outgroups.stderr.txt
    jobid: 2525
    wildcards: BUSCO=EOG091G04EX


        #download fastas from Orhtodb for BUSCO id
        for i in {1..5}
        do
             wget "http://www.orthodb.org/fasta?query=EOG091G04EX&level=33208" -O per_gene/EOG091G04EX/EOG091G04EX.orthodb.fasta 1> per_gene/EOG091G04EX/get_outgroups.stdout.txt 2> per_gene/EOG091G04EX/get_outgroups.stderr.txt && break || echo -e "try again ($i)" && sleep 15
        done

	#This is quick an dirty for now and just takes the first protein if there is more than one for an outgroup taxon
        bash ../scripts/download_outgroups.sh taxids.txt per_gene/EOG091G04EX/EOG091G04EX.orthodb.fasta > per_gene/EOG091G04EX/EOG091G04EX.outgroup.fasta
        
[Mon Jul  6 00:07:58 2020]
Finished job 2525.
2800 of 3292 steps (85%) done

[Mon Jul  6 00:07:58 2020]
rule join_groups:
    input: per_gene/EOG091G04EX/EOG091G04EX.ingroup.fasta, per_gene/EOG091G04EX/EOG091G04EX.outgroup.fasta
    output: per_gene/EOG091G04EX/EOG091G04EX.fasta
    jobid: 2086
    wildcards: BUSCO=EOG091G04EX


        cat per_gene/EOG091G04EX/EOG091G04EX.ingroup.fasta per_gene/EOG091G04EX/EOG091G04EX.outgroup.fasta > per_gene/EOG091G04EX/EOG091G04EX.fasta
        
[Mon Jul  6 00:07:59 2020]
Finished job 2086.
2801 of 3292 steps (85%) done

[Mon Jul  6 00:07:59 2020]
rule MSA:
    input: per_gene/EOG091G04EX/EOG091G04EX.fasta
    output: per_gene/EOG091G04EX/EOG091G04EX.clustalo.fasta
    log: per_gene/EOG091G04EX/MSA.stdout.txt, per_gene/EOG091G04EX/MSA.stderr.txt
    jobid: 1292
    wildcards: BUSCO=EOG091G04EX
    threads: 2


        clustalo -i per_gene/EOG091G04EX/EOG091G04EX.fasta -o per_gene/EOG091G04EX/EOG091G04EX.clustalo.fasta --threads=2 1> per_gene/EOG091G04EX/MSA.stdout.txt 2> per_gene/EOG091G04EX/MSA.stderr.txt
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/d68c9691725a7401923680874285c430.simg
[Mon Jul  6 00:08:00 2020]
Finished job 484.
2802 of 3292 steps (85%) done

[Mon Jul  6 00:08:00 2020]
rule infer_single_ML:
    input: per_gene/EOG091G05K5/EOG091G05K5.best_model, per_gene/EOG091G05K5/ALICUT_EOG091G05K5.clustalo.fasta
    output: per_gene/EOG091G05K5/EOG091G05K5.raxml.done
    log: per_gene/EOG091G05K5/infer_single_ML.stdout.txt, per_gene/EOG091G05K5/infer_single_ML.stderr.txt
    jobid: 36
    wildcards: BUSCO=EOG091G05K5
    threads: 2


        cd per_gene/EOG091G05K5
	count=$(cat ../../per_gene/EOG091G05K5/ALICUT_EOG091G05K5.clustalo.fasta | grep ">" | wc -l)
	if [ "$count" -gt 5 ]
        then
		RAxMLmodel=$(cat ../../per_gene/EOG091G05K5/EOG091G05K5.best_model | grep "Best" | cut -d ":" -f 2 | tr -d '[:space:]')
                if [ "$(ls -1 | grep "^RAxML" | wc -l)" -ne 0 ]
		then
			rm RAxML*
		fi
        	raxml -f a -T 2 -m PROTGAMMA$RAxMLmodel         	-p 12345 -x 12345 -# 100         	-s ../../per_gene/EOG091G05K5/ALICUT_EOG091G05K5.clustalo.fasta -n EOG091G05K5.clustalo.aln.ALICUT.$RAxMLmodel 		1> ../../per_gene/EOG091G05K5/infer_single_ML.stdout.txt 2> ../../per_gene/EOG091G05K5/infer_single_ML.stderr.txt
	else
		echo "fasta file per_gene/EOG091G05K5/ALICUT_EOG091G05K5.clustalo.fasta contains fewer than 5 sequences - skipped" > ../../per_gene/EOG091G05K5/infer_single_ML.stdout.txt
		touch raxml.skipped
	fi
        touch ../../per_gene/EOG091G05K5/EOG091G05K5.raxml.done
        
[33mJob counts:
	count	jobs
	1	infer_single_ML
	1[0m
[33m
        cd per_gene/EOG091G05K5
	count=$(cat ../../per_gene/EOG091G05K5/ALICUT_EOG091G05K5.clustalo.fasta | grep ">" | wc -l)
	if [ "$count" -gt 5 ]
        then
		RAxMLmodel=$(cat ../../per_gene/EOG091G05K5/EOG091G05K5.best_model | grep "Best" | cut -d ":" -f 2 | tr -d '[:space:]')
                if [ "$(ls -1 | grep "^RAxML" | wc -l)" -ne 0 ]
		then
			rm RAxML*
		fi
        	raxml -f a -T 2 -m PROTGAMMA$RAxMLmodel         	-p 12345 -x 12345 -# 100         	-s ../../per_gene/EOG091G05K5/ALICUT_EOG091G05K5.clustalo.fasta -n EOG091G05K5.clustalo.aln.ALICUT.$RAxMLmodel 		1> ../../per_gene/EOG091G05K5/infer_single_ML.stdout.txt 2> ../../per_gene/EOG091G05K5/infer_single_ML.stderr.txt
	else
		echo "fasta file per_gene/EOG091G05K5/ALICUT_EOG091G05K5.clustalo.fasta contains fewer than 5 sequences - skipped" > ../../per_gene/EOG091G05K5/infer_single_ML.stdout.txt
		touch raxml.skipped
	fi
        touch ../../per_gene/EOG091G05K5/EOG091G05K5.raxml.done
        [0m
[Mon Jul  6 00:08:03 2020]
Finished job 718.
2803 of 3292 steps (85%) done

[Mon Jul  6 00:08:03 2020]
rule infer_single_ML:
    input: per_gene/EOG091G0MY0/EOG091G0MY0.best_model, per_gene/EOG091G0MY0/ALICUT_EOG091G0MY0.clustalo.fasta
    output: per_gene/EOG091G0MY0/EOG091G0MY0.raxml.done
    log: per_gene/EOG091G0MY0/infer_single_ML.stdout.txt, per_gene/EOG091G0MY0/infer_single_ML.stderr.txt
    jobid: 153
    wildcards: BUSCO=EOG091G0MY0
    threads: 2


        cd per_gene/EOG091G0MY0
	count=$(cat ../../per_gene/EOG091G0MY0/ALICUT_EOG091G0MY0.clustalo.fasta | grep ">" | wc -l)
	if [ "$count" -gt 5 ]
        then
		RAxMLmodel=$(cat ../../per_gene/EOG091G0MY0/EOG091G0MY0.best_model | grep "Best" | cut -d ":" -f 2 | tr -d '[:space:]')
                if [ "$(ls -1 | grep "^RAxML" | wc -l)" -ne 0 ]
		then
			rm RAxML*
		fi
        	raxml -f a -T 2 -m PROTGAMMA$RAxMLmodel         	-p 12345 -x 12345 -# 100         	-s ../../per_gene/EOG091G0MY0/ALICUT_EOG091G0MY0.clustalo.fasta -n EOG091G0MY0.clustalo.aln.ALICUT.$RAxMLmodel 		1> ../../per_gene/EOG091G0MY0/infer_single_ML.stdout.txt 2> ../../per_gene/EOG091G0MY0/infer_single_ML.stderr.txt
	else
		echo "fasta file per_gene/EOG091G0MY0/ALICUT_EOG091G0MY0.clustalo.fasta contains fewer than 5 sequences - skipped" > ../../per_gene/EOG091G0MY0/infer_single_ML.stdout.txt
		touch raxml.skipped
	fi
        touch ../../per_gene/EOG091G0MY0/EOG091G0MY0.raxml.done
        
[Mon Jul  6 00:08:03 2020]
Finished job 1292.
2804 of 3292 steps (85%) done

[Mon Jul  6 00:08:03 2020]
rule score_and_cut:
    input: per_gene/EOG091G04EX/EOG091G04EX.clustalo.fasta
    output: per_gene/EOG091G04EX/ALICUT_EOG091G04EX.clustalo.fasta
    jobid: 469
    wildcards: BUSCO=EOG091G04EX
    threads: 2


        cd per_gene/EOG091G04EX
        Aliscore.pl -N -r 200000000000000000 -i ../../per_gene/EOG091G04EX/EOG091G04EX.clustalo.fasta &> aliscore.log
        ALICUT.pl -s &> alicut.log
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/63c88c27a0fa300f57066b0ef65fefcb.simg
[33mJob counts:
	count	jobs
	1	infer_single_ML
	1[0m
[33m
        cd per_gene/EOG091G0MY0
	count=$(cat ../../per_gene/EOG091G0MY0/ALICUT_EOG091G0MY0.clustalo.fasta | grep ">" | wc -l)
	if [ "$count" -gt 5 ]
        then
		RAxMLmodel=$(cat ../../per_gene/EOG091G0MY0/EOG091G0MY0.best_model | grep "Best" | cut -d ":" -f 2 | tr -d '[:space:]')
                if [ "$(ls -1 | grep "^RAxML" | wc -l)" -ne 0 ]
		then
			rm RAxML*
		fi
        	raxml -f a -T 2 -m PROTGAMMA$RAxMLmodel         	-p 12345 -x 12345 -# 100         	-s ../../per_gene/EOG091G0MY0/ALICUT_EOG091G0MY0.clustalo.fasta -n EOG091G0MY0.clustalo.aln.ALICUT.$RAxMLmodel 		1> ../../per_gene/EOG091G0MY0/infer_single_ML.stdout.txt 2> ../../per_gene/EOG091G0MY0/infer_single_ML.stderr.txt
	else
		echo "fasta file per_gene/EOG091G0MY0/ALICUT_EOG091G0MY0.clustalo.fasta contains fewer than 5 sequences - skipped" > ../../per_gene/EOG091G0MY0/infer_single_ML.stdout.txt
		touch raxml.skipped
	fi
        touch ../../per_gene/EOG091G0MY0/EOG091G0MY0.raxml.done
        [0m
[Mon Jul  6 00:08:09 2020]
Finished job 109.
2805 of 3292 steps (85%) done

[Mon Jul  6 00:08:09 2020]
rule get_seqs:
    input: /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ingroup.txt, /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/outgroup.txt
    output: per_gene/EOG091G0LP5/EOG091G0LP5.ingroup.fasta
    log: per_gene/EOG091G0LP5/get_seqs.stdout.txt, per_gene/EOG091G0LP5/get_seqs.stderr.txt
    jobid: 2748
    wildcards: BUSCO=EOG091G0LP5
    threads: 2


	basedir=$(pwd)
        cd per_gene/EOG091G0LP5
        
        bash $basedir/../scripts/fetch_seqs.sh EOG091G0LP5 /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ingroup.txt /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/outgroup.txt 1> ../../per_gene/EOG091G0LP5/get_seqs.stdout.txt 2> ../../per_gene/EOG091G0LP5/get_seqs.stderr.txt
	mv EOG091G0LP5.fasta $basedir/per_gene/EOG091G0LP5/EOG091G0LP5.ingroup.fasta
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/72476f9d9a5bd0627b4d721143a21354.simg
[Mon Jul  6 00:08:14 2020]
Finished job 469.
2806 of 3292 steps (85%) done

[Mon Jul  6 00:08:14 2020]
rule remove_empty:
    input: per_gene/EOG091G04EX/ALICUT_EOG091G04EX.clustalo.fasta
    output: per_gene/EOG091G04EX/empty_check.done
    jobid: 1291
    wildcards: BUSCO=EOG091G04EX


         if [ "$(cat per_gene/EOG091G04EX/ALICUT_EOG091G04EX.clustalo.fasta | grep -v ">" | sed 's/-//g' | grep "^$" | wc -l)" -gt 0 ]
         then
              cp per_gene/EOG091G04EX/ALICUT_EOG091G04EX.clustalo.fasta per_gene/EOG091G04EX/ALICUT_EOG091G04EX.clustalo.fasta.backup
              bash ../scripts/remove_empty.sh per_gene/EOG091G04EX/ALICUT_EOG091G04EX.clustalo.fasta.backup > per_gene/EOG091G04EX/ALICUT_EOG091G04EX.clustalo.fasta
         fi
         touch per_gene/EOG091G04EX/empty_check.done
         
[Mon Jul  6 00:08:14 2020]
Finished job 1291.
2807 of 3292 steps (85%) done

[Mon Jul  6 00:08:14 2020]
rule find_best_model:
    input: per_gene/EOG091G04EX/ALICUT_EOG091G04EX.clustalo.fasta, per_gene/EOG091G04EX/empty_check.done
    output: per_gene/EOG091G04EX/EOG091G04EX.best_model
    log: per_gene/EOG091G04EX/find_best_model.stderr.txt
    jobid: 468
    wildcards: BUSCO=EOG091G04EX
    threads: 2


        cd per_gene/EOG091G04EX
        if [ ! -d find_best_model ]
        then
            mkdir find_best_model
        fi
        cd find_best_model
        ln -s ../../../per_gene/EOG091G04EX/ALICUT_EOG091G04EX.clustalo.fasta EOG091G04EX.fasta
        ProteinModelSelection.pl EOG091G04EX.fasta 1> ../../../per_gene/EOG091G04EX/EOG091G04EX.best_model 2> ../../../per_gene/EOG091G04EX/find_best_model.stderr.txt
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/c0c09ee657b1e27f2c5687e0e9aa8d70.simg
[Mon Jul  6 00:08:20 2020]
Finished job 758.
2808 of 3292 steps (85%) done

[Mon Jul  6 00:08:20 2020]
rule infer_single_ML:
    input: per_gene/EOG091G0QJA/EOG091G0QJA.best_model, per_gene/EOG091G0QJA/ALICUT_EOG091G0QJA.clustalo.fasta
    output: per_gene/EOG091G0QJA/EOG091G0QJA.raxml.done
    log: per_gene/EOG091G0QJA/infer_single_ML.stdout.txt, per_gene/EOG091G0QJA/infer_single_ML.stderr.txt
    jobid: 173
    wildcards: BUSCO=EOG091G0QJA
    threads: 2


        cd per_gene/EOG091G0QJA
	count=$(cat ../../per_gene/EOG091G0QJA/ALICUT_EOG091G0QJA.clustalo.fasta | grep ">" | wc -l)
	if [ "$count" -gt 5 ]
        then
		RAxMLmodel=$(cat ../../per_gene/EOG091G0QJA/EOG091G0QJA.best_model | grep "Best" | cut -d ":" -f 2 | tr -d '[:space:]')
                if [ "$(ls -1 | grep "^RAxML" | wc -l)" -ne 0 ]
		then
			rm RAxML*
		fi
        	raxml -f a -T 2 -m PROTGAMMA$RAxMLmodel         	-p 12345 -x 12345 -# 100         	-s ../../per_gene/EOG091G0QJA/ALICUT_EOG091G0QJA.clustalo.fasta -n EOG091G0QJA.clustalo.aln.ALICUT.$RAxMLmodel 		1> ../../per_gene/EOG091G0QJA/infer_single_ML.stdout.txt 2> ../../per_gene/EOG091G0QJA/infer_single_ML.stderr.txt
	else
		echo "fasta file per_gene/EOG091G0QJA/ALICUT_EOG091G0QJA.clustalo.fasta contains fewer than 5 sequences - skipped" > ../../per_gene/EOG091G0QJA/infer_single_ML.stdout.txt
		touch raxml.skipped
	fi
        touch ../../per_gene/EOG091G0QJA/EOG091G0QJA.raxml.done
        
[33mJob counts:
	count	jobs
	1	infer_single_ML
	1[0m
[33m
        cd per_gene/EOG091G0QJA
	count=$(cat ../../per_gene/EOG091G0QJA/ALICUT_EOG091G0QJA.clustalo.fasta | grep ">" | wc -l)
	if [ "$count" -gt 5 ]
        then
		RAxMLmodel=$(cat ../../per_gene/EOG091G0QJA/EOG091G0QJA.best_model | grep "Best" | cut -d ":" -f 2 | tr -d '[:space:]')
                if [ "$(ls -1 | grep "^RAxML" | wc -l)" -ne 0 ]
		then
			rm RAxML*
		fi
        	raxml -f a -T 2 -m PROTGAMMA$RAxMLmodel         	-p 12345 -x 12345 -# 100         	-s ../../per_gene/EOG091G0QJA/ALICUT_EOG091G0QJA.clustalo.fasta -n EOG091G0QJA.clustalo.aln.ALICUT.$RAxMLmodel 		1> ../../per_gene/EOG091G0QJA/infer_single_ML.stdout.txt 2> ../../per_gene/EOG091G0QJA/infer_single_ML.stderr.txt
	else
		echo "fasta file per_gene/EOG091G0QJA/ALICUT_EOG091G0QJA.clustalo.fasta contains fewer than 5 sequences - skipped" > ../../per_gene/EOG091G0QJA/infer_single_ML.stdout.txt
		touch raxml.skipped
	fi
        touch ../../per_gene/EOG091G0QJA/EOG091G0QJA.raxml.done
        [0m
[Mon Jul  6 00:08:23 2020]
Finished job 2748.
2809 of 3292 steps (85%) done

[Mon Jul  6 00:08:23 2020]
rule get_outgroups:
    input: per_gene/EOG091G0LP5/EOG091G0LP5.ingroup.fasta
    output: per_gene/EOG091G0LP5/EOG091G0LP5.orthodb.fasta, per_gene/EOG091G0LP5/EOG091G0LP5.outgroup.fasta
    log: per_gene/EOG091G0LP5/get_outgroups.stdout.txt, per_gene/EOG091G0LP5/get_outgroups.stderr.txt
    jobid: 2749
    wildcards: BUSCO=EOG091G0LP5


        #download fastas from Orhtodb for BUSCO id
        for i in {1..5}
        do
             wget "http://www.orthodb.org/fasta?query=EOG091G0LP5&level=33208" -O per_gene/EOG091G0LP5/EOG091G0LP5.orthodb.fasta 1> per_gene/EOG091G0LP5/get_outgroups.stdout.txt 2> per_gene/EOG091G0LP5/get_outgroups.stderr.txt && break || echo -e "try again ($i)" && sleep 15
        done

	#This is quick an dirty for now and just takes the first protein if there is more than one for an outgroup taxon
        bash ../scripts/download_outgroups.sh taxids.txt per_gene/EOG091G0LP5/EOG091G0LP5.orthodb.fasta > per_gene/EOG091G0LP5/EOG091G0LP5.outgroup.fasta
        
[Mon Jul  6 00:08:23 2020]
Finished job 2749.
2810 of 3292 steps (85%) done

[Mon Jul  6 00:08:23 2020]
rule join_groups:
    input: per_gene/EOG091G0LP5/EOG091G0LP5.ingroup.fasta, per_gene/EOG091G0LP5/EOG091G0LP5.outgroup.fasta
    output: per_gene/EOG091G0LP5/EOG091G0LP5.fasta
    jobid: 2198
    wildcards: BUSCO=EOG091G0LP5


        cat per_gene/EOG091G0LP5/EOG091G0LP5.ingroup.fasta per_gene/EOG091G0LP5/EOG091G0LP5.outgroup.fasta > per_gene/EOG091G0LP5/EOG091G0LP5.fasta
        
[Mon Jul  6 00:08:23 2020]
Finished job 2198.
2811 of 3292 steps (85%) done

[Mon Jul  6 00:08:23 2020]
rule MSA:
    input: per_gene/EOG091G0LP5/EOG091G0LP5.fasta
    output: per_gene/EOG091G0LP5/EOG091G0LP5.clustalo.fasta
    log: per_gene/EOG091G0LP5/MSA.stdout.txt, per_gene/EOG091G0LP5/MSA.stderr.txt
    jobid: 1516
    wildcards: BUSCO=EOG091G0LP5
    threads: 2


        clustalo -i per_gene/EOG091G0LP5/EOG091G0LP5.fasta -o per_gene/EOG091G0LP5/EOG091G0LP5.clustalo.fasta --threads=2 1> per_gene/EOG091G0LP5/MSA.stdout.txt 2> per_gene/EOG091G0LP5/MSA.stderr.txt
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/d68c9691725a7401923680874285c430.simg
[Mon Jul  6 00:08:24 2020]
Finished job 1516.
2812 of 3292 steps (85%) done

[Mon Jul  6 00:08:24 2020]
rule score_and_cut:
    input: per_gene/EOG091G0LP5/EOG091G0LP5.clustalo.fasta
    output: per_gene/EOG091G0LP5/ALICUT_EOG091G0LP5.clustalo.fasta
    jobid: 693
    wildcards: BUSCO=EOG091G0LP5
    threads: 2


        cd per_gene/EOG091G0LP5
        Aliscore.pl -N -r 200000000000000000 -i ../../per_gene/EOG091G0LP5/EOG091G0LP5.clustalo.fasta &> aliscore.log
        ALICUT.pl -s &> alicut.log
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/63c88c27a0fa300f57066b0ef65fefcb.simg
[Mon Jul  6 00:08:34 2020]
Finished job 693.
2813 of 3292 steps (85%) done

[Mon Jul  6 00:08:34 2020]
rule remove_empty:
    input: per_gene/EOG091G0LP5/ALICUT_EOG091G0LP5.clustalo.fasta
    output: per_gene/EOG091G0LP5/empty_check.done
    jobid: 1515
    wildcards: BUSCO=EOG091G0LP5


         if [ "$(cat per_gene/EOG091G0LP5/ALICUT_EOG091G0LP5.clustalo.fasta | grep -v ">" | sed 's/-//g' | grep "^$" | wc -l)" -gt 0 ]
         then
              cp per_gene/EOG091G0LP5/ALICUT_EOG091G0LP5.clustalo.fasta per_gene/EOG091G0LP5/ALICUT_EOG091G0LP5.clustalo.fasta.backup
              bash ../scripts/remove_empty.sh per_gene/EOG091G0LP5/ALICUT_EOG091G0LP5.clustalo.fasta.backup > per_gene/EOG091G0LP5/ALICUT_EOG091G0LP5.clustalo.fasta
         fi
         touch per_gene/EOG091G0LP5/empty_check.done
         
[Mon Jul  6 00:08:34 2020]
Finished job 1515.
2814 of 3292 steps (85%) done

[Mon Jul  6 00:08:34 2020]
rule find_best_model:
    input: per_gene/EOG091G0LP5/ALICUT_EOG091G0LP5.clustalo.fasta, per_gene/EOG091G0LP5/empty_check.done
    output: per_gene/EOG091G0LP5/EOG091G0LP5.best_model
    log: per_gene/EOG091G0LP5/find_best_model.stderr.txt
    jobid: 692
    wildcards: BUSCO=EOG091G0LP5
    threads: 2


        cd per_gene/EOG091G0LP5
        if [ ! -d find_best_model ]
        then
            mkdir find_best_model
        fi
        cd find_best_model
        ln -s ../../../per_gene/EOG091G0LP5/ALICUT_EOG091G0LP5.clustalo.fasta EOG091G0LP5.fasta
        ProteinModelSelection.pl EOG091G0LP5.fasta 1> ../../../per_gene/EOG091G0LP5/EOG091G0LP5.best_model 2> ../../../per_gene/EOG091G0LP5/find_best_model.stderr.txt
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/c0c09ee657b1e27f2c5687e0e9aa8d70.simg
[Mon Jul  6 00:08:56 2020]
Finished job 692.
2815 of 3292 steps (86%) done

[Mon Jul  6 00:08:56 2020]
rule infer_single_ML:
    input: per_gene/EOG091G0LP5/EOG091G0LP5.best_model, per_gene/EOG091G0LP5/ALICUT_EOG091G0LP5.clustalo.fasta
    output: per_gene/EOG091G0LP5/EOG091G0LP5.raxml.done
    log: per_gene/EOG091G0LP5/infer_single_ML.stdout.txt, per_gene/EOG091G0LP5/infer_single_ML.stderr.txt
    jobid: 140
    wildcards: BUSCO=EOG091G0LP5
    threads: 2


        cd per_gene/EOG091G0LP5
	count=$(cat ../../per_gene/EOG091G0LP5/ALICUT_EOG091G0LP5.clustalo.fasta | grep ">" | wc -l)
	if [ "$count" -gt 5 ]
        then
		RAxMLmodel=$(cat ../../per_gene/EOG091G0LP5/EOG091G0LP5.best_model | grep "Best" | cut -d ":" -f 2 | tr -d '[:space:]')
                if [ "$(ls -1 | grep "^RAxML" | wc -l)" -ne 0 ]
		then
			rm RAxML*
		fi
        	raxml -f a -T 2 -m PROTGAMMA$RAxMLmodel         	-p 12345 -x 12345 -# 100         	-s ../../per_gene/EOG091G0LP5/ALICUT_EOG091G0LP5.clustalo.fasta -n EOG091G0LP5.clustalo.aln.ALICUT.$RAxMLmodel 		1> ../../per_gene/EOG091G0LP5/infer_single_ML.stdout.txt 2> ../../per_gene/EOG091G0LP5/infer_single_ML.stderr.txt
	else
		echo "fasta file per_gene/EOG091G0LP5/ALICUT_EOG091G0LP5.clustalo.fasta contains fewer than 5 sequences - skipped" > ../../per_gene/EOG091G0LP5/infer_single_ML.stdout.txt
		touch raxml.skipped
	fi
        touch ../../per_gene/EOG091G0LP5/EOG091G0LP5.raxml.done
        
[Mon Jul  6 00:08:58 2020]
Finished job 468.
2816 of 3292 steps (86%) done

[Mon Jul  6 00:08:58 2020]
rule infer_single_ML:
    input: per_gene/EOG091G04EX/EOG091G04EX.best_model, per_gene/EOG091G04EX/ALICUT_EOG091G04EX.clustalo.fasta
    output: per_gene/EOG091G04EX/EOG091G04EX.raxml.done
    log: per_gene/EOG091G04EX/infer_single_ML.stdout.txt, per_gene/EOG091G04EX/infer_single_ML.stderr.txt
    jobid: 28
    wildcards: BUSCO=EOG091G04EX
    threads: 2


        cd per_gene/EOG091G04EX
	count=$(cat ../../per_gene/EOG091G04EX/ALICUT_EOG091G04EX.clustalo.fasta | grep ">" | wc -l)
	if [ "$count" -gt 5 ]
        then
		RAxMLmodel=$(cat ../../per_gene/EOG091G04EX/EOG091G04EX.best_model | grep "Best" | cut -d ":" -f 2 | tr -d '[:space:]')
                if [ "$(ls -1 | grep "^RAxML" | wc -l)" -ne 0 ]
		then
			rm RAxML*
		fi
        	raxml -f a -T 2 -m PROTGAMMA$RAxMLmodel         	-p 12345 -x 12345 -# 100         	-s ../../per_gene/EOG091G04EX/ALICUT_EOG091G04EX.clustalo.fasta -n EOG091G04EX.clustalo.aln.ALICUT.$RAxMLmodel 		1> ../../per_gene/EOG091G04EX/infer_single_ML.stdout.txt 2> ../../per_gene/EOG091G04EX/infer_single_ML.stderr.txt
	else
		echo "fasta file per_gene/EOG091G04EX/ALICUT_EOG091G04EX.clustalo.fasta contains fewer than 5 sequences - skipped" > ../../per_gene/EOG091G04EX/infer_single_ML.stdout.txt
		touch raxml.skipped
	fi
        touch ../../per_gene/EOG091G04EX/EOG091G04EX.raxml.done
        
[Mon Jul  6 00:09:00 2020]
Finished job 387.
2817 of 3292 steps (86%) done

[Mon Jul  6 00:09:00 2020]
rule get_seqs:
    input: /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ingroup.txt, /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/outgroup.txt
    output: per_gene/EOG091G0CAR/EOG091G0CAR.ingroup.fasta
    log: per_gene/EOG091G0CAR/get_seqs.stdout.txt, per_gene/EOG091G0CAR/get_seqs.stderr.txt
    jobid: 2644
    wildcards: BUSCO=EOG091G0CAR
    threads: 2


	basedir=$(pwd)
        cd per_gene/EOG091G0CAR
        
        bash $basedir/../scripts/fetch_seqs.sh EOG091G0CAR /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ingroup.txt /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/outgroup.txt 1> ../../per_gene/EOG091G0CAR/get_seqs.stdout.txt 2> ../../per_gene/EOG091G0CAR/get_seqs.stderr.txt
	mv EOG091G0CAR.fasta $basedir/per_gene/EOG091G0CAR/EOG091G0CAR.ingroup.fasta
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/72476f9d9a5bd0627b4d721143a21354.simg
[33mJob counts:
	count	jobs
	1	infer_single_ML
	1[0m
[33mJob counts:
	count	jobs
	1	infer_single_ML
	1[0m
[33m
        cd per_gene/EOG091G04EX
	count=$(cat ../../per_gene/EOG091G04EX/ALICUT_EOG091G04EX.clustalo.fasta | grep ">" | wc -l)
	if [ "$count" -gt 5 ]
        then
		RAxMLmodel=$(cat ../../per_gene/EOG091G04EX/EOG091G04EX.best_model | grep "Best" | cut -d ":" -f 2 | tr -d '[:space:]')
                if [ "$(ls -1 | grep "^RAxML" | wc -l)" -ne 0 ]
		then
			rm RAxML*
		fi
        	raxml -f a -T 2 -m PROTGAMMA$RAxMLmodel         	-p 12345 -x 12345 -# 100         	-s ../../per_gene/EOG091G04EX/ALICUT_EOG091G04EX.clustalo.fasta -n EOG091G04EX.clustalo.aln.ALICUT.$RAxMLmodel 		1> ../../per_gene/EOG091G04EX/infer_single_ML.stdout.txt 2> ../../per_gene/EOG091G04EX/infer_single_ML.stderr.txt
	else
		echo "fasta file per_gene/EOG091G04EX/ALICUT_EOG091G04EX.clustalo.fasta contains fewer than 5 sequences - skipped" > ../../per_gene/EOG091G04EX/infer_single_ML.stdout.txt
		touch raxml.skipped
	fi
        touch ../../per_gene/EOG091G04EX/EOG091G04EX.raxml.done
        [0m
[33m
        cd per_gene/EOG091G0LP5
	count=$(cat ../../per_gene/EOG091G0LP5/ALICUT_EOG091G0LP5.clustalo.fasta | grep ">" | wc -l)
	if [ "$count" -gt 5 ]
        then
		RAxMLmodel=$(cat ../../per_gene/EOG091G0LP5/EOG091G0LP5.best_model | grep "Best" | cut -d ":" -f 2 | tr -d '[:space:]')
                if [ "$(ls -1 | grep "^RAxML" | wc -l)" -ne 0 ]
		then
			rm RAxML*
		fi
        	raxml -f a -T 2 -m PROTGAMMA$RAxMLmodel         	-p 12345 -x 12345 -# 100         	-s ../../per_gene/EOG091G0LP5/ALICUT_EOG091G0LP5.clustalo.fasta -n EOG091G0LP5.clustalo.aln.ALICUT.$RAxMLmodel 		1> ../../per_gene/EOG091G0LP5/infer_single_ML.stdout.txt 2> ../../per_gene/EOG091G0LP5/infer_single_ML.stderr.txt
	else
		echo "fasta file per_gene/EOG091G0LP5/ALICUT_EOG091G0LP5.clustalo.fasta contains fewer than 5 sequences - skipped" > ../../per_gene/EOG091G0LP5/infer_single_ML.stdout.txt
		touch raxml.skipped
	fi
        touch ../../per_gene/EOG091G0LP5/EOG091G0LP5.raxml.done
        [0m
[Mon Jul  6 00:09:14 2020]
Finished job 2644.
2818 of 3292 steps (86%) done

[Mon Jul  6 00:09:14 2020]
rule get_outgroups:
    input: per_gene/EOG091G0CAR/EOG091G0CAR.ingroup.fasta
    output: per_gene/EOG091G0CAR/EOG091G0CAR.orthodb.fasta, per_gene/EOG091G0CAR/EOG091G0CAR.outgroup.fasta
    log: per_gene/EOG091G0CAR/get_outgroups.stdout.txt, per_gene/EOG091G0CAR/get_outgroups.stderr.txt
    jobid: 2645
    wildcards: BUSCO=EOG091G0CAR


        #download fastas from Orhtodb for BUSCO id
        for i in {1..5}
        do
             wget "http://www.orthodb.org/fasta?query=EOG091G0CAR&level=33208" -O per_gene/EOG091G0CAR/EOG091G0CAR.orthodb.fasta 1> per_gene/EOG091G0CAR/get_outgroups.stdout.txt 2> per_gene/EOG091G0CAR/get_outgroups.stderr.txt && break || echo -e "try again ($i)" && sleep 15
        done

	#This is quick an dirty for now and just takes the first protein if there is more than one for an outgroup taxon
        bash ../scripts/download_outgroups.sh taxids.txt per_gene/EOG091G0CAR/EOG091G0CAR.orthodb.fasta > per_gene/EOG091G0CAR/EOG091G0CAR.outgroup.fasta
        
[Mon Jul  6 00:09:15 2020]
Finished job 2645.
2819 of 3292 steps (86%) done

[Mon Jul  6 00:09:15 2020]
rule join_groups:
    input: per_gene/EOG091G0CAR/EOG091G0CAR.ingroup.fasta, per_gene/EOG091G0CAR/EOG091G0CAR.outgroup.fasta
    output: per_gene/EOG091G0CAR/EOG091G0CAR.fasta
    jobid: 2146
    wildcards: BUSCO=EOG091G0CAR


        cat per_gene/EOG091G0CAR/EOG091G0CAR.ingroup.fasta per_gene/EOG091G0CAR/EOG091G0CAR.outgroup.fasta > per_gene/EOG091G0CAR/EOG091G0CAR.fasta
        
[Mon Jul  6 00:09:15 2020]
Finished job 2146.
2820 of 3292 steps (86%) done

[Mon Jul  6 00:09:15 2020]
rule MSA:
    input: per_gene/EOG091G0CAR/EOG091G0CAR.fasta
    output: per_gene/EOG091G0CAR/EOG091G0CAR.clustalo.fasta
    log: per_gene/EOG091G0CAR/MSA.stdout.txt, per_gene/EOG091G0CAR/MSA.stderr.txt
    jobid: 1412
    wildcards: BUSCO=EOG091G0CAR
    threads: 2


        clustalo -i per_gene/EOG091G0CAR/EOG091G0CAR.fasta -o per_gene/EOG091G0CAR/EOG091G0CAR.clustalo.fasta --threads=2 1> per_gene/EOG091G0CAR/MSA.stdout.txt 2> per_gene/EOG091G0CAR/MSA.stderr.txt
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/d68c9691725a7401923680874285c430.simg
[Mon Jul  6 00:09:16 2020]
Finished job 1412.
2821 of 3292 steps (86%) done

[Mon Jul  6 00:09:16 2020]
rule score_and_cut:
    input: per_gene/EOG091G0CAR/EOG091G0CAR.clustalo.fasta
    output: per_gene/EOG091G0CAR/ALICUT_EOG091G0CAR.clustalo.fasta
    jobid: 589
    wildcards: BUSCO=EOG091G0CAR
    threads: 2


        cd per_gene/EOG091G0CAR
        Aliscore.pl -N -r 200000000000000000 -i ../../per_gene/EOG091G0CAR/EOG091G0CAR.clustalo.fasta &> aliscore.log
        ALICUT.pl -s &> alicut.log
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/63c88c27a0fa300f57066b0ef65fefcb.simg
[Mon Jul  6 00:09:22 2020]
Finished job 7.
2822 of 3292 steps (86%) done

[Mon Jul  6 00:09:22 2020]
rule get_seqs:
    input: /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ingroup.txt, /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/outgroup.txt
    output: per_gene/EOG091G0262/EOG091G0262.ingroup.fasta
    log: per_gene/EOG091G0262/get_seqs.stdout.txt, per_gene/EOG091G0262/get_seqs.stderr.txt
    jobid: 3110
    wildcards: BUSCO=EOG091G0262
    threads: 2


	basedir=$(pwd)
        cd per_gene/EOG091G0262
        
        bash $basedir/../scripts/fetch_seqs.sh EOG091G0262 /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ingroup.txt /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/outgroup.txt 1> ../../per_gene/EOG091G0262/get_seqs.stdout.txt 2> ../../per_gene/EOG091G0262/get_seqs.stderr.txt
	mv EOG091G0262.fasta $basedir/per_gene/EOG091G0262/EOG091G0262.ingroup.fasta
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/72476f9d9a5bd0627b4d721143a21354.simg
[Mon Jul  6 00:09:26 2020]
Finished job 589.
2823 of 3292 steps (86%) done

[Mon Jul  6 00:09:26 2020]
rule remove_empty:
    input: per_gene/EOG091G0CAR/ALICUT_EOG091G0CAR.clustalo.fasta
    output: per_gene/EOG091G0CAR/empty_check.done
    jobid: 1411
    wildcards: BUSCO=EOG091G0CAR


         if [ "$(cat per_gene/EOG091G0CAR/ALICUT_EOG091G0CAR.clustalo.fasta | grep -v ">" | sed 's/-//g' | grep "^$" | wc -l)" -gt 0 ]
         then
              cp per_gene/EOG091G0CAR/ALICUT_EOG091G0CAR.clustalo.fasta per_gene/EOG091G0CAR/ALICUT_EOG091G0CAR.clustalo.fasta.backup
              bash ../scripts/remove_empty.sh per_gene/EOG091G0CAR/ALICUT_EOG091G0CAR.clustalo.fasta.backup > per_gene/EOG091G0CAR/ALICUT_EOG091G0CAR.clustalo.fasta
         fi
         touch per_gene/EOG091G0CAR/empty_check.done
         
[Mon Jul  6 00:09:26 2020]
Finished job 1411.
2824 of 3292 steps (86%) done

[Mon Jul  6 00:09:26 2020]
rule find_best_model:
    input: per_gene/EOG091G0CAR/ALICUT_EOG091G0CAR.clustalo.fasta, per_gene/EOG091G0CAR/empty_check.done
    output: per_gene/EOG091G0CAR/EOG091G0CAR.best_model
    log: per_gene/EOG091G0CAR/find_best_model.stderr.txt
    jobid: 588
    wildcards: BUSCO=EOG091G0CAR
    threads: 2


        cd per_gene/EOG091G0CAR
        if [ ! -d find_best_model ]
        then
            mkdir find_best_model
        fi
        cd find_best_model
        ln -s ../../../per_gene/EOG091G0CAR/ALICUT_EOG091G0CAR.clustalo.fasta EOG091G0CAR.fasta
        ProteinModelSelection.pl EOG091G0CAR.fasta 1> ../../../per_gene/EOG091G0CAR/EOG091G0CAR.best_model 2> ../../../per_gene/EOG091G0CAR/find_best_model.stderr.txt
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/c0c09ee657b1e27f2c5687e0e9aa8d70.simg
[Mon Jul  6 00:09:35 2020]
Finished job 3110.
2825 of 3292 steps (86%) done

[Mon Jul  6 00:09:35 2020]
rule get_outgroups:
    input: per_gene/EOG091G0262/EOG091G0262.ingroup.fasta
    output: per_gene/EOG091G0262/EOG091G0262.orthodb.fasta, per_gene/EOG091G0262/EOG091G0262.outgroup.fasta
    log: per_gene/EOG091G0262/get_outgroups.stdout.txt, per_gene/EOG091G0262/get_outgroups.stderr.txt
    jobid: 3111
    wildcards: BUSCO=EOG091G0262


        #download fastas from Orhtodb for BUSCO id
        for i in {1..5}
        do
             wget "http://www.orthodb.org/fasta?query=EOG091G0262&level=33208" -O per_gene/EOG091G0262/EOG091G0262.orthodb.fasta 1> per_gene/EOG091G0262/get_outgroups.stdout.txt 2> per_gene/EOG091G0262/get_outgroups.stderr.txt && break || echo -e "try again ($i)" && sleep 15
        done

	#This is quick an dirty for now and just takes the first protein if there is more than one for an outgroup taxon
        bash ../scripts/download_outgroups.sh taxids.txt per_gene/EOG091G0262/EOG091G0262.orthodb.fasta > per_gene/EOG091G0262/EOG091G0262.outgroup.fasta
        
[Mon Jul  6 00:09:36 2020]
Finished job 3111.
2826 of 3292 steps (86%) done

[Mon Jul  6 00:09:36 2020]
rule join_groups:
    input: per_gene/EOG091G0262/EOG091G0262.ingroup.fasta, per_gene/EOG091G0262/EOG091G0262.outgroup.fasta
    output: per_gene/EOG091G0262/EOG091G0262.fasta
    jobid: 2379
    wildcards: BUSCO=EOG091G0262


        cat per_gene/EOG091G0262/EOG091G0262.ingroup.fasta per_gene/EOG091G0262/EOG091G0262.outgroup.fasta > per_gene/EOG091G0262/EOG091G0262.fasta
        
[Mon Jul  6 00:09:36 2020]
Finished job 2379.
2827 of 3292 steps (86%) done

[Mon Jul  6 00:09:36 2020]
rule MSA:
    input: per_gene/EOG091G0262/EOG091G0262.fasta
    output: per_gene/EOG091G0262/EOG091G0262.clustalo.fasta
    log: per_gene/EOG091G0262/MSA.stdout.txt, per_gene/EOG091G0262/MSA.stderr.txt
    jobid: 1878
    wildcards: BUSCO=EOG091G0262
    threads: 2


        clustalo -i per_gene/EOG091G0262/EOG091G0262.fasta -o per_gene/EOG091G0262/EOG091G0262.clustalo.fasta --threads=2 1> per_gene/EOG091G0262/MSA.stdout.txt 2> per_gene/EOG091G0262/MSA.stderr.txt
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/d68c9691725a7401923680874285c430.simg
[Mon Jul  6 00:09:40 2020]
Finished job 1878.
2828 of 3292 steps (86%) done

[Mon Jul  6 00:09:40 2020]
rule score_and_cut:
    input: per_gene/EOG091G0262/EOG091G0262.clustalo.fasta
    output: per_gene/EOG091G0262/ALICUT_EOG091G0262.clustalo.fasta
    jobid: 1055
    wildcards: BUSCO=EOG091G0262
    threads: 2


        cd per_gene/EOG091G0262
        Aliscore.pl -N -r 200000000000000000 -i ../../per_gene/EOG091G0262/EOG091G0262.clustalo.fasta &> aliscore.log
        ALICUT.pl -s &> alicut.log
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/63c88c27a0fa300f57066b0ef65fefcb.simg
[Mon Jul  6 00:09:51 2020]
Finished job 1055.
2829 of 3292 steps (86%) done

[Mon Jul  6 00:09:51 2020]
rule remove_empty:
    input: per_gene/EOG091G0262/ALICUT_EOG091G0262.clustalo.fasta
    output: per_gene/EOG091G0262/empty_check.done
    jobid: 1877
    wildcards: BUSCO=EOG091G0262


         if [ "$(cat per_gene/EOG091G0262/ALICUT_EOG091G0262.clustalo.fasta | grep -v ">" | sed 's/-//g' | grep "^$" | wc -l)" -gt 0 ]
         then
              cp per_gene/EOG091G0262/ALICUT_EOG091G0262.clustalo.fasta per_gene/EOG091G0262/ALICUT_EOG091G0262.clustalo.fasta.backup
              bash ../scripts/remove_empty.sh per_gene/EOG091G0262/ALICUT_EOG091G0262.clustalo.fasta.backup > per_gene/EOG091G0262/ALICUT_EOG091G0262.clustalo.fasta
         fi
         touch per_gene/EOG091G0262/empty_check.done
         
[Mon Jul  6 00:09:51 2020]
Finished job 1877.
2830 of 3292 steps (86%) done

[Mon Jul  6 00:09:51 2020]
rule find_best_model:
    input: per_gene/EOG091G0262/ALICUT_EOG091G0262.clustalo.fasta, per_gene/EOG091G0262/empty_check.done
    output: per_gene/EOG091G0262/EOG091G0262.best_model
    log: per_gene/EOG091G0262/find_best_model.stderr.txt
    jobid: 1054
    wildcards: BUSCO=EOG091G0262
    threads: 2


        cd per_gene/EOG091G0262
        if [ ! -d find_best_model ]
        then
            mkdir find_best_model
        fi
        cd find_best_model
        ln -s ../../../per_gene/EOG091G0262/ALICUT_EOG091G0262.clustalo.fasta EOG091G0262.fasta
        ProteinModelSelection.pl EOG091G0262.fasta 1> ../../../per_gene/EOG091G0262/EOG091G0262.best_model 2> ../../../per_gene/EOG091G0262/find_best_model.stderr.txt
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/c0c09ee657b1e27f2c5687e0e9aa8d70.simg
[Mon Jul  6 00:09:57 2020]
Finished job 588.
2831 of 3292 steps (86%) done

[Mon Jul  6 00:09:57 2020]
rule infer_single_ML:
    input: per_gene/EOG091G0CAR/EOG091G0CAR.best_model, per_gene/EOG091G0CAR/ALICUT_EOG091G0CAR.clustalo.fasta
    output: per_gene/EOG091G0CAR/EOG091G0CAR.raxml.done
    log: per_gene/EOG091G0CAR/infer_single_ML.stdout.txt, per_gene/EOG091G0CAR/infer_single_ML.stderr.txt
    jobid: 88
    wildcards: BUSCO=EOG091G0CAR
    threads: 2


        cd per_gene/EOG091G0CAR
	count=$(cat ../../per_gene/EOG091G0CAR/ALICUT_EOG091G0CAR.clustalo.fasta | grep ">" | wc -l)
	if [ "$count" -gt 5 ]
        then
		RAxMLmodel=$(cat ../../per_gene/EOG091G0CAR/EOG091G0CAR.best_model | grep "Best" | cut -d ":" -f 2 | tr -d '[:space:]')
                if [ "$(ls -1 | grep "^RAxML" | wc -l)" -ne 0 ]
		then
			rm RAxML*
		fi
        	raxml -f a -T 2 -m PROTGAMMA$RAxMLmodel         	-p 12345 -x 12345 -# 100         	-s ../../per_gene/EOG091G0CAR/ALICUT_EOG091G0CAR.clustalo.fasta -n EOG091G0CAR.clustalo.aln.ALICUT.$RAxMLmodel 		1> ../../per_gene/EOG091G0CAR/infer_single_ML.stdout.txt 2> ../../per_gene/EOG091G0CAR/infer_single_ML.stderr.txt
	else
		echo "fasta file per_gene/EOG091G0CAR/ALICUT_EOG091G0CAR.clustalo.fasta contains fewer than 5 sequences - skipped" > ../../per_gene/EOG091G0CAR/infer_single_ML.stdout.txt
		touch raxml.skipped
	fi
        touch ../../per_gene/EOG091G0CAR/EOG091G0CAR.raxml.done
        
[33mJob counts:
	count	jobs
	1	infer_single_ML
	1[0m
[33m
        cd per_gene/EOG091G0CAR
	count=$(cat ../../per_gene/EOG091G0CAR/ALICUT_EOG091G0CAR.clustalo.fasta | grep ">" | wc -l)
	if [ "$count" -gt 5 ]
        then
		RAxMLmodel=$(cat ../../per_gene/EOG091G0CAR/EOG091G0CAR.best_model | grep "Best" | cut -d ":" -f 2 | tr -d '[:space:]')
                if [ "$(ls -1 | grep "^RAxML" | wc -l)" -ne 0 ]
		then
			rm RAxML*
		fi
        	raxml -f a -T 2 -m PROTGAMMA$RAxMLmodel         	-p 12345 -x 12345 -# 100         	-s ../../per_gene/EOG091G0CAR/ALICUT_EOG091G0CAR.clustalo.fasta -n EOG091G0CAR.clustalo.aln.ALICUT.$RAxMLmodel 		1> ../../per_gene/EOG091G0CAR/infer_single_ML.stdout.txt 2> ../../per_gene/EOG091G0CAR/infer_single_ML.stderr.txt
	else
		echo "fasta file per_gene/EOG091G0CAR/ALICUT_EOG091G0CAR.clustalo.fasta contains fewer than 5 sequences - skipped" > ../../per_gene/EOG091G0CAR/infer_single_ML.stdout.txt
		touch raxml.skipped
	fi
        touch ../../per_gene/EOG091G0CAR/EOG091G0CAR.raxml.done
        [0m
[Mon Jul  6 00:10:21 2020]
Finished job 1054.
2832 of 3292 steps (86%) done

[Mon Jul  6 00:10:21 2020]
rule infer_single_ML:
    input: per_gene/EOG091G0262/EOG091G0262.best_model, per_gene/EOG091G0262/ALICUT_EOG091G0262.clustalo.fasta
    output: per_gene/EOG091G0262/EOG091G0262.raxml.done
    log: per_gene/EOG091G0262/infer_single_ML.stdout.txt, per_gene/EOG091G0262/infer_single_ML.stderr.txt
    jobid: 321
    wildcards: BUSCO=EOG091G0262
    threads: 2


        cd per_gene/EOG091G0262
	count=$(cat ../../per_gene/EOG091G0262/ALICUT_EOG091G0262.clustalo.fasta | grep ">" | wc -l)
	if [ "$count" -gt 5 ]
        then
		RAxMLmodel=$(cat ../../per_gene/EOG091G0262/EOG091G0262.best_model | grep "Best" | cut -d ":" -f 2 | tr -d '[:space:]')
                if [ "$(ls -1 | grep "^RAxML" | wc -l)" -ne 0 ]
		then
			rm RAxML*
		fi
        	raxml -f a -T 2 -m PROTGAMMA$RAxMLmodel         	-p 12345 -x 12345 -# 100         	-s ../../per_gene/EOG091G0262/ALICUT_EOG091G0262.clustalo.fasta -n EOG091G0262.clustalo.aln.ALICUT.$RAxMLmodel 		1> ../../per_gene/EOG091G0262/infer_single_ML.stdout.txt 2> ../../per_gene/EOG091G0262/infer_single_ML.stderr.txt
	else
		echo "fasta file per_gene/EOG091G0262/ALICUT_EOG091G0262.clustalo.fasta contains fewer than 5 sequences - skipped" > ../../per_gene/EOG091G0262/infer_single_ML.stdout.txt
		touch raxml.skipped
	fi
        touch ../../per_gene/EOG091G0262/EOG091G0262.raxml.done
        
[33mJob counts:
	count	jobs
	1	infer_single_ML
	1[0m
[33m
        cd per_gene/EOG091G0262
	count=$(cat ../../per_gene/EOG091G0262/ALICUT_EOG091G0262.clustalo.fasta | grep ">" | wc -l)
	if [ "$count" -gt 5 ]
        then
		RAxMLmodel=$(cat ../../per_gene/EOG091G0262/EOG091G0262.best_model | grep "Best" | cut -d ":" -f 2 | tr -d '[:space:]')
                if [ "$(ls -1 | grep "^RAxML" | wc -l)" -ne 0 ]
		then
			rm RAxML*
		fi
        	raxml -f a -T 2 -m PROTGAMMA$RAxMLmodel         	-p 12345 -x 12345 -# 100         	-s ../../per_gene/EOG091G0262/ALICUT_EOG091G0262.clustalo.fasta -n EOG091G0262.clustalo.aln.ALICUT.$RAxMLmodel 		1> ../../per_gene/EOG091G0262/infer_single_ML.stdout.txt 2> ../../per_gene/EOG091G0262/infer_single_ML.stderr.txt
	else
		echo "fasta file per_gene/EOG091G0262/ALICUT_EOG091G0262.clustalo.fasta contains fewer than 5 sequences - skipped" > ../../per_gene/EOG091G0262/infer_single_ML.stdout.txt
		touch raxml.skipped
	fi
        touch ../../per_gene/EOG091G0262/EOG091G0262.raxml.done
        [0m
[Mon Jul  6 00:10:38 2020]
Finished job 222.
2833 of 3292 steps (86%) done

[Mon Jul  6 00:10:38 2020]
rule get_seqs:
    input: /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ingroup.txt, /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/outgroup.txt
    output: per_gene/EOG091G132G/EOG091G132G.ingroup.fasta
    log: per_gene/EOG091G132G/get_seqs.stdout.txt, per_gene/EOG091G132G/get_seqs.stderr.txt
    jobid: 2928
    wildcards: BUSCO=EOG091G132G
    threads: 2


	basedir=$(pwd)
        cd per_gene/EOG091G132G
        
        bash $basedir/../scripts/fetch_seqs.sh EOG091G132G /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ingroup.txt /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/outgroup.txt 1> ../../per_gene/EOG091G132G/get_seqs.stdout.txt 2> ../../per_gene/EOG091G132G/get_seqs.stderr.txt
	mv EOG091G132G.fasta $basedir/per_gene/EOG091G132G/EOG091G132G.ingroup.fasta
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/72476f9d9a5bd0627b4d721143a21354.simg
[Mon Jul  6 00:10:53 2020]
Finished job 2928.
2834 of 3292 steps (86%) done

[Mon Jul  6 00:10:53 2020]
rule get_outgroups:
    input: per_gene/EOG091G132G/EOG091G132G.ingroup.fasta
    output: per_gene/EOG091G132G/EOG091G132G.orthodb.fasta, per_gene/EOG091G132G/EOG091G132G.outgroup.fasta
    log: per_gene/EOG091G132G/get_outgroups.stdout.txt, per_gene/EOG091G132G/get_outgroups.stderr.txt
    jobid: 2929
    wildcards: BUSCO=EOG091G132G


        #download fastas from Orhtodb for BUSCO id
        for i in {1..5}
        do
             wget "http://www.orthodb.org/fasta?query=EOG091G132G&level=33208" -O per_gene/EOG091G132G/EOG091G132G.orthodb.fasta 1> per_gene/EOG091G132G/get_outgroups.stdout.txt 2> per_gene/EOG091G132G/get_outgroups.stderr.txt && break || echo -e "try again ($i)" && sleep 15
        done

	#This is quick an dirty for now and just takes the first protein if there is more than one for an outgroup taxon
        bash ../scripts/download_outgroups.sh taxids.txt per_gene/EOG091G132G/EOG091G132G.orthodb.fasta > per_gene/EOG091G132G/EOG091G132G.outgroup.fasta
        
[Mon Jul  6 00:10:53 2020]
Finished job 2929.
2835 of 3292 steps (86%) done

[Mon Jul  6 00:10:53 2020]
rule join_groups:
    input: per_gene/EOG091G132G/EOG091G132G.ingroup.fasta, per_gene/EOG091G132G/EOG091G132G.outgroup.fasta
    output: per_gene/EOG091G132G/EOG091G132G.fasta
    jobid: 2288
    wildcards: BUSCO=EOG091G132G


        cat per_gene/EOG091G132G/EOG091G132G.ingroup.fasta per_gene/EOG091G132G/EOG091G132G.outgroup.fasta > per_gene/EOG091G132G/EOG091G132G.fasta
        
[Mon Jul  6 00:10:54 2020]
Finished job 2288.
2836 of 3292 steps (86%) done

[Mon Jul  6 00:10:54 2020]
rule MSA:
    input: per_gene/EOG091G132G/EOG091G132G.fasta
    output: per_gene/EOG091G132G/EOG091G132G.clustalo.fasta
    log: per_gene/EOG091G132G/MSA.stdout.txt, per_gene/EOG091G132G/MSA.stderr.txt
    jobid: 1696
    wildcards: BUSCO=EOG091G132G
    threads: 2


        clustalo -i per_gene/EOG091G132G/EOG091G132G.fasta -o per_gene/EOG091G132G/EOG091G132G.clustalo.fasta --threads=2 1> per_gene/EOG091G132G/MSA.stdout.txt 2> per_gene/EOG091G132G/MSA.stderr.txt
        
[Mon Jul  6 00:10:54 2020]
Finished job 272.
2837 of 3292 steps (86%) done
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/d68c9691725a7401923680874285c430.simg

[Mon Jul  6 00:10:54 2020]
rule get_seqs:
    input: /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ingroup.txt, /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/outgroup.txt
    output: per_gene/EOG091G0QW9/EOG091G0QW9.ingroup.fasta
    log: per_gene/EOG091G0QW9/get_seqs.stdout.txt, per_gene/EOG091G0QW9/get_seqs.stderr.txt
    jobid: 2824
    wildcards: BUSCO=EOG091G0QW9
    threads: 2


	basedir=$(pwd)
        cd per_gene/EOG091G0QW9
        
        bash $basedir/../scripts/fetch_seqs.sh EOG091G0QW9 /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ingroup.txt /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/outgroup.txt 1> ../../per_gene/EOG091G0QW9/get_seqs.stdout.txt 2> ../../per_gene/EOG091G0QW9/get_seqs.stderr.txt
	mv EOG091G0QW9.fasta $basedir/per_gene/EOG091G0QW9/EOG091G0QW9.ingroup.fasta
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/72476f9d9a5bd0627b4d721143a21354.simg
[Mon Jul  6 00:10:56 2020]
Finished job 1696.
2838 of 3292 steps (86%) done

[Mon Jul  6 00:10:56 2020]
rule score_and_cut:
    input: per_gene/EOG091G132G/EOG091G132G.clustalo.fasta
    output: per_gene/EOG091G132G/ALICUT_EOG091G132G.clustalo.fasta
    jobid: 873
    wildcards: BUSCO=EOG091G132G
    threads: 2


        cd per_gene/EOG091G132G
        Aliscore.pl -N -r 200000000000000000 -i ../../per_gene/EOG091G132G/EOG091G132G.clustalo.fasta &> aliscore.log
        ALICUT.pl -s &> alicut.log
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/63c88c27a0fa300f57066b0ef65fefcb.simg
[Mon Jul  6 00:11:08 2020]
Finished job 873.
2839 of 3292 steps (86%) done

[Mon Jul  6 00:11:08 2020]
rule remove_empty:
    input: per_gene/EOG091G132G/ALICUT_EOG091G132G.clustalo.fasta
    output: per_gene/EOG091G132G/empty_check.done
    jobid: 1695
    wildcards: BUSCO=EOG091G132G


         if [ "$(cat per_gene/EOG091G132G/ALICUT_EOG091G132G.clustalo.fasta | grep -v ">" | sed 's/-//g' | grep "^$" | wc -l)" -gt 0 ]
         then
              cp per_gene/EOG091G132G/ALICUT_EOG091G132G.clustalo.fasta per_gene/EOG091G132G/ALICUT_EOG091G132G.clustalo.fasta.backup
              bash ../scripts/remove_empty.sh per_gene/EOG091G132G/ALICUT_EOG091G132G.clustalo.fasta.backup > per_gene/EOG091G132G/ALICUT_EOG091G132G.clustalo.fasta
         fi
         touch per_gene/EOG091G132G/empty_check.done
         
[Mon Jul  6 00:11:08 2020]
Finished job 1695.
2840 of 3292 steps (86%) done

[Mon Jul  6 00:11:08 2020]
rule find_best_model:
    input: per_gene/EOG091G132G/ALICUT_EOG091G132G.clustalo.fasta, per_gene/EOG091G132G/empty_check.done
    output: per_gene/EOG091G132G/EOG091G132G.best_model
    log: per_gene/EOG091G132G/find_best_model.stderr.txt
    jobid: 872
    wildcards: BUSCO=EOG091G132G
    threads: 2


        cd per_gene/EOG091G132G
        if [ ! -d find_best_model ]
        then
            mkdir find_best_model
        fi
        cd find_best_model
        ln -s ../../../per_gene/EOG091G132G/ALICUT_EOG091G132G.clustalo.fasta EOG091G132G.fasta
        ProteinModelSelection.pl EOG091G132G.fasta 1> ../../../per_gene/EOG091G132G/EOG091G132G.best_model 2> ../../../per_gene/EOG091G132G/find_best_model.stderr.txt
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/c0c09ee657b1e27f2c5687e0e9aa8d70.simg
[Mon Jul  6 00:11:09 2020]
Finished job 2824.
2841 of 3292 steps (86%) done

[Mon Jul  6 00:11:09 2020]
rule get_outgroups:
    input: per_gene/EOG091G0QW9/EOG091G0QW9.ingroup.fasta
    output: per_gene/EOG091G0QW9/EOG091G0QW9.orthodb.fasta, per_gene/EOG091G0QW9/EOG091G0QW9.outgroup.fasta
    log: per_gene/EOG091G0QW9/get_outgroups.stdout.txt, per_gene/EOG091G0QW9/get_outgroups.stderr.txt
    jobid: 2825
    wildcards: BUSCO=EOG091G0QW9


        #download fastas from Orhtodb for BUSCO id
        for i in {1..5}
        do
             wget "http://www.orthodb.org/fasta?query=EOG091G0QW9&level=33208" -O per_gene/EOG091G0QW9/EOG091G0QW9.orthodb.fasta 1> per_gene/EOG091G0QW9/get_outgroups.stdout.txt 2> per_gene/EOG091G0QW9/get_outgroups.stderr.txt && break || echo -e "try again ($i)" && sleep 15
        done

	#This is quick an dirty for now and just takes the first protein if there is more than one for an outgroup taxon
        bash ../scripts/download_outgroups.sh taxids.txt per_gene/EOG091G0QW9/EOG091G0QW9.orthodb.fasta > per_gene/EOG091G0QW9/EOG091G0QW9.outgroup.fasta
        
[Mon Jul  6 00:11:10 2020]
Finished job 2825.
2842 of 3292 steps (86%) done

[Mon Jul  6 00:11:10 2020]
rule join_groups:
    input: per_gene/EOG091G0QW9/EOG091G0QW9.ingroup.fasta, per_gene/EOG091G0QW9/EOG091G0QW9.outgroup.fasta
    output: per_gene/EOG091G0QW9/EOG091G0QW9.fasta
    jobid: 2236
    wildcards: BUSCO=EOG091G0QW9


        cat per_gene/EOG091G0QW9/EOG091G0QW9.ingroup.fasta per_gene/EOG091G0QW9/EOG091G0QW9.outgroup.fasta > per_gene/EOG091G0QW9/EOG091G0QW9.fasta
        
[Mon Jul  6 00:11:10 2020]
Finished job 2236.
2843 of 3292 steps (86%) done

[Mon Jul  6 00:11:10 2020]
rule MSA:
    input: per_gene/EOG091G0QW9/EOG091G0QW9.fasta
    output: per_gene/EOG091G0QW9/EOG091G0QW9.clustalo.fasta
    log: per_gene/EOG091G0QW9/MSA.stdout.txt, per_gene/EOG091G0QW9/MSA.stderr.txt
    jobid: 1592
    wildcards: BUSCO=EOG091G0QW9
    threads: 2


        clustalo -i per_gene/EOG091G0QW9/EOG091G0QW9.fasta -o per_gene/EOG091G0QW9/EOG091G0QW9.clustalo.fasta --threads=2 1> per_gene/EOG091G0QW9/MSA.stdout.txt 2> per_gene/EOG091G0QW9/MSA.stderr.txt
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/d68c9691725a7401923680874285c430.simg
[Mon Jul  6 00:11:11 2020]
Finished job 1592.
2844 of 3292 steps (86%) done

[Mon Jul  6 00:11:11 2020]
rule score_and_cut:
    input: per_gene/EOG091G0QW9/EOG091G0QW9.clustalo.fasta
    output: per_gene/EOG091G0QW9/ALICUT_EOG091G0QW9.clustalo.fasta
    jobid: 769
    wildcards: BUSCO=EOG091G0QW9
    threads: 2


        cd per_gene/EOG091G0QW9
        Aliscore.pl -N -r 200000000000000000 -i ../../per_gene/EOG091G0QW9/EOG091G0QW9.clustalo.fasta &> aliscore.log
        ALICUT.pl -s &> alicut.log
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/63c88c27a0fa300f57066b0ef65fefcb.simg
[Mon Jul  6 00:11:20 2020]
Finished job 114.
2845 of 3292 steps (86%) done

[Mon Jul  6 00:11:20 2020]
rule get_seqs:
    input: /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ingroup.txt, /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/outgroup.txt
    output: per_gene/EOG091G06J6/EOG091G06J6.ingroup.fasta
    log: per_gene/EOG091G06J6/get_seqs.stdout.txt, per_gene/EOG091G06J6/get_seqs.stderr.txt
    jobid: 3064
    wildcards: BUSCO=EOG091G06J6
    threads: 2


	basedir=$(pwd)
        cd per_gene/EOG091G06J6
        
        bash $basedir/../scripts/fetch_seqs.sh EOG091G06J6 /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ingroup.txt /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/outgroup.txt 1> ../../per_gene/EOG091G06J6/get_seqs.stdout.txt 2> ../../per_gene/EOG091G06J6/get_seqs.stderr.txt
	mv EOG091G06J6.fasta $basedir/per_gene/EOG091G06J6/EOG091G06J6.ingroup.fasta
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/72476f9d9a5bd0627b4d721143a21354.simg
[Mon Jul  6 00:11:22 2020]
Finished job 769.
2846 of 3292 steps (86%) done

[Mon Jul  6 00:11:22 2020]
rule remove_empty:
    input: per_gene/EOG091G0QW9/ALICUT_EOG091G0QW9.clustalo.fasta
    output: per_gene/EOG091G0QW9/empty_check.done
    jobid: 1591
    wildcards: BUSCO=EOG091G0QW9


         if [ "$(cat per_gene/EOG091G0QW9/ALICUT_EOG091G0QW9.clustalo.fasta | grep -v ">" | sed 's/-//g' | grep "^$" | wc -l)" -gt 0 ]
         then
              cp per_gene/EOG091G0QW9/ALICUT_EOG091G0QW9.clustalo.fasta per_gene/EOG091G0QW9/ALICUT_EOG091G0QW9.clustalo.fasta.backup
              bash ../scripts/remove_empty.sh per_gene/EOG091G0QW9/ALICUT_EOG091G0QW9.clustalo.fasta.backup > per_gene/EOG091G0QW9/ALICUT_EOG091G0QW9.clustalo.fasta
         fi
         touch per_gene/EOG091G0QW9/empty_check.done
         
[Mon Jul  6 00:11:23 2020]
Finished job 1591.
2847 of 3292 steps (86%) done

[Mon Jul  6 00:11:23 2020]
rule find_best_model:
    input: per_gene/EOG091G0QW9/ALICUT_EOG091G0QW9.clustalo.fasta, per_gene/EOG091G0QW9/empty_check.done
    output: per_gene/EOG091G0QW9/EOG091G0QW9.best_model
    log: per_gene/EOG091G0QW9/find_best_model.stderr.txt
    jobid: 768
    wildcards: BUSCO=EOG091G0QW9
    threads: 2


        cd per_gene/EOG091G0QW9
        if [ ! -d find_best_model ]
        then
            mkdir find_best_model
        fi
        cd find_best_model
        ln -s ../../../per_gene/EOG091G0QW9/ALICUT_EOG091G0QW9.clustalo.fasta EOG091G0QW9.fasta
        ProteinModelSelection.pl EOG091G0QW9.fasta 1> ../../../per_gene/EOG091G0QW9/EOG091G0QW9.best_model 2> ../../../per_gene/EOG091G0QW9/find_best_model.stderr.txt
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/c0c09ee657b1e27f2c5687e0e9aa8d70.simg
[Mon Jul  6 00:11:35 2020]
Finished job 3064.
2848 of 3292 steps (87%) done

[Mon Jul  6 00:11:35 2020]
rule get_outgroups:
    input: per_gene/EOG091G06J6/EOG091G06J6.ingroup.fasta
    output: per_gene/EOG091G06J6/EOG091G06J6.orthodb.fasta, per_gene/EOG091G06J6/EOG091G06J6.outgroup.fasta
    log: per_gene/EOG091G06J6/get_outgroups.stdout.txt, per_gene/EOG091G06J6/get_outgroups.stderr.txt
    jobid: 3065
    wildcards: BUSCO=EOG091G06J6


        #download fastas from Orhtodb for BUSCO id
        for i in {1..5}
        do
             wget "http://www.orthodb.org/fasta?query=EOG091G06J6&level=33208" -O per_gene/EOG091G06J6/EOG091G06J6.orthodb.fasta 1> per_gene/EOG091G06J6/get_outgroups.stdout.txt 2> per_gene/EOG091G06J6/get_outgroups.stderr.txt && break || echo -e "try again ($i)" && sleep 15
        done

	#This is quick an dirty for now and just takes the first protein if there is more than one for an outgroup taxon
        bash ../scripts/download_outgroups.sh taxids.txt per_gene/EOG091G06J6/EOG091G06J6.orthodb.fasta > per_gene/EOG091G06J6/EOG091G06J6.outgroup.fasta
        
[Mon Jul  6 00:11:35 2020]
Finished job 3065.
2849 of 3292 steps (87%) done

[Mon Jul  6 00:11:35 2020]
rule join_groups:
    input: per_gene/EOG091G06J6/EOG091G06J6.ingroup.fasta, per_gene/EOG091G06J6/EOG091G06J6.outgroup.fasta
    output: per_gene/EOG091G06J6/EOG091G06J6.fasta
    jobid: 2356
    wildcards: BUSCO=EOG091G06J6


        cat per_gene/EOG091G06J6/EOG091G06J6.ingroup.fasta per_gene/EOG091G06J6/EOG091G06J6.outgroup.fasta > per_gene/EOG091G06J6/EOG091G06J6.fasta
        
[Mon Jul  6 00:11:35 2020]
Finished job 2356.
2850 of 3292 steps (87%) done

[Mon Jul  6 00:11:35 2020]
rule MSA:
    input: per_gene/EOG091G06J6/EOG091G06J6.fasta
    output: per_gene/EOG091G06J6/EOG091G06J6.clustalo.fasta
    log: per_gene/EOG091G06J6/MSA.stdout.txt, per_gene/EOG091G06J6/MSA.stderr.txt
    jobid: 1832
    wildcards: BUSCO=EOG091G06J6
    threads: 2


        clustalo -i per_gene/EOG091G06J6/EOG091G06J6.fasta -o per_gene/EOG091G06J6/EOG091G06J6.clustalo.fasta --threads=2 1> per_gene/EOG091G06J6/MSA.stdout.txt 2> per_gene/EOG091G06J6/MSA.stderr.txt
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/d68c9691725a7401923680874285c430.simg
[Mon Jul  6 00:11:38 2020]
Finished job 140.
2851 of 3292 steps (87%) done

[Mon Jul  6 00:11:38 2020]
rule get_seqs:
    input: /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ingroup.txt, /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/outgroup.txt
    output: per_gene/EOG091G0JEC/EOG091G0JEC.ingroup.fasta
    log: per_gene/EOG091G0JEC/get_seqs.stdout.txt, per_gene/EOG091G0JEC/get_seqs.stderr.txt
    jobid: 2726
    wildcards: BUSCO=EOG091G0JEC
    threads: 2


	basedir=$(pwd)
        cd per_gene/EOG091G0JEC
        
        bash $basedir/../scripts/fetch_seqs.sh EOG091G0JEC /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ingroup.txt /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/outgroup.txt 1> ../../per_gene/EOG091G0JEC/get_seqs.stdout.txt 2> ../../per_gene/EOG091G0JEC/get_seqs.stderr.txt
	mv EOG091G0JEC.fasta $basedir/per_gene/EOG091G0JEC/EOG091G0JEC.ingroup.fasta
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/72476f9d9a5bd0627b4d721143a21354.simg
[Mon Jul  6 00:11:41 2020]
Finished job 1832.
2852 of 3292 steps (87%) done

[Mon Jul  6 00:11:41 2020]
rule score_and_cut:
    input: per_gene/EOG091G06J6/EOG091G06J6.clustalo.fasta
    output: per_gene/EOG091G06J6/ALICUT_EOG091G06J6.clustalo.fasta
    jobid: 1009
    wildcards: BUSCO=EOG091G06J6
    threads: 2


        cd per_gene/EOG091G06J6
        Aliscore.pl -N -r 200000000000000000 -i ../../per_gene/EOG091G06J6/EOG091G06J6.clustalo.fasta &> aliscore.log
        ALICUT.pl -s &> alicut.log
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/63c88c27a0fa300f57066b0ef65fefcb.simg
[Mon Jul  6 00:11:41 2020]
Finished job 872.
2853 of 3292 steps (87%) done

[Mon Jul  6 00:11:41 2020]
rule infer_single_ML:
    input: per_gene/EOG091G132G/EOG091G132G.best_model, per_gene/EOG091G132G/ALICUT_EOG091G132G.clustalo.fasta
    output: per_gene/EOG091G132G/EOG091G132G.raxml.done
    log: per_gene/EOG091G132G/infer_single_ML.stdout.txt, per_gene/EOG091G132G/infer_single_ML.stderr.txt
    jobid: 230
    wildcards: BUSCO=EOG091G132G
    threads: 2


        cd per_gene/EOG091G132G
	count=$(cat ../../per_gene/EOG091G132G/ALICUT_EOG091G132G.clustalo.fasta | grep ">" | wc -l)
	if [ "$count" -gt 5 ]
        then
		RAxMLmodel=$(cat ../../per_gene/EOG091G132G/EOG091G132G.best_model | grep "Best" | cut -d ":" -f 2 | tr -d '[:space:]')
                if [ "$(ls -1 | grep "^RAxML" | wc -l)" -ne 0 ]
		then
			rm RAxML*
		fi
        	raxml -f a -T 2 -m PROTGAMMA$RAxMLmodel         	-p 12345 -x 12345 -# 100         	-s ../../per_gene/EOG091G132G/ALICUT_EOG091G132G.clustalo.fasta -n EOG091G132G.clustalo.aln.ALICUT.$RAxMLmodel 		1> ../../per_gene/EOG091G132G/infer_single_ML.stdout.txt 2> ../../per_gene/EOG091G132G/infer_single_ML.stderr.txt
	else
		echo "fasta file per_gene/EOG091G132G/ALICUT_EOG091G132G.clustalo.fasta contains fewer than 5 sequences - skipped" > ../../per_gene/EOG091G132G/infer_single_ML.stdout.txt
		touch raxml.skipped
	fi
        touch ../../per_gene/EOG091G132G/EOG091G132G.raxml.done
        
[33mJob counts:
	count	jobs
	1	infer_single_ML
	1[0m
[33m
        cd per_gene/EOG091G132G
	count=$(cat ../../per_gene/EOG091G132G/ALICUT_EOG091G132G.clustalo.fasta | grep ">" | wc -l)
	if [ "$count" -gt 5 ]
        then
		RAxMLmodel=$(cat ../../per_gene/EOG091G132G/EOG091G132G.best_model | grep "Best" | cut -d ":" -f 2 | tr -d '[:space:]')
                if [ "$(ls -1 | grep "^RAxML" | wc -l)" -ne 0 ]
		then
			rm RAxML*
		fi
        	raxml -f a -T 2 -m PROTGAMMA$RAxMLmodel         	-p 12345 -x 12345 -# 100         	-s ../../per_gene/EOG091G132G/ALICUT_EOG091G132G.clustalo.fasta -n EOG091G132G.clustalo.aln.ALICUT.$RAxMLmodel 		1> ../../per_gene/EOG091G132G/infer_single_ML.stdout.txt 2> ../../per_gene/EOG091G132G/infer_single_ML.stderr.txt
	else
		echo "fasta file per_gene/EOG091G132G/ALICUT_EOG091G132G.clustalo.fasta contains fewer than 5 sequences - skipped" > ../../per_gene/EOG091G132G/infer_single_ML.stdout.txt
		touch raxml.skipped
	fi
        touch ../../per_gene/EOG091G132G/EOG091G132G.raxml.done
        [0m
[Mon Jul  6 00:11:51 2020]
Finished job 1009.
2854 of 3292 steps (87%) done

[Mon Jul  6 00:11:51 2020]
rule remove_empty:
    input: per_gene/EOG091G06J6/ALICUT_EOG091G06J6.clustalo.fasta
    output: per_gene/EOG091G06J6/empty_check.done
    jobid: 1831
    wildcards: BUSCO=EOG091G06J6


         if [ "$(cat per_gene/EOG091G06J6/ALICUT_EOG091G06J6.clustalo.fasta | grep -v ">" | sed 's/-//g' | grep "^$" | wc -l)" -gt 0 ]
         then
              cp per_gene/EOG091G06J6/ALICUT_EOG091G06J6.clustalo.fasta per_gene/EOG091G06J6/ALICUT_EOG091G06J6.clustalo.fasta.backup
              bash ../scripts/remove_empty.sh per_gene/EOG091G06J6/ALICUT_EOG091G06J6.clustalo.fasta.backup > per_gene/EOG091G06J6/ALICUT_EOG091G06J6.clustalo.fasta
         fi
         touch per_gene/EOG091G06J6/empty_check.done
         
[Mon Jul  6 00:11:51 2020]
Finished job 1831.
2855 of 3292 steps (87%) done

[Mon Jul  6 00:11:51 2020]
rule find_best_model:
    input: per_gene/EOG091G06J6/ALICUT_EOG091G06J6.clustalo.fasta, per_gene/EOG091G06J6/empty_check.done
    output: per_gene/EOG091G06J6/EOG091G06J6.best_model
    log: per_gene/EOG091G06J6/find_best_model.stderr.txt
    jobid: 1008
    wildcards: BUSCO=EOG091G06J6
    threads: 2


        cd per_gene/EOG091G06J6
        if [ ! -d find_best_model ]
        then
            mkdir find_best_model
        fi
        cd find_best_model
        ln -s ../../../per_gene/EOG091G06J6/ALICUT_EOG091G06J6.clustalo.fasta EOG091G06J6.fasta
        ProteinModelSelection.pl EOG091G06J6.fasta 1> ../../../per_gene/EOG091G06J6/EOG091G06J6.best_model 2> ../../../per_gene/EOG091G06J6/find_best_model.stderr.txt
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/c0c09ee657b1e27f2c5687e0e9aa8d70.simg
[Mon Jul  6 00:11:52 2020]
Finished job 2726.
2856 of 3292 steps (87%) done

[Mon Jul  6 00:11:52 2020]
rule get_outgroups:
    input: per_gene/EOG091G0JEC/EOG091G0JEC.ingroup.fasta
    output: per_gene/EOG091G0JEC/EOG091G0JEC.orthodb.fasta, per_gene/EOG091G0JEC/EOG091G0JEC.outgroup.fasta
    log: per_gene/EOG091G0JEC/get_outgroups.stdout.txt, per_gene/EOG091G0JEC/get_outgroups.stderr.txt
    jobid: 2727
    wildcards: BUSCO=EOG091G0JEC


        #download fastas from Orhtodb for BUSCO id
        for i in {1..5}
        do
             wget "http://www.orthodb.org/fasta?query=EOG091G0JEC&level=33208" -O per_gene/EOG091G0JEC/EOG091G0JEC.orthodb.fasta 1> per_gene/EOG091G0JEC/get_outgroups.stdout.txt 2> per_gene/EOG091G0JEC/get_outgroups.stderr.txt && break || echo -e "try again ($i)" && sleep 15
        done

	#This is quick an dirty for now and just takes the first protein if there is more than one for an outgroup taxon
        bash ../scripts/download_outgroups.sh taxids.txt per_gene/EOG091G0JEC/EOG091G0JEC.orthodb.fasta > per_gene/EOG091G0JEC/EOG091G0JEC.outgroup.fasta
        
[Mon Jul  6 00:11:53 2020]
Finished job 2727.
2857 of 3292 steps (87%) done

[Mon Jul  6 00:11:53 2020]
rule join_groups:
    input: per_gene/EOG091G0JEC/EOG091G0JEC.ingroup.fasta, per_gene/EOG091G0JEC/EOG091G0JEC.outgroup.fasta
    output: per_gene/EOG091G0JEC/EOG091G0JEC.fasta
    jobid: 2187
    wildcards: BUSCO=EOG091G0JEC


        cat per_gene/EOG091G0JEC/EOG091G0JEC.ingroup.fasta per_gene/EOG091G0JEC/EOG091G0JEC.outgroup.fasta > per_gene/EOG091G0JEC/EOG091G0JEC.fasta
        
[Mon Jul  6 00:11:53 2020]
Finished job 2187.
2858 of 3292 steps (87%) done

[Mon Jul  6 00:11:53 2020]
rule MSA:
    input: per_gene/EOG091G0JEC/EOG091G0JEC.fasta
    output: per_gene/EOG091G0JEC/EOG091G0JEC.clustalo.fasta
    log: per_gene/EOG091G0JEC/MSA.stdout.txt, per_gene/EOG091G0JEC/MSA.stderr.txt
    jobid: 1494
    wildcards: BUSCO=EOG091G0JEC
    threads: 2


        clustalo -i per_gene/EOG091G0JEC/EOG091G0JEC.fasta -o per_gene/EOG091G0JEC/EOG091G0JEC.clustalo.fasta --threads=2 1> per_gene/EOG091G0JEC/MSA.stdout.txt 2> per_gene/EOG091G0JEC/MSA.stderr.txt
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/d68c9691725a7401923680874285c430.simg
[Mon Jul  6 00:11:54 2020]
Finished job 1494.
2859 of 3292 steps (87%) done

[Mon Jul  6 00:11:54 2020]
rule score_and_cut:
    input: per_gene/EOG091G0JEC/EOG091G0JEC.clustalo.fasta
    output: per_gene/EOG091G0JEC/ALICUT_EOG091G0JEC.clustalo.fasta
    jobid: 671
    wildcards: BUSCO=EOG091G0JEC
    threads: 2


        cd per_gene/EOG091G0JEC
        Aliscore.pl -N -r 200000000000000000 -i ../../per_gene/EOG091G0JEC/EOG091G0JEC.clustalo.fasta &> aliscore.log
        ALICUT.pl -s &> alicut.log
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/63c88c27a0fa300f57066b0ef65fefcb.simg
[Mon Jul  6 00:11:58 2020]
Finished job 768.
2860 of 3292 steps (87%) done

[Mon Jul  6 00:11:58 2020]
rule infer_single_ML:
    input: per_gene/EOG091G0QW9/EOG091G0QW9.best_model, per_gene/EOG091G0QW9/ALICUT_EOG091G0QW9.clustalo.fasta
    output: per_gene/EOG091G0QW9/EOG091G0QW9.raxml.done
    log: per_gene/EOG091G0QW9/infer_single_ML.stdout.txt, per_gene/EOG091G0QW9/infer_single_ML.stderr.txt
    jobid: 178
    wildcards: BUSCO=EOG091G0QW9
    threads: 2


        cd per_gene/EOG091G0QW9
	count=$(cat ../../per_gene/EOG091G0QW9/ALICUT_EOG091G0QW9.clustalo.fasta | grep ">" | wc -l)
	if [ "$count" -gt 5 ]
        then
		RAxMLmodel=$(cat ../../per_gene/EOG091G0QW9/EOG091G0QW9.best_model | grep "Best" | cut -d ":" -f 2 | tr -d '[:space:]')
                if [ "$(ls -1 | grep "^RAxML" | wc -l)" -ne 0 ]
		then
			rm RAxML*
		fi
        	raxml -f a -T 2 -m PROTGAMMA$RAxMLmodel         	-p 12345 -x 12345 -# 100         	-s ../../per_gene/EOG091G0QW9/ALICUT_EOG091G0QW9.clustalo.fasta -n EOG091G0QW9.clustalo.aln.ALICUT.$RAxMLmodel 		1> ../../per_gene/EOG091G0QW9/infer_single_ML.stdout.txt 2> ../../per_gene/EOG091G0QW9/infer_single_ML.stderr.txt
	else
		echo "fasta file per_gene/EOG091G0QW9/ALICUT_EOG091G0QW9.clustalo.fasta contains fewer than 5 sequences - skipped" > ../../per_gene/EOG091G0QW9/infer_single_ML.stdout.txt
		touch raxml.skipped
	fi
        touch ../../per_gene/EOG091G0QW9/EOG091G0QW9.raxml.done
        
[33mJob counts:
	count	jobs
	1	infer_single_ML
	1[0m
[33m
        cd per_gene/EOG091G0QW9
	count=$(cat ../../per_gene/EOG091G0QW9/ALICUT_EOG091G0QW9.clustalo.fasta | grep ">" | wc -l)
	if [ "$count" -gt 5 ]
        then
		RAxMLmodel=$(cat ../../per_gene/EOG091G0QW9/EOG091G0QW9.best_model | grep "Best" | cut -d ":" -f 2 | tr -d '[:space:]')
                if [ "$(ls -1 | grep "^RAxML" | wc -l)" -ne 0 ]
		then
			rm RAxML*
		fi
        	raxml -f a -T 2 -m PROTGAMMA$RAxMLmodel         	-p 12345 -x 12345 -# 100         	-s ../../per_gene/EOG091G0QW9/ALICUT_EOG091G0QW9.clustalo.fasta -n EOG091G0QW9.clustalo.aln.ALICUT.$RAxMLmodel 		1> ../../per_gene/EOG091G0QW9/infer_single_ML.stdout.txt 2> ../../per_gene/EOG091G0QW9/infer_single_ML.stderr.txt
	else
		echo "fasta file per_gene/EOG091G0QW9/ALICUT_EOG091G0QW9.clustalo.fasta contains fewer than 5 sequences - skipped" > ../../per_gene/EOG091G0QW9/infer_single_ML.stdout.txt
		touch raxml.skipped
	fi
        touch ../../per_gene/EOG091G0QW9/EOG091G0QW9.raxml.done
        [0m
[Mon Jul  6 00:12:00 2020]
Finished job 305.
2861 of 3292 steps (87%) done

[Mon Jul  6 00:12:00 2020]
rule get_seqs:
    input: /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ingroup.txt, /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/outgroup.txt
    output: per_gene/EOG091G05YC/EOG091G05YC.ingroup.fasta
    log: per_gene/EOG091G05YC/get_seqs.stdout.txt, per_gene/EOG091G05YC/get_seqs.stderr.txt
    jobid: 2554
    wildcards: BUSCO=EOG091G05YC
    threads: 2


	basedir=$(pwd)
        cd per_gene/EOG091G05YC
        
        bash $basedir/../scripts/fetch_seqs.sh EOG091G05YC /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ingroup.txt /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/outgroup.txt 1> ../../per_gene/EOG091G05YC/get_seqs.stdout.txt 2> ../../per_gene/EOG091G05YC/get_seqs.stderr.txt
	mv EOG091G05YC.fasta $basedir/per_gene/EOG091G05YC/EOG091G05YC.ingroup.fasta
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/72476f9d9a5bd0627b4d721143a21354.simg
[Mon Jul  6 00:12:01 2020]
Finished job 91.
2862 of 3292 steps (87%) done

[Mon Jul  6 00:12:01 2020]
rule get_seqs:
    input: /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ingroup.txt, /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/outgroup.txt
    output: per_gene/EOG091G03Z1/EOG091G03Z1.ingroup.fasta
    log: per_gene/EOG091G03Z1/get_seqs.stdout.txt, per_gene/EOG091G03Z1/get_seqs.stderr.txt
    jobid: 3056
    wildcards: BUSCO=EOG091G03Z1
    threads: 2


	basedir=$(pwd)
        cd per_gene/EOG091G03Z1
        
        bash $basedir/../scripts/fetch_seqs.sh EOG091G03Z1 /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ingroup.txt /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/outgroup.txt 1> ../../per_gene/EOG091G03Z1/get_seqs.stdout.txt 2> ../../per_gene/EOG091G03Z1/get_seqs.stderr.txt
	mv EOG091G03Z1.fasta $basedir/per_gene/EOG091G03Z1/EOG091G03Z1.ingroup.fasta
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/72476f9d9a5bd0627b4d721143a21354.simg
[Mon Jul  6 00:12:04 2020]
Finished job 671.
2863 of 3292 steps (87%) done

[Mon Jul  6 00:12:04 2020]
rule remove_empty:
    input: per_gene/EOG091G0JEC/ALICUT_EOG091G0JEC.clustalo.fasta
    output: per_gene/EOG091G0JEC/empty_check.done
    jobid: 1493
    wildcards: BUSCO=EOG091G0JEC


         if [ "$(cat per_gene/EOG091G0JEC/ALICUT_EOG091G0JEC.clustalo.fasta | grep -v ">" | sed 's/-//g' | grep "^$" | wc -l)" -gt 0 ]
         then
              cp per_gene/EOG091G0JEC/ALICUT_EOG091G0JEC.clustalo.fasta per_gene/EOG091G0JEC/ALICUT_EOG091G0JEC.clustalo.fasta.backup
              bash ../scripts/remove_empty.sh per_gene/EOG091G0JEC/ALICUT_EOG091G0JEC.clustalo.fasta.backup > per_gene/EOG091G0JEC/ALICUT_EOG091G0JEC.clustalo.fasta
         fi
         touch per_gene/EOG091G0JEC/empty_check.done
         
[Mon Jul  6 00:12:04 2020]
Finished job 1493.
2864 of 3292 steps (87%) done

[Mon Jul  6 00:12:04 2020]
rule find_best_model:
    input: per_gene/EOG091G0JEC/ALICUT_EOG091G0JEC.clustalo.fasta, per_gene/EOG091G0JEC/empty_check.done
    output: per_gene/EOG091G0JEC/EOG091G0JEC.best_model
    log: per_gene/EOG091G0JEC/find_best_model.stderr.txt
    jobid: 670
    wildcards: BUSCO=EOG091G0JEC
    threads: 2


        cd per_gene/EOG091G0JEC
        if [ ! -d find_best_model ]
        then
            mkdir find_best_model
        fi
        cd find_best_model
        ln -s ../../../per_gene/EOG091G0JEC/ALICUT_EOG091G0JEC.clustalo.fasta EOG091G0JEC.fasta
        ProteinModelSelection.pl EOG091G0JEC.fasta 1> ../../../per_gene/EOG091G0JEC/EOG091G0JEC.best_model 2> ../../../per_gene/EOG091G0JEC/find_best_model.stderr.txt
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/c0c09ee657b1e27f2c5687e0e9aa8d70.simg
[Mon Jul  6 00:12:13 2020]
Finished job 2554.
2865 of 3292 steps (87%) done

[Mon Jul  6 00:12:13 2020]
rule get_outgroups:
    input: per_gene/EOG091G05YC/EOG091G05YC.ingroup.fasta
    output: per_gene/EOG091G05YC/EOG091G05YC.orthodb.fasta, per_gene/EOG091G05YC/EOG091G05YC.outgroup.fasta
    log: per_gene/EOG091G05YC/get_outgroups.stdout.txt, per_gene/EOG091G05YC/get_outgroups.stderr.txt
    jobid: 2555
    wildcards: BUSCO=EOG091G05YC


        #download fastas from Orhtodb for BUSCO id
        for i in {1..5}
        do
             wget "http://www.orthodb.org/fasta?query=EOG091G05YC&level=33208" -O per_gene/EOG091G05YC/EOG091G05YC.orthodb.fasta 1> per_gene/EOG091G05YC/get_outgroups.stdout.txt 2> per_gene/EOG091G05YC/get_outgroups.stderr.txt && break || echo -e "try again ($i)" && sleep 15
        done

	#This is quick an dirty for now and just takes the first protein if there is more than one for an outgroup taxon
        bash ../scripts/download_outgroups.sh taxids.txt per_gene/EOG091G05YC/EOG091G05YC.orthodb.fasta > per_gene/EOG091G05YC/EOG091G05YC.outgroup.fasta
        
[Mon Jul  6 00:12:14 2020]
Finished job 2555.
2866 of 3292 steps (87%) done

[Mon Jul  6 00:12:14 2020]
rule join_groups:
    input: per_gene/EOG091G05YC/EOG091G05YC.ingroup.fasta, per_gene/EOG091G05YC/EOG091G05YC.outgroup.fasta
    output: per_gene/EOG091G05YC/EOG091G05YC.fasta
    jobid: 2101
    wildcards: BUSCO=EOG091G05YC


        cat per_gene/EOG091G05YC/EOG091G05YC.ingroup.fasta per_gene/EOG091G05YC/EOG091G05YC.outgroup.fasta > per_gene/EOG091G05YC/EOG091G05YC.fasta
        
[Mon Jul  6 00:12:14 2020]
Finished job 2101.
2867 of 3292 steps (87%) done

[Mon Jul  6 00:12:14 2020]
rule MSA:
    input: per_gene/EOG091G05YC/EOG091G05YC.fasta
    output: per_gene/EOG091G05YC/EOG091G05YC.clustalo.fasta
    log: per_gene/EOG091G05YC/MSA.stdout.txt, per_gene/EOG091G05YC/MSA.stderr.txt
    jobid: 1322
    wildcards: BUSCO=EOG091G05YC
    threads: 2


        clustalo -i per_gene/EOG091G05YC/EOG091G05YC.fasta -o per_gene/EOG091G05YC/EOG091G05YC.clustalo.fasta --threads=2 1> per_gene/EOG091G05YC/MSA.stdout.txt 2> per_gene/EOG091G05YC/MSA.stderr.txt
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/d68c9691725a7401923680874285c430.simg
[Mon Jul  6 00:12:15 2020]
Finished job 3056.
2868 of 3292 steps (87%) done

[Mon Jul  6 00:12:15 2020]
rule get_outgroups:
    input: per_gene/EOG091G03Z1/EOG091G03Z1.ingroup.fasta
    output: per_gene/EOG091G03Z1/EOG091G03Z1.orthodb.fasta, per_gene/EOG091G03Z1/EOG091G03Z1.outgroup.fasta
    log: per_gene/EOG091G03Z1/get_outgroups.stdout.txt, per_gene/EOG091G03Z1/get_outgroups.stderr.txt
    jobid: 3057
    wildcards: BUSCO=EOG091G03Z1


        #download fastas from Orhtodb for BUSCO id
        for i in {1..5}
        do
             wget "http://www.orthodb.org/fasta?query=EOG091G03Z1&level=33208" -O per_gene/EOG091G03Z1/EOG091G03Z1.orthodb.fasta 1> per_gene/EOG091G03Z1/get_outgroups.stdout.txt 2> per_gene/EOG091G03Z1/get_outgroups.stderr.txt && break || echo -e "try again ($i)" && sleep 15
        done

	#This is quick an dirty for now and just takes the first protein if there is more than one for an outgroup taxon
        bash ../scripts/download_outgroups.sh taxids.txt per_gene/EOG091G03Z1/EOG091G03Z1.orthodb.fasta > per_gene/EOG091G03Z1/EOG091G03Z1.outgroup.fasta
        
[Mon Jul  6 00:12:15 2020]
Finished job 3057.
2869 of 3292 steps (87%) done

[Mon Jul  6 00:12:16 2020]
rule join_groups:
    input: per_gene/EOG091G03Z1/EOG091G03Z1.ingroup.fasta, per_gene/EOG091G03Z1/EOG091G03Z1.outgroup.fasta
    output: per_gene/EOG091G03Z1/EOG091G03Z1.fasta
    jobid: 2352
    wildcards: BUSCO=EOG091G03Z1


        cat per_gene/EOG091G03Z1/EOG091G03Z1.ingroup.fasta per_gene/EOG091G03Z1/EOG091G03Z1.outgroup.fasta > per_gene/EOG091G03Z1/EOG091G03Z1.fasta
        
[Mon Jul  6 00:12:16 2020]
Finished job 2352.
2870 of 3292 steps (87%) done

[Mon Jul  6 00:12:16 2020]
rule MSA:
    input: per_gene/EOG091G03Z1/EOG091G03Z1.fasta
    output: per_gene/EOG091G03Z1/EOG091G03Z1.clustalo.fasta
    log: per_gene/EOG091G03Z1/MSA.stdout.txt, per_gene/EOG091G03Z1/MSA.stderr.txt
    jobid: 1824
    wildcards: BUSCO=EOG091G03Z1
    threads: 2


        clustalo -i per_gene/EOG091G03Z1/EOG091G03Z1.fasta -o per_gene/EOG091G03Z1/EOG091G03Z1.clustalo.fasta --threads=2 1> per_gene/EOG091G03Z1/MSA.stdout.txt 2> per_gene/EOG091G03Z1/MSA.stderr.txt
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/d68c9691725a7401923680874285c430.simg
[Mon Jul  6 00:12:16 2020]
Finished job 1322.
2871 of 3292 steps (87%) done

[Mon Jul  6 00:12:16 2020]
rule score_and_cut:
    input: per_gene/EOG091G05YC/EOG091G05YC.clustalo.fasta
    output: per_gene/EOG091G05YC/ALICUT_EOG091G05YC.clustalo.fasta
    jobid: 499
    wildcards: BUSCO=EOG091G05YC
    threads: 2


        cd per_gene/EOG091G05YC
        Aliscore.pl -N -r 200000000000000000 -i ../../per_gene/EOG091G05YC/EOG091G05YC.clustalo.fasta &> aliscore.log
        ALICUT.pl -s &> alicut.log
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/63c88c27a0fa300f57066b0ef65fefcb.simg
[Mon Jul  6 00:12:19 2020]
Finished job 1824.
2872 of 3292 steps (87%) done

[Mon Jul  6 00:12:19 2020]
rule score_and_cut:
    input: per_gene/EOG091G03Z1/EOG091G03Z1.clustalo.fasta
    output: per_gene/EOG091G03Z1/ALICUT_EOG091G03Z1.clustalo.fasta
    jobid: 1001
    wildcards: BUSCO=EOG091G03Z1
    threads: 2


        cd per_gene/EOG091G03Z1
        Aliscore.pl -N -r 200000000000000000 -i ../../per_gene/EOG091G03Z1/EOG091G03Z1.clustalo.fasta &> aliscore.log
        ALICUT.pl -s &> alicut.log
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/63c88c27a0fa300f57066b0ef65fefcb.simg
[Mon Jul  6 00:12:22 2020]
Finished job 100.
2873 of 3292 steps (87%) done

[Mon Jul  6 00:12:22 2020]
rule get_seqs:
    input: /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ingroup.txt, /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/outgroup.txt
    output: per_gene/EOG091G06CB/EOG091G06CB.ingroup.fasta
    log: per_gene/EOG091G06CB/get_seqs.stdout.txt, per_gene/EOG091G06CB/get_seqs.stderr.txt
    jobid: 3144
    wildcards: BUSCO=EOG091G06CB
    threads: 2


	basedir=$(pwd)
        cd per_gene/EOG091G06CB
        
        bash $basedir/../scripts/fetch_seqs.sh EOG091G06CB /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ingroup.txt /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/outgroup.txt 1> ../../per_gene/EOG091G06CB/get_seqs.stdout.txt 2> ../../per_gene/EOG091G06CB/get_seqs.stderr.txt
	mv EOG091G06CB.fasta $basedir/per_gene/EOG091G06CB/EOG091G06CB.ingroup.fasta
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/72476f9d9a5bd0627b4d721143a21354.simg
[Mon Jul  6 00:12:25 2020]
Finished job 499.
2874 of 3292 steps (87%) done

[Mon Jul  6 00:12:25 2020]
rule remove_empty:
    input: per_gene/EOG091G05YC/ALICUT_EOG091G05YC.clustalo.fasta
    output: per_gene/EOG091G05YC/empty_check.done
    jobid: 1321
    wildcards: BUSCO=EOG091G05YC


         if [ "$(cat per_gene/EOG091G05YC/ALICUT_EOG091G05YC.clustalo.fasta | grep -v ">" | sed 's/-//g' | grep "^$" | wc -l)" -gt 0 ]
         then
              cp per_gene/EOG091G05YC/ALICUT_EOG091G05YC.clustalo.fasta per_gene/EOG091G05YC/ALICUT_EOG091G05YC.clustalo.fasta.backup
              bash ../scripts/remove_empty.sh per_gene/EOG091G05YC/ALICUT_EOG091G05YC.clustalo.fasta.backup > per_gene/EOG091G05YC/ALICUT_EOG091G05YC.clustalo.fasta
         fi
         touch per_gene/EOG091G05YC/empty_check.done
         
[Mon Jul  6 00:12:26 2020]
Finished job 1321.
2875 of 3292 steps (87%) done

[Mon Jul  6 00:12:26 2020]
rule find_best_model:
    input: per_gene/EOG091G05YC/ALICUT_EOG091G05YC.clustalo.fasta, per_gene/EOG091G05YC/empty_check.done
    output: per_gene/EOG091G05YC/EOG091G05YC.best_model
    log: per_gene/EOG091G05YC/find_best_model.stderr.txt
    jobid: 498
    wildcards: BUSCO=EOG091G05YC
    threads: 2


        cd per_gene/EOG091G05YC
        if [ ! -d find_best_model ]
        then
            mkdir find_best_model
        fi
        cd find_best_model
        ln -s ../../../per_gene/EOG091G05YC/ALICUT_EOG091G05YC.clustalo.fasta EOG091G05YC.fasta
        ProteinModelSelection.pl EOG091G05YC.fasta 1> ../../../per_gene/EOG091G05YC/EOG091G05YC.best_model 2> ../../../per_gene/EOG091G05YC/find_best_model.stderr.txt
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/c0c09ee657b1e27f2c5687e0e9aa8d70.simg
[Mon Jul  6 00:12:29 2020]
Finished job 1001.
2876 of 3292 steps (87%) done

[Mon Jul  6 00:12:29 2020]
rule remove_empty:
    input: per_gene/EOG091G03Z1/ALICUT_EOG091G03Z1.clustalo.fasta
    output: per_gene/EOG091G03Z1/empty_check.done
    jobid: 1823
    wildcards: BUSCO=EOG091G03Z1


         if [ "$(cat per_gene/EOG091G03Z1/ALICUT_EOG091G03Z1.clustalo.fasta | grep -v ">" | sed 's/-//g' | grep "^$" | wc -l)" -gt 0 ]
         then
              cp per_gene/EOG091G03Z1/ALICUT_EOG091G03Z1.clustalo.fasta per_gene/EOG091G03Z1/ALICUT_EOG091G03Z1.clustalo.fasta.backup
              bash ../scripts/remove_empty.sh per_gene/EOG091G03Z1/ALICUT_EOG091G03Z1.clustalo.fasta.backup > per_gene/EOG091G03Z1/ALICUT_EOG091G03Z1.clustalo.fasta
         fi
         touch per_gene/EOG091G03Z1/empty_check.done
         
[Mon Jul  6 00:12:29 2020]
Finished job 1823.
2877 of 3292 steps (87%) done

[Mon Jul  6 00:12:29 2020]
rule find_best_model:
    input: per_gene/EOG091G03Z1/ALICUT_EOG091G03Z1.clustalo.fasta, per_gene/EOG091G03Z1/empty_check.done
    output: per_gene/EOG091G03Z1/EOG091G03Z1.best_model
    log: per_gene/EOG091G03Z1/find_best_model.stderr.txt
    jobid: 1000
    wildcards: BUSCO=EOG091G03Z1
    threads: 2


        cd per_gene/EOG091G03Z1
        if [ ! -d find_best_model ]
        then
            mkdir find_best_model
        fi
        cd find_best_model
        ln -s ../../../per_gene/EOG091G03Z1/ALICUT_EOG091G03Z1.clustalo.fasta EOG091G03Z1.fasta
        ProteinModelSelection.pl EOG091G03Z1.fasta 1> ../../../per_gene/EOG091G03Z1/EOG091G03Z1.best_model 2> ../../../per_gene/EOG091G03Z1/find_best_model.stderr.txt
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/c0c09ee657b1e27f2c5687e0e9aa8d70.simg
[Mon Jul  6 00:12:33 2020]
Finished job 670.
2878 of 3292 steps (87%) done

[Mon Jul  6 00:12:33 2020]
rule infer_single_ML:
    input: per_gene/EOG091G0JEC/EOG091G0JEC.best_model, per_gene/EOG091G0JEC/ALICUT_EOG091G0JEC.clustalo.fasta
    output: per_gene/EOG091G0JEC/EOG091G0JEC.raxml.done
    log: per_gene/EOG091G0JEC/infer_single_ML.stdout.txt, per_gene/EOG091G0JEC/infer_single_ML.stderr.txt
    jobid: 129
    wildcards: BUSCO=EOG091G0JEC
    threads: 2


        cd per_gene/EOG091G0JEC
	count=$(cat ../../per_gene/EOG091G0JEC/ALICUT_EOG091G0JEC.clustalo.fasta | grep ">" | wc -l)
	if [ "$count" -gt 5 ]
        then
		RAxMLmodel=$(cat ../../per_gene/EOG091G0JEC/EOG091G0JEC.best_model | grep "Best" | cut -d ":" -f 2 | tr -d '[:space:]')
                if [ "$(ls -1 | grep "^RAxML" | wc -l)" -ne 0 ]
		then
			rm RAxML*
		fi
        	raxml -f a -T 2 -m PROTGAMMA$RAxMLmodel         	-p 12345 -x 12345 -# 100         	-s ../../per_gene/EOG091G0JEC/ALICUT_EOG091G0JEC.clustalo.fasta -n EOG091G0JEC.clustalo.aln.ALICUT.$RAxMLmodel 		1> ../../per_gene/EOG091G0JEC/infer_single_ML.stdout.txt 2> ../../per_gene/EOG091G0JEC/infer_single_ML.stderr.txt
	else
		echo "fasta file per_gene/EOG091G0JEC/ALICUT_EOG091G0JEC.clustalo.fasta contains fewer than 5 sequences - skipped" > ../../per_gene/EOG091G0JEC/infer_single_ML.stdout.txt
		touch raxml.skipped
	fi
        touch ../../per_gene/EOG091G0JEC/EOG091G0JEC.raxml.done
        
[33mJob counts:
	count	jobs
	1	infer_single_ML
	1[0m
[33m
        cd per_gene/EOG091G0JEC
	count=$(cat ../../per_gene/EOG091G0JEC/ALICUT_EOG091G0JEC.clustalo.fasta | grep ">" | wc -l)
	if [ "$count" -gt 5 ]
        then
		RAxMLmodel=$(cat ../../per_gene/EOG091G0JEC/EOG091G0JEC.best_model | grep "Best" | cut -d ":" -f 2 | tr -d '[:space:]')
                if [ "$(ls -1 | grep "^RAxML" | wc -l)" -ne 0 ]
		then
			rm RAxML*
		fi
        	raxml -f a -T 2 -m PROTGAMMA$RAxMLmodel         	-p 12345 -x 12345 -# 100         	-s ../../per_gene/EOG091G0JEC/ALICUT_EOG091G0JEC.clustalo.fasta -n EOG091G0JEC.clustalo.aln.ALICUT.$RAxMLmodel 		1> ../../per_gene/EOG091G0JEC/infer_single_ML.stdout.txt 2> ../../per_gene/EOG091G0JEC/infer_single_ML.stderr.txt
	else
		echo "fasta file per_gene/EOG091G0JEC/ALICUT_EOG091G0JEC.clustalo.fasta contains fewer than 5 sequences - skipped" > ../../per_gene/EOG091G0JEC/infer_single_ML.stdout.txt
		touch raxml.skipped
	fi
        touch ../../per_gene/EOG091G0JEC/EOG091G0JEC.raxml.done
        [0m
[Mon Jul  6 00:12:36 2020]
Finished job 173.
2879 of 3292 steps (87%) done

[Mon Jul  6 00:12:36 2020]
rule get_seqs:
    input: /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ingroup.txt, /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/outgroup.txt
    output: per_gene/EOG091G03I1/EOG091G03I1.ingroup.fasta
    log: per_gene/EOG091G03I1/get_seqs.stdout.txt, per_gene/EOG091G03I1/get_seqs.stderr.txt
    jobid: 2508
    wildcards: BUSCO=EOG091G03I1
    threads: 2


	basedir=$(pwd)
        cd per_gene/EOG091G03I1
        
        bash $basedir/../scripts/fetch_seqs.sh EOG091G03I1 /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ingroup.txt /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/outgroup.txt 1> ../../per_gene/EOG091G03I1/get_seqs.stdout.txt 2> ../../per_gene/EOG091G03I1/get_seqs.stderr.txt
	mv EOG091G03I1.fasta $basedir/per_gene/EOG091G03I1/EOG091G03I1.ingroup.fasta
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/72476f9d9a5bd0627b4d721143a21354.simg
[Mon Jul  6 00:12:37 2020]
Finished job 3144.
2880 of 3292 steps (87%) done

[Mon Jul  6 00:12:37 2020]
rule get_outgroups:
    input: per_gene/EOG091G06CB/EOG091G06CB.ingroup.fasta
    output: per_gene/EOG091G06CB/EOG091G06CB.orthodb.fasta, per_gene/EOG091G06CB/EOG091G06CB.outgroup.fasta
    log: per_gene/EOG091G06CB/get_outgroups.stdout.txt, per_gene/EOG091G06CB/get_outgroups.stderr.txt
    jobid: 3145
    wildcards: BUSCO=EOG091G06CB


        #download fastas from Orhtodb for BUSCO id
        for i in {1..5}
        do
             wget "http://www.orthodb.org/fasta?query=EOG091G06CB&level=33208" -O per_gene/EOG091G06CB/EOG091G06CB.orthodb.fasta 1> per_gene/EOG091G06CB/get_outgroups.stdout.txt 2> per_gene/EOG091G06CB/get_outgroups.stderr.txt && break || echo -e "try again ($i)" && sleep 15
        done

	#This is quick an dirty for now and just takes the first protein if there is more than one for an outgroup taxon
        bash ../scripts/download_outgroups.sh taxids.txt per_gene/EOG091G06CB/EOG091G06CB.orthodb.fasta > per_gene/EOG091G06CB/EOG091G06CB.outgroup.fasta
        
[Mon Jul  6 00:12:37 2020]
Finished job 3145.
2881 of 3292 steps (88%) done

[Mon Jul  6 00:12:37 2020]
rule join_groups:
    input: per_gene/EOG091G06CB/EOG091G06CB.ingroup.fasta, per_gene/EOG091G06CB/EOG091G06CB.outgroup.fasta
    output: per_gene/EOG091G06CB/EOG091G06CB.fasta
    jobid: 2396
    wildcards: BUSCO=EOG091G06CB


        cat per_gene/EOG091G06CB/EOG091G06CB.ingroup.fasta per_gene/EOG091G06CB/EOG091G06CB.outgroup.fasta > per_gene/EOG091G06CB/EOG091G06CB.fasta
        
[Mon Jul  6 00:12:38 2020]
Finished job 2396.
2882 of 3292 steps (88%) done

[Mon Jul  6 00:12:38 2020]
rule MSA:
    input: per_gene/EOG091G06CB/EOG091G06CB.fasta
    output: per_gene/EOG091G06CB/EOG091G06CB.clustalo.fasta
    log: per_gene/EOG091G06CB/MSA.stdout.txt, per_gene/EOG091G06CB/MSA.stderr.txt
    jobid: 1912
    wildcards: BUSCO=EOG091G06CB
    threads: 2


        clustalo -i per_gene/EOG091G06CB/EOG091G06CB.fasta -o per_gene/EOG091G06CB/EOG091G06CB.clustalo.fasta --threads=2 1> per_gene/EOG091G06CB/MSA.stdout.txt 2> per_gene/EOG091G06CB/MSA.stderr.txt
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/d68c9691725a7401923680874285c430.simg
[Mon Jul  6 00:12:39 2020]
Finished job 1912.
2883 of 3292 steps (88%) done

[Mon Jul  6 00:12:39 2020]
rule score_and_cut:
    input: per_gene/EOG091G06CB/EOG091G06CB.clustalo.fasta
    output: per_gene/EOG091G06CB/ALICUT_EOG091G06CB.clustalo.fasta
    jobid: 1089
    wildcards: BUSCO=EOG091G06CB
    threads: 2


        cd per_gene/EOG091G06CB
        Aliscore.pl -N -r 200000000000000000 -i ../../per_gene/EOG091G06CB/EOG091G06CB.clustalo.fasta &> aliscore.log
        ALICUT.pl -s &> alicut.log
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/63c88c27a0fa300f57066b0ef65fefcb.simg
[Mon Jul  6 00:12:42 2020]
Finished job 1008.
2884 of 3292 steps (88%) done

[Mon Jul  6 00:12:42 2020]
rule infer_single_ML:
    input: per_gene/EOG091G06J6/EOG091G06J6.best_model, per_gene/EOG091G06J6/ALICUT_EOG091G06J6.clustalo.fasta
    output: per_gene/EOG091G06J6/EOG091G06J6.raxml.done
    log: per_gene/EOG091G06J6/infer_single_ML.stdout.txt, per_gene/EOG091G06J6/infer_single_ML.stderr.txt
    jobid: 298
    wildcards: BUSCO=EOG091G06J6
    threads: 2


        cd per_gene/EOG091G06J6
	count=$(cat ../../per_gene/EOG091G06J6/ALICUT_EOG091G06J6.clustalo.fasta | grep ">" | wc -l)
	if [ "$count" -gt 5 ]
        then
		RAxMLmodel=$(cat ../../per_gene/EOG091G06J6/EOG091G06J6.best_model | grep "Best" | cut -d ":" -f 2 | tr -d '[:space:]')
                if [ "$(ls -1 | grep "^RAxML" | wc -l)" -ne 0 ]
		then
			rm RAxML*
		fi
        	raxml -f a -T 2 -m PROTGAMMA$RAxMLmodel         	-p 12345 -x 12345 -# 100         	-s ../../per_gene/EOG091G06J6/ALICUT_EOG091G06J6.clustalo.fasta -n EOG091G06J6.clustalo.aln.ALICUT.$RAxMLmodel 		1> ../../per_gene/EOG091G06J6/infer_single_ML.stdout.txt 2> ../../per_gene/EOG091G06J6/infer_single_ML.stderr.txt
	else
		echo "fasta file per_gene/EOG091G06J6/ALICUT_EOG091G06J6.clustalo.fasta contains fewer than 5 sequences - skipped" > ../../per_gene/EOG091G06J6/infer_single_ML.stdout.txt
		touch raxml.skipped
	fi
        touch ../../per_gene/EOG091G06J6/EOG091G06J6.raxml.done
        
[33mJob counts:
	count	jobs
	1	infer_single_ML
	1[0m
[33m
        cd per_gene/EOG091G06J6
	count=$(cat ../../per_gene/EOG091G06J6/ALICUT_EOG091G06J6.clustalo.fasta | grep ">" | wc -l)
	if [ "$count" -gt 5 ]
        then
		RAxMLmodel=$(cat ../../per_gene/EOG091G06J6/EOG091G06J6.best_model | grep "Best" | cut -d ":" -f 2 | tr -d '[:space:]')
                if [ "$(ls -1 | grep "^RAxML" | wc -l)" -ne 0 ]
		then
			rm RAxML*
		fi
        	raxml -f a -T 2 -m PROTGAMMA$RAxMLmodel         	-p 12345 -x 12345 -# 100         	-s ../../per_gene/EOG091G06J6/ALICUT_EOG091G06J6.clustalo.fasta -n EOG091G06J6.clustalo.aln.ALICUT.$RAxMLmodel 		1> ../../per_gene/EOG091G06J6/infer_single_ML.stdout.txt 2> ../../per_gene/EOG091G06J6/infer_single_ML.stderr.txt
	else
		echo "fasta file per_gene/EOG091G06J6/ALICUT_EOG091G06J6.clustalo.fasta contains fewer than 5 sequences - skipped" > ../../per_gene/EOG091G06J6/infer_single_ML.stdout.txt
		touch raxml.skipped
	fi
        touch ../../per_gene/EOG091G06J6/EOG091G06J6.raxml.done
        [0m
[Mon Jul  6 00:12:49 2020]
Finished job 1089.
2885 of 3292 steps (88%) done

[Mon Jul  6 00:12:49 2020]
rule remove_empty:
    input: per_gene/EOG091G06CB/ALICUT_EOG091G06CB.clustalo.fasta
    output: per_gene/EOG091G06CB/empty_check.done
    jobid: 1911
    wildcards: BUSCO=EOG091G06CB


         if [ "$(cat per_gene/EOG091G06CB/ALICUT_EOG091G06CB.clustalo.fasta | grep -v ">" | sed 's/-//g' | grep "^$" | wc -l)" -gt 0 ]
         then
              cp per_gene/EOG091G06CB/ALICUT_EOG091G06CB.clustalo.fasta per_gene/EOG091G06CB/ALICUT_EOG091G06CB.clustalo.fasta.backup
              bash ../scripts/remove_empty.sh per_gene/EOG091G06CB/ALICUT_EOG091G06CB.clustalo.fasta.backup > per_gene/EOG091G06CB/ALICUT_EOG091G06CB.clustalo.fasta
         fi
         touch per_gene/EOG091G06CB/empty_check.done
         
[Mon Jul  6 00:12:49 2020]
Finished job 1911.
2886 of 3292 steps (88%) done

[Mon Jul  6 00:12:49 2020]
rule find_best_model:
    input: per_gene/EOG091G06CB/ALICUT_EOG091G06CB.clustalo.fasta, per_gene/EOG091G06CB/empty_check.done
    output: per_gene/EOG091G06CB/EOG091G06CB.best_model
    log: per_gene/EOG091G06CB/find_best_model.stderr.txt
    jobid: 1088
    wildcards: BUSCO=EOG091G06CB
    threads: 2


        cd per_gene/EOG091G06CB
        if [ ! -d find_best_model ]
        then
            mkdir find_best_model
        fi
        cd find_best_model
        ln -s ../../../per_gene/EOG091G06CB/ALICUT_EOG091G06CB.clustalo.fasta EOG091G06CB.fasta
        ProteinModelSelection.pl EOG091G06CB.fasta 1> ../../../per_gene/EOG091G06CB/EOG091G06CB.best_model 2> ../../../per_gene/EOG091G06CB/find_best_model.stderr.txt
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/c0c09ee657b1e27f2c5687e0e9aa8d70.simg
[Mon Jul  6 00:12:52 2020]
Finished job 2508.
2887 of 3292 steps (88%) done

[Mon Jul  6 00:12:52 2020]
rule get_outgroups:
    input: per_gene/EOG091G03I1/EOG091G03I1.ingroup.fasta
    output: per_gene/EOG091G03I1/EOG091G03I1.orthodb.fasta, per_gene/EOG091G03I1/EOG091G03I1.outgroup.fasta
    log: per_gene/EOG091G03I1/get_outgroups.stdout.txt, per_gene/EOG091G03I1/get_outgroups.stderr.txt
    jobid: 2509
    wildcards: BUSCO=EOG091G03I1


        #download fastas from Orhtodb for BUSCO id
        for i in {1..5}
        do
             wget "http://www.orthodb.org/fasta?query=EOG091G03I1&level=33208" -O per_gene/EOG091G03I1/EOG091G03I1.orthodb.fasta 1> per_gene/EOG091G03I1/get_outgroups.stdout.txt 2> per_gene/EOG091G03I1/get_outgroups.stderr.txt && break || echo -e "try again ($i)" && sleep 15
        done

	#This is quick an dirty for now and just takes the first protein if there is more than one for an outgroup taxon
        bash ../scripts/download_outgroups.sh taxids.txt per_gene/EOG091G03I1/EOG091G03I1.orthodb.fasta > per_gene/EOG091G03I1/EOG091G03I1.outgroup.fasta
        
[Mon Jul  6 00:12:53 2020]
Finished job 2509.
2888 of 3292 steps (88%) done

[Mon Jul  6 00:12:53 2020]
rule join_groups:
    input: per_gene/EOG091G03I1/EOG091G03I1.ingroup.fasta, per_gene/EOG091G03I1/EOG091G03I1.outgroup.fasta
    output: per_gene/EOG091G03I1/EOG091G03I1.fasta
    jobid: 2078
    wildcards: BUSCO=EOG091G03I1


        cat per_gene/EOG091G03I1/EOG091G03I1.ingroup.fasta per_gene/EOG091G03I1/EOG091G03I1.outgroup.fasta > per_gene/EOG091G03I1/EOG091G03I1.fasta
        
[Mon Jul  6 00:12:53 2020]
Finished job 2078.
2889 of 3292 steps (88%) done

[Mon Jul  6 00:12:53 2020]
rule MSA:
    input: per_gene/EOG091G03I1/EOG091G03I1.fasta
    output: per_gene/EOG091G03I1/EOG091G03I1.clustalo.fasta
    log: per_gene/EOG091G03I1/MSA.stdout.txt, per_gene/EOG091G03I1/MSA.stderr.txt
    jobid: 1276
    wildcards: BUSCO=EOG091G03I1
    threads: 2


        clustalo -i per_gene/EOG091G03I1/EOG091G03I1.fasta -o per_gene/EOG091G03I1/EOG091G03I1.clustalo.fasta --threads=2 1> per_gene/EOG091G03I1/MSA.stdout.txt 2> per_gene/EOG091G03I1/MSA.stderr.txt
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/d68c9691725a7401923680874285c430.simg
[Mon Jul  6 00:12:56 2020]
Finished job 1276.
2890 of 3292 steps (88%) done

[Mon Jul  6 00:12:56 2020]
rule score_and_cut:
    input: per_gene/EOG091G03I1/EOG091G03I1.clustalo.fasta
    output: per_gene/EOG091G03I1/ALICUT_EOG091G03I1.clustalo.fasta
    jobid: 453
    wildcards: BUSCO=EOG091G03I1
    threads: 2


        cd per_gene/EOG091G03I1
        Aliscore.pl -N -r 200000000000000000 -i ../../per_gene/EOG091G03I1/EOG091G03I1.clustalo.fasta &> aliscore.log
        ALICUT.pl -s &> alicut.log
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/63c88c27a0fa300f57066b0ef65fefcb.simg
[Mon Jul  6 00:13:04 2020]
Finished job 498.
2891 of 3292 steps (88%) done

[Mon Jul  6 00:13:04 2020]
rule infer_single_ML:
    input: per_gene/EOG091G05YC/EOG091G05YC.best_model, per_gene/EOG091G05YC/ALICUT_EOG091G05YC.clustalo.fasta
    output: per_gene/EOG091G05YC/EOG091G05YC.raxml.done
    log: per_gene/EOG091G05YC/infer_single_ML.stdout.txt, per_gene/EOG091G05YC/infer_single_ML.stderr.txt
    jobid: 43
    wildcards: BUSCO=EOG091G05YC
    threads: 2


        cd per_gene/EOG091G05YC
	count=$(cat ../../per_gene/EOG091G05YC/ALICUT_EOG091G05YC.clustalo.fasta | grep ">" | wc -l)
	if [ "$count" -gt 5 ]
        then
		RAxMLmodel=$(cat ../../per_gene/EOG091G05YC/EOG091G05YC.best_model | grep "Best" | cut -d ":" -f 2 | tr -d '[:space:]')
                if [ "$(ls -1 | grep "^RAxML" | wc -l)" -ne 0 ]
		then
			rm RAxML*
		fi
        	raxml -f a -T 2 -m PROTGAMMA$RAxMLmodel         	-p 12345 -x 12345 -# 100         	-s ../../per_gene/EOG091G05YC/ALICUT_EOG091G05YC.clustalo.fasta -n EOG091G05YC.clustalo.aln.ALICUT.$RAxMLmodel 		1> ../../per_gene/EOG091G05YC/infer_single_ML.stdout.txt 2> ../../per_gene/EOG091G05YC/infer_single_ML.stderr.txt
	else
		echo "fasta file per_gene/EOG091G05YC/ALICUT_EOG091G05YC.clustalo.fasta contains fewer than 5 sequences - skipped" > ../../per_gene/EOG091G05YC/infer_single_ML.stdout.txt
		touch raxml.skipped
	fi
        touch ../../per_gene/EOG091G05YC/EOG091G05YC.raxml.done
        
[33mJob counts:
	count	jobs
	1	infer_single_ML
	1[0m
[33m
        cd per_gene/EOG091G05YC
	count=$(cat ../../per_gene/EOG091G05YC/ALICUT_EOG091G05YC.clustalo.fasta | grep ">" | wc -l)
	if [ "$count" -gt 5 ]
        then
		RAxMLmodel=$(cat ../../per_gene/EOG091G05YC/EOG091G05YC.best_model | grep "Best" | cut -d ":" -f 2 | tr -d '[:space:]')
                if [ "$(ls -1 | grep "^RAxML" | wc -l)" -ne 0 ]
		then
			rm RAxML*
		fi
        	raxml -f a -T 2 -m PROTGAMMA$RAxMLmodel         	-p 12345 -x 12345 -# 100         	-s ../../per_gene/EOG091G05YC/ALICUT_EOG091G05YC.clustalo.fasta -n EOG091G05YC.clustalo.aln.ALICUT.$RAxMLmodel 		1> ../../per_gene/EOG091G05YC/infer_single_ML.stdout.txt 2> ../../per_gene/EOG091G05YC/infer_single_ML.stderr.txt
	else
		echo "fasta file per_gene/EOG091G05YC/ALICUT_EOG091G05YC.clustalo.fasta contains fewer than 5 sequences - skipped" > ../../per_gene/EOG091G05YC/infer_single_ML.stdout.txt
		touch raxml.skipped
	fi
        touch ../../per_gene/EOG091G05YC/EOG091G05YC.raxml.done
        [0m
[Mon Jul  6 00:13:07 2020]
Finished job 453.
2892 of 3292 steps (88%) done

[Mon Jul  6 00:13:07 2020]
rule remove_empty:
    input: per_gene/EOG091G03I1/ALICUT_EOG091G03I1.clustalo.fasta
    output: per_gene/EOG091G03I1/empty_check.done
    jobid: 1275
    wildcards: BUSCO=EOG091G03I1


         if [ "$(cat per_gene/EOG091G03I1/ALICUT_EOG091G03I1.clustalo.fasta | grep -v ">" | sed 's/-//g' | grep "^$" | wc -l)" -gt 0 ]
         then
              cp per_gene/EOG091G03I1/ALICUT_EOG091G03I1.clustalo.fasta per_gene/EOG091G03I1/ALICUT_EOG091G03I1.clustalo.fasta.backup
              bash ../scripts/remove_empty.sh per_gene/EOG091G03I1/ALICUT_EOG091G03I1.clustalo.fasta.backup > per_gene/EOG091G03I1/ALICUT_EOG091G03I1.clustalo.fasta
         fi
         touch per_gene/EOG091G03I1/empty_check.done
         
[Mon Jul  6 00:13:07 2020]
Finished job 1275.
2893 of 3292 steps (88%) done

[Mon Jul  6 00:13:07 2020]
rule find_best_model:
    input: per_gene/EOG091G03I1/ALICUT_EOG091G03I1.clustalo.fasta, per_gene/EOG091G03I1/empty_check.done
    output: per_gene/EOG091G03I1/EOG091G03I1.best_model
    log: per_gene/EOG091G03I1/find_best_model.stderr.txt
    jobid: 452
    wildcards: BUSCO=EOG091G03I1
    threads: 2


        cd per_gene/EOG091G03I1
        if [ ! -d find_best_model ]
        then
            mkdir find_best_model
        fi
        cd find_best_model
        ln -s ../../../per_gene/EOG091G03I1/ALICUT_EOG091G03I1.clustalo.fasta EOG091G03I1.fasta
        ProteinModelSelection.pl EOG091G03I1.fasta 1> ../../../per_gene/EOG091G03I1/EOG091G03I1.best_model 2> ../../../per_gene/EOG091G03I1/find_best_model.stderr.txt
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/c0c09ee657b1e27f2c5687e0e9aa8d70.simg
[Mon Jul  6 00:13:09 2020]
Finished job 1000.
2894 of 3292 steps (88%) done

[Mon Jul  6 00:13:09 2020]
rule infer_single_ML:
    input: per_gene/EOG091G03Z1/EOG091G03Z1.best_model, per_gene/EOG091G03Z1/ALICUT_EOG091G03Z1.clustalo.fasta
    output: per_gene/EOG091G03Z1/EOG091G03Z1.raxml.done
    log: per_gene/EOG091G03Z1/infer_single_ML.stdout.txt, per_gene/EOG091G03Z1/infer_single_ML.stderr.txt
    jobid: 294
    wildcards: BUSCO=EOG091G03Z1
    threads: 2


        cd per_gene/EOG091G03Z1
	count=$(cat ../../per_gene/EOG091G03Z1/ALICUT_EOG091G03Z1.clustalo.fasta | grep ">" | wc -l)
	if [ "$count" -gt 5 ]
        then
		RAxMLmodel=$(cat ../../per_gene/EOG091G03Z1/EOG091G03Z1.best_model | grep "Best" | cut -d ":" -f 2 | tr -d '[:space:]')
                if [ "$(ls -1 | grep "^RAxML" | wc -l)" -ne 0 ]
		then
			rm RAxML*
		fi
        	raxml -f a -T 2 -m PROTGAMMA$RAxMLmodel         	-p 12345 -x 12345 -# 100         	-s ../../per_gene/EOG091G03Z1/ALICUT_EOG091G03Z1.clustalo.fasta -n EOG091G03Z1.clustalo.aln.ALICUT.$RAxMLmodel 		1> ../../per_gene/EOG091G03Z1/infer_single_ML.stdout.txt 2> ../../per_gene/EOG091G03Z1/infer_single_ML.stderr.txt
	else
		echo "fasta file per_gene/EOG091G03Z1/ALICUT_EOG091G03Z1.clustalo.fasta contains fewer than 5 sequences - skipped" > ../../per_gene/EOG091G03Z1/infer_single_ML.stdout.txt
		touch raxml.skipped
	fi
        touch ../../per_gene/EOG091G03Z1/EOG091G03Z1.raxml.done
        
[33mJob counts:
	count	jobs
	1	infer_single_ML
	1[0m
[33m
        cd per_gene/EOG091G03Z1
	count=$(cat ../../per_gene/EOG091G03Z1/ALICUT_EOG091G03Z1.clustalo.fasta | grep ">" | wc -l)
	if [ "$count" -gt 5 ]
        then
		RAxMLmodel=$(cat ../../per_gene/EOG091G03Z1/EOG091G03Z1.best_model | grep "Best" | cut -d ":" -f 2 | tr -d '[:space:]')
                if [ "$(ls -1 | grep "^RAxML" | wc -l)" -ne 0 ]
		then
			rm RAxML*
		fi
        	raxml -f a -T 2 -m PROTGAMMA$RAxMLmodel         	-p 12345 -x 12345 -# 100         	-s ../../per_gene/EOG091G03Z1/ALICUT_EOG091G03Z1.clustalo.fasta -n EOG091G03Z1.clustalo.aln.ALICUT.$RAxMLmodel 		1> ../../per_gene/EOG091G03Z1/infer_single_ML.stdout.txt 2> ../../per_gene/EOG091G03Z1/infer_single_ML.stderr.txt
	else
		echo "fasta file per_gene/EOG091G03Z1/ALICUT_EOG091G03Z1.clustalo.fasta contains fewer than 5 sequences - skipped" > ../../per_gene/EOG091G03Z1/infer_single_ML.stdout.txt
		touch raxml.skipped
	fi
        touch ../../per_gene/EOG091G03Z1/EOG091G03Z1.raxml.done
        [0m
[Mon Jul  6 00:13:14 2020]
Finished job 343.
2895 of 3292 steps (88%) done

[Mon Jul  6 00:13:14 2020]
rule get_seqs:
    input: /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ingroup.txt, /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/outgroup.txt
    output: per_gene/EOG091G0D26/EOG091G0D26.ingroup.fasta
    log: per_gene/EOG091G0D26/get_seqs.stdout.txt, per_gene/EOG091G0D26/get_seqs.stderr.txt
    jobid: 2656
    wildcards: BUSCO=EOG091G0D26
    threads: 2


	basedir=$(pwd)
        cd per_gene/EOG091G0D26
        
        bash $basedir/../scripts/fetch_seqs.sh EOG091G0D26 /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ingroup.txt /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/outgroup.txt 1> ../../per_gene/EOG091G0D26/get_seqs.stdout.txt 2> ../../per_gene/EOG091G0D26/get_seqs.stderr.txt
	mv EOG091G0D26.fasta $basedir/per_gene/EOG091G0D26/EOG091G0D26.ingroup.fasta
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/72476f9d9a5bd0627b4d721143a21354.simg
[Mon Jul  6 00:13:17 2020]
Finished job 321.
2896 of 3292 steps (88%) done

[Mon Jul  6 00:13:17 2020]
rule get_seqs:
    input: /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ingroup.txt, /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/outgroup.txt
    output: per_gene/EOG091G0KGO/EOG091G0KGO.ingroup.fasta
    log: per_gene/EOG091G0KGO/get_seqs.stdout.txt, per_gene/EOG091G0KGO/get_seqs.stderr.txt
    jobid: 2738
    wildcards: BUSCO=EOG091G0KGO
    threads: 2


	basedir=$(pwd)
        cd per_gene/EOG091G0KGO
        
        bash $basedir/../scripts/fetch_seqs.sh EOG091G0KGO /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ingroup.txt /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/outgroup.txt 1> ../../per_gene/EOG091G0KGO/get_seqs.stdout.txt 2> ../../per_gene/EOG091G0KGO/get_seqs.stderr.txt
	mv EOG091G0KGO.fasta $basedir/per_gene/EOG091G0KGO/EOG091G0KGO.ingroup.fasta
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/72476f9d9a5bd0627b4d721143a21354.simg
[Mon Jul  6 00:13:31 2020]
Finished job 2656.
2897 of 3292 steps (88%) done

[Mon Jul  6 00:13:31 2020]
rule get_outgroups:
    input: per_gene/EOG091G0D26/EOG091G0D26.ingroup.fasta
    output: per_gene/EOG091G0D26/EOG091G0D26.orthodb.fasta, per_gene/EOG091G0D26/EOG091G0D26.outgroup.fasta
    log: per_gene/EOG091G0D26/get_outgroups.stdout.txt, per_gene/EOG091G0D26/get_outgroups.stderr.txt
    jobid: 2657
    wildcards: BUSCO=EOG091G0D26


        #download fastas from Orhtodb for BUSCO id
        for i in {1..5}
        do
             wget "http://www.orthodb.org/fasta?query=EOG091G0D26&level=33208" -O per_gene/EOG091G0D26/EOG091G0D26.orthodb.fasta 1> per_gene/EOG091G0D26/get_outgroups.stdout.txt 2> per_gene/EOG091G0D26/get_outgroups.stderr.txt && break || echo -e "try again ($i)" && sleep 15
        done

	#This is quick an dirty for now and just takes the first protein if there is more than one for an outgroup taxon
        bash ../scripts/download_outgroups.sh taxids.txt per_gene/EOG091G0D26/EOG091G0D26.orthodb.fasta > per_gene/EOG091G0D26/EOG091G0D26.outgroup.fasta
        
[Mon Jul  6 00:13:31 2020]
Finished job 1088.
2898 of 3292 steps (88%) done

[Mon Jul  6 00:13:31 2020]
rule infer_single_ML:
    input: per_gene/EOG091G06CB/EOG091G06CB.best_model, per_gene/EOG091G06CB/ALICUT_EOG091G06CB.clustalo.fasta
    output: per_gene/EOG091G06CB/EOG091G06CB.raxml.done
    log: per_gene/EOG091G06CB/infer_single_ML.stdout.txt, per_gene/EOG091G06CB/infer_single_ML.stderr.txt
    jobid: 338
    wildcards: BUSCO=EOG091G06CB
    threads: 2


        cd per_gene/EOG091G06CB
	count=$(cat ../../per_gene/EOG091G06CB/ALICUT_EOG091G06CB.clustalo.fasta | grep ">" | wc -l)
	if [ "$count" -gt 5 ]
        then
		RAxMLmodel=$(cat ../../per_gene/EOG091G06CB/EOG091G06CB.best_model | grep "Best" | cut -d ":" -f 2 | tr -d '[:space:]')
                if [ "$(ls -1 | grep "^RAxML" | wc -l)" -ne 0 ]
		then
			rm RAxML*
		fi
        	raxml -f a -T 2 -m PROTGAMMA$RAxMLmodel         	-p 12345 -x 12345 -# 100         	-s ../../per_gene/EOG091G06CB/ALICUT_EOG091G06CB.clustalo.fasta -n EOG091G06CB.clustalo.aln.ALICUT.$RAxMLmodel 		1> ../../per_gene/EOG091G06CB/infer_single_ML.stdout.txt 2> ../../per_gene/EOG091G06CB/infer_single_ML.stderr.txt
	else
		echo "fasta file per_gene/EOG091G06CB/ALICUT_EOG091G06CB.clustalo.fasta contains fewer than 5 sequences - skipped" > ../../per_gene/EOG091G06CB/infer_single_ML.stdout.txt
		touch raxml.skipped
	fi
        touch ../../per_gene/EOG091G06CB/EOG091G06CB.raxml.done
        
[Mon Jul  6 00:13:32 2020]
Finished job 2657.
2899 of 3292 steps (88%) done

[Mon Jul  6 00:13:32 2020]
rule join_groups:
    input: per_gene/EOG091G0D26/EOG091G0D26.ingroup.fasta, per_gene/EOG091G0D26/EOG091G0D26.outgroup.fasta
    output: per_gene/EOG091G0D26/EOG091G0D26.fasta
    jobid: 2152
    wildcards: BUSCO=EOG091G0D26


        cat per_gene/EOG091G0D26/EOG091G0D26.ingroup.fasta per_gene/EOG091G0D26/EOG091G0D26.outgroup.fasta > per_gene/EOG091G0D26/EOG091G0D26.fasta
        
[Mon Jul  6 00:13:32 2020]
Finished job 2152.
2900 of 3292 steps (88%) done

[Mon Jul  6 00:13:32 2020]
rule MSA:
    input: per_gene/EOG091G0D26/EOG091G0D26.fasta
    output: per_gene/EOG091G0D26/EOG091G0D26.clustalo.fasta
    log: per_gene/EOG091G0D26/MSA.stdout.txt, per_gene/EOG091G0D26/MSA.stderr.txt
    jobid: 1424
    wildcards: BUSCO=EOG091G0D26
    threads: 2


        clustalo -i per_gene/EOG091G0D26/EOG091G0D26.fasta -o per_gene/EOG091G0D26/EOG091G0D26.clustalo.fasta --threads=2 1> per_gene/EOG091G0D26/MSA.stdout.txt 2> per_gene/EOG091G0D26/MSA.stderr.txt
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/d68c9691725a7401923680874285c430.simg
[33mJob counts:
	count	jobs
	1	infer_single_ML
	1[0m
[33m
        cd per_gene/EOG091G06CB
	count=$(cat ../../per_gene/EOG091G06CB/ALICUT_EOG091G06CB.clustalo.fasta | grep ">" | wc -l)
	if [ "$count" -gt 5 ]
        then
		RAxMLmodel=$(cat ../../per_gene/EOG091G06CB/EOG091G06CB.best_model | grep "Best" | cut -d ":" -f 2 | tr -d '[:space:]')
                if [ "$(ls -1 | grep "^RAxML" | wc -l)" -ne 0 ]
		then
			rm RAxML*
		fi
        	raxml -f a -T 2 -m PROTGAMMA$RAxMLmodel         	-p 12345 -x 12345 -# 100         	-s ../../per_gene/EOG091G06CB/ALICUT_EOG091G06CB.clustalo.fasta -n EOG091G06CB.clustalo.aln.ALICUT.$RAxMLmodel 		1> ../../per_gene/EOG091G06CB/infer_single_ML.stdout.txt 2> ../../per_gene/EOG091G06CB/infer_single_ML.stderr.txt
	else
		echo "fasta file per_gene/EOG091G06CB/ALICUT_EOG091G06CB.clustalo.fasta contains fewer than 5 sequences - skipped" > ../../per_gene/EOG091G06CB/infer_single_ML.stdout.txt
		touch raxml.skipped
	fi
        touch ../../per_gene/EOG091G06CB/EOG091G06CB.raxml.done
        [0m
[Mon Jul  6 00:13:33 2020]
Finished job 1424.
2901 of 3292 steps (88%) done

[Mon Jul  6 00:13:33 2020]
rule score_and_cut:
    input: per_gene/EOG091G0D26/EOG091G0D26.clustalo.fasta
    output: per_gene/EOG091G0D26/ALICUT_EOG091G0D26.clustalo.fasta
    jobid: 601
    wildcards: BUSCO=EOG091G0D26
    threads: 2


        cd per_gene/EOG091G0D26
        Aliscore.pl -N -r 200000000000000000 -i ../../per_gene/EOG091G0D26/EOG091G0D26.clustalo.fasta &> aliscore.log
        ALICUT.pl -s &> alicut.log
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/63c88c27a0fa300f57066b0ef65fefcb.simg
[Mon Jul  6 00:13:34 2020]
Finished job 2738.
2902 of 3292 steps (88%) done

[Mon Jul  6 00:13:34 2020]
rule get_outgroups:
    input: per_gene/EOG091G0KGO/EOG091G0KGO.ingroup.fasta
    output: per_gene/EOG091G0KGO/EOG091G0KGO.orthodb.fasta, per_gene/EOG091G0KGO/EOG091G0KGO.outgroup.fasta
    log: per_gene/EOG091G0KGO/get_outgroups.stdout.txt, per_gene/EOG091G0KGO/get_outgroups.stderr.txt
    jobid: 2739
    wildcards: BUSCO=EOG091G0KGO


        #download fastas from Orhtodb for BUSCO id
        for i in {1..5}
        do
             wget "http://www.orthodb.org/fasta?query=EOG091G0KGO&level=33208" -O per_gene/EOG091G0KGO/EOG091G0KGO.orthodb.fasta 1> per_gene/EOG091G0KGO/get_outgroups.stdout.txt 2> per_gene/EOG091G0KGO/get_outgroups.stderr.txt && break || echo -e "try again ($i)" && sleep 15
        done

	#This is quick an dirty for now and just takes the first protein if there is more than one for an outgroup taxon
        bash ../scripts/download_outgroups.sh taxids.txt per_gene/EOG091G0KGO/EOG091G0KGO.orthodb.fasta > per_gene/EOG091G0KGO/EOG091G0KGO.outgroup.fasta
        
[Mon Jul  6 00:13:34 2020]
Finished job 2739.
2903 of 3292 steps (88%) done

[Mon Jul  6 00:13:34 2020]
rule join_groups:
    input: per_gene/EOG091G0KGO/EOG091G0KGO.ingroup.fasta, per_gene/EOG091G0KGO/EOG091G0KGO.outgroup.fasta
    output: per_gene/EOG091G0KGO/EOG091G0KGO.fasta
    jobid: 2193
    wildcards: BUSCO=EOG091G0KGO


        cat per_gene/EOG091G0KGO/EOG091G0KGO.ingroup.fasta per_gene/EOG091G0KGO/EOG091G0KGO.outgroup.fasta > per_gene/EOG091G0KGO/EOG091G0KGO.fasta
        
[Mon Jul  6 00:13:34 2020]
Finished job 2193.
2904 of 3292 steps (88%) done

[Mon Jul  6 00:13:34 2020]
rule MSA:
    input: per_gene/EOG091G0KGO/EOG091G0KGO.fasta
    output: per_gene/EOG091G0KGO/EOG091G0KGO.clustalo.fasta
    log: per_gene/EOG091G0KGO/MSA.stdout.txt, per_gene/EOG091G0KGO/MSA.stderr.txt
    jobid: 1506
    wildcards: BUSCO=EOG091G0KGO
    threads: 2


        clustalo -i per_gene/EOG091G0KGO/EOG091G0KGO.fasta -o per_gene/EOG091G0KGO/EOG091G0KGO.clustalo.fasta --threads=2 1> per_gene/EOG091G0KGO/MSA.stdout.txt 2> per_gene/EOG091G0KGO/MSA.stderr.txt
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/d68c9691725a7401923680874285c430.simg
[Mon Jul  6 00:13:35 2020]
Finished job 153.
2905 of 3292 steps (88%) done

[Mon Jul  6 00:13:35 2020]
rule get_seqs:
    input: /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ingroup.txt, /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/outgroup.txt
    output: per_gene/EOG091G046H/EOG091G046H.ingroup.fasta
    log: per_gene/EOG091G046H/get_seqs.stdout.txt, per_gene/EOG091G046H/get_seqs.stderr.txt
    jobid: 3130
    wildcards: BUSCO=EOG091G046H
    threads: 2


	basedir=$(pwd)
        cd per_gene/EOG091G046H
        
        bash $basedir/../scripts/fetch_seqs.sh EOG091G046H /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ingroup.txt /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/outgroup.txt 1> ../../per_gene/EOG091G046H/get_seqs.stdout.txt 2> ../../per_gene/EOG091G046H/get_seqs.stderr.txt
	mv EOG091G046H.fasta $basedir/per_gene/EOG091G046H/EOG091G046H.ingroup.fasta
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/72476f9d9a5bd0627b4d721143a21354.simg
[Mon Jul  6 00:13:35 2020]
Finished job 1506.
2906 of 3292 steps (88%) done

[Mon Jul  6 00:13:35 2020]
rule score_and_cut:
    input: per_gene/EOG091G0KGO/EOG091G0KGO.clustalo.fasta
    output: per_gene/EOG091G0KGO/ALICUT_EOG091G0KGO.clustalo.fasta
    jobid: 683
    wildcards: BUSCO=EOG091G0KGO
    threads: 2


        cd per_gene/EOG091G0KGO
        Aliscore.pl -N -r 200000000000000000 -i ../../per_gene/EOG091G0KGO/EOG091G0KGO.clustalo.fasta &> aliscore.log
        ALICUT.pl -s &> alicut.log
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/63c88c27a0fa300f57066b0ef65fefcb.simg
[Mon Jul  6 00:13:43 2020]
Finished job 452.
2907 of 3292 steps (88%) done

[Mon Jul  6 00:13:43 2020]
rule infer_single_ML:
    input: per_gene/EOG091G03I1/EOG091G03I1.best_model, per_gene/EOG091G03I1/ALICUT_EOG091G03I1.clustalo.fasta
    output: per_gene/EOG091G03I1/EOG091G03I1.raxml.done
    log: per_gene/EOG091G03I1/infer_single_ML.stdout.txt, per_gene/EOG091G03I1/infer_single_ML.stderr.txt
    jobid: 20
    wildcards: BUSCO=EOG091G03I1
    threads: 2


        cd per_gene/EOG091G03I1
	count=$(cat ../../per_gene/EOG091G03I1/ALICUT_EOG091G03I1.clustalo.fasta | grep ">" | wc -l)
	if [ "$count" -gt 5 ]
        then
		RAxMLmodel=$(cat ../../per_gene/EOG091G03I1/EOG091G03I1.best_model | grep "Best" | cut -d ":" -f 2 | tr -d '[:space:]')
                if [ "$(ls -1 | grep "^RAxML" | wc -l)" -ne 0 ]
		then
			rm RAxML*
		fi
        	raxml -f a -T 2 -m PROTGAMMA$RAxMLmodel         	-p 12345 -x 12345 -# 100         	-s ../../per_gene/EOG091G03I1/ALICUT_EOG091G03I1.clustalo.fasta -n EOG091G03I1.clustalo.aln.ALICUT.$RAxMLmodel 		1> ../../per_gene/EOG091G03I1/infer_single_ML.stdout.txt 2> ../../per_gene/EOG091G03I1/infer_single_ML.stderr.txt
	else
		echo "fasta file per_gene/EOG091G03I1/ALICUT_EOG091G03I1.clustalo.fasta contains fewer than 5 sequences - skipped" > ../../per_gene/EOG091G03I1/infer_single_ML.stdout.txt
		touch raxml.skipped
	fi
        touch ../../per_gene/EOG091G03I1/EOG091G03I1.raxml.done
        
[Mon Jul  6 00:13:43 2020]
Finished job 601.
2908 of 3292 steps (88%) done

[Mon Jul  6 00:13:43 2020]
rule remove_empty:
    input: per_gene/EOG091G0D26/ALICUT_EOG091G0D26.clustalo.fasta
    output: per_gene/EOG091G0D26/empty_check.done
    jobid: 1423
    wildcards: BUSCO=EOG091G0D26


         if [ "$(cat per_gene/EOG091G0D26/ALICUT_EOG091G0D26.clustalo.fasta | grep -v ">" | sed 's/-//g' | grep "^$" | wc -l)" -gt 0 ]
         then
              cp per_gene/EOG091G0D26/ALICUT_EOG091G0D26.clustalo.fasta per_gene/EOG091G0D26/ALICUT_EOG091G0D26.clustalo.fasta.backup
              bash ../scripts/remove_empty.sh per_gene/EOG091G0D26/ALICUT_EOG091G0D26.clustalo.fasta.backup > per_gene/EOG091G0D26/ALICUT_EOG091G0D26.clustalo.fasta
         fi
         touch per_gene/EOG091G0D26/empty_check.done
         
[Mon Jul  6 00:13:43 2020]
Finished job 1423.
2909 of 3292 steps (88%) done

[Mon Jul  6 00:13:43 2020]
rule find_best_model:
    input: per_gene/EOG091G0D26/ALICUT_EOG091G0D26.clustalo.fasta, per_gene/EOG091G0D26/empty_check.done
    output: per_gene/EOG091G0D26/EOG091G0D26.best_model
    log: per_gene/EOG091G0D26/find_best_model.stderr.txt
    jobid: 600
    wildcards: BUSCO=EOG091G0D26
    threads: 2


        cd per_gene/EOG091G0D26
        if [ ! -d find_best_model ]
        then
            mkdir find_best_model
        fi
        cd find_best_model
        ln -s ../../../per_gene/EOG091G0D26/ALICUT_EOG091G0D26.clustalo.fasta EOG091G0D26.fasta
        ProteinModelSelection.pl EOG091G0D26.fasta 1> ../../../per_gene/EOG091G0D26/EOG091G0D26.best_model 2> ../../../per_gene/EOG091G0D26/find_best_model.stderr.txt
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/c0c09ee657b1e27f2c5687e0e9aa8d70.simg
[Mon Jul  6 00:13:45 2020]
Finished job 683.
2910 of 3292 steps (88%) done

[Mon Jul  6 00:13:45 2020]
rule remove_empty:
    input: per_gene/EOG091G0KGO/ALICUT_EOG091G0KGO.clustalo.fasta
    output: per_gene/EOG091G0KGO/empty_check.done
    jobid: 1505
    wildcards: BUSCO=EOG091G0KGO


         if [ "$(cat per_gene/EOG091G0KGO/ALICUT_EOG091G0KGO.clustalo.fasta | grep -v ">" | sed 's/-//g' | grep "^$" | wc -l)" -gt 0 ]
         then
              cp per_gene/EOG091G0KGO/ALICUT_EOG091G0KGO.clustalo.fasta per_gene/EOG091G0KGO/ALICUT_EOG091G0KGO.clustalo.fasta.backup
              bash ../scripts/remove_empty.sh per_gene/EOG091G0KGO/ALICUT_EOG091G0KGO.clustalo.fasta.backup > per_gene/EOG091G0KGO/ALICUT_EOG091G0KGO.clustalo.fasta
         fi
         touch per_gene/EOG091G0KGO/empty_check.done
         
[Mon Jul  6 00:13:45 2020]
Finished job 1505.
2911 of 3292 steps (88%) done

[Mon Jul  6 00:13:45 2020]
rule find_best_model:
    input: per_gene/EOG091G0KGO/ALICUT_EOG091G0KGO.clustalo.fasta, per_gene/EOG091G0KGO/empty_check.done
    output: per_gene/EOG091G0KGO/EOG091G0KGO.best_model
    log: per_gene/EOG091G0KGO/find_best_model.stderr.txt
    jobid: 682
    wildcards: BUSCO=EOG091G0KGO
    threads: 2


        cd per_gene/EOG091G0KGO
        if [ ! -d find_best_model ]
        then
            mkdir find_best_model
        fi
        cd find_best_model
        ln -s ../../../per_gene/EOG091G0KGO/ALICUT_EOG091G0KGO.clustalo.fasta EOG091G0KGO.fasta
        ProteinModelSelection.pl EOG091G0KGO.fasta 1> ../../../per_gene/EOG091G0KGO/EOG091G0KGO.best_model 2> ../../../per_gene/EOG091G0KGO/find_best_model.stderr.txt
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/c0c09ee657b1e27f2c5687e0e9aa8d70.simg
[33mJob counts:
	count	jobs
	1	infer_single_ML
	1[0m
[33m
        cd per_gene/EOG091G03I1
	count=$(cat ../../per_gene/EOG091G03I1/ALICUT_EOG091G03I1.clustalo.fasta | grep ">" | wc -l)
	if [ "$count" -gt 5 ]
        then
		RAxMLmodel=$(cat ../../per_gene/EOG091G03I1/EOG091G03I1.best_model | grep "Best" | cut -d ":" -f 2 | tr -d '[:space:]')
                if [ "$(ls -1 | grep "^RAxML" | wc -l)" -ne 0 ]
		then
			rm RAxML*
		fi
        	raxml -f a -T 2 -m PROTGAMMA$RAxMLmodel         	-p 12345 -x 12345 -# 100         	-s ../../per_gene/EOG091G03I1/ALICUT_EOG091G03I1.clustalo.fasta -n EOG091G03I1.clustalo.aln.ALICUT.$RAxMLmodel 		1> ../../per_gene/EOG091G03I1/infer_single_ML.stdout.txt 2> ../../per_gene/EOG091G03I1/infer_single_ML.stderr.txt
	else
		echo "fasta file per_gene/EOG091G03I1/ALICUT_EOG091G03I1.clustalo.fasta contains fewer than 5 sequences - skipped" > ../../per_gene/EOG091G03I1/infer_single_ML.stdout.txt
		touch raxml.skipped
	fi
        touch ../../per_gene/EOG091G03I1/EOG091G03I1.raxml.done
        [0m
[Mon Jul  6 00:13:48 2020]
Finished job 3130.
2912 of 3292 steps (88%) done

[Mon Jul  6 00:13:48 2020]
rule get_outgroups:
    input: per_gene/EOG091G046H/EOG091G046H.ingroup.fasta
    output: per_gene/EOG091G046H/EOG091G046H.orthodb.fasta, per_gene/EOG091G046H/EOG091G046H.outgroup.fasta
    log: per_gene/EOG091G046H/get_outgroups.stdout.txt, per_gene/EOG091G046H/get_outgroups.stderr.txt
    jobid: 3131
    wildcards: BUSCO=EOG091G046H


        #download fastas from Orhtodb for BUSCO id
        for i in {1..5}
        do
             wget "http://www.orthodb.org/fasta?query=EOG091G046H&level=33208" -O per_gene/EOG091G046H/EOG091G046H.orthodb.fasta 1> per_gene/EOG091G046H/get_outgroups.stdout.txt 2> per_gene/EOG091G046H/get_outgroups.stderr.txt && break || echo -e "try again ($i)" && sleep 15
        done

	#This is quick an dirty for now and just takes the first protein if there is more than one for an outgroup taxon
        bash ../scripts/download_outgroups.sh taxids.txt per_gene/EOG091G046H/EOG091G046H.orthodb.fasta > per_gene/EOG091G046H/EOG091G046H.outgroup.fasta
        
[Mon Jul  6 00:13:49 2020]
Finished job 3131.
2913 of 3292 steps (88%) done

[Mon Jul  6 00:13:49 2020]
rule join_groups:
    input: per_gene/EOG091G046H/EOG091G046H.ingroup.fasta, per_gene/EOG091G046H/EOG091G046H.outgroup.fasta
    output: per_gene/EOG091G046H/EOG091G046H.fasta
    jobid: 2389
    wildcards: BUSCO=EOG091G046H


        cat per_gene/EOG091G046H/EOG091G046H.ingroup.fasta per_gene/EOG091G046H/EOG091G046H.outgroup.fasta > per_gene/EOG091G046H/EOG091G046H.fasta
        
[Mon Jul  6 00:13:49 2020]
Finished job 2389.
2914 of 3292 steps (89%) done

[Mon Jul  6 00:13:49 2020]
rule MSA:
    input: per_gene/EOG091G046H/EOG091G046H.fasta
    output: per_gene/EOG091G046H/EOG091G046H.clustalo.fasta
    log: per_gene/EOG091G046H/MSA.stdout.txt, per_gene/EOG091G046H/MSA.stderr.txt
    jobid: 1898
    wildcards: BUSCO=EOG091G046H
    threads: 2


        clustalo -i per_gene/EOG091G046H/EOG091G046H.fasta -o per_gene/EOG091G046H/EOG091G046H.clustalo.fasta --threads=2 1> per_gene/EOG091G046H/MSA.stdout.txt 2> per_gene/EOG091G046H/MSA.stderr.txt
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/d68c9691725a7401923680874285c430.simg
[Mon Jul  6 00:13:53 2020]
Finished job 1898.
2915 of 3292 steps (89%) done

[Mon Jul  6 00:13:53 2020]
rule score_and_cut:
    input: per_gene/EOG091G046H/EOG091G046H.clustalo.fasta
    output: per_gene/EOG091G046H/ALICUT_EOG091G046H.clustalo.fasta
    jobid: 1075
    wildcards: BUSCO=EOG091G046H
    threads: 2


        cd per_gene/EOG091G046H
        Aliscore.pl -N -r 200000000000000000 -i ../../per_gene/EOG091G046H/EOG091G046H.clustalo.fasta &> aliscore.log
        ALICUT.pl -s &> alicut.log
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/63c88c27a0fa300f57066b0ef65fefcb.simg
[Mon Jul  6 00:14:05 2020]
Finished job 1075.
2916 of 3292 steps (89%) done

[Mon Jul  6 00:14:05 2020]
rule remove_empty:
    input: per_gene/EOG091G046H/ALICUT_EOG091G046H.clustalo.fasta
    output: per_gene/EOG091G046H/empty_check.done
    jobid: 1897
    wildcards: BUSCO=EOG091G046H


         if [ "$(cat per_gene/EOG091G046H/ALICUT_EOG091G046H.clustalo.fasta | grep -v ">" | sed 's/-//g' | grep "^$" | wc -l)" -gt 0 ]
         then
              cp per_gene/EOG091G046H/ALICUT_EOG091G046H.clustalo.fasta per_gene/EOG091G046H/ALICUT_EOG091G046H.clustalo.fasta.backup
              bash ../scripts/remove_empty.sh per_gene/EOG091G046H/ALICUT_EOG091G046H.clustalo.fasta.backup > per_gene/EOG091G046H/ALICUT_EOG091G046H.clustalo.fasta
         fi
         touch per_gene/EOG091G046H/empty_check.done
         
[Mon Jul  6 00:14:05 2020]
Finished job 1897.
2917 of 3292 steps (89%) done

[Mon Jul  6 00:14:05 2020]
rule find_best_model:
    input: per_gene/EOG091G046H/ALICUT_EOG091G046H.clustalo.fasta, per_gene/EOG091G046H/empty_check.done
    output: per_gene/EOG091G046H/EOG091G046H.best_model
    log: per_gene/EOG091G046H/find_best_model.stderr.txt
    jobid: 1074
    wildcards: BUSCO=EOG091G046H
    threads: 2


        cd per_gene/EOG091G046H
        if [ ! -d find_best_model ]
        then
            mkdir find_best_model
        fi
        cd find_best_model
        ln -s ../../../per_gene/EOG091G046H/ALICUT_EOG091G046H.clustalo.fasta EOG091G046H.fasta
        ProteinModelSelection.pl EOG091G046H.fasta 1> ../../../per_gene/EOG091G046H/EOG091G046H.best_model 2> ../../../per_gene/EOG091G046H/find_best_model.stderr.txt
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/c0c09ee657b1e27f2c5687e0e9aa8d70.simg
[Mon Jul  6 00:14:13 2020]
Finished job 600.
2918 of 3292 steps (89%) done

[Mon Jul  6 00:14:13 2020]
rule infer_single_ML:
    input: per_gene/EOG091G0D26/EOG091G0D26.best_model, per_gene/EOG091G0D26/ALICUT_EOG091G0D26.clustalo.fasta
    output: per_gene/EOG091G0D26/EOG091G0D26.raxml.done
    log: per_gene/EOG091G0D26/infer_single_ML.stdout.txt, per_gene/EOG091G0D26/infer_single_ML.stderr.txt
    jobid: 94
    wildcards: BUSCO=EOG091G0D26
    threads: 2


        cd per_gene/EOG091G0D26
	count=$(cat ../../per_gene/EOG091G0D26/ALICUT_EOG091G0D26.clustalo.fasta | grep ">" | wc -l)
	if [ "$count" -gt 5 ]
        then
		RAxMLmodel=$(cat ../../per_gene/EOG091G0D26/EOG091G0D26.best_model | grep "Best" | cut -d ":" -f 2 | tr -d '[:space:]')
                if [ "$(ls -1 | grep "^RAxML" | wc -l)" -ne 0 ]
		then
			rm RAxML*
		fi
        	raxml -f a -T 2 -m PROTGAMMA$RAxMLmodel         	-p 12345 -x 12345 -# 100         	-s ../../per_gene/EOG091G0D26/ALICUT_EOG091G0D26.clustalo.fasta -n EOG091G0D26.clustalo.aln.ALICUT.$RAxMLmodel 		1> ../../per_gene/EOG091G0D26/infer_single_ML.stdout.txt 2> ../../per_gene/EOG091G0D26/infer_single_ML.stderr.txt
	else
		echo "fasta file per_gene/EOG091G0D26/ALICUT_EOG091G0D26.clustalo.fasta contains fewer than 5 sequences - skipped" > ../../per_gene/EOG091G0D26/infer_single_ML.stdout.txt
		touch raxml.skipped
	fi
        touch ../../per_gene/EOG091G0D26/EOG091G0D26.raxml.done
        
[33mJob counts:
	count	jobs
	1	infer_single_ML
	1[0m
[33m
        cd per_gene/EOG091G0D26
	count=$(cat ../../per_gene/EOG091G0D26/ALICUT_EOG091G0D26.clustalo.fasta | grep ">" | wc -l)
	if [ "$count" -gt 5 ]
        then
		RAxMLmodel=$(cat ../../per_gene/EOG091G0D26/EOG091G0D26.best_model | grep "Best" | cut -d ":" -f 2 | tr -d '[:space:]')
                if [ "$(ls -1 | grep "^RAxML" | wc -l)" -ne 0 ]
		then
			rm RAxML*
		fi
        	raxml -f a -T 2 -m PROTGAMMA$RAxMLmodel         	-p 12345 -x 12345 -# 100         	-s ../../per_gene/EOG091G0D26/ALICUT_EOG091G0D26.clustalo.fasta -n EOG091G0D26.clustalo.aln.ALICUT.$RAxMLmodel 		1> ../../per_gene/EOG091G0D26/infer_single_ML.stdout.txt 2> ../../per_gene/EOG091G0D26/infer_single_ML.stderr.txt
	else
		echo "fasta file per_gene/EOG091G0D26/ALICUT_EOG091G0D26.clustalo.fasta contains fewer than 5 sequences - skipped" > ../../per_gene/EOG091G0D26/infer_single_ML.stdout.txt
		touch raxml.skipped
	fi
        touch ../../per_gene/EOG091G0D26/EOG091G0D26.raxml.done
        [0m
[Mon Jul  6 00:14:15 2020]
Finished job 682.
2919 of 3292 steps (89%) done

[Mon Jul  6 00:14:15 2020]
rule infer_single_ML:
    input: per_gene/EOG091G0KGO/EOG091G0KGO.best_model, per_gene/EOG091G0KGO/ALICUT_EOG091G0KGO.clustalo.fasta
    output: per_gene/EOG091G0KGO/EOG091G0KGO.raxml.done
    log: per_gene/EOG091G0KGO/infer_single_ML.stdout.txt, per_gene/EOG091G0KGO/infer_single_ML.stderr.txt
    jobid: 135
    wildcards: BUSCO=EOG091G0KGO
    threads: 2


        cd per_gene/EOG091G0KGO
	count=$(cat ../../per_gene/EOG091G0KGO/ALICUT_EOG091G0KGO.clustalo.fasta | grep ">" | wc -l)
	if [ "$count" -gt 5 ]
        then
		RAxMLmodel=$(cat ../../per_gene/EOG091G0KGO/EOG091G0KGO.best_model | grep "Best" | cut -d ":" -f 2 | tr -d '[:space:]')
                if [ "$(ls -1 | grep "^RAxML" | wc -l)" -ne 0 ]
		then
			rm RAxML*
		fi
        	raxml -f a -T 2 -m PROTGAMMA$RAxMLmodel         	-p 12345 -x 12345 -# 100         	-s ../../per_gene/EOG091G0KGO/ALICUT_EOG091G0KGO.clustalo.fasta -n EOG091G0KGO.clustalo.aln.ALICUT.$RAxMLmodel 		1> ../../per_gene/EOG091G0KGO/infer_single_ML.stdout.txt 2> ../../per_gene/EOG091G0KGO/infer_single_ML.stderr.txt
	else
		echo "fasta file per_gene/EOG091G0KGO/ALICUT_EOG091G0KGO.clustalo.fasta contains fewer than 5 sequences - skipped" > ../../per_gene/EOG091G0KGO/infer_single_ML.stdout.txt
		touch raxml.skipped
	fi
        touch ../../per_gene/EOG091G0KGO/EOG091G0KGO.raxml.done
        
[33mJob counts:
	count	jobs
	1	infer_single_ML
	1[0m
[33m
        cd per_gene/EOG091G0KGO
	count=$(cat ../../per_gene/EOG091G0KGO/ALICUT_EOG091G0KGO.clustalo.fasta | grep ">" | wc -l)
	if [ "$count" -gt 5 ]
        then
		RAxMLmodel=$(cat ../../per_gene/EOG091G0KGO/EOG091G0KGO.best_model | grep "Best" | cut -d ":" -f 2 | tr -d '[:space:]')
                if [ "$(ls -1 | grep "^RAxML" | wc -l)" -ne 0 ]
		then
			rm RAxML*
		fi
        	raxml -f a -T 2 -m PROTGAMMA$RAxMLmodel         	-p 12345 -x 12345 -# 100         	-s ../../per_gene/EOG091G0KGO/ALICUT_EOG091G0KGO.clustalo.fasta -n EOG091G0KGO.clustalo.aln.ALICUT.$RAxMLmodel 		1> ../../per_gene/EOG091G0KGO/infer_single_ML.stdout.txt 2> ../../per_gene/EOG091G0KGO/infer_single_ML.stderr.txt
	else
		echo "fasta file per_gene/EOG091G0KGO/ALICUT_EOG091G0KGO.clustalo.fasta contains fewer than 5 sequences - skipped" > ../../per_gene/EOG091G0KGO/infer_single_ML.stdout.txt
		touch raxml.skipped
	fi
        touch ../../per_gene/EOG091G0KGO/EOG091G0KGO.raxml.done
        [0m
[Mon Jul  6 00:14:25 2020]
Finished job 328.
2920 of 3292 steps (89%) done

[Mon Jul  6 00:14:25 2020]
rule get_seqs:
    input: /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ingroup.txt, /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/outgroup.txt
    output: per_gene/EOG091G0K95/EOG091G0K95.ingroup.fasta
    log: per_gene/EOG091G0K95/get_seqs.stdout.txt, per_gene/EOG091G0K95/get_seqs.stderr.txt
    jobid: 2734
    wildcards: BUSCO=EOG091G0K95
    threads: 2


	basedir=$(pwd)
        cd per_gene/EOG091G0K95
        
        bash $basedir/../scripts/fetch_seqs.sh EOG091G0K95 /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ingroup.txt /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/outgroup.txt 1> ../../per_gene/EOG091G0K95/get_seqs.stdout.txt 2> ../../per_gene/EOG091G0K95/get_seqs.stderr.txt
	mv EOG091G0K95.fasta $basedir/per_gene/EOG091G0K95/EOG091G0K95.ingroup.fasta
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/72476f9d9a5bd0627b4d721143a21354.simg
[Mon Jul  6 00:14:39 2020]
Finished job 2734.
2921 of 3292 steps (89%) done

[Mon Jul  6 00:14:39 2020]
rule get_outgroups:
    input: per_gene/EOG091G0K95/EOG091G0K95.ingroup.fasta
    output: per_gene/EOG091G0K95/EOG091G0K95.orthodb.fasta, per_gene/EOG091G0K95/EOG091G0K95.outgroup.fasta
    log: per_gene/EOG091G0K95/get_outgroups.stdout.txt, per_gene/EOG091G0K95/get_outgroups.stderr.txt
    jobid: 2735
    wildcards: BUSCO=EOG091G0K95


        #download fastas from Orhtodb for BUSCO id
        for i in {1..5}
        do
             wget "http://www.orthodb.org/fasta?query=EOG091G0K95&level=33208" -O per_gene/EOG091G0K95/EOG091G0K95.orthodb.fasta 1> per_gene/EOG091G0K95/get_outgroups.stdout.txt 2> per_gene/EOG091G0K95/get_outgroups.stderr.txt && break || echo -e "try again ($i)" && sleep 15
        done

	#This is quick an dirty for now and just takes the first protein if there is more than one for an outgroup taxon
        bash ../scripts/download_outgroups.sh taxids.txt per_gene/EOG091G0K95/EOG091G0K95.orthodb.fasta > per_gene/EOG091G0K95/EOG091G0K95.outgroup.fasta
        
[Mon Jul  6 00:14:40 2020]
Finished job 2735.
2922 of 3292 steps (89%) done

[Mon Jul  6 00:14:40 2020]
rule join_groups:
    input: per_gene/EOG091G0K95/EOG091G0K95.ingroup.fasta, per_gene/EOG091G0K95/EOG091G0K95.outgroup.fasta
    output: per_gene/EOG091G0K95/EOG091G0K95.fasta
    jobid: 2191
    wildcards: BUSCO=EOG091G0K95


        cat per_gene/EOG091G0K95/EOG091G0K95.ingroup.fasta per_gene/EOG091G0K95/EOG091G0K95.outgroup.fasta > per_gene/EOG091G0K95/EOG091G0K95.fasta
        
[Mon Jul  6 00:14:40 2020]
Finished job 2191.
2923 of 3292 steps (89%) done

[Mon Jul  6 00:14:40 2020]
rule MSA:
    input: per_gene/EOG091G0K95/EOG091G0K95.fasta
    output: per_gene/EOG091G0K95/EOG091G0K95.clustalo.fasta
    log: per_gene/EOG091G0K95/MSA.stdout.txt, per_gene/EOG091G0K95/MSA.stderr.txt
    jobid: 1502
    wildcards: BUSCO=EOG091G0K95
    threads: 2


        clustalo -i per_gene/EOG091G0K95/EOG091G0K95.fasta -o per_gene/EOG091G0K95/EOG091G0K95.clustalo.fasta --threads=2 1> per_gene/EOG091G0K95/MSA.stdout.txt 2> per_gene/EOG091G0K95/MSA.stderr.txt
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/d68c9691725a7401923680874285c430.simg
[Mon Jul  6 00:14:45 2020]
Finished job 1502.
2924 of 3292 steps (89%) done

[Mon Jul  6 00:14:45 2020]
rule score_and_cut:
    input: per_gene/EOG091G0K95/EOG091G0K95.clustalo.fasta
    output: per_gene/EOG091G0K95/ALICUT_EOG091G0K95.clustalo.fasta
    jobid: 679
    wildcards: BUSCO=EOG091G0K95
    threads: 2


        cd per_gene/EOG091G0K95
        Aliscore.pl -N -r 200000000000000000 -i ../../per_gene/EOG091G0K95/EOG091G0K95.clustalo.fasta &> aliscore.log
        ALICUT.pl -s &> alicut.log
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/63c88c27a0fa300f57066b0ef65fefcb.simg
[Mon Jul  6 00:14:53 2020]
Finished job 1074.
2925 of 3292 steps (89%) done

[Mon Jul  6 00:14:53 2020]
rule infer_single_ML:
    input: per_gene/EOG091G046H/EOG091G046H.best_model, per_gene/EOG091G046H/ALICUT_EOG091G046H.clustalo.fasta
    output: per_gene/EOG091G046H/EOG091G046H.raxml.done
    log: per_gene/EOG091G046H/infer_single_ML.stdout.txt, per_gene/EOG091G046H/infer_single_ML.stderr.txt
    jobid: 331
    wildcards: BUSCO=EOG091G046H
    threads: 2


        cd per_gene/EOG091G046H
	count=$(cat ../../per_gene/EOG091G046H/ALICUT_EOG091G046H.clustalo.fasta | grep ">" | wc -l)
	if [ "$count" -gt 5 ]
        then
		RAxMLmodel=$(cat ../../per_gene/EOG091G046H/EOG091G046H.best_model | grep "Best" | cut -d ":" -f 2 | tr -d '[:space:]')
                if [ "$(ls -1 | grep "^RAxML" | wc -l)" -ne 0 ]
		then
			rm RAxML*
		fi
        	raxml -f a -T 2 -m PROTGAMMA$RAxMLmodel         	-p 12345 -x 12345 -# 100         	-s ../../per_gene/EOG091G046H/ALICUT_EOG091G046H.clustalo.fasta -n EOG091G046H.clustalo.aln.ALICUT.$RAxMLmodel 		1> ../../per_gene/EOG091G046H/infer_single_ML.stdout.txt 2> ../../per_gene/EOG091G046H/infer_single_ML.stderr.txt
	else
		echo "fasta file per_gene/EOG091G046H/ALICUT_EOG091G046H.clustalo.fasta contains fewer than 5 sequences - skipped" > ../../per_gene/EOG091G046H/infer_single_ML.stdout.txt
		touch raxml.skipped
	fi
        touch ../../per_gene/EOG091G046H/EOG091G046H.raxml.done
        
[33mJob counts:
	count	jobs
	1	infer_single_ML
	1[0m
[33m
        cd per_gene/EOG091G046H
	count=$(cat ../../per_gene/EOG091G046H/ALICUT_EOG091G046H.clustalo.fasta | grep ">" | wc -l)
	if [ "$count" -gt 5 ]
        then
		RAxMLmodel=$(cat ../../per_gene/EOG091G046H/EOG091G046H.best_model | grep "Best" | cut -d ":" -f 2 | tr -d '[:space:]')
                if [ "$(ls -1 | grep "^RAxML" | wc -l)" -ne 0 ]
		then
			rm RAxML*
		fi
        	raxml -f a -T 2 -m PROTGAMMA$RAxMLmodel         	-p 12345 -x 12345 -# 100         	-s ../../per_gene/EOG091G046H/ALICUT_EOG091G046H.clustalo.fasta -n EOG091G046H.clustalo.aln.ALICUT.$RAxMLmodel 		1> ../../per_gene/EOG091G046H/infer_single_ML.stdout.txt 2> ../../per_gene/EOG091G046H/infer_single_ML.stderr.txt
	else
		echo "fasta file per_gene/EOG091G046H/ALICUT_EOG091G046H.clustalo.fasta contains fewer than 5 sequences - skipped" > ../../per_gene/EOG091G046H/infer_single_ML.stdout.txt
		touch raxml.skipped
	fi
        touch ../../per_gene/EOG091G046H/EOG091G046H.raxml.done
        [0m
[Mon Jul  6 00:14:58 2020]
Finished job 679.
2926 of 3292 steps (89%) done

[Mon Jul  6 00:14:58 2020]
rule remove_empty:
    input: per_gene/EOG091G0K95/ALICUT_EOG091G0K95.clustalo.fasta
    output: per_gene/EOG091G0K95/empty_check.done
    jobid: 1501
    wildcards: BUSCO=EOG091G0K95


         if [ "$(cat per_gene/EOG091G0K95/ALICUT_EOG091G0K95.clustalo.fasta | grep -v ">" | sed 's/-//g' | grep "^$" | wc -l)" -gt 0 ]
         then
              cp per_gene/EOG091G0K95/ALICUT_EOG091G0K95.clustalo.fasta per_gene/EOG091G0K95/ALICUT_EOG091G0K95.clustalo.fasta.backup
              bash ../scripts/remove_empty.sh per_gene/EOG091G0K95/ALICUT_EOG091G0K95.clustalo.fasta.backup > per_gene/EOG091G0K95/ALICUT_EOG091G0K95.clustalo.fasta
         fi
         touch per_gene/EOG091G0K95/empty_check.done
         
[Mon Jul  6 00:14:58 2020]
Finished job 1501.
2927 of 3292 steps (89%) done

[Mon Jul  6 00:14:58 2020]
rule find_best_model:
    input: per_gene/EOG091G0K95/ALICUT_EOG091G0K95.clustalo.fasta, per_gene/EOG091G0K95/empty_check.done
    output: per_gene/EOG091G0K95/EOG091G0K95.best_model
    log: per_gene/EOG091G0K95/find_best_model.stderr.txt
    jobid: 678
    wildcards: BUSCO=EOG091G0K95
    threads: 2


        cd per_gene/EOG091G0K95
        if [ ! -d find_best_model ]
        then
            mkdir find_best_model
        fi
        cd find_best_model
        ln -s ../../../per_gene/EOG091G0K95/ALICUT_EOG091G0K95.clustalo.fasta EOG091G0K95.fasta
        ProteinModelSelection.pl EOG091G0K95.fasta 1> ../../../per_gene/EOG091G0K95/EOG091G0K95.best_model 2> ../../../per_gene/EOG091G0K95/find_best_model.stderr.txt
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/c0c09ee657b1e27f2c5687e0e9aa8d70.simg
[Mon Jul  6 00:15:25 2020]
Finished job 88.
2928 of 3292 steps (89%) done

[Mon Jul  6 00:15:25 2020]
rule get_seqs:
    input: /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ingroup.txt, /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/outgroup.txt
    output: per_gene/EOG091G0YU6/EOG091G0YU6.ingroup.fasta
    log: per_gene/EOG091G0YU6/get_seqs.stdout.txt, per_gene/EOG091G0YU6/get_seqs.stderr.txt
    jobid: 2898
    wildcards: BUSCO=EOG091G0YU6
    threads: 2


	basedir=$(pwd)
        cd per_gene/EOG091G0YU6
        
        bash $basedir/../scripts/fetch_seqs.sh EOG091G0YU6 /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ingroup.txt /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/outgroup.txt 1> ../../per_gene/EOG091G0YU6/get_seqs.stdout.txt 2> ../../per_gene/EOG091G0YU6/get_seqs.stderr.txt
	mv EOG091G0YU6.fasta $basedir/per_gene/EOG091G0YU6/EOG091G0YU6.ingroup.fasta
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/72476f9d9a5bd0627b4d721143a21354.simg
[Mon Jul  6 00:15:39 2020]
Finished job 678.
2929 of 3292 steps (89%) done

[Mon Jul  6 00:15:39 2020]
rule infer_single_ML:
    input: per_gene/EOG091G0K95/EOG091G0K95.best_model, per_gene/EOG091G0K95/ALICUT_EOG091G0K95.clustalo.fasta
    output: per_gene/EOG091G0K95/EOG091G0K95.raxml.done
    log: per_gene/EOG091G0K95/infer_single_ML.stdout.txt, per_gene/EOG091G0K95/infer_single_ML.stderr.txt
    jobid: 133
    wildcards: BUSCO=EOG091G0K95
    threads: 2


        cd per_gene/EOG091G0K95
	count=$(cat ../../per_gene/EOG091G0K95/ALICUT_EOG091G0K95.clustalo.fasta | grep ">" | wc -l)
	if [ "$count" -gt 5 ]
        then
		RAxMLmodel=$(cat ../../per_gene/EOG091G0K95/EOG091G0K95.best_model | grep "Best" | cut -d ":" -f 2 | tr -d '[:space:]')
                if [ "$(ls -1 | grep "^RAxML" | wc -l)" -ne 0 ]
		then
			rm RAxML*
		fi
        	raxml -f a -T 2 -m PROTGAMMA$RAxMLmodel         	-p 12345 -x 12345 -# 100         	-s ../../per_gene/EOG091G0K95/ALICUT_EOG091G0K95.clustalo.fasta -n EOG091G0K95.clustalo.aln.ALICUT.$RAxMLmodel 		1> ../../per_gene/EOG091G0K95/infer_single_ML.stdout.txt 2> ../../per_gene/EOG091G0K95/infer_single_ML.stderr.txt
	else
		echo "fasta file per_gene/EOG091G0K95/ALICUT_EOG091G0K95.clustalo.fasta contains fewer than 5 sequences - skipped" > ../../per_gene/EOG091G0K95/infer_single_ML.stdout.txt
		touch raxml.skipped
	fi
        touch ../../per_gene/EOG091G0K95/EOG091G0K95.raxml.done
        
[Mon Jul  6 00:15:40 2020]
Finished job 2898.
2930 of 3292 steps (89%) done

[Mon Jul  6 00:15:40 2020]
rule get_outgroups:
    input: per_gene/EOG091G0YU6/EOG091G0YU6.ingroup.fasta
    output: per_gene/EOG091G0YU6/EOG091G0YU6.orthodb.fasta, per_gene/EOG091G0YU6/EOG091G0YU6.outgroup.fasta
    log: per_gene/EOG091G0YU6/get_outgroups.stdout.txt, per_gene/EOG091G0YU6/get_outgroups.stderr.txt
    jobid: 2899
    wildcards: BUSCO=EOG091G0YU6


        #download fastas from Orhtodb for BUSCO id
        for i in {1..5}
        do
             wget "http://www.orthodb.org/fasta?query=EOG091G0YU6&level=33208" -O per_gene/EOG091G0YU6/EOG091G0YU6.orthodb.fasta 1> per_gene/EOG091G0YU6/get_outgroups.stdout.txt 2> per_gene/EOG091G0YU6/get_outgroups.stderr.txt && break || echo -e "try again ($i)" && sleep 15
        done

	#This is quick an dirty for now and just takes the first protein if there is more than one for an outgroup taxon
        bash ../scripts/download_outgroups.sh taxids.txt per_gene/EOG091G0YU6/EOG091G0YU6.orthodb.fasta > per_gene/EOG091G0YU6/EOG091G0YU6.outgroup.fasta
        
[Mon Jul  6 00:15:41 2020]
Finished job 2899.
2931 of 3292 steps (89%) done

[Mon Jul  6 00:15:41 2020]
rule join_groups:
    input: per_gene/EOG091G0YU6/EOG091G0YU6.ingroup.fasta, per_gene/EOG091G0YU6/EOG091G0YU6.outgroup.fasta
    output: per_gene/EOG091G0YU6/EOG091G0YU6.fasta
    jobid: 2273
    wildcards: BUSCO=EOG091G0YU6


        cat per_gene/EOG091G0YU6/EOG091G0YU6.ingroup.fasta per_gene/EOG091G0YU6/EOG091G0YU6.outgroup.fasta > per_gene/EOG091G0YU6/EOG091G0YU6.fasta
        
[33mJob counts:
	count	jobs
	1	infer_single_ML
	1[0m
[33m
        cd per_gene/EOG091G0K95
	count=$(cat ../../per_gene/EOG091G0K95/ALICUT_EOG091G0K95.clustalo.fasta | grep ">" | wc -l)
	if [ "$count" -gt 5 ]
        then
		RAxMLmodel=$(cat ../../per_gene/EOG091G0K95/EOG091G0K95.best_model | grep "Best" | cut -d ":" -f 2 | tr -d '[:space:]')
                if [ "$(ls -1 | grep "^RAxML" | wc -l)" -ne 0 ]
		then
			rm RAxML*
		fi
        	raxml -f a -T 2 -m PROTGAMMA$RAxMLmodel         	-p 12345 -x 12345 -# 100         	-s ../../per_gene/EOG091G0K95/ALICUT_EOG091G0K95.clustalo.fasta -n EOG091G0K95.clustalo.aln.ALICUT.$RAxMLmodel 		1> ../../per_gene/EOG091G0K95/infer_single_ML.stdout.txt 2> ../../per_gene/EOG091G0K95/infer_single_ML.stderr.txt
	else
		echo "fasta file per_gene/EOG091G0K95/ALICUT_EOG091G0K95.clustalo.fasta contains fewer than 5 sequences - skipped" > ../../per_gene/EOG091G0K95/infer_single_ML.stdout.txt
		touch raxml.skipped
	fi
        touch ../../per_gene/EOG091G0K95/EOG091G0K95.raxml.done
        [0m
[Mon Jul  6 00:15:41 2020]
Finished job 2273.
2932 of 3292 steps (89%) done

[Mon Jul  6 00:15:41 2020]
rule MSA:
    input: per_gene/EOG091G0YU6/EOG091G0YU6.fasta
    output: per_gene/EOG091G0YU6/EOG091G0YU6.clustalo.fasta
    log: per_gene/EOG091G0YU6/MSA.stdout.txt, per_gene/EOG091G0YU6/MSA.stderr.txt
    jobid: 1666
    wildcards: BUSCO=EOG091G0YU6
    threads: 2


        clustalo -i per_gene/EOG091G0YU6/EOG091G0YU6.fasta -o per_gene/EOG091G0YU6/EOG091G0YU6.clustalo.fasta --threads=2 1> per_gene/EOG091G0YU6/MSA.stdout.txt 2> per_gene/EOG091G0YU6/MSA.stderr.txt
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/d68c9691725a7401923680874285c430.simg
[Mon Jul  6 00:15:42 2020]
Finished job 1666.
2933 of 3292 steps (89%) done

[Mon Jul  6 00:15:42 2020]
rule score_and_cut:
    input: per_gene/EOG091G0YU6/EOG091G0YU6.clustalo.fasta
    output: per_gene/EOG091G0YU6/ALICUT_EOG091G0YU6.clustalo.fasta
    jobid: 843
    wildcards: BUSCO=EOG091G0YU6
    threads: 2


        cd per_gene/EOG091G0YU6
        Aliscore.pl -N -r 200000000000000000 -i ../../per_gene/EOG091G0YU6/EOG091G0YU6.clustalo.fasta &> aliscore.log
        ALICUT.pl -s &> alicut.log
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/63c88c27a0fa300f57066b0ef65fefcb.simg
[Mon Jul  6 00:15:52 2020]
Finished job 843.
2934 of 3292 steps (89%) done

[Mon Jul  6 00:15:52 2020]
rule remove_empty:
    input: per_gene/EOG091G0YU6/ALICUT_EOG091G0YU6.clustalo.fasta
    output: per_gene/EOG091G0YU6/empty_check.done
    jobid: 1665
    wildcards: BUSCO=EOG091G0YU6


         if [ "$(cat per_gene/EOG091G0YU6/ALICUT_EOG091G0YU6.clustalo.fasta | grep -v ">" | sed 's/-//g' | grep "^$" | wc -l)" -gt 0 ]
         then
              cp per_gene/EOG091G0YU6/ALICUT_EOG091G0YU6.clustalo.fasta per_gene/EOG091G0YU6/ALICUT_EOG091G0YU6.clustalo.fasta.backup
              bash ../scripts/remove_empty.sh per_gene/EOG091G0YU6/ALICUT_EOG091G0YU6.clustalo.fasta.backup > per_gene/EOG091G0YU6/ALICUT_EOG091G0YU6.clustalo.fasta
         fi
         touch per_gene/EOG091G0YU6/empty_check.done
         
[Mon Jul  6 00:15:52 2020]
Finished job 1665.
2935 of 3292 steps (89%) done

[Mon Jul  6 00:15:52 2020]
rule find_best_model:
    input: per_gene/EOG091G0YU6/ALICUT_EOG091G0YU6.clustalo.fasta, per_gene/EOG091G0YU6/empty_check.done
    output: per_gene/EOG091G0YU6/EOG091G0YU6.best_model
    log: per_gene/EOG091G0YU6/find_best_model.stderr.txt
    jobid: 842
    wildcards: BUSCO=EOG091G0YU6
    threads: 2


        cd per_gene/EOG091G0YU6
        if [ ! -d find_best_model ]
        then
            mkdir find_best_model
        fi
        cd find_best_model
        ln -s ../../../per_gene/EOG091G0YU6/ALICUT_EOG091G0YU6.clustalo.fasta EOG091G0YU6.fasta
        ProteinModelSelection.pl EOG091G0YU6.fasta 1> ../../../per_gene/EOG091G0YU6/EOG091G0YU6.best_model 2> ../../../per_gene/EOG091G0YU6/find_best_model.stderr.txt
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/c0c09ee657b1e27f2c5687e0e9aa8d70.simg
[Mon Jul  6 00:16:15 2020]
Finished job 842.
2936 of 3292 steps (89%) done

[Mon Jul  6 00:16:15 2020]
rule infer_single_ML:
    input: per_gene/EOG091G0YU6/EOG091G0YU6.best_model, per_gene/EOG091G0YU6/ALICUT_EOG091G0YU6.clustalo.fasta
    output: per_gene/EOG091G0YU6/EOG091G0YU6.raxml.done
    log: per_gene/EOG091G0YU6/infer_single_ML.stdout.txt, per_gene/EOG091G0YU6/infer_single_ML.stderr.txt
    jobid: 215
    wildcards: BUSCO=EOG091G0YU6
    threads: 2


        cd per_gene/EOG091G0YU6
	count=$(cat ../../per_gene/EOG091G0YU6/ALICUT_EOG091G0YU6.clustalo.fasta | grep ">" | wc -l)
	if [ "$count" -gt 5 ]
        then
		RAxMLmodel=$(cat ../../per_gene/EOG091G0YU6/EOG091G0YU6.best_model | grep "Best" | cut -d ":" -f 2 | tr -d '[:space:]')
                if [ "$(ls -1 | grep "^RAxML" | wc -l)" -ne 0 ]
		then
			rm RAxML*
		fi
        	raxml -f a -T 2 -m PROTGAMMA$RAxMLmodel         	-p 12345 -x 12345 -# 100         	-s ../../per_gene/EOG091G0YU6/ALICUT_EOG091G0YU6.clustalo.fasta -n EOG091G0YU6.clustalo.aln.ALICUT.$RAxMLmodel 		1> ../../per_gene/EOG091G0YU6/infer_single_ML.stdout.txt 2> ../../per_gene/EOG091G0YU6/infer_single_ML.stderr.txt
	else
		echo "fasta file per_gene/EOG091G0YU6/ALICUT_EOG091G0YU6.clustalo.fasta contains fewer than 5 sequences - skipped" > ../../per_gene/EOG091G0YU6/infer_single_ML.stdout.txt
		touch raxml.skipped
	fi
        touch ../../per_gene/EOG091G0YU6/EOG091G0YU6.raxml.done
        
[33mJob counts:
	count	jobs
	1	infer_single_ML
	1[0m
[33m
        cd per_gene/EOG091G0YU6
	count=$(cat ../../per_gene/EOG091G0YU6/ALICUT_EOG091G0YU6.clustalo.fasta | grep ">" | wc -l)
	if [ "$count" -gt 5 ]
        then
		RAxMLmodel=$(cat ../../per_gene/EOG091G0YU6/EOG091G0YU6.best_model | grep "Best" | cut -d ":" -f 2 | tr -d '[:space:]')
                if [ "$(ls -1 | grep "^RAxML" | wc -l)" -ne 0 ]
		then
			rm RAxML*
		fi
        	raxml -f a -T 2 -m PROTGAMMA$RAxMLmodel         	-p 12345 -x 12345 -# 100         	-s ../../per_gene/EOG091G0YU6/ALICUT_EOG091G0YU6.clustalo.fasta -n EOG091G0YU6.clustalo.aln.ALICUT.$RAxMLmodel 		1> ../../per_gene/EOG091G0YU6/infer_single_ML.stdout.txt 2> ../../per_gene/EOG091G0YU6/infer_single_ML.stderr.txt
	else
		echo "fasta file per_gene/EOG091G0YU6/ALICUT_EOG091G0YU6.clustalo.fasta contains fewer than 5 sequences - skipped" > ../../per_gene/EOG091G0YU6/infer_single_ML.stdout.txt
		touch raxml.skipped
	fi
        touch ../../per_gene/EOG091G0YU6/EOG091G0YU6.raxml.done
        [0m
[Mon Jul  6 00:16:38 2020]
Finished job 28.
2937 of 3292 steps (89%) done

[Mon Jul  6 00:16:38 2020]
rule get_seqs:
    input: /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ingroup.txt, /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/outgroup.txt
    output: per_gene/EOG091G0RRE/EOG091G0RRE.ingroup.fasta
    log: per_gene/EOG091G0RRE/get_seqs.stdout.txt, per_gene/EOG091G0RRE/get_seqs.stderr.txt
    jobid: 2838
    wildcards: BUSCO=EOG091G0RRE
    threads: 2


	basedir=$(pwd)
        cd per_gene/EOG091G0RRE
        
        bash $basedir/../scripts/fetch_seqs.sh EOG091G0RRE /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ingroup.txt /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/outgroup.txt 1> ../../per_gene/EOG091G0RRE/get_seqs.stdout.txt 2> ../../per_gene/EOG091G0RRE/get_seqs.stderr.txt
	mv EOG091G0RRE.fasta $basedir/per_gene/EOG091G0RRE/EOG091G0RRE.ingroup.fasta
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/72476f9d9a5bd0627b4d721143a21354.simg
[Mon Jul  6 00:16:51 2020]
Finished job 2838.
2938 of 3292 steps (89%) done

[Mon Jul  6 00:16:51 2020]
rule get_outgroups:
    input: per_gene/EOG091G0RRE/EOG091G0RRE.ingroup.fasta
    output: per_gene/EOG091G0RRE/EOG091G0RRE.orthodb.fasta, per_gene/EOG091G0RRE/EOG091G0RRE.outgroup.fasta
    log: per_gene/EOG091G0RRE/get_outgroups.stdout.txt, per_gene/EOG091G0RRE/get_outgroups.stderr.txt
    jobid: 2839
    wildcards: BUSCO=EOG091G0RRE


        #download fastas from Orhtodb for BUSCO id
        for i in {1..5}
        do
             wget "http://www.orthodb.org/fasta?query=EOG091G0RRE&level=33208" -O per_gene/EOG091G0RRE/EOG091G0RRE.orthodb.fasta 1> per_gene/EOG091G0RRE/get_outgroups.stdout.txt 2> per_gene/EOG091G0RRE/get_outgroups.stderr.txt && break || echo -e "try again ($i)" && sleep 15
        done

	#This is quick an dirty for now and just takes the first protein if there is more than one for an outgroup taxon
        bash ../scripts/download_outgroups.sh taxids.txt per_gene/EOG091G0RRE/EOG091G0RRE.orthodb.fasta > per_gene/EOG091G0RRE/EOG091G0RRE.outgroup.fasta
        
[Mon Jul  6 00:16:53 2020]
Finished job 2839.
2939 of 3292 steps (89%) done

[Mon Jul  6 00:16:53 2020]
rule join_groups:
    input: per_gene/EOG091G0RRE/EOG091G0RRE.ingroup.fasta, per_gene/EOG091G0RRE/EOG091G0RRE.outgroup.fasta
    output: per_gene/EOG091G0RRE/EOG091G0RRE.fasta
    jobid: 2243
    wildcards: BUSCO=EOG091G0RRE


        cat per_gene/EOG091G0RRE/EOG091G0RRE.ingroup.fasta per_gene/EOG091G0RRE/EOG091G0RRE.outgroup.fasta > per_gene/EOG091G0RRE/EOG091G0RRE.fasta
        
[Mon Jul  6 00:16:53 2020]
Finished job 2243.
2940 of 3292 steps (89%) done

[Mon Jul  6 00:16:53 2020]
rule MSA:
    input: per_gene/EOG091G0RRE/EOG091G0RRE.fasta
    output: per_gene/EOG091G0RRE/EOG091G0RRE.clustalo.fasta
    log: per_gene/EOG091G0RRE/MSA.stdout.txt, per_gene/EOG091G0RRE/MSA.stderr.txt
    jobid: 1606
    wildcards: BUSCO=EOG091G0RRE
    threads: 2


        clustalo -i per_gene/EOG091G0RRE/EOG091G0RRE.fasta -o per_gene/EOG091G0RRE/EOG091G0RRE.clustalo.fasta --threads=2 1> per_gene/EOG091G0RRE/MSA.stdout.txt 2> per_gene/EOG091G0RRE/MSA.stderr.txt
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/d68c9691725a7401923680874285c430.simg
[Mon Jul  6 00:16:54 2020]
Finished job 1606.
2941 of 3292 steps (89%) done

[Mon Jul  6 00:16:54 2020]
rule score_and_cut:
    input: per_gene/EOG091G0RRE/EOG091G0RRE.clustalo.fasta
    output: per_gene/EOG091G0RRE/ALICUT_EOG091G0RRE.clustalo.fasta
    jobid: 783
    wildcards: BUSCO=EOG091G0RRE
    threads: 2


        cd per_gene/EOG091G0RRE
        Aliscore.pl -N -r 200000000000000000 -i ../../per_gene/EOG091G0RRE/EOG091G0RRE.clustalo.fasta &> aliscore.log
        ALICUT.pl -s &> alicut.log
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/63c88c27a0fa300f57066b0ef65fefcb.simg
[Mon Jul  6 00:17:05 2020]
Finished job 783.
2942 of 3292 steps (89%) done

[Mon Jul  6 00:17:05 2020]
rule remove_empty:
    input: per_gene/EOG091G0RRE/ALICUT_EOG091G0RRE.clustalo.fasta
    output: per_gene/EOG091G0RRE/empty_check.done
    jobid: 1605
    wildcards: BUSCO=EOG091G0RRE


         if [ "$(cat per_gene/EOG091G0RRE/ALICUT_EOG091G0RRE.clustalo.fasta | grep -v ">" | sed 's/-//g' | grep "^$" | wc -l)" -gt 0 ]
         then
              cp per_gene/EOG091G0RRE/ALICUT_EOG091G0RRE.clustalo.fasta per_gene/EOG091G0RRE/ALICUT_EOG091G0RRE.clustalo.fasta.backup
              bash ../scripts/remove_empty.sh per_gene/EOG091G0RRE/ALICUT_EOG091G0RRE.clustalo.fasta.backup > per_gene/EOG091G0RRE/ALICUT_EOG091G0RRE.clustalo.fasta
         fi
         touch per_gene/EOG091G0RRE/empty_check.done
         
[Mon Jul  6 00:17:05 2020]
Finished job 1605.
2943 of 3292 steps (89%) done

[Mon Jul  6 00:17:05 2020]
rule find_best_model:
    input: per_gene/EOG091G0RRE/ALICUT_EOG091G0RRE.clustalo.fasta, per_gene/EOG091G0RRE/empty_check.done
    output: per_gene/EOG091G0RRE/EOG091G0RRE.best_model
    log: per_gene/EOG091G0RRE/find_best_model.stderr.txt
    jobid: 782
    wildcards: BUSCO=EOG091G0RRE
    threads: 2


        cd per_gene/EOG091G0RRE
        if [ ! -d find_best_model ]
        then
            mkdir find_best_model
        fi
        cd find_best_model
        ln -s ../../../per_gene/EOG091G0RRE/ALICUT_EOG091G0RRE.clustalo.fasta EOG091G0RRE.fasta
        ProteinModelSelection.pl EOG091G0RRE.fasta 1> ../../../per_gene/EOG091G0RRE/EOG091G0RRE.best_model 2> ../../../per_gene/EOG091G0RRE/find_best_model.stderr.txt
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/c0c09ee657b1e27f2c5687e0e9aa8d70.simg
[Mon Jul  6 00:17:22 2020]
Finished job 39.
2944 of 3292 steps (89%) done

[Mon Jul  6 00:17:22 2020]
rule get_seqs:
    input: /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ingroup.txt, /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/outgroup.txt
    output: per_gene/EOG091G0VTN/EOG091G0VTN.ingroup.fasta
    log: per_gene/EOG091G0VTN/get_seqs.stdout.txt, per_gene/EOG091G0VTN/get_seqs.stderr.txt
    jobid: 2882
    wildcards: BUSCO=EOG091G0VTN
    threads: 2


	basedir=$(pwd)
        cd per_gene/EOG091G0VTN
        
        bash $basedir/../scripts/fetch_seqs.sh EOG091G0VTN /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ingroup.txt /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/outgroup.txt 1> ../../per_gene/EOG091G0VTN/get_seqs.stdout.txt 2> ../../per_gene/EOG091G0VTN/get_seqs.stderr.txt
	mv EOG091G0VTN.fasta $basedir/per_gene/EOG091G0VTN/EOG091G0VTN.ingroup.fasta
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/72476f9d9a5bd0627b4d721143a21354.simg
[Mon Jul  6 00:17:23 2020]
Finished job 129.
2945 of 3292 steps (89%) done

[Mon Jul  6 00:17:23 2020]
rule get_seqs:
    input: /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ingroup.txt, /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/outgroup.txt
    output: per_gene/EOG091G0QEQ/EOG091G0QEQ.ingroup.fasta
    log: per_gene/EOG091G0QEQ/get_seqs.stdout.txt, per_gene/EOG091G0QEQ/get_seqs.stderr.txt
    jobid: 3010
    wildcards: BUSCO=EOG091G0QEQ
    threads: 2


	basedir=$(pwd)
        cd per_gene/EOG091G0QEQ
        
        bash $basedir/../scripts/fetch_seqs.sh EOG091G0QEQ /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ingroup.txt /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/outgroup.txt 1> ../../per_gene/EOG091G0QEQ/get_seqs.stdout.txt 2> ../../per_gene/EOG091G0QEQ/get_seqs.stderr.txt
	mv EOG091G0QEQ.fasta $basedir/per_gene/EOG091G0QEQ/EOG091G0QEQ.ingroup.fasta
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/72476f9d9a5bd0627b4d721143a21354.simg
[Mon Jul  6 00:17:30 2020]
Finished job 782.
2946 of 3292 steps (89%) done

[Mon Jul  6 00:17:30 2020]
rule infer_single_ML:
    input: per_gene/EOG091G0RRE/EOG091G0RRE.best_model, per_gene/EOG091G0RRE/ALICUT_EOG091G0RRE.clustalo.fasta
    output: per_gene/EOG091G0RRE/EOG091G0RRE.raxml.done
    log: per_gene/EOG091G0RRE/infer_single_ML.stdout.txt, per_gene/EOG091G0RRE/infer_single_ML.stderr.txt
    jobid: 185
    wildcards: BUSCO=EOG091G0RRE
    threads: 2


        cd per_gene/EOG091G0RRE
	count=$(cat ../../per_gene/EOG091G0RRE/ALICUT_EOG091G0RRE.clustalo.fasta | grep ">" | wc -l)
	if [ "$count" -gt 5 ]
        then
		RAxMLmodel=$(cat ../../per_gene/EOG091G0RRE/EOG091G0RRE.best_model | grep "Best" | cut -d ":" -f 2 | tr -d '[:space:]')
                if [ "$(ls -1 | grep "^RAxML" | wc -l)" -ne 0 ]
		then
			rm RAxML*
		fi
        	raxml -f a -T 2 -m PROTGAMMA$RAxMLmodel         	-p 12345 -x 12345 -# 100         	-s ../../per_gene/EOG091G0RRE/ALICUT_EOG091G0RRE.clustalo.fasta -n EOG091G0RRE.clustalo.aln.ALICUT.$RAxMLmodel 		1> ../../per_gene/EOG091G0RRE/infer_single_ML.stdout.txt 2> ../../per_gene/EOG091G0RRE/infer_single_ML.stderr.txt
	else
		echo "fasta file per_gene/EOG091G0RRE/ALICUT_EOG091G0RRE.clustalo.fasta contains fewer than 5 sequences - skipped" > ../../per_gene/EOG091G0RRE/infer_single_ML.stdout.txt
		touch raxml.skipped
	fi
        touch ../../per_gene/EOG091G0RRE/EOG091G0RRE.raxml.done
        
[33mJob counts:
	count	jobs
	1	infer_single_ML
	1[0m
[33m
        cd per_gene/EOG091G0RRE
	count=$(cat ../../per_gene/EOG091G0RRE/ALICUT_EOG091G0RRE.clustalo.fasta | grep ">" | wc -l)
	if [ "$count" -gt 5 ]
        then
		RAxMLmodel=$(cat ../../per_gene/EOG091G0RRE/EOG091G0RRE.best_model | grep "Best" | cut -d ":" -f 2 | tr -d '[:space:]')
                if [ "$(ls -1 | grep "^RAxML" | wc -l)" -ne 0 ]
		then
			rm RAxML*
		fi
        	raxml -f a -T 2 -m PROTGAMMA$RAxMLmodel         	-p 12345 -x 12345 -# 100         	-s ../../per_gene/EOG091G0RRE/ALICUT_EOG091G0RRE.clustalo.fasta -n EOG091G0RRE.clustalo.aln.ALICUT.$RAxMLmodel 		1> ../../per_gene/EOG091G0RRE/infer_single_ML.stdout.txt 2> ../../per_gene/EOG091G0RRE/infer_single_ML.stderr.txt
	else
		echo "fasta file per_gene/EOG091G0RRE/ALICUT_EOG091G0RRE.clustalo.fasta contains fewer than 5 sequences - skipped" > ../../per_gene/EOG091G0RRE/infer_single_ML.stdout.txt
		touch raxml.skipped
	fi
        touch ../../per_gene/EOG091G0RRE/EOG091G0RRE.raxml.done
        [0m
[Mon Jul  6 00:17:38 2020]
Finished job 3010.
2947 of 3292 steps (90%) done
[Mon Jul  6 00:17:38 2020]
Finished job 2882.
2948 of 3292 steps (90%) done

[Mon Jul  6 00:17:38 2020]
rule get_seqs:
    input: /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ingroup.txt, /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/outgroup.txt
    output: per_gene/EOG091G0A2I/EOG091G0A2I.ingroup.fasta
    log: per_gene/EOG091G0A2I/get_seqs.stdout.txt, per_gene/EOG091G0A2I/get_seqs.stderr.txt
    jobid: 2614
    wildcards: BUSCO=EOG091G0A2I
    threads: 2


	basedir=$(pwd)
        cd per_gene/EOG091G0A2I
        
        bash $basedir/../scripts/fetch_seqs.sh EOG091G0A2I /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ingroup.txt /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/outgroup.txt 1> ../../per_gene/EOG091G0A2I/get_seqs.stdout.txt 2> ../../per_gene/EOG091G0A2I/get_seqs.stderr.txt
	mv EOG091G0A2I.fasta $basedir/per_gene/EOG091G0A2I/EOG091G0A2I.ingroup.fasta
        

[Mon Jul  6 00:17:38 2020]
rule get_outgroups:
    input: per_gene/EOG091G0QEQ/EOG091G0QEQ.ingroup.fasta
    output: per_gene/EOG091G0QEQ/EOG091G0QEQ.orthodb.fasta, per_gene/EOG091G0QEQ/EOG091G0QEQ.outgroup.fasta
    log: per_gene/EOG091G0QEQ/get_outgroups.stdout.txt, per_gene/EOG091G0QEQ/get_outgroups.stderr.txt
    jobid: 3011
    wildcards: BUSCO=EOG091G0QEQ


        #download fastas from Orhtodb for BUSCO id
        for i in {1..5}
        do
             wget "http://www.orthodb.org/fasta?query=EOG091G0QEQ&level=33208" -O per_gene/EOG091G0QEQ/EOG091G0QEQ.orthodb.fasta 1> per_gene/EOG091G0QEQ/get_outgroups.stdout.txt 2> per_gene/EOG091G0QEQ/get_outgroups.stderr.txt && break || echo -e "try again ($i)" && sleep 15
        done

	#This is quick an dirty for now and just takes the first protein if there is more than one for an outgroup taxon
        bash ../scripts/download_outgroups.sh taxids.txt per_gene/EOG091G0QEQ/EOG091G0QEQ.orthodb.fasta > per_gene/EOG091G0QEQ/EOG091G0QEQ.outgroup.fasta
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/72476f9d9a5bd0627b4d721143a21354.simg

[Mon Jul  6 00:17:38 2020]
rule get_outgroups:
    input: per_gene/EOG091G0VTN/EOG091G0VTN.ingroup.fasta
    output: per_gene/EOG091G0VTN/EOG091G0VTN.orthodb.fasta, per_gene/EOG091G0VTN/EOG091G0VTN.outgroup.fasta
    log: per_gene/EOG091G0VTN/get_outgroups.stdout.txt, per_gene/EOG091G0VTN/get_outgroups.stderr.txt
    jobid: 2883
    wildcards: BUSCO=EOG091G0VTN


        #download fastas from Orhtodb for BUSCO id
        for i in {1..5}
        do
             wget "http://www.orthodb.org/fasta?query=EOG091G0VTN&level=33208" -O per_gene/EOG091G0VTN/EOG091G0VTN.orthodb.fasta 1> per_gene/EOG091G0VTN/get_outgroups.stdout.txt 2> per_gene/EOG091G0VTN/get_outgroups.stderr.txt && break || echo -e "try again ($i)" && sleep 15
        done

	#This is quick an dirty for now and just takes the first protein if there is more than one for an outgroup taxon
        bash ../scripts/download_outgroups.sh taxids.txt per_gene/EOG091G0VTN/EOG091G0VTN.orthodb.fasta > per_gene/EOG091G0VTN/EOG091G0VTN.outgroup.fasta
        
[Mon Jul  6 00:17:39 2020]
Finished job 3011.
2949 of 3292 steps (90%) done

[Mon Jul  6 00:17:39 2020]
rule join_groups:
    input: per_gene/EOG091G0QEQ/EOG091G0QEQ.ingroup.fasta, per_gene/EOG091G0QEQ/EOG091G0QEQ.outgroup.fasta
    output: per_gene/EOG091G0QEQ/EOG091G0QEQ.fasta
    jobid: 2329
    wildcards: BUSCO=EOG091G0QEQ


        cat per_gene/EOG091G0QEQ/EOG091G0QEQ.ingroup.fasta per_gene/EOG091G0QEQ/EOG091G0QEQ.outgroup.fasta > per_gene/EOG091G0QEQ/EOG091G0QEQ.fasta
        
[Mon Jul  6 00:17:39 2020]
Finished job 2329.
2950 of 3292 steps (90%) done
[Mon Jul  6 00:17:40 2020]
Finished job 2883.
2951 of 3292 steps (90%) done

[Mon Jul  6 00:17:40 2020]
rule MSA:
    input: per_gene/EOG091G0QEQ/EOG091G0QEQ.fasta
    output: per_gene/EOG091G0QEQ/EOG091G0QEQ.clustalo.fasta
    log: per_gene/EOG091G0QEQ/MSA.stdout.txt, per_gene/EOG091G0QEQ/MSA.stderr.txt
    jobid: 1778
    wildcards: BUSCO=EOG091G0QEQ
    threads: 2


        clustalo -i per_gene/EOG091G0QEQ/EOG091G0QEQ.fasta -o per_gene/EOG091G0QEQ/EOG091G0QEQ.clustalo.fasta --threads=2 1> per_gene/EOG091G0QEQ/MSA.stdout.txt 2> per_gene/EOG091G0QEQ/MSA.stderr.txt
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/d68c9691725a7401923680874285c430.simg
[Mon Jul  6 00:17:40 2020]
Finished job 1778.
2952 of 3292 steps (90%) done

[Mon Jul  6 00:17:40 2020]
rule score_and_cut:
    input: per_gene/EOG091G0QEQ/EOG091G0QEQ.clustalo.fasta
    output: per_gene/EOG091G0QEQ/ALICUT_EOG091G0QEQ.clustalo.fasta
    jobid: 955
    wildcards: BUSCO=EOG091G0QEQ
    threads: 2


        cd per_gene/EOG091G0QEQ
        Aliscore.pl -N -r 200000000000000000 -i ../../per_gene/EOG091G0QEQ/EOG091G0QEQ.clustalo.fasta &> aliscore.log
        ALICUT.pl -s &> alicut.log
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/63c88c27a0fa300f57066b0ef65fefcb.simg
[Mon Jul  6 00:17:50 2020]
Finished job 955.
2953 of 3292 steps (90%) done

[Mon Jul  6 00:17:50 2020]
rule join_groups:
    input: per_gene/EOG091G0VTN/EOG091G0VTN.ingroup.fasta, per_gene/EOG091G0VTN/EOG091G0VTN.outgroup.fasta
    output: per_gene/EOG091G0VTN/EOG091G0VTN.fasta
    jobid: 2265
    wildcards: BUSCO=EOG091G0VTN


        cat per_gene/EOG091G0VTN/EOG091G0VTN.ingroup.fasta per_gene/EOG091G0VTN/EOG091G0VTN.outgroup.fasta > per_gene/EOG091G0VTN/EOG091G0VTN.fasta
        

[Mon Jul  6 00:17:50 2020]
rule remove_empty:
    input: per_gene/EOG091G0QEQ/ALICUT_EOG091G0QEQ.clustalo.fasta
    output: per_gene/EOG091G0QEQ/empty_check.done
    jobid: 1777
    wildcards: BUSCO=EOG091G0QEQ


         if [ "$(cat per_gene/EOG091G0QEQ/ALICUT_EOG091G0QEQ.clustalo.fasta | grep -v ">" | sed 's/-//g' | grep "^$" | wc -l)" -gt 0 ]
         then
              cp per_gene/EOG091G0QEQ/ALICUT_EOG091G0QEQ.clustalo.fasta per_gene/EOG091G0QEQ/ALICUT_EOG091G0QEQ.clustalo.fasta.backup
              bash ../scripts/remove_empty.sh per_gene/EOG091G0QEQ/ALICUT_EOG091G0QEQ.clustalo.fasta.backup > per_gene/EOG091G0QEQ/ALICUT_EOG091G0QEQ.clustalo.fasta
         fi
         touch per_gene/EOG091G0QEQ/empty_check.done
         
[Mon Jul  6 00:17:50 2020]
Finished job 2265.
2954 of 3292 steps (90%) done
[Mon Jul  6 00:17:50 2020]
Finished job 1777.
2955 of 3292 steps (90%) done

[Mon Jul  6 00:17:50 2020]
rule MSA:
    input: per_gene/EOG091G0VTN/EOG091G0VTN.fasta
    output: per_gene/EOG091G0VTN/EOG091G0VTN.clustalo.fasta
    log: per_gene/EOG091G0VTN/MSA.stdout.txt, per_gene/EOG091G0VTN/MSA.stderr.txt
    jobid: 1650
    wildcards: BUSCO=EOG091G0VTN
    threads: 2


        clustalo -i per_gene/EOG091G0VTN/EOG091G0VTN.fasta -o per_gene/EOG091G0VTN/EOG091G0VTN.clustalo.fasta --threads=2 1> per_gene/EOG091G0VTN/MSA.stdout.txt 2> per_gene/EOG091G0VTN/MSA.stderr.txt
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/d68c9691725a7401923680874285c430.simg
[Mon Jul  6 00:17:50 2020]
Finished job 1650.
2956 of 3292 steps (90%) done

[Mon Jul  6 00:17:50 2020]
rule score_and_cut:
    input: per_gene/EOG091G0VTN/EOG091G0VTN.clustalo.fasta
    output: per_gene/EOG091G0VTN/ALICUT_EOG091G0VTN.clustalo.fasta
    jobid: 827
    wildcards: BUSCO=EOG091G0VTN
    threads: 2


        cd per_gene/EOG091G0VTN
        Aliscore.pl -N -r 200000000000000000 -i ../../per_gene/EOG091G0VTN/EOG091G0VTN.clustalo.fasta &> aliscore.log
        ALICUT.pl -s &> alicut.log
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/63c88c27a0fa300f57066b0ef65fefcb.simg
[Mon Jul  6 00:17:52 2020]
Finished job 2614.
2957 of 3292 steps (90%) done

[Mon Jul  6 00:17:52 2020]
rule get_outgroups:
    input: per_gene/EOG091G0A2I/EOG091G0A2I.ingroup.fasta
    output: per_gene/EOG091G0A2I/EOG091G0A2I.orthodb.fasta, per_gene/EOG091G0A2I/EOG091G0A2I.outgroup.fasta
    log: per_gene/EOG091G0A2I/get_outgroups.stdout.txt, per_gene/EOG091G0A2I/get_outgroups.stderr.txt
    jobid: 2615
    wildcards: BUSCO=EOG091G0A2I


        #download fastas from Orhtodb for BUSCO id
        for i in {1..5}
        do
             wget "http://www.orthodb.org/fasta?query=EOG091G0A2I&level=33208" -O per_gene/EOG091G0A2I/EOG091G0A2I.orthodb.fasta 1> per_gene/EOG091G0A2I/get_outgroups.stdout.txt 2> per_gene/EOG091G0A2I/get_outgroups.stderr.txt && break || echo -e "try again ($i)" && sleep 15
        done

	#This is quick an dirty for now and just takes the first protein if there is more than one for an outgroup taxon
        bash ../scripts/download_outgroups.sh taxids.txt per_gene/EOG091G0A2I/EOG091G0A2I.orthodb.fasta > per_gene/EOG091G0A2I/EOG091G0A2I.outgroup.fasta
        
[Mon Jul  6 00:17:53 2020]
Finished job 2615.
2958 of 3292 steps (90%) done

[Mon Jul  6 00:17:53 2020]
rule join_groups:
    input: per_gene/EOG091G0A2I/EOG091G0A2I.ingroup.fasta, per_gene/EOG091G0A2I/EOG091G0A2I.outgroup.fasta
    output: per_gene/EOG091G0A2I/EOG091G0A2I.fasta
    jobid: 2131
    wildcards: BUSCO=EOG091G0A2I


        cat per_gene/EOG091G0A2I/EOG091G0A2I.ingroup.fasta per_gene/EOG091G0A2I/EOG091G0A2I.outgroup.fasta > per_gene/EOG091G0A2I/EOG091G0A2I.fasta
        
[Mon Jul  6 00:17:53 2020]
Finished job 2131.
2959 of 3292 steps (90%) done

[Mon Jul  6 00:17:53 2020]
rule MSA:
    input: per_gene/EOG091G0A2I/EOG091G0A2I.fasta
    output: per_gene/EOG091G0A2I/EOG091G0A2I.clustalo.fasta
    log: per_gene/EOG091G0A2I/MSA.stdout.txt, per_gene/EOG091G0A2I/MSA.stderr.txt
    jobid: 1382
    wildcards: BUSCO=EOG091G0A2I
    threads: 2


        clustalo -i per_gene/EOG091G0A2I/EOG091G0A2I.fasta -o per_gene/EOG091G0A2I/EOG091G0A2I.clustalo.fasta --threads=2 1> per_gene/EOG091G0A2I/MSA.stdout.txt 2> per_gene/EOG091G0A2I/MSA.stderr.txt
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/d68c9691725a7401923680874285c430.simg
[Mon Jul  6 00:17:54 2020]
Finished job 1382.
2960 of 3292 steps (90%) done

[Mon Jul  6 00:17:54 2020]
rule score_and_cut:
    input: per_gene/EOG091G0A2I/EOG091G0A2I.clustalo.fasta
    output: per_gene/EOG091G0A2I/ALICUT_EOG091G0A2I.clustalo.fasta
    jobid: 559
    wildcards: BUSCO=EOG091G0A2I
    threads: 2


        cd per_gene/EOG091G0A2I
        Aliscore.pl -N -r 200000000000000000 -i ../../per_gene/EOG091G0A2I/EOG091G0A2I.clustalo.fasta &> aliscore.log
        ALICUT.pl -s &> alicut.log
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/63c88c27a0fa300f57066b0ef65fefcb.simg
[Mon Jul  6 00:18:00 2020]
Finished job 827.
2961 of 3292 steps (90%) done

[Mon Jul  6 00:18:00 2020]
rule find_best_model:
    input: per_gene/EOG091G0QEQ/ALICUT_EOG091G0QEQ.clustalo.fasta, per_gene/EOG091G0QEQ/empty_check.done
    output: per_gene/EOG091G0QEQ/EOG091G0QEQ.best_model
    log: per_gene/EOG091G0QEQ/find_best_model.stderr.txt
    jobid: 954
    wildcards: BUSCO=EOG091G0QEQ
    threads: 2


        cd per_gene/EOG091G0QEQ
        if [ ! -d find_best_model ]
        then
            mkdir find_best_model
        fi
        cd find_best_model
        ln -s ../../../per_gene/EOG091G0QEQ/ALICUT_EOG091G0QEQ.clustalo.fasta EOG091G0QEQ.fasta
        ProteinModelSelection.pl EOG091G0QEQ.fasta 1> ../../../per_gene/EOG091G0QEQ/EOG091G0QEQ.best_model 2> ../../../per_gene/EOG091G0QEQ/find_best_model.stderr.txt
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/c0c09ee657b1e27f2c5687e0e9aa8d70.simg
[Mon Jul  6 00:18:04 2020]
Finished job 559.
2962 of 3292 steps (90%) done

[Mon Jul  6 00:18:04 2020]
rule remove_empty:
    input: per_gene/EOG091G0A2I/ALICUT_EOG091G0A2I.clustalo.fasta
    output: per_gene/EOG091G0A2I/empty_check.done
    jobid: 1381
    wildcards: BUSCO=EOG091G0A2I


         if [ "$(cat per_gene/EOG091G0A2I/ALICUT_EOG091G0A2I.clustalo.fasta | grep -v ">" | sed 's/-//g' | grep "^$" | wc -l)" -gt 0 ]
         then
              cp per_gene/EOG091G0A2I/ALICUT_EOG091G0A2I.clustalo.fasta per_gene/EOG091G0A2I/ALICUT_EOG091G0A2I.clustalo.fasta.backup
              bash ../scripts/remove_empty.sh per_gene/EOG091G0A2I/ALICUT_EOG091G0A2I.clustalo.fasta.backup > per_gene/EOG091G0A2I/ALICUT_EOG091G0A2I.clustalo.fasta
         fi
         touch per_gene/EOG091G0A2I/empty_check.done
         

[Mon Jul  6 00:18:04 2020]
rule remove_empty:
    input: per_gene/EOG091G0VTN/ALICUT_EOG091G0VTN.clustalo.fasta
    output: per_gene/EOG091G0VTN/empty_check.done
    jobid: 1649
    wildcards: BUSCO=EOG091G0VTN


         if [ "$(cat per_gene/EOG091G0VTN/ALICUT_EOG091G0VTN.clustalo.fasta | grep -v ">" | sed 's/-//g' | grep "^$" | wc -l)" -gt 0 ]
         then
              cp per_gene/EOG091G0VTN/ALICUT_EOG091G0VTN.clustalo.fasta per_gene/EOG091G0VTN/ALICUT_EOG091G0VTN.clustalo.fasta.backup
              bash ../scripts/remove_empty.sh per_gene/EOG091G0VTN/ALICUT_EOG091G0VTN.clustalo.fasta.backup > per_gene/EOG091G0VTN/ALICUT_EOG091G0VTN.clustalo.fasta
         fi
         touch per_gene/EOG091G0VTN/empty_check.done
         
[Mon Jul  6 00:18:04 2020]
Finished job 1381.
2963 of 3292 steps (90%) done
[Mon Jul  6 00:18:04 2020]
Finished job 1649.
2964 of 3292 steps (90%) done

[Mon Jul  6 00:18:04 2020]
rule find_best_model:
    input: per_gene/EOG091G0A2I/ALICUT_EOG091G0A2I.clustalo.fasta, per_gene/EOG091G0A2I/empty_check.done
    output: per_gene/EOG091G0A2I/EOG091G0A2I.best_model
    log: per_gene/EOG091G0A2I/find_best_model.stderr.txt
    jobid: 558
    wildcards: BUSCO=EOG091G0A2I
    threads: 2


        cd per_gene/EOG091G0A2I
        if [ ! -d find_best_model ]
        then
            mkdir find_best_model
        fi
        cd find_best_model
        ln -s ../../../per_gene/EOG091G0A2I/ALICUT_EOG091G0A2I.clustalo.fasta EOG091G0A2I.fasta
        ProteinModelSelection.pl EOG091G0A2I.fasta 1> ../../../per_gene/EOG091G0A2I/EOG091G0A2I.best_model 2> ../../../per_gene/EOG091G0A2I/find_best_model.stderr.txt
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/c0c09ee657b1e27f2c5687e0e9aa8d70.simg
[Mon Jul  6 00:18:15 2020]
Finished job 178.
2965 of 3292 steps (90%) done

[Mon Jul  6 00:18:15 2020]
rule find_best_model:
    input: per_gene/EOG091G0VTN/ALICUT_EOG091G0VTN.clustalo.fasta, per_gene/EOG091G0VTN/empty_check.done
    output: per_gene/EOG091G0VTN/EOG091G0VTN.best_model
    log: per_gene/EOG091G0VTN/find_best_model.stderr.txt
    jobid: 826
    wildcards: BUSCO=EOG091G0VTN
    threads: 2


        cd per_gene/EOG091G0VTN
        if [ ! -d find_best_model ]
        then
            mkdir find_best_model
        fi
        cd find_best_model
        ln -s ../../../per_gene/EOG091G0VTN/ALICUT_EOG091G0VTN.clustalo.fasta EOG091G0VTN.fasta
        ProteinModelSelection.pl EOG091G0VTN.fasta 1> ../../../per_gene/EOG091G0VTN/EOG091G0VTN.best_model 2> ../../../per_gene/EOG091G0VTN/find_best_model.stderr.txt
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/c0c09ee657b1e27f2c5687e0e9aa8d70.simg
[Mon Jul  6 00:18:25 2020]
Finished job 954.
2966 of 3292 steps (90%) done

[Mon Jul  6 00:18:25 2020]
rule infer_single_ML:
    input: per_gene/EOG091G0QEQ/EOG091G0QEQ.best_model, per_gene/EOG091G0QEQ/ALICUT_EOG091G0QEQ.clustalo.fasta
    output: per_gene/EOG091G0QEQ/EOG091G0QEQ.raxml.done
    log: per_gene/EOG091G0QEQ/infer_single_ML.stdout.txt, per_gene/EOG091G0QEQ/infer_single_ML.stderr.txt
    jobid: 271
    wildcards: BUSCO=EOG091G0QEQ
    threads: 2


        cd per_gene/EOG091G0QEQ
	count=$(cat ../../per_gene/EOG091G0QEQ/ALICUT_EOG091G0QEQ.clustalo.fasta | grep ">" | wc -l)
	if [ "$count" -gt 5 ]
        then
		RAxMLmodel=$(cat ../../per_gene/EOG091G0QEQ/EOG091G0QEQ.best_model | grep "Best" | cut -d ":" -f 2 | tr -d '[:space:]')
                if [ "$(ls -1 | grep "^RAxML" | wc -l)" -ne 0 ]
		then
			rm RAxML*
		fi
        	raxml -f a -T 2 -m PROTGAMMA$RAxMLmodel         	-p 12345 -x 12345 -# 100         	-s ../../per_gene/EOG091G0QEQ/ALICUT_EOG091G0QEQ.clustalo.fasta -n EOG091G0QEQ.clustalo.aln.ALICUT.$RAxMLmodel 		1> ../../per_gene/EOG091G0QEQ/infer_single_ML.stdout.txt 2> ../../per_gene/EOG091G0QEQ/infer_single_ML.stderr.txt
	else
		echo "fasta file per_gene/EOG091G0QEQ/ALICUT_EOG091G0QEQ.clustalo.fasta contains fewer than 5 sequences - skipped" > ../../per_gene/EOG091G0QEQ/infer_single_ML.stdout.txt
		touch raxml.skipped
	fi
        touch ../../per_gene/EOG091G0QEQ/EOG091G0QEQ.raxml.done
        
[33mJob counts:
	count	jobs
	1	infer_single_ML
	1[0m
[33m
        cd per_gene/EOG091G0QEQ
	count=$(cat ../../per_gene/EOG091G0QEQ/ALICUT_EOG091G0QEQ.clustalo.fasta | grep ">" | wc -l)
	if [ "$count" -gt 5 ]
        then
		RAxMLmodel=$(cat ../../per_gene/EOG091G0QEQ/EOG091G0QEQ.best_model | grep "Best" | cut -d ":" -f 2 | tr -d '[:space:]')
                if [ "$(ls -1 | grep "^RAxML" | wc -l)" -ne 0 ]
		then
			rm RAxML*
		fi
        	raxml -f a -T 2 -m PROTGAMMA$RAxMLmodel         	-p 12345 -x 12345 -# 100         	-s ../../per_gene/EOG091G0QEQ/ALICUT_EOG091G0QEQ.clustalo.fasta -n EOG091G0QEQ.clustalo.aln.ALICUT.$RAxMLmodel 		1> ../../per_gene/EOG091G0QEQ/infer_single_ML.stdout.txt 2> ../../per_gene/EOG091G0QEQ/infer_single_ML.stderr.txt
	else
		echo "fasta file per_gene/EOG091G0QEQ/ALICUT_EOG091G0QEQ.clustalo.fasta contains fewer than 5 sequences - skipped" > ../../per_gene/EOG091G0QEQ/infer_single_ML.stdout.txt
		touch raxml.skipped
	fi
        touch ../../per_gene/EOG091G0QEQ/EOG091G0QEQ.raxml.done
        [0m
[Mon Jul  6 00:18:40 2020]
Finished job 558.
2967 of 3292 steps (90%) done

[Mon Jul  6 00:18:40 2020]
rule infer_single_ML:
    input: per_gene/EOG091G0A2I/EOG091G0A2I.best_model, per_gene/EOG091G0A2I/ALICUT_EOG091G0A2I.clustalo.fasta
    output: per_gene/EOG091G0A2I/EOG091G0A2I.raxml.done
    log: per_gene/EOG091G0A2I/infer_single_ML.stdout.txt, per_gene/EOG091G0A2I/infer_single_ML.stderr.txt
    jobid: 73
    wildcards: BUSCO=EOG091G0A2I
    threads: 2


        cd per_gene/EOG091G0A2I
	count=$(cat ../../per_gene/EOG091G0A2I/ALICUT_EOG091G0A2I.clustalo.fasta | grep ">" | wc -l)
	if [ "$count" -gt 5 ]
        then
		RAxMLmodel=$(cat ../../per_gene/EOG091G0A2I/EOG091G0A2I.best_model | grep "Best" | cut -d ":" -f 2 | tr -d '[:space:]')
                if [ "$(ls -1 | grep "^RAxML" | wc -l)" -ne 0 ]
		then
			rm RAxML*
		fi
        	raxml -f a -T 2 -m PROTGAMMA$RAxMLmodel         	-p 12345 -x 12345 -# 100         	-s ../../per_gene/EOG091G0A2I/ALICUT_EOG091G0A2I.clustalo.fasta -n EOG091G0A2I.clustalo.aln.ALICUT.$RAxMLmodel 		1> ../../per_gene/EOG091G0A2I/infer_single_ML.stdout.txt 2> ../../per_gene/EOG091G0A2I/infer_single_ML.stderr.txt
	else
		echo "fasta file per_gene/EOG091G0A2I/ALICUT_EOG091G0A2I.clustalo.fasta contains fewer than 5 sequences - skipped" > ../../per_gene/EOG091G0A2I/infer_single_ML.stdout.txt
		touch raxml.skipped
	fi
        touch ../../per_gene/EOG091G0A2I/EOG091G0A2I.raxml.done
        
[Mon Jul  6 00:18:41 2020]
Finished job 826.
2968 of 3292 steps (90%) done

[Mon Jul  6 00:18:41 2020]
rule infer_single_ML:
    input: per_gene/EOG091G0VTN/EOG091G0VTN.best_model, per_gene/EOG091G0VTN/ALICUT_EOG091G0VTN.clustalo.fasta
    output: per_gene/EOG091G0VTN/EOG091G0VTN.raxml.done
    log: per_gene/EOG091G0VTN/infer_single_ML.stdout.txt, per_gene/EOG091G0VTN/infer_single_ML.stderr.txt
    jobid: 207
    wildcards: BUSCO=EOG091G0VTN
    threads: 2


        cd per_gene/EOG091G0VTN
	count=$(cat ../../per_gene/EOG091G0VTN/ALICUT_EOG091G0VTN.clustalo.fasta | grep ">" | wc -l)
	if [ "$count" -gt 5 ]
        then
		RAxMLmodel=$(cat ../../per_gene/EOG091G0VTN/EOG091G0VTN.best_model | grep "Best" | cut -d ":" -f 2 | tr -d '[:space:]')
                if [ "$(ls -1 | grep "^RAxML" | wc -l)" -ne 0 ]
		then
			rm RAxML*
		fi
        	raxml -f a -T 2 -m PROTGAMMA$RAxMLmodel         	-p 12345 -x 12345 -# 100         	-s ../../per_gene/EOG091G0VTN/ALICUT_EOG091G0VTN.clustalo.fasta -n EOG091G0VTN.clustalo.aln.ALICUT.$RAxMLmodel 		1> ../../per_gene/EOG091G0VTN/infer_single_ML.stdout.txt 2> ../../per_gene/EOG091G0VTN/infer_single_ML.stderr.txt
	else
		echo "fasta file per_gene/EOG091G0VTN/ALICUT_EOG091G0VTN.clustalo.fasta contains fewer than 5 sequences - skipped" > ../../per_gene/EOG091G0VTN/infer_single_ML.stdout.txt
		touch raxml.skipped
	fi
        touch ../../per_gene/EOG091G0VTN/EOG091G0VTN.raxml.done
        
[33mJob counts:
	count	jobs
	1	infer_single_ML
	1[0m
[33mJob counts:
	count	jobs
	1	infer_single_ML
	1[0m
[33m
        cd per_gene/EOG091G0A2I
	count=$(cat ../../per_gene/EOG091G0A2I/ALICUT_EOG091G0A2I.clustalo.fasta | grep ">" | wc -l)
	if [ "$count" -gt 5 ]
        then
		RAxMLmodel=$(cat ../../per_gene/EOG091G0A2I/EOG091G0A2I.best_model | grep "Best" | cut -d ":" -f 2 | tr -d '[:space:]')
                if [ "$(ls -1 | grep "^RAxML" | wc -l)" -ne 0 ]
		then
			rm RAxML*
		fi
        	raxml -f a -T 2 -m PROTGAMMA$RAxMLmodel         	-p 12345 -x 12345 -# 100         	-s ../../per_gene/EOG091G0A2I/ALICUT_EOG091G0A2I.clustalo.fasta -n EOG091G0A2I.clustalo.aln.ALICUT.$RAxMLmodel 		1> ../../per_gene/EOG091G0A2I/infer_single_ML.stdout.txt 2> ../../per_gene/EOG091G0A2I/infer_single_ML.stderr.txt
	else
		echo "fasta file per_gene/EOG091G0A2I/ALICUT_EOG091G0A2I.clustalo.fasta contains fewer than 5 sequences - skipped" > ../../per_gene/EOG091G0A2I/infer_single_ML.stdout.txt
		touch raxml.skipped
	fi
        touch ../../per_gene/EOG091G0A2I/EOG091G0A2I.raxml.done
        [0m
[33m
        cd per_gene/EOG091G0VTN
	count=$(cat ../../per_gene/EOG091G0VTN/ALICUT_EOG091G0VTN.clustalo.fasta | grep ">" | wc -l)
	if [ "$count" -gt 5 ]
        then
		RAxMLmodel=$(cat ../../per_gene/EOG091G0VTN/EOG091G0VTN.best_model | grep "Best" | cut -d ":" -f 2 | tr -d '[:space:]')
                if [ "$(ls -1 | grep "^RAxML" | wc -l)" -ne 0 ]
		then
			rm RAxML*
		fi
        	raxml -f a -T 2 -m PROTGAMMA$RAxMLmodel         	-p 12345 -x 12345 -# 100         	-s ../../per_gene/EOG091G0VTN/ALICUT_EOG091G0VTN.clustalo.fasta -n EOG091G0VTN.clustalo.aln.ALICUT.$RAxMLmodel 		1> ../../per_gene/EOG091G0VTN/infer_single_ML.stdout.txt 2> ../../per_gene/EOG091G0VTN/infer_single_ML.stderr.txt
	else
		echo "fasta file per_gene/EOG091G0VTN/ALICUT_EOG091G0VTN.clustalo.fasta contains fewer than 5 sequences - skipped" > ../../per_gene/EOG091G0VTN/infer_single_ML.stdout.txt
		touch raxml.skipped
	fi
        touch ../../per_gene/EOG091G0VTN/EOG091G0VTN.raxml.done
        [0m
[Mon Jul  6 00:19:11 2020]
Finished job 230.
2969 of 3292 steps (90%) done

[Mon Jul  6 00:19:11 2020]
rule get_seqs:
    input: /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ingroup.txt, /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/outgroup.txt
    output: per_gene/EOG091G0TA6/EOG091G0TA6.ingroup.fasta
    log: per_gene/EOG091G0TA6/get_seqs.stdout.txt, per_gene/EOG091G0TA6/get_seqs.stderr.txt
    jobid: 3252
    wildcards: BUSCO=EOG091G0TA6
    threads: 2


	basedir=$(pwd)
        cd per_gene/EOG091G0TA6
        
        bash $basedir/../scripts/fetch_seqs.sh EOG091G0TA6 /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ingroup.txt /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/outgroup.txt 1> ../../per_gene/EOG091G0TA6/get_seqs.stdout.txt 2> ../../per_gene/EOG091G0TA6/get_seqs.stderr.txt
	mv EOG091G0TA6.fasta $basedir/per_gene/EOG091G0TA6/EOG091G0TA6.ingroup.fasta
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/72476f9d9a5bd0627b4d721143a21354.simg
[Mon Jul  6 00:19:19 2020]
Finished job 36.
2970 of 3292 steps (90%) done

[Mon Jul  6 00:19:19 2020]
rule get_seqs:
    input: /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ingroup.txt, /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/outgroup.txt
    output: per_gene/EOG091G197A/EOG091G197A.ingroup.fasta
    log: per_gene/EOG091G197A/get_seqs.stdout.txt, per_gene/EOG091G197A/get_seqs.stderr.txt
    jobid: 3048
    wildcards: BUSCO=EOG091G197A
    threads: 2


	basedir=$(pwd)
        cd per_gene/EOG091G197A
        
        bash $basedir/../scripts/fetch_seqs.sh EOG091G197A /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ingroup.txt /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/outgroup.txt 1> ../../per_gene/EOG091G197A/get_seqs.stdout.txt 2> ../../per_gene/EOG091G197A/get_seqs.stderr.txt
	mv EOG091G197A.fasta $basedir/per_gene/EOG091G197A/EOG091G197A.ingroup.fasta
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/72476f9d9a5bd0627b4d721143a21354.simg
[Mon Jul  6 00:19:25 2020]
Finished job 3252.
2971 of 3292 steps (90%) done

[Mon Jul  6 00:19:25 2020]
rule get_outgroups:
    input: per_gene/EOG091G0TA6/EOG091G0TA6.ingroup.fasta
    output: per_gene/EOG091G0TA6/EOG091G0TA6.orthodb.fasta, per_gene/EOG091G0TA6/EOG091G0TA6.outgroup.fasta
    log: per_gene/EOG091G0TA6/get_outgroups.stdout.txt, per_gene/EOG091G0TA6/get_outgroups.stderr.txt
    jobid: 3253
    wildcards: BUSCO=EOG091G0TA6


        #download fastas from Orhtodb for BUSCO id
        for i in {1..5}
        do
             wget "http://www.orthodb.org/fasta?query=EOG091G0TA6&level=33208" -O per_gene/EOG091G0TA6/EOG091G0TA6.orthodb.fasta 1> per_gene/EOG091G0TA6/get_outgroups.stdout.txt 2> per_gene/EOG091G0TA6/get_outgroups.stderr.txt && break || echo -e "try again ($i)" && sleep 15
        done

	#This is quick an dirty for now and just takes the first protein if there is more than one for an outgroup taxon
        bash ../scripts/download_outgroups.sh taxids.txt per_gene/EOG091G0TA6/EOG091G0TA6.orthodb.fasta > per_gene/EOG091G0TA6/EOG091G0TA6.outgroup.fasta
        
[Mon Jul  6 00:19:26 2020]
Finished job 3253.
2972 of 3292 steps (90%) done

[Mon Jul  6 00:19:26 2020]
rule join_groups:
    input: per_gene/EOG091G0TA6/EOG091G0TA6.ingroup.fasta, per_gene/EOG091G0TA6/EOG091G0TA6.outgroup.fasta
    output: per_gene/EOG091G0TA6/EOG091G0TA6.fasta
    jobid: 2450
    wildcards: BUSCO=EOG091G0TA6


        cat per_gene/EOG091G0TA6/EOG091G0TA6.ingroup.fasta per_gene/EOG091G0TA6/EOG091G0TA6.outgroup.fasta > per_gene/EOG091G0TA6/EOG091G0TA6.fasta
        
[Mon Jul  6 00:19:26 2020]
Finished job 2450.
2973 of 3292 steps (90%) done

[Mon Jul  6 00:19:26 2020]
rule MSA:
    input: per_gene/EOG091G0TA6/EOG091G0TA6.fasta
    output: per_gene/EOG091G0TA6/EOG091G0TA6.clustalo.fasta
    log: per_gene/EOG091G0TA6/MSA.stdout.txt, per_gene/EOG091G0TA6/MSA.stderr.txt
    jobid: 2020
    wildcards: BUSCO=EOG091G0TA6
    threads: 2


        clustalo -i per_gene/EOG091G0TA6/EOG091G0TA6.fasta -o per_gene/EOG091G0TA6/EOG091G0TA6.clustalo.fasta --threads=2 1> per_gene/EOG091G0TA6/MSA.stdout.txt 2> per_gene/EOG091G0TA6/MSA.stderr.txt
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/d68c9691725a7401923680874285c430.simg
[Mon Jul  6 00:19:29 2020]
Finished job 2020.
2974 of 3292 steps (90%) done

[Mon Jul  6 00:19:29 2020]
rule score_and_cut:
    input: per_gene/EOG091G0TA6/EOG091G0TA6.clustalo.fasta
    output: per_gene/EOG091G0TA6/ALICUT_EOG091G0TA6.clustalo.fasta
    jobid: 1197
    wildcards: BUSCO=EOG091G0TA6
    threads: 2


        cd per_gene/EOG091G0TA6
        Aliscore.pl -N -r 200000000000000000 -i ../../per_gene/EOG091G0TA6/EOG091G0TA6.clustalo.fasta &> aliscore.log
        ALICUT.pl -s &> alicut.log
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/63c88c27a0fa300f57066b0ef65fefcb.simg
[Mon Jul  6 00:19:33 2020]
Finished job 3048.
2975 of 3292 steps (90%) done

[Mon Jul  6 00:19:33 2020]
rule get_outgroups:
    input: per_gene/EOG091G197A/EOG091G197A.ingroup.fasta
    output: per_gene/EOG091G197A/EOG091G197A.orthodb.fasta, per_gene/EOG091G197A/EOG091G197A.outgroup.fasta
    log: per_gene/EOG091G197A/get_outgroups.stdout.txt, per_gene/EOG091G197A/get_outgroups.stderr.txt
    jobid: 3049
    wildcards: BUSCO=EOG091G197A


        #download fastas from Orhtodb for BUSCO id
        for i in {1..5}
        do
             wget "http://www.orthodb.org/fasta?query=EOG091G197A&level=33208" -O per_gene/EOG091G197A/EOG091G197A.orthodb.fasta 1> per_gene/EOG091G197A/get_outgroups.stdout.txt 2> per_gene/EOG091G197A/get_outgroups.stderr.txt && break || echo -e "try again ($i)" && sleep 15
        done

	#This is quick an dirty for now and just takes the first protein if there is more than one for an outgroup taxon
        bash ../scripts/download_outgroups.sh taxids.txt per_gene/EOG091G197A/EOG091G197A.orthodb.fasta > per_gene/EOG091G197A/EOG091G197A.outgroup.fasta
        
[Mon Jul  6 00:19:33 2020]
Finished job 3049.
2976 of 3292 steps (90%) done

[Mon Jul  6 00:19:33 2020]
rule join_groups:
    input: per_gene/EOG091G197A/EOG091G197A.ingroup.fasta, per_gene/EOG091G197A/EOG091G197A.outgroup.fasta
    output: per_gene/EOG091G197A/EOG091G197A.fasta
    jobid: 2348
    wildcards: BUSCO=EOG091G197A


        cat per_gene/EOG091G197A/EOG091G197A.ingroup.fasta per_gene/EOG091G197A/EOG091G197A.outgroup.fasta > per_gene/EOG091G197A/EOG091G197A.fasta
        
[Mon Jul  6 00:19:33 2020]
Finished job 2348.
2977 of 3292 steps (90%) done

[Mon Jul  6 00:19:33 2020]
rule MSA:
    input: per_gene/EOG091G197A/EOG091G197A.fasta
    output: per_gene/EOG091G197A/EOG091G197A.clustalo.fasta
    log: per_gene/EOG091G197A/MSA.stdout.txt, per_gene/EOG091G197A/MSA.stderr.txt
    jobid: 1816
    wildcards: BUSCO=EOG091G197A
    threads: 2


        clustalo -i per_gene/EOG091G197A/EOG091G197A.fasta -o per_gene/EOG091G197A/EOG091G197A.clustalo.fasta --threads=2 1> per_gene/EOG091G197A/MSA.stdout.txt 2> per_gene/EOG091G197A/MSA.stderr.txt
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/d68c9691725a7401923680874285c430.simg
[Mon Jul  6 00:19:34 2020]
Finished job 1816.
2978 of 3292 steps (90%) done

[Mon Jul  6 00:19:34 2020]
rule score_and_cut:
    input: per_gene/EOG091G197A/EOG091G197A.clustalo.fasta
    output: per_gene/EOG091G197A/ALICUT_EOG091G197A.clustalo.fasta
    jobid: 993
    wildcards: BUSCO=EOG091G197A
    threads: 2


        cd per_gene/EOG091G197A
        Aliscore.pl -N -r 200000000000000000 -i ../../per_gene/EOG091G197A/EOG091G197A.clustalo.fasta &> aliscore.log
        ALICUT.pl -s &> alicut.log
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/63c88c27a0fa300f57066b0ef65fefcb.simg
[Mon Jul  6 00:19:39 2020]
Finished job 1197.
2979 of 3292 steps (90%) done

[Mon Jul  6 00:19:39 2020]
rule remove_empty:
    input: per_gene/EOG091G0TA6/ALICUT_EOG091G0TA6.clustalo.fasta
    output: per_gene/EOG091G0TA6/empty_check.done
    jobid: 2019
    wildcards: BUSCO=EOG091G0TA6


         if [ "$(cat per_gene/EOG091G0TA6/ALICUT_EOG091G0TA6.clustalo.fasta | grep -v ">" | sed 's/-//g' | grep "^$" | wc -l)" -gt 0 ]
         then
              cp per_gene/EOG091G0TA6/ALICUT_EOG091G0TA6.clustalo.fasta per_gene/EOG091G0TA6/ALICUT_EOG091G0TA6.clustalo.fasta.backup
              bash ../scripts/remove_empty.sh per_gene/EOG091G0TA6/ALICUT_EOG091G0TA6.clustalo.fasta.backup > per_gene/EOG091G0TA6/ALICUT_EOG091G0TA6.clustalo.fasta
         fi
         touch per_gene/EOG091G0TA6/empty_check.done
         
[Mon Jul  6 00:19:39 2020]
Finished job 2019.
2980 of 3292 steps (91%) done

[Mon Jul  6 00:19:39 2020]
rule find_best_model:
    input: per_gene/EOG091G0TA6/ALICUT_EOG091G0TA6.clustalo.fasta, per_gene/EOG091G0TA6/empty_check.done
    output: per_gene/EOG091G0TA6/EOG091G0TA6.best_model
    log: per_gene/EOG091G0TA6/find_best_model.stderr.txt
    jobid: 1196
    wildcards: BUSCO=EOG091G0TA6
    threads: 2


        cd per_gene/EOG091G0TA6
        if [ ! -d find_best_model ]
        then
            mkdir find_best_model
        fi
        cd find_best_model
        ln -s ../../../per_gene/EOG091G0TA6/ALICUT_EOG091G0TA6.clustalo.fasta EOG091G0TA6.fasta
        ProteinModelSelection.pl EOG091G0TA6.fasta 1> ../../../per_gene/EOG091G0TA6/EOG091G0TA6.best_model 2> ../../../per_gene/EOG091G0TA6/find_best_model.stderr.txt
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/c0c09ee657b1e27f2c5687e0e9aa8d70.simg
[Mon Jul  6 00:19:43 2020]
Finished job 993.
2981 of 3292 steps (91%) done

[Mon Jul  6 00:19:43 2020]
rule remove_empty:
    input: per_gene/EOG091G197A/ALICUT_EOG091G197A.clustalo.fasta
    output: per_gene/EOG091G197A/empty_check.done
    jobid: 1815
    wildcards: BUSCO=EOG091G197A


         if [ "$(cat per_gene/EOG091G197A/ALICUT_EOG091G197A.clustalo.fasta | grep -v ">" | sed 's/-//g' | grep "^$" | wc -l)" -gt 0 ]
         then
              cp per_gene/EOG091G197A/ALICUT_EOG091G197A.clustalo.fasta per_gene/EOG091G197A/ALICUT_EOG091G197A.clustalo.fasta.backup
              bash ../scripts/remove_empty.sh per_gene/EOG091G197A/ALICUT_EOG091G197A.clustalo.fasta.backup > per_gene/EOG091G197A/ALICUT_EOG091G197A.clustalo.fasta
         fi
         touch per_gene/EOG091G197A/empty_check.done
         
[Mon Jul  6 00:19:44 2020]
Finished job 1815.
2982 of 3292 steps (91%) done

[Mon Jul  6 00:19:44 2020]
rule find_best_model:
    input: per_gene/EOG091G197A/ALICUT_EOG091G197A.clustalo.fasta, per_gene/EOG091G197A/empty_check.done
    output: per_gene/EOG091G197A/EOG091G197A.best_model
    log: per_gene/EOG091G197A/find_best_model.stderr.txt
    jobid: 992
    wildcards: BUSCO=EOG091G197A
    threads: 2


        cd per_gene/EOG091G197A
        if [ ! -d find_best_model ]
        then
            mkdir find_best_model
        fi
        cd find_best_model
        ln -s ../../../per_gene/EOG091G197A/ALICUT_EOG091G197A.clustalo.fasta EOG091G197A.fasta
        ProteinModelSelection.pl EOG091G197A.fasta 1> ../../../per_gene/EOG091G197A/EOG091G197A.best_model 2> ../../../per_gene/EOG091G197A/find_best_model.stderr.txt
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/c0c09ee657b1e27f2c5687e0e9aa8d70.simg
[Mon Jul  6 00:19:47 2020]
Finished job 215.
2983 of 3292 steps (91%) done

[Mon Jul  6 00:19:47 2020]
rule get_seqs:
    input: /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ingroup.txt, /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/outgroup.txt
    output: per_gene/EOG091G07S9/EOG091G07S9.ingroup.fasta
    log: per_gene/EOG091G07S9/get_seqs.stdout.txt, per_gene/EOG091G07S9/get_seqs.stderr.txt
    jobid: 2582
    wildcards: BUSCO=EOG091G07S9
    threads: 2


	basedir=$(pwd)
        cd per_gene/EOG091G07S9
        
        bash $basedir/../scripts/fetch_seqs.sh EOG091G07S9 /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ingroup.txt /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/outgroup.txt 1> ../../per_gene/EOG091G07S9/get_seqs.stdout.txt 2> ../../per_gene/EOG091G07S9/get_seqs.stderr.txt
	mv EOG091G07S9.fasta $basedir/per_gene/EOG091G07S9/EOG091G07S9.ingroup.fasta
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/72476f9d9a5bd0627b4d721143a21354.simg
[Mon Jul  6 00:20:01 2020]
Finished job 2582.
2984 of 3292 steps (91%) done

[Mon Jul  6 00:20:01 2020]
rule get_outgroups:
    input: per_gene/EOG091G07S9/EOG091G07S9.ingroup.fasta
    output: per_gene/EOG091G07S9/EOG091G07S9.orthodb.fasta, per_gene/EOG091G07S9/EOG091G07S9.outgroup.fasta
    log: per_gene/EOG091G07S9/get_outgroups.stdout.txt, per_gene/EOG091G07S9/get_outgroups.stderr.txt
    jobid: 2583
    wildcards: BUSCO=EOG091G07S9


        #download fastas from Orhtodb for BUSCO id
        for i in {1..5}
        do
             wget "http://www.orthodb.org/fasta?query=EOG091G07S9&level=33208" -O per_gene/EOG091G07S9/EOG091G07S9.orthodb.fasta 1> per_gene/EOG091G07S9/get_outgroups.stdout.txt 2> per_gene/EOG091G07S9/get_outgroups.stderr.txt && break || echo -e "try again ($i)" && sleep 15
        done

	#This is quick an dirty for now and just takes the first protein if there is more than one for an outgroup taxon
        bash ../scripts/download_outgroups.sh taxids.txt per_gene/EOG091G07S9/EOG091G07S9.orthodb.fasta > per_gene/EOG091G07S9/EOG091G07S9.outgroup.fasta
        
[Mon Jul  6 00:20:02 2020]
Finished job 2583.
2985 of 3292 steps (91%) done

[Mon Jul  6 00:20:02 2020]
rule join_groups:
    input: per_gene/EOG091G07S9/EOG091G07S9.ingroup.fasta, per_gene/EOG091G07S9/EOG091G07S9.outgroup.fasta
    output: per_gene/EOG091G07S9/EOG091G07S9.fasta
    jobid: 2115
    wildcards: BUSCO=EOG091G07S9


        cat per_gene/EOG091G07S9/EOG091G07S9.ingroup.fasta per_gene/EOG091G07S9/EOG091G07S9.outgroup.fasta > per_gene/EOG091G07S9/EOG091G07S9.fasta
        
[Mon Jul  6 00:20:02 2020]
Finished job 2115.
2986 of 3292 steps (91%) done

[Mon Jul  6 00:20:02 2020]
rule MSA:
    input: per_gene/EOG091G07S9/EOG091G07S9.fasta
    output: per_gene/EOG091G07S9/EOG091G07S9.clustalo.fasta
    log: per_gene/EOG091G07S9/MSA.stdout.txt, per_gene/EOG091G07S9/MSA.stderr.txt
    jobid: 1350
    wildcards: BUSCO=EOG091G07S9
    threads: 2


        clustalo -i per_gene/EOG091G07S9/EOG091G07S9.fasta -o per_gene/EOG091G07S9/EOG091G07S9.clustalo.fasta --threads=2 1> per_gene/EOG091G07S9/MSA.stdout.txt 2> per_gene/EOG091G07S9/MSA.stderr.txt
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/d68c9691725a7401923680874285c430.simg
[Mon Jul  6 00:20:04 2020]
Finished job 1196.
2987 of 3292 steps (91%) done

[Mon Jul  6 00:20:04 2020]
rule infer_single_ML:
    input: per_gene/EOG091G0TA6/EOG091G0TA6.best_model, per_gene/EOG091G0TA6/ALICUT_EOG091G0TA6.clustalo.fasta
    output: per_gene/EOG091G0TA6/EOG091G0TA6.raxml.done
    log: per_gene/EOG091G0TA6/infer_single_ML.stdout.txt, per_gene/EOG091G0TA6/infer_single_ML.stderr.txt
    jobid: 392
    wildcards: BUSCO=EOG091G0TA6
    threads: 2


        cd per_gene/EOG091G0TA6
	count=$(cat ../../per_gene/EOG091G0TA6/ALICUT_EOG091G0TA6.clustalo.fasta | grep ">" | wc -l)
	if [ "$count" -gt 5 ]
        then
		RAxMLmodel=$(cat ../../per_gene/EOG091G0TA6/EOG091G0TA6.best_model | grep "Best" | cut -d ":" -f 2 | tr -d '[:space:]')
                if [ "$(ls -1 | grep "^RAxML" | wc -l)" -ne 0 ]
		then
			rm RAxML*
		fi
        	raxml -f a -T 2 -m PROTGAMMA$RAxMLmodel         	-p 12345 -x 12345 -# 100         	-s ../../per_gene/EOG091G0TA6/ALICUT_EOG091G0TA6.clustalo.fasta -n EOG091G0TA6.clustalo.aln.ALICUT.$RAxMLmodel 		1> ../../per_gene/EOG091G0TA6/infer_single_ML.stdout.txt 2> ../../per_gene/EOG091G0TA6/infer_single_ML.stderr.txt
	else
		echo "fasta file per_gene/EOG091G0TA6/ALICUT_EOG091G0TA6.clustalo.fasta contains fewer than 5 sequences - skipped" > ../../per_gene/EOG091G0TA6/infer_single_ML.stdout.txt
		touch raxml.skipped
	fi
        touch ../../per_gene/EOG091G0TA6/EOG091G0TA6.raxml.done
        
[Mon Jul  6 00:20:04 2020]
Finished job 1350.
2988 of 3292 steps (91%) done

[Mon Jul  6 00:20:04 2020]
rule score_and_cut:
    input: per_gene/EOG091G07S9/EOG091G07S9.clustalo.fasta
    output: per_gene/EOG091G07S9/ALICUT_EOG091G07S9.clustalo.fasta
    jobid: 527
    wildcards: BUSCO=EOG091G07S9
    threads: 2


        cd per_gene/EOG091G07S9
        Aliscore.pl -N -r 200000000000000000 -i ../../per_gene/EOG091G07S9/EOG091G07S9.clustalo.fasta &> aliscore.log
        ALICUT.pl -s &> alicut.log
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/63c88c27a0fa300f57066b0ef65fefcb.simg
[33mJob counts:
	count	jobs
	1	infer_single_ML
	1[0m
[33m
        cd per_gene/EOG091G0TA6
	count=$(cat ../../per_gene/EOG091G0TA6/ALICUT_EOG091G0TA6.clustalo.fasta | grep ">" | wc -l)
	if [ "$count" -gt 5 ]
        then
		RAxMLmodel=$(cat ../../per_gene/EOG091G0TA6/EOG091G0TA6.best_model | grep "Best" | cut -d ":" -f 2 | tr -d '[:space:]')
                if [ "$(ls -1 | grep "^RAxML" | wc -l)" -ne 0 ]
		then
			rm RAxML*
		fi
        	raxml -f a -T 2 -m PROTGAMMA$RAxMLmodel         	-p 12345 -x 12345 -# 100         	-s ../../per_gene/EOG091G0TA6/ALICUT_EOG091G0TA6.clustalo.fasta -n EOG091G0TA6.clustalo.aln.ALICUT.$RAxMLmodel 		1> ../../per_gene/EOG091G0TA6/infer_single_ML.stdout.txt 2> ../../per_gene/EOG091G0TA6/infer_single_ML.stderr.txt
	else
		echo "fasta file per_gene/EOG091G0TA6/ALICUT_EOG091G0TA6.clustalo.fasta contains fewer than 5 sequences - skipped" > ../../per_gene/EOG091G0TA6/infer_single_ML.stdout.txt
		touch raxml.skipped
	fi
        touch ../../per_gene/EOG091G0TA6/EOG091G0TA6.raxml.done
        [0m
[Mon Jul  6 00:20:08 2020]
Finished job 992.
2989 of 3292 steps (91%) done

[Mon Jul  6 00:20:08 2020]
rule infer_single_ML:
    input: per_gene/EOG091G197A/EOG091G197A.best_model, per_gene/EOG091G197A/ALICUT_EOG091G197A.clustalo.fasta
    output: per_gene/EOG091G197A/EOG091G197A.raxml.done
    log: per_gene/EOG091G197A/infer_single_ML.stdout.txt, per_gene/EOG091G197A/infer_single_ML.stderr.txt
    jobid: 290
    wildcards: BUSCO=EOG091G197A
    threads: 2


        cd per_gene/EOG091G197A
	count=$(cat ../../per_gene/EOG091G197A/ALICUT_EOG091G197A.clustalo.fasta | grep ">" | wc -l)
	if [ "$count" -gt 5 ]
        then
		RAxMLmodel=$(cat ../../per_gene/EOG091G197A/EOG091G197A.best_model | grep "Best" | cut -d ":" -f 2 | tr -d '[:space:]')
                if [ "$(ls -1 | grep "^RAxML" | wc -l)" -ne 0 ]
		then
			rm RAxML*
		fi
        	raxml -f a -T 2 -m PROTGAMMA$RAxMLmodel         	-p 12345 -x 12345 -# 100         	-s ../../per_gene/EOG091G197A/ALICUT_EOG091G197A.clustalo.fasta -n EOG091G197A.clustalo.aln.ALICUT.$RAxMLmodel 		1> ../../per_gene/EOG091G197A/infer_single_ML.stdout.txt 2> ../../per_gene/EOG091G197A/infer_single_ML.stderr.txt
	else
		echo "fasta file per_gene/EOG091G197A/ALICUT_EOG091G197A.clustalo.fasta contains fewer than 5 sequences - skipped" > ../../per_gene/EOG091G197A/infer_single_ML.stdout.txt
		touch raxml.skipped
	fi
        touch ../../per_gene/EOG091G197A/EOG091G197A.raxml.done
        
[33mJob counts:
	count	jobs
	1	infer_single_ML
	1[0m
[33m
        cd per_gene/EOG091G197A
	count=$(cat ../../per_gene/EOG091G197A/ALICUT_EOG091G197A.clustalo.fasta | grep ">" | wc -l)
	if [ "$count" -gt 5 ]
        then
		RAxMLmodel=$(cat ../../per_gene/EOG091G197A/EOG091G197A.best_model | grep "Best" | cut -d ":" -f 2 | tr -d '[:space:]')
                if [ "$(ls -1 | grep "^RAxML" | wc -l)" -ne 0 ]
		then
			rm RAxML*
		fi
        	raxml -f a -T 2 -m PROTGAMMA$RAxMLmodel         	-p 12345 -x 12345 -# 100         	-s ../../per_gene/EOG091G197A/ALICUT_EOG091G197A.clustalo.fasta -n EOG091G197A.clustalo.aln.ALICUT.$RAxMLmodel 		1> ../../per_gene/EOG091G197A/infer_single_ML.stdout.txt 2> ../../per_gene/EOG091G197A/infer_single_ML.stderr.txt
	else
		echo "fasta file per_gene/EOG091G197A/ALICUT_EOG091G197A.clustalo.fasta contains fewer than 5 sequences - skipped" > ../../per_gene/EOG091G197A/infer_single_ML.stdout.txt
		touch raxml.skipped
	fi
        touch ../../per_gene/EOG091G197A/EOG091G197A.raxml.done
        [0m
[Mon Jul  6 00:20:14 2020]
Finished job 527.
2990 of 3292 steps (91%) done

[Mon Jul  6 00:20:14 2020]
rule remove_empty:
    input: per_gene/EOG091G07S9/ALICUT_EOG091G07S9.clustalo.fasta
    output: per_gene/EOG091G07S9/empty_check.done
    jobid: 1349
    wildcards: BUSCO=EOG091G07S9


         if [ "$(cat per_gene/EOG091G07S9/ALICUT_EOG091G07S9.clustalo.fasta | grep -v ">" | sed 's/-//g' | grep "^$" | wc -l)" -gt 0 ]
         then
              cp per_gene/EOG091G07S9/ALICUT_EOG091G07S9.clustalo.fasta per_gene/EOG091G07S9/ALICUT_EOG091G07S9.clustalo.fasta.backup
              bash ../scripts/remove_empty.sh per_gene/EOG091G07S9/ALICUT_EOG091G07S9.clustalo.fasta.backup > per_gene/EOG091G07S9/ALICUT_EOG091G07S9.clustalo.fasta
         fi
         touch per_gene/EOG091G07S9/empty_check.done
         
[Mon Jul  6 00:20:15 2020]
Finished job 1349.
2991 of 3292 steps (91%) done

[Mon Jul  6 00:20:15 2020]
rule find_best_model:
    input: per_gene/EOG091G07S9/ALICUT_EOG091G07S9.clustalo.fasta, per_gene/EOG091G07S9/empty_check.done
    output: per_gene/EOG091G07S9/EOG091G07S9.best_model
    log: per_gene/EOG091G07S9/find_best_model.stderr.txt
    jobid: 526
    wildcards: BUSCO=EOG091G07S9
    threads: 2


        cd per_gene/EOG091G07S9
        if [ ! -d find_best_model ]
        then
            mkdir find_best_model
        fi
        cd find_best_model
        ln -s ../../../per_gene/EOG091G07S9/ALICUT_EOG091G07S9.clustalo.fasta EOG091G07S9.fasta
        ProteinModelSelection.pl EOG091G07S9.fasta 1> ../../../per_gene/EOG091G07S9/EOG091G07S9.best_model 2> ../../../per_gene/EOG091G07S9/find_best_model.stderr.txt
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/c0c09ee657b1e27f2c5687e0e9aa8d70.simg
[Mon Jul  6 00:20:37 2020]
Finished job 94.
2992 of 3292 steps (91%) done

[Mon Jul  6 00:20:37 2020]
rule get_seqs:
    input: /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ingroup.txt, /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/outgroup.txt
    output: per_gene/EOG091G0W6G/EOG091G0W6G.ingroup.fasta
    log: per_gene/EOG091G0W6G/get_seqs.stdout.txt, per_gene/EOG091G0W6G/get_seqs.stderr.txt
    jobid: 2884
    wildcards: BUSCO=EOG091G0W6G
    threads: 2


	basedir=$(pwd)
        cd per_gene/EOG091G0W6G
        
        bash $basedir/../scripts/fetch_seqs.sh EOG091G0W6G /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ingroup.txt /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/outgroup.txt 1> ../../per_gene/EOG091G0W6G/get_seqs.stdout.txt 2> ../../per_gene/EOG091G0W6G/get_seqs.stderr.txt
	mv EOG091G0W6G.fasta $basedir/per_gene/EOG091G0W6G/EOG091G0W6G.ingroup.fasta
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/72476f9d9a5bd0627b4d721143a21354.simg
[Mon Jul  6 00:20:43 2020]
Finished job 43.
2993 of 3292 steps (91%) done

[Mon Jul  6 00:20:43 2020]
rule get_seqs:
    input: /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ingroup.txt, /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/outgroup.txt
    output: per_gene/EOG091G0MDT/EOG091G0MDT.ingroup.fasta
    log: per_gene/EOG091G0MDT/get_seqs.stdout.txt, per_gene/EOG091G0MDT/get_seqs.stderr.txt
    jobid: 2764
    wildcards: BUSCO=EOG091G0MDT
    threads: 2


	basedir=$(pwd)
        cd per_gene/EOG091G0MDT
        
        bash $basedir/../scripts/fetch_seqs.sh EOG091G0MDT /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ingroup.txt /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/outgroup.txt 1> ../../per_gene/EOG091G0MDT/get_seqs.stdout.txt 2> ../../per_gene/EOG091G0MDT/get_seqs.stderr.txt
	mv EOG091G0MDT.fasta $basedir/per_gene/EOG091G0MDT/EOG091G0MDT.ingroup.fasta
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/72476f9d9a5bd0627b4d721143a21354.simg
[Mon Jul  6 00:20:44 2020]
Finished job 135.
2994 of 3292 steps (91%) done

[Mon Jul  6 00:20:44 2020]
rule get_seqs:
    input: /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ingroup.txt, /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/outgroup.txt
    output: per_gene/EOG091G0TNU/EOG091G0TNU.ingroup.fasta
    log: per_gene/EOG091G0TNU/get_seqs.stdout.txt, per_gene/EOG091G0TNU/get_seqs.stderr.txt
    jobid: 2852
    wildcards: BUSCO=EOG091G0TNU
    threads: 2


	basedir=$(pwd)
        cd per_gene/EOG091G0TNU
        
        bash $basedir/../scripts/fetch_seqs.sh EOG091G0TNU /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ingroup.txt /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/outgroup.txt 1> ../../per_gene/EOG091G0TNU/get_seqs.stdout.txt 2> ../../per_gene/EOG091G0TNU/get_seqs.stderr.txt
	mv EOG091G0TNU.fasta $basedir/per_gene/EOG091G0TNU/EOG091G0TNU.ingroup.fasta
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/72476f9d9a5bd0627b4d721143a21354.simg
[Mon Jul  6 00:20:49 2020]
Finished job 20.
2995 of 3292 steps (91%) done

[Mon Jul  6 00:20:49 2020]
rule get_seqs:
    input: /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ingroup.txt, /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/outgroup.txt
    output: per_gene/EOG091G0SQV/EOG091G0SQV.ingroup.fasta
    log: per_gene/EOG091G0SQV/get_seqs.stdout.txt, per_gene/EOG091G0SQV/get_seqs.stderr.txt
    jobid: 3282
    wildcards: BUSCO=EOG091G0SQV
    threads: 2


	basedir=$(pwd)
        cd per_gene/EOG091G0SQV
        
        bash $basedir/../scripts/fetch_seqs.sh EOG091G0SQV /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ingroup.txt /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/outgroup.txt 1> ../../per_gene/EOG091G0SQV/get_seqs.stdout.txt 2> ../../per_gene/EOG091G0SQV/get_seqs.stderr.txt
	mv EOG091G0SQV.fasta $basedir/per_gene/EOG091G0SQV/EOG091G0SQV.ingroup.fasta
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/72476f9d9a5bd0627b4d721143a21354.simg
[Mon Jul  6 00:20:54 2020]
Finished job 294.
2996 of 3292 steps (91%) done

[Mon Jul  6 00:20:54 2020]
rule get_seqs:
    input: /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ingroup.txt, /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/outgroup.txt
    output: per_gene/EOG091G03ZS/EOG091G03ZS.ingroup.fasta
    log: per_gene/EOG091G03ZS/get_seqs.stdout.txt, per_gene/EOG091G03ZS/get_seqs.stderr.txt
    jobid: 3058
    wildcards: BUSCO=EOG091G03ZS
    threads: 2


	basedir=$(pwd)
        cd per_gene/EOG091G03ZS
        
        bash $basedir/../scripts/fetch_seqs.sh EOG091G03ZS /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ingroup.txt /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/outgroup.txt 1> ../../per_gene/EOG091G03ZS/get_seqs.stdout.txt 2> ../../per_gene/EOG091G03ZS/get_seqs.stderr.txt
	mv EOG091G03ZS.fasta $basedir/per_gene/EOG091G03ZS/EOG091G03ZS.ingroup.fasta
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/72476f9d9a5bd0627b4d721143a21354.simg
[Mon Jul  6 00:20:58 2020]
Finished job 2884.
2997 of 3292 steps (91%) done

[Mon Jul  6 00:20:58 2020]
rule get_outgroups:
    input: per_gene/EOG091G0W6G/EOG091G0W6G.ingroup.fasta
    output: per_gene/EOG091G0W6G/EOG091G0W6G.orthodb.fasta, per_gene/EOG091G0W6G/EOG091G0W6G.outgroup.fasta
    log: per_gene/EOG091G0W6G/get_outgroups.stdout.txt, per_gene/EOG091G0W6G/get_outgroups.stderr.txt
    jobid: 2885
    wildcards: BUSCO=EOG091G0W6G


        #download fastas from Orhtodb for BUSCO id
        for i in {1..5}
        do
             wget "http://www.orthodb.org/fasta?query=EOG091G0W6G&level=33208" -O per_gene/EOG091G0W6G/EOG091G0W6G.orthodb.fasta 1> per_gene/EOG091G0W6G/get_outgroups.stdout.txt 2> per_gene/EOG091G0W6G/get_outgroups.stderr.txt && break || echo -e "try again ($i)" && sleep 15
        done

	#This is quick an dirty for now and just takes the first protein if there is more than one for an outgroup taxon
        bash ../scripts/download_outgroups.sh taxids.txt per_gene/EOG091G0W6G/EOG091G0W6G.orthodb.fasta > per_gene/EOG091G0W6G/EOG091G0W6G.outgroup.fasta
        
[Mon Jul  6 00:20:59 2020]
Finished job 2885.
2998 of 3292 steps (91%) done

[Mon Jul  6 00:20:59 2020]
rule join_groups:
    input: per_gene/EOG091G0W6G/EOG091G0W6G.ingroup.fasta, per_gene/EOG091G0W6G/EOG091G0W6G.outgroup.fasta
    output: per_gene/EOG091G0W6G/EOG091G0W6G.fasta
    jobid: 2266
    wildcards: BUSCO=EOG091G0W6G


        cat per_gene/EOG091G0W6G/EOG091G0W6G.ingroup.fasta per_gene/EOG091G0W6G/EOG091G0W6G.outgroup.fasta > per_gene/EOG091G0W6G/EOG091G0W6G.fasta
        
[Mon Jul  6 00:20:59 2020]
Finished job 2266.
2999 of 3292 steps (91%) done

[Mon Jul  6 00:20:59 2020]
rule MSA:
    input: per_gene/EOG091G0W6G/EOG091G0W6G.fasta
    output: per_gene/EOG091G0W6G/EOG091G0W6G.clustalo.fasta
    log: per_gene/EOG091G0W6G/MSA.stdout.txt, per_gene/EOG091G0W6G/MSA.stderr.txt
    jobid: 1652
    wildcards: BUSCO=EOG091G0W6G
    threads: 2


        clustalo -i per_gene/EOG091G0W6G/EOG091G0W6G.fasta -o per_gene/EOG091G0W6G/EOG091G0W6G.clustalo.fasta --threads=2 1> per_gene/EOG091G0W6G/MSA.stdout.txt 2> per_gene/EOG091G0W6G/MSA.stderr.txt
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/d68c9691725a7401923680874285c430.simg
[Mon Jul  6 00:21:00 2020]
Finished job 1652.
3000 of 3292 steps (91%) done

[Mon Jul  6 00:21:00 2020]
rule score_and_cut:
    input: per_gene/EOG091G0W6G/EOG091G0W6G.clustalo.fasta
    output: per_gene/EOG091G0W6G/ALICUT_EOG091G0W6G.clustalo.fasta
    jobid: 829
    wildcards: BUSCO=EOG091G0W6G
    threads: 2


        cd per_gene/EOG091G0W6G
        Aliscore.pl -N -r 200000000000000000 -i ../../per_gene/EOG091G0W6G/EOG091G0W6G.clustalo.fasta &> aliscore.log
        ALICUT.pl -s &> alicut.log
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/63c88c27a0fa300f57066b0ef65fefcb.simg
[Mon Jul  6 00:21:02 2020]
Finished job 2764.
3001 of 3292 steps (91%) done

[Mon Jul  6 00:21:02 2020]
rule get_outgroups:
    input: per_gene/EOG091G0MDT/EOG091G0MDT.ingroup.fasta
    output: per_gene/EOG091G0MDT/EOG091G0MDT.orthodb.fasta, per_gene/EOG091G0MDT/EOG091G0MDT.outgroup.fasta
    log: per_gene/EOG091G0MDT/get_outgroups.stdout.txt, per_gene/EOG091G0MDT/get_outgroups.stderr.txt
    jobid: 2765
    wildcards: BUSCO=EOG091G0MDT


        #download fastas from Orhtodb for BUSCO id
        for i in {1..5}
        do
             wget "http://www.orthodb.org/fasta?query=EOG091G0MDT&level=33208" -O per_gene/EOG091G0MDT/EOG091G0MDT.orthodb.fasta 1> per_gene/EOG091G0MDT/get_outgroups.stdout.txt 2> per_gene/EOG091G0MDT/get_outgroups.stderr.txt && break || echo -e "try again ($i)" && sleep 15
        done

	#This is quick an dirty for now and just takes the first protein if there is more than one for an outgroup taxon
        bash ../scripts/download_outgroups.sh taxids.txt per_gene/EOG091G0MDT/EOG091G0MDT.orthodb.fasta > per_gene/EOG091G0MDT/EOG091G0MDT.outgroup.fasta
        
[Mon Jul  6 00:21:04 2020]
Finished job 2765.
3002 of 3292 steps (91%) done

[Mon Jul  6 00:21:04 2020]
rule join_groups:
    input: per_gene/EOG091G0MDT/EOG091G0MDT.ingroup.fasta, per_gene/EOG091G0MDT/EOG091G0MDT.outgroup.fasta
    output: per_gene/EOG091G0MDT/EOG091G0MDT.fasta
    jobid: 2206
    wildcards: BUSCO=EOG091G0MDT


        cat per_gene/EOG091G0MDT/EOG091G0MDT.ingroup.fasta per_gene/EOG091G0MDT/EOG091G0MDT.outgroup.fasta > per_gene/EOG091G0MDT/EOG091G0MDT.fasta
        
[Mon Jul  6 00:21:04 2020]
Finished job 2206.
3003 of 3292 steps (91%) done

[Mon Jul  6 00:21:04 2020]
rule MSA:
    input: per_gene/EOG091G0MDT/EOG091G0MDT.fasta
    output: per_gene/EOG091G0MDT/EOG091G0MDT.clustalo.fasta
    log: per_gene/EOG091G0MDT/MSA.stdout.txt, per_gene/EOG091G0MDT/MSA.stderr.txt
    jobid: 1532
    wildcards: BUSCO=EOG091G0MDT
    threads: 2


        clustalo -i per_gene/EOG091G0MDT/EOG091G0MDT.fasta -o per_gene/EOG091G0MDT/EOG091G0MDT.clustalo.fasta --threads=2 1> per_gene/EOG091G0MDT/MSA.stdout.txt 2> per_gene/EOG091G0MDT/MSA.stderr.txt
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/d68c9691725a7401923680874285c430.simg
[Mon Jul  6 00:21:04 2020]
Finished job 526.
3004 of 3292 steps (91%) done

[Mon Jul  6 00:21:04 2020]
rule infer_single_ML:
    input: per_gene/EOG091G07S9/EOG091G07S9.best_model, per_gene/EOG091G07S9/ALICUT_EOG091G07S9.clustalo.fasta
    output: per_gene/EOG091G07S9/EOG091G07S9.raxml.done
    log: per_gene/EOG091G07S9/infer_single_ML.stdout.txt, per_gene/EOG091G07S9/infer_single_ML.stderr.txt
    jobid: 57
    wildcards: BUSCO=EOG091G07S9
    threads: 2


        cd per_gene/EOG091G07S9
	count=$(cat ../../per_gene/EOG091G07S9/ALICUT_EOG091G07S9.clustalo.fasta | grep ">" | wc -l)
	if [ "$count" -gt 5 ]
        then
		RAxMLmodel=$(cat ../../per_gene/EOG091G07S9/EOG091G07S9.best_model | grep "Best" | cut -d ":" -f 2 | tr -d '[:space:]')
                if [ "$(ls -1 | grep "^RAxML" | wc -l)" -ne 0 ]
		then
			rm RAxML*
		fi
        	raxml -f a -T 2 -m PROTGAMMA$RAxMLmodel         	-p 12345 -x 12345 -# 100         	-s ../../per_gene/EOG091G07S9/ALICUT_EOG091G07S9.clustalo.fasta -n EOG091G07S9.clustalo.aln.ALICUT.$RAxMLmodel 		1> ../../per_gene/EOG091G07S9/infer_single_ML.stdout.txt 2> ../../per_gene/EOG091G07S9/infer_single_ML.stderr.txt
	else
		echo "fasta file per_gene/EOG091G07S9/ALICUT_EOG091G07S9.clustalo.fasta contains fewer than 5 sequences - skipped" > ../../per_gene/EOG091G07S9/infer_single_ML.stdout.txt
		touch raxml.skipped
	fi
        touch ../../per_gene/EOG091G07S9/EOG091G07S9.raxml.done
        
[Mon Jul  6 00:21:04 2020]
Finished job 1532.
3005 of 3292 steps (91%) done

[Mon Jul  6 00:21:04 2020]
rule score_and_cut:
    input: per_gene/EOG091G0MDT/EOG091G0MDT.clustalo.fasta
    output: per_gene/EOG091G0MDT/ALICUT_EOG091G0MDT.clustalo.fasta
    jobid: 709
    wildcards: BUSCO=EOG091G0MDT
    threads: 2


        cd per_gene/EOG091G0MDT
        Aliscore.pl -N -r 200000000000000000 -i ../../per_gene/EOG091G0MDT/EOG091G0MDT.clustalo.fasta &> aliscore.log
        ALICUT.pl -s &> alicut.log
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/63c88c27a0fa300f57066b0ef65fefcb.simg
[Mon Jul  6 00:21:04 2020]
Finished job 2852.
3006 of 3292 steps (91%) done

[Mon Jul  6 00:21:04 2020]
rule get_outgroups:
    input: per_gene/EOG091G0TNU/EOG091G0TNU.ingroup.fasta
    output: per_gene/EOG091G0TNU/EOG091G0TNU.orthodb.fasta, per_gene/EOG091G0TNU/EOG091G0TNU.outgroup.fasta
    log: per_gene/EOG091G0TNU/get_outgroups.stdout.txt, per_gene/EOG091G0TNU/get_outgroups.stderr.txt
    jobid: 2853
    wildcards: BUSCO=EOG091G0TNU


        #download fastas from Orhtodb for BUSCO id
        for i in {1..5}
        do
             wget "http://www.orthodb.org/fasta?query=EOG091G0TNU&level=33208" -O per_gene/EOG091G0TNU/EOG091G0TNU.orthodb.fasta 1> per_gene/EOG091G0TNU/get_outgroups.stdout.txt 2> per_gene/EOG091G0TNU/get_outgroups.stderr.txt && break || echo -e "try again ($i)" && sleep 15
        done

	#This is quick an dirty for now and just takes the first protein if there is more than one for an outgroup taxon
        bash ../scripts/download_outgroups.sh taxids.txt per_gene/EOG091G0TNU/EOG091G0TNU.orthodb.fasta > per_gene/EOG091G0TNU/EOG091G0TNU.outgroup.fasta
        
[33mJob counts:
	count	jobs
	1	infer_single_ML
	1[0m
[33m
        cd per_gene/EOG091G07S9
	count=$(cat ../../per_gene/EOG091G07S9/ALICUT_EOG091G07S9.clustalo.fasta | grep ">" | wc -l)
	if [ "$count" -gt 5 ]
        then
		RAxMLmodel=$(cat ../../per_gene/EOG091G07S9/EOG091G07S9.best_model | grep "Best" | cut -d ":" -f 2 | tr -d '[:space:]')
                if [ "$(ls -1 | grep "^RAxML" | wc -l)" -ne 0 ]
		then
			rm RAxML*
		fi
        	raxml -f a -T 2 -m PROTGAMMA$RAxMLmodel         	-p 12345 -x 12345 -# 100         	-s ../../per_gene/EOG091G07S9/ALICUT_EOG091G07S9.clustalo.fasta -n EOG091G07S9.clustalo.aln.ALICUT.$RAxMLmodel 		1> ../../per_gene/EOG091G07S9/infer_single_ML.stdout.txt 2> ../../per_gene/EOG091G07S9/infer_single_ML.stderr.txt
	else
		echo "fasta file per_gene/EOG091G07S9/ALICUT_EOG091G07S9.clustalo.fasta contains fewer than 5 sequences - skipped" > ../../per_gene/EOG091G07S9/infer_single_ML.stdout.txt
		touch raxml.skipped
	fi
        touch ../../per_gene/EOG091G07S9/EOG091G07S9.raxml.done
        [0m
[Mon Jul  6 00:21:05 2020]
Finished job 2853.
3007 of 3292 steps (91%) done

[Mon Jul  6 00:21:05 2020]
rule join_groups:
    input: per_gene/EOG091G0TNU/EOG091G0TNU.ingroup.fasta, per_gene/EOG091G0TNU/EOG091G0TNU.outgroup.fasta
    output: per_gene/EOG091G0TNU/EOG091G0TNU.fasta
    jobid: 2250
    wildcards: BUSCO=EOG091G0TNU


        cat per_gene/EOG091G0TNU/EOG091G0TNU.ingroup.fasta per_gene/EOG091G0TNU/EOG091G0TNU.outgroup.fasta > per_gene/EOG091G0TNU/EOG091G0TNU.fasta
        
[Mon Jul  6 00:21:05 2020]
Finished job 2250.
3008 of 3292 steps (91%) done

[Mon Jul  6 00:21:05 2020]
rule MSA:
    input: per_gene/EOG091G0TNU/EOG091G0TNU.fasta
    output: per_gene/EOG091G0TNU/EOG091G0TNU.clustalo.fasta
    log: per_gene/EOG091G0TNU/MSA.stdout.txt, per_gene/EOG091G0TNU/MSA.stderr.txt
    jobid: 1620
    wildcards: BUSCO=EOG091G0TNU
    threads: 2


        clustalo -i per_gene/EOG091G0TNU/EOG091G0TNU.fasta -o per_gene/EOG091G0TNU/EOG091G0TNU.clustalo.fasta --threads=2 1> per_gene/EOG091G0TNU/MSA.stdout.txt 2> per_gene/EOG091G0TNU/MSA.stderr.txt
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/d68c9691725a7401923680874285c430.simg
[Mon Jul  6 00:21:06 2020]
Finished job 1620.
3009 of 3292 steps (91%) done

[Mon Jul  6 00:21:06 2020]
rule score_and_cut:
    input: per_gene/EOG091G0TNU/EOG091G0TNU.clustalo.fasta
    output: per_gene/EOG091G0TNU/ALICUT_EOG091G0TNU.clustalo.fasta
    jobid: 797
    wildcards: BUSCO=EOG091G0TNU
    threads: 2


        cd per_gene/EOG091G0TNU
        Aliscore.pl -N -r 200000000000000000 -i ../../per_gene/EOG091G0TNU/EOG091G0TNU.clustalo.fasta &> aliscore.log
        ALICUT.pl -s &> alicut.log
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/63c88c27a0fa300f57066b0ef65fefcb.simg
[Mon Jul  6 00:21:08 2020]
Finished job 829.
3010 of 3292 steps (91%) done

[Mon Jul  6 00:21:08 2020]
rule remove_empty:
    input: per_gene/EOG091G0W6G/ALICUT_EOG091G0W6G.clustalo.fasta
    output: per_gene/EOG091G0W6G/empty_check.done
    jobid: 1651
    wildcards: BUSCO=EOG091G0W6G


         if [ "$(cat per_gene/EOG091G0W6G/ALICUT_EOG091G0W6G.clustalo.fasta | grep -v ">" | sed 's/-//g' | grep "^$" | wc -l)" -gt 0 ]
         then
              cp per_gene/EOG091G0W6G/ALICUT_EOG091G0W6G.clustalo.fasta per_gene/EOG091G0W6G/ALICUT_EOG091G0W6G.clustalo.fasta.backup
              bash ../scripts/remove_empty.sh per_gene/EOG091G0W6G/ALICUT_EOG091G0W6G.clustalo.fasta.backup > per_gene/EOG091G0W6G/ALICUT_EOG091G0W6G.clustalo.fasta
         fi
         touch per_gene/EOG091G0W6G/empty_check.done
         
[Mon Jul  6 00:21:08 2020]
Finished job 1651.
3011 of 3292 steps (91%) done

[Mon Jul  6 00:21:08 2020]
rule find_best_model:
    input: per_gene/EOG091G0W6G/ALICUT_EOG091G0W6G.clustalo.fasta, per_gene/EOG091G0W6G/empty_check.done
    output: per_gene/EOG091G0W6G/EOG091G0W6G.best_model
    log: per_gene/EOG091G0W6G/find_best_model.stderr.txt
    jobid: 828
    wildcards: BUSCO=EOG091G0W6G
    threads: 2


        cd per_gene/EOG091G0W6G
        if [ ! -d find_best_model ]
        then
            mkdir find_best_model
        fi
        cd find_best_model
        ln -s ../../../per_gene/EOG091G0W6G/ALICUT_EOG091G0W6G.clustalo.fasta EOG091G0W6G.fasta
        ProteinModelSelection.pl EOG091G0W6G.fasta 1> ../../../per_gene/EOG091G0W6G/EOG091G0W6G.best_model 2> ../../../per_gene/EOG091G0W6G/find_best_model.stderr.txt
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/c0c09ee657b1e27f2c5687e0e9aa8d70.simg
[Mon Jul  6 00:21:08 2020]
Finished job 3282.
3012 of 3292 steps (91%) done

[Mon Jul  6 00:21:08 2020]
rule get_outgroups:
    input: per_gene/EOG091G0SQV/EOG091G0SQV.ingroup.fasta
    output: per_gene/EOG091G0SQV/EOG091G0SQV.orthodb.fasta, per_gene/EOG091G0SQV/EOG091G0SQV.outgroup.fasta
    log: per_gene/EOG091G0SQV/get_outgroups.stdout.txt, per_gene/EOG091G0SQV/get_outgroups.stderr.txt
    jobid: 3283
    wildcards: BUSCO=EOG091G0SQV


        #download fastas from Orhtodb for BUSCO id
        for i in {1..5}
        do
             wget "http://www.orthodb.org/fasta?query=EOG091G0SQV&level=33208" -O per_gene/EOG091G0SQV/EOG091G0SQV.orthodb.fasta 1> per_gene/EOG091G0SQV/get_outgroups.stdout.txt 2> per_gene/EOG091G0SQV/get_outgroups.stderr.txt && break || echo -e "try again ($i)" && sleep 15
        done

	#This is quick an dirty for now and just takes the first protein if there is more than one for an outgroup taxon
        bash ../scripts/download_outgroups.sh taxids.txt per_gene/EOG091G0SQV/EOG091G0SQV.orthodb.fasta > per_gene/EOG091G0SQV/EOG091G0SQV.outgroup.fasta
        
[Mon Jul  6 00:21:10 2020]
Finished job 3283.
3013 of 3292 steps (92%) done

[Mon Jul  6 00:21:10 2020]
rule join_groups:
    input: per_gene/EOG091G0SQV/EOG091G0SQV.ingroup.fasta, per_gene/EOG091G0SQV/EOG091G0SQV.outgroup.fasta
    output: per_gene/EOG091G0SQV/EOG091G0SQV.fasta
    jobid: 2465
    wildcards: BUSCO=EOG091G0SQV


        cat per_gene/EOG091G0SQV/EOG091G0SQV.ingroup.fasta per_gene/EOG091G0SQV/EOG091G0SQV.outgroup.fasta > per_gene/EOG091G0SQV/EOG091G0SQV.fasta
        
[Mon Jul  6 00:21:10 2020]
Finished job 2465.
3014 of 3292 steps (92%) done

[Mon Jul  6 00:21:10 2020]
rule MSA:
    input: per_gene/EOG091G0SQV/EOG091G0SQV.fasta
    output: per_gene/EOG091G0SQV/EOG091G0SQV.clustalo.fasta
    log: per_gene/EOG091G0SQV/MSA.stdout.txt, per_gene/EOG091G0SQV/MSA.stderr.txt
    jobid: 2050
    wildcards: BUSCO=EOG091G0SQV
    threads: 2


        clustalo -i per_gene/EOG091G0SQV/EOG091G0SQV.fasta -o per_gene/EOG091G0SQV/EOG091G0SQV.clustalo.fasta --threads=2 1> per_gene/EOG091G0SQV/MSA.stdout.txt 2> per_gene/EOG091G0SQV/MSA.stderr.txt
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/d68c9691725a7401923680874285c430.simg
[Mon Jul  6 00:21:10 2020]
Finished job 2050.
3015 of 3292 steps (92%) done

[Mon Jul  6 00:21:10 2020]
rule score_and_cut:
    input: per_gene/EOG091G0SQV/EOG091G0SQV.clustalo.fasta
    output: per_gene/EOG091G0SQV/ALICUT_EOG091G0SQV.clustalo.fasta
    jobid: 1227
    wildcards: BUSCO=EOG091G0SQV
    threads: 2


        cd per_gene/EOG091G0SQV
        Aliscore.pl -N -r 200000000000000000 -i ../../per_gene/EOG091G0SQV/EOG091G0SQV.clustalo.fasta &> aliscore.log
        ALICUT.pl -s &> alicut.log
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/63c88c27a0fa300f57066b0ef65fefcb.simg
[Mon Jul  6 00:21:13 2020]
Finished job 3058.
3016 of 3292 steps (92%) done

[Mon Jul  6 00:21:13 2020]
rule get_outgroups:
    input: per_gene/EOG091G03ZS/EOG091G03ZS.ingroup.fasta
    output: per_gene/EOG091G03ZS/EOG091G03ZS.orthodb.fasta, per_gene/EOG091G03ZS/EOG091G03ZS.outgroup.fasta
    log: per_gene/EOG091G03ZS/get_outgroups.stdout.txt, per_gene/EOG091G03ZS/get_outgroups.stderr.txt
    jobid: 3059
    wildcards: BUSCO=EOG091G03ZS


        #download fastas from Orhtodb for BUSCO id
        for i in {1..5}
        do
             wget "http://www.orthodb.org/fasta?query=EOG091G03ZS&level=33208" -O per_gene/EOG091G03ZS/EOG091G03ZS.orthodb.fasta 1> per_gene/EOG091G03ZS/get_outgroups.stdout.txt 2> per_gene/EOG091G03ZS/get_outgroups.stderr.txt && break || echo -e "try again ($i)" && sleep 15
        done

	#This is quick an dirty for now and just takes the first protein if there is more than one for an outgroup taxon
        bash ../scripts/download_outgroups.sh taxids.txt per_gene/EOG091G03ZS/EOG091G03ZS.orthodb.fasta > per_gene/EOG091G03ZS/EOG091G03ZS.outgroup.fasta
        
[Mon Jul  6 00:21:13 2020]
Finished job 709.
3017 of 3292 steps (92%) done

[Mon Jul  6 00:21:13 2020]
rule remove_empty:
    input: per_gene/EOG091G0MDT/ALICUT_EOG091G0MDT.clustalo.fasta
    output: per_gene/EOG091G0MDT/empty_check.done
    jobid: 1531
    wildcards: BUSCO=EOG091G0MDT


         if [ "$(cat per_gene/EOG091G0MDT/ALICUT_EOG091G0MDT.clustalo.fasta | grep -v ">" | sed 's/-//g' | grep "^$" | wc -l)" -gt 0 ]
         then
              cp per_gene/EOG091G0MDT/ALICUT_EOG091G0MDT.clustalo.fasta per_gene/EOG091G0MDT/ALICUT_EOG091G0MDT.clustalo.fasta.backup
              bash ../scripts/remove_empty.sh per_gene/EOG091G0MDT/ALICUT_EOG091G0MDT.clustalo.fasta.backup > per_gene/EOG091G0MDT/ALICUT_EOG091G0MDT.clustalo.fasta
         fi
         touch per_gene/EOG091G0MDT/empty_check.done
         

[Mon Jul  6 00:21:13 2020]
rule get_seqs:
    input: /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ingroup.txt, /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/outgroup.txt
    output: per_gene/EOG091G0H62/EOG091G0H62.ingroup.fasta
    log: per_gene/EOG091G0H62/get_seqs.stdout.txt, per_gene/EOG091G0H62/get_seqs.stderr.txt
    jobid: 2700
    wildcards: BUSCO=EOG091G0H62
    threads: 2


	basedir=$(pwd)
        cd per_gene/EOG091G0H62
        
        bash $basedir/../scripts/fetch_seqs.sh EOG091G0H62 /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ingroup.txt /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/outgroup.txt 1> ../../per_gene/EOG091G0H62/get_seqs.stdout.txt 2> ../../per_gene/EOG091G0H62/get_seqs.stderr.txt
	mv EOG091G0H62.fasta $basedir/per_gene/EOG091G0H62/EOG091G0H62.ingroup.fasta
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/72476f9d9a5bd0627b4d721143a21354.simg
[Mon Jul  6 00:21:13 2020]
Finished job 1531.
3018 of 3292 steps (92%) done
[Mon Jul  6 00:21:14 2020]
Finished job 3059.
3019 of 3292 steps (92%) done

[Mon Jul  6 00:21:14 2020]
rule join_groups:
    input: per_gene/EOG091G03ZS/EOG091G03ZS.ingroup.fasta, per_gene/EOG091G03ZS/EOG091G03ZS.outgroup.fasta
    output: per_gene/EOG091G03ZS/EOG091G03ZS.fasta
    jobid: 2353
    wildcards: BUSCO=EOG091G03ZS


        cat per_gene/EOG091G03ZS/EOG091G03ZS.ingroup.fasta per_gene/EOG091G03ZS/EOG091G03ZS.outgroup.fasta > per_gene/EOG091G03ZS/EOG091G03ZS.fasta
        
[Mon Jul  6 00:21:14 2020]
Finished job 2353.
3020 of 3292 steps (92%) done

[Mon Jul  6 00:21:14 2020]
rule MSA:
    input: per_gene/EOG091G03ZS/EOG091G03ZS.fasta
    output: per_gene/EOG091G03ZS/EOG091G03ZS.clustalo.fasta
    log: per_gene/EOG091G03ZS/MSA.stdout.txt, per_gene/EOG091G03ZS/MSA.stderr.txt
    jobid: 1826
    wildcards: BUSCO=EOG091G03ZS
    threads: 2


        clustalo -i per_gene/EOG091G03ZS/EOG091G03ZS.fasta -o per_gene/EOG091G03ZS/EOG091G03ZS.clustalo.fasta --threads=2 1> per_gene/EOG091G03ZS/MSA.stdout.txt 2> per_gene/EOG091G03ZS/MSA.stderr.txt
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/d68c9691725a7401923680874285c430.simg
[Mon Jul  6 00:21:16 2020]
Finished job 797.
3021 of 3292 steps (92%) done

[Mon Jul  6 00:21:16 2020]
rule find_best_model:
    input: per_gene/EOG091G0MDT/ALICUT_EOG091G0MDT.clustalo.fasta, per_gene/EOG091G0MDT/empty_check.done
    output: per_gene/EOG091G0MDT/EOG091G0MDT.best_model
    log: per_gene/EOG091G0MDT/find_best_model.stderr.txt
    jobid: 708
    wildcards: BUSCO=EOG091G0MDT
    threads: 2


        cd per_gene/EOG091G0MDT
        if [ ! -d find_best_model ]
        then
            mkdir find_best_model
        fi
        cd find_best_model
        ln -s ../../../per_gene/EOG091G0MDT/ALICUT_EOG091G0MDT.clustalo.fasta EOG091G0MDT.fasta
        ProteinModelSelection.pl EOG091G0MDT.fasta 1> ../../../per_gene/EOG091G0MDT/EOG091G0MDT.best_model 2> ../../../per_gene/EOG091G0MDT/find_best_model.stderr.txt
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/c0c09ee657b1e27f2c5687e0e9aa8d70.simg
[Mon Jul  6 00:21:16 2020]
Finished job 1826.
3022 of 3292 steps (92%) done

[Mon Jul  6 00:21:16 2020]
rule score_and_cut:
    input: per_gene/EOG091G03ZS/EOG091G03ZS.clustalo.fasta
    output: per_gene/EOG091G03ZS/ALICUT_EOG091G03ZS.clustalo.fasta
    jobid: 1003
    wildcards: BUSCO=EOG091G03ZS
    threads: 2


        cd per_gene/EOG091G03ZS
        Aliscore.pl -N -r 200000000000000000 -i ../../per_gene/EOG091G03ZS/EOG091G03ZS.clustalo.fasta &> aliscore.log
        ALICUT.pl -s &> alicut.log
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/63c88c27a0fa300f57066b0ef65fefcb.simg
[Mon Jul  6 00:21:20 2020]
Finished job 1227.
3023 of 3292 steps (92%) done

[Mon Jul  6 00:21:20 2020]
rule remove_empty:
    input: per_gene/EOG091G0SQV/ALICUT_EOG091G0SQV.clustalo.fasta
    output: per_gene/EOG091G0SQV/empty_check.done
    jobid: 2049
    wildcards: BUSCO=EOG091G0SQV


         if [ "$(cat per_gene/EOG091G0SQV/ALICUT_EOG091G0SQV.clustalo.fasta | grep -v ">" | sed 's/-//g' | grep "^$" | wc -l)" -gt 0 ]
         then
              cp per_gene/EOG091G0SQV/ALICUT_EOG091G0SQV.clustalo.fasta per_gene/EOG091G0SQV/ALICUT_EOG091G0SQV.clustalo.fasta.backup
              bash ../scripts/remove_empty.sh per_gene/EOG091G0SQV/ALICUT_EOG091G0SQV.clustalo.fasta.backup > per_gene/EOG091G0SQV/ALICUT_EOG091G0SQV.clustalo.fasta
         fi
         touch per_gene/EOG091G0SQV/empty_check.done
         

[Mon Jul  6 00:21:20 2020]
rule remove_empty:
    input: per_gene/EOG091G0TNU/ALICUT_EOG091G0TNU.clustalo.fasta
    output: per_gene/EOG091G0TNU/empty_check.done
    jobid: 1619
    wildcards: BUSCO=EOG091G0TNU


         if [ "$(cat per_gene/EOG091G0TNU/ALICUT_EOG091G0TNU.clustalo.fasta | grep -v ">" | sed 's/-//g' | grep "^$" | wc -l)" -gt 0 ]
         then
              cp per_gene/EOG091G0TNU/ALICUT_EOG091G0TNU.clustalo.fasta per_gene/EOG091G0TNU/ALICUT_EOG091G0TNU.clustalo.fasta.backup
              bash ../scripts/remove_empty.sh per_gene/EOG091G0TNU/ALICUT_EOG091G0TNU.clustalo.fasta.backup > per_gene/EOG091G0TNU/ALICUT_EOG091G0TNU.clustalo.fasta
         fi
         touch per_gene/EOG091G0TNU/empty_check.done
         
[Mon Jul  6 00:21:20 2020]
Finished job 2049.
3024 of 3292 steps (92%) done
[Mon Jul  6 00:21:20 2020]
Finished job 1619.
3025 of 3292 steps (92%) done

[Mon Jul  6 00:21:20 2020]
rule find_best_model:
    input: per_gene/EOG091G0TNU/ALICUT_EOG091G0TNU.clustalo.fasta, per_gene/EOG091G0TNU/empty_check.done
    output: per_gene/EOG091G0TNU/EOG091G0TNU.best_model
    log: per_gene/EOG091G0TNU/find_best_model.stderr.txt
    jobid: 796
    wildcards: BUSCO=EOG091G0TNU
    threads: 2


        cd per_gene/EOG091G0TNU
        if [ ! -d find_best_model ]
        then
            mkdir find_best_model
        fi
        cd find_best_model
        ln -s ../../../per_gene/EOG091G0TNU/ALICUT_EOG091G0TNU.clustalo.fasta EOG091G0TNU.fasta
        ProteinModelSelection.pl EOG091G0TNU.fasta 1> ../../../per_gene/EOG091G0TNU/EOG091G0TNU.best_model 2> ../../../per_gene/EOG091G0TNU/find_best_model.stderr.txt
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/c0c09ee657b1e27f2c5687e0e9aa8d70.simg
[Mon Jul  6 00:21:25 2020]
Finished job 1003.
3026 of 3292 steps (92%) done

[Mon Jul  6 00:21:25 2020]
rule remove_empty:
    input: per_gene/EOG091G03ZS/ALICUT_EOG091G03ZS.clustalo.fasta
    output: per_gene/EOG091G03ZS/empty_check.done
    jobid: 1825
    wildcards: BUSCO=EOG091G03ZS


         if [ "$(cat per_gene/EOG091G03ZS/ALICUT_EOG091G03ZS.clustalo.fasta | grep -v ">" | sed 's/-//g' | grep "^$" | wc -l)" -gt 0 ]
         then
              cp per_gene/EOG091G03ZS/ALICUT_EOG091G03ZS.clustalo.fasta per_gene/EOG091G03ZS/ALICUT_EOG091G03ZS.clustalo.fasta.backup
              bash ../scripts/remove_empty.sh per_gene/EOG091G03ZS/ALICUT_EOG091G03ZS.clustalo.fasta.backup > per_gene/EOG091G03ZS/ALICUT_EOG091G03ZS.clustalo.fasta
         fi
         touch per_gene/EOG091G03ZS/empty_check.done
         
[Mon Jul  6 00:21:25 2020]
Finished job 1825.
3027 of 3292 steps (92%) done

[Mon Jul  6 00:21:25 2020]
rule find_best_model:
    input: per_gene/EOG091G03ZS/ALICUT_EOG091G03ZS.clustalo.fasta, per_gene/EOG091G03ZS/empty_check.done
    output: per_gene/EOG091G03ZS/EOG091G03ZS.best_model
    log: per_gene/EOG091G03ZS/find_best_model.stderr.txt
    jobid: 1002
    wildcards: BUSCO=EOG091G03ZS
    threads: 2


        cd per_gene/EOG091G03ZS
        if [ ! -d find_best_model ]
        then
            mkdir find_best_model
        fi
        cd find_best_model
        ln -s ../../../per_gene/EOG091G03ZS/ALICUT_EOG091G03ZS.clustalo.fasta EOG091G03ZS.fasta
        ProteinModelSelection.pl EOG091G03ZS.fasta 1> ../../../per_gene/EOG091G03ZS/EOG091G03ZS.best_model 2> ../../../per_gene/EOG091G03ZS/find_best_model.stderr.txt
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/c0c09ee657b1e27f2c5687e0e9aa8d70.simg
[Mon Jul  6 00:21:26 2020]
Finished job 2700.
3028 of 3292 steps (92%) done

[Mon Jul  6 00:21:26 2020]
rule get_outgroups:
    input: per_gene/EOG091G0H62/EOG091G0H62.ingroup.fasta
    output: per_gene/EOG091G0H62/EOG091G0H62.orthodb.fasta, per_gene/EOG091G0H62/EOG091G0H62.outgroup.fasta
    log: per_gene/EOG091G0H62/get_outgroups.stdout.txt, per_gene/EOG091G0H62/get_outgroups.stderr.txt
    jobid: 2701
    wildcards: BUSCO=EOG091G0H62


        #download fastas from Orhtodb for BUSCO id
        for i in {1..5}
        do
             wget "http://www.orthodb.org/fasta?query=EOG091G0H62&level=33208" -O per_gene/EOG091G0H62/EOG091G0H62.orthodb.fasta 1> per_gene/EOG091G0H62/get_outgroups.stdout.txt 2> per_gene/EOG091G0H62/get_outgroups.stderr.txt && break || echo -e "try again ($i)" && sleep 15
        done

	#This is quick an dirty for now and just takes the first protein if there is more than one for an outgroup taxon
        bash ../scripts/download_outgroups.sh taxids.txt per_gene/EOG091G0H62/EOG091G0H62.orthodb.fasta > per_gene/EOG091G0H62/EOG091G0H62.outgroup.fasta
        
[Mon Jul  6 00:21:27 2020]
Finished job 2701.
3029 of 3292 steps (92%) done

[Mon Jul  6 00:21:27 2020]
rule join_groups:
    input: per_gene/EOG091G0H62/EOG091G0H62.ingroup.fasta, per_gene/EOG091G0H62/EOG091G0H62.outgroup.fasta
    output: per_gene/EOG091G0H62/EOG091G0H62.fasta
    jobid: 2174
    wildcards: BUSCO=EOG091G0H62


        cat per_gene/EOG091G0H62/EOG091G0H62.ingroup.fasta per_gene/EOG091G0H62/EOG091G0H62.outgroup.fasta > per_gene/EOG091G0H62/EOG091G0H62.fasta
        
[Mon Jul  6 00:21:27 2020]
Finished job 2174.
3030 of 3292 steps (92%) done

[Mon Jul  6 00:21:27 2020]
rule MSA:
    input: per_gene/EOG091G0H62/EOG091G0H62.fasta
    output: per_gene/EOG091G0H62/EOG091G0H62.clustalo.fasta
    log: per_gene/EOG091G0H62/MSA.stdout.txt, per_gene/EOG091G0H62/MSA.stderr.txt
    jobid: 1468
    wildcards: BUSCO=EOG091G0H62
    threads: 2


        clustalo -i per_gene/EOG091G0H62/EOG091G0H62.fasta -o per_gene/EOG091G0H62/EOG091G0H62.clustalo.fasta --threads=2 1> per_gene/EOG091G0H62/MSA.stdout.txt 2> per_gene/EOG091G0H62/MSA.stderr.txt
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/d68c9691725a7401923680874285c430.simg
[Mon Jul  6 00:21:29 2020]
Finished job 1468.
3031 of 3292 steps (92%) done

[Mon Jul  6 00:21:29 2020]
rule score_and_cut:
    input: per_gene/EOG091G0H62/EOG091G0H62.clustalo.fasta
    output: per_gene/EOG091G0H62/ALICUT_EOG091G0H62.clustalo.fasta
    jobid: 645
    wildcards: BUSCO=EOG091G0H62
    threads: 2


        cd per_gene/EOG091G0H62
        Aliscore.pl -N -r 200000000000000000 -i ../../per_gene/EOG091G0H62/EOG091G0H62.clustalo.fasta &> aliscore.log
        ALICUT.pl -s &> alicut.log
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/63c88c27a0fa300f57066b0ef65fefcb.simg
[Mon Jul  6 00:21:32 2020]
Finished job 828.
3032 of 3292 steps (92%) done

[Mon Jul  6 00:21:32 2020]
rule infer_single_ML:
    input: per_gene/EOG091G0W6G/EOG091G0W6G.best_model, per_gene/EOG091G0W6G/ALICUT_EOG091G0W6G.clustalo.fasta
    output: per_gene/EOG091G0W6G/EOG091G0W6G.raxml.done
    log: per_gene/EOG091G0W6G/infer_single_ML.stdout.txt, per_gene/EOG091G0W6G/infer_single_ML.stderr.txt
    jobid: 208
    wildcards: BUSCO=EOG091G0W6G
    threads: 2


        cd per_gene/EOG091G0W6G
	count=$(cat ../../per_gene/EOG091G0W6G/ALICUT_EOG091G0W6G.clustalo.fasta | grep ">" | wc -l)
	if [ "$count" -gt 5 ]
        then
		RAxMLmodel=$(cat ../../per_gene/EOG091G0W6G/EOG091G0W6G.best_model | grep "Best" | cut -d ":" -f 2 | tr -d '[:space:]')
                if [ "$(ls -1 | grep "^RAxML" | wc -l)" -ne 0 ]
		then
			rm RAxML*
		fi
        	raxml -f a -T 2 -m PROTGAMMA$RAxMLmodel         	-p 12345 -x 12345 -# 100         	-s ../../per_gene/EOG091G0W6G/ALICUT_EOG091G0W6G.clustalo.fasta -n EOG091G0W6G.clustalo.aln.ALICUT.$RAxMLmodel 		1> ../../per_gene/EOG091G0W6G/infer_single_ML.stdout.txt 2> ../../per_gene/EOG091G0W6G/infer_single_ML.stderr.txt
	else
		echo "fasta file per_gene/EOG091G0W6G/ALICUT_EOG091G0W6G.clustalo.fasta contains fewer than 5 sequences - skipped" > ../../per_gene/EOG091G0W6G/infer_single_ML.stdout.txt
		touch raxml.skipped
	fi
        touch ../../per_gene/EOG091G0W6G/EOG091G0W6G.raxml.done
        
[33mJob counts:
	count	jobs
	1	infer_single_ML
	1[0m
[33m
        cd per_gene/EOG091G0W6G
	count=$(cat ../../per_gene/EOG091G0W6G/ALICUT_EOG091G0W6G.clustalo.fasta | grep ">" | wc -l)
	if [ "$count" -gt 5 ]
        then
		RAxMLmodel=$(cat ../../per_gene/EOG091G0W6G/EOG091G0W6G.best_model | grep "Best" | cut -d ":" -f 2 | tr -d '[:space:]')
                if [ "$(ls -1 | grep "^RAxML" | wc -l)" -ne 0 ]
		then
			rm RAxML*
		fi
        	raxml -f a -T 2 -m PROTGAMMA$RAxMLmodel         	-p 12345 -x 12345 -# 100         	-s ../../per_gene/EOG091G0W6G/ALICUT_EOG091G0W6G.clustalo.fasta -n EOG091G0W6G.clustalo.aln.ALICUT.$RAxMLmodel 		1> ../../per_gene/EOG091G0W6G/infer_single_ML.stdout.txt 2> ../../per_gene/EOG091G0W6G/infer_single_ML.stderr.txt
	else
		echo "fasta file per_gene/EOG091G0W6G/ALICUT_EOG091G0W6G.clustalo.fasta contains fewer than 5 sequences - skipped" > ../../per_gene/EOG091G0W6G/infer_single_ML.stdout.txt
		touch raxml.skipped
	fi
        touch ../../per_gene/EOG091G0W6G/EOG091G0W6G.raxml.done
        [0m
[Mon Jul  6 00:21:38 2020]
Finished job 645.
3033 of 3292 steps (92%) done

[Mon Jul  6 00:21:38 2020]
rule remove_empty:
    input: per_gene/EOG091G0H62/ALICUT_EOG091G0H62.clustalo.fasta
    output: per_gene/EOG091G0H62/empty_check.done
    jobid: 1467
    wildcards: BUSCO=EOG091G0H62


         if [ "$(cat per_gene/EOG091G0H62/ALICUT_EOG091G0H62.clustalo.fasta | grep -v ">" | sed 's/-//g' | grep "^$" | wc -l)" -gt 0 ]
         then
              cp per_gene/EOG091G0H62/ALICUT_EOG091G0H62.clustalo.fasta per_gene/EOG091G0H62/ALICUT_EOG091G0H62.clustalo.fasta.backup
              bash ../scripts/remove_empty.sh per_gene/EOG091G0H62/ALICUT_EOG091G0H62.clustalo.fasta.backup > per_gene/EOG091G0H62/ALICUT_EOG091G0H62.clustalo.fasta
         fi
         touch per_gene/EOG091G0H62/empty_check.done
         
[Mon Jul  6 00:21:38 2020]
Finished job 1467.
3034 of 3292 steps (92%) done

[Mon Jul  6 00:21:38 2020]
rule find_best_model:
    input: per_gene/EOG091G0H62/ALICUT_EOG091G0H62.clustalo.fasta, per_gene/EOG091G0H62/empty_check.done
    output: per_gene/EOG091G0H62/EOG091G0H62.best_model
    log: per_gene/EOG091G0H62/find_best_model.stderr.txt
    jobid: 644
    wildcards: BUSCO=EOG091G0H62
    threads: 2


        cd per_gene/EOG091G0H62
        if [ ! -d find_best_model ]
        then
            mkdir find_best_model
        fi
        cd find_best_model
        ln -s ../../../per_gene/EOG091G0H62/ALICUT_EOG091G0H62.clustalo.fasta EOG091G0H62.fasta
        ProteinModelSelection.pl EOG091G0H62.fasta 1> ../../../per_gene/EOG091G0H62/EOG091G0H62.best_model 2> ../../../per_gene/EOG091G0H62/find_best_model.stderr.txt
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/c0c09ee657b1e27f2c5687e0e9aa8d70.simg
[Mon Jul  6 00:21:40 2020]
Finished job 185.
3035 of 3292 steps (92%) done

[Mon Jul  6 00:21:40 2020]
rule find_best_model:
    input: per_gene/EOG091G0SQV/ALICUT_EOG091G0SQV.clustalo.fasta, per_gene/EOG091G0SQV/empty_check.done
    output: per_gene/EOG091G0SQV/EOG091G0SQV.best_model
    log: per_gene/EOG091G0SQV/find_best_model.stderr.txt
    jobid: 1226
    wildcards: BUSCO=EOG091G0SQV
    threads: 2


        cd per_gene/EOG091G0SQV
        if [ ! -d find_best_model ]
        then
            mkdir find_best_model
        fi
        cd find_best_model
        ln -s ../../../per_gene/EOG091G0SQV/ALICUT_EOG091G0SQV.clustalo.fasta EOG091G0SQV.fasta
        ProteinModelSelection.pl EOG091G0SQV.fasta 1> ../../../per_gene/EOG091G0SQV/EOG091G0SQV.best_model 2> ../../../per_gene/EOG091G0SQV/find_best_model.stderr.txt
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/c0c09ee657b1e27f2c5687e0e9aa8d70.simg
[Mon Jul  6 00:21:42 2020]
Finished job 796.
3036 of 3292 steps (92%) done

[Mon Jul  6 00:21:42 2020]
rule infer_single_ML:
    input: per_gene/EOG091G0TNU/EOG091G0TNU.best_model, per_gene/EOG091G0TNU/ALICUT_EOG091G0TNU.clustalo.fasta
    output: per_gene/EOG091G0TNU/EOG091G0TNU.raxml.done
    log: per_gene/EOG091G0TNU/infer_single_ML.stdout.txt, per_gene/EOG091G0TNU/infer_single_ML.stderr.txt
    jobid: 192
    wildcards: BUSCO=EOG091G0TNU
    threads: 2


        cd per_gene/EOG091G0TNU
	count=$(cat ../../per_gene/EOG091G0TNU/ALICUT_EOG091G0TNU.clustalo.fasta | grep ">" | wc -l)
	if [ "$count" -gt 5 ]
        then
		RAxMLmodel=$(cat ../../per_gene/EOG091G0TNU/EOG091G0TNU.best_model | grep "Best" | cut -d ":" -f 2 | tr -d '[:space:]')
                if [ "$(ls -1 | grep "^RAxML" | wc -l)" -ne 0 ]
		then
			rm RAxML*
		fi
        	raxml -f a -T 2 -m PROTGAMMA$RAxMLmodel         	-p 12345 -x 12345 -# 100         	-s ../../per_gene/EOG091G0TNU/ALICUT_EOG091G0TNU.clustalo.fasta -n EOG091G0TNU.clustalo.aln.ALICUT.$RAxMLmodel 		1> ../../per_gene/EOG091G0TNU/infer_single_ML.stdout.txt 2> ../../per_gene/EOG091G0TNU/infer_single_ML.stderr.txt
	else
		echo "fasta file per_gene/EOG091G0TNU/ALICUT_EOG091G0TNU.clustalo.fasta contains fewer than 5 sequences - skipped" > ../../per_gene/EOG091G0TNU/infer_single_ML.stdout.txt
		touch raxml.skipped
	fi
        touch ../../per_gene/EOG091G0TNU/EOG091G0TNU.raxml.done
        
[33mJob counts:
	count	jobs
	1	infer_single_ML
	1[0m
[33m
        cd per_gene/EOG091G0TNU
	count=$(cat ../../per_gene/EOG091G0TNU/ALICUT_EOG091G0TNU.clustalo.fasta | grep ">" | wc -l)
	if [ "$count" -gt 5 ]
        then
		RAxMLmodel=$(cat ../../per_gene/EOG091G0TNU/EOG091G0TNU.best_model | grep "Best" | cut -d ":" -f 2 | tr -d '[:space:]')
                if [ "$(ls -1 | grep "^RAxML" | wc -l)" -ne 0 ]
		then
			rm RAxML*
		fi
        	raxml -f a -T 2 -m PROTGAMMA$RAxMLmodel         	-p 12345 -x 12345 -# 100         	-s ../../per_gene/EOG091G0TNU/ALICUT_EOG091G0TNU.clustalo.fasta -n EOG091G0TNU.clustalo.aln.ALICUT.$RAxMLmodel 		1> ../../per_gene/EOG091G0TNU/infer_single_ML.stdout.txt 2> ../../per_gene/EOG091G0TNU/infer_single_ML.stderr.txt
	else
		echo "fasta file per_gene/EOG091G0TNU/ALICUT_EOG091G0TNU.clustalo.fasta contains fewer than 5 sequences - skipped" > ../../per_gene/EOG091G0TNU/infer_single_ML.stdout.txt
		touch raxml.skipped
	fi
        touch ../../per_gene/EOG091G0TNU/EOG091G0TNU.raxml.done
        [0m
[Mon Jul  6 00:21:45 2020]
Finished job 708.
3037 of 3292 steps (92%) done

[Mon Jul  6 00:21:45 2020]
rule infer_single_ML:
    input: per_gene/EOG091G0MDT/EOG091G0MDT.best_model, per_gene/EOG091G0MDT/ALICUT_EOG091G0MDT.clustalo.fasta
    output: per_gene/EOG091G0MDT/EOG091G0MDT.raxml.done
    log: per_gene/EOG091G0MDT/infer_single_ML.stdout.txt, per_gene/EOG091G0MDT/infer_single_ML.stderr.txt
    jobid: 148
    wildcards: BUSCO=EOG091G0MDT
    threads: 2


        cd per_gene/EOG091G0MDT
	count=$(cat ../../per_gene/EOG091G0MDT/ALICUT_EOG091G0MDT.clustalo.fasta | grep ">" | wc -l)
	if [ "$count" -gt 5 ]
        then
		RAxMLmodel=$(cat ../../per_gene/EOG091G0MDT/EOG091G0MDT.best_model | grep "Best" | cut -d ":" -f 2 | tr -d '[:space:]')
                if [ "$(ls -1 | grep "^RAxML" | wc -l)" -ne 0 ]
		then
			rm RAxML*
		fi
        	raxml -f a -T 2 -m PROTGAMMA$RAxMLmodel         	-p 12345 -x 12345 -# 100         	-s ../../per_gene/EOG091G0MDT/ALICUT_EOG091G0MDT.clustalo.fasta -n EOG091G0MDT.clustalo.aln.ALICUT.$RAxMLmodel 		1> ../../per_gene/EOG091G0MDT/infer_single_ML.stdout.txt 2> ../../per_gene/EOG091G0MDT/infer_single_ML.stderr.txt
	else
		echo "fasta file per_gene/EOG091G0MDT/ALICUT_EOG091G0MDT.clustalo.fasta contains fewer than 5 sequences - skipped" > ../../per_gene/EOG091G0MDT/infer_single_ML.stdout.txt
		touch raxml.skipped
	fi
        touch ../../per_gene/EOG091G0MDT/EOG091G0MDT.raxml.done
        
[33mJob counts:
	count	jobs
	1	infer_single_ML
	1[0m
[33m
        cd per_gene/EOG091G0MDT
	count=$(cat ../../per_gene/EOG091G0MDT/ALICUT_EOG091G0MDT.clustalo.fasta | grep ">" | wc -l)
	if [ "$count" -gt 5 ]
        then
		RAxMLmodel=$(cat ../../per_gene/EOG091G0MDT/EOG091G0MDT.best_model | grep "Best" | cut -d ":" -f 2 | tr -d '[:space:]')
                if [ "$(ls -1 | grep "^RAxML" | wc -l)" -ne 0 ]
		then
			rm RAxML*
		fi
        	raxml -f a -T 2 -m PROTGAMMA$RAxMLmodel         	-p 12345 -x 12345 -# 100         	-s ../../per_gene/EOG091G0MDT/ALICUT_EOG091G0MDT.clustalo.fasta -n EOG091G0MDT.clustalo.aln.ALICUT.$RAxMLmodel 		1> ../../per_gene/EOG091G0MDT/infer_single_ML.stdout.txt 2> ../../per_gene/EOG091G0MDT/infer_single_ML.stderr.txt
	else
		echo "fasta file per_gene/EOG091G0MDT/ALICUT_EOG091G0MDT.clustalo.fasta contains fewer than 5 sequences - skipped" > ../../per_gene/EOG091G0MDT/infer_single_ML.stdout.txt
		touch raxml.skipped
	fi
        touch ../../per_gene/EOG091G0MDT/EOG091G0MDT.raxml.done
        [0m
[Mon Jul  6 00:21:48 2020]
Finished job 271.
3038 of 3292 steps (92%) done

[Mon Jul  6 00:21:48 2020]
rule get_seqs:
    input: /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ingroup.txt, /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/outgroup.txt
    output: per_gene/EOG091G0Y05/EOG091G0Y05.ingroup.fasta
    log: per_gene/EOG091G0Y05/get_seqs.stdout.txt, per_gene/EOG091G0Y05/get_seqs.stderr.txt
    jobid: 2894
    wildcards: BUSCO=EOG091G0Y05
    threads: 2


	basedir=$(pwd)
        cd per_gene/EOG091G0Y05
        
        bash $basedir/../scripts/fetch_seqs.sh EOG091G0Y05 /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ingroup.txt /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/outgroup.txt 1> ../../per_gene/EOG091G0Y05/get_seqs.stdout.txt 2> ../../per_gene/EOG091G0Y05/get_seqs.stderr.txt
	mv EOG091G0Y05.fasta $basedir/per_gene/EOG091G0Y05/EOG091G0Y05.ingroup.fasta
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/72476f9d9a5bd0627b4d721143a21354.simg
[Mon Jul  6 00:22:05 2020]
Finished job 1226.
3039 of 3292 steps (92%) done

[Mon Jul  6 00:22:05 2020]
rule infer_single_ML:
    input: per_gene/EOG091G0SQV/EOG091G0SQV.best_model, per_gene/EOG091G0SQV/ALICUT_EOG091G0SQV.clustalo.fasta
    output: per_gene/EOG091G0SQV/EOG091G0SQV.raxml.done
    log: per_gene/EOG091G0SQV/infer_single_ML.stdout.txt, per_gene/EOG091G0SQV/infer_single_ML.stderr.txt
    jobid: 407
    wildcards: BUSCO=EOG091G0SQV
    threads: 2


        cd per_gene/EOG091G0SQV
	count=$(cat ../../per_gene/EOG091G0SQV/ALICUT_EOG091G0SQV.clustalo.fasta | grep ">" | wc -l)
	if [ "$count" -gt 5 ]
        then
		RAxMLmodel=$(cat ../../per_gene/EOG091G0SQV/EOG091G0SQV.best_model | grep "Best" | cut -d ":" -f 2 | tr -d '[:space:]')
                if [ "$(ls -1 | grep "^RAxML" | wc -l)" -ne 0 ]
		then
			rm RAxML*
		fi
        	raxml -f a -T 2 -m PROTGAMMA$RAxMLmodel         	-p 12345 -x 12345 -# 100         	-s ../../per_gene/EOG091G0SQV/ALICUT_EOG091G0SQV.clustalo.fasta -n EOG091G0SQV.clustalo.aln.ALICUT.$RAxMLmodel 		1> ../../per_gene/EOG091G0SQV/infer_single_ML.stdout.txt 2> ../../per_gene/EOG091G0SQV/infer_single_ML.stderr.txt
	else
		echo "fasta file per_gene/EOG091G0SQV/ALICUT_EOG091G0SQV.clustalo.fasta contains fewer than 5 sequences - skipped" > ../../per_gene/EOG091G0SQV/infer_single_ML.stdout.txt
		touch raxml.skipped
	fi
        touch ../../per_gene/EOG091G0SQV/EOG091G0SQV.raxml.done
        
[33mJob counts:
	count	jobs
	1	infer_single_ML
	1[0m
[33m
        cd per_gene/EOG091G0SQV
	count=$(cat ../../per_gene/EOG091G0SQV/ALICUT_EOG091G0SQV.clustalo.fasta | grep ">" | wc -l)
	if [ "$count" -gt 5 ]
        then
		RAxMLmodel=$(cat ../../per_gene/EOG091G0SQV/EOG091G0SQV.best_model | grep "Best" | cut -d ":" -f 2 | tr -d '[:space:]')
                if [ "$(ls -1 | grep "^RAxML" | wc -l)" -ne 0 ]
		then
			rm RAxML*
		fi
        	raxml -f a -T 2 -m PROTGAMMA$RAxMLmodel         	-p 12345 -x 12345 -# 100         	-s ../../per_gene/EOG091G0SQV/ALICUT_EOG091G0SQV.clustalo.fasta -n EOG091G0SQV.clustalo.aln.ALICUT.$RAxMLmodel 		1> ../../per_gene/EOG091G0SQV/infer_single_ML.stdout.txt 2> ../../per_gene/EOG091G0SQV/infer_single_ML.stderr.txt
	else
		echo "fasta file per_gene/EOG091G0SQV/ALICUT_EOG091G0SQV.clustalo.fasta contains fewer than 5 sequences - skipped" > ../../per_gene/EOG091G0SQV/infer_single_ML.stdout.txt
		touch raxml.skipped
	fi
        touch ../../per_gene/EOG091G0SQV/EOG091G0SQV.raxml.done
        [0m
[Mon Jul  6 00:22:07 2020]
Finished job 2894.
3040 of 3292 steps (92%) done

[Mon Jul  6 00:22:07 2020]
rule get_outgroups:
    input: per_gene/EOG091G0Y05/EOG091G0Y05.ingroup.fasta
    output: per_gene/EOG091G0Y05/EOG091G0Y05.orthodb.fasta, per_gene/EOG091G0Y05/EOG091G0Y05.outgroup.fasta
    log: per_gene/EOG091G0Y05/get_outgroups.stdout.txt, per_gene/EOG091G0Y05/get_outgroups.stderr.txt
    jobid: 2895
    wildcards: BUSCO=EOG091G0Y05


        #download fastas from Orhtodb for BUSCO id
        for i in {1..5}
        do
             wget "http://www.orthodb.org/fasta?query=EOG091G0Y05&level=33208" -O per_gene/EOG091G0Y05/EOG091G0Y05.orthodb.fasta 1> per_gene/EOG091G0Y05/get_outgroups.stdout.txt 2> per_gene/EOG091G0Y05/get_outgroups.stderr.txt && break || echo -e "try again ($i)" && sleep 15
        done

	#This is quick an dirty for now and just takes the first protein if there is more than one for an outgroup taxon
        bash ../scripts/download_outgroups.sh taxids.txt per_gene/EOG091G0Y05/EOG091G0Y05.orthodb.fasta > per_gene/EOG091G0Y05/EOG091G0Y05.outgroup.fasta
        
[Mon Jul  6 00:22:08 2020]
Finished job 2895.
3041 of 3292 steps (92%) done

[Mon Jul  6 00:22:08 2020]
rule join_groups:
    input: per_gene/EOG091G0Y05/EOG091G0Y05.ingroup.fasta, per_gene/EOG091G0Y05/EOG091G0Y05.outgroup.fasta
    output: per_gene/EOG091G0Y05/EOG091G0Y05.fasta
    jobid: 2271
    wildcards: BUSCO=EOG091G0Y05


        cat per_gene/EOG091G0Y05/EOG091G0Y05.ingroup.fasta per_gene/EOG091G0Y05/EOG091G0Y05.outgroup.fasta > per_gene/EOG091G0Y05/EOG091G0Y05.fasta
        
[Mon Jul  6 00:22:08 2020]
Finished job 2271.
3042 of 3292 steps (92%) done

[Mon Jul  6 00:22:08 2020]
rule MSA:
    input: per_gene/EOG091G0Y05/EOG091G0Y05.fasta
    output: per_gene/EOG091G0Y05/EOG091G0Y05.clustalo.fasta
    log: per_gene/EOG091G0Y05/MSA.stdout.txt, per_gene/EOG091G0Y05/MSA.stderr.txt
    jobid: 1662
    wildcards: BUSCO=EOG091G0Y05
    threads: 2


        clustalo -i per_gene/EOG091G0Y05/EOG091G0Y05.fasta -o per_gene/EOG091G0Y05/EOG091G0Y05.clustalo.fasta --threads=2 1> per_gene/EOG091G0Y05/MSA.stdout.txt 2> per_gene/EOG091G0Y05/MSA.stderr.txt
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/d68c9691725a7401923680874285c430.simg
[Mon Jul  6 00:22:09 2020]
Finished job 1662.
3043 of 3292 steps (92%) done

[Mon Jul  6 00:22:09 2020]
rule score_and_cut:
    input: per_gene/EOG091G0Y05/EOG091G0Y05.clustalo.fasta
    output: per_gene/EOG091G0Y05/ALICUT_EOG091G0Y05.clustalo.fasta
    jobid: 839
    wildcards: BUSCO=EOG091G0Y05
    threads: 2


        cd per_gene/EOG091G0Y05
        Aliscore.pl -N -r 200000000000000000 -i ../../per_gene/EOG091G0Y05/EOG091G0Y05.clustalo.fasta &> aliscore.log
        ALICUT.pl -s &> alicut.log
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/63c88c27a0fa300f57066b0ef65fefcb.simg
[Mon Jul  6 00:22:11 2020]
Finished job 644.
3044 of 3292 steps (92%) done

[Mon Jul  6 00:22:11 2020]
rule infer_single_ML:
    input: per_gene/EOG091G0H62/EOG091G0H62.best_model, per_gene/EOG091G0H62/ALICUT_EOG091G0H62.clustalo.fasta
    output: per_gene/EOG091G0H62/EOG091G0H62.raxml.done
    log: per_gene/EOG091G0H62/infer_single_ML.stdout.txt, per_gene/EOG091G0H62/infer_single_ML.stderr.txt
    jobid: 116
    wildcards: BUSCO=EOG091G0H62
    threads: 2


        cd per_gene/EOG091G0H62
	count=$(cat ../../per_gene/EOG091G0H62/ALICUT_EOG091G0H62.clustalo.fasta | grep ">" | wc -l)
	if [ "$count" -gt 5 ]
        then
		RAxMLmodel=$(cat ../../per_gene/EOG091G0H62/EOG091G0H62.best_model | grep "Best" | cut -d ":" -f 2 | tr -d '[:space:]')
                if [ "$(ls -1 | grep "^RAxML" | wc -l)" -ne 0 ]
		then
			rm RAxML*
		fi
        	raxml -f a -T 2 -m PROTGAMMA$RAxMLmodel         	-p 12345 -x 12345 -# 100         	-s ../../per_gene/EOG091G0H62/ALICUT_EOG091G0H62.clustalo.fasta -n EOG091G0H62.clustalo.aln.ALICUT.$RAxMLmodel 		1> ../../per_gene/EOG091G0H62/infer_single_ML.stdout.txt 2> ../../per_gene/EOG091G0H62/infer_single_ML.stderr.txt
	else
		echo "fasta file per_gene/EOG091G0H62/ALICUT_EOG091G0H62.clustalo.fasta contains fewer than 5 sequences - skipped" > ../../per_gene/EOG091G0H62/infer_single_ML.stdout.txt
		touch raxml.skipped
	fi
        touch ../../per_gene/EOG091G0H62/EOG091G0H62.raxml.done
        
[Mon Jul  6 00:22:14 2020]
Finished job 1002.
3045 of 3292 steps (92%) done

[Mon Jul  6 00:22:14 2020]
rule infer_single_ML:
    input: per_gene/EOG091G03ZS/EOG091G03ZS.best_model, per_gene/EOG091G03ZS/ALICUT_EOG091G03ZS.clustalo.fasta
    output: per_gene/EOG091G03ZS/EOG091G03ZS.raxml.done
    log: per_gene/EOG091G03ZS/infer_single_ML.stdout.txt, per_gene/EOG091G03ZS/infer_single_ML.stderr.txt
    jobid: 295
    wildcards: BUSCO=EOG091G03ZS
    threads: 2


        cd per_gene/EOG091G03ZS
	count=$(cat ../../per_gene/EOG091G03ZS/ALICUT_EOG091G03ZS.clustalo.fasta | grep ">" | wc -l)
	if [ "$count" -gt 5 ]
        then
		RAxMLmodel=$(cat ../../per_gene/EOG091G03ZS/EOG091G03ZS.best_model | grep "Best" | cut -d ":" -f 2 | tr -d '[:space:]')
                if [ "$(ls -1 | grep "^RAxML" | wc -l)" -ne 0 ]
		then
			rm RAxML*
		fi
        	raxml -f a -T 2 -m PROTGAMMA$RAxMLmodel         	-p 12345 -x 12345 -# 100         	-s ../../per_gene/EOG091G03ZS/ALICUT_EOG091G03ZS.clustalo.fasta -n EOG091G03ZS.clustalo.aln.ALICUT.$RAxMLmodel 		1> ../../per_gene/EOG091G03ZS/infer_single_ML.stdout.txt 2> ../../per_gene/EOG091G03ZS/infer_single_ML.stderr.txt
	else
		echo "fasta file per_gene/EOG091G03ZS/ALICUT_EOG091G03ZS.clustalo.fasta contains fewer than 5 sequences - skipped" > ../../per_gene/EOG091G03ZS/infer_single_ML.stdout.txt
		touch raxml.skipped
	fi
        touch ../../per_gene/EOG091G03ZS/EOG091G03ZS.raxml.done
        
[33mJob counts:
	count	jobs
	1	infer_single_ML
	1[0m
[33m
        cd per_gene/EOG091G0H62
	count=$(cat ../../per_gene/EOG091G0H62/ALICUT_EOG091G0H62.clustalo.fasta | grep ">" | wc -l)
	if [ "$count" -gt 5 ]
        then
		RAxMLmodel=$(cat ../../per_gene/EOG091G0H62/EOG091G0H62.best_model | grep "Best" | cut -d ":" -f 2 | tr -d '[:space:]')
                if [ "$(ls -1 | grep "^RAxML" | wc -l)" -ne 0 ]
		then
			rm RAxML*
		fi
        	raxml -f a -T 2 -m PROTGAMMA$RAxMLmodel         	-p 12345 -x 12345 -# 100         	-s ../../per_gene/EOG091G0H62/ALICUT_EOG091G0H62.clustalo.fasta -n EOG091G0H62.clustalo.aln.ALICUT.$RAxMLmodel 		1> ../../per_gene/EOG091G0H62/infer_single_ML.stdout.txt 2> ../../per_gene/EOG091G0H62/infer_single_ML.stderr.txt
	else
		echo "fasta file per_gene/EOG091G0H62/ALICUT_EOG091G0H62.clustalo.fasta contains fewer than 5 sequences - skipped" > ../../per_gene/EOG091G0H62/infer_single_ML.stdout.txt
		touch raxml.skipped
	fi
        touch ../../per_gene/EOG091G0H62/EOG091G0H62.raxml.done
        [0m
[33mJob counts:
	count	jobs
	1	infer_single_ML
	1[0m
[33m
        cd per_gene/EOG091G03ZS
	count=$(cat ../../per_gene/EOG091G03ZS/ALICUT_EOG091G03ZS.clustalo.fasta | grep ">" | wc -l)
	if [ "$count" -gt 5 ]
        then
		RAxMLmodel=$(cat ../../per_gene/EOG091G03ZS/EOG091G03ZS.best_model | grep "Best" | cut -d ":" -f 2 | tr -d '[:space:]')
                if [ "$(ls -1 | grep "^RAxML" | wc -l)" -ne 0 ]
		then
			rm RAxML*
		fi
        	raxml -f a -T 2 -m PROTGAMMA$RAxMLmodel         	-p 12345 -x 12345 -# 100         	-s ../../per_gene/EOG091G03ZS/ALICUT_EOG091G03ZS.clustalo.fasta -n EOG091G03ZS.clustalo.aln.ALICUT.$RAxMLmodel 		1> ../../per_gene/EOG091G03ZS/infer_single_ML.stdout.txt 2> ../../per_gene/EOG091G03ZS/infer_single_ML.stderr.txt
	else
		echo "fasta file per_gene/EOG091G03ZS/ALICUT_EOG091G03ZS.clustalo.fasta contains fewer than 5 sequences - skipped" > ../../per_gene/EOG091G03ZS/infer_single_ML.stdout.txt
		touch raxml.skipped
	fi
        touch ../../per_gene/EOG091G03ZS/EOG091G03ZS.raxml.done
        [0m
[Mon Jul  6 00:22:18 2020]
Finished job 839.
3046 of 3292 steps (93%) done

[Mon Jul  6 00:22:18 2020]
rule remove_empty:
    input: per_gene/EOG091G0Y05/ALICUT_EOG091G0Y05.clustalo.fasta
    output: per_gene/EOG091G0Y05/empty_check.done
    jobid: 1661
    wildcards: BUSCO=EOG091G0Y05


         if [ "$(cat per_gene/EOG091G0Y05/ALICUT_EOG091G0Y05.clustalo.fasta | grep -v ">" | sed 's/-//g' | grep "^$" | wc -l)" -gt 0 ]
         then
              cp per_gene/EOG091G0Y05/ALICUT_EOG091G0Y05.clustalo.fasta per_gene/EOG091G0Y05/ALICUT_EOG091G0Y05.clustalo.fasta.backup
              bash ../scripts/remove_empty.sh per_gene/EOG091G0Y05/ALICUT_EOG091G0Y05.clustalo.fasta.backup > per_gene/EOG091G0Y05/ALICUT_EOG091G0Y05.clustalo.fasta
         fi
         touch per_gene/EOG091G0Y05/empty_check.done
         
[Mon Jul  6 00:22:18 2020]
Finished job 1661.
3047 of 3292 steps (93%) done

[Mon Jul  6 00:22:18 2020]
rule find_best_model:
    input: per_gene/EOG091G0Y05/ALICUT_EOG091G0Y05.clustalo.fasta, per_gene/EOG091G0Y05/empty_check.done
    output: per_gene/EOG091G0Y05/EOG091G0Y05.best_model
    log: per_gene/EOG091G0Y05/find_best_model.stderr.txt
    jobid: 838
    wildcards: BUSCO=EOG091G0Y05
    threads: 2


        cd per_gene/EOG091G0Y05
        if [ ! -d find_best_model ]
        then
            mkdir find_best_model
        fi
        cd find_best_model
        ln -s ../../../per_gene/EOG091G0Y05/ALICUT_EOG091G0Y05.clustalo.fasta EOG091G0Y05.fasta
        ProteinModelSelection.pl EOG091G0Y05.fasta 1> ../../../per_gene/EOG091G0Y05/EOG091G0Y05.best_model 2> ../../../per_gene/EOG091G0Y05/find_best_model.stderr.txt
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/c0c09ee657b1e27f2c5687e0e9aa8d70.simg
[Mon Jul  6 00:22:41 2020]
Finished job 838.
3048 of 3292 steps (93%) done

[Mon Jul  6 00:22:41 2020]
rule infer_single_ML:
    input: per_gene/EOG091G0Y05/EOG091G0Y05.best_model, per_gene/EOG091G0Y05/ALICUT_EOG091G0Y05.clustalo.fasta
    output: per_gene/EOG091G0Y05/EOG091G0Y05.raxml.done
    log: per_gene/EOG091G0Y05/infer_single_ML.stdout.txt, per_gene/EOG091G0Y05/infer_single_ML.stderr.txt
    jobid: 213
    wildcards: BUSCO=EOG091G0Y05
    threads: 2


        cd per_gene/EOG091G0Y05
	count=$(cat ../../per_gene/EOG091G0Y05/ALICUT_EOG091G0Y05.clustalo.fasta | grep ">" | wc -l)
	if [ "$count" -gt 5 ]
        then
		RAxMLmodel=$(cat ../../per_gene/EOG091G0Y05/EOG091G0Y05.best_model | grep "Best" | cut -d ":" -f 2 | tr -d '[:space:]')
                if [ "$(ls -1 | grep "^RAxML" | wc -l)" -ne 0 ]
		then
			rm RAxML*
		fi
        	raxml -f a -T 2 -m PROTGAMMA$RAxMLmodel         	-p 12345 -x 12345 -# 100         	-s ../../per_gene/EOG091G0Y05/ALICUT_EOG091G0Y05.clustalo.fasta -n EOG091G0Y05.clustalo.aln.ALICUT.$RAxMLmodel 		1> ../../per_gene/EOG091G0Y05/infer_single_ML.stdout.txt 2> ../../per_gene/EOG091G0Y05/infer_single_ML.stderr.txt
	else
		echo "fasta file per_gene/EOG091G0Y05/ALICUT_EOG091G0Y05.clustalo.fasta contains fewer than 5 sequences - skipped" > ../../per_gene/EOG091G0Y05/infer_single_ML.stdout.txt
		touch raxml.skipped
	fi
        touch ../../per_gene/EOG091G0Y05/EOG091G0Y05.raxml.done
        
[33mJob counts:
	count	jobs
	1	infer_single_ML
	1[0m
[33m
        cd per_gene/EOG091G0Y05
	count=$(cat ../../per_gene/EOG091G0Y05/ALICUT_EOG091G0Y05.clustalo.fasta | grep ">" | wc -l)
	if [ "$count" -gt 5 ]
        then
		RAxMLmodel=$(cat ../../per_gene/EOG091G0Y05/EOG091G0Y05.best_model | grep "Best" | cut -d ":" -f 2 | tr -d '[:space:]')
                if [ "$(ls -1 | grep "^RAxML" | wc -l)" -ne 0 ]
		then
			rm RAxML*
		fi
        	raxml -f a -T 2 -m PROTGAMMA$RAxMLmodel         	-p 12345 -x 12345 -# 100         	-s ../../per_gene/EOG091G0Y05/ALICUT_EOG091G0Y05.clustalo.fasta -n EOG091G0Y05.clustalo.aln.ALICUT.$RAxMLmodel 		1> ../../per_gene/EOG091G0Y05/infer_single_ML.stdout.txt 2> ../../per_gene/EOG091G0Y05/infer_single_ML.stderr.txt
	else
		echo "fasta file per_gene/EOG091G0Y05/ALICUT_EOG091G0Y05.clustalo.fasta contains fewer than 5 sequences - skipped" > ../../per_gene/EOG091G0Y05/infer_single_ML.stdout.txt
		touch raxml.skipped
	fi
        touch ../../per_gene/EOG091G0Y05/EOG091G0Y05.raxml.done
        [0m
[Mon Jul  6 00:22:45 2020]
Finished job 207.
3049 of 3292 steps (93%) done

[Mon Jul  6 00:22:45 2020]
rule get_seqs:
    input: /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ingroup.txt, /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/outgroup.txt
    output: per_gene/EOG091G0B27/EOG091G0B27.ingroup.fasta
    log: per_gene/EOG091G0B27/get_seqs.stdout.txt, per_gene/EOG091G0B27/get_seqs.stderr.txt
    jobid: 2628
    wildcards: BUSCO=EOG091G0B27
    threads: 2


	basedir=$(pwd)
        cd per_gene/EOG091G0B27
        
        bash $basedir/../scripts/fetch_seqs.sh EOG091G0B27 /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ingroup.txt /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/outgroup.txt 1> ../../per_gene/EOG091G0B27/get_seqs.stdout.txt 2> ../../per_gene/EOG091G0B27/get_seqs.stderr.txt
	mv EOG091G0B27.fasta $basedir/per_gene/EOG091G0B27/EOG091G0B27.ingroup.fasta
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/72476f9d9a5bd0627b4d721143a21354.simg
[Mon Jul  6 00:23:00 2020]
Finished job 2628.
3050 of 3292 steps (93%) done

[Mon Jul  6 00:23:00 2020]
rule get_outgroups:
    input: per_gene/EOG091G0B27/EOG091G0B27.ingroup.fasta
    output: per_gene/EOG091G0B27/EOG091G0B27.orthodb.fasta, per_gene/EOG091G0B27/EOG091G0B27.outgroup.fasta
    log: per_gene/EOG091G0B27/get_outgroups.stdout.txt, per_gene/EOG091G0B27/get_outgroups.stderr.txt
    jobid: 2629
    wildcards: BUSCO=EOG091G0B27


        #download fastas from Orhtodb for BUSCO id
        for i in {1..5}
        do
             wget "http://www.orthodb.org/fasta?query=EOG091G0B27&level=33208" -O per_gene/EOG091G0B27/EOG091G0B27.orthodb.fasta 1> per_gene/EOG091G0B27/get_outgroups.stdout.txt 2> per_gene/EOG091G0B27/get_outgroups.stderr.txt && break || echo -e "try again ($i)" && sleep 15
        done

	#This is quick an dirty for now and just takes the first protein if there is more than one for an outgroup taxon
        bash ../scripts/download_outgroups.sh taxids.txt per_gene/EOG091G0B27/EOG091G0B27.orthodb.fasta > per_gene/EOG091G0B27/EOG091G0B27.outgroup.fasta
        
[Mon Jul  6 00:23:02 2020]
Finished job 2629.
3051 of 3292 steps (93%) done

[Mon Jul  6 00:23:02 2020]
rule join_groups:
    input: per_gene/EOG091G0B27/EOG091G0B27.ingroup.fasta, per_gene/EOG091G0B27/EOG091G0B27.outgroup.fasta
    output: per_gene/EOG091G0B27/EOG091G0B27.fasta
    jobid: 2138
    wildcards: BUSCO=EOG091G0B27


        cat per_gene/EOG091G0B27/EOG091G0B27.ingroup.fasta per_gene/EOG091G0B27/EOG091G0B27.outgroup.fasta > per_gene/EOG091G0B27/EOG091G0B27.fasta
        
[Mon Jul  6 00:23:02 2020]
Finished job 2138.
3052 of 3292 steps (93%) done

[Mon Jul  6 00:23:02 2020]
rule MSA:
    input: per_gene/EOG091G0B27/EOG091G0B27.fasta
    output: per_gene/EOG091G0B27/EOG091G0B27.clustalo.fasta
    log: per_gene/EOG091G0B27/MSA.stdout.txt, per_gene/EOG091G0B27/MSA.stderr.txt
    jobid: 1396
    wildcards: BUSCO=EOG091G0B27
    threads: 2


        clustalo -i per_gene/EOG091G0B27/EOG091G0B27.fasta -o per_gene/EOG091G0B27/EOG091G0B27.clustalo.fasta --threads=2 1> per_gene/EOG091G0B27/MSA.stdout.txt 2> per_gene/EOG091G0B27/MSA.stderr.txt
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/d68c9691725a7401923680874285c430.simg
[Mon Jul  6 00:23:04 2020]
Finished job 1396.
3053 of 3292 steps (93%) done

[Mon Jul  6 00:23:04 2020]
rule score_and_cut:
    input: per_gene/EOG091G0B27/EOG091G0B27.clustalo.fasta
    output: per_gene/EOG091G0B27/ALICUT_EOG091G0B27.clustalo.fasta
    jobid: 573
    wildcards: BUSCO=EOG091G0B27
    threads: 2


        cd per_gene/EOG091G0B27
        Aliscore.pl -N -r 200000000000000000 -i ../../per_gene/EOG091G0B27/EOG091G0B27.clustalo.fasta &> aliscore.log
        ALICUT.pl -s &> alicut.log
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/63c88c27a0fa300f57066b0ef65fefcb.simg
[Mon Jul  6 00:23:16 2020]
Finished job 573.
3054 of 3292 steps (93%) done

[Mon Jul  6 00:23:16 2020]
rule remove_empty:
    input: per_gene/EOG091G0B27/ALICUT_EOG091G0B27.clustalo.fasta
    output: per_gene/EOG091G0B27/empty_check.done
    jobid: 1395
    wildcards: BUSCO=EOG091G0B27


         if [ "$(cat per_gene/EOG091G0B27/ALICUT_EOG091G0B27.clustalo.fasta | grep -v ">" | sed 's/-//g' | grep "^$" | wc -l)" -gt 0 ]
         then
              cp per_gene/EOG091G0B27/ALICUT_EOG091G0B27.clustalo.fasta per_gene/EOG091G0B27/ALICUT_EOG091G0B27.clustalo.fasta.backup
              bash ../scripts/remove_empty.sh per_gene/EOG091G0B27/ALICUT_EOG091G0B27.clustalo.fasta.backup > per_gene/EOG091G0B27/ALICUT_EOG091G0B27.clustalo.fasta
         fi
         touch per_gene/EOG091G0B27/empty_check.done
         
[Mon Jul  6 00:23:16 2020]
Finished job 1395.
3055 of 3292 steps (93%) done

[Mon Jul  6 00:23:16 2020]
rule find_best_model:
    input: per_gene/EOG091G0B27/ALICUT_EOG091G0B27.clustalo.fasta, per_gene/EOG091G0B27/empty_check.done
    output: per_gene/EOG091G0B27/EOG091G0B27.best_model
    log: per_gene/EOG091G0B27/find_best_model.stderr.txt
    jobid: 572
    wildcards: BUSCO=EOG091G0B27
    threads: 2


        cd per_gene/EOG091G0B27
        if [ ! -d find_best_model ]
        then
            mkdir find_best_model
        fi
        cd find_best_model
        ln -s ../../../per_gene/EOG091G0B27/ALICUT_EOG091G0B27.clustalo.fasta EOG091G0B27.fasta
        ProteinModelSelection.pl EOG091G0B27.fasta 1> ../../../per_gene/EOG091G0B27/EOG091G0B27.best_model 2> ../../../per_gene/EOG091G0B27/find_best_model.stderr.txt
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/c0c09ee657b1e27f2c5687e0e9aa8d70.simg
[Mon Jul  6 00:23:47 2020]
Finished job 572.
3056 of 3292 steps (93%) done

[Mon Jul  6 00:23:47 2020]
rule infer_single_ML:
    input: per_gene/EOG091G0B27/EOG091G0B27.best_model, per_gene/EOG091G0B27/ALICUT_EOG091G0B27.clustalo.fasta
    output: per_gene/EOG091G0B27/EOG091G0B27.raxml.done
    log: per_gene/EOG091G0B27/infer_single_ML.stdout.txt, per_gene/EOG091G0B27/infer_single_ML.stderr.txt
    jobid: 80
    wildcards: BUSCO=EOG091G0B27
    threads: 2


        cd per_gene/EOG091G0B27
	count=$(cat ../../per_gene/EOG091G0B27/ALICUT_EOG091G0B27.clustalo.fasta | grep ">" | wc -l)
	if [ "$count" -gt 5 ]
        then
		RAxMLmodel=$(cat ../../per_gene/EOG091G0B27/EOG091G0B27.best_model | grep "Best" | cut -d ":" -f 2 | tr -d '[:space:]')
                if [ "$(ls -1 | grep "^RAxML" | wc -l)" -ne 0 ]
		then
			rm RAxML*
		fi
        	raxml -f a -T 2 -m PROTGAMMA$RAxMLmodel         	-p 12345 -x 12345 -# 100         	-s ../../per_gene/EOG091G0B27/ALICUT_EOG091G0B27.clustalo.fasta -n EOG091G0B27.clustalo.aln.ALICUT.$RAxMLmodel 		1> ../../per_gene/EOG091G0B27/infer_single_ML.stdout.txt 2> ../../per_gene/EOG091G0B27/infer_single_ML.stderr.txt
	else
		echo "fasta file per_gene/EOG091G0B27/ALICUT_EOG091G0B27.clustalo.fasta contains fewer than 5 sequences - skipped" > ../../per_gene/EOG091G0B27/infer_single_ML.stdout.txt
		touch raxml.skipped
	fi
        touch ../../per_gene/EOG091G0B27/EOG091G0B27.raxml.done
        
[33mJob counts:
	count	jobs
	1	infer_single_ML
	1[0m
[33m
        cd per_gene/EOG091G0B27
	count=$(cat ../../per_gene/EOG091G0B27/ALICUT_EOG091G0B27.clustalo.fasta | grep ">" | wc -l)
	if [ "$count" -gt 5 ]
        then
		RAxMLmodel=$(cat ../../per_gene/EOG091G0B27/EOG091G0B27.best_model | grep "Best" | cut -d ":" -f 2 | tr -d '[:space:]')
                if [ "$(ls -1 | grep "^RAxML" | wc -l)" -ne 0 ]
		then
			rm RAxML*
		fi
        	raxml -f a -T 2 -m PROTGAMMA$RAxMLmodel         	-p 12345 -x 12345 -# 100         	-s ../../per_gene/EOG091G0B27/ALICUT_EOG091G0B27.clustalo.fasta -n EOG091G0B27.clustalo.aln.ALICUT.$RAxMLmodel 		1> ../../per_gene/EOG091G0B27/infer_single_ML.stdout.txt 2> ../../per_gene/EOG091G0B27/infer_single_ML.stderr.txt
	else
		echo "fasta file per_gene/EOG091G0B27/ALICUT_EOG091G0B27.clustalo.fasta contains fewer than 5 sequences - skipped" > ../../per_gene/EOG091G0B27/infer_single_ML.stdout.txt
		touch raxml.skipped
	fi
        touch ../../per_gene/EOG091G0B27/EOG091G0B27.raxml.done
        [0m
[Mon Jul  6 00:23:54 2020]
Finished job 290.
3057 of 3292 steps (93%) done

[Mon Jul  6 00:23:54 2020]
rule get_seqs:
    input: /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ingroup.txt, /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/outgroup.txt
    output: per_gene/EOG091G19Y2/EOG091G19Y2.ingroup.fasta
    log: per_gene/EOG091G19Y2/get_seqs.stdout.txt, per_gene/EOG091G19Y2/get_seqs.stderr.txt
    jobid: 2940
    wildcards: BUSCO=EOG091G19Y2
    threads: 2


	basedir=$(pwd)
        cd per_gene/EOG091G19Y2
        
        bash $basedir/../scripts/fetch_seqs.sh EOG091G19Y2 /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ingroup.txt /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/outgroup.txt 1> ../../per_gene/EOG091G19Y2/get_seqs.stdout.txt 2> ../../per_gene/EOG091G19Y2/get_seqs.stderr.txt
	mv EOG091G19Y2.fasta $basedir/per_gene/EOG091G19Y2/EOG091G19Y2.ingroup.fasta
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/72476f9d9a5bd0627b4d721143a21354.simg
[Mon Jul  6 00:23:56 2020]
Finished job 338.
3058 of 3292 steps (93%) done

[Mon Jul  6 00:23:56 2020]
rule get_seqs:
    input: /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ingroup.txt, /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/outgroup.txt
    output: per_gene/EOG091G0ARE/EOG091G0ARE.ingroup.fasta
    log: per_gene/EOG091G0ARE/get_seqs.stdout.txt, per_gene/EOG091G0ARE/get_seqs.stderr.txt
    jobid: 3174
    wildcards: BUSCO=EOG091G0ARE
    threads: 2


	basedir=$(pwd)
        cd per_gene/EOG091G0ARE
        
        bash $basedir/../scripts/fetch_seqs.sh EOG091G0ARE /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ingroup.txt /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/outgroup.txt 1> ../../per_gene/EOG091G0ARE/get_seqs.stdout.txt 2> ../../per_gene/EOG091G0ARE/get_seqs.stderr.txt
	mv EOG091G0ARE.fasta $basedir/per_gene/EOG091G0ARE/EOG091G0ARE.ingroup.fasta
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/72476f9d9a5bd0627b4d721143a21354.simg
[Mon Jul  6 00:24:08 2020]
Finished job 2940.
3059 of 3292 steps (93%) done

[Mon Jul  6 00:24:08 2020]
rule get_outgroups:
    input: per_gene/EOG091G19Y2/EOG091G19Y2.ingroup.fasta
    output: per_gene/EOG091G19Y2/EOG091G19Y2.orthodb.fasta, per_gene/EOG091G19Y2/EOG091G19Y2.outgroup.fasta
    log: per_gene/EOG091G19Y2/get_outgroups.stdout.txt, per_gene/EOG091G19Y2/get_outgroups.stderr.txt
    jobid: 2941
    wildcards: BUSCO=EOG091G19Y2


        #download fastas from Orhtodb for BUSCO id
        for i in {1..5}
        do
             wget "http://www.orthodb.org/fasta?query=EOG091G19Y2&level=33208" -O per_gene/EOG091G19Y2/EOG091G19Y2.orthodb.fasta 1> per_gene/EOG091G19Y2/get_outgroups.stdout.txt 2> per_gene/EOG091G19Y2/get_outgroups.stderr.txt && break || echo -e "try again ($i)" && sleep 15
        done

	#This is quick an dirty for now and just takes the first protein if there is more than one for an outgroup taxon
        bash ../scripts/download_outgroups.sh taxids.txt per_gene/EOG091G19Y2/EOG091G19Y2.orthodb.fasta > per_gene/EOG091G19Y2/EOG091G19Y2.outgroup.fasta
        
[Mon Jul  6 00:24:09 2020]
Finished job 2941.
3060 of 3292 steps (93%) done

[Mon Jul  6 00:24:09 2020]
rule join_groups:
    input: per_gene/EOG091G19Y2/EOG091G19Y2.ingroup.fasta, per_gene/EOG091G19Y2/EOG091G19Y2.outgroup.fasta
    output: per_gene/EOG091G19Y2/EOG091G19Y2.fasta
    jobid: 2294
    wildcards: BUSCO=EOG091G19Y2


        cat per_gene/EOG091G19Y2/EOG091G19Y2.ingroup.fasta per_gene/EOG091G19Y2/EOG091G19Y2.outgroup.fasta > per_gene/EOG091G19Y2/EOG091G19Y2.fasta
        
[Mon Jul  6 00:24:09 2020]
Finished job 2294.
3061 of 3292 steps (93%) done

[Mon Jul  6 00:24:09 2020]
rule MSA:
    input: per_gene/EOG091G19Y2/EOG091G19Y2.fasta
    output: per_gene/EOG091G19Y2/EOG091G19Y2.clustalo.fasta
    log: per_gene/EOG091G19Y2/MSA.stdout.txt, per_gene/EOG091G19Y2/MSA.stderr.txt
    jobid: 1708
    wildcards: BUSCO=EOG091G19Y2
    threads: 2


        clustalo -i per_gene/EOG091G19Y2/EOG091G19Y2.fasta -o per_gene/EOG091G19Y2/EOG091G19Y2.clustalo.fasta --threads=2 1> per_gene/EOG091G19Y2/MSA.stdout.txt 2> per_gene/EOG091G19Y2/MSA.stderr.txt
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/d68c9691725a7401923680874285c430.simg
[Mon Jul  6 00:24:09 2020]
Finished job 1708.
3062 of 3292 steps (93%) done

[Mon Jul  6 00:24:09 2020]
rule score_and_cut:
    input: per_gene/EOG091G19Y2/EOG091G19Y2.clustalo.fasta
    output: per_gene/EOG091G19Y2/ALICUT_EOG091G19Y2.clustalo.fasta
    jobid: 885
    wildcards: BUSCO=EOG091G19Y2
    threads: 2


        cd per_gene/EOG091G19Y2
        Aliscore.pl -N -r 200000000000000000 -i ../../per_gene/EOG091G19Y2/EOG091G19Y2.clustalo.fasta &> aliscore.log
        ALICUT.pl -s &> alicut.log
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/63c88c27a0fa300f57066b0ef65fefcb.simg
[Mon Jul  6 00:24:11 2020]
Finished job 3174.
3063 of 3292 steps (93%) done

[Mon Jul  6 00:24:11 2020]
rule get_outgroups:
    input: per_gene/EOG091G0ARE/EOG091G0ARE.ingroup.fasta
    output: per_gene/EOG091G0ARE/EOG091G0ARE.orthodb.fasta, per_gene/EOG091G0ARE/EOG091G0ARE.outgroup.fasta
    log: per_gene/EOG091G0ARE/get_outgroups.stdout.txt, per_gene/EOG091G0ARE/get_outgroups.stderr.txt
    jobid: 3175
    wildcards: BUSCO=EOG091G0ARE


        #download fastas from Orhtodb for BUSCO id
        for i in {1..5}
        do
             wget "http://www.orthodb.org/fasta?query=EOG091G0ARE&level=33208" -O per_gene/EOG091G0ARE/EOG091G0ARE.orthodb.fasta 1> per_gene/EOG091G0ARE/get_outgroups.stdout.txt 2> per_gene/EOG091G0ARE/get_outgroups.stderr.txt && break || echo -e "try again ($i)" && sleep 15
        done

	#This is quick an dirty for now and just takes the first protein if there is more than one for an outgroup taxon
        bash ../scripts/download_outgroups.sh taxids.txt per_gene/EOG091G0ARE/EOG091G0ARE.orthodb.fasta > per_gene/EOG091G0ARE/EOG091G0ARE.outgroup.fasta
        
[Mon Jul  6 00:24:12 2020]
Finished job 3175.
3064 of 3292 steps (93%) done

[Mon Jul  6 00:24:12 2020]
rule join_groups:
    input: per_gene/EOG091G0ARE/EOG091G0ARE.ingroup.fasta, per_gene/EOG091G0ARE/EOG091G0ARE.outgroup.fasta
    output: per_gene/EOG091G0ARE/EOG091G0ARE.fasta
    jobid: 2411
    wildcards: BUSCO=EOG091G0ARE


        cat per_gene/EOG091G0ARE/EOG091G0ARE.ingroup.fasta per_gene/EOG091G0ARE/EOG091G0ARE.outgroup.fasta > per_gene/EOG091G0ARE/EOG091G0ARE.fasta
        
[Mon Jul  6 00:24:12 2020]
Finished job 2411.
3065 of 3292 steps (93%) done

[Mon Jul  6 00:24:12 2020]
rule MSA:
    input: per_gene/EOG091G0ARE/EOG091G0ARE.fasta
    output: per_gene/EOG091G0ARE/EOG091G0ARE.clustalo.fasta
    log: per_gene/EOG091G0ARE/MSA.stdout.txt, per_gene/EOG091G0ARE/MSA.stderr.txt
    jobid: 1942
    wildcards: BUSCO=EOG091G0ARE
    threads: 2


        clustalo -i per_gene/EOG091G0ARE/EOG091G0ARE.fasta -o per_gene/EOG091G0ARE/EOG091G0ARE.clustalo.fasta --threads=2 1> per_gene/EOG091G0ARE/MSA.stdout.txt 2> per_gene/EOG091G0ARE/MSA.stderr.txt
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/d68c9691725a7401923680874285c430.simg
[Mon Jul  6 00:24:14 2020]
Finished job 1942.
3066 of 3292 steps (93%) done

[Mon Jul  6 00:24:14 2020]
rule score_and_cut:
    input: per_gene/EOG091G0ARE/EOG091G0ARE.clustalo.fasta
    output: per_gene/EOG091G0ARE/ALICUT_EOG091G0ARE.clustalo.fasta
    jobid: 1119
    wildcards: BUSCO=EOG091G0ARE
    threads: 2


        cd per_gene/EOG091G0ARE
        Aliscore.pl -N -r 200000000000000000 -i ../../per_gene/EOG091G0ARE/EOG091G0ARE.clustalo.fasta &> aliscore.log
        ALICUT.pl -s &> alicut.log
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/63c88c27a0fa300f57066b0ef65fefcb.simg
[Mon Jul  6 00:24:18 2020]
Finished job 298.
3067 of 3292 steps (93%) done

[Mon Jul  6 00:24:18 2020]
rule get_seqs:
    input: /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ingroup.txt, /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/outgroup.txt
    output: per_gene/EOG091G05EU/EOG091G05EU.ingroup.fasta
    log: per_gene/EOG091G05EU/get_seqs.stdout.txt, per_gene/EOG091G05EU/get_seqs.stderr.txt
    jobid: 2536
    wildcards: BUSCO=EOG091G05EU
    threads: 2


	basedir=$(pwd)
        cd per_gene/EOG091G05EU
        
        bash $basedir/../scripts/fetch_seqs.sh EOG091G05EU /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ingroup.txt /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/outgroup.txt 1> ../../per_gene/EOG091G05EU/get_seqs.stdout.txt 2> ../../per_gene/EOG091G05EU/get_seqs.stderr.txt
	mv EOG091G05EU.fasta $basedir/per_gene/EOG091G05EU/EOG091G05EU.ingroup.fasta
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/72476f9d9a5bd0627b4d721143a21354.simg
[Mon Jul  6 00:24:19 2020]
Finished job 885.
3068 of 3292 steps (93%) done

[Mon Jul  6 00:24:19 2020]
rule remove_empty:
    input: per_gene/EOG091G19Y2/ALICUT_EOG091G19Y2.clustalo.fasta
    output: per_gene/EOG091G19Y2/empty_check.done
    jobid: 1707
    wildcards: BUSCO=EOG091G19Y2


         if [ "$(cat per_gene/EOG091G19Y2/ALICUT_EOG091G19Y2.clustalo.fasta | grep -v ">" | sed 's/-//g' | grep "^$" | wc -l)" -gt 0 ]
         then
              cp per_gene/EOG091G19Y2/ALICUT_EOG091G19Y2.clustalo.fasta per_gene/EOG091G19Y2/ALICUT_EOG091G19Y2.clustalo.fasta.backup
              bash ../scripts/remove_empty.sh per_gene/EOG091G19Y2/ALICUT_EOG091G19Y2.clustalo.fasta.backup > per_gene/EOG091G19Y2/ALICUT_EOG091G19Y2.clustalo.fasta
         fi
         touch per_gene/EOG091G19Y2/empty_check.done
         
[Mon Jul  6 00:24:19 2020]
Finished job 1707.
3069 of 3292 steps (93%) done

[Mon Jul  6 00:24:19 2020]
rule find_best_model:
    input: per_gene/EOG091G19Y2/ALICUT_EOG091G19Y2.clustalo.fasta, per_gene/EOG091G19Y2/empty_check.done
    output: per_gene/EOG091G19Y2/EOG091G19Y2.best_model
    log: per_gene/EOG091G19Y2/find_best_model.stderr.txt
    jobid: 884
    wildcards: BUSCO=EOG091G19Y2
    threads: 2


        cd per_gene/EOG091G19Y2
        if [ ! -d find_best_model ]
        then
            mkdir find_best_model
        fi
        cd find_best_model
        ln -s ../../../per_gene/EOG091G19Y2/ALICUT_EOG091G19Y2.clustalo.fasta EOG091G19Y2.fasta
        ProteinModelSelection.pl EOG091G19Y2.fasta 1> ../../../per_gene/EOG091G19Y2/EOG091G19Y2.best_model 2> ../../../per_gene/EOG091G19Y2/find_best_model.stderr.txt
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/c0c09ee657b1e27f2c5687e0e9aa8d70.simg
[Mon Jul  6 00:24:25 2020]
Finished job 1119.
3070 of 3292 steps (93%) done

[Mon Jul  6 00:24:25 2020]
rule remove_empty:
    input: per_gene/EOG091G0ARE/ALICUT_EOG091G0ARE.clustalo.fasta
    output: per_gene/EOG091G0ARE/empty_check.done
    jobid: 1941
    wildcards: BUSCO=EOG091G0ARE


         if [ "$(cat per_gene/EOG091G0ARE/ALICUT_EOG091G0ARE.clustalo.fasta | grep -v ">" | sed 's/-//g' | grep "^$" | wc -l)" -gt 0 ]
         then
              cp per_gene/EOG091G0ARE/ALICUT_EOG091G0ARE.clustalo.fasta per_gene/EOG091G0ARE/ALICUT_EOG091G0ARE.clustalo.fasta.backup
              bash ../scripts/remove_empty.sh per_gene/EOG091G0ARE/ALICUT_EOG091G0ARE.clustalo.fasta.backup > per_gene/EOG091G0ARE/ALICUT_EOG091G0ARE.clustalo.fasta
         fi
         touch per_gene/EOG091G0ARE/empty_check.done
         
[Mon Jul  6 00:24:25 2020]
Finished job 1941.
3071 of 3292 steps (93%) done

[Mon Jul  6 00:24:25 2020]
rule find_best_model:
    input: per_gene/EOG091G0ARE/ALICUT_EOG091G0ARE.clustalo.fasta, per_gene/EOG091G0ARE/empty_check.done
    output: per_gene/EOG091G0ARE/EOG091G0ARE.best_model
    log: per_gene/EOG091G0ARE/find_best_model.stderr.txt
    jobid: 1118
    wildcards: BUSCO=EOG091G0ARE
    threads: 2


        cd per_gene/EOG091G0ARE
        if [ ! -d find_best_model ]
        then
            mkdir find_best_model
        fi
        cd find_best_model
        ln -s ../../../per_gene/EOG091G0ARE/ALICUT_EOG091G0ARE.clustalo.fasta EOG091G0ARE.fasta
        ProteinModelSelection.pl EOG091G0ARE.fasta 1> ../../../per_gene/EOG091G0ARE/EOG091G0ARE.best_model 2> ../../../per_gene/EOG091G0ARE/find_best_model.stderr.txt
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/c0c09ee657b1e27f2c5687e0e9aa8d70.simg
[Mon Jul  6 00:24:27 2020]
Finished job 331.
3072 of 3292 steps (93%) done

[Mon Jul  6 00:24:27 2020]
rule get_seqs:
    input: /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ingroup.txt, /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/outgroup.txt
    output: per_gene/EOG091G0RCI/EOG091G0RCI.ingroup.fasta
    log: per_gene/EOG091G0RCI/get_seqs.stdout.txt, per_gene/EOG091G0RCI/get_seqs.stderr.txt
    jobid: 3014
    wildcards: BUSCO=EOG091G0RCI
    threads: 2


	basedir=$(pwd)
        cd per_gene/EOG091G0RCI
        
        bash $basedir/../scripts/fetch_seqs.sh EOG091G0RCI /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ingroup.txt /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/outgroup.txt 1> ../../per_gene/EOG091G0RCI/get_seqs.stdout.txt 2> ../../per_gene/EOG091G0RCI/get_seqs.stderr.txt
	mv EOG091G0RCI.fasta $basedir/per_gene/EOG091G0RCI/EOG091G0RCI.ingroup.fasta
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/72476f9d9a5bd0627b4d721143a21354.simg
[Mon Jul  6 00:24:33 2020]
Finished job 2536.
3073 of 3292 steps (93%) done

[Mon Jul  6 00:24:33 2020]
rule get_outgroups:
    input: per_gene/EOG091G05EU/EOG091G05EU.ingroup.fasta
    output: per_gene/EOG091G05EU/EOG091G05EU.orthodb.fasta, per_gene/EOG091G05EU/EOG091G05EU.outgroup.fasta
    log: per_gene/EOG091G05EU/get_outgroups.stdout.txt, per_gene/EOG091G05EU/get_outgroups.stderr.txt
    jobid: 2537
    wildcards: BUSCO=EOG091G05EU


        #download fastas from Orhtodb for BUSCO id
        for i in {1..5}
        do
             wget "http://www.orthodb.org/fasta?query=EOG091G05EU&level=33208" -O per_gene/EOG091G05EU/EOG091G05EU.orthodb.fasta 1> per_gene/EOG091G05EU/get_outgroups.stdout.txt 2> per_gene/EOG091G05EU/get_outgroups.stderr.txt && break || echo -e "try again ($i)" && sleep 15
        done

	#This is quick an dirty for now and just takes the first protein if there is more than one for an outgroup taxon
        bash ../scripts/download_outgroups.sh taxids.txt per_gene/EOG091G05EU/EOG091G05EU.orthodb.fasta > per_gene/EOG091G05EU/EOG091G05EU.outgroup.fasta
        
[Mon Jul  6 00:24:34 2020]
Finished job 2537.
3074 of 3292 steps (93%) done

[Mon Jul  6 00:24:34 2020]
rule join_groups:
    input: per_gene/EOG091G05EU/EOG091G05EU.ingroup.fasta, per_gene/EOG091G05EU/EOG091G05EU.outgroup.fasta
    output: per_gene/EOG091G05EU/EOG091G05EU.fasta
    jobid: 2092
    wildcards: BUSCO=EOG091G05EU


        cat per_gene/EOG091G05EU/EOG091G05EU.ingroup.fasta per_gene/EOG091G05EU/EOG091G05EU.outgroup.fasta > per_gene/EOG091G05EU/EOG091G05EU.fasta
        
[Mon Jul  6 00:24:34 2020]
Finished job 2092.
3075 of 3292 steps (93%) done

[Mon Jul  6 00:24:34 2020]
rule MSA:
    input: per_gene/EOG091G05EU/EOG091G05EU.fasta
    output: per_gene/EOG091G05EU/EOG091G05EU.clustalo.fasta
    log: per_gene/EOG091G05EU/MSA.stdout.txt, per_gene/EOG091G05EU/MSA.stderr.txt
    jobid: 1304
    wildcards: BUSCO=EOG091G05EU
    threads: 2


        clustalo -i per_gene/EOG091G05EU/EOG091G05EU.fasta -o per_gene/EOG091G05EU/EOG091G05EU.clustalo.fasta --threads=2 1> per_gene/EOG091G05EU/MSA.stdout.txt 2> per_gene/EOG091G05EU/MSA.stderr.txt
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/d68c9691725a7401923680874285c430.simg
[Mon Jul  6 00:24:35 2020]
Finished job 1304.
3076 of 3292 steps (93%) done

[Mon Jul  6 00:24:35 2020]
rule score_and_cut:
    input: per_gene/EOG091G05EU/EOG091G05EU.clustalo.fasta
    output: per_gene/EOG091G05EU/ALICUT_EOG091G05EU.clustalo.fasta
    jobid: 481
    wildcards: BUSCO=EOG091G05EU
    threads: 2


        cd per_gene/EOG091G05EU
        Aliscore.pl -N -r 200000000000000000 -i ../../per_gene/EOG091G05EU/EOG091G05EU.clustalo.fasta &> aliscore.log
        ALICUT.pl -s &> alicut.log
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/63c88c27a0fa300f57066b0ef65fefcb.simg
[Mon Jul  6 00:24:41 2020]
Finished job 3014.
3077 of 3292 steps (93%) done

[Mon Jul  6 00:24:41 2020]
rule get_outgroups:
    input: per_gene/EOG091G0RCI/EOG091G0RCI.ingroup.fasta
    output: per_gene/EOG091G0RCI/EOG091G0RCI.orthodb.fasta, per_gene/EOG091G0RCI/EOG091G0RCI.outgroup.fasta
    log: per_gene/EOG091G0RCI/get_outgroups.stdout.txt, per_gene/EOG091G0RCI/get_outgroups.stderr.txt
    jobid: 3015
    wildcards: BUSCO=EOG091G0RCI


        #download fastas from Orhtodb for BUSCO id
        for i in {1..5}
        do
             wget "http://www.orthodb.org/fasta?query=EOG091G0RCI&level=33208" -O per_gene/EOG091G0RCI/EOG091G0RCI.orthodb.fasta 1> per_gene/EOG091G0RCI/get_outgroups.stdout.txt 2> per_gene/EOG091G0RCI/get_outgroups.stderr.txt && break || echo -e "try again ($i)" && sleep 15
        done

	#This is quick an dirty for now and just takes the first protein if there is more than one for an outgroup taxon
        bash ../scripts/download_outgroups.sh taxids.txt per_gene/EOG091G0RCI/EOG091G0RCI.orthodb.fasta > per_gene/EOG091G0RCI/EOG091G0RCI.outgroup.fasta
        
[Mon Jul  6 00:24:42 2020]
Finished job 3015.
3078 of 3292 steps (93%) done

[Mon Jul  6 00:24:42 2020]
rule join_groups:
    input: per_gene/EOG091G0RCI/EOG091G0RCI.ingroup.fasta, per_gene/EOG091G0RCI/EOG091G0RCI.outgroup.fasta
    output: per_gene/EOG091G0RCI/EOG091G0RCI.fasta
    jobid: 2331
    wildcards: BUSCO=EOG091G0RCI


        cat per_gene/EOG091G0RCI/EOG091G0RCI.ingroup.fasta per_gene/EOG091G0RCI/EOG091G0RCI.outgroup.fasta > per_gene/EOG091G0RCI/EOG091G0RCI.fasta
        
[Mon Jul  6 00:24:42 2020]
Finished job 2331.
3079 of 3292 steps (94%) done

[Mon Jul  6 00:24:42 2020]
rule MSA:
    input: per_gene/EOG091G0RCI/EOG091G0RCI.fasta
    output: per_gene/EOG091G0RCI/EOG091G0RCI.clustalo.fasta
    log: per_gene/EOG091G0RCI/MSA.stdout.txt, per_gene/EOG091G0RCI/MSA.stderr.txt
    jobid: 1782
    wildcards: BUSCO=EOG091G0RCI
    threads: 2


        clustalo -i per_gene/EOG091G0RCI/EOG091G0RCI.fasta -o per_gene/EOG091G0RCI/EOG091G0RCI.clustalo.fasta --threads=2 1> per_gene/EOG091G0RCI/MSA.stdout.txt 2> per_gene/EOG091G0RCI/MSA.stderr.txt
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/d68c9691725a7401923680874285c430.simg
[Mon Jul  6 00:24:43 2020]
Finished job 1782.
3080 of 3292 steps (94%) done

[Mon Jul  6 00:24:43 2020]
rule score_and_cut:
    input: per_gene/EOG091G0RCI/EOG091G0RCI.clustalo.fasta
    output: per_gene/EOG091G0RCI/ALICUT_EOG091G0RCI.clustalo.fasta
    jobid: 959
    wildcards: BUSCO=EOG091G0RCI
    threads: 2


        cd per_gene/EOG091G0RCI
        Aliscore.pl -N -r 200000000000000000 -i ../../per_gene/EOG091G0RCI/EOG091G0RCI.clustalo.fasta &> aliscore.log
        ALICUT.pl -s &> alicut.log
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/63c88c27a0fa300f57066b0ef65fefcb.simg
[Mon Jul  6 00:24:45 2020]
Finished job 884.
3081 of 3292 steps (94%) done

[Mon Jul  6 00:24:45 2020]
rule infer_single_ML:
    input: per_gene/EOG091G19Y2/EOG091G19Y2.best_model, per_gene/EOG091G19Y2/ALICUT_EOG091G19Y2.clustalo.fasta
    output: per_gene/EOG091G19Y2/EOG091G19Y2.raxml.done
    log: per_gene/EOG091G19Y2/infer_single_ML.stdout.txt, per_gene/EOG091G19Y2/infer_single_ML.stderr.txt
    jobid: 236
    wildcards: BUSCO=EOG091G19Y2
    threads: 2


        cd per_gene/EOG091G19Y2
	count=$(cat ../../per_gene/EOG091G19Y2/ALICUT_EOG091G19Y2.clustalo.fasta | grep ">" | wc -l)
	if [ "$count" -gt 5 ]
        then
		RAxMLmodel=$(cat ../../per_gene/EOG091G19Y2/EOG091G19Y2.best_model | grep "Best" | cut -d ":" -f 2 | tr -d '[:space:]')
                if [ "$(ls -1 | grep "^RAxML" | wc -l)" -ne 0 ]
		then
			rm RAxML*
		fi
        	raxml -f a -T 2 -m PROTGAMMA$RAxMLmodel         	-p 12345 -x 12345 -# 100         	-s ../../per_gene/EOG091G19Y2/ALICUT_EOG091G19Y2.clustalo.fasta -n EOG091G19Y2.clustalo.aln.ALICUT.$RAxMLmodel 		1> ../../per_gene/EOG091G19Y2/infer_single_ML.stdout.txt 2> ../../per_gene/EOG091G19Y2/infer_single_ML.stderr.txt
	else
		echo "fasta file per_gene/EOG091G19Y2/ALICUT_EOG091G19Y2.clustalo.fasta contains fewer than 5 sequences - skipped" > ../../per_gene/EOG091G19Y2/infer_single_ML.stdout.txt
		touch raxml.skipped
	fi
        touch ../../per_gene/EOG091G19Y2/EOG091G19Y2.raxml.done
        
[Mon Jul  6 00:24:45 2020]
Finished job 481.
3082 of 3292 steps (94%) done

[Mon Jul  6 00:24:45 2020]
rule remove_empty:
    input: per_gene/EOG091G05EU/ALICUT_EOG091G05EU.clustalo.fasta
    output: per_gene/EOG091G05EU/empty_check.done
    jobid: 1303
    wildcards: BUSCO=EOG091G05EU


         if [ "$(cat per_gene/EOG091G05EU/ALICUT_EOG091G05EU.clustalo.fasta | grep -v ">" | sed 's/-//g' | grep "^$" | wc -l)" -gt 0 ]
         then
              cp per_gene/EOG091G05EU/ALICUT_EOG091G05EU.clustalo.fasta per_gene/EOG091G05EU/ALICUT_EOG091G05EU.clustalo.fasta.backup
              bash ../scripts/remove_empty.sh per_gene/EOG091G05EU/ALICUT_EOG091G05EU.clustalo.fasta.backup > per_gene/EOG091G05EU/ALICUT_EOG091G05EU.clustalo.fasta
         fi
         touch per_gene/EOG091G05EU/empty_check.done
         
[Mon Jul  6 00:24:45 2020]
Finished job 1303.
3083 of 3292 steps (94%) done

[Mon Jul  6 00:24:45 2020]
rule find_best_model:
    input: per_gene/EOG091G05EU/ALICUT_EOG091G05EU.clustalo.fasta, per_gene/EOG091G05EU/empty_check.done
    output: per_gene/EOG091G05EU/EOG091G05EU.best_model
    log: per_gene/EOG091G05EU/find_best_model.stderr.txt
    jobid: 480
    wildcards: BUSCO=EOG091G05EU
    threads: 2


        cd per_gene/EOG091G05EU
        if [ ! -d find_best_model ]
        then
            mkdir find_best_model
        fi
        cd find_best_model
        ln -s ../../../per_gene/EOG091G05EU/ALICUT_EOG091G05EU.clustalo.fasta EOG091G05EU.fasta
        ProteinModelSelection.pl EOG091G05EU.fasta 1> ../../../per_gene/EOG091G05EU/EOG091G05EU.best_model 2> ../../../per_gene/EOG091G05EU/find_best_model.stderr.txt
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/c0c09ee657b1e27f2c5687e0e9aa8d70.simg
[33mJob counts:
	count	jobs
	1	infer_single_ML
	1[0m
[33m
        cd per_gene/EOG091G19Y2
	count=$(cat ../../per_gene/EOG091G19Y2/ALICUT_EOG091G19Y2.clustalo.fasta | grep ">" | wc -l)
	if [ "$count" -gt 5 ]
        then
		RAxMLmodel=$(cat ../../per_gene/EOG091G19Y2/EOG091G19Y2.best_model | grep "Best" | cut -d ":" -f 2 | tr -d '[:space:]')
                if [ "$(ls -1 | grep "^RAxML" | wc -l)" -ne 0 ]
		then
			rm RAxML*
		fi
        	raxml -f a -T 2 -m PROTGAMMA$RAxMLmodel         	-p 12345 -x 12345 -# 100         	-s ../../per_gene/EOG091G19Y2/ALICUT_EOG091G19Y2.clustalo.fasta -n EOG091G19Y2.clustalo.aln.ALICUT.$RAxMLmodel 		1> ../../per_gene/EOG091G19Y2/infer_single_ML.stdout.txt 2> ../../per_gene/EOG091G19Y2/infer_single_ML.stderr.txt
	else
		echo "fasta file per_gene/EOG091G19Y2/ALICUT_EOG091G19Y2.clustalo.fasta contains fewer than 5 sequences - skipped" > ../../per_gene/EOG091G19Y2/infer_single_ML.stdout.txt
		touch raxml.skipped
	fi
        touch ../../per_gene/EOG091G19Y2/EOG091G19Y2.raxml.done
        [0m
[Mon Jul  6 00:24:49 2020]
Finished job 208.
3084 of 3292 steps (94%) done

[Mon Jul  6 00:24:49 2020]
rule get_seqs:
    input: /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ingroup.txt, /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/outgroup.txt
    output: per_gene/EOG091G0NIU/EOG091G0NIU.ingroup.fasta
    log: per_gene/EOG091G0NIU/get_seqs.stdout.txt, per_gene/EOG091G0NIU/get_seqs.stderr.txt
    jobid: 3238
    wildcards: BUSCO=EOG091G0NIU
    threads: 2


	basedir=$(pwd)
        cd per_gene/EOG091G0NIU
        
        bash $basedir/../scripts/fetch_seqs.sh EOG091G0NIU /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ingroup.txt /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/outgroup.txt 1> ../../per_gene/EOG091G0NIU/get_seqs.stdout.txt 2> ../../per_gene/EOG091G0NIU/get_seqs.stderr.txt
	mv EOG091G0NIU.fasta $basedir/per_gene/EOG091G0NIU/EOG091G0NIU.ingroup.fasta
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/72476f9d9a5bd0627b4d721143a21354.simg
[Mon Jul  6 00:24:51 2020]
Finished job 192.
3085 of 3292 steps (94%) done

[Mon Jul  6 00:24:51 2020]
rule get_seqs:
    input: /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ingroup.txt, /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/outgroup.txt
    output: per_gene/EOG091G04FV/EOG091G04FV.ingroup.fasta
    log: per_gene/EOG091G04FV/get_seqs.stdout.txt, per_gene/EOG091G04FV/get_seqs.stderr.txt
    jobid: 2952
    wildcards: BUSCO=EOG091G04FV
    threads: 2


	basedir=$(pwd)
        cd per_gene/EOG091G04FV
        
        bash $basedir/../scripts/fetch_seqs.sh EOG091G04FV /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ingroup.txt /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/outgroup.txt 1> ../../per_gene/EOG091G04FV/get_seqs.stdout.txt 2> ../../per_gene/EOG091G04FV/get_seqs.stderr.txt
	mv EOG091G04FV.fasta $basedir/per_gene/EOG091G04FV/EOG091G04FV.ingroup.fasta
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/72476f9d9a5bd0627b4d721143a21354.simg
[Mon Jul  6 00:24:52 2020]
Finished job 959.
3086 of 3292 steps (94%) done

[Mon Jul  6 00:24:52 2020]
rule remove_empty:
    input: per_gene/EOG091G0RCI/ALICUT_EOG091G0RCI.clustalo.fasta
    output: per_gene/EOG091G0RCI/empty_check.done
    jobid: 1781
    wildcards: BUSCO=EOG091G0RCI


         if [ "$(cat per_gene/EOG091G0RCI/ALICUT_EOG091G0RCI.clustalo.fasta | grep -v ">" | sed 's/-//g' | grep "^$" | wc -l)" -gt 0 ]
         then
              cp per_gene/EOG091G0RCI/ALICUT_EOG091G0RCI.clustalo.fasta per_gene/EOG091G0RCI/ALICUT_EOG091G0RCI.clustalo.fasta.backup
              bash ../scripts/remove_empty.sh per_gene/EOG091G0RCI/ALICUT_EOG091G0RCI.clustalo.fasta.backup > per_gene/EOG091G0RCI/ALICUT_EOG091G0RCI.clustalo.fasta
         fi
         touch per_gene/EOG091G0RCI/empty_check.done
         
[Mon Jul  6 00:24:52 2020]
Finished job 1781.
3087 of 3292 steps (94%) done

[Mon Jul  6 00:24:52 2020]
rule find_best_model:
    input: per_gene/EOG091G0RCI/ALICUT_EOG091G0RCI.clustalo.fasta, per_gene/EOG091G0RCI/empty_check.done
    output: per_gene/EOG091G0RCI/EOG091G0RCI.best_model
    log: per_gene/EOG091G0RCI/find_best_model.stderr.txt
    jobid: 958
    wildcards: BUSCO=EOG091G0RCI
    threads: 2


        cd per_gene/EOG091G0RCI
        if [ ! -d find_best_model ]
        then
            mkdir find_best_model
        fi
        cd find_best_model
        ln -s ../../../per_gene/EOG091G0RCI/ALICUT_EOG091G0RCI.clustalo.fasta EOG091G0RCI.fasta
        ProteinModelSelection.pl EOG091G0RCI.fasta 1> ../../../per_gene/EOG091G0RCI/EOG091G0RCI.best_model 2> ../../../per_gene/EOG091G0RCI/find_best_model.stderr.txt
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/c0c09ee657b1e27f2c5687e0e9aa8d70.simg
[Mon Jul  6 00:25:01 2020]
Finished job 133.
3088 of 3292 steps (94%) done

[Mon Jul  6 00:25:01 2020]
rule get_seqs:
    input: /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ingroup.txt, /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/outgroup.txt
    output: per_gene/EOG091G11CG/EOG091G11CG.ingroup.fasta
    log: per_gene/EOG091G11CG/get_seqs.stdout.txt, per_gene/EOG091G11CG/get_seqs.stderr.txt
    jobid: 2920
    wildcards: BUSCO=EOG091G11CG
    threads: 2


	basedir=$(pwd)
        cd per_gene/EOG091G11CG
        
        bash $basedir/../scripts/fetch_seqs.sh EOG091G11CG /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ingroup.txt /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/outgroup.txt 1> ../../per_gene/EOG091G11CG/get_seqs.stdout.txt 2> ../../per_gene/EOG091G11CG/get_seqs.stderr.txt
	mv EOG091G11CG.fasta $basedir/per_gene/EOG091G11CG/EOG091G11CG.ingroup.fasta
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/72476f9d9a5bd0627b4d721143a21354.simg
[Mon Jul  6 00:25:05 2020]
Finished job 3238.
3089 of 3292 steps (94%) done

[Mon Jul  6 00:25:05 2020]
rule get_outgroups:
    input: per_gene/EOG091G0NIU/EOG091G0NIU.ingroup.fasta
    output: per_gene/EOG091G0NIU/EOG091G0NIU.orthodb.fasta, per_gene/EOG091G0NIU/EOG091G0NIU.outgroup.fasta
    log: per_gene/EOG091G0NIU/get_outgroups.stdout.txt, per_gene/EOG091G0NIU/get_outgroups.stderr.txt
    jobid: 3239
    wildcards: BUSCO=EOG091G0NIU


        #download fastas from Orhtodb for BUSCO id
        for i in {1..5}
        do
             wget "http://www.orthodb.org/fasta?query=EOG091G0NIU&level=33208" -O per_gene/EOG091G0NIU/EOG091G0NIU.orthodb.fasta 1> per_gene/EOG091G0NIU/get_outgroups.stdout.txt 2> per_gene/EOG091G0NIU/get_outgroups.stderr.txt && break || echo -e "try again ($i)" && sleep 15
        done

	#This is quick an dirty for now and just takes the first protein if there is more than one for an outgroup taxon
        bash ../scripts/download_outgroups.sh taxids.txt per_gene/EOG091G0NIU/EOG091G0NIU.orthodb.fasta > per_gene/EOG091G0NIU/EOG091G0NIU.outgroup.fasta
        
[Mon Jul  6 00:25:06 2020]
Finished job 3239.
3090 of 3292 steps (94%) done

[Mon Jul  6 00:25:06 2020]
rule join_groups:
    input: per_gene/EOG091G0NIU/EOG091G0NIU.ingroup.fasta, per_gene/EOG091G0NIU/EOG091G0NIU.outgroup.fasta
    output: per_gene/EOG091G0NIU/EOG091G0NIU.fasta
    jobid: 2443
    wildcards: BUSCO=EOG091G0NIU


        cat per_gene/EOG091G0NIU/EOG091G0NIU.ingroup.fasta per_gene/EOG091G0NIU/EOG091G0NIU.outgroup.fasta > per_gene/EOG091G0NIU/EOG091G0NIU.fasta
        
[Mon Jul  6 00:25:06 2020]
Finished job 2443.
3091 of 3292 steps (94%) done

[Mon Jul  6 00:25:06 2020]
rule MSA:
    input: per_gene/EOG091G0NIU/EOG091G0NIU.fasta
    output: per_gene/EOG091G0NIU/EOG091G0NIU.clustalo.fasta
    log: per_gene/EOG091G0NIU/MSA.stdout.txt, per_gene/EOG091G0NIU/MSA.stderr.txt
    jobid: 2006
    wildcards: BUSCO=EOG091G0NIU
    threads: 2


        clustalo -i per_gene/EOG091G0NIU/EOG091G0NIU.fasta -o per_gene/EOG091G0NIU/EOG091G0NIU.clustalo.fasta --threads=2 1> per_gene/EOG091G0NIU/MSA.stdout.txt 2> per_gene/EOG091G0NIU/MSA.stderr.txt
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/d68c9691725a7401923680874285c430.simg
[Mon Jul  6 00:25:06 2020]
Finished job 2952.
3092 of 3292 steps (94%) done

[Mon Jul  6 00:25:06 2020]
rule get_outgroups:
    input: per_gene/EOG091G04FV/EOG091G04FV.ingroup.fasta
    output: per_gene/EOG091G04FV/EOG091G04FV.orthodb.fasta, per_gene/EOG091G04FV/EOG091G04FV.outgroup.fasta
    log: per_gene/EOG091G04FV/get_outgroups.stdout.txt, per_gene/EOG091G04FV/get_outgroups.stderr.txt
    jobid: 2953
    wildcards: BUSCO=EOG091G04FV


        #download fastas from Orhtodb for BUSCO id
        for i in {1..5}
        do
             wget "http://www.orthodb.org/fasta?query=EOG091G04FV&level=33208" -O per_gene/EOG091G04FV/EOG091G04FV.orthodb.fasta 1> per_gene/EOG091G04FV/get_outgroups.stdout.txt 2> per_gene/EOG091G04FV/get_outgroups.stderr.txt && break || echo -e "try again ($i)" && sleep 15
        done

	#This is quick an dirty for now and just takes the first protein if there is more than one for an outgroup taxon
        bash ../scripts/download_outgroups.sh taxids.txt per_gene/EOG091G04FV/EOG091G04FV.orthodb.fasta > per_gene/EOG091G04FV/EOG091G04FV.outgroup.fasta
        
[Mon Jul  6 00:25:06 2020]
Finished job 2006.
3093 of 3292 steps (94%) done

[Mon Jul  6 00:25:06 2020]
rule score_and_cut:
    input: per_gene/EOG091G0NIU/EOG091G0NIU.clustalo.fasta
    output: per_gene/EOG091G0NIU/ALICUT_EOG091G0NIU.clustalo.fasta
    jobid: 1183
    wildcards: BUSCO=EOG091G0NIU
    threads: 2


        cd per_gene/EOG091G0NIU
        Aliscore.pl -N -r 200000000000000000 -i ../../per_gene/EOG091G0NIU/EOG091G0NIU.clustalo.fasta &> aliscore.log
        ALICUT.pl -s &> alicut.log
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/63c88c27a0fa300f57066b0ef65fefcb.simg
[Mon Jul  6 00:25:07 2020]
Finished job 2953.
3094 of 3292 steps (94%) done
[Mon Jul  6 00:25:07 2020]
Finished job 392.
3095 of 3292 steps (94%) done

[Mon Jul  6 00:25:07 2020]
rule join_groups:
    input: per_gene/EOG091G04FV/EOG091G04FV.ingroup.fasta, per_gene/EOG091G04FV/EOG091G04FV.outgroup.fasta
    output: per_gene/EOG091G04FV/EOG091G04FV.fasta
    jobid: 2300
    wildcards: BUSCO=EOG091G04FV


        cat per_gene/EOG091G04FV/EOG091G04FV.ingroup.fasta per_gene/EOG091G04FV/EOG091G04FV.outgroup.fasta > per_gene/EOG091G04FV/EOG091G04FV.fasta
        

[Mon Jul  6 00:25:07 2020]
rule get_seqs:
    input: /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ingroup.txt, /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/outgroup.txt
    output: per_gene/EOG091G0BUH/EOG091G0BUH.ingroup.fasta
    log: per_gene/EOG091G0BUH/get_seqs.stdout.txt, per_gene/EOG091G0BUH/get_seqs.stderr.txt
    jobid: 3178
    wildcards: BUSCO=EOG091G0BUH
    threads: 2


	basedir=$(pwd)
        cd per_gene/EOG091G0BUH
        
        bash $basedir/../scripts/fetch_seqs.sh EOG091G0BUH /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ingroup.txt /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/outgroup.txt 1> ../../per_gene/EOG091G0BUH/get_seqs.stdout.txt 2> ../../per_gene/EOG091G0BUH/get_seqs.stderr.txt
	mv EOG091G0BUH.fasta $basedir/per_gene/EOG091G0BUH/EOG091G0BUH.ingroup.fasta
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/72476f9d9a5bd0627b4d721143a21354.simg
[Mon Jul  6 00:25:07 2020]
Finished job 2300.
3096 of 3292 steps (94%) done

[Mon Jul  6 00:25:07 2020]
rule MSA:
    input: per_gene/EOG091G04FV/EOG091G04FV.fasta
    output: per_gene/EOG091G04FV/EOG091G04FV.clustalo.fasta
    log: per_gene/EOG091G04FV/MSA.stdout.txt, per_gene/EOG091G04FV/MSA.stderr.txt
    jobid: 1720
    wildcards: BUSCO=EOG091G04FV
    threads: 2


        clustalo -i per_gene/EOG091G04FV/EOG091G04FV.fasta -o per_gene/EOG091G04FV/EOG091G04FV.clustalo.fasta --threads=2 1> per_gene/EOG091G04FV/MSA.stdout.txt 2> per_gene/EOG091G04FV/MSA.stderr.txt
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/d68c9691725a7401923680874285c430.simg
[Mon Jul  6 00:25:11 2020]
Finished job 1118.
3097 of 3292 steps (94%) done

[Mon Jul  6 00:25:11 2020]
rule infer_single_ML:
    input: per_gene/EOG091G0ARE/EOG091G0ARE.best_model, per_gene/EOG091G0ARE/ALICUT_EOG091G0ARE.clustalo.fasta
    output: per_gene/EOG091G0ARE/EOG091G0ARE.raxml.done
    log: per_gene/EOG091G0ARE/infer_single_ML.stdout.txt, per_gene/EOG091G0ARE/infer_single_ML.stderr.txt
    jobid: 353
    wildcards: BUSCO=EOG091G0ARE
    threads: 2


        cd per_gene/EOG091G0ARE
	count=$(cat ../../per_gene/EOG091G0ARE/ALICUT_EOG091G0ARE.clustalo.fasta | grep ">" | wc -l)
	if [ "$count" -gt 5 ]
        then
		RAxMLmodel=$(cat ../../per_gene/EOG091G0ARE/EOG091G0ARE.best_model | grep "Best" | cut -d ":" -f 2 | tr -d '[:space:]')
                if [ "$(ls -1 | grep "^RAxML" | wc -l)" -ne 0 ]
		then
			rm RAxML*
		fi
        	raxml -f a -T 2 -m PROTGAMMA$RAxMLmodel         	-p 12345 -x 12345 -# 100         	-s ../../per_gene/EOG091G0ARE/ALICUT_EOG091G0ARE.clustalo.fasta -n EOG091G0ARE.clustalo.aln.ALICUT.$RAxMLmodel 		1> ../../per_gene/EOG091G0ARE/infer_single_ML.stdout.txt 2> ../../per_gene/EOG091G0ARE/infer_single_ML.stderr.txt
	else
		echo "fasta file per_gene/EOG091G0ARE/ALICUT_EOG091G0ARE.clustalo.fasta contains fewer than 5 sequences - skipped" > ../../per_gene/EOG091G0ARE/infer_single_ML.stdout.txt
		touch raxml.skipped
	fi
        touch ../../per_gene/EOG091G0ARE/EOG091G0ARE.raxml.done
        
[Mon Jul  6 00:25:12 2020]
Finished job 407.
3098 of 3292 steps (94%) done

[Mon Jul  6 00:25:12 2020]
rule get_seqs:
    input: /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ingroup.txt, /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/outgroup.txt
    output: per_gene/EOG091G0MI7/EOG091G0MI7.ingroup.fasta
    log: per_gene/EOG091G0MI7/get_seqs.stdout.txt, per_gene/EOG091G0MI7/get_seqs.stderr.txt
    jobid: 3232
    wildcards: BUSCO=EOG091G0MI7
    threads: 2


	basedir=$(pwd)
        cd per_gene/EOG091G0MI7
        
        bash $basedir/../scripts/fetch_seqs.sh EOG091G0MI7 /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ingroup.txt /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/outgroup.txt 1> ../../per_gene/EOG091G0MI7/get_seqs.stdout.txt 2> ../../per_gene/EOG091G0MI7/get_seqs.stderr.txt
	mv EOG091G0MI7.fasta $basedir/per_gene/EOG091G0MI7/EOG091G0MI7.ingroup.fasta
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/72476f9d9a5bd0627b4d721143a21354.simg
[Mon Jul  6 00:25:12 2020]
Finished job 1720.
3099 of 3292 steps (94%) done

[Mon Jul  6 00:25:12 2020]
rule score_and_cut:
    input: per_gene/EOG091G04FV/EOG091G04FV.clustalo.fasta
    output: per_gene/EOG091G04FV/ALICUT_EOG091G04FV.clustalo.fasta
    jobid: 897
    wildcards: BUSCO=EOG091G04FV
    threads: 2


        cd per_gene/EOG091G04FV
        Aliscore.pl -N -r 200000000000000000 -i ../../per_gene/EOG091G04FV/EOG091G04FV.clustalo.fasta &> aliscore.log
        ALICUT.pl -s &> alicut.log
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/63c88c27a0fa300f57066b0ef65fefcb.simg
[33mJob counts:
	count	jobs
	1	infer_single_ML
	1[0m
[33m
        cd per_gene/EOG091G0ARE
	count=$(cat ../../per_gene/EOG091G0ARE/ALICUT_EOG091G0ARE.clustalo.fasta | grep ">" | wc -l)
	if [ "$count" -gt 5 ]
        then
		RAxMLmodel=$(cat ../../per_gene/EOG091G0ARE/EOG091G0ARE.best_model | grep "Best" | cut -d ":" -f 2 | tr -d '[:space:]')
                if [ "$(ls -1 | grep "^RAxML" | wc -l)" -ne 0 ]
		then
			rm RAxML*
		fi
        	raxml -f a -T 2 -m PROTGAMMA$RAxMLmodel         	-p 12345 -x 12345 -# 100         	-s ../../per_gene/EOG091G0ARE/ALICUT_EOG091G0ARE.clustalo.fasta -n EOG091G0ARE.clustalo.aln.ALICUT.$RAxMLmodel 		1> ../../per_gene/EOG091G0ARE/infer_single_ML.stdout.txt 2> ../../per_gene/EOG091G0ARE/infer_single_ML.stderr.txt
	else
		echo "fasta file per_gene/EOG091G0ARE/ALICUT_EOG091G0ARE.clustalo.fasta contains fewer than 5 sequences - skipped" > ../../per_gene/EOG091G0ARE/infer_single_ML.stdout.txt
		touch raxml.skipped
	fi
        touch ../../per_gene/EOG091G0ARE/EOG091G0ARE.raxml.done
        [0m
[Mon Jul  6 00:25:15 2020]
Finished job 1183.
3100 of 3292 steps (94%) done

[Mon Jul  6 00:25:15 2020]
rule remove_empty:
    input: per_gene/EOG091G0NIU/ALICUT_EOG091G0NIU.clustalo.fasta
    output: per_gene/EOG091G0NIU/empty_check.done
    jobid: 2005
    wildcards: BUSCO=EOG091G0NIU


         if [ "$(cat per_gene/EOG091G0NIU/ALICUT_EOG091G0NIU.clustalo.fasta | grep -v ">" | sed 's/-//g' | grep "^$" | wc -l)" -gt 0 ]
         then
              cp per_gene/EOG091G0NIU/ALICUT_EOG091G0NIU.clustalo.fasta per_gene/EOG091G0NIU/ALICUT_EOG091G0NIU.clustalo.fasta.backup
              bash ../scripts/remove_empty.sh per_gene/EOG091G0NIU/ALICUT_EOG091G0NIU.clustalo.fasta.backup > per_gene/EOG091G0NIU/ALICUT_EOG091G0NIU.clustalo.fasta
         fi
         touch per_gene/EOG091G0NIU/empty_check.done
         
[Mon Jul  6 00:25:15 2020]
Finished job 2005.
3101 of 3292 steps (94%) done

[Mon Jul  6 00:25:15 2020]
rule find_best_model:
    input: per_gene/EOG091G0NIU/ALICUT_EOG091G0NIU.clustalo.fasta, per_gene/EOG091G0NIU/empty_check.done
    output: per_gene/EOG091G0NIU/EOG091G0NIU.best_model
    log: per_gene/EOG091G0NIU/find_best_model.stderr.txt
    jobid: 1182
    wildcards: BUSCO=EOG091G0NIU
    threads: 2


        cd per_gene/EOG091G0NIU
        if [ ! -d find_best_model ]
        then
            mkdir find_best_model
        fi
        cd find_best_model
        ln -s ../../../per_gene/EOG091G0NIU/ALICUT_EOG091G0NIU.clustalo.fasta EOG091G0NIU.fasta
        ProteinModelSelection.pl EOG091G0NIU.fasta 1> ../../../per_gene/EOG091G0NIU/EOG091G0NIU.best_model 2> ../../../per_gene/EOG091G0NIU/find_best_model.stderr.txt
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/c0c09ee657b1e27f2c5687e0e9aa8d70.simg
[Mon Jul  6 00:25:18 2020]
Finished job 2920.
3102 of 3292 steps (94%) done

[Mon Jul  6 00:25:18 2020]
rule get_outgroups:
    input: per_gene/EOG091G11CG/EOG091G11CG.ingroup.fasta
    output: per_gene/EOG091G11CG/EOG091G11CG.orthodb.fasta, per_gene/EOG091G11CG/EOG091G11CG.outgroup.fasta
    log: per_gene/EOG091G11CG/get_outgroups.stdout.txt, per_gene/EOG091G11CG/get_outgroups.stderr.txt
    jobid: 2921
    wildcards: BUSCO=EOG091G11CG


        #download fastas from Orhtodb for BUSCO id
        for i in {1..5}
        do
             wget "http://www.orthodb.org/fasta?query=EOG091G11CG&level=33208" -O per_gene/EOG091G11CG/EOG091G11CG.orthodb.fasta 1> per_gene/EOG091G11CG/get_outgroups.stdout.txt 2> per_gene/EOG091G11CG/get_outgroups.stderr.txt && break || echo -e "try again ($i)" && sleep 15
        done

	#This is quick an dirty for now and just takes the first protein if there is more than one for an outgroup taxon
        bash ../scripts/download_outgroups.sh taxids.txt per_gene/EOG091G11CG/EOG091G11CG.orthodb.fasta > per_gene/EOG091G11CG/EOG091G11CG.outgroup.fasta
        
[Mon Jul  6 00:25:19 2020]
Finished job 2921.
3103 of 3292 steps (94%) done

[Mon Jul  6 00:25:19 2020]
rule join_groups:
    input: per_gene/EOG091G11CG/EOG091G11CG.ingroup.fasta, per_gene/EOG091G11CG/EOG091G11CG.outgroup.fasta
    output: per_gene/EOG091G11CG/EOG091G11CG.fasta
    jobid: 2284
    wildcards: BUSCO=EOG091G11CG


        cat per_gene/EOG091G11CG/EOG091G11CG.ingroup.fasta per_gene/EOG091G11CG/EOG091G11CG.outgroup.fasta > per_gene/EOG091G11CG/EOG091G11CG.fasta
        
[Mon Jul  6 00:25:19 2020]
Finished job 2284.
3104 of 3292 steps (94%) done

[Mon Jul  6 00:25:19 2020]
rule MSA:
    input: per_gene/EOG091G11CG/EOG091G11CG.fasta
    output: per_gene/EOG091G11CG/EOG091G11CG.clustalo.fasta
    log: per_gene/EOG091G11CG/MSA.stdout.txt, per_gene/EOG091G11CG/MSA.stderr.txt
    jobid: 1688
    wildcards: BUSCO=EOG091G11CG
    threads: 2


        clustalo -i per_gene/EOG091G11CG/EOG091G11CG.fasta -o per_gene/EOG091G11CG/EOG091G11CG.clustalo.fasta --threads=2 1> per_gene/EOG091G11CG/MSA.stdout.txt 2> per_gene/EOG091G11CG/MSA.stderr.txt
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/d68c9691725a7401923680874285c430.simg
[Mon Jul  6 00:25:19 2020]
Finished job 958.
3105 of 3292 steps (94%) done

[Mon Jul  6 00:25:19 2020]
rule infer_single_ML:
    input: per_gene/EOG091G0RCI/EOG091G0RCI.best_model, per_gene/EOG091G0RCI/ALICUT_EOG091G0RCI.clustalo.fasta
    output: per_gene/EOG091G0RCI/EOG091G0RCI.raxml.done
    log: per_gene/EOG091G0RCI/infer_single_ML.stdout.txt, per_gene/EOG091G0RCI/infer_single_ML.stderr.txt
    jobid: 273
    wildcards: BUSCO=EOG091G0RCI
    threads: 2


        cd per_gene/EOG091G0RCI
	count=$(cat ../../per_gene/EOG091G0RCI/ALICUT_EOG091G0RCI.clustalo.fasta | grep ">" | wc -l)
	if [ "$count" -gt 5 ]
        then
		RAxMLmodel=$(cat ../../per_gene/EOG091G0RCI/EOG091G0RCI.best_model | grep "Best" | cut -d ":" -f 2 | tr -d '[:space:]')
                if [ "$(ls -1 | grep "^RAxML" | wc -l)" -ne 0 ]
		then
			rm RAxML*
		fi
        	raxml -f a -T 2 -m PROTGAMMA$RAxMLmodel         	-p 12345 -x 12345 -# 100         	-s ../../per_gene/EOG091G0RCI/ALICUT_EOG091G0RCI.clustalo.fasta -n EOG091G0RCI.clustalo.aln.ALICUT.$RAxMLmodel 		1> ../../per_gene/EOG091G0RCI/infer_single_ML.stdout.txt 2> ../../per_gene/EOG091G0RCI/infer_single_ML.stderr.txt
	else
		echo "fasta file per_gene/EOG091G0RCI/ALICUT_EOG091G0RCI.clustalo.fasta contains fewer than 5 sequences - skipped" > ../../per_gene/EOG091G0RCI/infer_single_ML.stdout.txt
		touch raxml.skipped
	fi
        touch ../../per_gene/EOG091G0RCI/EOG091G0RCI.raxml.done
        
[Mon Jul  6 00:25:20 2020]
Finished job 1688.
3106 of 3292 steps (94%) done

[Mon Jul  6 00:25:20 2020]
rule score_and_cut:
    input: per_gene/EOG091G11CG/EOG091G11CG.clustalo.fasta
    output: per_gene/EOG091G11CG/ALICUT_EOG091G11CG.clustalo.fasta
    jobid: 865
    wildcards: BUSCO=EOG091G11CG
    threads: 2


        cd per_gene/EOG091G11CG
        Aliscore.pl -N -r 200000000000000000 -i ../../per_gene/EOG091G11CG/EOG091G11CG.clustalo.fasta &> aliscore.log
        ALICUT.pl -s &> alicut.log
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/63c88c27a0fa300f57066b0ef65fefcb.simg
[33mJob counts:
	count	jobs
	1	infer_single_ML
	1[0m
[33m
        cd per_gene/EOG091G0RCI
	count=$(cat ../../per_gene/EOG091G0RCI/ALICUT_EOG091G0RCI.clustalo.fasta | grep ">" | wc -l)
	if [ "$count" -gt 5 ]
        then
		RAxMLmodel=$(cat ../../per_gene/EOG091G0RCI/EOG091G0RCI.best_model | grep "Best" | cut -d ":" -f 2 | tr -d '[:space:]')
                if [ "$(ls -1 | grep "^RAxML" | wc -l)" -ne 0 ]
		then
			rm RAxML*
		fi
        	raxml -f a -T 2 -m PROTGAMMA$RAxMLmodel         	-p 12345 -x 12345 -# 100         	-s ../../per_gene/EOG091G0RCI/ALICUT_EOG091G0RCI.clustalo.fasta -n EOG091G0RCI.clustalo.aln.ALICUT.$RAxMLmodel 		1> ../../per_gene/EOG091G0RCI/infer_single_ML.stdout.txt 2> ../../per_gene/EOG091G0RCI/infer_single_ML.stderr.txt
	else
		echo "fasta file per_gene/EOG091G0RCI/ALICUT_EOG091G0RCI.clustalo.fasta contains fewer than 5 sequences - skipped" > ../../per_gene/EOG091G0RCI/infer_single_ML.stdout.txt
		touch raxml.skipped
	fi
        touch ../../per_gene/EOG091G0RCI/EOG091G0RCI.raxml.done
        [0m
[Mon Jul  6 00:25:22 2020]
Finished job 480.
3107 of 3292 steps (94%) done
[Mon Jul  6 00:25:22 2020]
Finished job 3178.
3108 of 3292 steps (94%) done

[Mon Jul  6 00:25:22 2020]
rule get_outgroups:
    input: per_gene/EOG091G0BUH/EOG091G0BUH.ingroup.fasta
    output: per_gene/EOG091G0BUH/EOG091G0BUH.orthodb.fasta, per_gene/EOG091G0BUH/EOG091G0BUH.outgroup.fasta
    log: per_gene/EOG091G0BUH/get_outgroups.stdout.txt, per_gene/EOG091G0BUH/get_outgroups.stderr.txt
    jobid: 3179
    wildcards: BUSCO=EOG091G0BUH


        #download fastas from Orhtodb for BUSCO id
        for i in {1..5}
        do
             wget "http://www.orthodb.org/fasta?query=EOG091G0BUH&level=33208" -O per_gene/EOG091G0BUH/EOG091G0BUH.orthodb.fasta 1> per_gene/EOG091G0BUH/get_outgroups.stdout.txt 2> per_gene/EOG091G0BUH/get_outgroups.stderr.txt && break || echo -e "try again ($i)" && sleep 15
        done

	#This is quick an dirty for now and just takes the first protein if there is more than one for an outgroup taxon
        bash ../scripts/download_outgroups.sh taxids.txt per_gene/EOG091G0BUH/EOG091G0BUH.orthodb.fasta > per_gene/EOG091G0BUH/EOG091G0BUH.outgroup.fasta
        

[Mon Jul  6 00:25:22 2020]
rule infer_single_ML:
    input: per_gene/EOG091G05EU/EOG091G05EU.best_model, per_gene/EOG091G05EU/ALICUT_EOG091G05EU.clustalo.fasta
    output: per_gene/EOG091G05EU/EOG091G05EU.raxml.done
    log: per_gene/EOG091G05EU/infer_single_ML.stdout.txt, per_gene/EOG091G05EU/infer_single_ML.stderr.txt
    jobid: 34
    wildcards: BUSCO=EOG091G05EU
    threads: 2


        cd per_gene/EOG091G05EU
	count=$(cat ../../per_gene/EOG091G05EU/ALICUT_EOG091G05EU.clustalo.fasta | grep ">" | wc -l)
	if [ "$count" -gt 5 ]
        then
		RAxMLmodel=$(cat ../../per_gene/EOG091G05EU/EOG091G05EU.best_model | grep "Best" | cut -d ":" -f 2 | tr -d '[:space:]')
                if [ "$(ls -1 | grep "^RAxML" | wc -l)" -ne 0 ]
		then
			rm RAxML*
		fi
        	raxml -f a -T 2 -m PROTGAMMA$RAxMLmodel         	-p 12345 -x 12345 -# 100         	-s ../../per_gene/EOG091G05EU/ALICUT_EOG091G05EU.clustalo.fasta -n EOG091G05EU.clustalo.aln.ALICUT.$RAxMLmodel 		1> ../../per_gene/EOG091G05EU/infer_single_ML.stdout.txt 2> ../../per_gene/EOG091G05EU/infer_single_ML.stderr.txt
	else
		echo "fasta file per_gene/EOG091G05EU/ALICUT_EOG091G05EU.clustalo.fasta contains fewer than 5 sequences - skipped" > ../../per_gene/EOG091G05EU/infer_single_ML.stdout.txt
		touch raxml.skipped
	fi
        touch ../../per_gene/EOG091G05EU/EOG091G05EU.raxml.done
        
[33mJob counts:
	count	jobs
	1	infer_single_ML
	1[0m
[33m
        cd per_gene/EOG091G05EU
	count=$(cat ../../per_gene/EOG091G05EU/ALICUT_EOG091G05EU.clustalo.fasta | grep ">" | wc -l)
	if [ "$count" -gt 5 ]
        then
		RAxMLmodel=$(cat ../../per_gene/EOG091G05EU/EOG091G05EU.best_model | grep "Best" | cut -d ":" -f 2 | tr -d '[:space:]')
                if [ "$(ls -1 | grep "^RAxML" | wc -l)" -ne 0 ]
		then
			rm RAxML*
		fi
        	raxml -f a -T 2 -m PROTGAMMA$RAxMLmodel         	-p 12345 -x 12345 -# 100         	-s ../../per_gene/EOG091G05EU/ALICUT_EOG091G05EU.clustalo.fasta -n EOG091G05EU.clustalo.aln.ALICUT.$RAxMLmodel 		1> ../../per_gene/EOG091G05EU/infer_single_ML.stdout.txt 2> ../../per_gene/EOG091G05EU/infer_single_ML.stderr.txt
	else
		echo "fasta file per_gene/EOG091G05EU/ALICUT_EOG091G05EU.clustalo.fasta contains fewer than 5 sequences - skipped" > ../../per_gene/EOG091G05EU/infer_single_ML.stdout.txt
		touch raxml.skipped
	fi
        touch ../../per_gene/EOG091G05EU/EOG091G05EU.raxml.done
        [0m
[Mon Jul  6 00:25:23 2020]
Finished job 3179.
3109 of 3292 steps (94%) done
[Mon Jul  6 00:25:23 2020]
Finished job 897.
3110 of 3292 steps (94%) done

[Mon Jul  6 00:25:23 2020]
rule join_groups:
    input: per_gene/EOG091G0BUH/EOG091G0BUH.ingroup.fasta, per_gene/EOG091G0BUH/EOG091G0BUH.outgroup.fasta
    output: per_gene/EOG091G0BUH/EOG091G0BUH.fasta
    jobid: 2413
    wildcards: BUSCO=EOG091G0BUH


        cat per_gene/EOG091G0BUH/EOG091G0BUH.ingroup.fasta per_gene/EOG091G0BUH/EOG091G0BUH.outgroup.fasta > per_gene/EOG091G0BUH/EOG091G0BUH.fasta
        

[Mon Jul  6 00:25:23 2020]
rule get_seqs:
    input: /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ingroup.txt, /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/outgroup.txt
    output: per_gene/EOG091G112U/EOG091G112U.ingroup.fasta
    log: per_gene/EOG091G112U/get_seqs.stdout.txt, per_gene/EOG091G112U/get_seqs.stderr.txt
    jobid: 3042
    wildcards: BUSCO=EOG091G112U
    threads: 2


	basedir=$(pwd)
        cd per_gene/EOG091G112U
        
        bash $basedir/../scripts/fetch_seqs.sh EOG091G112U /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ingroup.txt /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/outgroup.txt 1> ../../per_gene/EOG091G112U/get_seqs.stdout.txt 2> ../../per_gene/EOG091G112U/get_seqs.stderr.txt
	mv EOG091G112U.fasta $basedir/per_gene/EOG091G112U/EOG091G112U.ingroup.fasta
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/72476f9d9a5bd0627b4d721143a21354.simg

[Mon Jul  6 00:25:23 2020]
rule remove_empty:
    input: per_gene/EOG091G04FV/ALICUT_EOG091G04FV.clustalo.fasta
    output: per_gene/EOG091G04FV/empty_check.done
    jobid: 1719
    wildcards: BUSCO=EOG091G04FV


         if [ "$(cat per_gene/EOG091G04FV/ALICUT_EOG091G04FV.clustalo.fasta | grep -v ">" | sed 's/-//g' | grep "^$" | wc -l)" -gt 0 ]
         then
              cp per_gene/EOG091G04FV/ALICUT_EOG091G04FV.clustalo.fasta per_gene/EOG091G04FV/ALICUT_EOG091G04FV.clustalo.fasta.backup
              bash ../scripts/remove_empty.sh per_gene/EOG091G04FV/ALICUT_EOG091G04FV.clustalo.fasta.backup > per_gene/EOG091G04FV/ALICUT_EOG091G04FV.clustalo.fasta
         fi
         touch per_gene/EOG091G04FV/empty_check.done
         
[Mon Jul  6 00:25:23 2020]
Finished job 2413.
3111 of 3292 steps (95%) done
[Mon Jul  6 00:25:23 2020]
Finished job 1719.
3112 of 3292 steps (95%) done

[Mon Jul  6 00:25:23 2020]
rule MSA:
    input: per_gene/EOG091G0BUH/EOG091G0BUH.fasta
    output: per_gene/EOG091G0BUH/EOG091G0BUH.clustalo.fasta
    log: per_gene/EOG091G0BUH/MSA.stdout.txt, per_gene/EOG091G0BUH/MSA.stderr.txt
    jobid: 1946
    wildcards: BUSCO=EOG091G0BUH
    threads: 2


        clustalo -i per_gene/EOG091G0BUH/EOG091G0BUH.fasta -o per_gene/EOG091G0BUH/EOG091G0BUH.clustalo.fasta --threads=2 1> per_gene/EOG091G0BUH/MSA.stdout.txt 2> per_gene/EOG091G0BUH/MSA.stderr.txt
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/d68c9691725a7401923680874285c430.simg
[Mon Jul  6 00:25:24 2020]
Finished job 1946.
3113 of 3292 steps (95%) done

[Mon Jul  6 00:25:24 2020]
rule score_and_cut:
    input: per_gene/EOG091G0BUH/EOG091G0BUH.clustalo.fasta
    output: per_gene/EOG091G0BUH/ALICUT_EOG091G0BUH.clustalo.fasta
    jobid: 1123
    wildcards: BUSCO=EOG091G0BUH
    threads: 2


        cd per_gene/EOG091G0BUH
        Aliscore.pl -N -r 200000000000000000 -i ../../per_gene/EOG091G0BUH/EOG091G0BUH.clustalo.fasta &> aliscore.log
        ALICUT.pl -s &> alicut.log
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/63c88c27a0fa300f57066b0ef65fefcb.simg
[Mon Jul  6 00:25:28 2020]
Finished job 3232.
3114 of 3292 steps (95%) done

[Mon Jul  6 00:25:28 2020]
rule find_best_model:
    input: per_gene/EOG091G04FV/ALICUT_EOG091G04FV.clustalo.fasta, per_gene/EOG091G04FV/empty_check.done
    output: per_gene/EOG091G04FV/EOG091G04FV.best_model
    log: per_gene/EOG091G04FV/find_best_model.stderr.txt
    jobid: 896
    wildcards: BUSCO=EOG091G04FV
    threads: 2


        cd per_gene/EOG091G04FV
        if [ ! -d find_best_model ]
        then
            mkdir find_best_model
        fi
        cd find_best_model
        ln -s ../../../per_gene/EOG091G04FV/ALICUT_EOG091G04FV.clustalo.fasta EOG091G04FV.fasta
        ProteinModelSelection.pl EOG091G04FV.fasta 1> ../../../per_gene/EOG091G04FV/EOG091G04FV.best_model 2> ../../../per_gene/EOG091G04FV/find_best_model.stderr.txt
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/c0c09ee657b1e27f2c5687e0e9aa8d70.simg
[Mon Jul  6 00:25:29 2020]
Finished job 865.
3115 of 3292 steps (95%) done

[Mon Jul  6 00:25:29 2020]
rule get_outgroups:
    input: per_gene/EOG091G0MI7/EOG091G0MI7.ingroup.fasta
    output: per_gene/EOG091G0MI7/EOG091G0MI7.orthodb.fasta, per_gene/EOG091G0MI7/EOG091G0MI7.outgroup.fasta
    log: per_gene/EOG091G0MI7/get_outgroups.stdout.txt, per_gene/EOG091G0MI7/get_outgroups.stderr.txt
    jobid: 3233
    wildcards: BUSCO=EOG091G0MI7


        #download fastas from Orhtodb for BUSCO id
        for i in {1..5}
        do
             wget "http://www.orthodb.org/fasta?query=EOG091G0MI7&level=33208" -O per_gene/EOG091G0MI7/EOG091G0MI7.orthodb.fasta 1> per_gene/EOG091G0MI7/get_outgroups.stdout.txt 2> per_gene/EOG091G0MI7/get_outgroups.stderr.txt && break || echo -e "try again ($i)" && sleep 15
        done

	#This is quick an dirty for now and just takes the first protein if there is more than one for an outgroup taxon
        bash ../scripts/download_outgroups.sh taxids.txt per_gene/EOG091G0MI7/EOG091G0MI7.orthodb.fasta > per_gene/EOG091G0MI7/EOG091G0MI7.outgroup.fasta
        

[Mon Jul  6 00:25:29 2020]
rule remove_empty:
    input: per_gene/EOG091G11CG/ALICUT_EOG091G11CG.clustalo.fasta
    output: per_gene/EOG091G11CG/empty_check.done
    jobid: 1687
    wildcards: BUSCO=EOG091G11CG


         if [ "$(cat per_gene/EOG091G11CG/ALICUT_EOG091G11CG.clustalo.fasta | grep -v ">" | sed 's/-//g' | grep "^$" | wc -l)" -gt 0 ]
         then
              cp per_gene/EOG091G11CG/ALICUT_EOG091G11CG.clustalo.fasta per_gene/EOG091G11CG/ALICUT_EOG091G11CG.clustalo.fasta.backup
              bash ../scripts/remove_empty.sh per_gene/EOG091G11CG/ALICUT_EOG091G11CG.clustalo.fasta.backup > per_gene/EOG091G11CG/ALICUT_EOG091G11CG.clustalo.fasta
         fi
         touch per_gene/EOG091G11CG/empty_check.done
         
[Mon Jul  6 00:25:29 2020]
Finished job 1687.
3116 of 3292 steps (95%) done
[Mon Jul  6 00:25:30 2020]
Finished job 3233.
3117 of 3292 steps (95%) done

[Mon Jul  6 00:25:30 2020]
rule join_groups:
    input: per_gene/EOG091G0MI7/EOG091G0MI7.ingroup.fasta, per_gene/EOG091G0MI7/EOG091G0MI7.outgroup.fasta
    output: per_gene/EOG091G0MI7/EOG091G0MI7.fasta
    jobid: 2440
    wildcards: BUSCO=EOG091G0MI7


        cat per_gene/EOG091G0MI7/EOG091G0MI7.ingroup.fasta per_gene/EOG091G0MI7/EOG091G0MI7.outgroup.fasta > per_gene/EOG091G0MI7/EOG091G0MI7.fasta
        
[Mon Jul  6 00:25:30 2020]
Finished job 2440.
3118 of 3292 steps (95%) done

[Mon Jul  6 00:25:30 2020]
rule MSA:
    input: per_gene/EOG091G0MI7/EOG091G0MI7.fasta
    output: per_gene/EOG091G0MI7/EOG091G0MI7.clustalo.fasta
    log: per_gene/EOG091G0MI7/MSA.stdout.txt, per_gene/EOG091G0MI7/MSA.stderr.txt
    jobid: 2000
    wildcards: BUSCO=EOG091G0MI7
    threads: 2


        clustalo -i per_gene/EOG091G0MI7/EOG091G0MI7.fasta -o per_gene/EOG091G0MI7/EOG091G0MI7.clustalo.fasta --threads=2 1> per_gene/EOG091G0MI7/MSA.stdout.txt 2> per_gene/EOG091G0MI7/MSA.stderr.txt
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/d68c9691725a7401923680874285c430.simg
[Mon Jul  6 00:25:31 2020]
Finished job 2000.
3119 of 3292 steps (95%) done

[Mon Jul  6 00:25:31 2020]
rule score_and_cut:
    input: per_gene/EOG091G0MI7/EOG091G0MI7.clustalo.fasta
    output: per_gene/EOG091G0MI7/ALICUT_EOG091G0MI7.clustalo.fasta
    jobid: 1177
    wildcards: BUSCO=EOG091G0MI7
    threads: 2


        cd per_gene/EOG091G0MI7
        Aliscore.pl -N -r 200000000000000000 -i ../../per_gene/EOG091G0MI7/EOG091G0MI7.clustalo.fasta &> aliscore.log
        ALICUT.pl -s &> alicut.log
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/63c88c27a0fa300f57066b0ef65fefcb.simg
[Mon Jul  6 00:25:34 2020]
Finished job 1123.
3120 of 3292 steps (95%) done

[Mon Jul  6 00:25:34 2020]
rule remove_empty:
    input: per_gene/EOG091G0BUH/ALICUT_EOG091G0BUH.clustalo.fasta
    output: per_gene/EOG091G0BUH/empty_check.done
    jobid: 1945
    wildcards: BUSCO=EOG091G0BUH


         if [ "$(cat per_gene/EOG091G0BUH/ALICUT_EOG091G0BUH.clustalo.fasta | grep -v ">" | sed 's/-//g' | grep "^$" | wc -l)" -gt 0 ]
         then
              cp per_gene/EOG091G0BUH/ALICUT_EOG091G0BUH.clustalo.fasta per_gene/EOG091G0BUH/ALICUT_EOG091G0BUH.clustalo.fasta.backup
              bash ../scripts/remove_empty.sh per_gene/EOG091G0BUH/ALICUT_EOG091G0BUH.clustalo.fasta.backup > per_gene/EOG091G0BUH/ALICUT_EOG091G0BUH.clustalo.fasta
         fi
         touch per_gene/EOG091G0BUH/empty_check.done
         
[Mon Jul  6 00:25:34 2020]
Finished job 1945.
3121 of 3292 steps (95%) done

[Mon Jul  6 00:25:34 2020]
rule find_best_model:
    input: per_gene/EOG091G0BUH/ALICUT_EOG091G0BUH.clustalo.fasta, per_gene/EOG091G0BUH/empty_check.done
    output: per_gene/EOG091G0BUH/EOG091G0BUH.best_model
    log: per_gene/EOG091G0BUH/find_best_model.stderr.txt
    jobid: 1122
    wildcards: BUSCO=EOG091G0BUH
    threads: 2


        cd per_gene/EOG091G0BUH
        if [ ! -d find_best_model ]
        then
            mkdir find_best_model
        fi
        cd find_best_model
        ln -s ../../../per_gene/EOG091G0BUH/ALICUT_EOG091G0BUH.clustalo.fasta EOG091G0BUH.fasta
        ProteinModelSelection.pl EOG091G0BUH.fasta 1> ../../../per_gene/EOG091G0BUH/EOG091G0BUH.best_model 2> ../../../per_gene/EOG091G0BUH/find_best_model.stderr.txt
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/c0c09ee657b1e27f2c5687e0e9aa8d70.simg
[Mon Jul  6 00:25:38 2020]
Finished job 3042.
3122 of 3292 steps (95%) done

[Mon Jul  6 00:25:38 2020]
rule find_best_model:
    input: per_gene/EOG091G11CG/ALICUT_EOG091G11CG.clustalo.fasta, per_gene/EOG091G11CG/empty_check.done
    output: per_gene/EOG091G11CG/EOG091G11CG.best_model
    log: per_gene/EOG091G11CG/find_best_model.stderr.txt
    jobid: 864
    wildcards: BUSCO=EOG091G11CG
    threads: 2


        cd per_gene/EOG091G11CG
        if [ ! -d find_best_model ]
        then
            mkdir find_best_model
        fi
        cd find_best_model
        ln -s ../../../per_gene/EOG091G11CG/ALICUT_EOG091G11CG.clustalo.fasta EOG091G11CG.fasta
        ProteinModelSelection.pl EOG091G11CG.fasta 1> ../../../per_gene/EOG091G11CG/EOG091G11CG.best_model 2> ../../../per_gene/EOG091G11CG/find_best_model.stderr.txt
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/c0c09ee657b1e27f2c5687e0e9aa8d70.simg
[Mon Jul  6 00:25:39 2020]
Finished job 1182.
3123 of 3292 steps (95%) done

[Mon Jul  6 00:25:39 2020]
rule infer_single_ML:
    input: per_gene/EOG091G0NIU/EOG091G0NIU.best_model, per_gene/EOG091G0NIU/ALICUT_EOG091G0NIU.clustalo.fasta
    output: per_gene/EOG091G0NIU/EOG091G0NIU.raxml.done
    log: per_gene/EOG091G0NIU/infer_single_ML.stdout.txt, per_gene/EOG091G0NIU/infer_single_ML.stderr.txt
    jobid: 385
    wildcards: BUSCO=EOG091G0NIU
    threads: 2


        cd per_gene/EOG091G0NIU
	count=$(cat ../../per_gene/EOG091G0NIU/ALICUT_EOG091G0NIU.clustalo.fasta | grep ">" | wc -l)
	if [ "$count" -gt 5 ]
        then
		RAxMLmodel=$(cat ../../per_gene/EOG091G0NIU/EOG091G0NIU.best_model | grep "Best" | cut -d ":" -f 2 | tr -d '[:space:]')
                if [ "$(ls -1 | grep "^RAxML" | wc -l)" -ne 0 ]
		then
			rm RAxML*
		fi
        	raxml -f a -T 2 -m PROTGAMMA$RAxMLmodel         	-p 12345 -x 12345 -# 100         	-s ../../per_gene/EOG091G0NIU/ALICUT_EOG091G0NIU.clustalo.fasta -n EOG091G0NIU.clustalo.aln.ALICUT.$RAxMLmodel 		1> ../../per_gene/EOG091G0NIU/infer_single_ML.stdout.txt 2> ../../per_gene/EOG091G0NIU/infer_single_ML.stderr.txt
	else
		echo "fasta file per_gene/EOG091G0NIU/ALICUT_EOG091G0NIU.clustalo.fasta contains fewer than 5 sequences - skipped" > ../../per_gene/EOG091G0NIU/infer_single_ML.stdout.txt
		touch raxml.skipped
	fi
        touch ../../per_gene/EOG091G0NIU/EOG091G0NIU.raxml.done
        
[33mJob counts:
	count	jobs
	1	infer_single_ML
	1[0m
[33m
        cd per_gene/EOG091G0NIU
	count=$(cat ../../per_gene/EOG091G0NIU/ALICUT_EOG091G0NIU.clustalo.fasta | grep ">" | wc -l)
	if [ "$count" -gt 5 ]
        then
		RAxMLmodel=$(cat ../../per_gene/EOG091G0NIU/EOG091G0NIU.best_model | grep "Best" | cut -d ":" -f 2 | tr -d '[:space:]')
                if [ "$(ls -1 | grep "^RAxML" | wc -l)" -ne 0 ]
		then
			rm RAxML*
		fi
        	raxml -f a -T 2 -m PROTGAMMA$RAxMLmodel         	-p 12345 -x 12345 -# 100         	-s ../../per_gene/EOG091G0NIU/ALICUT_EOG091G0NIU.clustalo.fasta -n EOG091G0NIU.clustalo.aln.ALICUT.$RAxMLmodel 		1> ../../per_gene/EOG091G0NIU/infer_single_ML.stdout.txt 2> ../../per_gene/EOG091G0NIU/infer_single_ML.stderr.txt
	else
		echo "fasta file per_gene/EOG091G0NIU/ALICUT_EOG091G0NIU.clustalo.fasta contains fewer than 5 sequences - skipped" > ../../per_gene/EOG091G0NIU/infer_single_ML.stdout.txt
		touch raxml.skipped
	fi
        touch ../../per_gene/EOG091G0NIU/EOG091G0NIU.raxml.done
        [0m
[Mon Jul  6 00:25:40 2020]
Finished job 1177.
3124 of 3292 steps (95%) done

[Mon Jul  6 00:25:40 2020]
rule get_outgroups:
    input: per_gene/EOG091G112U/EOG091G112U.ingroup.fasta
    output: per_gene/EOG091G112U/EOG091G112U.orthodb.fasta, per_gene/EOG091G112U/EOG091G112U.outgroup.fasta
    log: per_gene/EOG091G112U/get_outgroups.stdout.txt, per_gene/EOG091G112U/get_outgroups.stderr.txt
    jobid: 3043
    wildcards: BUSCO=EOG091G112U


        #download fastas from Orhtodb for BUSCO id
        for i in {1..5}
        do
             wget "http://www.orthodb.org/fasta?query=EOG091G112U&level=33208" -O per_gene/EOG091G112U/EOG091G112U.orthodb.fasta 1> per_gene/EOG091G112U/get_outgroups.stdout.txt 2> per_gene/EOG091G112U/get_outgroups.stderr.txt && break || echo -e "try again ($i)" && sleep 15
        done

	#This is quick an dirty for now and just takes the first protein if there is more than one for an outgroup taxon
        bash ../scripts/download_outgroups.sh taxids.txt per_gene/EOG091G112U/EOG091G112U.orthodb.fasta > per_gene/EOG091G112U/EOG091G112U.outgroup.fasta
        

[Mon Jul  6 00:25:40 2020]
rule remove_empty:
    input: per_gene/EOG091G0MI7/ALICUT_EOG091G0MI7.clustalo.fasta
    output: per_gene/EOG091G0MI7/empty_check.done
    jobid: 1999
    wildcards: BUSCO=EOG091G0MI7


         if [ "$(cat per_gene/EOG091G0MI7/ALICUT_EOG091G0MI7.clustalo.fasta | grep -v ">" | sed 's/-//g' | grep "^$" | wc -l)" -gt 0 ]
         then
              cp per_gene/EOG091G0MI7/ALICUT_EOG091G0MI7.clustalo.fasta per_gene/EOG091G0MI7/ALICUT_EOG091G0MI7.clustalo.fasta.backup
              bash ../scripts/remove_empty.sh per_gene/EOG091G0MI7/ALICUT_EOG091G0MI7.clustalo.fasta.backup > per_gene/EOG091G0MI7/ALICUT_EOG091G0MI7.clustalo.fasta
         fi
         touch per_gene/EOG091G0MI7/empty_check.done
         
[Mon Jul  6 00:25:40 2020]
Finished job 1999.
3125 of 3292 steps (95%) done
[Mon Jul  6 00:25:41 2020]
Finished job 3043.
3126 of 3292 steps (95%) done

[Mon Jul  6 00:25:41 2020]
rule find_best_model:
    input: per_gene/EOG091G0MI7/ALICUT_EOG091G0MI7.clustalo.fasta, per_gene/EOG091G0MI7/empty_check.done
    output: per_gene/EOG091G0MI7/EOG091G0MI7.best_model
    log: per_gene/EOG091G0MI7/find_best_model.stderr.txt
    jobid: 1176
    wildcards: BUSCO=EOG091G0MI7
    threads: 2


        cd per_gene/EOG091G0MI7
        if [ ! -d find_best_model ]
        then
            mkdir find_best_model
        fi
        cd find_best_model
        ln -s ../../../per_gene/EOG091G0MI7/ALICUT_EOG091G0MI7.clustalo.fasta EOG091G0MI7.fasta
        ProteinModelSelection.pl EOG091G0MI7.fasta 1> ../../../per_gene/EOG091G0MI7/EOG091G0MI7.best_model 2> ../../../per_gene/EOG091G0MI7/find_best_model.stderr.txt
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/c0c09ee657b1e27f2c5687e0e9aa8d70.simg
[Mon Jul  6 00:26:00 2020]
Finished job 896.
3127 of 3292 steps (95%) done

[Mon Jul  6 00:26:00 2020]
rule infer_single_ML:
    input: per_gene/EOG091G04FV/EOG091G04FV.best_model, per_gene/EOG091G04FV/ALICUT_EOG091G04FV.clustalo.fasta
    output: per_gene/EOG091G04FV/EOG091G04FV.raxml.done
    log: per_gene/EOG091G04FV/infer_single_ML.stdout.txt, per_gene/EOG091G04FV/infer_single_ML.stderr.txt
    jobid: 242
    wildcards: BUSCO=EOG091G04FV
    threads: 2


        cd per_gene/EOG091G04FV
	count=$(cat ../../per_gene/EOG091G04FV/ALICUT_EOG091G04FV.clustalo.fasta | grep ">" | wc -l)
	if [ "$count" -gt 5 ]
        then
		RAxMLmodel=$(cat ../../per_gene/EOG091G04FV/EOG091G04FV.best_model | grep "Best" | cut -d ":" -f 2 | tr -d '[:space:]')
                if [ "$(ls -1 | grep "^RAxML" | wc -l)" -ne 0 ]
		then
			rm RAxML*
		fi
        	raxml -f a -T 2 -m PROTGAMMA$RAxMLmodel         	-p 12345 -x 12345 -# 100         	-s ../../per_gene/EOG091G04FV/ALICUT_EOG091G04FV.clustalo.fasta -n EOG091G04FV.clustalo.aln.ALICUT.$RAxMLmodel 		1> ../../per_gene/EOG091G04FV/infer_single_ML.stdout.txt 2> ../../per_gene/EOG091G04FV/infer_single_ML.stderr.txt
	else
		echo "fasta file per_gene/EOG091G04FV/ALICUT_EOG091G04FV.clustalo.fasta contains fewer than 5 sequences - skipped" > ../../per_gene/EOG091G04FV/infer_single_ML.stdout.txt
		touch raxml.skipped
	fi
        touch ../../per_gene/EOG091G04FV/EOG091G04FV.raxml.done
        
[Mon Jul  6 00:26:00 2020]
Finished job 864.
3128 of 3292 steps (95%) done

[Mon Jul  6 00:26:00 2020]
rule join_groups:
    input: per_gene/EOG091G112U/EOG091G112U.ingroup.fasta, per_gene/EOG091G112U/EOG091G112U.outgroup.fasta
    output: per_gene/EOG091G112U/EOG091G112U.fasta
    jobid: 2345
    wildcards: BUSCO=EOG091G112U


        cat per_gene/EOG091G112U/EOG091G112U.ingroup.fasta per_gene/EOG091G112U/EOG091G112U.outgroup.fasta > per_gene/EOG091G112U/EOG091G112U.fasta
        
[Mon Jul  6 00:26:01 2020]
Finished job 2345.
3129 of 3292 steps (95%) done

[Mon Jul  6 00:26:01 2020]
rule MSA:
    input: per_gene/EOG091G112U/EOG091G112U.fasta
    output: per_gene/EOG091G112U/EOG091G112U.clustalo.fasta
    log: per_gene/EOG091G112U/MSA.stdout.txt, per_gene/EOG091G112U/MSA.stderr.txt
    jobid: 1810
    wildcards: BUSCO=EOG091G112U
    threads: 2


        clustalo -i per_gene/EOG091G112U/EOG091G112U.fasta -o per_gene/EOG091G112U/EOG091G112U.clustalo.fasta --threads=2 1> per_gene/EOG091G112U/MSA.stdout.txt 2> per_gene/EOG091G112U/MSA.stderr.txt
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/d68c9691725a7401923680874285c430.simg
[Mon Jul  6 00:26:01 2020]
Finished job 1810.
3130 of 3292 steps (95%) done

[Mon Jul  6 00:26:01 2020]
rule score_and_cut:
    input: per_gene/EOG091G112U/EOG091G112U.clustalo.fasta
    output: per_gene/EOG091G112U/ALICUT_EOG091G112U.clustalo.fasta
    jobid: 987
    wildcards: BUSCO=EOG091G112U
    threads: 2


        cd per_gene/EOG091G112U
        Aliscore.pl -N -r 200000000000000000 -i ../../per_gene/EOG091G112U/EOG091G112U.clustalo.fasta &> aliscore.log
        ALICUT.pl -s &> alicut.log
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/63c88c27a0fa300f57066b0ef65fefcb.simg
[33mJob counts:
	count	jobs
	1	infer_single_ML
	1[0m
[33m
        cd per_gene/EOG091G04FV
	count=$(cat ../../per_gene/EOG091G04FV/ALICUT_EOG091G04FV.clustalo.fasta | grep ">" | wc -l)
	if [ "$count" -gt 5 ]
        then
		RAxMLmodel=$(cat ../../per_gene/EOG091G04FV/EOG091G04FV.best_model | grep "Best" | cut -d ":" -f 2 | tr -d '[:space:]')
                if [ "$(ls -1 | grep "^RAxML" | wc -l)" -ne 0 ]
		then
			rm RAxML*
		fi
        	raxml -f a -T 2 -m PROTGAMMA$RAxMLmodel         	-p 12345 -x 12345 -# 100         	-s ../../per_gene/EOG091G04FV/ALICUT_EOG091G04FV.clustalo.fasta -n EOG091G04FV.clustalo.aln.ALICUT.$RAxMLmodel 		1> ../../per_gene/EOG091G04FV/infer_single_ML.stdout.txt 2> ../../per_gene/EOG091G04FV/infer_single_ML.stderr.txt
	else
		echo "fasta file per_gene/EOG091G04FV/ALICUT_EOG091G04FV.clustalo.fasta contains fewer than 5 sequences - skipped" > ../../per_gene/EOG091G04FV/infer_single_ML.stdout.txt
		touch raxml.skipped
	fi
        touch ../../per_gene/EOG091G04FV/EOG091G04FV.raxml.done
        [0m
[Mon Jul  6 00:26:07 2020]
Finished job 1122.
3131 of 3292 steps (95%) done

[Mon Jul  6 00:26:07 2020]
rule infer_single_ML:
    input: per_gene/EOG091G0BUH/EOG091G0BUH.best_model, per_gene/EOG091G0BUH/ALICUT_EOG091G0BUH.clustalo.fasta
    output: per_gene/EOG091G0BUH/EOG091G0BUH.raxml.done
    log: per_gene/EOG091G0BUH/infer_single_ML.stdout.txt, per_gene/EOG091G0BUH/infer_single_ML.stderr.txt
    jobid: 355
    wildcards: BUSCO=EOG091G0BUH
    threads: 2


        cd per_gene/EOG091G0BUH
	count=$(cat ../../per_gene/EOG091G0BUH/ALICUT_EOG091G0BUH.clustalo.fasta | grep ">" | wc -l)
	if [ "$count" -gt 5 ]
        then
		RAxMLmodel=$(cat ../../per_gene/EOG091G0BUH/EOG091G0BUH.best_model | grep "Best" | cut -d ":" -f 2 | tr -d '[:space:]')
                if [ "$(ls -1 | grep "^RAxML" | wc -l)" -ne 0 ]
		then
			rm RAxML*
		fi
        	raxml -f a -T 2 -m PROTGAMMA$RAxMLmodel         	-p 12345 -x 12345 -# 100         	-s ../../per_gene/EOG091G0BUH/ALICUT_EOG091G0BUH.clustalo.fasta -n EOG091G0BUH.clustalo.aln.ALICUT.$RAxMLmodel 		1> ../../per_gene/EOG091G0BUH/infer_single_ML.stdout.txt 2> ../../per_gene/EOG091G0BUH/infer_single_ML.stderr.txt
	else
		echo "fasta file per_gene/EOG091G0BUH/ALICUT_EOG091G0BUH.clustalo.fasta contains fewer than 5 sequences - skipped" > ../../per_gene/EOG091G0BUH/infer_single_ML.stdout.txt
		touch raxml.skipped
	fi
        touch ../../per_gene/EOG091G0BUH/EOG091G0BUH.raxml.done
        
[33mJob counts:
	count	jobs
	1	infer_single_ML
	1[0m
[33m
        cd per_gene/EOG091G0BUH
	count=$(cat ../../per_gene/EOG091G0BUH/ALICUT_EOG091G0BUH.clustalo.fasta | grep ">" | wc -l)
	if [ "$count" -gt 5 ]
        then
		RAxMLmodel=$(cat ../../per_gene/EOG091G0BUH/EOG091G0BUH.best_model | grep "Best" | cut -d ":" -f 2 | tr -d '[:space:]')
                if [ "$(ls -1 | grep "^RAxML" | wc -l)" -ne 0 ]
		then
			rm RAxML*
		fi
        	raxml -f a -T 2 -m PROTGAMMA$RAxMLmodel         	-p 12345 -x 12345 -# 100         	-s ../../per_gene/EOG091G0BUH/ALICUT_EOG091G0BUH.clustalo.fasta -n EOG091G0BUH.clustalo.aln.ALICUT.$RAxMLmodel 		1> ../../per_gene/EOG091G0BUH/infer_single_ML.stdout.txt 2> ../../per_gene/EOG091G0BUH/infer_single_ML.stderr.txt
	else
		echo "fasta file per_gene/EOG091G0BUH/ALICUT_EOG091G0BUH.clustalo.fasta contains fewer than 5 sequences - skipped" > ../../per_gene/EOG091G0BUH/infer_single_ML.stdout.txt
		touch raxml.skipped
	fi
        touch ../../per_gene/EOG091G0BUH/EOG091G0BUH.raxml.done
        [0m
[Mon Jul  6 00:26:11 2020]
Finished job 987.
3132 of 3292 steps (95%) done

[Mon Jul  6 00:26:11 2020]
rule remove_empty:
    input: per_gene/EOG091G112U/ALICUT_EOG091G112U.clustalo.fasta
    output: per_gene/EOG091G112U/empty_check.done
    jobid: 1809
    wildcards: BUSCO=EOG091G112U


         if [ "$(cat per_gene/EOG091G112U/ALICUT_EOG091G112U.clustalo.fasta | grep -v ">" | sed 's/-//g' | grep "^$" | wc -l)" -gt 0 ]
         then
              cp per_gene/EOG091G112U/ALICUT_EOG091G112U.clustalo.fasta per_gene/EOG091G112U/ALICUT_EOG091G112U.clustalo.fasta.backup
              bash ../scripts/remove_empty.sh per_gene/EOG091G112U/ALICUT_EOG091G112U.clustalo.fasta.backup > per_gene/EOG091G112U/ALICUT_EOG091G112U.clustalo.fasta
         fi
         touch per_gene/EOG091G112U/empty_check.done
         
[Mon Jul  6 00:26:11 2020]
Finished job 1176.
3133 of 3292 steps (95%) done

[Mon Jul  6 00:26:11 2020]
rule infer_single_ML:
    input: per_gene/EOG091G0MI7/EOG091G0MI7.best_model, per_gene/EOG091G0MI7/ALICUT_EOG091G0MI7.clustalo.fasta
    output: per_gene/EOG091G0MI7/EOG091G0MI7.raxml.done
    log: per_gene/EOG091G0MI7/infer_single_ML.stdout.txt, per_gene/EOG091G0MI7/infer_single_ML.stderr.txt
    jobid: 382
    wildcards: BUSCO=EOG091G0MI7
    threads: 2


        cd per_gene/EOG091G0MI7
	count=$(cat ../../per_gene/EOG091G0MI7/ALICUT_EOG091G0MI7.clustalo.fasta | grep ">" | wc -l)
	if [ "$count" -gt 5 ]
        then
		RAxMLmodel=$(cat ../../per_gene/EOG091G0MI7/EOG091G0MI7.best_model | grep "Best" | cut -d ":" -f 2 | tr -d '[:space:]')
                if [ "$(ls -1 | grep "^RAxML" | wc -l)" -ne 0 ]
		then
			rm RAxML*
		fi
        	raxml -f a -T 2 -m PROTGAMMA$RAxMLmodel         	-p 12345 -x 12345 -# 100         	-s ../../per_gene/EOG091G0MI7/ALICUT_EOG091G0MI7.clustalo.fasta -n EOG091G0MI7.clustalo.aln.ALICUT.$RAxMLmodel 		1> ../../per_gene/EOG091G0MI7/infer_single_ML.stdout.txt 2> ../../per_gene/EOG091G0MI7/infer_single_ML.stderr.txt
	else
		echo "fasta file per_gene/EOG091G0MI7/ALICUT_EOG091G0MI7.clustalo.fasta contains fewer than 5 sequences - skipped" > ../../per_gene/EOG091G0MI7/infer_single_ML.stdout.txt
		touch raxml.skipped
	fi
        touch ../../per_gene/EOG091G0MI7/EOG091G0MI7.raxml.done
        
[Mon Jul  6 00:26:11 2020]
Finished job 1809.
3134 of 3292 steps (95%) done

[Mon Jul  6 00:26:11 2020]
rule find_best_model:
    input: per_gene/EOG091G112U/ALICUT_EOG091G112U.clustalo.fasta, per_gene/EOG091G112U/empty_check.done
    output: per_gene/EOG091G112U/EOG091G112U.best_model
    log: per_gene/EOG091G112U/find_best_model.stderr.txt
    jobid: 986
    wildcards: BUSCO=EOG091G112U
    threads: 2


        cd per_gene/EOG091G112U
        if [ ! -d find_best_model ]
        then
            mkdir find_best_model
        fi
        cd find_best_model
        ln -s ../../../per_gene/EOG091G112U/ALICUT_EOG091G112U.clustalo.fasta EOG091G112U.fasta
        ProteinModelSelection.pl EOG091G112U.fasta 1> ../../../per_gene/EOG091G112U/EOG091G112U.best_model 2> ../../../per_gene/EOG091G112U/find_best_model.stderr.txt
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/c0c09ee657b1e27f2c5687e0e9aa8d70.simg
[33mJob counts:
	count	jobs
	1	infer_single_ML
	1[0m
[33m
        cd per_gene/EOG091G0MI7
	count=$(cat ../../per_gene/EOG091G0MI7/ALICUT_EOG091G0MI7.clustalo.fasta | grep ">" | wc -l)
	if [ "$count" -gt 5 ]
        then
		RAxMLmodel=$(cat ../../per_gene/EOG091G0MI7/EOG091G0MI7.best_model | grep "Best" | cut -d ":" -f 2 | tr -d '[:space:]')
                if [ "$(ls -1 | grep "^RAxML" | wc -l)" -ne 0 ]
		then
			rm RAxML*
		fi
        	raxml -f a -T 2 -m PROTGAMMA$RAxMLmodel         	-p 12345 -x 12345 -# 100         	-s ../../per_gene/EOG091G0MI7/ALICUT_EOG091G0MI7.clustalo.fasta -n EOG091G0MI7.clustalo.aln.ALICUT.$RAxMLmodel 		1> ../../per_gene/EOG091G0MI7/infer_single_ML.stdout.txt 2> ../../per_gene/EOG091G0MI7/infer_single_ML.stderr.txt
	else
		echo "fasta file per_gene/EOG091G0MI7/ALICUT_EOG091G0MI7.clustalo.fasta contains fewer than 5 sequences - skipped" > ../../per_gene/EOG091G0MI7/infer_single_ML.stdout.txt
		touch raxml.skipped
	fi
        touch ../../per_gene/EOG091G0MI7/EOG091G0MI7.raxml.done
        [0m
[Mon Jul  6 00:26:32 2020]
Finished job 986.
3135 of 3292 steps (95%) done

[Mon Jul  6 00:26:32 2020]
rule infer_single_ML:
    input: per_gene/EOG091G112U/EOG091G112U.best_model, per_gene/EOG091G112U/ALICUT_EOG091G112U.clustalo.fasta
    output: per_gene/EOG091G112U/EOG091G112U.raxml.done
    log: per_gene/EOG091G112U/infer_single_ML.stdout.txt, per_gene/EOG091G112U/infer_single_ML.stderr.txt
    jobid: 287
    wildcards: BUSCO=EOG091G112U
    threads: 2


        cd per_gene/EOG091G112U
	count=$(cat ../../per_gene/EOG091G112U/ALICUT_EOG091G112U.clustalo.fasta | grep ">" | wc -l)
	if [ "$count" -gt 5 ]
        then
		RAxMLmodel=$(cat ../../per_gene/EOG091G112U/EOG091G112U.best_model | grep "Best" | cut -d ":" -f 2 | tr -d '[:space:]')
                if [ "$(ls -1 | grep "^RAxML" | wc -l)" -ne 0 ]
		then
			rm RAxML*
		fi
        	raxml -f a -T 2 -m PROTGAMMA$RAxMLmodel         	-p 12345 -x 12345 -# 100         	-s ../../per_gene/EOG091G112U/ALICUT_EOG091G112U.clustalo.fasta -n EOG091G112U.clustalo.aln.ALICUT.$RAxMLmodel 		1> ../../per_gene/EOG091G112U/infer_single_ML.stdout.txt 2> ../../per_gene/EOG091G112U/infer_single_ML.stderr.txt
	else
		echo "fasta file per_gene/EOG091G112U/ALICUT_EOG091G112U.clustalo.fasta contains fewer than 5 sequences - skipped" > ../../per_gene/EOG091G112U/infer_single_ML.stdout.txt
		touch raxml.skipped
	fi
        touch ../../per_gene/EOG091G112U/EOG091G112U.raxml.done
        
[33mJob counts:
	count	jobs
	1	infer_single_ML
	1[0m
[33m
        cd per_gene/EOG091G112U
	count=$(cat ../../per_gene/EOG091G112U/ALICUT_EOG091G112U.clustalo.fasta | grep ">" | wc -l)
	if [ "$count" -gt 5 ]
        then
		RAxMLmodel=$(cat ../../per_gene/EOG091G112U/EOG091G112U.best_model | grep "Best" | cut -d ":" -f 2 | tr -d '[:space:]')
                if [ "$(ls -1 | grep "^RAxML" | wc -l)" -ne 0 ]
		then
			rm RAxML*
		fi
        	raxml -f a -T 2 -m PROTGAMMA$RAxMLmodel         	-p 12345 -x 12345 -# 100         	-s ../../per_gene/EOG091G112U/ALICUT_EOG091G112U.clustalo.fasta -n EOG091G112U.clustalo.aln.ALICUT.$RAxMLmodel 		1> ../../per_gene/EOG091G112U/infer_single_ML.stdout.txt 2> ../../per_gene/EOG091G112U/infer_single_ML.stderr.txt
	else
		echo "fasta file per_gene/EOG091G112U/ALICUT_EOG091G112U.clustalo.fasta contains fewer than 5 sequences - skipped" > ../../per_gene/EOG091G112U/infer_single_ML.stdout.txt
		touch raxml.skipped
	fi
        touch ../../per_gene/EOG091G112U/EOG091G112U.raxml.done
        [0m
[Mon Jul  6 00:26:45 2020]
Finished job 213.
3136 of 3292 steps (95%) done

[Mon Jul  6 00:26:45 2020]
rule infer_single_ML:
    input: per_gene/EOG091G11CG/EOG091G11CG.best_model, per_gene/EOG091G11CG/ALICUT_EOG091G11CG.clustalo.fasta
    output: per_gene/EOG091G11CG/EOG091G11CG.raxml.done
    log: per_gene/EOG091G11CG/infer_single_ML.stdout.txt, per_gene/EOG091G11CG/infer_single_ML.stderr.txt
    jobid: 226
    wildcards: BUSCO=EOG091G11CG
    threads: 2


        cd per_gene/EOG091G11CG
	count=$(cat ../../per_gene/EOG091G11CG/ALICUT_EOG091G11CG.clustalo.fasta | grep ">" | wc -l)
	if [ "$count" -gt 5 ]
        then
		RAxMLmodel=$(cat ../../per_gene/EOG091G11CG/EOG091G11CG.best_model | grep "Best" | cut -d ":" -f 2 | tr -d '[:space:]')
                if [ "$(ls -1 | grep "^RAxML" | wc -l)" -ne 0 ]
		then
			rm RAxML*
		fi
        	raxml -f a -T 2 -m PROTGAMMA$RAxMLmodel         	-p 12345 -x 12345 -# 100         	-s ../../per_gene/EOG091G11CG/ALICUT_EOG091G11CG.clustalo.fasta -n EOG091G11CG.clustalo.aln.ALICUT.$RAxMLmodel 		1> ../../per_gene/EOG091G11CG/infer_single_ML.stdout.txt 2> ../../per_gene/EOG091G11CG/infer_single_ML.stderr.txt
	else
		echo "fasta file per_gene/EOG091G11CG/ALICUT_EOG091G11CG.clustalo.fasta contains fewer than 5 sequences - skipped" > ../../per_gene/EOG091G11CG/infer_single_ML.stdout.txt
		touch raxml.skipped
	fi
        touch ../../per_gene/EOG091G11CG/EOG091G11CG.raxml.done
        
[33mJob counts:
	count	jobs
	1	infer_single_ML
	1[0m
[33m
        cd per_gene/EOG091G11CG
	count=$(cat ../../per_gene/EOG091G11CG/ALICUT_EOG091G11CG.clustalo.fasta | grep ">" | wc -l)
	if [ "$count" -gt 5 ]
        then
		RAxMLmodel=$(cat ../../per_gene/EOG091G11CG/EOG091G11CG.best_model | grep "Best" | cut -d ":" -f 2 | tr -d '[:space:]')
                if [ "$(ls -1 | grep "^RAxML" | wc -l)" -ne 0 ]
		then
			rm RAxML*
		fi
        	raxml -f a -T 2 -m PROTGAMMA$RAxMLmodel         	-p 12345 -x 12345 -# 100         	-s ../../per_gene/EOG091G11CG/ALICUT_EOG091G11CG.clustalo.fasta -n EOG091G11CG.clustalo.aln.ALICUT.$RAxMLmodel 		1> ../../per_gene/EOG091G11CG/infer_single_ML.stdout.txt 2> ../../per_gene/EOG091G11CG/infer_single_ML.stderr.txt
	else
		echo "fasta file per_gene/EOG091G11CG/ALICUT_EOG091G11CG.clustalo.fasta contains fewer than 5 sequences - skipped" > ../../per_gene/EOG091G11CG/infer_single_ML.stdout.txt
		touch raxml.skipped
	fi
        touch ../../per_gene/EOG091G11CG/EOG091G11CG.raxml.done
        [0m
[Mon Jul  6 00:27:24 2020]
Finished job 73.
3137 of 3292 steps (95%) done

[Mon Jul  6 00:27:24 2020]
rule get_seqs:
    input: /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ingroup.txt, /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/outgroup.txt
    output: per_gene/EOG091G0E7S/EOG091G0E7S.ingroup.fasta
    log: per_gene/EOG091G0E7S/get_seqs.stdout.txt, per_gene/EOG091G0E7S/get_seqs.stderr.txt
    jobid: 3188
    wildcards: BUSCO=EOG091G0E7S
    threads: 2


	basedir=$(pwd)
        cd per_gene/EOG091G0E7S
        
        bash $basedir/../scripts/fetch_seqs.sh EOG091G0E7S /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ingroup.txt /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/outgroup.txt 1> ../../per_gene/EOG091G0E7S/get_seqs.stdout.txt 2> ../../per_gene/EOG091G0E7S/get_seqs.stderr.txt
	mv EOG091G0E7S.fasta $basedir/per_gene/EOG091G0E7S/EOG091G0E7S.ingroup.fasta
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/72476f9d9a5bd0627b4d721143a21354.simg
[Mon Jul  6 00:27:38 2020]
Finished job 3188.
3138 of 3292 steps (95%) done

[Mon Jul  6 00:27:38 2020]
rule get_outgroups:
    input: per_gene/EOG091G0E7S/EOG091G0E7S.ingroup.fasta
    output: per_gene/EOG091G0E7S/EOG091G0E7S.orthodb.fasta, per_gene/EOG091G0E7S/EOG091G0E7S.outgroup.fasta
    log: per_gene/EOG091G0E7S/get_outgroups.stdout.txt, per_gene/EOG091G0E7S/get_outgroups.stderr.txt
    jobid: 3189
    wildcards: BUSCO=EOG091G0E7S


        #download fastas from Orhtodb for BUSCO id
        for i in {1..5}
        do
             wget "http://www.orthodb.org/fasta?query=EOG091G0E7S&level=33208" -O per_gene/EOG091G0E7S/EOG091G0E7S.orthodb.fasta 1> per_gene/EOG091G0E7S/get_outgroups.stdout.txt 2> per_gene/EOG091G0E7S/get_outgroups.stderr.txt && break || echo -e "try again ($i)" && sleep 15
        done

	#This is quick an dirty for now and just takes the first protein if there is more than one for an outgroup taxon
        bash ../scripts/download_outgroups.sh taxids.txt per_gene/EOG091G0E7S/EOG091G0E7S.orthodb.fasta > per_gene/EOG091G0E7S/EOG091G0E7S.outgroup.fasta
        
[Mon Jul  6 00:27:39 2020]
Finished job 3189.
3139 of 3292 steps (95%) done

[Mon Jul  6 00:27:39 2020]
rule join_groups:
    input: per_gene/EOG091G0E7S/EOG091G0E7S.ingroup.fasta, per_gene/EOG091G0E7S/EOG091G0E7S.outgroup.fasta
    output: per_gene/EOG091G0E7S/EOG091G0E7S.fasta
    jobid: 2418
    wildcards: BUSCO=EOG091G0E7S


        cat per_gene/EOG091G0E7S/EOG091G0E7S.ingroup.fasta per_gene/EOG091G0E7S/EOG091G0E7S.outgroup.fasta > per_gene/EOG091G0E7S/EOG091G0E7S.fasta
        
[Mon Jul  6 00:27:39 2020]
Finished job 2418.
3140 of 3292 steps (95%) done

[Mon Jul  6 00:27:39 2020]
rule MSA:
    input: per_gene/EOG091G0E7S/EOG091G0E7S.fasta
    output: per_gene/EOG091G0E7S/EOG091G0E7S.clustalo.fasta
    log: per_gene/EOG091G0E7S/MSA.stdout.txt, per_gene/EOG091G0E7S/MSA.stderr.txt
    jobid: 1956
    wildcards: BUSCO=EOG091G0E7S
    threads: 2


        clustalo -i per_gene/EOG091G0E7S/EOG091G0E7S.fasta -o per_gene/EOG091G0E7S/EOG091G0E7S.clustalo.fasta --threads=2 1> per_gene/EOG091G0E7S/MSA.stdout.txt 2> per_gene/EOG091G0E7S/MSA.stderr.txt
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/d68c9691725a7401923680874285c430.simg
[Mon Jul  6 00:27:40 2020]
Finished job 1956.
3141 of 3292 steps (95%) done

[Mon Jul  6 00:27:40 2020]
rule score_and_cut:
    input: per_gene/EOG091G0E7S/EOG091G0E7S.clustalo.fasta
    output: per_gene/EOG091G0E7S/ALICUT_EOG091G0E7S.clustalo.fasta
    jobid: 1133
    wildcards: BUSCO=EOG091G0E7S
    threads: 2


        cd per_gene/EOG091G0E7S
        Aliscore.pl -N -r 200000000000000000 -i ../../per_gene/EOG091G0E7S/EOG091G0E7S.clustalo.fasta &> aliscore.log
        ALICUT.pl -s &> alicut.log
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/63c88c27a0fa300f57066b0ef65fefcb.simg
[Mon Jul  6 00:27:50 2020]
Finished job 1133.
3142 of 3292 steps (95%) done

[Mon Jul  6 00:27:50 2020]
rule remove_empty:
    input: per_gene/EOG091G0E7S/ALICUT_EOG091G0E7S.clustalo.fasta
    output: per_gene/EOG091G0E7S/empty_check.done
    jobid: 1955
    wildcards: BUSCO=EOG091G0E7S


         if [ "$(cat per_gene/EOG091G0E7S/ALICUT_EOG091G0E7S.clustalo.fasta | grep -v ">" | sed 's/-//g' | grep "^$" | wc -l)" -gt 0 ]
         then
              cp per_gene/EOG091G0E7S/ALICUT_EOG091G0E7S.clustalo.fasta per_gene/EOG091G0E7S/ALICUT_EOG091G0E7S.clustalo.fasta.backup
              bash ../scripts/remove_empty.sh per_gene/EOG091G0E7S/ALICUT_EOG091G0E7S.clustalo.fasta.backup > per_gene/EOG091G0E7S/ALICUT_EOG091G0E7S.clustalo.fasta
         fi
         touch per_gene/EOG091G0E7S/empty_check.done
         
[Mon Jul  6 00:27:50 2020]
Finished job 1955.
3143 of 3292 steps (95%) done

[Mon Jul  6 00:27:50 2020]
rule find_best_model:
    input: per_gene/EOG091G0E7S/ALICUT_EOG091G0E7S.clustalo.fasta, per_gene/EOG091G0E7S/empty_check.done
    output: per_gene/EOG091G0E7S/EOG091G0E7S.best_model
    log: per_gene/EOG091G0E7S/find_best_model.stderr.txt
    jobid: 1132
    wildcards: BUSCO=EOG091G0E7S
    threads: 2


        cd per_gene/EOG091G0E7S
        if [ ! -d find_best_model ]
        then
            mkdir find_best_model
        fi
        cd find_best_model
        ln -s ../../../per_gene/EOG091G0E7S/ALICUT_EOG091G0E7S.clustalo.fasta EOG091G0E7S.fasta
        ProteinModelSelection.pl EOG091G0E7S.fasta 1> ../../../per_gene/EOG091G0E7S/EOG091G0E7S.best_model 2> ../../../per_gene/EOG091G0E7S/find_best_model.stderr.txt
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/c0c09ee657b1e27f2c5687e0e9aa8d70.simg
[Mon Jul  6 00:27:56 2020]
Finished job 116.
3144 of 3292 steps (96%) done

[Mon Jul  6 00:27:56 2020]
rule get_seqs:
    input: /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ingroup.txt, /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/outgroup.txt
    output: per_gene/EOG091G0LS0/EOG091G0LS0.ingroup.fasta
    log: per_gene/EOG091G0LS0/get_seqs.stdout.txt, per_gene/EOG091G0LS0/get_seqs.stderr.txt
    jobid: 2750
    wildcards: BUSCO=EOG091G0LS0
    threads: 2


	basedir=$(pwd)
        cd per_gene/EOG091G0LS0
        
        bash $basedir/../scripts/fetch_seqs.sh EOG091G0LS0 /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ingroup.txt /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/outgroup.txt 1> ../../per_gene/EOG091G0LS0/get_seqs.stdout.txt 2> ../../per_gene/EOG091G0LS0/get_seqs.stderr.txt
	mv EOG091G0LS0.fasta $basedir/per_gene/EOG091G0LS0/EOG091G0LS0.ingroup.fasta
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/72476f9d9a5bd0627b4d721143a21354.simg
[Mon Jul  6 00:28:10 2020]
Finished job 2750.
3145 of 3292 steps (96%) done

[Mon Jul  6 00:28:10 2020]
rule get_outgroups:
    input: per_gene/EOG091G0LS0/EOG091G0LS0.ingroup.fasta
    output: per_gene/EOG091G0LS0/EOG091G0LS0.orthodb.fasta, per_gene/EOG091G0LS0/EOG091G0LS0.outgroup.fasta
    log: per_gene/EOG091G0LS0/get_outgroups.stdout.txt, per_gene/EOG091G0LS0/get_outgroups.stderr.txt
    jobid: 2751
    wildcards: BUSCO=EOG091G0LS0


        #download fastas from Orhtodb for BUSCO id
        for i in {1..5}
        do
             wget "http://www.orthodb.org/fasta?query=EOG091G0LS0&level=33208" -O per_gene/EOG091G0LS0/EOG091G0LS0.orthodb.fasta 1> per_gene/EOG091G0LS0/get_outgroups.stdout.txt 2> per_gene/EOG091G0LS0/get_outgroups.stderr.txt && break || echo -e "try again ($i)" && sleep 15
        done

	#This is quick an dirty for now and just takes the first protein if there is more than one for an outgroup taxon
        bash ../scripts/download_outgroups.sh taxids.txt per_gene/EOG091G0LS0/EOG091G0LS0.orthodb.fasta > per_gene/EOG091G0LS0/EOG091G0LS0.outgroup.fasta
        
[Mon Jul  6 00:28:11 2020]
Finished job 226.
3146 of 3292 steps (96%) done

[Mon Jul  6 00:28:11 2020]
rule get_seqs:
    input: /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ingroup.txt, /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/outgroup.txt
    output: per_gene/EOG091G0D0W/EOG091G0D0W.ingroup.fasta
    log: per_gene/EOG091G0D0W/get_seqs.stdout.txt, per_gene/EOG091G0D0W/get_seqs.stderr.txt
    jobid: 3090
    wildcards: BUSCO=EOG091G0D0W
    threads: 2


	basedir=$(pwd)
        cd per_gene/EOG091G0D0W
        
        bash $basedir/../scripts/fetch_seqs.sh EOG091G0D0W /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ingroup.txt /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/outgroup.txt 1> ../../per_gene/EOG091G0D0W/get_seqs.stdout.txt 2> ../../per_gene/EOG091G0D0W/get_seqs.stderr.txt
	mv EOG091G0D0W.fasta $basedir/per_gene/EOG091G0D0W/EOG091G0D0W.ingroup.fasta
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/72476f9d9a5bd0627b4d721143a21354.simg
[Mon Jul  6 00:28:11 2020]
Finished job 2751.
3147 of 3292 steps (96%) done

[Mon Jul  6 00:28:11 2020]
rule join_groups:
    input: per_gene/EOG091G0LS0/EOG091G0LS0.ingroup.fasta, per_gene/EOG091G0LS0/EOG091G0LS0.outgroup.fasta
    output: per_gene/EOG091G0LS0/EOG091G0LS0.fasta
    jobid: 2199
    wildcards: BUSCO=EOG091G0LS0


        cat per_gene/EOG091G0LS0/EOG091G0LS0.ingroup.fasta per_gene/EOG091G0LS0/EOG091G0LS0.outgroup.fasta > per_gene/EOG091G0LS0/EOG091G0LS0.fasta
        
[Mon Jul  6 00:28:11 2020]
Finished job 2199.
3148 of 3292 steps (96%) done

[Mon Jul  6 00:28:11 2020]
rule MSA:
    input: per_gene/EOG091G0LS0/EOG091G0LS0.fasta
    output: per_gene/EOG091G0LS0/EOG091G0LS0.clustalo.fasta
    log: per_gene/EOG091G0LS0/MSA.stdout.txt, per_gene/EOG091G0LS0/MSA.stderr.txt
    jobid: 1518
    wildcards: BUSCO=EOG091G0LS0
    threads: 2


        clustalo -i per_gene/EOG091G0LS0/EOG091G0LS0.fasta -o per_gene/EOG091G0LS0/EOG091G0LS0.clustalo.fasta --threads=2 1> per_gene/EOG091G0LS0/MSA.stdout.txt 2> per_gene/EOG091G0LS0/MSA.stderr.txt
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/d68c9691725a7401923680874285c430.simg
[Mon Jul  6 00:28:12 2020]
Finished job 1518.
3149 of 3292 steps (96%) done

[Mon Jul  6 00:28:12 2020]
rule score_and_cut:
    input: per_gene/EOG091G0LS0/EOG091G0LS0.clustalo.fasta
    output: per_gene/EOG091G0LS0/ALICUT_EOG091G0LS0.clustalo.fasta
    jobid: 695
    wildcards: BUSCO=EOG091G0LS0
    threads: 2


        cd per_gene/EOG091G0LS0
        Aliscore.pl -N -r 200000000000000000 -i ../../per_gene/EOG091G0LS0/EOG091G0LS0.clustalo.fasta &> aliscore.log
        ALICUT.pl -s &> alicut.log
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/63c88c27a0fa300f57066b0ef65fefcb.simg
[Mon Jul  6 00:28:20 2020]
Finished job 1132.
3150 of 3292 steps (96%) done

[Mon Jul  6 00:28:20 2020]
rule infer_single_ML:
    input: per_gene/EOG091G0E7S/EOG091G0E7S.best_model, per_gene/EOG091G0E7S/ALICUT_EOG091G0E7S.clustalo.fasta
    output: per_gene/EOG091G0E7S/EOG091G0E7S.raxml.done
    log: per_gene/EOG091G0E7S/infer_single_ML.stdout.txt, per_gene/EOG091G0E7S/infer_single_ML.stderr.txt
    jobid: 360
    wildcards: BUSCO=EOG091G0E7S
    threads: 2


        cd per_gene/EOG091G0E7S
	count=$(cat ../../per_gene/EOG091G0E7S/ALICUT_EOG091G0E7S.clustalo.fasta | grep ">" | wc -l)
	if [ "$count" -gt 5 ]
        then
		RAxMLmodel=$(cat ../../per_gene/EOG091G0E7S/EOG091G0E7S.best_model | grep "Best" | cut -d ":" -f 2 | tr -d '[:space:]')
                if [ "$(ls -1 | grep "^RAxML" | wc -l)" -ne 0 ]
		then
			rm RAxML*
		fi
        	raxml -f a -T 2 -m PROTGAMMA$RAxMLmodel         	-p 12345 -x 12345 -# 100         	-s ../../per_gene/EOG091G0E7S/ALICUT_EOG091G0E7S.clustalo.fasta -n EOG091G0E7S.clustalo.aln.ALICUT.$RAxMLmodel 		1> ../../per_gene/EOG091G0E7S/infer_single_ML.stdout.txt 2> ../../per_gene/EOG091G0E7S/infer_single_ML.stderr.txt
	else
		echo "fasta file per_gene/EOG091G0E7S/ALICUT_EOG091G0E7S.clustalo.fasta contains fewer than 5 sequences - skipped" > ../../per_gene/EOG091G0E7S/infer_single_ML.stdout.txt
		touch raxml.skipped
	fi
        touch ../../per_gene/EOG091G0E7S/EOG091G0E7S.raxml.done
        
[Mon Jul  6 00:28:22 2020]
Finished job 695.
3151 of 3292 steps (96%) done

[Mon Jul  6 00:28:22 2020]
rule remove_empty:
    input: per_gene/EOG091G0LS0/ALICUT_EOG091G0LS0.clustalo.fasta
    output: per_gene/EOG091G0LS0/empty_check.done
    jobid: 1517
    wildcards: BUSCO=EOG091G0LS0


         if [ "$(cat per_gene/EOG091G0LS0/ALICUT_EOG091G0LS0.clustalo.fasta | grep -v ">" | sed 's/-//g' | grep "^$" | wc -l)" -gt 0 ]
         then
              cp per_gene/EOG091G0LS0/ALICUT_EOG091G0LS0.clustalo.fasta per_gene/EOG091G0LS0/ALICUT_EOG091G0LS0.clustalo.fasta.backup
              bash ../scripts/remove_empty.sh per_gene/EOG091G0LS0/ALICUT_EOG091G0LS0.clustalo.fasta.backup > per_gene/EOG091G0LS0/ALICUT_EOG091G0LS0.clustalo.fasta
         fi
         touch per_gene/EOG091G0LS0/empty_check.done
         
[Mon Jul  6 00:28:22 2020]
Finished job 1517.
3152 of 3292 steps (96%) done

[Mon Jul  6 00:28:22 2020]
rule find_best_model:
    input: per_gene/EOG091G0LS0/ALICUT_EOG091G0LS0.clustalo.fasta, per_gene/EOG091G0LS0/empty_check.done
    output: per_gene/EOG091G0LS0/EOG091G0LS0.best_model
    log: per_gene/EOG091G0LS0/find_best_model.stderr.txt
    jobid: 694
    wildcards: BUSCO=EOG091G0LS0
    threads: 2


        cd per_gene/EOG091G0LS0
        if [ ! -d find_best_model ]
        then
            mkdir find_best_model
        fi
        cd find_best_model
        ln -s ../../../per_gene/EOG091G0LS0/ALICUT_EOG091G0LS0.clustalo.fasta EOG091G0LS0.fasta
        ProteinModelSelection.pl EOG091G0LS0.fasta 1> ../../../per_gene/EOG091G0LS0/EOG091G0LS0.best_model 2> ../../../per_gene/EOG091G0LS0/find_best_model.stderr.txt
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/c0c09ee657b1e27f2c5687e0e9aa8d70.simg
[Mon Jul  6 00:28:25 2020]
Finished job 3090.
3153 of 3292 steps (96%) done

[Mon Jul  6 00:28:25 2020]
rule get_outgroups:
    input: per_gene/EOG091G0D0W/EOG091G0D0W.ingroup.fasta
    output: per_gene/EOG091G0D0W/EOG091G0D0W.orthodb.fasta, per_gene/EOG091G0D0W/EOG091G0D0W.outgroup.fasta
    log: per_gene/EOG091G0D0W/get_outgroups.stdout.txt, per_gene/EOG091G0D0W/get_outgroups.stderr.txt
    jobid: 3091
    wildcards: BUSCO=EOG091G0D0W


        #download fastas from Orhtodb for BUSCO id
        for i in {1..5}
        do
             wget "http://www.orthodb.org/fasta?query=EOG091G0D0W&level=33208" -O per_gene/EOG091G0D0W/EOG091G0D0W.orthodb.fasta 1> per_gene/EOG091G0D0W/get_outgroups.stdout.txt 2> per_gene/EOG091G0D0W/get_outgroups.stderr.txt && break || echo -e "try again ($i)" && sleep 15
        done

	#This is quick an dirty for now and just takes the first protein if there is more than one for an outgroup taxon
        bash ../scripts/download_outgroups.sh taxids.txt per_gene/EOG091G0D0W/EOG091G0D0W.orthodb.fasta > per_gene/EOG091G0D0W/EOG091G0D0W.outgroup.fasta
        
[Mon Jul  6 00:28:25 2020]
Finished job 3091.
3154 of 3292 steps (96%) done

[Mon Jul  6 00:28:25 2020]
rule join_groups:
    input: per_gene/EOG091G0D0W/EOG091G0D0W.ingroup.fasta, per_gene/EOG091G0D0W/EOG091G0D0W.outgroup.fasta
    output: per_gene/EOG091G0D0W/EOG091G0D0W.fasta
    jobid: 2369
    wildcards: BUSCO=EOG091G0D0W


        cat per_gene/EOG091G0D0W/EOG091G0D0W.ingroup.fasta per_gene/EOG091G0D0W/EOG091G0D0W.outgroup.fasta > per_gene/EOG091G0D0W/EOG091G0D0W.fasta
        
[Mon Jul  6 00:28:25 2020]
Finished job 2369.
3155 of 3292 steps (96%) done

[Mon Jul  6 00:28:25 2020]
rule MSA:
    input: per_gene/EOG091G0D0W/EOG091G0D0W.fasta
    output: per_gene/EOG091G0D0W/EOG091G0D0W.clustalo.fasta
    log: per_gene/EOG091G0D0W/MSA.stdout.txt, per_gene/EOG091G0D0W/MSA.stderr.txt
    jobid: 1858
    wildcards: BUSCO=EOG091G0D0W
    threads: 2


        clustalo -i per_gene/EOG091G0D0W/EOG091G0D0W.fasta -o per_gene/EOG091G0D0W/EOG091G0D0W.clustalo.fasta --threads=2 1> per_gene/EOG091G0D0W/MSA.stdout.txt 2> per_gene/EOG091G0D0W/MSA.stderr.txt
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/d68c9691725a7401923680874285c430.simg
[Mon Jul  6 00:28:28 2020]
Finished job 1858.
3156 of 3292 steps (96%) done

[Mon Jul  6 00:28:28 2020]
rule score_and_cut:
    input: per_gene/EOG091G0D0W/EOG091G0D0W.clustalo.fasta
    output: per_gene/EOG091G0D0W/ALICUT_EOG091G0D0W.clustalo.fasta
    jobid: 1035
    wildcards: BUSCO=EOG091G0D0W
    threads: 2


        cd per_gene/EOG091G0D0W
        Aliscore.pl -N -r 200000000000000000 -i ../../per_gene/EOG091G0D0W/EOG091G0D0W.clustalo.fasta &> aliscore.log
        ALICUT.pl -s &> alicut.log
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/63c88c27a0fa300f57066b0ef65fefcb.simg
[33mJob counts:
	count	jobs
	1	infer_single_ML
	1[0m
[33m
        cd per_gene/EOG091G0E7S
	count=$(cat ../../per_gene/EOG091G0E7S/ALICUT_EOG091G0E7S.clustalo.fasta | grep ">" | wc -l)
	if [ "$count" -gt 5 ]
        then
		RAxMLmodel=$(cat ../../per_gene/EOG091G0E7S/EOG091G0E7S.best_model | grep "Best" | cut -d ":" -f 2 | tr -d '[:space:]')
                if [ "$(ls -1 | grep "^RAxML" | wc -l)" -ne 0 ]
		then
			rm RAxML*
		fi
        	raxml -f a -T 2 -m PROTGAMMA$RAxMLmodel         	-p 12345 -x 12345 -# 100         	-s ../../per_gene/EOG091G0E7S/ALICUT_EOG091G0E7S.clustalo.fasta -n EOG091G0E7S.clustalo.aln.ALICUT.$RAxMLmodel 		1> ../../per_gene/EOG091G0E7S/infer_single_ML.stdout.txt 2> ../../per_gene/EOG091G0E7S/infer_single_ML.stderr.txt
	else
		echo "fasta file per_gene/EOG091G0E7S/ALICUT_EOG091G0E7S.clustalo.fasta contains fewer than 5 sequences - skipped" > ../../per_gene/EOG091G0E7S/infer_single_ML.stdout.txt
		touch raxml.skipped
	fi
        touch ../../per_gene/EOG091G0E7S/EOG091G0E7S.raxml.done
        [0m
[Mon Jul  6 00:28:38 2020]
Finished job 1035.
3157 of 3292 steps (96%) done

[Mon Jul  6 00:28:38 2020]
rule remove_empty:
    input: per_gene/EOG091G0D0W/ALICUT_EOG091G0D0W.clustalo.fasta
    output: per_gene/EOG091G0D0W/empty_check.done
    jobid: 1857
    wildcards: BUSCO=EOG091G0D0W


         if [ "$(cat per_gene/EOG091G0D0W/ALICUT_EOG091G0D0W.clustalo.fasta | grep -v ">" | sed 's/-//g' | grep "^$" | wc -l)" -gt 0 ]
         then
              cp per_gene/EOG091G0D0W/ALICUT_EOG091G0D0W.clustalo.fasta per_gene/EOG091G0D0W/ALICUT_EOG091G0D0W.clustalo.fasta.backup
              bash ../scripts/remove_empty.sh per_gene/EOG091G0D0W/ALICUT_EOG091G0D0W.clustalo.fasta.backup > per_gene/EOG091G0D0W/ALICUT_EOG091G0D0W.clustalo.fasta
         fi
         touch per_gene/EOG091G0D0W/empty_check.done
         
[Mon Jul  6 00:28:38 2020]
Finished job 1857.
3158 of 3292 steps (96%) done

[Mon Jul  6 00:28:38 2020]
rule find_best_model:
    input: per_gene/EOG091G0D0W/ALICUT_EOG091G0D0W.clustalo.fasta, per_gene/EOG091G0D0W/empty_check.done
    output: per_gene/EOG091G0D0W/EOG091G0D0W.best_model
    log: per_gene/EOG091G0D0W/find_best_model.stderr.txt
    jobid: 1034
    wildcards: BUSCO=EOG091G0D0W
    threads: 2


        cd per_gene/EOG091G0D0W
        if [ ! -d find_best_model ]
        then
            mkdir find_best_model
        fi
        cd find_best_model
        ln -s ../../../per_gene/EOG091G0D0W/ALICUT_EOG091G0D0W.clustalo.fasta EOG091G0D0W.fasta
        ProteinModelSelection.pl EOG091G0D0W.fasta 1> ../../../per_gene/EOG091G0D0W/EOG091G0D0W.best_model 2> ../../../per_gene/EOG091G0D0W/find_best_model.stderr.txt
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/c0c09ee657b1e27f2c5687e0e9aa8d70.simg
[Mon Jul  6 00:28:44 2020]
Finished job 236.
3159 of 3292 steps (96%) done

[Mon Jul  6 00:28:44 2020]
rule get_seqs:
    input: /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ingroup.txt, /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/outgroup.txt
    output: per_gene/EOG091G0CW2/EOG091G0CW2.ingroup.fasta
    log: per_gene/EOG091G0CW2/get_seqs.stdout.txt, per_gene/EOG091G0CW2/get_seqs.stderr.txt
    jobid: 3088
    wildcards: BUSCO=EOG091G0CW2
    threads: 2


	basedir=$(pwd)
        cd per_gene/EOG091G0CW2
        
        bash $basedir/../scripts/fetch_seqs.sh EOG091G0CW2 /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ingroup.txt /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/outgroup.txt 1> ../../per_gene/EOG091G0CW2/get_seqs.stdout.txt 2> ../../per_gene/EOG091G0CW2/get_seqs.stderr.txt
	mv EOG091G0CW2.fasta $basedir/per_gene/EOG091G0CW2/EOG091G0CW2.ingroup.fasta
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/72476f9d9a5bd0627b4d721143a21354.simg
[Mon Jul  6 00:28:55 2020]
Finished job 694.
3160 of 3292 steps (96%) done

[Mon Jul  6 00:28:55 2020]
rule infer_single_ML:
    input: per_gene/EOG091G0LS0/EOG091G0LS0.best_model, per_gene/EOG091G0LS0/ALICUT_EOG091G0LS0.clustalo.fasta
    output: per_gene/EOG091G0LS0/EOG091G0LS0.raxml.done
    log: per_gene/EOG091G0LS0/infer_single_ML.stdout.txt, per_gene/EOG091G0LS0/infer_single_ML.stderr.txt
    jobid: 141
    wildcards: BUSCO=EOG091G0LS0
    threads: 2


        cd per_gene/EOG091G0LS0
	count=$(cat ../../per_gene/EOG091G0LS0/ALICUT_EOG091G0LS0.clustalo.fasta | grep ">" | wc -l)
	if [ "$count" -gt 5 ]
        then
		RAxMLmodel=$(cat ../../per_gene/EOG091G0LS0/EOG091G0LS0.best_model | grep "Best" | cut -d ":" -f 2 | tr -d '[:space:]')
                if [ "$(ls -1 | grep "^RAxML" | wc -l)" -ne 0 ]
		then
			rm RAxML*
		fi
        	raxml -f a -T 2 -m PROTGAMMA$RAxMLmodel         	-p 12345 -x 12345 -# 100         	-s ../../per_gene/EOG091G0LS0/ALICUT_EOG091G0LS0.clustalo.fasta -n EOG091G0LS0.clustalo.aln.ALICUT.$RAxMLmodel 		1> ../../per_gene/EOG091G0LS0/infer_single_ML.stdout.txt 2> ../../per_gene/EOG091G0LS0/infer_single_ML.stderr.txt
	else
		echo "fasta file per_gene/EOG091G0LS0/ALICUT_EOG091G0LS0.clustalo.fasta contains fewer than 5 sequences - skipped" > ../../per_gene/EOG091G0LS0/infer_single_ML.stdout.txt
		touch raxml.skipped
	fi
        touch ../../per_gene/EOG091G0LS0/EOG091G0LS0.raxml.done
        
[Mon Jul  6 00:28:55 2020]
Finished job 148.
3161 of 3292 steps (96%) done

[Mon Jul  6 00:28:55 2020]
rule get_seqs:
    input: /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ingroup.txt, /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/outgroup.txt
    output: per_gene/EOG091G06S3/EOG091G06S3.ingroup.fasta
    log: per_gene/EOG091G06S3/get_seqs.stdout.txt, per_gene/EOG091G06S3/get_seqs.stderr.txt
    jobid: 2564
    wildcards: BUSCO=EOG091G06S3
    threads: 2


	basedir=$(pwd)
        cd per_gene/EOG091G06S3
        
        bash $basedir/../scripts/fetch_seqs.sh EOG091G06S3 /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ingroup.txt /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/outgroup.txt 1> ../../per_gene/EOG091G06S3/get_seqs.stdout.txt 2> ../../per_gene/EOG091G06S3/get_seqs.stderr.txt
	mv EOG091G06S3.fasta $basedir/per_gene/EOG091G06S3/EOG091G06S3.ingroup.fasta
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/72476f9d9a5bd0627b4d721143a21354.simg
[33mJob counts:
	count	jobs
	1	infer_single_ML
	1[0m
[33m
        cd per_gene/EOG091G0LS0
	count=$(cat ../../per_gene/EOG091G0LS0/ALICUT_EOG091G0LS0.clustalo.fasta | grep ">" | wc -l)
	if [ "$count" -gt 5 ]
        then
		RAxMLmodel=$(cat ../../per_gene/EOG091G0LS0/EOG091G0LS0.best_model | grep "Best" | cut -d ":" -f 2 | tr -d '[:space:]')
                if [ "$(ls -1 | grep "^RAxML" | wc -l)" -ne 0 ]
		then
			rm RAxML*
		fi
        	raxml -f a -T 2 -m PROTGAMMA$RAxMLmodel         	-p 12345 -x 12345 -# 100         	-s ../../per_gene/EOG091G0LS0/ALICUT_EOG091G0LS0.clustalo.fasta -n EOG091G0LS0.clustalo.aln.ALICUT.$RAxMLmodel 		1> ../../per_gene/EOG091G0LS0/infer_single_ML.stdout.txt 2> ../../per_gene/EOG091G0LS0/infer_single_ML.stderr.txt
	else
		echo "fasta file per_gene/EOG091G0LS0/ALICUT_EOG091G0LS0.clustalo.fasta contains fewer than 5 sequences - skipped" > ../../per_gene/EOG091G0LS0/infer_single_ML.stdout.txt
		touch raxml.skipped
	fi
        touch ../../per_gene/EOG091G0LS0/EOG091G0LS0.raxml.done
        [0m
[Mon Jul  6 00:28:58 2020]
Finished job 3088.
3162 of 3292 steps (96%) done

[Mon Jul  6 00:28:58 2020]
rule get_outgroups:
    input: per_gene/EOG091G0CW2/EOG091G0CW2.ingroup.fasta
    output: per_gene/EOG091G0CW2/EOG091G0CW2.orthodb.fasta, per_gene/EOG091G0CW2/EOG091G0CW2.outgroup.fasta
    log: per_gene/EOG091G0CW2/get_outgroups.stdout.txt, per_gene/EOG091G0CW2/get_outgroups.stderr.txt
    jobid: 3089
    wildcards: BUSCO=EOG091G0CW2


        #download fastas from Orhtodb for BUSCO id
        for i in {1..5}
        do
             wget "http://www.orthodb.org/fasta?query=EOG091G0CW2&level=33208" -O per_gene/EOG091G0CW2/EOG091G0CW2.orthodb.fasta 1> per_gene/EOG091G0CW2/get_outgroups.stdout.txt 2> per_gene/EOG091G0CW2/get_outgroups.stderr.txt && break || echo -e "try again ($i)" && sleep 15
        done

	#This is quick an dirty for now and just takes the first protein if there is more than one for an outgroup taxon
        bash ../scripts/download_outgroups.sh taxids.txt per_gene/EOG091G0CW2/EOG091G0CW2.orthodb.fasta > per_gene/EOG091G0CW2/EOG091G0CW2.outgroup.fasta
        
[Mon Jul  6 00:28:59 2020]
Finished job 3089.
3163 of 3292 steps (96%) done

[Mon Jul  6 00:28:59 2020]
rule join_groups:
    input: per_gene/EOG091G0CW2/EOG091G0CW2.ingroup.fasta, per_gene/EOG091G0CW2/EOG091G0CW2.outgroup.fasta
    output: per_gene/EOG091G0CW2/EOG091G0CW2.fasta
    jobid: 2368
    wildcards: BUSCO=EOG091G0CW2


        cat per_gene/EOG091G0CW2/EOG091G0CW2.ingroup.fasta per_gene/EOG091G0CW2/EOG091G0CW2.outgroup.fasta > per_gene/EOG091G0CW2/EOG091G0CW2.fasta
        
[Mon Jul  6 00:28:59 2020]
Finished job 2368.
3164 of 3292 steps (96%) done

[Mon Jul  6 00:28:59 2020]
rule MSA:
    input: per_gene/EOG091G0CW2/EOG091G0CW2.fasta
    output: per_gene/EOG091G0CW2/EOG091G0CW2.clustalo.fasta
    log: per_gene/EOG091G0CW2/MSA.stdout.txt, per_gene/EOG091G0CW2/MSA.stderr.txt
    jobid: 1856
    wildcards: BUSCO=EOG091G0CW2
    threads: 2


        clustalo -i per_gene/EOG091G0CW2/EOG091G0CW2.fasta -o per_gene/EOG091G0CW2/EOG091G0CW2.clustalo.fasta --threads=2 1> per_gene/EOG091G0CW2/MSA.stdout.txt 2> per_gene/EOG091G0CW2/MSA.stderr.txt
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/d68c9691725a7401923680874285c430.simg
[Mon Jul  6 00:29:00 2020]
Finished job 1856.
3165 of 3292 steps (96%) done

[Mon Jul  6 00:29:00 2020]
rule score_and_cut:
    input: per_gene/EOG091G0CW2/EOG091G0CW2.clustalo.fasta
    output: per_gene/EOG091G0CW2/ALICUT_EOG091G0CW2.clustalo.fasta
    jobid: 1033
    wildcards: BUSCO=EOG091G0CW2
    threads: 2


        cd per_gene/EOG091G0CW2
        Aliscore.pl -N -r 200000000000000000 -i ../../per_gene/EOG091G0CW2/EOG091G0CW2.clustalo.fasta &> aliscore.log
        ALICUT.pl -s &> alicut.log
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/63c88c27a0fa300f57066b0ef65fefcb.simg
[Mon Jul  6 00:29:02 2020]
Finished job 273.
3166 of 3292 steps (96%) done

[Mon Jul  6 00:29:02 2020]
rule get_seqs:
    input: /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ingroup.txt, /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/outgroup.txt
    output: per_gene/EOG091G0ID9/EOG091G0ID9.ingroup.fasta
    log: per_gene/EOG091G0ID9/get_seqs.stdout.txt, per_gene/EOG091G0ID9/get_seqs.stderr.txt
    jobid: 3206
    wildcards: BUSCO=EOG091G0ID9
    threads: 2


	basedir=$(pwd)
        cd per_gene/EOG091G0ID9
        
        bash $basedir/../scripts/fetch_seqs.sh EOG091G0ID9 /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ingroup.txt /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/outgroup.txt 1> ../../per_gene/EOG091G0ID9/get_seqs.stdout.txt 2> ../../per_gene/EOG091G0ID9/get_seqs.stderr.txt
	mv EOG091G0ID9.fasta $basedir/per_gene/EOG091G0ID9/EOG091G0ID9.ingroup.fasta
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/72476f9d9a5bd0627b4d721143a21354.simg
[Mon Jul  6 00:29:08 2020]
Finished job 385.
3167 of 3292 steps (96%) done

[Mon Jul  6 00:29:08 2020]
rule get_seqs:
    input: /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ingroup.txt, /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/outgroup.txt
    output: per_gene/EOG091G0WT4/EOG091G0WT4.ingroup.fasta
    log: per_gene/EOG091G0WT4/get_seqs.stdout.txt, per_gene/EOG091G0WT4/get_seqs.stderr.txt
    jobid: 2888
    wildcards: BUSCO=EOG091G0WT4
    threads: 2


	basedir=$(pwd)
        cd per_gene/EOG091G0WT4
        
        bash $basedir/../scripts/fetch_seqs.sh EOG091G0WT4 /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ingroup.txt /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/outgroup.txt 1> ../../per_gene/EOG091G0WT4/get_seqs.stdout.txt 2> ../../per_gene/EOG091G0WT4/get_seqs.stderr.txt
	mv EOG091G0WT4.fasta $basedir/per_gene/EOG091G0WT4/EOG091G0WT4.ingroup.fasta
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/72476f9d9a5bd0627b4d721143a21354.simg
[Mon Jul  6 00:29:11 2020]
Finished job 1033.
3168 of 3292 steps (96%) done

[Mon Jul  6 00:29:11 2020]
rule remove_empty:
    input: per_gene/EOG091G0CW2/ALICUT_EOG091G0CW2.clustalo.fasta
    output: per_gene/EOG091G0CW2/empty_check.done
    jobid: 1855
    wildcards: BUSCO=EOG091G0CW2


         if [ "$(cat per_gene/EOG091G0CW2/ALICUT_EOG091G0CW2.clustalo.fasta | grep -v ">" | sed 's/-//g' | grep "^$" | wc -l)" -gt 0 ]
         then
              cp per_gene/EOG091G0CW2/ALICUT_EOG091G0CW2.clustalo.fasta per_gene/EOG091G0CW2/ALICUT_EOG091G0CW2.clustalo.fasta.backup
              bash ../scripts/remove_empty.sh per_gene/EOG091G0CW2/ALICUT_EOG091G0CW2.clustalo.fasta.backup > per_gene/EOG091G0CW2/ALICUT_EOG091G0CW2.clustalo.fasta
         fi
         touch per_gene/EOG091G0CW2/empty_check.done
         
[Mon Jul  6 00:29:11 2020]
Finished job 1855.
3169 of 3292 steps (96%) done

[Mon Jul  6 00:29:11 2020]
rule find_best_model:
    input: per_gene/EOG091G0CW2/ALICUT_EOG091G0CW2.clustalo.fasta, per_gene/EOG091G0CW2/empty_check.done
    output: per_gene/EOG091G0CW2/EOG091G0CW2.best_model
    log: per_gene/EOG091G0CW2/find_best_model.stderr.txt
    jobid: 1032
    wildcards: BUSCO=EOG091G0CW2
    threads: 2


        cd per_gene/EOG091G0CW2
        if [ ! -d find_best_model ]
        then
            mkdir find_best_model
        fi
        cd find_best_model
        ln -s ../../../per_gene/EOG091G0CW2/ALICUT_EOG091G0CW2.clustalo.fasta EOG091G0CW2.fasta
        ProteinModelSelection.pl EOG091G0CW2.fasta 1> ../../../per_gene/EOG091G0CW2/EOG091G0CW2.best_model 2> ../../../per_gene/EOG091G0CW2/find_best_model.stderr.txt
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/c0c09ee657b1e27f2c5687e0e9aa8d70.simg
[Mon Jul  6 00:29:12 2020]
Finished job 2564.
3170 of 3292 steps (96%) done

[Mon Jul  6 00:29:12 2020]
rule get_outgroups:
    input: per_gene/EOG091G06S3/EOG091G06S3.ingroup.fasta
    output: per_gene/EOG091G06S3/EOG091G06S3.orthodb.fasta, per_gene/EOG091G06S3/EOG091G06S3.outgroup.fasta
    log: per_gene/EOG091G06S3/get_outgroups.stdout.txt, per_gene/EOG091G06S3/get_outgroups.stderr.txt
    jobid: 2565
    wildcards: BUSCO=EOG091G06S3


        #download fastas from Orhtodb for BUSCO id
        for i in {1..5}
        do
             wget "http://www.orthodb.org/fasta?query=EOG091G06S3&level=33208" -O per_gene/EOG091G06S3/EOG091G06S3.orthodb.fasta 1> per_gene/EOG091G06S3/get_outgroups.stdout.txt 2> per_gene/EOG091G06S3/get_outgroups.stderr.txt && break || echo -e "try again ($i)" && sleep 15
        done

	#This is quick an dirty for now and just takes the first protein if there is more than one for an outgroup taxon
        bash ../scripts/download_outgroups.sh taxids.txt per_gene/EOG091G06S3/EOG091G06S3.orthodb.fasta > per_gene/EOG091G06S3/EOG091G06S3.outgroup.fasta
        
[Mon Jul  6 00:29:13 2020]
Finished job 2565.
3171 of 3292 steps (96%) done

[Mon Jul  6 00:29:13 2020]
rule join_groups:
    input: per_gene/EOG091G06S3/EOG091G06S3.ingroup.fasta, per_gene/EOG091G06S3/EOG091G06S3.outgroup.fasta
    output: per_gene/EOG091G06S3/EOG091G06S3.fasta
    jobid: 2106
    wildcards: BUSCO=EOG091G06S3


        cat per_gene/EOG091G06S3/EOG091G06S3.ingroup.fasta per_gene/EOG091G06S3/EOG091G06S3.outgroup.fasta > per_gene/EOG091G06S3/EOG091G06S3.fasta
        
[Mon Jul  6 00:29:13 2020]
Finished job 2106.
3172 of 3292 steps (96%) done

[Mon Jul  6 00:29:13 2020]
rule MSA:
    input: per_gene/EOG091G06S3/EOG091G06S3.fasta
    output: per_gene/EOG091G06S3/EOG091G06S3.clustalo.fasta
    log: per_gene/EOG091G06S3/MSA.stdout.txt, per_gene/EOG091G06S3/MSA.stderr.txt
    jobid: 1332
    wildcards: BUSCO=EOG091G06S3
    threads: 2


        clustalo -i per_gene/EOG091G06S3/EOG091G06S3.fasta -o per_gene/EOG091G06S3/EOG091G06S3.clustalo.fasta --threads=2 1> per_gene/EOG091G06S3/MSA.stdout.txt 2> per_gene/EOG091G06S3/MSA.stderr.txt
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/d68c9691725a7401923680874285c430.simg
[Mon Jul  6 00:29:13 2020]
Finished job 1034.
3173 of 3292 steps (96%) done

[Mon Jul  6 00:29:13 2020]
rule infer_single_ML:
    input: per_gene/EOG091G0D0W/EOG091G0D0W.best_model, per_gene/EOG091G0D0W/ALICUT_EOG091G0D0W.clustalo.fasta
    output: per_gene/EOG091G0D0W/EOG091G0D0W.raxml.done
    log: per_gene/EOG091G0D0W/infer_single_ML.stdout.txt, per_gene/EOG091G0D0W/infer_single_ML.stderr.txt
    jobid: 311
    wildcards: BUSCO=EOG091G0D0W
    threads: 2


        cd per_gene/EOG091G0D0W
	count=$(cat ../../per_gene/EOG091G0D0W/ALICUT_EOG091G0D0W.clustalo.fasta | grep ">" | wc -l)
	if [ "$count" -gt 5 ]
        then
		RAxMLmodel=$(cat ../../per_gene/EOG091G0D0W/EOG091G0D0W.best_model | grep "Best" | cut -d ":" -f 2 | tr -d '[:space:]')
                if [ "$(ls -1 | grep "^RAxML" | wc -l)" -ne 0 ]
		then
			rm RAxML*
		fi
        	raxml -f a -T 2 -m PROTGAMMA$RAxMLmodel         	-p 12345 -x 12345 -# 100         	-s ../../per_gene/EOG091G0D0W/ALICUT_EOG091G0D0W.clustalo.fasta -n EOG091G0D0W.clustalo.aln.ALICUT.$RAxMLmodel 		1> ../../per_gene/EOG091G0D0W/infer_single_ML.stdout.txt 2> ../../per_gene/EOG091G0D0W/infer_single_ML.stderr.txt
	else
		echo "fasta file per_gene/EOG091G0D0W/ALICUT_EOG091G0D0W.clustalo.fasta contains fewer than 5 sequences - skipped" > ../../per_gene/EOG091G0D0W/infer_single_ML.stdout.txt
		touch raxml.skipped
	fi
        touch ../../per_gene/EOG091G0D0W/EOG091G0D0W.raxml.done
        
[33mJob counts:
	count	jobs
	1	infer_single_ML
	1[0m
[33m
        cd per_gene/EOG091G0D0W
	count=$(cat ../../per_gene/EOG091G0D0W/ALICUT_EOG091G0D0W.clustalo.fasta | grep ">" | wc -l)
	if [ "$count" -gt 5 ]
        then
		RAxMLmodel=$(cat ../../per_gene/EOG091G0D0W/EOG091G0D0W.best_model | grep "Best" | cut -d ":" -f 2 | tr -d '[:space:]')
                if [ "$(ls -1 | grep "^RAxML" | wc -l)" -ne 0 ]
		then
			rm RAxML*
		fi
        	raxml -f a -T 2 -m PROTGAMMA$RAxMLmodel         	-p 12345 -x 12345 -# 100         	-s ../../per_gene/EOG091G0D0W/ALICUT_EOG091G0D0W.clustalo.fasta -n EOG091G0D0W.clustalo.aln.ALICUT.$RAxMLmodel 		1> ../../per_gene/EOG091G0D0W/infer_single_ML.stdout.txt 2> ../../per_gene/EOG091G0D0W/infer_single_ML.stderr.txt
	else
		echo "fasta file per_gene/EOG091G0D0W/ALICUT_EOG091G0D0W.clustalo.fasta contains fewer than 5 sequences - skipped" > ../../per_gene/EOG091G0D0W/infer_single_ML.stdout.txt
		touch raxml.skipped
	fi
        touch ../../per_gene/EOG091G0D0W/EOG091G0D0W.raxml.done
        [0m
[Mon Jul  6 00:29:15 2020]
Finished job 1332.
3174 of 3292 steps (96%) done

[Mon Jul  6 00:29:15 2020]
rule score_and_cut:
    input: per_gene/EOG091G06S3/EOG091G06S3.clustalo.fasta
    output: per_gene/EOG091G06S3/ALICUT_EOG091G06S3.clustalo.fasta
    jobid: 509
    wildcards: BUSCO=EOG091G06S3
    threads: 2


        cd per_gene/EOG091G06S3
        Aliscore.pl -N -r 200000000000000000 -i ../../per_gene/EOG091G06S3/EOG091G06S3.clustalo.fasta &> aliscore.log
        ALICUT.pl -s &> alicut.log
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/63c88c27a0fa300f57066b0ef65fefcb.simg
[Mon Jul  6 00:29:18 2020]
Finished job 3206.
3175 of 3292 steps (96%) done

[Mon Jul  6 00:29:18 2020]
rule get_outgroups:
    input: per_gene/EOG091G0ID9/EOG091G0ID9.ingroup.fasta
    output: per_gene/EOG091G0ID9/EOG091G0ID9.orthodb.fasta, per_gene/EOG091G0ID9/EOG091G0ID9.outgroup.fasta
    log: per_gene/EOG091G0ID9/get_outgroups.stdout.txt, per_gene/EOG091G0ID9/get_outgroups.stderr.txt
    jobid: 3207
    wildcards: BUSCO=EOG091G0ID9


        #download fastas from Orhtodb for BUSCO id
        for i in {1..5}
        do
             wget "http://www.orthodb.org/fasta?query=EOG091G0ID9&level=33208" -O per_gene/EOG091G0ID9/EOG091G0ID9.orthodb.fasta 1> per_gene/EOG091G0ID9/get_outgroups.stdout.txt 2> per_gene/EOG091G0ID9/get_outgroups.stderr.txt && break || echo -e "try again ($i)" && sleep 15
        done

	#This is quick an dirty for now and just takes the first protein if there is more than one for an outgroup taxon
        bash ../scripts/download_outgroups.sh taxids.txt per_gene/EOG091G0ID9/EOG091G0ID9.orthodb.fasta > per_gene/EOG091G0ID9/EOG091G0ID9.outgroup.fasta
        
[Mon Jul  6 00:29:18 2020]
Finished job 3207.
3176 of 3292 steps (96%) done

[Mon Jul  6 00:29:18 2020]
rule join_groups:
    input: per_gene/EOG091G0ID9/EOG091G0ID9.ingroup.fasta, per_gene/EOG091G0ID9/EOG091G0ID9.outgroup.fasta
    output: per_gene/EOG091G0ID9/EOG091G0ID9.fasta
    jobid: 2427
    wildcards: BUSCO=EOG091G0ID9


        cat per_gene/EOG091G0ID9/EOG091G0ID9.ingroup.fasta per_gene/EOG091G0ID9/EOG091G0ID9.outgroup.fasta > per_gene/EOG091G0ID9/EOG091G0ID9.fasta
        
[Mon Jul  6 00:29:18 2020]
Finished job 2427.
3177 of 3292 steps (97%) done

[Mon Jul  6 00:29:18 2020]
rule MSA:
    input: per_gene/EOG091G0ID9/EOG091G0ID9.fasta
    output: per_gene/EOG091G0ID9/EOG091G0ID9.clustalo.fasta
    log: per_gene/EOG091G0ID9/MSA.stdout.txt, per_gene/EOG091G0ID9/MSA.stderr.txt
    jobid: 1974
    wildcards: BUSCO=EOG091G0ID9
    threads: 2


        clustalo -i per_gene/EOG091G0ID9/EOG091G0ID9.fasta -o per_gene/EOG091G0ID9/EOG091G0ID9.clustalo.fasta --threads=2 1> per_gene/EOG091G0ID9/MSA.stdout.txt 2> per_gene/EOG091G0ID9/MSA.stderr.txt
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/d68c9691725a7401923680874285c430.simg
[Mon Jul  6 00:29:19 2020]
Finished job 1974.
3178 of 3292 steps (97%) done

[Mon Jul  6 00:29:19 2020]
rule score_and_cut:
    input: per_gene/EOG091G0ID9/EOG091G0ID9.clustalo.fasta
    output: per_gene/EOG091G0ID9/ALICUT_EOG091G0ID9.clustalo.fasta
    jobid: 1151
    wildcards: BUSCO=EOG091G0ID9
    threads: 2


        cd per_gene/EOG091G0ID9
        Aliscore.pl -N -r 200000000000000000 -i ../../per_gene/EOG091G0ID9/EOG091G0ID9.clustalo.fasta &> aliscore.log
        ALICUT.pl -s &> alicut.log
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/63c88c27a0fa300f57066b0ef65fefcb.simg
[Mon Jul  6 00:29:22 2020]
Finished job 2888.
3179 of 3292 steps (97%) done

[Mon Jul  6 00:29:22 2020]
rule get_outgroups:
    input: per_gene/EOG091G0WT4/EOG091G0WT4.ingroup.fasta
    output: per_gene/EOG091G0WT4/EOG091G0WT4.orthodb.fasta, per_gene/EOG091G0WT4/EOG091G0WT4.outgroup.fasta
    log: per_gene/EOG091G0WT4/get_outgroups.stdout.txt, per_gene/EOG091G0WT4/get_outgroups.stderr.txt
    jobid: 2889
    wildcards: BUSCO=EOG091G0WT4


        #download fastas from Orhtodb for BUSCO id
        for i in {1..5}
        do
             wget "http://www.orthodb.org/fasta?query=EOG091G0WT4&level=33208" -O per_gene/EOG091G0WT4/EOG091G0WT4.orthodb.fasta 1> per_gene/EOG091G0WT4/get_outgroups.stdout.txt 2> per_gene/EOG091G0WT4/get_outgroups.stderr.txt && break || echo -e "try again ($i)" && sleep 15
        done

	#This is quick an dirty for now and just takes the first protein if there is more than one for an outgroup taxon
        bash ../scripts/download_outgroups.sh taxids.txt per_gene/EOG091G0WT4/EOG091G0WT4.orthodb.fasta > per_gene/EOG091G0WT4/EOG091G0WT4.outgroup.fasta
        
[Mon Jul  6 00:29:23 2020]
Finished job 2889.
3180 of 3292 steps (97%) done

[Mon Jul  6 00:29:23 2020]
rule join_groups:
    input: per_gene/EOG091G0WT4/EOG091G0WT4.ingroup.fasta, per_gene/EOG091G0WT4/EOG091G0WT4.outgroup.fasta
    output: per_gene/EOG091G0WT4/EOG091G0WT4.fasta
    jobid: 2268
    wildcards: BUSCO=EOG091G0WT4


        cat per_gene/EOG091G0WT4/EOG091G0WT4.ingroup.fasta per_gene/EOG091G0WT4/EOG091G0WT4.outgroup.fasta > per_gene/EOG091G0WT4/EOG091G0WT4.fasta
        
[Mon Jul  6 00:29:23 2020]
Finished job 2268.
3181 of 3292 steps (97%) done

[Mon Jul  6 00:29:23 2020]
rule MSA:
    input: per_gene/EOG091G0WT4/EOG091G0WT4.fasta
    output: per_gene/EOG091G0WT4/EOG091G0WT4.clustalo.fasta
    log: per_gene/EOG091G0WT4/MSA.stdout.txt, per_gene/EOG091G0WT4/MSA.stderr.txt
    jobid: 1656
    wildcards: BUSCO=EOG091G0WT4
    threads: 2


        clustalo -i per_gene/EOG091G0WT4/EOG091G0WT4.fasta -o per_gene/EOG091G0WT4/EOG091G0WT4.clustalo.fasta --threads=2 1> per_gene/EOG091G0WT4/MSA.stdout.txt 2> per_gene/EOG091G0WT4/MSA.stderr.txt
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/d68c9691725a7401923680874285c430.simg
[Mon Jul  6 00:29:23 2020]
Finished job 1656.
3182 of 3292 steps (97%) done

[Mon Jul  6 00:29:23 2020]
rule score_and_cut:
    input: per_gene/EOG091G0WT4/EOG091G0WT4.clustalo.fasta
    output: per_gene/EOG091G0WT4/ALICUT_EOG091G0WT4.clustalo.fasta
    jobid: 833
    wildcards: BUSCO=EOG091G0WT4
    threads: 2


        cd per_gene/EOG091G0WT4
        Aliscore.pl -N -r 200000000000000000 -i ../../per_gene/EOG091G0WT4/EOG091G0WT4.clustalo.fasta &> aliscore.log
        ALICUT.pl -s &> alicut.log
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/63c88c27a0fa300f57066b0ef65fefcb.simg
[Mon Jul  6 00:29:25 2020]
Finished job 509.
3183 of 3292 steps (97%) done

[Mon Jul  6 00:29:25 2020]
rule remove_empty:
    input: per_gene/EOG091G06S3/ALICUT_EOG091G06S3.clustalo.fasta
    output: per_gene/EOG091G06S3/empty_check.done
    jobid: 1331
    wildcards: BUSCO=EOG091G06S3


         if [ "$(cat per_gene/EOG091G06S3/ALICUT_EOG091G06S3.clustalo.fasta | grep -v ">" | sed 's/-//g' | grep "^$" | wc -l)" -gt 0 ]
         then
              cp per_gene/EOG091G06S3/ALICUT_EOG091G06S3.clustalo.fasta per_gene/EOG091G06S3/ALICUT_EOG091G06S3.clustalo.fasta.backup
              bash ../scripts/remove_empty.sh per_gene/EOG091G06S3/ALICUT_EOG091G06S3.clustalo.fasta.backup > per_gene/EOG091G06S3/ALICUT_EOG091G06S3.clustalo.fasta
         fi
         touch per_gene/EOG091G06S3/empty_check.done
         
[Mon Jul  6 00:29:25 2020]
Finished job 1331.
3184 of 3292 steps (97%) done

[Mon Jul  6 00:29:25 2020]
rule find_best_model:
    input: per_gene/EOG091G06S3/ALICUT_EOG091G06S3.clustalo.fasta, per_gene/EOG091G06S3/empty_check.done
    output: per_gene/EOG091G06S3/EOG091G06S3.best_model
    log: per_gene/EOG091G06S3/find_best_model.stderr.txt
    jobid: 508
    wildcards: BUSCO=EOG091G06S3
    threads: 2


        cd per_gene/EOG091G06S3
        if [ ! -d find_best_model ]
        then
            mkdir find_best_model
        fi
        cd find_best_model
        ln -s ../../../per_gene/EOG091G06S3/ALICUT_EOG091G06S3.clustalo.fasta EOG091G06S3.fasta
        ProteinModelSelection.pl EOG091G06S3.fasta 1> ../../../per_gene/EOG091G06S3/EOG091G06S3.best_model 2> ../../../per_gene/EOG091G06S3/find_best_model.stderr.txt
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/c0c09ee657b1e27f2c5687e0e9aa8d70.simg
[Mon Jul  6 00:29:30 2020]
Finished job 1151.
3185 of 3292 steps (97%) done

[Mon Jul  6 00:29:30 2020]
rule remove_empty:
    input: per_gene/EOG091G0ID9/ALICUT_EOG091G0ID9.clustalo.fasta
    output: per_gene/EOG091G0ID9/empty_check.done
    jobid: 1973
    wildcards: BUSCO=EOG091G0ID9


         if [ "$(cat per_gene/EOG091G0ID9/ALICUT_EOG091G0ID9.clustalo.fasta | grep -v ">" | sed 's/-//g' | grep "^$" | wc -l)" -gt 0 ]
         then
              cp per_gene/EOG091G0ID9/ALICUT_EOG091G0ID9.clustalo.fasta per_gene/EOG091G0ID9/ALICUT_EOG091G0ID9.clustalo.fasta.backup
              bash ../scripts/remove_empty.sh per_gene/EOG091G0ID9/ALICUT_EOG091G0ID9.clustalo.fasta.backup > per_gene/EOG091G0ID9/ALICUT_EOG091G0ID9.clustalo.fasta
         fi
         touch per_gene/EOG091G0ID9/empty_check.done
         
[Mon Jul  6 00:29:30 2020]
Finished job 1973.
3186 of 3292 steps (97%) done

[Mon Jul  6 00:29:30 2020]
rule find_best_model:
    input: per_gene/EOG091G0ID9/ALICUT_EOG091G0ID9.clustalo.fasta, per_gene/EOG091G0ID9/empty_check.done
    output: per_gene/EOG091G0ID9/EOG091G0ID9.best_model
    log: per_gene/EOG091G0ID9/find_best_model.stderr.txt
    jobid: 1150
    wildcards: BUSCO=EOG091G0ID9
    threads: 2


        cd per_gene/EOG091G0ID9
        if [ ! -d find_best_model ]
        then
            mkdir find_best_model
        fi
        cd find_best_model
        ln -s ../../../per_gene/EOG091G0ID9/ALICUT_EOG091G0ID9.clustalo.fasta EOG091G0ID9.fasta
        ProteinModelSelection.pl EOG091G0ID9.fasta 1> ../../../per_gene/EOG091G0ID9/EOG091G0ID9.best_model 2> ../../../per_gene/EOG091G0ID9/find_best_model.stderr.txt
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/c0c09ee657b1e27f2c5687e0e9aa8d70.simg
[Mon Jul  6 00:29:32 2020]
Finished job 833.
3187 of 3292 steps (97%) done

[Mon Jul  6 00:29:32 2020]
rule remove_empty:
    input: per_gene/EOG091G0WT4/ALICUT_EOG091G0WT4.clustalo.fasta
    output: per_gene/EOG091G0WT4/empty_check.done
    jobid: 1655
    wildcards: BUSCO=EOG091G0WT4


         if [ "$(cat per_gene/EOG091G0WT4/ALICUT_EOG091G0WT4.clustalo.fasta | grep -v ">" | sed 's/-//g' | grep "^$" | wc -l)" -gt 0 ]
         then
              cp per_gene/EOG091G0WT4/ALICUT_EOG091G0WT4.clustalo.fasta per_gene/EOG091G0WT4/ALICUT_EOG091G0WT4.clustalo.fasta.backup
              bash ../scripts/remove_empty.sh per_gene/EOG091G0WT4/ALICUT_EOG091G0WT4.clustalo.fasta.backup > per_gene/EOG091G0WT4/ALICUT_EOG091G0WT4.clustalo.fasta
         fi
         touch per_gene/EOG091G0WT4/empty_check.done
         
[Mon Jul  6 00:29:32 2020]
Finished job 1655.
3188 of 3292 steps (97%) done

[Mon Jul  6 00:29:32 2020]
rule find_best_model:
    input: per_gene/EOG091G0WT4/ALICUT_EOG091G0WT4.clustalo.fasta, per_gene/EOG091G0WT4/empty_check.done
    output: per_gene/EOG091G0WT4/EOG091G0WT4.best_model
    log: per_gene/EOG091G0WT4/find_best_model.stderr.txt
    jobid: 832
    wildcards: BUSCO=EOG091G0WT4
    threads: 2


        cd per_gene/EOG091G0WT4
        if [ ! -d find_best_model ]
        then
            mkdir find_best_model
        fi
        cd find_best_model
        ln -s ../../../per_gene/EOG091G0WT4/ALICUT_EOG091G0WT4.clustalo.fasta EOG091G0WT4.fasta
        ProteinModelSelection.pl EOG091G0WT4.fasta 1> ../../../per_gene/EOG091G0WT4/EOG091G0WT4.best_model 2> ../../../per_gene/EOG091G0WT4/find_best_model.stderr.txt
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/c0c09ee657b1e27f2c5687e0e9aa8d70.simg
[Mon Jul  6 00:29:37 2020]
Finished job 1032.
3189 of 3292 steps (97%) done

[Mon Jul  6 00:29:37 2020]
rule infer_single_ML:
    input: per_gene/EOG091G0CW2/EOG091G0CW2.best_model, per_gene/EOG091G0CW2/ALICUT_EOG091G0CW2.clustalo.fasta
    output: per_gene/EOG091G0CW2/EOG091G0CW2.raxml.done
    log: per_gene/EOG091G0CW2/infer_single_ML.stdout.txt, per_gene/EOG091G0CW2/infer_single_ML.stderr.txt
    jobid: 310
    wildcards: BUSCO=EOG091G0CW2
    threads: 2


        cd per_gene/EOG091G0CW2
	count=$(cat ../../per_gene/EOG091G0CW2/ALICUT_EOG091G0CW2.clustalo.fasta | grep ">" | wc -l)
	if [ "$count" -gt 5 ]
        then
		RAxMLmodel=$(cat ../../per_gene/EOG091G0CW2/EOG091G0CW2.best_model | grep "Best" | cut -d ":" -f 2 | tr -d '[:space:]')
                if [ "$(ls -1 | grep "^RAxML" | wc -l)" -ne 0 ]
		then
			rm RAxML*
		fi
        	raxml -f a -T 2 -m PROTGAMMA$RAxMLmodel         	-p 12345 -x 12345 -# 100         	-s ../../per_gene/EOG091G0CW2/ALICUT_EOG091G0CW2.clustalo.fasta -n EOG091G0CW2.clustalo.aln.ALICUT.$RAxMLmodel 		1> ../../per_gene/EOG091G0CW2/infer_single_ML.stdout.txt 2> ../../per_gene/EOG091G0CW2/infer_single_ML.stderr.txt
	else
		echo "fasta file per_gene/EOG091G0CW2/ALICUT_EOG091G0CW2.clustalo.fasta contains fewer than 5 sequences - skipped" > ../../per_gene/EOG091G0CW2/infer_single_ML.stdout.txt
		touch raxml.skipped
	fi
        touch ../../per_gene/EOG091G0CW2/EOG091G0CW2.raxml.done
        
[33mJob counts:
	count	jobs
	1	infer_single_ML
	1[0m
[33m
        cd per_gene/EOG091G0CW2
	count=$(cat ../../per_gene/EOG091G0CW2/ALICUT_EOG091G0CW2.clustalo.fasta | grep ">" | wc -l)
	if [ "$count" -gt 5 ]
        then
		RAxMLmodel=$(cat ../../per_gene/EOG091G0CW2/EOG091G0CW2.best_model | grep "Best" | cut -d ":" -f 2 | tr -d '[:space:]')
                if [ "$(ls -1 | grep "^RAxML" | wc -l)" -ne 0 ]
		then
			rm RAxML*
		fi
        	raxml -f a -T 2 -m PROTGAMMA$RAxMLmodel         	-p 12345 -x 12345 -# 100         	-s ../../per_gene/EOG091G0CW2/ALICUT_EOG091G0CW2.clustalo.fasta -n EOG091G0CW2.clustalo.aln.ALICUT.$RAxMLmodel 		1> ../../per_gene/EOG091G0CW2/infer_single_ML.stdout.txt 2> ../../per_gene/EOG091G0CW2/infer_single_ML.stderr.txt
	else
		echo "fasta file per_gene/EOG091G0CW2/ALICUT_EOG091G0CW2.clustalo.fasta contains fewer than 5 sequences - skipped" > ../../per_gene/EOG091G0CW2/infer_single_ML.stdout.txt
		touch raxml.skipped
	fi
        touch ../../per_gene/EOG091G0CW2/EOG091G0CW2.raxml.done
        [0m
[Mon Jul  6 00:29:52 2020]
Finished job 34.
3190 of 3292 steps (97%) done

[Mon Jul  6 00:29:52 2020]
rule get_seqs:
    input: /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ingroup.txt, /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/outgroup.txt
    output: per_gene/EOG091G0EA2/EOG091G0EA2.ingroup.fasta
    log: per_gene/EOG091G0EA2/get_seqs.stdout.txt, per_gene/EOG091G0EA2/get_seqs.stderr.txt
    jobid: 3190
    wildcards: BUSCO=EOG091G0EA2
    threads: 2


	basedir=$(pwd)
        cd per_gene/EOG091G0EA2
        
        bash $basedir/../scripts/fetch_seqs.sh EOG091G0EA2 /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ingroup.txt /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/outgroup.txt 1> ../../per_gene/EOG091G0EA2/get_seqs.stdout.txt 2> ../../per_gene/EOG091G0EA2/get_seqs.stderr.txt
	mv EOG091G0EA2.fasta $basedir/per_gene/EOG091G0EA2/EOG091G0EA2.ingroup.fasta
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/72476f9d9a5bd0627b4d721143a21354.simg
[Mon Jul  6 00:29:57 2020]
Finished job 57.
3191 of 3292 steps (97%) done

[Mon Jul  6 00:29:57 2020]
rule get_seqs:
    input: /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ingroup.txt, /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/outgroup.txt
    output: per_gene/EOG091G0K1Z/EOG091G0K1Z.ingroup.fasta
    log: per_gene/EOG091G0K1Z/get_seqs.stdout.txt, per_gene/EOG091G0K1Z/get_seqs.stderr.txt
    jobid: 3218
    wildcards: BUSCO=EOG091G0K1Z
    threads: 2


	basedir=$(pwd)
        cd per_gene/EOG091G0K1Z
        
        bash $basedir/../scripts/fetch_seqs.sh EOG091G0K1Z /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ingroup.txt /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/outgroup.txt 1> ../../per_gene/EOG091G0K1Z/get_seqs.stdout.txt 2> ../../per_gene/EOG091G0K1Z/get_seqs.stderr.txt
	mv EOG091G0K1Z.fasta $basedir/per_gene/EOG091G0K1Z/EOG091G0K1Z.ingroup.fasta
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/72476f9d9a5bd0627b4d721143a21354.simg
[Mon Jul  6 00:29:57 2020]
Finished job 832.
3192 of 3292 steps (97%) done

[Mon Jul  6 00:29:57 2020]
rule infer_single_ML:
    input: per_gene/EOG091G0WT4/EOG091G0WT4.best_model, per_gene/EOG091G0WT4/ALICUT_EOG091G0WT4.clustalo.fasta
    output: per_gene/EOG091G0WT4/EOG091G0WT4.raxml.done
    log: per_gene/EOG091G0WT4/infer_single_ML.stdout.txt, per_gene/EOG091G0WT4/infer_single_ML.stderr.txt
    jobid: 210
    wildcards: BUSCO=EOG091G0WT4
    threads: 2


        cd per_gene/EOG091G0WT4
	count=$(cat ../../per_gene/EOG091G0WT4/ALICUT_EOG091G0WT4.clustalo.fasta | grep ">" | wc -l)
	if [ "$count" -gt 5 ]
        then
		RAxMLmodel=$(cat ../../per_gene/EOG091G0WT4/EOG091G0WT4.best_model | grep "Best" | cut -d ":" -f 2 | tr -d '[:space:]')
                if [ "$(ls -1 | grep "^RAxML" | wc -l)" -ne 0 ]
		then
			rm RAxML*
		fi
        	raxml -f a -T 2 -m PROTGAMMA$RAxMLmodel         	-p 12345 -x 12345 -# 100         	-s ../../per_gene/EOG091G0WT4/ALICUT_EOG091G0WT4.clustalo.fasta -n EOG091G0WT4.clustalo.aln.ALICUT.$RAxMLmodel 		1> ../../per_gene/EOG091G0WT4/infer_single_ML.stdout.txt 2> ../../per_gene/EOG091G0WT4/infer_single_ML.stderr.txt
	else
		echo "fasta file per_gene/EOG091G0WT4/ALICUT_EOG091G0WT4.clustalo.fasta contains fewer than 5 sequences - skipped" > ../../per_gene/EOG091G0WT4/infer_single_ML.stdout.txt
		touch raxml.skipped
	fi
        touch ../../per_gene/EOG091G0WT4/EOG091G0WT4.raxml.done
        
[33mJob counts:
	count	jobs
	1	infer_single_ML
	1[0m
[33m
        cd per_gene/EOG091G0WT4
	count=$(cat ../../per_gene/EOG091G0WT4/ALICUT_EOG091G0WT4.clustalo.fasta | grep ">" | wc -l)
	if [ "$count" -gt 5 ]
        then
		RAxMLmodel=$(cat ../../per_gene/EOG091G0WT4/EOG091G0WT4.best_model | grep "Best" | cut -d ":" -f 2 | tr -d '[:space:]')
                if [ "$(ls -1 | grep "^RAxML" | wc -l)" -ne 0 ]
		then
			rm RAxML*
		fi
        	raxml -f a -T 2 -m PROTGAMMA$RAxMLmodel         	-p 12345 -x 12345 -# 100         	-s ../../per_gene/EOG091G0WT4/ALICUT_EOG091G0WT4.clustalo.fasta -n EOG091G0WT4.clustalo.aln.ALICUT.$RAxMLmodel 		1> ../../per_gene/EOG091G0WT4/infer_single_ML.stdout.txt 2> ../../per_gene/EOG091G0WT4/infer_single_ML.stderr.txt
	else
		echo "fasta file per_gene/EOG091G0WT4/ALICUT_EOG091G0WT4.clustalo.fasta contains fewer than 5 sequences - skipped" > ../../per_gene/EOG091G0WT4/infer_single_ML.stdout.txt
		touch raxml.skipped
	fi
        touch ../../per_gene/EOG091G0WT4/EOG091G0WT4.raxml.done
        [0m
[Mon Jul  6 00:30:01 2020]
Finished job 1150.
3193 of 3292 steps (97%) done

[Mon Jul  6 00:30:01 2020]
rule infer_single_ML:
    input: per_gene/EOG091G0ID9/EOG091G0ID9.best_model, per_gene/EOG091G0ID9/ALICUT_EOG091G0ID9.clustalo.fasta
    output: per_gene/EOG091G0ID9/EOG091G0ID9.raxml.done
    log: per_gene/EOG091G0ID9/infer_single_ML.stdout.txt, per_gene/EOG091G0ID9/infer_single_ML.stderr.txt
    jobid: 369
    wildcards: BUSCO=EOG091G0ID9
    threads: 2


        cd per_gene/EOG091G0ID9
	count=$(cat ../../per_gene/EOG091G0ID9/ALICUT_EOG091G0ID9.clustalo.fasta | grep ">" | wc -l)
	if [ "$count" -gt 5 ]
        then
		RAxMLmodel=$(cat ../../per_gene/EOG091G0ID9/EOG091G0ID9.best_model | grep "Best" | cut -d ":" -f 2 | tr -d '[:space:]')
                if [ "$(ls -1 | grep "^RAxML" | wc -l)" -ne 0 ]
		then
			rm RAxML*
		fi
        	raxml -f a -T 2 -m PROTGAMMA$RAxMLmodel         	-p 12345 -x 12345 -# 100         	-s ../../per_gene/EOG091G0ID9/ALICUT_EOG091G0ID9.clustalo.fasta -n EOG091G0ID9.clustalo.aln.ALICUT.$RAxMLmodel 		1> ../../per_gene/EOG091G0ID9/infer_single_ML.stdout.txt 2> ../../per_gene/EOG091G0ID9/infer_single_ML.stderr.txt
	else
		echo "fasta file per_gene/EOG091G0ID9/ALICUT_EOG091G0ID9.clustalo.fasta contains fewer than 5 sequences - skipped" > ../../per_gene/EOG091G0ID9/infer_single_ML.stdout.txt
		touch raxml.skipped
	fi
        touch ../../per_gene/EOG091G0ID9/EOG091G0ID9.raxml.done
        
[Mon Jul  6 00:30:01 2020]
Finished job 80.
3194 of 3292 steps (97%) done

[Mon Jul  6 00:30:01 2020]
rule get_seqs:
    input: /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ingroup.txt, /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/outgroup.txt
    output: per_gene/EOG091G06Y3/EOG091G06Y3.ingroup.fasta
    log: per_gene/EOG091G06Y3/get_seqs.stdout.txt, per_gene/EOG091G06Y3/get_seqs.stderr.txt
    jobid: 3150
    wildcards: BUSCO=EOG091G06Y3
    threads: 2


	basedir=$(pwd)
        cd per_gene/EOG091G06Y3
        
        bash $basedir/../scripts/fetch_seqs.sh EOG091G06Y3 /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ingroup.txt /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/outgroup.txt 1> ../../per_gene/EOG091G06Y3/get_seqs.stdout.txt 2> ../../per_gene/EOG091G06Y3/get_seqs.stderr.txt
	mv EOG091G06Y3.fasta $basedir/per_gene/EOG091G06Y3/EOG091G06Y3.ingroup.fasta
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/72476f9d9a5bd0627b4d721143a21354.simg
[Mon Jul  6 00:30:01 2020]
Finished job 287.
3195 of 3292 steps (97%) done

[Mon Jul  6 00:30:01 2020]
rule get_seqs:
    input: /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ingroup.txt, /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/outgroup.txt
    output: per_gene/EOG091G0QKK/EOG091G0QKK.ingroup.fasta
    log: per_gene/EOG091G0QKK/get_seqs.stdout.txt, per_gene/EOG091G0QKK/get_seqs.stderr.txt
    jobid: 2816
    wildcards: BUSCO=EOG091G0QKK
    threads: 2


	basedir=$(pwd)
        cd per_gene/EOG091G0QKK
        
        bash $basedir/../scripts/fetch_seqs.sh EOG091G0QKK /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ingroup.txt /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/outgroup.txt 1> ../../per_gene/EOG091G0QKK/get_seqs.stdout.txt 2> ../../per_gene/EOG091G0QKK/get_seqs.stderr.txt
	mv EOG091G0QKK.fasta $basedir/per_gene/EOG091G0QKK/EOG091G0QKK.ingroup.fasta
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/72476f9d9a5bd0627b4d721143a21354.simg
[33mJob counts:
	count	jobs
	1	infer_single_ML
	1[0m
[33m
        cd per_gene/EOG091G0ID9
	count=$(cat ../../per_gene/EOG091G0ID9/ALICUT_EOG091G0ID9.clustalo.fasta | grep ">" | wc -l)
	if [ "$count" -gt 5 ]
        then
		RAxMLmodel=$(cat ../../per_gene/EOG091G0ID9/EOG091G0ID9.best_model | grep "Best" | cut -d ":" -f 2 | tr -d '[:space:]')
                if [ "$(ls -1 | grep "^RAxML" | wc -l)" -ne 0 ]
		then
			rm RAxML*
		fi
        	raxml -f a -T 2 -m PROTGAMMA$RAxMLmodel         	-p 12345 -x 12345 -# 100         	-s ../../per_gene/EOG091G0ID9/ALICUT_EOG091G0ID9.clustalo.fasta -n EOG091G0ID9.clustalo.aln.ALICUT.$RAxMLmodel 		1> ../../per_gene/EOG091G0ID9/infer_single_ML.stdout.txt 2> ../../per_gene/EOG091G0ID9/infer_single_ML.stderr.txt
	else
		echo "fasta file per_gene/EOG091G0ID9/ALICUT_EOG091G0ID9.clustalo.fasta contains fewer than 5 sequences - skipped" > ../../per_gene/EOG091G0ID9/infer_single_ML.stdout.txt
		touch raxml.skipped
	fi
        touch ../../per_gene/EOG091G0ID9/EOG091G0ID9.raxml.done
        [0m
[Mon Jul  6 00:30:09 2020]
Finished job 3190.
3196 of 3292 steps (97%) done

[Mon Jul  6 00:30:09 2020]
rule get_outgroups:
    input: per_gene/EOG091G0EA2/EOG091G0EA2.ingroup.fasta
    output: per_gene/EOG091G0EA2/EOG091G0EA2.orthodb.fasta, per_gene/EOG091G0EA2/EOG091G0EA2.outgroup.fasta
    log: per_gene/EOG091G0EA2/get_outgroups.stdout.txt, per_gene/EOG091G0EA2/get_outgroups.stderr.txt
    jobid: 3191
    wildcards: BUSCO=EOG091G0EA2


        #download fastas from Orhtodb for BUSCO id
        for i in {1..5}
        do
             wget "http://www.orthodb.org/fasta?query=EOG091G0EA2&level=33208" -O per_gene/EOG091G0EA2/EOG091G0EA2.orthodb.fasta 1> per_gene/EOG091G0EA2/get_outgroups.stdout.txt 2> per_gene/EOG091G0EA2/get_outgroups.stderr.txt && break || echo -e "try again ($i)" && sleep 15
        done

	#This is quick an dirty for now and just takes the first protein if there is more than one for an outgroup taxon
        bash ../scripts/download_outgroups.sh taxids.txt per_gene/EOG091G0EA2/EOG091G0EA2.orthodb.fasta > per_gene/EOG091G0EA2/EOG091G0EA2.outgroup.fasta
        
[Mon Jul  6 00:30:10 2020]
Finished job 3191.
3197 of 3292 steps (97%) done

[Mon Jul  6 00:30:10 2020]
rule join_groups:
    input: per_gene/EOG091G0EA2/EOG091G0EA2.ingroup.fasta, per_gene/EOG091G0EA2/EOG091G0EA2.outgroup.fasta
    output: per_gene/EOG091G0EA2/EOG091G0EA2.fasta
    jobid: 2419
    wildcards: BUSCO=EOG091G0EA2


        cat per_gene/EOG091G0EA2/EOG091G0EA2.ingroup.fasta per_gene/EOG091G0EA2/EOG091G0EA2.outgroup.fasta > per_gene/EOG091G0EA2/EOG091G0EA2.fasta
        
[Mon Jul  6 00:30:10 2020]
Finished job 2419.
3198 of 3292 steps (97%) done

[Mon Jul  6 00:30:10 2020]
rule MSA:
    input: per_gene/EOG091G0EA2/EOG091G0EA2.fasta
    output: per_gene/EOG091G0EA2/EOG091G0EA2.clustalo.fasta
    log: per_gene/EOG091G0EA2/MSA.stdout.txt, per_gene/EOG091G0EA2/MSA.stderr.txt
    jobid: 1958
    wildcards: BUSCO=EOG091G0EA2
    threads: 2


        clustalo -i per_gene/EOG091G0EA2/EOG091G0EA2.fasta -o per_gene/EOG091G0EA2/EOG091G0EA2.clustalo.fasta --threads=2 1> per_gene/EOG091G0EA2/MSA.stdout.txt 2> per_gene/EOG091G0EA2/MSA.stderr.txt
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/d68c9691725a7401923680874285c430.simg
[Mon Jul  6 00:30:11 2020]
Finished job 1958.
3199 of 3292 steps (97%) done

[Mon Jul  6 00:30:11 2020]
rule score_and_cut:
    input: per_gene/EOG091G0EA2/EOG091G0EA2.clustalo.fasta
    output: per_gene/EOG091G0EA2/ALICUT_EOG091G0EA2.clustalo.fasta
    jobid: 1135
    wildcards: BUSCO=EOG091G0EA2
    threads: 2


        cd per_gene/EOG091G0EA2
        Aliscore.pl -N -r 200000000000000000 -i ../../per_gene/EOG091G0EA2/EOG091G0EA2.clustalo.fasta &> aliscore.log
        ALICUT.pl -s &> alicut.log
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/63c88c27a0fa300f57066b0ef65fefcb.simg
[Mon Jul  6 00:30:13 2020]
Finished job 3218.
3200 of 3292 steps (97%) done

[Mon Jul  6 00:30:13 2020]
rule get_outgroups:
    input: per_gene/EOG091G0K1Z/EOG091G0K1Z.ingroup.fasta
    output: per_gene/EOG091G0K1Z/EOG091G0K1Z.orthodb.fasta, per_gene/EOG091G0K1Z/EOG091G0K1Z.outgroup.fasta
    log: per_gene/EOG091G0K1Z/get_outgroups.stdout.txt, per_gene/EOG091G0K1Z/get_outgroups.stderr.txt
    jobid: 3219
    wildcards: BUSCO=EOG091G0K1Z


        #download fastas from Orhtodb for BUSCO id
        for i in {1..5}
        do
             wget "http://www.orthodb.org/fasta?query=EOG091G0K1Z&level=33208" -O per_gene/EOG091G0K1Z/EOG091G0K1Z.orthodb.fasta 1> per_gene/EOG091G0K1Z/get_outgroups.stdout.txt 2> per_gene/EOG091G0K1Z/get_outgroups.stderr.txt && break || echo -e "try again ($i)" && sleep 15
        done

	#This is quick an dirty for now and just takes the first protein if there is more than one for an outgroup taxon
        bash ../scripts/download_outgroups.sh taxids.txt per_gene/EOG091G0K1Z/EOG091G0K1Z.orthodb.fasta > per_gene/EOG091G0K1Z/EOG091G0K1Z.outgroup.fasta
        
[Mon Jul  6 00:30:14 2020]
Finished job 3219.
3201 of 3292 steps (97%) done

[Mon Jul  6 00:30:14 2020]
rule join_groups:
    input: per_gene/EOG091G0K1Z/EOG091G0K1Z.ingroup.fasta, per_gene/EOG091G0K1Z/EOG091G0K1Z.outgroup.fasta
    output: per_gene/EOG091G0K1Z/EOG091G0K1Z.fasta
    jobid: 2433
    wildcards: BUSCO=EOG091G0K1Z


        cat per_gene/EOG091G0K1Z/EOG091G0K1Z.ingroup.fasta per_gene/EOG091G0K1Z/EOG091G0K1Z.outgroup.fasta > per_gene/EOG091G0K1Z/EOG091G0K1Z.fasta
        
[Mon Jul  6 00:30:14 2020]
Finished job 2433.
3202 of 3292 steps (97%) done

[Mon Jul  6 00:30:14 2020]
rule MSA:
    input: per_gene/EOG091G0K1Z/EOG091G0K1Z.fasta
    output: per_gene/EOG091G0K1Z/EOG091G0K1Z.clustalo.fasta
    log: per_gene/EOG091G0K1Z/MSA.stdout.txt, per_gene/EOG091G0K1Z/MSA.stderr.txt
    jobid: 1986
    wildcards: BUSCO=EOG091G0K1Z
    threads: 2


        clustalo -i per_gene/EOG091G0K1Z/EOG091G0K1Z.fasta -o per_gene/EOG091G0K1Z/EOG091G0K1Z.clustalo.fasta --threads=2 1> per_gene/EOG091G0K1Z/MSA.stdout.txt 2> per_gene/EOG091G0K1Z/MSA.stderr.txt
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/d68c9691725a7401923680874285c430.simg
[Mon Jul  6 00:30:16 2020]
Finished job 1986.
3203 of 3292 steps (97%) done

[Mon Jul  6 00:30:16 2020]
rule score_and_cut:
    input: per_gene/EOG091G0K1Z/EOG091G0K1Z.clustalo.fasta
    output: per_gene/EOG091G0K1Z/ALICUT_EOG091G0K1Z.clustalo.fasta
    jobid: 1163
    wildcards: BUSCO=EOG091G0K1Z
    threads: 2


        cd per_gene/EOG091G0K1Z
        Aliscore.pl -N -r 200000000000000000 -i ../../per_gene/EOG091G0K1Z/EOG091G0K1Z.clustalo.fasta &> aliscore.log
        ALICUT.pl -s &> alicut.log
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/63c88c27a0fa300f57066b0ef65fefcb.simg
[Mon Jul  6 00:30:16 2020]
Finished job 508.
3204 of 3292 steps (97%) done

[Mon Jul  6 00:30:16 2020]
rule infer_single_ML:
    input: per_gene/EOG091G06S3/EOG091G06S3.best_model, per_gene/EOG091G06S3/ALICUT_EOG091G06S3.clustalo.fasta
    output: per_gene/EOG091G06S3/EOG091G06S3.raxml.done
    log: per_gene/EOG091G06S3/infer_single_ML.stdout.txt, per_gene/EOG091G06S3/infer_single_ML.stderr.txt
    jobid: 48
    wildcards: BUSCO=EOG091G06S3
    threads: 2


        cd per_gene/EOG091G06S3
	count=$(cat ../../per_gene/EOG091G06S3/ALICUT_EOG091G06S3.clustalo.fasta | grep ">" | wc -l)
	if [ "$count" -gt 5 ]
        then
		RAxMLmodel=$(cat ../../per_gene/EOG091G06S3/EOG091G06S3.best_model | grep "Best" | cut -d ":" -f 2 | tr -d '[:space:]')
                if [ "$(ls -1 | grep "^RAxML" | wc -l)" -ne 0 ]
		then
			rm RAxML*
		fi
        	raxml -f a -T 2 -m PROTGAMMA$RAxMLmodel         	-p 12345 -x 12345 -# 100         	-s ../../per_gene/EOG091G06S3/ALICUT_EOG091G06S3.clustalo.fasta -n EOG091G06S3.clustalo.aln.ALICUT.$RAxMLmodel 		1> ../../per_gene/EOG091G06S3/infer_single_ML.stdout.txt 2> ../../per_gene/EOG091G06S3/infer_single_ML.stderr.txt
	else
		echo "fasta file per_gene/EOG091G06S3/ALICUT_EOG091G06S3.clustalo.fasta contains fewer than 5 sequences - skipped" > ../../per_gene/EOG091G06S3/infer_single_ML.stdout.txt
		touch raxml.skipped
	fi
        touch ../../per_gene/EOG091G06S3/EOG091G06S3.raxml.done
        
[33mJob counts:
	count	jobs
	1	infer_single_ML
	1[0m
[33m
        cd per_gene/EOG091G06S3
	count=$(cat ../../per_gene/EOG091G06S3/ALICUT_EOG091G06S3.clustalo.fasta | grep ">" | wc -l)
	if [ "$count" -gt 5 ]
        then
		RAxMLmodel=$(cat ../../per_gene/EOG091G06S3/EOG091G06S3.best_model | grep "Best" | cut -d ":" -f 2 | tr -d '[:space:]')
                if [ "$(ls -1 | grep "^RAxML" | wc -l)" -ne 0 ]
		then
			rm RAxML*
		fi
        	raxml -f a -T 2 -m PROTGAMMA$RAxMLmodel         	-p 12345 -x 12345 -# 100         	-s ../../per_gene/EOG091G06S3/ALICUT_EOG091G06S3.clustalo.fasta -n EOG091G06S3.clustalo.aln.ALICUT.$RAxMLmodel 		1> ../../per_gene/EOG091G06S3/infer_single_ML.stdout.txt 2> ../../per_gene/EOG091G06S3/infer_single_ML.stderr.txt
	else
		echo "fasta file per_gene/EOG091G06S3/ALICUT_EOG091G06S3.clustalo.fasta contains fewer than 5 sequences - skipped" > ../../per_gene/EOG091G06S3/infer_single_ML.stdout.txt
		touch raxml.skipped
	fi
        touch ../../per_gene/EOG091G06S3/EOG091G06S3.raxml.done
        [0m
[Mon Jul  6 00:30:20 2020]
Finished job 3150.
3205 of 3292 steps (97%) done

[Mon Jul  6 00:30:20 2020]
rule get_outgroups:
    input: per_gene/EOG091G06Y3/EOG091G06Y3.ingroup.fasta
    output: per_gene/EOG091G06Y3/EOG091G06Y3.orthodb.fasta, per_gene/EOG091G06Y3/EOG091G06Y3.outgroup.fasta
    log: per_gene/EOG091G06Y3/get_outgroups.stdout.txt, per_gene/EOG091G06Y3/get_outgroups.stderr.txt
    jobid: 3151
    wildcards: BUSCO=EOG091G06Y3


        #download fastas from Orhtodb for BUSCO id
        for i in {1..5}
        do
             wget "http://www.orthodb.org/fasta?query=EOG091G06Y3&level=33208" -O per_gene/EOG091G06Y3/EOG091G06Y3.orthodb.fasta 1> per_gene/EOG091G06Y3/get_outgroups.stdout.txt 2> per_gene/EOG091G06Y3/get_outgroups.stderr.txt && break || echo -e "try again ($i)" && sleep 15
        done

	#This is quick an dirty for now and just takes the first protein if there is more than one for an outgroup taxon
        bash ../scripts/download_outgroups.sh taxids.txt per_gene/EOG091G06Y3/EOG091G06Y3.orthodb.fasta > per_gene/EOG091G06Y3/EOG091G06Y3.outgroup.fasta
        
[Mon Jul  6 00:30:21 2020]
Finished job 3151.
3206 of 3292 steps (97%) done

[Mon Jul  6 00:30:21 2020]
rule join_groups:
    input: per_gene/EOG091G06Y3/EOG091G06Y3.ingroup.fasta, per_gene/EOG091G06Y3/EOG091G06Y3.outgroup.fasta
    output: per_gene/EOG091G06Y3/EOG091G06Y3.fasta
    jobid: 2399
    wildcards: BUSCO=EOG091G06Y3


        cat per_gene/EOG091G06Y3/EOG091G06Y3.ingroup.fasta per_gene/EOG091G06Y3/EOG091G06Y3.outgroup.fasta > per_gene/EOG091G06Y3/EOG091G06Y3.fasta
        
[Mon Jul  6 00:30:21 2020]
Finished job 2399.
3207 of 3292 steps (97%) done

[Mon Jul  6 00:30:21 2020]
rule MSA:
    input: per_gene/EOG091G06Y3/EOG091G06Y3.fasta
    output: per_gene/EOG091G06Y3/EOG091G06Y3.clustalo.fasta
    log: per_gene/EOG091G06Y3/MSA.stdout.txt, per_gene/EOG091G06Y3/MSA.stderr.txt
    jobid: 1918
    wildcards: BUSCO=EOG091G06Y3
    threads: 2


        clustalo -i per_gene/EOG091G06Y3/EOG091G06Y3.fasta -o per_gene/EOG091G06Y3/EOG091G06Y3.clustalo.fasta --threads=2 1> per_gene/EOG091G06Y3/MSA.stdout.txt 2> per_gene/EOG091G06Y3/MSA.stderr.txt
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/d68c9691725a7401923680874285c430.simg
[Mon Jul  6 00:30:22 2020]
Finished job 1135.
3208 of 3292 steps (97%) done

[Mon Jul  6 00:30:22 2020]
rule remove_empty:
    input: per_gene/EOG091G0EA2/ALICUT_EOG091G0EA2.clustalo.fasta
    output: per_gene/EOG091G0EA2/empty_check.done
    jobid: 1957
    wildcards: BUSCO=EOG091G0EA2


         if [ "$(cat per_gene/EOG091G0EA2/ALICUT_EOG091G0EA2.clustalo.fasta | grep -v ">" | sed 's/-//g' | grep "^$" | wc -l)" -gt 0 ]
         then
              cp per_gene/EOG091G0EA2/ALICUT_EOG091G0EA2.clustalo.fasta per_gene/EOG091G0EA2/ALICUT_EOG091G0EA2.clustalo.fasta.backup
              bash ../scripts/remove_empty.sh per_gene/EOG091G0EA2/ALICUT_EOG091G0EA2.clustalo.fasta.backup > per_gene/EOG091G0EA2/ALICUT_EOG091G0EA2.clustalo.fasta
         fi
         touch per_gene/EOG091G0EA2/empty_check.done
         
[Mon Jul  6 00:30:22 2020]
Finished job 1957.
3209 of 3292 steps (97%) done

[Mon Jul  6 00:30:22 2020]
rule find_best_model:
    input: per_gene/EOG091G0EA2/ALICUT_EOG091G0EA2.clustalo.fasta, per_gene/EOG091G0EA2/empty_check.done
    output: per_gene/EOG091G0EA2/EOG091G0EA2.best_model
    log: per_gene/EOG091G0EA2/find_best_model.stderr.txt
    jobid: 1134
    wildcards: BUSCO=EOG091G0EA2
    threads: 2


        cd per_gene/EOG091G0EA2
        if [ ! -d find_best_model ]
        then
            mkdir find_best_model
        fi
        cd find_best_model
        ln -s ../../../per_gene/EOG091G0EA2/ALICUT_EOG091G0EA2.clustalo.fasta EOG091G0EA2.fasta
        ProteinModelSelection.pl EOG091G0EA2.fasta 1> ../../../per_gene/EOG091G0EA2/EOG091G0EA2.best_model 2> ../../../per_gene/EOG091G0EA2/find_best_model.stderr.txt
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/c0c09ee657b1e27f2c5687e0e9aa8d70.simg
[Mon Jul  6 00:30:23 2020]
Finished job 2816.
3210 of 3292 steps (98%) done

[Mon Jul  6 00:30:23 2020]
rule get_outgroups:
    input: per_gene/EOG091G0QKK/EOG091G0QKK.ingroup.fasta
    output: per_gene/EOG091G0QKK/EOG091G0QKK.orthodb.fasta, per_gene/EOG091G0QKK/EOG091G0QKK.outgroup.fasta
    log: per_gene/EOG091G0QKK/get_outgroups.stdout.txt, per_gene/EOG091G0QKK/get_outgroups.stderr.txt
    jobid: 2817
    wildcards: BUSCO=EOG091G0QKK


        #download fastas from Orhtodb for BUSCO id
        for i in {1..5}
        do
             wget "http://www.orthodb.org/fasta?query=EOG091G0QKK&level=33208" -O per_gene/EOG091G0QKK/EOG091G0QKK.orthodb.fasta 1> per_gene/EOG091G0QKK/get_outgroups.stdout.txt 2> per_gene/EOG091G0QKK/get_outgroups.stderr.txt && break || echo -e "try again ($i)" && sleep 15
        done

	#This is quick an dirty for now and just takes the first protein if there is more than one for an outgroup taxon
        bash ../scripts/download_outgroups.sh taxids.txt per_gene/EOG091G0QKK/EOG091G0QKK.orthodb.fasta > per_gene/EOG091G0QKK/EOG091G0QKK.outgroup.fasta
        
[Mon Jul  6 00:30:24 2020]
Finished job 2817.
3211 of 3292 steps (98%) done

[Mon Jul  6 00:30:24 2020]
rule join_groups:
    input: per_gene/EOG091G0QKK/EOG091G0QKK.ingroup.fasta, per_gene/EOG091G0QKK/EOG091G0QKK.outgroup.fasta
    output: per_gene/EOG091G0QKK/EOG091G0QKK.fasta
    jobid: 2232
    wildcards: BUSCO=EOG091G0QKK


        cat per_gene/EOG091G0QKK/EOG091G0QKK.ingroup.fasta per_gene/EOG091G0QKK/EOG091G0QKK.outgroup.fasta > per_gene/EOG091G0QKK/EOG091G0QKK.fasta
        
[Mon Jul  6 00:30:24 2020]
Finished job 2232.
3212 of 3292 steps (98%) done

[Mon Jul  6 00:30:24 2020]
rule MSA:
    input: per_gene/EOG091G0QKK/EOG091G0QKK.fasta
    output: per_gene/EOG091G0QKK/EOG091G0QKK.clustalo.fasta
    log: per_gene/EOG091G0QKK/MSA.stdout.txt, per_gene/EOG091G0QKK/MSA.stderr.txt
    jobid: 1584
    wildcards: BUSCO=EOG091G0QKK
    threads: 2


        clustalo -i per_gene/EOG091G0QKK/EOG091G0QKK.fasta -o per_gene/EOG091G0QKK/EOG091G0QKK.clustalo.fasta --threads=2 1> per_gene/EOG091G0QKK/MSA.stdout.txt 2> per_gene/EOG091G0QKK/MSA.stderr.txt
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/d68c9691725a7401923680874285c430.simg
[Mon Jul  6 00:30:24 2020]
Finished job 1918.
3213 of 3292 steps (98%) done

[Mon Jul  6 00:30:24 2020]
rule score_and_cut:
    input: per_gene/EOG091G06Y3/EOG091G06Y3.clustalo.fasta
    output: per_gene/EOG091G06Y3/ALICUT_EOG091G06Y3.clustalo.fasta
    jobid: 1095
    wildcards: BUSCO=EOG091G06Y3
    threads: 2


        cd per_gene/EOG091G06Y3
        Aliscore.pl -N -r 200000000000000000 -i ../../per_gene/EOG091G06Y3/EOG091G06Y3.clustalo.fasta &> aliscore.log
        ALICUT.pl -s &> alicut.log
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/63c88c27a0fa300f57066b0ef65fefcb.simg
[Mon Jul  6 00:30:24 2020]
Finished job 1584.
3214 of 3292 steps (98%) done

[Mon Jul  6 00:30:24 2020]
rule score_and_cut:
    input: per_gene/EOG091G0QKK/EOG091G0QKK.clustalo.fasta
    output: per_gene/EOG091G0QKK/ALICUT_EOG091G0QKK.clustalo.fasta
    jobid: 761
    wildcards: BUSCO=EOG091G0QKK
    threads: 2


        cd per_gene/EOG091G0QKK
        Aliscore.pl -N -r 200000000000000000 -i ../../per_gene/EOG091G0QKK/EOG091G0QKK.clustalo.fasta &> aliscore.log
        ALICUT.pl -s &> alicut.log
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/63c88c27a0fa300f57066b0ef65fefcb.simg
[Mon Jul  6 00:30:25 2020]
Finished job 1163.
3215 of 3292 steps (98%) done

[Mon Jul  6 00:30:25 2020]
rule remove_empty:
    input: per_gene/EOG091G0K1Z/ALICUT_EOG091G0K1Z.clustalo.fasta
    output: per_gene/EOG091G0K1Z/empty_check.done
    jobid: 1985
    wildcards: BUSCO=EOG091G0K1Z


         if [ "$(cat per_gene/EOG091G0K1Z/ALICUT_EOG091G0K1Z.clustalo.fasta | grep -v ">" | sed 's/-//g' | grep "^$" | wc -l)" -gt 0 ]
         then
              cp per_gene/EOG091G0K1Z/ALICUT_EOG091G0K1Z.clustalo.fasta per_gene/EOG091G0K1Z/ALICUT_EOG091G0K1Z.clustalo.fasta.backup
              bash ../scripts/remove_empty.sh per_gene/EOG091G0K1Z/ALICUT_EOG091G0K1Z.clustalo.fasta.backup > per_gene/EOG091G0K1Z/ALICUT_EOG091G0K1Z.clustalo.fasta
         fi
         touch per_gene/EOG091G0K1Z/empty_check.done
         
[Mon Jul  6 00:30:25 2020]
Finished job 1985.
3216 of 3292 steps (98%) done

[Mon Jul  6 00:30:25 2020]
rule find_best_model:
    input: per_gene/EOG091G0K1Z/ALICUT_EOG091G0K1Z.clustalo.fasta, per_gene/EOG091G0K1Z/empty_check.done
    output: per_gene/EOG091G0K1Z/EOG091G0K1Z.best_model
    log: per_gene/EOG091G0K1Z/find_best_model.stderr.txt
    jobid: 1162
    wildcards: BUSCO=EOG091G0K1Z
    threads: 2


        cd per_gene/EOG091G0K1Z
        if [ ! -d find_best_model ]
        then
            mkdir find_best_model
        fi
        cd find_best_model
        ln -s ../../../per_gene/EOG091G0K1Z/ALICUT_EOG091G0K1Z.clustalo.fasta EOG091G0K1Z.fasta
        ProteinModelSelection.pl EOG091G0K1Z.fasta 1> ../../../per_gene/EOG091G0K1Z/EOG091G0K1Z.best_model 2> ../../../per_gene/EOG091G0K1Z/find_best_model.stderr.txt
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/c0c09ee657b1e27f2c5687e0e9aa8d70.simg
[Mon Jul  6 00:30:33 2020]
Finished job 1095.
3217 of 3292 steps (98%) done

[Mon Jul  6 00:30:33 2020]
rule remove_empty:
    input: per_gene/EOG091G06Y3/ALICUT_EOG091G06Y3.clustalo.fasta
    output: per_gene/EOG091G06Y3/empty_check.done
    jobid: 1917
    wildcards: BUSCO=EOG091G06Y3


         if [ "$(cat per_gene/EOG091G06Y3/ALICUT_EOG091G06Y3.clustalo.fasta | grep -v ">" | sed 's/-//g' | grep "^$" | wc -l)" -gt 0 ]
         then
              cp per_gene/EOG091G06Y3/ALICUT_EOG091G06Y3.clustalo.fasta per_gene/EOG091G06Y3/ALICUT_EOG091G06Y3.clustalo.fasta.backup
              bash ../scripts/remove_empty.sh per_gene/EOG091G06Y3/ALICUT_EOG091G06Y3.clustalo.fasta.backup > per_gene/EOG091G06Y3/ALICUT_EOG091G06Y3.clustalo.fasta
         fi
         touch per_gene/EOG091G06Y3/empty_check.done
         
[Mon Jul  6 00:30:33 2020]
Finished job 1917.
3218 of 3292 steps (98%) done

[Mon Jul  6 00:30:33 2020]
rule find_best_model:
    input: per_gene/EOG091G06Y3/ALICUT_EOG091G06Y3.clustalo.fasta, per_gene/EOG091G06Y3/empty_check.done
    output: per_gene/EOG091G06Y3/EOG091G06Y3.best_model
    log: per_gene/EOG091G06Y3/find_best_model.stderr.txt
    jobid: 1094
    wildcards: BUSCO=EOG091G06Y3
    threads: 2


        cd per_gene/EOG091G06Y3
        if [ ! -d find_best_model ]
        then
            mkdir find_best_model
        fi
        cd find_best_model
        ln -s ../../../per_gene/EOG091G06Y3/ALICUT_EOG091G06Y3.clustalo.fasta EOG091G06Y3.fasta
        ProteinModelSelection.pl EOG091G06Y3.fasta 1> ../../../per_gene/EOG091G06Y3/EOG091G06Y3.best_model 2> ../../../per_gene/EOG091G06Y3/find_best_model.stderr.txt
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/c0c09ee657b1e27f2c5687e0e9aa8d70.simg
[Mon Jul  6 00:30:35 2020]
Finished job 761.
3219 of 3292 steps (98%) done

[Mon Jul  6 00:30:35 2020]
rule remove_empty:
    input: per_gene/EOG091G0QKK/ALICUT_EOG091G0QKK.clustalo.fasta
    output: per_gene/EOG091G0QKK/empty_check.done
    jobid: 1583
    wildcards: BUSCO=EOG091G0QKK


         if [ "$(cat per_gene/EOG091G0QKK/ALICUT_EOG091G0QKK.clustalo.fasta | grep -v ">" | sed 's/-//g' | grep "^$" | wc -l)" -gt 0 ]
         then
              cp per_gene/EOG091G0QKK/ALICUT_EOG091G0QKK.clustalo.fasta per_gene/EOG091G0QKK/ALICUT_EOG091G0QKK.clustalo.fasta.backup
              bash ../scripts/remove_empty.sh per_gene/EOG091G0QKK/ALICUT_EOG091G0QKK.clustalo.fasta.backup > per_gene/EOG091G0QKK/ALICUT_EOG091G0QKK.clustalo.fasta
         fi
         touch per_gene/EOG091G0QKK/empty_check.done
         
[Mon Jul  6 00:30:35 2020]
Finished job 1583.
3220 of 3292 steps (98%) done

[Mon Jul  6 00:30:35 2020]
rule find_best_model:
    input: per_gene/EOG091G0QKK/ALICUT_EOG091G0QKK.clustalo.fasta, per_gene/EOG091G0QKK/empty_check.done
    output: per_gene/EOG091G0QKK/EOG091G0QKK.best_model
    log: per_gene/EOG091G0QKK/find_best_model.stderr.txt
    jobid: 760
    wildcards: BUSCO=EOG091G0QKK
    threads: 2


        cd per_gene/EOG091G0QKK
        if [ ! -d find_best_model ]
        then
            mkdir find_best_model
        fi
        cd find_best_model
        ln -s ../../../per_gene/EOG091G0QKK/ALICUT_EOG091G0QKK.clustalo.fasta EOG091G0QKK.fasta
        ProteinModelSelection.pl EOG091G0QKK.fasta 1> ../../../per_gene/EOG091G0QKK/EOG091G0QKK.best_model 2> ../../../per_gene/EOG091G0QKK/find_best_model.stderr.txt
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/c0c09ee657b1e27f2c5687e0e9aa8d70.simg
[Mon Jul  6 00:30:52 2020]
Finished job 355.
3221 of 3292 steps (98%) done

[Mon Jul  6 00:30:52 2020]
rule get_seqs:
    input: /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ingroup.txt, /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/outgroup.txt
    output: per_gene/EOG091G0QZ2/EOG091G0QZ2.ingroup.fasta
    log: per_gene/EOG091G0QZ2/get_seqs.stdout.txt, per_gene/EOG091G0QZ2/get_seqs.stderr.txt
    jobid: 2826
    wildcards: BUSCO=EOG091G0QZ2
    threads: 2


	basedir=$(pwd)
        cd per_gene/EOG091G0QZ2
        
        bash $basedir/../scripts/fetch_seqs.sh EOG091G0QZ2 /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ingroup.txt /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/outgroup.txt 1> ../../per_gene/EOG091G0QZ2/get_seqs.stdout.txt 2> ../../per_gene/EOG091G0QZ2/get_seqs.stderr.txt
	mv EOG091G0QZ2.fasta $basedir/per_gene/EOG091G0QZ2/EOG091G0QZ2.ingroup.fasta
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/72476f9d9a5bd0627b4d721143a21354.simg
[Mon Jul  6 00:30:55 2020]
Finished job 1162.
3222 of 3292 steps (98%) done

[Mon Jul  6 00:30:55 2020]
rule infer_single_ML:
    input: per_gene/EOG091G0K1Z/EOG091G0K1Z.best_model, per_gene/EOG091G0K1Z/ALICUT_EOG091G0K1Z.clustalo.fasta
    output: per_gene/EOG091G0K1Z/EOG091G0K1Z.raxml.done
    log: per_gene/EOG091G0K1Z/infer_single_ML.stdout.txt, per_gene/EOG091G0K1Z/infer_single_ML.stderr.txt
    jobid: 375
    wildcards: BUSCO=EOG091G0K1Z
    threads: 2


        cd per_gene/EOG091G0K1Z
	count=$(cat ../../per_gene/EOG091G0K1Z/ALICUT_EOG091G0K1Z.clustalo.fasta | grep ">" | wc -l)
	if [ "$count" -gt 5 ]
        then
		RAxMLmodel=$(cat ../../per_gene/EOG091G0K1Z/EOG091G0K1Z.best_model | grep "Best" | cut -d ":" -f 2 | tr -d '[:space:]')
                if [ "$(ls -1 | grep "^RAxML" | wc -l)" -ne 0 ]
		then
			rm RAxML*
		fi
        	raxml -f a -T 2 -m PROTGAMMA$RAxMLmodel         	-p 12345 -x 12345 -# 100         	-s ../../per_gene/EOG091G0K1Z/ALICUT_EOG091G0K1Z.clustalo.fasta -n EOG091G0K1Z.clustalo.aln.ALICUT.$RAxMLmodel 		1> ../../per_gene/EOG091G0K1Z/infer_single_ML.stdout.txt 2> ../../per_gene/EOG091G0K1Z/infer_single_ML.stderr.txt
	else
		echo "fasta file per_gene/EOG091G0K1Z/ALICUT_EOG091G0K1Z.clustalo.fasta contains fewer than 5 sequences - skipped" > ../../per_gene/EOG091G0K1Z/infer_single_ML.stdout.txt
		touch raxml.skipped
	fi
        touch ../../per_gene/EOG091G0K1Z/EOG091G0K1Z.raxml.done
        
[33mJob counts:
	count	jobs
	1	infer_single_ML
	1[0m
[33m
        cd per_gene/EOG091G0K1Z
	count=$(cat ../../per_gene/EOG091G0K1Z/ALICUT_EOG091G0K1Z.clustalo.fasta | grep ">" | wc -l)
	if [ "$count" -gt 5 ]
        then
		RAxMLmodel=$(cat ../../per_gene/EOG091G0K1Z/EOG091G0K1Z.best_model | grep "Best" | cut -d ":" -f 2 | tr -d '[:space:]')
                if [ "$(ls -1 | grep "^RAxML" | wc -l)" -ne 0 ]
		then
			rm RAxML*
		fi
        	raxml -f a -T 2 -m PROTGAMMA$RAxMLmodel         	-p 12345 -x 12345 -# 100         	-s ../../per_gene/EOG091G0K1Z/ALICUT_EOG091G0K1Z.clustalo.fasta -n EOG091G0K1Z.clustalo.aln.ALICUT.$RAxMLmodel 		1> ../../per_gene/EOG091G0K1Z/infer_single_ML.stdout.txt 2> ../../per_gene/EOG091G0K1Z/infer_single_ML.stderr.txt
	else
		echo "fasta file per_gene/EOG091G0K1Z/ALICUT_EOG091G0K1Z.clustalo.fasta contains fewer than 5 sequences - skipped" > ../../per_gene/EOG091G0K1Z/infer_single_ML.stdout.txt
		touch raxml.skipped
	fi
        touch ../../per_gene/EOG091G0K1Z/EOG091G0K1Z.raxml.done
        [0m
[Mon Jul  6 00:30:57 2020]
Finished job 1134.
3223 of 3292 steps (98%) done

[Mon Jul  6 00:30:57 2020]
rule infer_single_ML:
    input: per_gene/EOG091G0EA2/EOG091G0EA2.best_model, per_gene/EOG091G0EA2/ALICUT_EOG091G0EA2.clustalo.fasta
    output: per_gene/EOG091G0EA2/EOG091G0EA2.raxml.done
    log: per_gene/EOG091G0EA2/infer_single_ML.stdout.txt, per_gene/EOG091G0EA2/infer_single_ML.stderr.txt
    jobid: 361
    wildcards: BUSCO=EOG091G0EA2
    threads: 2


        cd per_gene/EOG091G0EA2
	count=$(cat ../../per_gene/EOG091G0EA2/ALICUT_EOG091G0EA2.clustalo.fasta | grep ">" | wc -l)
	if [ "$count" -gt 5 ]
        then
		RAxMLmodel=$(cat ../../per_gene/EOG091G0EA2/EOG091G0EA2.best_model | grep "Best" | cut -d ":" -f 2 | tr -d '[:space:]')
                if [ "$(ls -1 | grep "^RAxML" | wc -l)" -ne 0 ]
		then
			rm RAxML*
		fi
        	raxml -f a -T 2 -m PROTGAMMA$RAxMLmodel         	-p 12345 -x 12345 -# 100         	-s ../../per_gene/EOG091G0EA2/ALICUT_EOG091G0EA2.clustalo.fasta -n EOG091G0EA2.clustalo.aln.ALICUT.$RAxMLmodel 		1> ../../per_gene/EOG091G0EA2/infer_single_ML.stdout.txt 2> ../../per_gene/EOG091G0EA2/infer_single_ML.stderr.txt
	else
		echo "fasta file per_gene/EOG091G0EA2/ALICUT_EOG091G0EA2.clustalo.fasta contains fewer than 5 sequences - skipped" > ../../per_gene/EOG091G0EA2/infer_single_ML.stdout.txt
		touch raxml.skipped
	fi
        touch ../../per_gene/EOG091G0EA2/EOG091G0EA2.raxml.done
        
[33mJob counts:
	count	jobs
	1	infer_single_ML
	1[0m
[33m
        cd per_gene/EOG091G0EA2
	count=$(cat ../../per_gene/EOG091G0EA2/ALICUT_EOG091G0EA2.clustalo.fasta | grep ">" | wc -l)
	if [ "$count" -gt 5 ]
        then
		RAxMLmodel=$(cat ../../per_gene/EOG091G0EA2/EOG091G0EA2.best_model | grep "Best" | cut -d ":" -f 2 | tr -d '[:space:]')
                if [ "$(ls -1 | grep "^RAxML" | wc -l)" -ne 0 ]
		then
			rm RAxML*
		fi
        	raxml -f a -T 2 -m PROTGAMMA$RAxMLmodel         	-p 12345 -x 12345 -# 100         	-s ../../per_gene/EOG091G0EA2/ALICUT_EOG091G0EA2.clustalo.fasta -n EOG091G0EA2.clustalo.aln.ALICUT.$RAxMLmodel 		1> ../../per_gene/EOG091G0EA2/infer_single_ML.stdout.txt 2> ../../per_gene/EOG091G0EA2/infer_single_ML.stderr.txt
	else
		echo "fasta file per_gene/EOG091G0EA2/ALICUT_EOG091G0EA2.clustalo.fasta contains fewer than 5 sequences - skipped" > ../../per_gene/EOG091G0EA2/infer_single_ML.stdout.txt
		touch raxml.skipped
	fi
        touch ../../per_gene/EOG091G0EA2/EOG091G0EA2.raxml.done
        [0m
[Mon Jul  6 00:31:09 2020]
Finished job 2826.
3224 of 3292 steps (98%) done

[Mon Jul  6 00:31:09 2020]
rule get_outgroups:
    input: per_gene/EOG091G0QZ2/EOG091G0QZ2.ingroup.fasta
    output: per_gene/EOG091G0QZ2/EOG091G0QZ2.orthodb.fasta, per_gene/EOG091G0QZ2/EOG091G0QZ2.outgroup.fasta
    log: per_gene/EOG091G0QZ2/get_outgroups.stdout.txt, per_gene/EOG091G0QZ2/get_outgroups.stderr.txt
    jobid: 2827
    wildcards: BUSCO=EOG091G0QZ2


        #download fastas from Orhtodb for BUSCO id
        for i in {1..5}
        do
             wget "http://www.orthodb.org/fasta?query=EOG091G0QZ2&level=33208" -O per_gene/EOG091G0QZ2/EOG091G0QZ2.orthodb.fasta 1> per_gene/EOG091G0QZ2/get_outgroups.stdout.txt 2> per_gene/EOG091G0QZ2/get_outgroups.stderr.txt && break || echo -e "try again ($i)" && sleep 15
        done

	#This is quick an dirty for now and just takes the first protein if there is more than one for an outgroup taxon
        bash ../scripts/download_outgroups.sh taxids.txt per_gene/EOG091G0QZ2/EOG091G0QZ2.orthodb.fasta > per_gene/EOG091G0QZ2/EOG091G0QZ2.outgroup.fasta
        
[Mon Jul  6 00:31:09 2020]
Finished job 1094.
3225 of 3292 steps (98%) done

[Mon Jul  6 00:31:09 2020]
rule infer_single_ML:
    input: per_gene/EOG091G06Y3/EOG091G06Y3.best_model, per_gene/EOG091G06Y3/ALICUT_EOG091G06Y3.clustalo.fasta
    output: per_gene/EOG091G06Y3/EOG091G06Y3.raxml.done
    log: per_gene/EOG091G06Y3/infer_single_ML.stdout.txt, per_gene/EOG091G06Y3/infer_single_ML.stderr.txt
    jobid: 341
    wildcards: BUSCO=EOG091G06Y3
    threads: 2


        cd per_gene/EOG091G06Y3
	count=$(cat ../../per_gene/EOG091G06Y3/ALICUT_EOG091G06Y3.clustalo.fasta | grep ">" | wc -l)
	if [ "$count" -gt 5 ]
        then
		RAxMLmodel=$(cat ../../per_gene/EOG091G06Y3/EOG091G06Y3.best_model | grep "Best" | cut -d ":" -f 2 | tr -d '[:space:]')
                if [ "$(ls -1 | grep "^RAxML" | wc -l)" -ne 0 ]
		then
			rm RAxML*
		fi
        	raxml -f a -T 2 -m PROTGAMMA$RAxMLmodel         	-p 12345 -x 12345 -# 100         	-s ../../per_gene/EOG091G06Y3/ALICUT_EOG091G06Y3.clustalo.fasta -n EOG091G06Y3.clustalo.aln.ALICUT.$RAxMLmodel 		1> ../../per_gene/EOG091G06Y3/infer_single_ML.stdout.txt 2> ../../per_gene/EOG091G06Y3/infer_single_ML.stderr.txt
	else
		echo "fasta file per_gene/EOG091G06Y3/ALICUT_EOG091G06Y3.clustalo.fasta contains fewer than 5 sequences - skipped" > ../../per_gene/EOG091G06Y3/infer_single_ML.stdout.txt
		touch raxml.skipped
	fi
        touch ../../per_gene/EOG091G06Y3/EOG091G06Y3.raxml.done
        
[Mon Jul  6 00:31:10 2020]
Finished job 2827.
3226 of 3292 steps (98%) done

[Mon Jul  6 00:31:10 2020]
rule join_groups:
    input: per_gene/EOG091G0QZ2/EOG091G0QZ2.ingroup.fasta, per_gene/EOG091G0QZ2/EOG091G0QZ2.outgroup.fasta
    output: per_gene/EOG091G0QZ2/EOG091G0QZ2.fasta
    jobid: 2237
    wildcards: BUSCO=EOG091G0QZ2


        cat per_gene/EOG091G0QZ2/EOG091G0QZ2.ingroup.fasta per_gene/EOG091G0QZ2/EOG091G0QZ2.outgroup.fasta > per_gene/EOG091G0QZ2/EOG091G0QZ2.fasta
        
[Mon Jul  6 00:31:10 2020]
Finished job 2237.
3227 of 3292 steps (98%) done

[Mon Jul  6 00:31:10 2020]
rule MSA:
    input: per_gene/EOG091G0QZ2/EOG091G0QZ2.fasta
    output: per_gene/EOG091G0QZ2/EOG091G0QZ2.clustalo.fasta
    log: per_gene/EOG091G0QZ2/MSA.stdout.txt, per_gene/EOG091G0QZ2/MSA.stderr.txt
    jobid: 1594
    wildcards: BUSCO=EOG091G0QZ2
    threads: 2


        clustalo -i per_gene/EOG091G0QZ2/EOG091G0QZ2.fasta -o per_gene/EOG091G0QZ2/EOG091G0QZ2.clustalo.fasta --threads=2 1> per_gene/EOG091G0QZ2/MSA.stdout.txt 2> per_gene/EOG091G0QZ2/MSA.stderr.txt
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/d68c9691725a7401923680874285c430.simg
[33mJob counts:
	count	jobs
	1	infer_single_ML
	1[0m
[33m
        cd per_gene/EOG091G06Y3
	count=$(cat ../../per_gene/EOG091G06Y3/ALICUT_EOG091G06Y3.clustalo.fasta | grep ">" | wc -l)
	if [ "$count" -gt 5 ]
        then
		RAxMLmodel=$(cat ../../per_gene/EOG091G06Y3/EOG091G06Y3.best_model | grep "Best" | cut -d ":" -f 2 | tr -d '[:space:]')
                if [ "$(ls -1 | grep "^RAxML" | wc -l)" -ne 0 ]
		then
			rm RAxML*
		fi
        	raxml -f a -T 2 -m PROTGAMMA$RAxMLmodel         	-p 12345 -x 12345 -# 100         	-s ../../per_gene/EOG091G06Y3/ALICUT_EOG091G06Y3.clustalo.fasta -n EOG091G06Y3.clustalo.aln.ALICUT.$RAxMLmodel 		1> ../../per_gene/EOG091G06Y3/infer_single_ML.stdout.txt 2> ../../per_gene/EOG091G06Y3/infer_single_ML.stderr.txt
	else
		echo "fasta file per_gene/EOG091G06Y3/ALICUT_EOG091G06Y3.clustalo.fasta contains fewer than 5 sequences - skipped" > ../../per_gene/EOG091G06Y3/infer_single_ML.stdout.txt
		touch raxml.skipped
	fi
        touch ../../per_gene/EOG091G06Y3/EOG091G06Y3.raxml.done
        [0m
[Mon Jul  6 00:31:10 2020]
Finished job 760.
3228 of 3292 steps (98%) done

[Mon Jul  6 00:31:10 2020]
rule infer_single_ML:
    input: per_gene/EOG091G0QKK/EOG091G0QKK.best_model, per_gene/EOG091G0QKK/ALICUT_EOG091G0QKK.clustalo.fasta
    output: per_gene/EOG091G0QKK/EOG091G0QKK.raxml.done
    log: per_gene/EOG091G0QKK/infer_single_ML.stdout.txt, per_gene/EOG091G0QKK/infer_single_ML.stderr.txt
    jobid: 174
    wildcards: BUSCO=EOG091G0QKK
    threads: 2


        cd per_gene/EOG091G0QKK
	count=$(cat ../../per_gene/EOG091G0QKK/ALICUT_EOG091G0QKK.clustalo.fasta | grep ">" | wc -l)
	if [ "$count" -gt 5 ]
        then
		RAxMLmodel=$(cat ../../per_gene/EOG091G0QKK/EOG091G0QKK.best_model | grep "Best" | cut -d ":" -f 2 | tr -d '[:space:]')
                if [ "$(ls -1 | grep "^RAxML" | wc -l)" -ne 0 ]
		then
			rm RAxML*
		fi
        	raxml -f a -T 2 -m PROTGAMMA$RAxMLmodel         	-p 12345 -x 12345 -# 100         	-s ../../per_gene/EOG091G0QKK/ALICUT_EOG091G0QKK.clustalo.fasta -n EOG091G0QKK.clustalo.aln.ALICUT.$RAxMLmodel 		1> ../../per_gene/EOG091G0QKK/infer_single_ML.stdout.txt 2> ../../per_gene/EOG091G0QKK/infer_single_ML.stderr.txt
	else
		echo "fasta file per_gene/EOG091G0QKK/ALICUT_EOG091G0QKK.clustalo.fasta contains fewer than 5 sequences - skipped" > ../../per_gene/EOG091G0QKK/infer_single_ML.stdout.txt
		touch raxml.skipped
	fi
        touch ../../per_gene/EOG091G0QKK/EOG091G0QKK.raxml.done
        
[Mon Jul  6 00:31:10 2020]
Finished job 1594.
3229 of 3292 steps (98%) done

[Mon Jul  6 00:31:10 2020]
rule score_and_cut:
    input: per_gene/EOG091G0QZ2/EOG091G0QZ2.clustalo.fasta
    output: per_gene/EOG091G0QZ2/ALICUT_EOG091G0QZ2.clustalo.fasta
    jobid: 771
    wildcards: BUSCO=EOG091G0QZ2
    threads: 2


        cd per_gene/EOG091G0QZ2
        Aliscore.pl -N -r 200000000000000000 -i ../../per_gene/EOG091G0QZ2/EOG091G0QZ2.clustalo.fasta &> aliscore.log
        ALICUT.pl -s &> alicut.log
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/63c88c27a0fa300f57066b0ef65fefcb.simg
[33mJob counts:
	count	jobs
	1	infer_single_ML
	1[0m
[33m
        cd per_gene/EOG091G0QKK
	count=$(cat ../../per_gene/EOG091G0QKK/ALICUT_EOG091G0QKK.clustalo.fasta | grep ">" | wc -l)
	if [ "$count" -gt 5 ]
        then
		RAxMLmodel=$(cat ../../per_gene/EOG091G0QKK/EOG091G0QKK.best_model | grep "Best" | cut -d ":" -f 2 | tr -d '[:space:]')
                if [ "$(ls -1 | grep "^RAxML" | wc -l)" -ne 0 ]
		then
			rm RAxML*
		fi
        	raxml -f a -T 2 -m PROTGAMMA$RAxMLmodel         	-p 12345 -x 12345 -# 100         	-s ../../per_gene/EOG091G0QKK/ALICUT_EOG091G0QKK.clustalo.fasta -n EOG091G0QKK.clustalo.aln.ALICUT.$RAxMLmodel 		1> ../../per_gene/EOG091G0QKK/infer_single_ML.stdout.txt 2> ../../per_gene/EOG091G0QKK/infer_single_ML.stderr.txt
	else
		echo "fasta file per_gene/EOG091G0QKK/ALICUT_EOG091G0QKK.clustalo.fasta contains fewer than 5 sequences - skipped" > ../../per_gene/EOG091G0QKK/infer_single_ML.stdout.txt
		touch raxml.skipped
	fi
        touch ../../per_gene/EOG091G0QKK/EOG091G0QKK.raxml.done
        [0m
[Mon Jul  6 00:31:14 2020]
Finished job 242.
3230 of 3292 steps (98%) done

[Mon Jul  6 00:31:14 2020]
rule get_seqs:
    input: /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ingroup.txt, /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/outgroup.txt
    output: per_gene/EOG091G0H8F/EOG091G0H8F.ingroup.fasta
    log: per_gene/EOG091G0H8F/get_seqs.stdout.txt, per_gene/EOG091G0H8F/get_seqs.stderr.txt
    jobid: 2704
    wildcards: BUSCO=EOG091G0H8F
    threads: 2


	basedir=$(pwd)
        cd per_gene/EOG091G0H8F
        
        bash $basedir/../scripts/fetch_seqs.sh EOG091G0H8F /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ingroup.txt /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/outgroup.txt 1> ../../per_gene/EOG091G0H8F/get_seqs.stdout.txt 2> ../../per_gene/EOG091G0H8F/get_seqs.stderr.txt
	mv EOG091G0H8F.fasta $basedir/per_gene/EOG091G0H8F/EOG091G0H8F.ingroup.fasta
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/72476f9d9a5bd0627b4d721143a21354.simg
[Mon Jul  6 00:31:21 2020]
Finished job 771.
3231 of 3292 steps (98%) done

[Mon Jul  6 00:31:21 2020]
rule remove_empty:
    input: per_gene/EOG091G0QZ2/ALICUT_EOG091G0QZ2.clustalo.fasta
    output: per_gene/EOG091G0QZ2/empty_check.done
    jobid: 1593
    wildcards: BUSCO=EOG091G0QZ2


         if [ "$(cat per_gene/EOG091G0QZ2/ALICUT_EOG091G0QZ2.clustalo.fasta | grep -v ">" | sed 's/-//g' | grep "^$" | wc -l)" -gt 0 ]
         then
              cp per_gene/EOG091G0QZ2/ALICUT_EOG091G0QZ2.clustalo.fasta per_gene/EOG091G0QZ2/ALICUT_EOG091G0QZ2.clustalo.fasta.backup
              bash ../scripts/remove_empty.sh per_gene/EOG091G0QZ2/ALICUT_EOG091G0QZ2.clustalo.fasta.backup > per_gene/EOG091G0QZ2/ALICUT_EOG091G0QZ2.clustalo.fasta
         fi
         touch per_gene/EOG091G0QZ2/empty_check.done
         
[Mon Jul  6 00:31:21 2020]
Finished job 1593.
3232 of 3292 steps (98%) done

[Mon Jul  6 00:31:21 2020]
rule find_best_model:
    input: per_gene/EOG091G0QZ2/ALICUT_EOG091G0QZ2.clustalo.fasta, per_gene/EOG091G0QZ2/empty_check.done
    output: per_gene/EOG091G0QZ2/EOG091G0QZ2.best_model
    log: per_gene/EOG091G0QZ2/find_best_model.stderr.txt
    jobid: 770
    wildcards: BUSCO=EOG091G0QZ2
    threads: 2


        cd per_gene/EOG091G0QZ2
        if [ ! -d find_best_model ]
        then
            mkdir find_best_model
        fi
        cd find_best_model
        ln -s ../../../per_gene/EOG091G0QZ2/ALICUT_EOG091G0QZ2.clustalo.fasta EOG091G0QZ2.fasta
        ProteinModelSelection.pl EOG091G0QZ2.fasta 1> ../../../per_gene/EOG091G0QZ2/EOG091G0QZ2.best_model 2> ../../../per_gene/EOG091G0QZ2/find_best_model.stderr.txt
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/c0c09ee657b1e27f2c5687e0e9aa8d70.simg
[Mon Jul  6 00:31:29 2020]
Finished job 2704.
3233 of 3292 steps (98%) done

[Mon Jul  6 00:31:29 2020]
rule get_outgroups:
    input: per_gene/EOG091G0H8F/EOG091G0H8F.ingroup.fasta
    output: per_gene/EOG091G0H8F/EOG091G0H8F.orthodb.fasta, per_gene/EOG091G0H8F/EOG091G0H8F.outgroup.fasta
    log: per_gene/EOG091G0H8F/get_outgroups.stdout.txt, per_gene/EOG091G0H8F/get_outgroups.stderr.txt
    jobid: 2705
    wildcards: BUSCO=EOG091G0H8F


        #download fastas from Orhtodb for BUSCO id
        for i in {1..5}
        do
             wget "http://www.orthodb.org/fasta?query=EOG091G0H8F&level=33208" -O per_gene/EOG091G0H8F/EOG091G0H8F.orthodb.fasta 1> per_gene/EOG091G0H8F/get_outgroups.stdout.txt 2> per_gene/EOG091G0H8F/get_outgroups.stderr.txt && break || echo -e "try again ($i)" && sleep 15
        done

	#This is quick an dirty for now and just takes the first protein if there is more than one for an outgroup taxon
        bash ../scripts/download_outgroups.sh taxids.txt per_gene/EOG091G0H8F/EOG091G0H8F.orthodb.fasta > per_gene/EOG091G0H8F/EOG091G0H8F.outgroup.fasta
        
[Mon Jul  6 00:31:30 2020]
Finished job 2705.
3234 of 3292 steps (98%) done

[Mon Jul  6 00:31:30 2020]
rule join_groups:
    input: per_gene/EOG091G0H8F/EOG091G0H8F.ingroup.fasta, per_gene/EOG091G0H8F/EOG091G0H8F.outgroup.fasta
    output: per_gene/EOG091G0H8F/EOG091G0H8F.fasta
    jobid: 2176
    wildcards: BUSCO=EOG091G0H8F


        cat per_gene/EOG091G0H8F/EOG091G0H8F.ingroup.fasta per_gene/EOG091G0H8F/EOG091G0H8F.outgroup.fasta > per_gene/EOG091G0H8F/EOG091G0H8F.fasta
        
[Mon Jul  6 00:31:30 2020]
Finished job 2176.
3235 of 3292 steps (98%) done

[Mon Jul  6 00:31:30 2020]
rule MSA:
    input: per_gene/EOG091G0H8F/EOG091G0H8F.fasta
    output: per_gene/EOG091G0H8F/EOG091G0H8F.clustalo.fasta
    log: per_gene/EOG091G0H8F/MSA.stdout.txt, per_gene/EOG091G0H8F/MSA.stderr.txt
    jobid: 1472
    wildcards: BUSCO=EOG091G0H8F
    threads: 2


        clustalo -i per_gene/EOG091G0H8F/EOG091G0H8F.fasta -o per_gene/EOG091G0H8F/EOG091G0H8F.clustalo.fasta --threads=2 1> per_gene/EOG091G0H8F/MSA.stdout.txt 2> per_gene/EOG091G0H8F/MSA.stderr.txt
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/d68c9691725a7401923680874285c430.simg
[Mon Jul  6 00:31:31 2020]
Finished job 1472.
3236 of 3292 steps (98%) done

[Mon Jul  6 00:31:31 2020]
rule score_and_cut:
    input: per_gene/EOG091G0H8F/EOG091G0H8F.clustalo.fasta
    output: per_gene/EOG091G0H8F/ALICUT_EOG091G0H8F.clustalo.fasta
    jobid: 649
    wildcards: BUSCO=EOG091G0H8F
    threads: 2


        cd per_gene/EOG091G0H8F
        Aliscore.pl -N -r 200000000000000000 -i ../../per_gene/EOG091G0H8F/EOG091G0H8F.clustalo.fasta &> aliscore.log
        ALICUT.pl -s &> alicut.log
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/63c88c27a0fa300f57066b0ef65fefcb.simg
[Mon Jul  6 00:31:42 2020]
Finished job 649.
3237 of 3292 steps (98%) done

[Mon Jul  6 00:31:42 2020]
rule remove_empty:
    input: per_gene/EOG091G0H8F/ALICUT_EOG091G0H8F.clustalo.fasta
    output: per_gene/EOG091G0H8F/empty_check.done
    jobid: 1471
    wildcards: BUSCO=EOG091G0H8F


         if [ "$(cat per_gene/EOG091G0H8F/ALICUT_EOG091G0H8F.clustalo.fasta | grep -v ">" | sed 's/-//g' | grep "^$" | wc -l)" -gt 0 ]
         then
              cp per_gene/EOG091G0H8F/ALICUT_EOG091G0H8F.clustalo.fasta per_gene/EOG091G0H8F/ALICUT_EOG091G0H8F.clustalo.fasta.backup
              bash ../scripts/remove_empty.sh per_gene/EOG091G0H8F/ALICUT_EOG091G0H8F.clustalo.fasta.backup > per_gene/EOG091G0H8F/ALICUT_EOG091G0H8F.clustalo.fasta
         fi
         touch per_gene/EOG091G0H8F/empty_check.done
         
[Mon Jul  6 00:31:43 2020]
Finished job 1471.
3238 of 3292 steps (98%) done

[Mon Jul  6 00:31:43 2020]
rule find_best_model:
    input: per_gene/EOG091G0H8F/ALICUT_EOG091G0H8F.clustalo.fasta, per_gene/EOG091G0H8F/empty_check.done
    output: per_gene/EOG091G0H8F/EOG091G0H8F.best_model
    log: per_gene/EOG091G0H8F/find_best_model.stderr.txt
    jobid: 648
    wildcards: BUSCO=EOG091G0H8F
    threads: 2


        cd per_gene/EOG091G0H8F
        if [ ! -d find_best_model ]
        then
            mkdir find_best_model
        fi
        cd find_best_model
        ln -s ../../../per_gene/EOG091G0H8F/ALICUT_EOG091G0H8F.clustalo.fasta EOG091G0H8F.fasta
        ProteinModelSelection.pl EOG091G0H8F.fasta 1> ../../../per_gene/EOG091G0H8F/EOG091G0H8F.best_model 2> ../../../per_gene/EOG091G0H8F/find_best_model.stderr.txt
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/c0c09ee657b1e27f2c5687e0e9aa8d70.simg
[Mon Jul  6 00:31:45 2020]
Finished job 770.
3239 of 3292 steps (98%) done

[Mon Jul  6 00:31:45 2020]
rule infer_single_ML:
    input: per_gene/EOG091G0QZ2/EOG091G0QZ2.best_model, per_gene/EOG091G0QZ2/ALICUT_EOG091G0QZ2.clustalo.fasta
    output: per_gene/EOG091G0QZ2/EOG091G0QZ2.raxml.done
    log: per_gene/EOG091G0QZ2/infer_single_ML.stdout.txt, per_gene/EOG091G0QZ2/infer_single_ML.stderr.txt
    jobid: 179
    wildcards: BUSCO=EOG091G0QZ2
    threads: 2


        cd per_gene/EOG091G0QZ2
	count=$(cat ../../per_gene/EOG091G0QZ2/ALICUT_EOG091G0QZ2.clustalo.fasta | grep ">" | wc -l)
	if [ "$count" -gt 5 ]
        then
		RAxMLmodel=$(cat ../../per_gene/EOG091G0QZ2/EOG091G0QZ2.best_model | grep "Best" | cut -d ":" -f 2 | tr -d '[:space:]')
                if [ "$(ls -1 | grep "^RAxML" | wc -l)" -ne 0 ]
		then
			rm RAxML*
		fi
        	raxml -f a -T 2 -m PROTGAMMA$RAxMLmodel         	-p 12345 -x 12345 -# 100         	-s ../../per_gene/EOG091G0QZ2/ALICUT_EOG091G0QZ2.clustalo.fasta -n EOG091G0QZ2.clustalo.aln.ALICUT.$RAxMLmodel 		1> ../../per_gene/EOG091G0QZ2/infer_single_ML.stdout.txt 2> ../../per_gene/EOG091G0QZ2/infer_single_ML.stderr.txt
	else
		echo "fasta file per_gene/EOG091G0QZ2/ALICUT_EOG091G0QZ2.clustalo.fasta contains fewer than 5 sequences - skipped" > ../../per_gene/EOG091G0QZ2/infer_single_ML.stdout.txt
		touch raxml.skipped
	fi
        touch ../../per_gene/EOG091G0QZ2/EOG091G0QZ2.raxml.done
        
[33mJob counts:
	count	jobs
	1	infer_single_ML
	1[0m
[33m
        cd per_gene/EOG091G0QZ2
	count=$(cat ../../per_gene/EOG091G0QZ2/ALICUT_EOG091G0QZ2.clustalo.fasta | grep ">" | wc -l)
	if [ "$count" -gt 5 ]
        then
		RAxMLmodel=$(cat ../../per_gene/EOG091G0QZ2/EOG091G0QZ2.best_model | grep "Best" | cut -d ":" -f 2 | tr -d '[:space:]')
                if [ "$(ls -1 | grep "^RAxML" | wc -l)" -ne 0 ]
		then
			rm RAxML*
		fi
        	raxml -f a -T 2 -m PROTGAMMA$RAxMLmodel         	-p 12345 -x 12345 -# 100         	-s ../../per_gene/EOG091G0QZ2/ALICUT_EOG091G0QZ2.clustalo.fasta -n EOG091G0QZ2.clustalo.aln.ALICUT.$RAxMLmodel 		1> ../../per_gene/EOG091G0QZ2/infer_single_ML.stdout.txt 2> ../../per_gene/EOG091G0QZ2/infer_single_ML.stderr.txt
	else
		echo "fasta file per_gene/EOG091G0QZ2/ALICUT_EOG091G0QZ2.clustalo.fasta contains fewer than 5 sequences - skipped" > ../../per_gene/EOG091G0QZ2/infer_single_ML.stdout.txt
		touch raxml.skipped
	fi
        touch ../../per_gene/EOG091G0QZ2/EOG091G0QZ2.raxml.done
        [0m
[Mon Jul  6 00:31:52 2020]
Finished job 382.
3240 of 3292 steps (98%) done

[Mon Jul  6 00:31:52 2020]
rule get_seqs:
    input: /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ingroup.txt, /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/outgroup.txt
    output: per_gene/EOG091G0ER1/EOG091G0ER1.ingroup.fasta
    log: per_gene/EOG091G0ER1/get_seqs.stdout.txt, per_gene/EOG091G0ER1/get_seqs.stderr.txt
    jobid: 2976
    wildcards: BUSCO=EOG091G0ER1
    threads: 2


	basedir=$(pwd)
        cd per_gene/EOG091G0ER1
        
        bash $basedir/../scripts/fetch_seqs.sh EOG091G0ER1 /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ingroup.txt /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/outgroup.txt 1> ../../per_gene/EOG091G0ER1/get_seqs.stdout.txt 2> ../../per_gene/EOG091G0ER1/get_seqs.stderr.txt
	mv EOG091G0ER1.fasta $basedir/per_gene/EOG091G0ER1/EOG091G0ER1.ingroup.fasta
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/72476f9d9a5bd0627b4d721143a21354.simg
[Mon Jul  6 00:32:10 2020]
Finished job 2976.
3241 of 3292 steps (98%) done

[Mon Jul  6 00:32:10 2020]
rule get_outgroups:
    input: per_gene/EOG091G0ER1/EOG091G0ER1.ingroup.fasta
    output: per_gene/EOG091G0ER1/EOG091G0ER1.orthodb.fasta, per_gene/EOG091G0ER1/EOG091G0ER1.outgroup.fasta
    log: per_gene/EOG091G0ER1/get_outgroups.stdout.txt, per_gene/EOG091G0ER1/get_outgroups.stderr.txt
    jobid: 2977
    wildcards: BUSCO=EOG091G0ER1


        #download fastas from Orhtodb for BUSCO id
        for i in {1..5}
        do
             wget "http://www.orthodb.org/fasta?query=EOG091G0ER1&level=33208" -O per_gene/EOG091G0ER1/EOG091G0ER1.orthodb.fasta 1> per_gene/EOG091G0ER1/get_outgroups.stdout.txt 2> per_gene/EOG091G0ER1/get_outgroups.stderr.txt && break || echo -e "try again ($i)" && sleep 15
        done

	#This is quick an dirty for now and just takes the first protein if there is more than one for an outgroup taxon
        bash ../scripts/download_outgroups.sh taxids.txt per_gene/EOG091G0ER1/EOG091G0ER1.orthodb.fasta > per_gene/EOG091G0ER1/EOG091G0ER1.outgroup.fasta
        
[Mon Jul  6 00:32:11 2020]
Finished job 2977.
3242 of 3292 steps (98%) done

[Mon Jul  6 00:32:11 2020]
rule join_groups:
    input: per_gene/EOG091G0ER1/EOG091G0ER1.ingroup.fasta, per_gene/EOG091G0ER1/EOG091G0ER1.outgroup.fasta
    output: per_gene/EOG091G0ER1/EOG091G0ER1.fasta
    jobid: 2312
    wildcards: BUSCO=EOG091G0ER1


        cat per_gene/EOG091G0ER1/EOG091G0ER1.ingroup.fasta per_gene/EOG091G0ER1/EOG091G0ER1.outgroup.fasta > per_gene/EOG091G0ER1/EOG091G0ER1.fasta
        
[Mon Jul  6 00:32:11 2020]
Finished job 2312.
3243 of 3292 steps (99%) done

[Mon Jul  6 00:32:11 2020]
rule MSA:
    input: per_gene/EOG091G0ER1/EOG091G0ER1.fasta
    output: per_gene/EOG091G0ER1/EOG091G0ER1.clustalo.fasta
    log: per_gene/EOG091G0ER1/MSA.stdout.txt, per_gene/EOG091G0ER1/MSA.stderr.txt
    jobid: 1744
    wildcards: BUSCO=EOG091G0ER1
    threads: 2


        clustalo -i per_gene/EOG091G0ER1/EOG091G0ER1.fasta -o per_gene/EOG091G0ER1/EOG091G0ER1.clustalo.fasta --threads=2 1> per_gene/EOG091G0ER1/MSA.stdout.txt 2> per_gene/EOG091G0ER1/MSA.stderr.txt
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/d68c9691725a7401923680874285c430.simg
[Mon Jul  6 00:32:17 2020]
Finished job 1744.
3244 of 3292 steps (99%) done

[Mon Jul  6 00:32:17 2020]
rule score_and_cut:
    input: per_gene/EOG091G0ER1/EOG091G0ER1.clustalo.fasta
    output: per_gene/EOG091G0ER1/ALICUT_EOG091G0ER1.clustalo.fasta
    jobid: 921
    wildcards: BUSCO=EOG091G0ER1
    threads: 2


        cd per_gene/EOG091G0ER1
        Aliscore.pl -N -r 200000000000000000 -i ../../per_gene/EOG091G0ER1/EOG091G0ER1.clustalo.fasta &> aliscore.log
        ALICUT.pl -s &> alicut.log
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/63c88c27a0fa300f57066b0ef65fefcb.simg
[Mon Jul  6 00:32:20 2020]
Finished job 648.
3245 of 3292 steps (99%) done

[Mon Jul  6 00:32:20 2020]
rule infer_single_ML:
    input: per_gene/EOG091G0H8F/EOG091G0H8F.best_model, per_gene/EOG091G0H8F/ALICUT_EOG091G0H8F.clustalo.fasta
    output: per_gene/EOG091G0H8F/EOG091G0H8F.raxml.done
    log: per_gene/EOG091G0H8F/infer_single_ML.stdout.txt, per_gene/EOG091G0H8F/infer_single_ML.stderr.txt
    jobid: 118
    wildcards: BUSCO=EOG091G0H8F
    threads: 2


        cd per_gene/EOG091G0H8F
	count=$(cat ../../per_gene/EOG091G0H8F/ALICUT_EOG091G0H8F.clustalo.fasta | grep ">" | wc -l)
	if [ "$count" -gt 5 ]
        then
		RAxMLmodel=$(cat ../../per_gene/EOG091G0H8F/EOG091G0H8F.best_model | grep "Best" | cut -d ":" -f 2 | tr -d '[:space:]')
                if [ "$(ls -1 | grep "^RAxML" | wc -l)" -ne 0 ]
		then
			rm RAxML*
		fi
        	raxml -f a -T 2 -m PROTGAMMA$RAxMLmodel         	-p 12345 -x 12345 -# 100         	-s ../../per_gene/EOG091G0H8F/ALICUT_EOG091G0H8F.clustalo.fasta -n EOG091G0H8F.clustalo.aln.ALICUT.$RAxMLmodel 		1> ../../per_gene/EOG091G0H8F/infer_single_ML.stdout.txt 2> ../../per_gene/EOG091G0H8F/infer_single_ML.stderr.txt
	else
		echo "fasta file per_gene/EOG091G0H8F/ALICUT_EOG091G0H8F.clustalo.fasta contains fewer than 5 sequences - skipped" > ../../per_gene/EOG091G0H8F/infer_single_ML.stdout.txt
		touch raxml.skipped
	fi
        touch ../../per_gene/EOG091G0H8F/EOG091G0H8F.raxml.done
        
[Mon Jul  6 00:32:23 2020]
Finished job 210.
3246 of 3292 steps (99%) done

[Mon Jul  6 00:32:23 2020]
rule get_seqs:
    input: /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ingroup.txt, /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/outgroup.txt
    output: per_gene/EOG091G0E11/EOG091G0E11.ingroup.fasta
    log: per_gene/EOG091G0E11/get_seqs.stdout.txt, per_gene/EOG091G0E11/get_seqs.stderr.txt
    jobid: 2974
    wildcards: BUSCO=EOG091G0E11
    threads: 2


	basedir=$(pwd)
        cd per_gene/EOG091G0E11
        
        bash $basedir/../scripts/fetch_seqs.sh EOG091G0E11 /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ingroup.txt /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/outgroup.txt 1> ../../per_gene/EOG091G0E11/get_seqs.stdout.txt 2> ../../per_gene/EOG091G0E11/get_seqs.stderr.txt
	mv EOG091G0E11.fasta $basedir/per_gene/EOG091G0E11/EOG091G0E11.ingroup.fasta
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/72476f9d9a5bd0627b4d721143a21354.simg
[33mJob counts:
	count	jobs
	1	infer_single_ML
	1[0m
[33m
        cd per_gene/EOG091G0H8F
	count=$(cat ../../per_gene/EOG091G0H8F/ALICUT_EOG091G0H8F.clustalo.fasta | grep ">" | wc -l)
	if [ "$count" -gt 5 ]
        then
		RAxMLmodel=$(cat ../../per_gene/EOG091G0H8F/EOG091G0H8F.best_model | grep "Best" | cut -d ":" -f 2 | tr -d '[:space:]')
                if [ "$(ls -1 | grep "^RAxML" | wc -l)" -ne 0 ]
		then
			rm RAxML*
		fi
        	raxml -f a -T 2 -m PROTGAMMA$RAxMLmodel         	-p 12345 -x 12345 -# 100         	-s ../../per_gene/EOG091G0H8F/ALICUT_EOG091G0H8F.clustalo.fasta -n EOG091G0H8F.clustalo.aln.ALICUT.$RAxMLmodel 		1> ../../per_gene/EOG091G0H8F/infer_single_ML.stdout.txt 2> ../../per_gene/EOG091G0H8F/infer_single_ML.stderr.txt
	else
		echo "fasta file per_gene/EOG091G0H8F/ALICUT_EOG091G0H8F.clustalo.fasta contains fewer than 5 sequences - skipped" > ../../per_gene/EOG091G0H8F/infer_single_ML.stdout.txt
		touch raxml.skipped
	fi
        touch ../../per_gene/EOG091G0H8F/EOG091G0H8F.raxml.done
        [0m
[Mon Jul  6 00:32:28 2020]
Finished job 921.
3247 of 3292 steps (99%) done

[Mon Jul  6 00:32:28 2020]
rule remove_empty:
    input: per_gene/EOG091G0ER1/ALICUT_EOG091G0ER1.clustalo.fasta
    output: per_gene/EOG091G0ER1/empty_check.done
    jobid: 1743
    wildcards: BUSCO=EOG091G0ER1


         if [ "$(cat per_gene/EOG091G0ER1/ALICUT_EOG091G0ER1.clustalo.fasta | grep -v ">" | sed 's/-//g' | grep "^$" | wc -l)" -gt 0 ]
         then
              cp per_gene/EOG091G0ER1/ALICUT_EOG091G0ER1.clustalo.fasta per_gene/EOG091G0ER1/ALICUT_EOG091G0ER1.clustalo.fasta.backup
              bash ../scripts/remove_empty.sh per_gene/EOG091G0ER1/ALICUT_EOG091G0ER1.clustalo.fasta.backup > per_gene/EOG091G0ER1/ALICUT_EOG091G0ER1.clustalo.fasta
         fi
         touch per_gene/EOG091G0ER1/empty_check.done
         
[Mon Jul  6 00:32:28 2020]
Finished job 1743.
3248 of 3292 steps (99%) done

[Mon Jul  6 00:32:28 2020]
rule find_best_model:
    input: per_gene/EOG091G0ER1/ALICUT_EOG091G0ER1.clustalo.fasta, per_gene/EOG091G0ER1/empty_check.done
    output: per_gene/EOG091G0ER1/EOG091G0ER1.best_model
    log: per_gene/EOG091G0ER1/find_best_model.stderr.txt
    jobid: 920
    wildcards: BUSCO=EOG091G0ER1
    threads: 2


        cd per_gene/EOG091G0ER1
        if [ ! -d find_best_model ]
        then
            mkdir find_best_model
        fi
        cd find_best_model
        ln -s ../../../per_gene/EOG091G0ER1/ALICUT_EOG091G0ER1.clustalo.fasta EOG091G0ER1.fasta
        ProteinModelSelection.pl EOG091G0ER1.fasta 1> ../../../per_gene/EOG091G0ER1/EOG091G0ER1.best_model 2> ../../../per_gene/EOG091G0ER1/find_best_model.stderr.txt
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/c0c09ee657b1e27f2c5687e0e9aa8d70.simg
[Mon Jul  6 00:32:36 2020]
Finished job 2974.
3249 of 3292 steps (99%) done

[Mon Jul  6 00:32:36 2020]
rule get_outgroups:
    input: per_gene/EOG091G0E11/EOG091G0E11.ingroup.fasta
    output: per_gene/EOG091G0E11/EOG091G0E11.orthodb.fasta, per_gene/EOG091G0E11/EOG091G0E11.outgroup.fasta
    log: per_gene/EOG091G0E11/get_outgroups.stdout.txt, per_gene/EOG091G0E11/get_outgroups.stderr.txt
    jobid: 2975
    wildcards: BUSCO=EOG091G0E11


        #download fastas from Orhtodb for BUSCO id
        for i in {1..5}
        do
             wget "http://www.orthodb.org/fasta?query=EOG091G0E11&level=33208" -O per_gene/EOG091G0E11/EOG091G0E11.orthodb.fasta 1> per_gene/EOG091G0E11/get_outgroups.stdout.txt 2> per_gene/EOG091G0E11/get_outgroups.stderr.txt && break || echo -e "try again ($i)" && sleep 15
        done

	#This is quick an dirty for now and just takes the first protein if there is more than one for an outgroup taxon
        bash ../scripts/download_outgroups.sh taxids.txt per_gene/EOG091G0E11/EOG091G0E11.orthodb.fasta > per_gene/EOG091G0E11/EOG091G0E11.outgroup.fasta
        
[Mon Jul  6 00:32:37 2020]
Finished job 2975.
3250 of 3292 steps (99%) done

[Mon Jul  6 00:32:37 2020]
rule join_groups:
    input: per_gene/EOG091G0E11/EOG091G0E11.ingroup.fasta, per_gene/EOG091G0E11/EOG091G0E11.outgroup.fasta
    output: per_gene/EOG091G0E11/EOG091G0E11.fasta
    jobid: 2311
    wildcards: BUSCO=EOG091G0E11


        cat per_gene/EOG091G0E11/EOG091G0E11.ingroup.fasta per_gene/EOG091G0E11/EOG091G0E11.outgroup.fasta > per_gene/EOG091G0E11/EOG091G0E11.fasta
        
[Mon Jul  6 00:32:37 2020]
Finished job 2311.
3251 of 3292 steps (99%) done

[Mon Jul  6 00:32:37 2020]
rule MSA:
    input: per_gene/EOG091G0E11/EOG091G0E11.fasta
    output: per_gene/EOG091G0E11/EOG091G0E11.clustalo.fasta
    log: per_gene/EOG091G0E11/MSA.stdout.txt, per_gene/EOG091G0E11/MSA.stderr.txt
    jobid: 1742
    wildcards: BUSCO=EOG091G0E11
    threads: 2


        clustalo -i per_gene/EOG091G0E11/EOG091G0E11.fasta -o per_gene/EOG091G0E11/EOG091G0E11.clustalo.fasta --threads=2 1> per_gene/EOG091G0E11/MSA.stdout.txt 2> per_gene/EOG091G0E11/MSA.stderr.txt
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/d68c9691725a7401923680874285c430.simg
[Mon Jul  6 00:32:40 2020]
Finished job 1742.
3252 of 3292 steps (99%) done

[Mon Jul  6 00:32:40 2020]
rule score_and_cut:
    input: per_gene/EOG091G0E11/EOG091G0E11.clustalo.fasta
    output: per_gene/EOG091G0E11/ALICUT_EOG091G0E11.clustalo.fasta
    jobid: 919
    wildcards: BUSCO=EOG091G0E11
    threads: 2


        cd per_gene/EOG091G0E11
        Aliscore.pl -N -r 200000000000000000 -i ../../per_gene/EOG091G0E11/EOG091G0E11.clustalo.fasta &> aliscore.log
        ALICUT.pl -s &> alicut.log
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/63c88c27a0fa300f57066b0ef65fefcb.simg
[Mon Jul  6 00:32:59 2020]
Finished job 919.
3253 of 3292 steps (99%) done

[Mon Jul  6 00:32:59 2020]
rule remove_empty:
    input: per_gene/EOG091G0E11/ALICUT_EOG091G0E11.clustalo.fasta
    output: per_gene/EOG091G0E11/empty_check.done
    jobid: 1741
    wildcards: BUSCO=EOG091G0E11


         if [ "$(cat per_gene/EOG091G0E11/ALICUT_EOG091G0E11.clustalo.fasta | grep -v ">" | sed 's/-//g' | grep "^$" | wc -l)" -gt 0 ]
         then
              cp per_gene/EOG091G0E11/ALICUT_EOG091G0E11.clustalo.fasta per_gene/EOG091G0E11/ALICUT_EOG091G0E11.clustalo.fasta.backup
              bash ../scripts/remove_empty.sh per_gene/EOG091G0E11/ALICUT_EOG091G0E11.clustalo.fasta.backup > per_gene/EOG091G0E11/ALICUT_EOG091G0E11.clustalo.fasta
         fi
         touch per_gene/EOG091G0E11/empty_check.done
         
[Mon Jul  6 00:33:00 2020]
Finished job 1741.
3254 of 3292 steps (99%) done

[Mon Jul  6 00:33:00 2020]
rule find_best_model:
    input: per_gene/EOG091G0E11/ALICUT_EOG091G0E11.clustalo.fasta, per_gene/EOG091G0E11/empty_check.done
    output: per_gene/EOG091G0E11/EOG091G0E11.best_model
    log: per_gene/EOG091G0E11/find_best_model.stderr.txt
    jobid: 918
    wildcards: BUSCO=EOG091G0E11
    threads: 2


        cd per_gene/EOG091G0E11
        if [ ! -d find_best_model ]
        then
            mkdir find_best_model
        fi
        cd find_best_model
        ln -s ../../../per_gene/EOG091G0E11/ALICUT_EOG091G0E11.clustalo.fasta EOG091G0E11.fasta
        ProteinModelSelection.pl EOG091G0E11.fasta 1> ../../../per_gene/EOG091G0E11/EOG091G0E11.best_model 2> ../../../per_gene/EOG091G0E11/find_best_model.stderr.txt
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/c0c09ee657b1e27f2c5687e0e9aa8d70.simg
[Mon Jul  6 00:33:02 2020]
Finished job 920.
3255 of 3292 steps (99%) done

[Mon Jul  6 00:33:02 2020]
rule infer_single_ML:
    input: per_gene/EOG091G0ER1/EOG091G0ER1.best_model, per_gene/EOG091G0ER1/ALICUT_EOG091G0ER1.clustalo.fasta
    output: per_gene/EOG091G0ER1/EOG091G0ER1.raxml.done
    log: per_gene/EOG091G0ER1/infer_single_ML.stdout.txt, per_gene/EOG091G0ER1/infer_single_ML.stderr.txt
    jobid: 254
    wildcards: BUSCO=EOG091G0ER1
    threads: 2


        cd per_gene/EOG091G0ER1
	count=$(cat ../../per_gene/EOG091G0ER1/ALICUT_EOG091G0ER1.clustalo.fasta | grep ">" | wc -l)
	if [ "$count" -gt 5 ]
        then
		RAxMLmodel=$(cat ../../per_gene/EOG091G0ER1/EOG091G0ER1.best_model | grep "Best" | cut -d ":" -f 2 | tr -d '[:space:]')
                if [ "$(ls -1 | grep "^RAxML" | wc -l)" -ne 0 ]
		then
			rm RAxML*
		fi
        	raxml -f a -T 2 -m PROTGAMMA$RAxMLmodel         	-p 12345 -x 12345 -# 100         	-s ../../per_gene/EOG091G0ER1/ALICUT_EOG091G0ER1.clustalo.fasta -n EOG091G0ER1.clustalo.aln.ALICUT.$RAxMLmodel 		1> ../../per_gene/EOG091G0ER1/infer_single_ML.stdout.txt 2> ../../per_gene/EOG091G0ER1/infer_single_ML.stderr.txt
	else
		echo "fasta file per_gene/EOG091G0ER1/ALICUT_EOG091G0ER1.clustalo.fasta contains fewer than 5 sequences - skipped" > ../../per_gene/EOG091G0ER1/infer_single_ML.stdout.txt
		touch raxml.skipped
	fi
        touch ../../per_gene/EOG091G0ER1/EOG091G0ER1.raxml.done
        
[33mJob counts:
	count	jobs
	1	infer_single_ML
	1[0m
[33m
        cd per_gene/EOG091G0ER1
	count=$(cat ../../per_gene/EOG091G0ER1/ALICUT_EOG091G0ER1.clustalo.fasta | grep ">" | wc -l)
	if [ "$count" -gt 5 ]
        then
		RAxMLmodel=$(cat ../../per_gene/EOG091G0ER1/EOG091G0ER1.best_model | grep "Best" | cut -d ":" -f 2 | tr -d '[:space:]')
                if [ "$(ls -1 | grep "^RAxML" | wc -l)" -ne 0 ]
		then
			rm RAxML*
		fi
        	raxml -f a -T 2 -m PROTGAMMA$RAxMLmodel         	-p 12345 -x 12345 -# 100         	-s ../../per_gene/EOG091G0ER1/ALICUT_EOG091G0ER1.clustalo.fasta -n EOG091G0ER1.clustalo.aln.ALICUT.$RAxMLmodel 		1> ../../per_gene/EOG091G0ER1/infer_single_ML.stdout.txt 2> ../../per_gene/EOG091G0ER1/infer_single_ML.stderr.txt
	else
		echo "fasta file per_gene/EOG091G0ER1/ALICUT_EOG091G0ER1.clustalo.fasta contains fewer than 5 sequences - skipped" > ../../per_gene/EOG091G0ER1/infer_single_ML.stdout.txt
		touch raxml.skipped
	fi
        touch ../../per_gene/EOG091G0ER1/EOG091G0ER1.raxml.done
        [0m
[Mon Jul  6 00:33:26 2020]
Finished job 353.
3256 of 3292 steps (99%) done

[Mon Jul  6 00:33:26 2020]
rule get_seqs:
    input: /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ingroup.txt, /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/outgroup.txt
    output: per_gene/EOG091G10CG/EOG091G10CG.ingroup.fasta
    log: per_gene/EOG091G10CG/get_seqs.stdout.txt, per_gene/EOG091G10CG/get_seqs.stderr.txt
    jobid: 2910
    wildcards: BUSCO=EOG091G10CG
    threads: 2


	basedir=$(pwd)
        cd per_gene/EOG091G10CG
        
        bash $basedir/../scripts/fetch_seqs.sh EOG091G10CG /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ingroup.txt /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/outgroup.txt 1> ../../per_gene/EOG091G10CG/get_seqs.stdout.txt 2> ../../per_gene/EOG091G10CG/get_seqs.stderr.txt
	mv EOG091G10CG.fasta $basedir/per_gene/EOG091G10CG/EOG091G10CG.ingroup.fasta
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/72476f9d9a5bd0627b4d721143a21354.simg
[Mon Jul  6 00:33:26 2020]
Finished job 918.
3257 of 3292 steps (99%) done

[Mon Jul  6 00:33:26 2020]
rule infer_single_ML:
    input: per_gene/EOG091G0E11/EOG091G0E11.best_model, per_gene/EOG091G0E11/ALICUT_EOG091G0E11.clustalo.fasta
    output: per_gene/EOG091G0E11/EOG091G0E11.raxml.done
    log: per_gene/EOG091G0E11/infer_single_ML.stdout.txt, per_gene/EOG091G0E11/infer_single_ML.stderr.txt
    jobid: 253
    wildcards: BUSCO=EOG091G0E11
    threads: 2


        cd per_gene/EOG091G0E11
	count=$(cat ../../per_gene/EOG091G0E11/ALICUT_EOG091G0E11.clustalo.fasta | grep ">" | wc -l)
	if [ "$count" -gt 5 ]
        then
		RAxMLmodel=$(cat ../../per_gene/EOG091G0E11/EOG091G0E11.best_model | grep "Best" | cut -d ":" -f 2 | tr -d '[:space:]')
                if [ "$(ls -1 | grep "^RAxML" | wc -l)" -ne 0 ]
		then
			rm RAxML*
		fi
        	raxml -f a -T 2 -m PROTGAMMA$RAxMLmodel         	-p 12345 -x 12345 -# 100         	-s ../../per_gene/EOG091G0E11/ALICUT_EOG091G0E11.clustalo.fasta -n EOG091G0E11.clustalo.aln.ALICUT.$RAxMLmodel 		1> ../../per_gene/EOG091G0E11/infer_single_ML.stdout.txt 2> ../../per_gene/EOG091G0E11/infer_single_ML.stderr.txt
	else
		echo "fasta file per_gene/EOG091G0E11/ALICUT_EOG091G0E11.clustalo.fasta contains fewer than 5 sequences - skipped" > ../../per_gene/EOG091G0E11/infer_single_ML.stdout.txt
		touch raxml.skipped
	fi
        touch ../../per_gene/EOG091G0E11/EOG091G0E11.raxml.done
        
[33mJob counts:
	count	jobs
	1	infer_single_ML
	1[0m
[33m
        cd per_gene/EOG091G0E11
	count=$(cat ../../per_gene/EOG091G0E11/ALICUT_EOG091G0E11.clustalo.fasta | grep ">" | wc -l)
	if [ "$count" -gt 5 ]
        then
		RAxMLmodel=$(cat ../../per_gene/EOG091G0E11/EOG091G0E11.best_model | grep "Best" | cut -d ":" -f 2 | tr -d '[:space:]')
                if [ "$(ls -1 | grep "^RAxML" | wc -l)" -ne 0 ]
		then
			rm RAxML*
		fi
        	raxml -f a -T 2 -m PROTGAMMA$RAxMLmodel         	-p 12345 -x 12345 -# 100         	-s ../../per_gene/EOG091G0E11/ALICUT_EOG091G0E11.clustalo.fasta -n EOG091G0E11.clustalo.aln.ALICUT.$RAxMLmodel 		1> ../../per_gene/EOG091G0E11/infer_single_ML.stdout.txt 2> ../../per_gene/EOG091G0E11/infer_single_ML.stderr.txt
	else
		echo "fasta file per_gene/EOG091G0E11/ALICUT_EOG091G0E11.clustalo.fasta contains fewer than 5 sequences - skipped" > ../../per_gene/EOG091G0E11/infer_single_ML.stdout.txt
		touch raxml.skipped
	fi
        touch ../../per_gene/EOG091G0E11/EOG091G0E11.raxml.done
        [0m
[Mon Jul  6 00:33:40 2020]
Finished job 2910.
3258 of 3292 steps (99%) done

[Mon Jul  6 00:33:40 2020]
rule get_outgroups:
    input: per_gene/EOG091G10CG/EOG091G10CG.ingroup.fasta
    output: per_gene/EOG091G10CG/EOG091G10CG.orthodb.fasta, per_gene/EOG091G10CG/EOG091G10CG.outgroup.fasta
    log: per_gene/EOG091G10CG/get_outgroups.stdout.txt, per_gene/EOG091G10CG/get_outgroups.stderr.txt
    jobid: 2911
    wildcards: BUSCO=EOG091G10CG


        #download fastas from Orhtodb for BUSCO id
        for i in {1..5}
        do
             wget "http://www.orthodb.org/fasta?query=EOG091G10CG&level=33208" -O per_gene/EOG091G10CG/EOG091G10CG.orthodb.fasta 1> per_gene/EOG091G10CG/get_outgroups.stdout.txt 2> per_gene/EOG091G10CG/get_outgroups.stderr.txt && break || echo -e "try again ($i)" && sleep 15
        done

	#This is quick an dirty for now and just takes the first protein if there is more than one for an outgroup taxon
        bash ../scripts/download_outgroups.sh taxids.txt per_gene/EOG091G10CG/EOG091G10CG.orthodb.fasta > per_gene/EOG091G10CG/EOG091G10CG.outgroup.fasta
        
[Mon Jul  6 00:33:42 2020]
Finished job 2911.
3259 of 3292 steps (99%) done

[Mon Jul  6 00:33:42 2020]
rule join_groups:
    input: per_gene/EOG091G10CG/EOG091G10CG.ingroup.fasta, per_gene/EOG091G10CG/EOG091G10CG.outgroup.fasta
    output: per_gene/EOG091G10CG/EOG091G10CG.fasta
    jobid: 2279
    wildcards: BUSCO=EOG091G10CG


        cat per_gene/EOG091G10CG/EOG091G10CG.ingroup.fasta per_gene/EOG091G10CG/EOG091G10CG.outgroup.fasta > per_gene/EOG091G10CG/EOG091G10CG.fasta
        
[Mon Jul  6 00:33:42 2020]
Finished job 2279.
3260 of 3292 steps (99%) done

[Mon Jul  6 00:33:42 2020]
rule MSA:
    input: per_gene/EOG091G10CG/EOG091G10CG.fasta
    output: per_gene/EOG091G10CG/EOG091G10CG.clustalo.fasta
    log: per_gene/EOG091G10CG/MSA.stdout.txt, per_gene/EOG091G10CG/MSA.stderr.txt
    jobid: 1678
    wildcards: BUSCO=EOG091G10CG
    threads: 2


        clustalo -i per_gene/EOG091G10CG/EOG091G10CG.fasta -o per_gene/EOG091G10CG/EOG091G10CG.clustalo.fasta --threads=2 1> per_gene/EOG091G10CG/MSA.stdout.txt 2> per_gene/EOG091G10CG/MSA.stderr.txt
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/d68c9691725a7401923680874285c430.simg
[Mon Jul  6 00:33:42 2020]
Finished job 1678.
3261 of 3292 steps (99%) done

[Mon Jul  6 00:33:42 2020]
rule score_and_cut:
    input: per_gene/EOG091G10CG/EOG091G10CG.clustalo.fasta
    output: per_gene/EOG091G10CG/ALICUT_EOG091G10CG.clustalo.fasta
    jobid: 855
    wildcards: BUSCO=EOG091G10CG
    threads: 2


        cd per_gene/EOG091G10CG
        Aliscore.pl -N -r 200000000000000000 -i ../../per_gene/EOG091G10CG/EOG091G10CG.clustalo.fasta &> aliscore.log
        ALICUT.pl -s &> alicut.log
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/63c88c27a0fa300f57066b0ef65fefcb.simg
[Mon Jul  6 00:33:49 2020]
Finished job 295.
3262 of 3292 steps (99%) done

[Mon Jul  6 00:33:49 2020]
rule get_seqs:
    input: /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ingroup.txt, /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/outgroup.txt
    output: per_gene/EOG091G0B2N/EOG091G0B2N.ingroup.fasta
    log: per_gene/EOG091G0B2N/get_seqs.stdout.txt, per_gene/EOG091G0B2N/get_seqs.stderr.txt
    jobid: 2630
    wildcards: BUSCO=EOG091G0B2N
    threads: 2


	basedir=$(pwd)
        cd per_gene/EOG091G0B2N
        
        bash $basedir/../scripts/fetch_seqs.sh EOG091G0B2N /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/ingroup.txt /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/outgroup.txt 1> ../../per_gene/EOG091G0B2N/get_seqs.stdout.txt 2> ../../per_gene/EOG091G0B2N/get_seqs.stderr.txt
	mv EOG091G0B2N.fasta $basedir/per_gene/EOG091G0B2N/EOG091G0B2N.ingroup.fasta
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/72476f9d9a5bd0627b4d721143a21354.simg
[Mon Jul  6 00:33:52 2020]
Finished job 855.
3263 of 3292 steps (99%) done

[Mon Jul  6 00:33:52 2020]
rule remove_empty:
    input: per_gene/EOG091G10CG/ALICUT_EOG091G10CG.clustalo.fasta
    output: per_gene/EOG091G10CG/empty_check.done
    jobid: 1677
    wildcards: BUSCO=EOG091G10CG


         if [ "$(cat per_gene/EOG091G10CG/ALICUT_EOG091G10CG.clustalo.fasta | grep -v ">" | sed 's/-//g' | grep "^$" | wc -l)" -gt 0 ]
         then
              cp per_gene/EOG091G10CG/ALICUT_EOG091G10CG.clustalo.fasta per_gene/EOG091G10CG/ALICUT_EOG091G10CG.clustalo.fasta.backup
              bash ../scripts/remove_empty.sh per_gene/EOG091G10CG/ALICUT_EOG091G10CG.clustalo.fasta.backup > per_gene/EOG091G10CG/ALICUT_EOG091G10CG.clustalo.fasta
         fi
         touch per_gene/EOG091G10CG/empty_check.done
         
[Mon Jul  6 00:33:52 2020]
Finished job 1677.
3264 of 3292 steps (99%) done

[Mon Jul  6 00:33:52 2020]
rule find_best_model:
    input: per_gene/EOG091G10CG/ALICUT_EOG091G10CG.clustalo.fasta, per_gene/EOG091G10CG/empty_check.done
    output: per_gene/EOG091G10CG/EOG091G10CG.best_model
    log: per_gene/EOG091G10CG/find_best_model.stderr.txt
    jobid: 854
    wildcards: BUSCO=EOG091G10CG
    threads: 2


        cd per_gene/EOG091G10CG
        if [ ! -d find_best_model ]
        then
            mkdir find_best_model
        fi
        cd find_best_model
        ln -s ../../../per_gene/EOG091G10CG/ALICUT_EOG091G10CG.clustalo.fasta EOG091G10CG.fasta
        ProteinModelSelection.pl EOG091G10CG.fasta 1> ../../../per_gene/EOG091G10CG/EOG091G10CG.best_model 2> ../../../per_gene/EOG091G10CG/find_best_model.stderr.txt
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/c0c09ee657b1e27f2c5687e0e9aa8d70.simg
[Mon Jul  6 00:34:16 2020]
Finished job 2630.
3265 of 3292 steps (99%) done

[Mon Jul  6 00:34:16 2020]
rule get_outgroups:
    input: per_gene/EOG091G0B2N/EOG091G0B2N.ingroup.fasta
    output: per_gene/EOG091G0B2N/EOG091G0B2N.orthodb.fasta, per_gene/EOG091G0B2N/EOG091G0B2N.outgroup.fasta
    log: per_gene/EOG091G0B2N/get_outgroups.stdout.txt, per_gene/EOG091G0B2N/get_outgroups.stderr.txt
    jobid: 2631
    wildcards: BUSCO=EOG091G0B2N


        #download fastas from Orhtodb for BUSCO id
        for i in {1..5}
        do
             wget "http://www.orthodb.org/fasta?query=EOG091G0B2N&level=33208" -O per_gene/EOG091G0B2N/EOG091G0B2N.orthodb.fasta 1> per_gene/EOG091G0B2N/get_outgroups.stdout.txt 2> per_gene/EOG091G0B2N/get_outgroups.stderr.txt && break || echo -e "try again ($i)" && sleep 15
        done

	#This is quick an dirty for now and just takes the first protein if there is more than one for an outgroup taxon
        bash ../scripts/download_outgroups.sh taxids.txt per_gene/EOG091G0B2N/EOG091G0B2N.orthodb.fasta > per_gene/EOG091G0B2N/EOG091G0B2N.outgroup.fasta
        
[Mon Jul  6 00:34:18 2020]
Finished job 2631.
3266 of 3292 steps (99%) done

[Mon Jul  6 00:34:18 2020]
rule join_groups:
    input: per_gene/EOG091G0B2N/EOG091G0B2N.ingroup.fasta, per_gene/EOG091G0B2N/EOG091G0B2N.outgroup.fasta
    output: per_gene/EOG091G0B2N/EOG091G0B2N.fasta
    jobid: 2139
    wildcards: BUSCO=EOG091G0B2N


        cat per_gene/EOG091G0B2N/EOG091G0B2N.ingroup.fasta per_gene/EOG091G0B2N/EOG091G0B2N.outgroup.fasta > per_gene/EOG091G0B2N/EOG091G0B2N.fasta
        
[Mon Jul  6 00:34:18 2020]
Finished job 2139.
3267 of 3292 steps (99%) done

[Mon Jul  6 00:34:18 2020]
rule MSA:
    input: per_gene/EOG091G0B2N/EOG091G0B2N.fasta
    output: per_gene/EOG091G0B2N/EOG091G0B2N.clustalo.fasta
    log: per_gene/EOG091G0B2N/MSA.stdout.txt, per_gene/EOG091G0B2N/MSA.stderr.txt
    jobid: 1398
    wildcards: BUSCO=EOG091G0B2N
    threads: 2


        clustalo -i per_gene/EOG091G0B2N/EOG091G0B2N.fasta -o per_gene/EOG091G0B2N/EOG091G0B2N.clustalo.fasta --threads=2 1> per_gene/EOG091G0B2N/MSA.stdout.txt 2> per_gene/EOG091G0B2N/MSA.stderr.txt
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/d68c9691725a7401923680874285c430.simg
[Mon Jul  6 00:34:20 2020]
Finished job 1398.
3268 of 3292 steps (99%) done

[Mon Jul  6 00:34:20 2020]
rule score_and_cut:
    input: per_gene/EOG091G0B2N/EOG091G0B2N.clustalo.fasta
    output: per_gene/EOG091G0B2N/ALICUT_EOG091G0B2N.clustalo.fasta
    jobid: 575
    wildcards: BUSCO=EOG091G0B2N
    threads: 2


        cd per_gene/EOG091G0B2N
        Aliscore.pl -N -r 200000000000000000 -i ../../per_gene/EOG091G0B2N/EOG091G0B2N.clustalo.fasta &> aliscore.log
        ALICUT.pl -s &> alicut.log
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/63c88c27a0fa300f57066b0ef65fefcb.simg
[Mon Jul  6 00:34:26 2020]
Finished job 375.
3269 of 3292 steps (99%) done
[Mon Jul  6 00:34:30 2020]
Finished job 575.
3270 of 3292 steps (99%) done

[Mon Jul  6 00:34:30 2020]
rule remove_empty:
    input: per_gene/EOG091G0B2N/ALICUT_EOG091G0B2N.clustalo.fasta
    output: per_gene/EOG091G0B2N/empty_check.done
    jobid: 1397
    wildcards: BUSCO=EOG091G0B2N


         if [ "$(cat per_gene/EOG091G0B2N/ALICUT_EOG091G0B2N.clustalo.fasta | grep -v ">" | sed 's/-//g' | grep "^$" | wc -l)" -gt 0 ]
         then
              cp per_gene/EOG091G0B2N/ALICUT_EOG091G0B2N.clustalo.fasta per_gene/EOG091G0B2N/ALICUT_EOG091G0B2N.clustalo.fasta.backup
              bash ../scripts/remove_empty.sh per_gene/EOG091G0B2N/ALICUT_EOG091G0B2N.clustalo.fasta.backup > per_gene/EOG091G0B2N/ALICUT_EOG091G0B2N.clustalo.fasta
         fi
         touch per_gene/EOG091G0B2N/empty_check.done
         
[Mon Jul  6 00:34:30 2020]
Finished job 1397.
3271 of 3292 steps (99%) done

[Mon Jul  6 00:34:30 2020]
rule find_best_model:
    input: per_gene/EOG091G0B2N/ALICUT_EOG091G0B2N.clustalo.fasta, per_gene/EOG091G0B2N/empty_check.done
    output: per_gene/EOG091G0B2N/EOG091G0B2N.best_model
    log: per_gene/EOG091G0B2N/find_best_model.stderr.txt
    jobid: 574
    wildcards: BUSCO=EOG091G0B2N
    threads: 2


        cd per_gene/EOG091G0B2N
        if [ ! -d find_best_model ]
        then
            mkdir find_best_model
        fi
        cd find_best_model
        ln -s ../../../per_gene/EOG091G0B2N/ALICUT_EOG091G0B2N.clustalo.fasta EOG091G0B2N.fasta
        ProteinModelSelection.pl EOG091G0B2N.fasta 1> ../../../per_gene/EOG091G0B2N/EOG091G0B2N.best_model 2> ../../../per_gene/EOG091G0B2N/find_best_model.stderr.txt
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/c0c09ee657b1e27f2c5687e0e9aa8d70.simg
[Mon Jul  6 00:34:40 2020]
Finished job 854.
3272 of 3292 steps (99%) done

[Mon Jul  6 00:34:40 2020]
rule infer_single_ML:
    input: per_gene/EOG091G10CG/EOG091G10CG.best_model, per_gene/EOG091G10CG/ALICUT_EOG091G10CG.clustalo.fasta
    output: per_gene/EOG091G10CG/EOG091G10CG.raxml.done
    log: per_gene/EOG091G10CG/infer_single_ML.stdout.txt, per_gene/EOG091G10CG/infer_single_ML.stderr.txt
    jobid: 221
    wildcards: BUSCO=EOG091G10CG
    threads: 2


        cd per_gene/EOG091G10CG
	count=$(cat ../../per_gene/EOG091G10CG/ALICUT_EOG091G10CG.clustalo.fasta | grep ">" | wc -l)
	if [ "$count" -gt 5 ]
        then
		RAxMLmodel=$(cat ../../per_gene/EOG091G10CG/EOG091G10CG.best_model | grep "Best" | cut -d ":" -f 2 | tr -d '[:space:]')
                if [ "$(ls -1 | grep "^RAxML" | wc -l)" -ne 0 ]
		then
			rm RAxML*
		fi
        	raxml -f a -T 2 -m PROTGAMMA$RAxMLmodel         	-p 12345 -x 12345 -# 100         	-s ../../per_gene/EOG091G10CG/ALICUT_EOG091G10CG.clustalo.fasta -n EOG091G10CG.clustalo.aln.ALICUT.$RAxMLmodel 		1> ../../per_gene/EOG091G10CG/infer_single_ML.stdout.txt 2> ../../per_gene/EOG091G10CG/infer_single_ML.stderr.txt
	else
		echo "fasta file per_gene/EOG091G10CG/ALICUT_EOG091G10CG.clustalo.fasta contains fewer than 5 sequences - skipped" > ../../per_gene/EOG091G10CG/infer_single_ML.stdout.txt
		touch raxml.skipped
	fi
        touch ../../per_gene/EOG091G10CG/EOG091G10CG.raxml.done
        
[33mJob counts:
	count	jobs
	1	infer_single_ML
	1[0m
[33m
        cd per_gene/EOG091G10CG
	count=$(cat ../../per_gene/EOG091G10CG/ALICUT_EOG091G10CG.clustalo.fasta | grep ">" | wc -l)
	if [ "$count" -gt 5 ]
        then
		RAxMLmodel=$(cat ../../per_gene/EOG091G10CG/EOG091G10CG.best_model | grep "Best" | cut -d ":" -f 2 | tr -d '[:space:]')
                if [ "$(ls -1 | grep "^RAxML" | wc -l)" -ne 0 ]
		then
			rm RAxML*
		fi
        	raxml -f a -T 2 -m PROTGAMMA$RAxMLmodel         	-p 12345 -x 12345 -# 100         	-s ../../per_gene/EOG091G10CG/ALICUT_EOG091G10CG.clustalo.fasta -n EOG091G10CG.clustalo.aln.ALICUT.$RAxMLmodel 		1> ../../per_gene/EOG091G10CG/infer_single_ML.stdout.txt 2> ../../per_gene/EOG091G10CG/infer_single_ML.stderr.txt
	else
		echo "fasta file per_gene/EOG091G10CG/ALICUT_EOG091G10CG.clustalo.fasta contains fewer than 5 sequences - skipped" > ../../per_gene/EOG091G10CG/infer_single_ML.stdout.txt
		touch raxml.skipped
	fi
        touch ../../per_gene/EOG091G10CG/EOG091G10CG.raxml.done
        [0m
[Mon Jul  6 00:35:07 2020]
Finished job 574.
3273 of 3292 steps (99%) done

[Mon Jul  6 00:35:07 2020]
rule infer_single_ML:
    input: per_gene/EOG091G0B2N/EOG091G0B2N.best_model, per_gene/EOG091G0B2N/ALICUT_EOG091G0B2N.clustalo.fasta
    output: per_gene/EOG091G0B2N/EOG091G0B2N.raxml.done
    log: per_gene/EOG091G0B2N/infer_single_ML.stdout.txt, per_gene/EOG091G0B2N/infer_single_ML.stderr.txt
    jobid: 81
    wildcards: BUSCO=EOG091G0B2N
    threads: 2


        cd per_gene/EOG091G0B2N
	count=$(cat ../../per_gene/EOG091G0B2N/ALICUT_EOG091G0B2N.clustalo.fasta | grep ">" | wc -l)
	if [ "$count" -gt 5 ]
        then
		RAxMLmodel=$(cat ../../per_gene/EOG091G0B2N/EOG091G0B2N.best_model | grep "Best" | cut -d ":" -f 2 | tr -d '[:space:]')
                if [ "$(ls -1 | grep "^RAxML" | wc -l)" -ne 0 ]
		then
			rm RAxML*
		fi
        	raxml -f a -T 2 -m PROTGAMMA$RAxMLmodel         	-p 12345 -x 12345 -# 100         	-s ../../per_gene/EOG091G0B2N/ALICUT_EOG091G0B2N.clustalo.fasta -n EOG091G0B2N.clustalo.aln.ALICUT.$RAxMLmodel 		1> ../../per_gene/EOG091G0B2N/infer_single_ML.stdout.txt 2> ../../per_gene/EOG091G0B2N/infer_single_ML.stderr.txt
	else
		echo "fasta file per_gene/EOG091G0B2N/ALICUT_EOG091G0B2N.clustalo.fasta contains fewer than 5 sequences - skipped" > ../../per_gene/EOG091G0B2N/infer_single_ML.stdout.txt
		touch raxml.skipped
	fi
        touch ../../per_gene/EOG091G0B2N/EOG091G0B2N.raxml.done
        
[33mJob counts:
	count	jobs
	1	infer_single_ML
	1[0m
[33m
        cd per_gene/EOG091G0B2N
	count=$(cat ../../per_gene/EOG091G0B2N/ALICUT_EOG091G0B2N.clustalo.fasta | grep ">" | wc -l)
	if [ "$count" -gt 5 ]
        then
		RAxMLmodel=$(cat ../../per_gene/EOG091G0B2N/EOG091G0B2N.best_model | grep "Best" | cut -d ":" -f 2 | tr -d '[:space:]')
                if [ "$(ls -1 | grep "^RAxML" | wc -l)" -ne 0 ]
		then
			rm RAxML*
		fi
        	raxml -f a -T 2 -m PROTGAMMA$RAxMLmodel         	-p 12345 -x 12345 -# 100         	-s ../../per_gene/EOG091G0B2N/ALICUT_EOG091G0B2N.clustalo.fasta -n EOG091G0B2N.clustalo.aln.ALICUT.$RAxMLmodel 		1> ../../per_gene/EOG091G0B2N/infer_single_ML.stdout.txt 2> ../../per_gene/EOG091G0B2N/infer_single_ML.stderr.txt
	else
		echo "fasta file per_gene/EOG091G0B2N/ALICUT_EOG091G0B2N.clustalo.fasta contains fewer than 5 sequences - skipped" > ../../per_gene/EOG091G0B2N/infer_single_ML.stdout.txt
		touch raxml.skipped
	fi
        touch ../../per_gene/EOG091G0B2N/EOG091G0B2N.raxml.done
        [0m
[Mon Jul  6 00:35:13 2020]
Finished job 360.
3274 of 3292 steps (99%) done
[Mon Jul  6 00:35:36 2020]
Finished job 361.
3275 of 3292 steps (99%) done
[Mon Jul  6 00:35:49 2020]
Finished job 310.
3276 of 3292 steps (100%) done
[Mon Jul  6 00:35:52 2020]
Finished job 179.
3277 of 3292 steps (100%) done
[Mon Jul  6 00:36:02 2020]
Finished job 141.
3278 of 3292 steps (100%) done
[Mon Jul  6 00:36:07 2020]
Finished job 341.
3279 of 3292 steps (100%) done
[Mon Jul  6 00:36:24 2020]
Finished job 369.
3280 of 3292 steps (100%) done
[Mon Jul  6 00:36:29 2020]
Finished job 311.
3281 of 3292 steps (100%) done
[Mon Jul  6 00:36:49 2020]
Finished job 221.
3282 of 3292 steps (100%) done
[Mon Jul  6 00:37:37 2020]
Finished job 253.
3283 of 3292 steps (100%) done
[Mon Jul  6 00:37:46 2020]
Finished job 174.
3284 of 3292 steps (100%) done
[Mon Jul  6 00:38:06 2020]
Finished job 254.
3285 of 3292 steps (100%) done
[Mon Jul  6 00:38:25 2020]
Finished job 118.
3286 of 3292 steps (100%) done
[Mon Jul  6 00:39:44 2020]
Finished job 48.
3287 of 3292 steps (100%) done
[Mon Jul  6 00:40:46 2020]
Finished job 81.
3288 of 3292 steps (100%) done

[Mon Jul  6 00:40:47 2020]
rule post_filter:
    input: per_gene/EOG091G00Q0/EOG091G00Q0.raxml.done, per_gene/EOG091G00UD/EOG091G00UD.raxml.done, per_gene/EOG091G00Z3/EOG091G00Z3.raxml.done, per_gene/EOG091G011X/EOG091G011X.raxml.done, per_gene/EOG091G017G/EOG091G017G.raxml.done, per_gene/EOG091G017T/EOG091G017T.raxml.done, per_gene/EOG091G01EW/EOG091G01EW.raxml.done, per_gene/EOG091G01IW/EOG091G01IW.raxml.done, per_gene/EOG091G01TH/EOG091G01TH.raxml.done, per_gene/EOG091G01XI/EOG091G01XI.raxml.done, per_gene/EOG091G027G/EOG091G027G.raxml.done, per_gene/EOG091G02LY/EOG091G02LY.raxml.done, per_gene/EOG091G02O5/EOG091G02O5.raxml.done, per_gene/EOG091G02V5/EOG091G02V5.raxml.done, per_gene/EOG091G02ZI/EOG091G02ZI.raxml.done, per_gene/EOG091G0307/EOG091G0307.raxml.done, per_gene/EOG091G0321/EOG091G0321.raxml.done, per_gene/EOG091G03AN/EOG091G03AN.raxml.done, per_gene/EOG091G03B9/EOG091G03B9.raxml.done, per_gene/EOG091G03I1/EOG091G03I1.raxml.done, per_gene/EOG091G03JF/EOG091G03JF.raxml.done, per_gene/EOG091G03M4/EOG091G03M4.raxml.done, per_gene/EOG091G03PD/EOG091G03PD.raxml.done, per_gene/EOG091G03RW/EOG091G03RW.raxml.done, per_gene/EOG091G03TZ/EOG091G03TZ.raxml.done, per_gene/EOG091G040G/EOG091G040G.raxml.done, per_gene/EOG091G046Y/EOG091G046Y.raxml.done, per_gene/EOG091G04EX/EOG091G04EX.raxml.done, per_gene/EOG091G04GW/EOG091G04GW.raxml.done, per_gene/EOG091G0530/EOG091G0530.raxml.done, per_gene/EOG091G057L/EOG091G057L.raxml.done, per_gene/EOG091G05AA/EOG091G05AA.raxml.done, per_gene/EOG091G05AH/EOG091G05AH.raxml.done, per_gene/EOG091G05EU/EOG091G05EU.raxml.done, per_gene/EOG091G05GZ/EOG091G05GZ.raxml.done, per_gene/EOG091G05K5/EOG091G05K5.raxml.done, per_gene/EOG091G05KR/EOG091G05KR.raxml.done, per_gene/EOG091G05NK/EOG091G05NK.raxml.done, per_gene/EOG091G05NZ/EOG091G05NZ.raxml.done, per_gene/EOG091G05OR/EOG091G05OR.raxml.done, per_gene/EOG091G05OW/EOG091G05OW.raxml.done, per_gene/EOG091G05Q6/EOG091G05Q6.raxml.done, per_gene/EOG091G05YC/EOG091G05YC.raxml.done, per_gene/EOG091G06HP/EOG091G06HP.raxml.done, per_gene/EOG091G06M8/EOG091G06M8.raxml.done, per_gene/EOG091G06ON/EOG091G06ON.raxml.done, per_gene/EOG091G06QP/EOG091G06QP.raxml.done, per_gene/EOG091G06S3/EOG091G06S3.raxml.done, per_gene/EOG091G06U0/EOG091G06U0.raxml.done, per_gene/EOG091G06Y7/EOG091G06Y7.raxml.done, per_gene/EOG091G073F/EOG091G073F.raxml.done, per_gene/EOG091G074U/EOG091G074U.raxml.done, per_gene/EOG091G075F/EOG091G075F.raxml.done, per_gene/EOG091G07IK/EOG091G07IK.raxml.done, per_gene/EOG091G07NJ/EOG091G07NJ.raxml.done, per_gene/EOG091G07OD/EOG091G07OD.raxml.done, per_gene/EOG091G07S9/EOG091G07S9.raxml.done, per_gene/EOG091G07VQ/EOG091G07VQ.raxml.done, per_gene/EOG091G07Z5/EOG091G07Z5.raxml.done, per_gene/EOG091G085U/EOG091G085U.raxml.done, per_gene/EOG091G08BK/EOG091G08BK.raxml.done, per_gene/EOG091G08LT/EOG091G08LT.raxml.done, per_gene/EOG091G08O3/EOG091G08O3.raxml.done, per_gene/EOG091G08RU/EOG091G08RU.raxml.done, per_gene/EOG091G08ZG/EOG091G08ZG.raxml.done, per_gene/EOG091G0977/EOG091G0977.raxml.done, per_gene/EOG091G0990/EOG091G0990.raxml.done, per_gene/EOG091G09GO/EOG091G09GO.raxml.done, per_gene/EOG091G09HR/EOG091G09HR.raxml.done, per_gene/EOG091G09MU/EOG091G09MU.raxml.done, per_gene/EOG091G09RJ/EOG091G09RJ.raxml.done, per_gene/EOG091G0A19/EOG091G0A19.raxml.done, per_gene/EOG091G0A2I/EOG091G0A2I.raxml.done, per_gene/EOG091G0A2L/EOG091G0A2L.raxml.done, per_gene/EOG091G0A98/EOG091G0A98.raxml.done, per_gene/EOG091G0AE9/EOG091G0AE9.raxml.done, per_gene/EOG091G0AFP/EOG091G0AFP.raxml.done, per_gene/EOG091G0AKW/EOG091G0AKW.raxml.done, per_gene/EOG091G0AQA/EOG091G0AQA.raxml.done, per_gene/EOG091G0B27/EOG091G0B27.raxml.done, per_gene/EOG091G0B2N/EOG091G0B2N.raxml.done, per_gene/EOG091G0BHP/EOG091G0BHP.raxml.done, per_gene/EOG091G0BHV/EOG091G0BHV.raxml.done, per_gene/EOG091G0BKZ/EOG091G0BKZ.raxml.done, per_gene/EOG091G0BUD/EOG091G0BUD.raxml.done, per_gene/EOG091G0C84/EOG091G0C84.raxml.done, per_gene/EOG091G0C8H/EOG091G0C8H.raxml.done, per_gene/EOG091G0CAR/EOG091G0CAR.raxml.done, per_gene/EOG091G0CEW/EOG091G0CEW.raxml.done, per_gene/EOG091G0CFP/EOG091G0CFP.raxml.done, per_gene/EOG091G0CNT/EOG091G0CNT.raxml.done, per_gene/EOG091G0CTG/EOG091G0CTG.raxml.done, per_gene/EOG091G0CZX/EOG091G0CZX.raxml.done, per_gene/EOG091G0D26/EOG091G0D26.raxml.done, per_gene/EOG091G0DTP/EOG091G0DTP.raxml.done, per_gene/EOG091G0DVQ/EOG091G0DVQ.raxml.done, per_gene/EOG091G0DXV/EOG091G0DXV.raxml.done, per_gene/EOG091G0DYW/EOG091G0DYW.raxml.done, per_gene/EOG091G0E06/EOG091G0E06.raxml.done, per_gene/EOG091G0EH8/EOG091G0EH8.raxml.done, per_gene/EOG091G0EHZ/EOG091G0EHZ.raxml.done, per_gene/EOG091G0ES6/EOG091G0ES6.raxml.done, per_gene/EOG091G0EVK/EOG091G0EVK.raxml.done, per_gene/EOG091G0EZO/EOG091G0EZO.raxml.done, per_gene/EOG091G0FIJ/EOG091G0FIJ.raxml.done, per_gene/EOG091G0G3M/EOG091G0G3M.raxml.done, per_gene/EOG091G0G6C/EOG091G0G6C.raxml.done, per_gene/EOG091G0G6Z/EOG091G0G6Z.raxml.done, per_gene/EOG091G0G8R/EOG091G0G8R.raxml.done, per_gene/EOG091G0GDF/EOG091G0GDF.raxml.done, per_gene/EOG091G0GKH/EOG091G0GKH.raxml.done, per_gene/EOG091G0GOU/EOG091G0GOU.raxml.done, per_gene/EOG091G0GQO/EOG091G0GQO.raxml.done, per_gene/EOG091G0GVZ/EOG091G0GVZ.raxml.done, per_gene/EOG091G0GWO/EOG091G0GWO.raxml.done, per_gene/EOG091G0H62/EOG091G0H62.raxml.done, per_gene/EOG091G0H6A/EOG091G0H6A.raxml.done, per_gene/EOG091G0H8F/EOG091G0H8F.raxml.done, per_gene/EOG091G0HXI/EOG091G0HXI.raxml.done, per_gene/EOG091G0I8J/EOG091G0I8J.raxml.done, per_gene/EOG091G0IDP/EOG091G0IDP.raxml.done, per_gene/EOG091G0II3/EOG091G0II3.raxml.done, per_gene/EOG091G0ILG/EOG091G0ILG.raxml.done, per_gene/EOG091G0IQ7/EOG091G0IQ7.raxml.done, per_gene/EOG091G0ITS/EOG091G0ITS.raxml.done, per_gene/EOG091G0IZX/EOG091G0IZX.raxml.done, per_gene/EOG091G0J14/EOG091G0J14.raxml.done, per_gene/EOG091G0J2W/EOG091G0J2W.raxml.done, per_gene/EOG091G0JEC/EOG091G0JEC.raxml.done, per_gene/EOG091G0JI1/EOG091G0JI1.raxml.done, per_gene/EOG091G0K2R/EOG091G0K2R.raxml.done, per_gene/EOG091G0K82/EOG091G0K82.raxml.done, per_gene/EOG091G0K95/EOG091G0K95.raxml.done, per_gene/EOG091G0K9M/EOG091G0K9M.raxml.done, per_gene/EOG091G0KGO/EOG091G0KGO.raxml.done, per_gene/EOG091G0KRB/EOG091G0KRB.raxml.done, per_gene/EOG091G0KSX/EOG091G0KSX.raxml.done, per_gene/EOG091G0KVW/EOG091G0KVW.raxml.done, per_gene/EOG091G0LKE/EOG091G0LKE.raxml.done, per_gene/EOG091G0LP5/EOG091G0LP5.raxml.done, per_gene/EOG091G0LS0/EOG091G0LS0.raxml.done, per_gene/EOG091G0LT1/EOG091G0LT1.raxml.done, per_gene/EOG091G0LZ0/EOG091G0LZ0.raxml.done, per_gene/EOG091G0M12/EOG091G0M12.raxml.done, per_gene/EOG091G0M22/EOG091G0M22.raxml.done, per_gene/EOG091G0M4K/EOG091G0M4K.raxml.done, per_gene/EOG091G0MDG/EOG091G0MDG.raxml.done, per_gene/EOG091G0MDT/EOG091G0MDT.raxml.done, per_gene/EOG091G0MKY/EOG091G0MKY.raxml.done, per_gene/EOG091G0MP6/EOG091G0MP6.raxml.done, per_gene/EOG091G0MSB/EOG091G0MSB.raxml.done, per_gene/EOG091G0MVL/EOG091G0MVL.raxml.done, per_gene/EOG091G0MY0/EOG091G0MY0.raxml.done, per_gene/EOG091G0MY8/EOG091G0MY8.raxml.done, per_gene/EOG091G0MZC/EOG091G0MZC.raxml.done, per_gene/EOG091G0N0A/EOG091G0N0A.raxml.done, per_gene/EOG091G0N0R/EOG091G0N0R.raxml.done, per_gene/EOG091G0NK3/EOG091G0NK3.raxml.done, per_gene/EOG091G0NKD/EOG091G0NKD.raxml.done, per_gene/EOG091G0NMJ/EOG091G0NMJ.raxml.done, per_gene/EOG091G0NNO/EOG091G0NNO.raxml.done, per_gene/EOG091G0NVA/EOG091G0NVA.raxml.done, per_gene/EOG091G0O6E/EOG091G0O6E.raxml.done, per_gene/EOG091G0OHF/EOG091G0OHF.raxml.done, per_gene/EOG091G0OWI/EOG091G0OWI.raxml.done, per_gene/EOG091G0PAG/EOG091G0PAG.raxml.done, per_gene/EOG091G0PEI/EOG091G0PEI.raxml.done, per_gene/EOG091G0PHL/EOG091G0PHL.raxml.done, per_gene/EOG091G0PNO/EOG091G0PNO.raxml.done, per_gene/EOG091G0QE1/EOG091G0QE1.raxml.done, per_gene/EOG091G0QGZ/EOG091G0QGZ.raxml.done, per_gene/EOG091G0QIP/EOG091G0QIP.raxml.done, per_gene/EOG091G0QJA/EOG091G0QJA.raxml.done, per_gene/EOG091G0QKK/EOG091G0QKK.raxml.done, per_gene/EOG091G0QPG/EOG091G0QPG.raxml.done, per_gene/EOG091G0QRW/EOG091G0QRW.raxml.done, per_gene/EOG091G0QUH/EOG091G0QUH.raxml.done, per_gene/EOG091G0QW9/EOG091G0QW9.raxml.done, per_gene/EOG091G0QZ2/EOG091G0QZ2.raxml.done, per_gene/EOG091G0R04/EOG091G0R04.raxml.done, per_gene/EOG091G0R21/EOG091G0R21.raxml.done, per_gene/EOG091G0RA2/EOG091G0RA2.raxml.done, per_gene/EOG091G0RHX/EOG091G0RHX.raxml.done, per_gene/EOG091G0RR3/EOG091G0RR3.raxml.done, per_gene/EOG091G0RRE/EOG091G0RRE.raxml.done, per_gene/EOG091G0RTZ/EOG091G0RTZ.raxml.done, per_gene/EOG091G0S8Y/EOG091G0S8Y.raxml.done, per_gene/EOG091G0SBR/EOG091G0SBR.raxml.done, per_gene/EOG091G0SRZ/EOG091G0SRZ.raxml.done, per_gene/EOG091G0SU6/EOG091G0SU6.raxml.done, per_gene/EOG091G0TCJ/EOG091G0TCJ.raxml.done, per_gene/EOG091G0TNU/EOG091G0TNU.raxml.done, per_gene/EOG091G0TRW/EOG091G0TRW.raxml.done, per_gene/EOG091G0TSE/EOG091G0TSE.raxml.done, per_gene/EOG091G0TVG/EOG091G0TVG.raxml.done, per_gene/EOG091G0TWR/EOG091G0TWR.raxml.done, per_gene/EOG091G0TZX/EOG091G0TZX.raxml.done, per_gene/EOG091G0U75/EOG091G0U75.raxml.done, per_gene/EOG091G0UKP/EOG091G0UKP.raxml.done, per_gene/EOG091G0UQZ/EOG091G0UQZ.raxml.done, per_gene/EOG091G0UYL/EOG091G0UYL.raxml.done, per_gene/EOG091G0VGJ/EOG091G0VGJ.raxml.done, per_gene/EOG091G0VIF/EOG091G0VIF.raxml.done, per_gene/EOG091G0VNB/EOG091G0VNB.raxml.done, per_gene/EOG091G0VQK/EOG091G0VQK.raxml.done, per_gene/EOG091G0VSZ/EOG091G0VSZ.raxml.done, per_gene/EOG091G0VTN/EOG091G0VTN.raxml.done, per_gene/EOG091G0W6G/EOG091G0W6G.raxml.done, per_gene/EOG091G0WLL/EOG091G0WLL.raxml.done, per_gene/EOG091G0WT4/EOG091G0WT4.raxml.done, per_gene/EOG091G0XN1/EOG091G0XN1.raxml.done, per_gene/EOG091G0XQ3/EOG091G0XQ3.raxml.done, per_gene/EOG091G0Y05/EOG091G0Y05.raxml.done, per_gene/EOG091G0Y09/EOG091G0Y09.raxml.done, per_gene/EOG091G0YU6/EOG091G0YU6.raxml.done, per_gene/EOG091G0YVI/EOG091G0YVI.raxml.done, per_gene/EOG091G0YZ0/EOG091G0YZ0.raxml.done, per_gene/EOG091G0Z4E/EOG091G0Z4E.raxml.done, per_gene/EOG091G0ZLI/EOG091G0ZLI.raxml.done, per_gene/EOG091G0ZUA/EOG091G0ZUA.raxml.done, per_gene/EOG091G10CG/EOG091G10CG.raxml.done, per_gene/EOG091G10FG/EOG091G10FG.raxml.done, per_gene/EOG091G10IX/EOG091G10IX.raxml.done, per_gene/EOG091G113O/EOG091G113O.raxml.done, per_gene/EOG091G114S/EOG091G114S.raxml.done, per_gene/EOG091G11CG/EOG091G11CG.raxml.done, per_gene/EOG091G11OU/EOG091G11OU.raxml.done, per_gene/EOG091G1285/EOG091G1285.raxml.done, per_gene/EOG091G12A5/EOG091G12A5.raxml.done, per_gene/EOG091G132G/EOG091G132G.raxml.done, per_gene/EOG091G146E/EOG091G146E.raxml.done, per_gene/EOG091G15HV/EOG091G15HV.raxml.done, per_gene/EOG091G15N9/EOG091G15N9.raxml.done, per_gene/EOG091G17K3/EOG091G17K3.raxml.done, per_gene/EOG091G1817/EOG091G1817.raxml.done, per_gene/EOG091G19Y2/EOG091G19Y2.raxml.done, per_gene/EOG091G1A1V/EOG091G1A1V.raxml.done, per_gene/EOG091G1AP6/EOG091G1AP6.raxml.done, per_gene/EOG091G02IP/EOG091G02IP.raxml.done, per_gene/EOG091G03FL/EOG091G03FL.raxml.done, per_gene/EOG091G03QC/EOG091G03QC.raxml.done, per_gene/EOG091G04FV/EOG091G04FV.raxml.done, per_gene/EOG091G05T4/EOG091G05T4.raxml.done, per_gene/EOG091G05TG/EOG091G05TG.raxml.done, per_gene/EOG091G06EF/EOG091G06EF.raxml.done, per_gene/EOG091G07Z0/EOG091G07Z0.raxml.done, per_gene/EOG091G08FX/EOG091G08FX.raxml.done, per_gene/EOG091G09QO/EOG091G09QO.raxml.done, per_gene/EOG091G0AHJ/EOG091G0AHJ.raxml.done, per_gene/EOG091G0BAM/EOG091G0BAM.raxml.done, per_gene/EOG091G0BTX/EOG091G0BTX.raxml.done, per_gene/EOG091G0D8I/EOG091G0D8I.raxml.done, per_gene/EOG091G0E11/EOG091G0E11.raxml.done, per_gene/EOG091G0ER1/EOG091G0ER1.raxml.done, per_gene/EOG091G0FJB/EOG091G0FJB.raxml.done, per_gene/EOG091G0FQ2/EOG091G0FQ2.raxml.done, per_gene/EOG091G0FTU/EOG091G0FTU.raxml.done, per_gene/EOG091G0HAI/EOG091G0HAI.raxml.done, per_gene/EOG091G0IMD/EOG091G0IMD.raxml.done, per_gene/EOG091G0IVB/EOG091G0IVB.raxml.done, per_gene/EOG091G0K1G/EOG091G0K1G.raxml.done, per_gene/EOG091G0K6O/EOG091G0K6O.raxml.done, per_gene/EOG091G0KSQ/EOG091G0KSQ.raxml.done, per_gene/EOG091G0L66/EOG091G0L66.raxml.done, per_gene/EOG091G0LRI/EOG091G0LRI.raxml.done, per_gene/EOG091G0MCM/EOG091G0MCM.raxml.done, per_gene/EOG091G0MRS/EOG091G0MRS.raxml.done, per_gene/EOG091G0N9D/EOG091G0N9D.raxml.done, per_gene/EOG091G0NTO/EOG091G0NTO.raxml.done, per_gene/EOG091G0OI8/EOG091G0OI8.raxml.done, per_gene/EOG091G0QEQ/EOG091G0QEQ.raxml.done, per_gene/EOG091G0QS6/EOG091G0QS6.raxml.done, per_gene/EOG091G0RCI/EOG091G0RCI.raxml.done, per_gene/EOG091G0RM8/EOG091G0RM8.raxml.done, per_gene/EOG091G0RRN/EOG091G0RRN.raxml.done, per_gene/EOG091G0RVD/EOG091G0RVD.raxml.done, per_gene/EOG091G0SNM/EOG091G0SNM.raxml.done, per_gene/EOG091G0TKH/EOG091G0TKH.raxml.done, per_gene/EOG091G0TQF/EOG091G0TQF.raxml.done, per_gene/EOG091G0UB5/EOG091G0UB5.raxml.done, per_gene/EOG091G0UE6/EOG091G0UE6.raxml.done, per_gene/EOG091G0VZF/EOG091G0VZF.raxml.done, per_gene/EOG091G0X3B/EOG091G0X3B.raxml.done, per_gene/EOG091G0ZLQ/EOG091G0ZLQ.raxml.done, per_gene/EOG091G0ZRG/EOG091G0ZRG.raxml.done, per_gene/EOG091G107U/EOG091G107U.raxml.done, per_gene/EOG091G112U/EOG091G112U.raxml.done, per_gene/EOG091G134K/EOG091G134K.raxml.done, per_gene/EOG091G184V/EOG091G184V.raxml.done, per_gene/EOG091G197A/EOG091G197A.raxml.done, per_gene/EOG091G01VH/EOG091G01VH.raxml.done, per_gene/EOG091G01XQ/EOG091G01XQ.raxml.done, per_gene/EOG091G038T/EOG091G038T.raxml.done, per_gene/EOG091G03Z1/EOG091G03Z1.raxml.done, per_gene/EOG091G03ZS/EOG091G03ZS.raxml.done, per_gene/EOG091G05RA/EOG091G05RA.raxml.done, per_gene/EOG091G065D/EOG091G065D.raxml.done, per_gene/EOG091G06J6/EOG091G06J6.raxml.done, per_gene/EOG091G06P4/EOG091G06P4.raxml.done, per_gene/EOG091G074G/EOG091G074G.raxml.done, per_gene/EOG091G079R/EOG091G079R.raxml.done, per_gene/EOG091G07KL/EOG091G07KL.raxml.done, per_gene/EOG091G088L/EOG091G088L.raxml.done, per_gene/EOG091G08UU/EOG091G08UU.raxml.done, per_gene/EOG091G08VB/EOG091G08VB.raxml.done, per_gene/EOG091G09MD/EOG091G09MD.raxml.done, per_gene/EOG091G0BQF/EOG091G0BQF.raxml.done, per_gene/EOG091G0CF7/EOG091G0CF7.raxml.done, per_gene/EOG091G0CQ2/EOG091G0CQ2.raxml.done, per_gene/EOG091G0CW2/EOG091G0CW2.raxml.done, per_gene/EOG091G0D0W/EOG091G0D0W.raxml.done, per_gene/EOG091G0E5O/EOG091G0E5O.raxml.done, per_gene/EOG091G0ILS/EOG091G0ILS.raxml.done, per_gene/EOG091G0IWR/EOG091G0IWR.raxml.done, per_gene/EOG091G0LFF/EOG091G0LFF.raxml.done, per_gene/EOG091G0NQW/EOG091G0NQW.raxml.done, per_gene/EOG091G0P5N/EOG091G0P5N.raxml.done, per_gene/EOG091G0PUZ/EOG091G0PUZ.raxml.done, per_gene/EOG091G19WY/EOG091G19WY.raxml.done, per_gene/EOG091G01GC/EOG091G01GC.raxml.done, per_gene/EOG091G0262/EOG091G0262.raxml.done, per_gene/EOG091G0291/EOG091G0291.raxml.done, per_gene/EOG091G029K/EOG091G029K.raxml.done, per_gene/EOG091G02FR/EOG091G02FR.raxml.done, per_gene/EOG091G02NH/EOG091G02NH.raxml.done, per_gene/EOG091G02O6/EOG091G02O6.raxml.done, per_gene/EOG091G03G3/EOG091G03G3.raxml.done, per_gene/EOG091G03LI/EOG091G03LI.raxml.done, per_gene/EOG091G03TX/EOG091G03TX.raxml.done, per_gene/EOG091G03XO/EOG091G03XO.raxml.done, per_gene/EOG091G046H/EOG091G046H.raxml.done, per_gene/EOG091G049W/EOG091G049W.raxml.done, per_gene/EOG091G04LC/EOG091G04LC.raxml.done, per_gene/EOG091G050Q/EOG091G050Q.raxml.done, per_gene/EOG091G059G/EOG091G059G.raxml.done, per_gene/EOG091G05IK/EOG091G05IK.raxml.done, per_gene/EOG091G05SE/EOG091G05SE.raxml.done, per_gene/EOG091G06CB/EOG091G06CB.raxml.done, per_gene/EOG091G06I8/EOG091G06I8.raxml.done, per_gene/EOG091G06MR/EOG091G06MR.raxml.done, per_gene/EOG091G06Y3/EOG091G06Y3.raxml.done, per_gene/EOG091G07CE/EOG091G07CE.raxml.done, per_gene/EOG091G07D9/EOG091G07D9.raxml.done, per_gene/EOG091G07EJ/EOG091G07EJ.raxml.done, per_gene/EOG091G0803/EOG091G0803.raxml.done, per_gene/EOG091G08JE/EOG091G08JE.raxml.done, per_gene/EOG091G08SM/EOG091G08SM.raxml.done, per_gene/EOG091G096V/EOG091G096V.raxml.done, per_gene/EOG091G09U9/EOG091G09U9.raxml.done, per_gene/EOG091G09UB/EOG091G09UB.raxml.done, per_gene/EOG091G0A5N/EOG091G0A5N.raxml.done, per_gene/EOG091G0AEL/EOG091G0AEL.raxml.done, per_gene/EOG091G0ARE/EOG091G0ARE.raxml.done, per_gene/EOG091G0AVP/EOG091G0AVP.raxml.done, per_gene/EOG091G0BUH/EOG091G0BUH.raxml.done, per_gene/EOG091G0C7Y/EOG091G0C7Y.raxml.done, per_gene/EOG091G0CEK/EOG091G0CEK.raxml.done, per_gene/EOG091G0CMN/EOG091G0CMN.raxml.done, per_gene/EOG091G0DTD/EOG091G0DTD.raxml.done, per_gene/EOG091G0E7S/EOG091G0E7S.raxml.done, per_gene/EOG091G0EA2/EOG091G0EA2.raxml.done, per_gene/EOG091G0FPM/EOG091G0FPM.raxml.done, per_gene/EOG091G0GIC/EOG091G0GIC.raxml.done, per_gene/EOG091G0HML/EOG091G0HML.raxml.done, per_gene/EOG091G0HSB/EOG091G0HSB.raxml.done, per_gene/EOG091G0HTU/EOG091G0HTU.raxml.done, per_gene/EOG091G0HYF/EOG091G0HYF.raxml.done, per_gene/EOG091G0I85/EOG091G0I85.raxml.done, per_gene/EOG091G0ID9/EOG091G0ID9.raxml.done, per_gene/EOG091G0IDG/EOG091G0IDG.raxml.done, per_gene/EOG091G0IQD/EOG091G0IQD.raxml.done, per_gene/EOG091G0IUT/EOG091G0IUT.raxml.done, per_gene/EOG091G0IYB/EOG091G0IYB.raxml.done, per_gene/EOG091G0JYQ/EOG091G0JYQ.raxml.done, per_gene/EOG091G0K1Z/EOG091G0K1Z.raxml.done, per_gene/EOG091G0KC3/EOG091G0KC3.raxml.done, per_gene/EOG091G0KRZ/EOG091G0KRZ.raxml.done, per_gene/EOG091G0LIN/EOG091G0LIN.raxml.done, per_gene/EOG091G0M24/EOG091G0M24.raxml.done, per_gene/EOG091G0MDD/EOG091G0MDD.raxml.done, per_gene/EOG091G0MHM/EOG091G0MHM.raxml.done, per_gene/EOG091G0MI7/EOG091G0MI7.raxml.done, per_gene/EOG091G0MJA/EOG091G0MJA.raxml.done, per_gene/EOG091G0MLD/EOG091G0MLD.raxml.done, per_gene/EOG091G0NIU/EOG091G0NIU.raxml.done, per_gene/EOG091G0NOA/EOG091G0NOA.raxml.done, per_gene/EOG091G0PD3/EOG091G0PD3.raxml.done, per_gene/EOG091G0PIU/EOG091G0PIU.raxml.done, per_gene/EOG091G0R3S/EOG091G0R3S.raxml.done, per_gene/EOG091G0R6Z/EOG091G0R6Z.raxml.done, per_gene/EOG091G0RT1/EOG091G0RT1.raxml.done, per_gene/EOG091G0TA6/EOG091G0TA6.raxml.done, per_gene/EOG091G0W2D/EOG091G0W2D.raxml.done, per_gene/EOG091G0ZDR/EOG091G0ZDR.raxml.done, per_gene/EOG091G115J/EOG091G115J.raxml.done, per_gene/EOG091G11O6/EOG091G11O6.raxml.done, per_gene/EOG091G1422/EOG091G1422.raxml.done, per_gene/EOG091G1BQN/EOG091G1BQN.raxml.done, per_gene/EOG091G0554/EOG091G0554.raxml.done, per_gene/EOG091G0BG4/EOG091G0BG4.raxml.done, per_gene/EOG091G0EAF/EOG091G0EAF.raxml.done, per_gene/EOG091G0GWF/EOG091G0GWF.raxml.done, per_gene/EOG091G0JI0/EOG091G0JI0.raxml.done, per_gene/EOG091G0L5D/EOG091G0L5D.raxml.done, per_gene/EOG091G0L84/EOG091G0L84.raxml.done, per_gene/EOG091G0O7O/EOG091G0O7O.raxml.done, per_gene/EOG091G0SQV/EOG091G0SQV.raxml.done, per_gene/EOG091G0UKA/EOG091G0UKA.raxml.done, per_gene/EOG091G0WPV/EOG091G0WPV.raxml.done, per_gene/EOG091G0YHX/EOG091G0YHX.raxml.done, per_gene/EOG091G126R/EOG091G126R.raxml.done
    output: post-filtering-concat/post_filter.ok
    log: post-filtering-concat/post_filter.stdout.txt, post-filtering-concat/post_filter.stderr.txt
    jobid: 1236


	basedir=$(pwd)
        cd post-filtering-concat
        
        bash $basedir/../scripts/post-filter.sh ../per_gene/ 100 5 60 1> ../post-filtering-concat/post_filter.stdout.txt 2> ../post-filtering-concat/post_filter.stderr.txt

	touch ../post-filtering-concat/post_filter.ok
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/72476f9d9a5bd0627b4d721143a21354.simg
[Mon Jul  6 00:43:54 2020]
Finished job 1236.
3289 of 3292 steps (100%) done

[Mon Jul  6 00:43:54 2020]
rule concat:
    input: post-filtering-concat/post_filter.ok
    output: post-filtering-concat/FcC_supermatrix.fas
    log: post-filtering-concat/concat.stdout.txt, post-filtering-concat/concat.stderr.txt
    jobid: 412


	cd post-filtering-concat

	FASconCAT-G.pl -a -a -s 1> ../post-filtering-concat/concat.stdout.txt 2> ../post-filtering-concat/concat.stderr.txt
	
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/bf0a1dac7d8e05dcb9550970a1e2932d.simg
[Mon Jul  6 00:44:11 2020]
Finished job 412.
3290 of 3292 steps (100%) done

[Mon Jul  6 00:44:11 2020]
rule infer_supermatrix_ML:
    input: post-filtering-concat/FcC_supermatrix.fas
    output: phylogenomic-ML/partitions.txt, phylogenomic-ML/RAxML_bipartitions.final
    log: phylogenomic-ML/infer_supermatrix_ML.stdout.txt, phylogenomic-ML/infer_supermatrix_ML.stderr.txt
    jobid: 413
    threads: 32


	basedir=$(pwd)
	cd phylogenomic-ML

	bash $basedir/../scripts/create_partitions.sh ../post-filtering-concat 1> ../phylogenomic-ML/partitions.txt 2> partitions.err

	file=(RAxML*)
	if [ -f "$file" ]
	then
		rm RAxML*
	fi
	raxml -f a -T 32 -m PROTGAMMAWAG -p 12345 -q ../phylogenomic-ML/partitions.txt -x 12345 -# 100 -s ../post-filtering-concat/FcC_supermatrix.fas -n final 1> ../phylogenomic-ML/infer_supermatrix_ML.stdout.txt 2> ../phylogenomic-ML/infer_supermatrix_ML.stderr.txt
        
Activating singularity image /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/singularity/c0c09ee657b1e27f2c5687e0e9aa8d70.simg
[Mon Jul  6 08:16:04 2020]
Finished job 413.
3291 of 3292 steps (100%) done

[Mon Jul  6 08:16:04 2020]
localrule all:
    input: per_gene/EOG091G00Q0/EOG091G00Q0.raxml.done, per_gene/EOG091G00UD/EOG091G00UD.raxml.done, per_gene/EOG091G00Z3/EOG091G00Z3.raxml.done, per_gene/EOG091G011X/EOG091G011X.raxml.done, per_gene/EOG091G017G/EOG091G017G.raxml.done, per_gene/EOG091G017T/EOG091G017T.raxml.done, per_gene/EOG091G01EW/EOG091G01EW.raxml.done, per_gene/EOG091G01IW/EOG091G01IW.raxml.done, per_gene/EOG091G01TH/EOG091G01TH.raxml.done, per_gene/EOG091G01XI/EOG091G01XI.raxml.done, per_gene/EOG091G027G/EOG091G027G.raxml.done, per_gene/EOG091G02LY/EOG091G02LY.raxml.done, per_gene/EOG091G02O5/EOG091G02O5.raxml.done, per_gene/EOG091G02V5/EOG091G02V5.raxml.done, per_gene/EOG091G02ZI/EOG091G02ZI.raxml.done, per_gene/EOG091G0307/EOG091G0307.raxml.done, per_gene/EOG091G0321/EOG091G0321.raxml.done, per_gene/EOG091G03AN/EOG091G03AN.raxml.done, per_gene/EOG091G03B9/EOG091G03B9.raxml.done, per_gene/EOG091G03I1/EOG091G03I1.raxml.done, per_gene/EOG091G03JF/EOG091G03JF.raxml.done, per_gene/EOG091G03M4/EOG091G03M4.raxml.done, per_gene/EOG091G03PD/EOG091G03PD.raxml.done, per_gene/EOG091G03RW/EOG091G03RW.raxml.done, per_gene/EOG091G03TZ/EOG091G03TZ.raxml.done, per_gene/EOG091G040G/EOG091G040G.raxml.done, per_gene/EOG091G046Y/EOG091G046Y.raxml.done, per_gene/EOG091G04EX/EOG091G04EX.raxml.done, per_gene/EOG091G04GW/EOG091G04GW.raxml.done, per_gene/EOG091G0530/EOG091G0530.raxml.done, per_gene/EOG091G057L/EOG091G057L.raxml.done, per_gene/EOG091G05AA/EOG091G05AA.raxml.done, per_gene/EOG091G05AH/EOG091G05AH.raxml.done, per_gene/EOG091G05EU/EOG091G05EU.raxml.done, per_gene/EOG091G05GZ/EOG091G05GZ.raxml.done, per_gene/EOG091G05K5/EOG091G05K5.raxml.done, per_gene/EOG091G05KR/EOG091G05KR.raxml.done, per_gene/EOG091G05NK/EOG091G05NK.raxml.done, per_gene/EOG091G05NZ/EOG091G05NZ.raxml.done, per_gene/EOG091G05OR/EOG091G05OR.raxml.done, per_gene/EOG091G05OW/EOG091G05OW.raxml.done, per_gene/EOG091G05Q6/EOG091G05Q6.raxml.done, per_gene/EOG091G05YC/EOG091G05YC.raxml.done, per_gene/EOG091G06HP/EOG091G06HP.raxml.done, per_gene/EOG091G06M8/EOG091G06M8.raxml.done, per_gene/EOG091G06ON/EOG091G06ON.raxml.done, per_gene/EOG091G06QP/EOG091G06QP.raxml.done, per_gene/EOG091G06S3/EOG091G06S3.raxml.done, per_gene/EOG091G06U0/EOG091G06U0.raxml.done, per_gene/EOG091G06Y7/EOG091G06Y7.raxml.done, per_gene/EOG091G073F/EOG091G073F.raxml.done, per_gene/EOG091G074U/EOG091G074U.raxml.done, per_gene/EOG091G075F/EOG091G075F.raxml.done, per_gene/EOG091G07IK/EOG091G07IK.raxml.done, per_gene/EOG091G07NJ/EOG091G07NJ.raxml.done, per_gene/EOG091G07OD/EOG091G07OD.raxml.done, per_gene/EOG091G07S9/EOG091G07S9.raxml.done, per_gene/EOG091G07VQ/EOG091G07VQ.raxml.done, per_gene/EOG091G07Z5/EOG091G07Z5.raxml.done, per_gene/EOG091G085U/EOG091G085U.raxml.done, per_gene/EOG091G08BK/EOG091G08BK.raxml.done, per_gene/EOG091G08LT/EOG091G08LT.raxml.done, per_gene/EOG091G08O3/EOG091G08O3.raxml.done, per_gene/EOG091G08RU/EOG091G08RU.raxml.done, per_gene/EOG091G08ZG/EOG091G08ZG.raxml.done, per_gene/EOG091G0977/EOG091G0977.raxml.done, per_gene/EOG091G0990/EOG091G0990.raxml.done, per_gene/EOG091G09GO/EOG091G09GO.raxml.done, per_gene/EOG091G09HR/EOG091G09HR.raxml.done, per_gene/EOG091G09MU/EOG091G09MU.raxml.done, per_gene/EOG091G09RJ/EOG091G09RJ.raxml.done, per_gene/EOG091G0A19/EOG091G0A19.raxml.done, per_gene/EOG091G0A2I/EOG091G0A2I.raxml.done, per_gene/EOG091G0A2L/EOG091G0A2L.raxml.done, per_gene/EOG091G0A98/EOG091G0A98.raxml.done, per_gene/EOG091G0AE9/EOG091G0AE9.raxml.done, per_gene/EOG091G0AFP/EOG091G0AFP.raxml.done, per_gene/EOG091G0AKW/EOG091G0AKW.raxml.done, per_gene/EOG091G0AQA/EOG091G0AQA.raxml.done, per_gene/EOG091G0B27/EOG091G0B27.raxml.done, per_gene/EOG091G0B2N/EOG091G0B2N.raxml.done, per_gene/EOG091G0BHP/EOG091G0BHP.raxml.done, per_gene/EOG091G0BHV/EOG091G0BHV.raxml.done, per_gene/EOG091G0BKZ/EOG091G0BKZ.raxml.done, per_gene/EOG091G0BUD/EOG091G0BUD.raxml.done, per_gene/EOG091G0C84/EOG091G0C84.raxml.done, per_gene/EOG091G0C8H/EOG091G0C8H.raxml.done, per_gene/EOG091G0CAR/EOG091G0CAR.raxml.done, per_gene/EOG091G0CEW/EOG091G0CEW.raxml.done, per_gene/EOG091G0CFP/EOG091G0CFP.raxml.done, per_gene/EOG091G0CNT/EOG091G0CNT.raxml.done, per_gene/EOG091G0CTG/EOG091G0CTG.raxml.done, per_gene/EOG091G0CZX/EOG091G0CZX.raxml.done, per_gene/EOG091G0D26/EOG091G0D26.raxml.done, per_gene/EOG091G0DTP/EOG091G0DTP.raxml.done, per_gene/EOG091G0DVQ/EOG091G0DVQ.raxml.done, per_gene/EOG091G0DXV/EOG091G0DXV.raxml.done, per_gene/EOG091G0DYW/EOG091G0DYW.raxml.done, per_gene/EOG091G0E06/EOG091G0E06.raxml.done, per_gene/EOG091G0EH8/EOG091G0EH8.raxml.done, per_gene/EOG091G0EHZ/EOG091G0EHZ.raxml.done, per_gene/EOG091G0ES6/EOG091G0ES6.raxml.done, per_gene/EOG091G0EVK/EOG091G0EVK.raxml.done, per_gene/EOG091G0EZO/EOG091G0EZO.raxml.done, per_gene/EOG091G0FIJ/EOG091G0FIJ.raxml.done, per_gene/EOG091G0G3M/EOG091G0G3M.raxml.done, per_gene/EOG091G0G6C/EOG091G0G6C.raxml.done, per_gene/EOG091G0G6Z/EOG091G0G6Z.raxml.done, per_gene/EOG091G0G8R/EOG091G0G8R.raxml.done, per_gene/EOG091G0GDF/EOG091G0GDF.raxml.done, per_gene/EOG091G0GKH/EOG091G0GKH.raxml.done, per_gene/EOG091G0GOU/EOG091G0GOU.raxml.done, per_gene/EOG091G0GQO/EOG091G0GQO.raxml.done, per_gene/EOG091G0GVZ/EOG091G0GVZ.raxml.done, per_gene/EOG091G0GWO/EOG091G0GWO.raxml.done, per_gene/EOG091G0H62/EOG091G0H62.raxml.done, per_gene/EOG091G0H6A/EOG091G0H6A.raxml.done, per_gene/EOG091G0H8F/EOG091G0H8F.raxml.done, per_gene/EOG091G0HXI/EOG091G0HXI.raxml.done, per_gene/EOG091G0I8J/EOG091G0I8J.raxml.done, per_gene/EOG091G0IDP/EOG091G0IDP.raxml.done, per_gene/EOG091G0II3/EOG091G0II3.raxml.done, per_gene/EOG091G0ILG/EOG091G0ILG.raxml.done, per_gene/EOG091G0IQ7/EOG091G0IQ7.raxml.done, per_gene/EOG091G0ITS/EOG091G0ITS.raxml.done, per_gene/EOG091G0IZX/EOG091G0IZX.raxml.done, per_gene/EOG091G0J14/EOG091G0J14.raxml.done, per_gene/EOG091G0J2W/EOG091G0J2W.raxml.done, per_gene/EOG091G0JEC/EOG091G0JEC.raxml.done, per_gene/EOG091G0JI1/EOG091G0JI1.raxml.done, per_gene/EOG091G0K2R/EOG091G0K2R.raxml.done, per_gene/EOG091G0K82/EOG091G0K82.raxml.done, per_gene/EOG091G0K95/EOG091G0K95.raxml.done, per_gene/EOG091G0K9M/EOG091G0K9M.raxml.done, per_gene/EOG091G0KGO/EOG091G0KGO.raxml.done, per_gene/EOG091G0KRB/EOG091G0KRB.raxml.done, per_gene/EOG091G0KSX/EOG091G0KSX.raxml.done, per_gene/EOG091G0KVW/EOG091G0KVW.raxml.done, per_gene/EOG091G0LKE/EOG091G0LKE.raxml.done, per_gene/EOG091G0LP5/EOG091G0LP5.raxml.done, per_gene/EOG091G0LS0/EOG091G0LS0.raxml.done, per_gene/EOG091G0LT1/EOG091G0LT1.raxml.done, per_gene/EOG091G0LZ0/EOG091G0LZ0.raxml.done, per_gene/EOG091G0M12/EOG091G0M12.raxml.done, per_gene/EOG091G0M22/EOG091G0M22.raxml.done, per_gene/EOG091G0M4K/EOG091G0M4K.raxml.done, per_gene/EOG091G0MDG/EOG091G0MDG.raxml.done, per_gene/EOG091G0MDT/EOG091G0MDT.raxml.done, per_gene/EOG091G0MKY/EOG091G0MKY.raxml.done, per_gene/EOG091G0MP6/EOG091G0MP6.raxml.done, per_gene/EOG091G0MSB/EOG091G0MSB.raxml.done, per_gene/EOG091G0MVL/EOG091G0MVL.raxml.done, per_gene/EOG091G0MY0/EOG091G0MY0.raxml.done, per_gene/EOG091G0MY8/EOG091G0MY8.raxml.done, per_gene/EOG091G0MZC/EOG091G0MZC.raxml.done, per_gene/EOG091G0N0A/EOG091G0N0A.raxml.done, per_gene/EOG091G0N0R/EOG091G0N0R.raxml.done, per_gene/EOG091G0NK3/EOG091G0NK3.raxml.done, per_gene/EOG091G0NKD/EOG091G0NKD.raxml.done, per_gene/EOG091G0NMJ/EOG091G0NMJ.raxml.done, per_gene/EOG091G0NNO/EOG091G0NNO.raxml.done, per_gene/EOG091G0NVA/EOG091G0NVA.raxml.done, per_gene/EOG091G0O6E/EOG091G0O6E.raxml.done, per_gene/EOG091G0OHF/EOG091G0OHF.raxml.done, per_gene/EOG091G0OWI/EOG091G0OWI.raxml.done, per_gene/EOG091G0PAG/EOG091G0PAG.raxml.done, per_gene/EOG091G0PEI/EOG091G0PEI.raxml.done, per_gene/EOG091G0PHL/EOG091G0PHL.raxml.done, per_gene/EOG091G0PNO/EOG091G0PNO.raxml.done, per_gene/EOG091G0QE1/EOG091G0QE1.raxml.done, per_gene/EOG091G0QGZ/EOG091G0QGZ.raxml.done, per_gene/EOG091G0QIP/EOG091G0QIP.raxml.done, per_gene/EOG091G0QJA/EOG091G0QJA.raxml.done, per_gene/EOG091G0QKK/EOG091G0QKK.raxml.done, per_gene/EOG091G0QPG/EOG091G0QPG.raxml.done, per_gene/EOG091G0QRW/EOG091G0QRW.raxml.done, per_gene/EOG091G0QUH/EOG091G0QUH.raxml.done, per_gene/EOG091G0QW9/EOG091G0QW9.raxml.done, per_gene/EOG091G0QZ2/EOG091G0QZ2.raxml.done, per_gene/EOG091G0R04/EOG091G0R04.raxml.done, per_gene/EOG091G0R21/EOG091G0R21.raxml.done, per_gene/EOG091G0RA2/EOG091G0RA2.raxml.done, per_gene/EOG091G0RHX/EOG091G0RHX.raxml.done, per_gene/EOG091G0RR3/EOG091G0RR3.raxml.done, per_gene/EOG091G0RRE/EOG091G0RRE.raxml.done, per_gene/EOG091G0RTZ/EOG091G0RTZ.raxml.done, per_gene/EOG091G0S8Y/EOG091G0S8Y.raxml.done, per_gene/EOG091G0SBR/EOG091G0SBR.raxml.done, per_gene/EOG091G0SRZ/EOG091G0SRZ.raxml.done, per_gene/EOG091G0SU6/EOG091G0SU6.raxml.done, per_gene/EOG091G0TCJ/EOG091G0TCJ.raxml.done, per_gene/EOG091G0TNU/EOG091G0TNU.raxml.done, per_gene/EOG091G0TRW/EOG091G0TRW.raxml.done, per_gene/EOG091G0TSE/EOG091G0TSE.raxml.done, per_gene/EOG091G0TVG/EOG091G0TVG.raxml.done, per_gene/EOG091G0TWR/EOG091G0TWR.raxml.done, per_gene/EOG091G0TZX/EOG091G0TZX.raxml.done, per_gene/EOG091G0U75/EOG091G0U75.raxml.done, per_gene/EOG091G0UKP/EOG091G0UKP.raxml.done, per_gene/EOG091G0UQZ/EOG091G0UQZ.raxml.done, per_gene/EOG091G0UYL/EOG091G0UYL.raxml.done, per_gene/EOG091G0VGJ/EOG091G0VGJ.raxml.done, per_gene/EOG091G0VIF/EOG091G0VIF.raxml.done, per_gene/EOG091G0VNB/EOG091G0VNB.raxml.done, per_gene/EOG091G0VQK/EOG091G0VQK.raxml.done, per_gene/EOG091G0VSZ/EOG091G0VSZ.raxml.done, per_gene/EOG091G0VTN/EOG091G0VTN.raxml.done, per_gene/EOG091G0W6G/EOG091G0W6G.raxml.done, per_gene/EOG091G0WLL/EOG091G0WLL.raxml.done, per_gene/EOG091G0WT4/EOG091G0WT4.raxml.done, per_gene/EOG091G0XN1/EOG091G0XN1.raxml.done, per_gene/EOG091G0XQ3/EOG091G0XQ3.raxml.done, per_gene/EOG091G0Y05/EOG091G0Y05.raxml.done, per_gene/EOG091G0Y09/EOG091G0Y09.raxml.done, per_gene/EOG091G0YU6/EOG091G0YU6.raxml.done, per_gene/EOG091G0YVI/EOG091G0YVI.raxml.done, per_gene/EOG091G0YZ0/EOG091G0YZ0.raxml.done, per_gene/EOG091G0Z4E/EOG091G0Z4E.raxml.done, per_gene/EOG091G0ZLI/EOG091G0ZLI.raxml.done, per_gene/EOG091G0ZUA/EOG091G0ZUA.raxml.done, per_gene/EOG091G10CG/EOG091G10CG.raxml.done, per_gene/EOG091G10FG/EOG091G10FG.raxml.done, per_gene/EOG091G10IX/EOG091G10IX.raxml.done, per_gene/EOG091G113O/EOG091G113O.raxml.done, per_gene/EOG091G114S/EOG091G114S.raxml.done, per_gene/EOG091G11CG/EOG091G11CG.raxml.done, per_gene/EOG091G11OU/EOG091G11OU.raxml.done, per_gene/EOG091G1285/EOG091G1285.raxml.done, per_gene/EOG091G12A5/EOG091G12A5.raxml.done, per_gene/EOG091G132G/EOG091G132G.raxml.done, per_gene/EOG091G146E/EOG091G146E.raxml.done, per_gene/EOG091G15HV/EOG091G15HV.raxml.done, per_gene/EOG091G15N9/EOG091G15N9.raxml.done, per_gene/EOG091G17K3/EOG091G17K3.raxml.done, per_gene/EOG091G1817/EOG091G1817.raxml.done, per_gene/EOG091G19Y2/EOG091G19Y2.raxml.done, per_gene/EOG091G1A1V/EOG091G1A1V.raxml.done, per_gene/EOG091G1AP6/EOG091G1AP6.raxml.done, per_gene/EOG091G02IP/EOG091G02IP.raxml.done, per_gene/EOG091G03FL/EOG091G03FL.raxml.done, per_gene/EOG091G03QC/EOG091G03QC.raxml.done, per_gene/EOG091G04FV/EOG091G04FV.raxml.done, per_gene/EOG091G05T4/EOG091G05T4.raxml.done, per_gene/EOG091G05TG/EOG091G05TG.raxml.done, per_gene/EOG091G06EF/EOG091G06EF.raxml.done, per_gene/EOG091G07Z0/EOG091G07Z0.raxml.done, per_gene/EOG091G08FX/EOG091G08FX.raxml.done, per_gene/EOG091G09QO/EOG091G09QO.raxml.done, per_gene/EOG091G0AHJ/EOG091G0AHJ.raxml.done, per_gene/EOG091G0BAM/EOG091G0BAM.raxml.done, per_gene/EOG091G0BTX/EOG091G0BTX.raxml.done, per_gene/EOG091G0D8I/EOG091G0D8I.raxml.done, per_gene/EOG091G0E11/EOG091G0E11.raxml.done, per_gene/EOG091G0ER1/EOG091G0ER1.raxml.done, per_gene/EOG091G0FJB/EOG091G0FJB.raxml.done, per_gene/EOG091G0FQ2/EOG091G0FQ2.raxml.done, per_gene/EOG091G0FTU/EOG091G0FTU.raxml.done, per_gene/EOG091G0HAI/EOG091G0HAI.raxml.done, per_gene/EOG091G0IMD/EOG091G0IMD.raxml.done, per_gene/EOG091G0IVB/EOG091G0IVB.raxml.done, per_gene/EOG091G0K1G/EOG091G0K1G.raxml.done, per_gene/EOG091G0K6O/EOG091G0K6O.raxml.done, per_gene/EOG091G0KSQ/EOG091G0KSQ.raxml.done, per_gene/EOG091G0L66/EOG091G0L66.raxml.done, per_gene/EOG091G0LRI/EOG091G0LRI.raxml.done, per_gene/EOG091G0MCM/EOG091G0MCM.raxml.done, per_gene/EOG091G0MRS/EOG091G0MRS.raxml.done, per_gene/EOG091G0N9D/EOG091G0N9D.raxml.done, per_gene/EOG091G0NTO/EOG091G0NTO.raxml.done, per_gene/EOG091G0OI8/EOG091G0OI8.raxml.done, per_gene/EOG091G0QEQ/EOG091G0QEQ.raxml.done, per_gene/EOG091G0QS6/EOG091G0QS6.raxml.done, per_gene/EOG091G0RCI/EOG091G0RCI.raxml.done, per_gene/EOG091G0RM8/EOG091G0RM8.raxml.done, per_gene/EOG091G0RRN/EOG091G0RRN.raxml.done, per_gene/EOG091G0RVD/EOG091G0RVD.raxml.done, per_gene/EOG091G0SNM/EOG091G0SNM.raxml.done, per_gene/EOG091G0TKH/EOG091G0TKH.raxml.done, per_gene/EOG091G0TQF/EOG091G0TQF.raxml.done, per_gene/EOG091G0UB5/EOG091G0UB5.raxml.done, per_gene/EOG091G0UE6/EOG091G0UE6.raxml.done, per_gene/EOG091G0VZF/EOG091G0VZF.raxml.done, per_gene/EOG091G0X3B/EOG091G0X3B.raxml.done, per_gene/EOG091G0ZLQ/EOG091G0ZLQ.raxml.done, per_gene/EOG091G0ZRG/EOG091G0ZRG.raxml.done, per_gene/EOG091G107U/EOG091G107U.raxml.done, per_gene/EOG091G112U/EOG091G112U.raxml.done, per_gene/EOG091G134K/EOG091G134K.raxml.done, per_gene/EOG091G184V/EOG091G184V.raxml.done, per_gene/EOG091G197A/EOG091G197A.raxml.done, per_gene/EOG091G01VH/EOG091G01VH.raxml.done, per_gene/EOG091G01XQ/EOG091G01XQ.raxml.done, per_gene/EOG091G038T/EOG091G038T.raxml.done, per_gene/EOG091G03Z1/EOG091G03Z1.raxml.done, per_gene/EOG091G03ZS/EOG091G03ZS.raxml.done, per_gene/EOG091G05RA/EOG091G05RA.raxml.done, per_gene/EOG091G065D/EOG091G065D.raxml.done, per_gene/EOG091G06J6/EOG091G06J6.raxml.done, per_gene/EOG091G06P4/EOG091G06P4.raxml.done, per_gene/EOG091G074G/EOG091G074G.raxml.done, per_gene/EOG091G079R/EOG091G079R.raxml.done, per_gene/EOG091G07KL/EOG091G07KL.raxml.done, per_gene/EOG091G088L/EOG091G088L.raxml.done, per_gene/EOG091G08UU/EOG091G08UU.raxml.done, per_gene/EOG091G08VB/EOG091G08VB.raxml.done, per_gene/EOG091G09MD/EOG091G09MD.raxml.done, per_gene/EOG091G0BQF/EOG091G0BQF.raxml.done, per_gene/EOG091G0CF7/EOG091G0CF7.raxml.done, per_gene/EOG091G0CQ2/EOG091G0CQ2.raxml.done, per_gene/EOG091G0CW2/EOG091G0CW2.raxml.done, per_gene/EOG091G0D0W/EOG091G0D0W.raxml.done, per_gene/EOG091G0E5O/EOG091G0E5O.raxml.done, per_gene/EOG091G0ILS/EOG091G0ILS.raxml.done, per_gene/EOG091G0IWR/EOG091G0IWR.raxml.done, per_gene/EOG091G0LFF/EOG091G0LFF.raxml.done, per_gene/EOG091G0NQW/EOG091G0NQW.raxml.done, per_gene/EOG091G0P5N/EOG091G0P5N.raxml.done, per_gene/EOG091G0PUZ/EOG091G0PUZ.raxml.done, per_gene/EOG091G19WY/EOG091G19WY.raxml.done, per_gene/EOG091G01GC/EOG091G01GC.raxml.done, per_gene/EOG091G0262/EOG091G0262.raxml.done, per_gene/EOG091G0291/EOG091G0291.raxml.done, per_gene/EOG091G029K/EOG091G029K.raxml.done, per_gene/EOG091G02FR/EOG091G02FR.raxml.done, per_gene/EOG091G02NH/EOG091G02NH.raxml.done, per_gene/EOG091G02O6/EOG091G02O6.raxml.done, per_gene/EOG091G03G3/EOG091G03G3.raxml.done, per_gene/EOG091G03LI/EOG091G03LI.raxml.done, per_gene/EOG091G03TX/EOG091G03TX.raxml.done, per_gene/EOG091G03XO/EOG091G03XO.raxml.done, per_gene/EOG091G046H/EOG091G046H.raxml.done, per_gene/EOG091G049W/EOG091G049W.raxml.done, per_gene/EOG091G04LC/EOG091G04LC.raxml.done, per_gene/EOG091G050Q/EOG091G050Q.raxml.done, per_gene/EOG091G059G/EOG091G059G.raxml.done, per_gene/EOG091G05IK/EOG091G05IK.raxml.done, per_gene/EOG091G05SE/EOG091G05SE.raxml.done, per_gene/EOG091G06CB/EOG091G06CB.raxml.done, per_gene/EOG091G06I8/EOG091G06I8.raxml.done, per_gene/EOG091G06MR/EOG091G06MR.raxml.done, per_gene/EOG091G06Y3/EOG091G06Y3.raxml.done, per_gene/EOG091G07CE/EOG091G07CE.raxml.done, per_gene/EOG091G07D9/EOG091G07D9.raxml.done, per_gene/EOG091G07EJ/EOG091G07EJ.raxml.done, per_gene/EOG091G0803/EOG091G0803.raxml.done, per_gene/EOG091G08JE/EOG091G08JE.raxml.done, per_gene/EOG091G08SM/EOG091G08SM.raxml.done, per_gene/EOG091G096V/EOG091G096V.raxml.done, per_gene/EOG091G09U9/EOG091G09U9.raxml.done, per_gene/EOG091G09UB/EOG091G09UB.raxml.done, per_gene/EOG091G0A5N/EOG091G0A5N.raxml.done, per_gene/EOG091G0AEL/EOG091G0AEL.raxml.done, per_gene/EOG091G0ARE/EOG091G0ARE.raxml.done, per_gene/EOG091G0AVP/EOG091G0AVP.raxml.done, per_gene/EOG091G0BUH/EOG091G0BUH.raxml.done, per_gene/EOG091G0C7Y/EOG091G0C7Y.raxml.done, per_gene/EOG091G0CEK/EOG091G0CEK.raxml.done, per_gene/EOG091G0CMN/EOG091G0CMN.raxml.done, per_gene/EOG091G0DTD/EOG091G0DTD.raxml.done, per_gene/EOG091G0E7S/EOG091G0E7S.raxml.done, per_gene/EOG091G0EA2/EOG091G0EA2.raxml.done, per_gene/EOG091G0FPM/EOG091G0FPM.raxml.done, per_gene/EOG091G0GIC/EOG091G0GIC.raxml.done, per_gene/EOG091G0HML/EOG091G0HML.raxml.done, per_gene/EOG091G0HSB/EOG091G0HSB.raxml.done, per_gene/EOG091G0HTU/EOG091G0HTU.raxml.done, per_gene/EOG091G0HYF/EOG091G0HYF.raxml.done, per_gene/EOG091G0I85/EOG091G0I85.raxml.done, per_gene/EOG091G0ID9/EOG091G0ID9.raxml.done, per_gene/EOG091G0IDG/EOG091G0IDG.raxml.done, per_gene/EOG091G0IQD/EOG091G0IQD.raxml.done, per_gene/EOG091G0IUT/EOG091G0IUT.raxml.done, per_gene/EOG091G0IYB/EOG091G0IYB.raxml.done, per_gene/EOG091G0JYQ/EOG091G0JYQ.raxml.done, per_gene/EOG091G0K1Z/EOG091G0K1Z.raxml.done, per_gene/EOG091G0KC3/EOG091G0KC3.raxml.done, per_gene/EOG091G0KRZ/EOG091G0KRZ.raxml.done, per_gene/EOG091G0LIN/EOG091G0LIN.raxml.done, per_gene/EOG091G0M24/EOG091G0M24.raxml.done, per_gene/EOG091G0MDD/EOG091G0MDD.raxml.done, per_gene/EOG091G0MHM/EOG091G0MHM.raxml.done, per_gene/EOG091G0MI7/EOG091G0MI7.raxml.done, per_gene/EOG091G0MJA/EOG091G0MJA.raxml.done, per_gene/EOG091G0MLD/EOG091G0MLD.raxml.done, per_gene/EOG091G0NIU/EOG091G0NIU.raxml.done, per_gene/EOG091G0NOA/EOG091G0NOA.raxml.done, per_gene/EOG091G0PD3/EOG091G0PD3.raxml.done, per_gene/EOG091G0PIU/EOG091G0PIU.raxml.done, per_gene/EOG091G0R3S/EOG091G0R3S.raxml.done, per_gene/EOG091G0R6Z/EOG091G0R6Z.raxml.done, per_gene/EOG091G0RT1/EOG091G0RT1.raxml.done, per_gene/EOG091G0TA6/EOG091G0TA6.raxml.done, per_gene/EOG091G0W2D/EOG091G0W2D.raxml.done, per_gene/EOG091G0ZDR/EOG091G0ZDR.raxml.done, per_gene/EOG091G115J/EOG091G115J.raxml.done, per_gene/EOG091G11O6/EOG091G11O6.raxml.done, per_gene/EOG091G1422/EOG091G1422.raxml.done, per_gene/EOG091G1BQN/EOG091G1BQN.raxml.done, per_gene/EOG091G0554/EOG091G0554.raxml.done, per_gene/EOG091G0BG4/EOG091G0BG4.raxml.done, per_gene/EOG091G0EAF/EOG091G0EAF.raxml.done, per_gene/EOG091G0GWF/EOG091G0GWF.raxml.done, per_gene/EOG091G0JI0/EOG091G0JI0.raxml.done, per_gene/EOG091G0L5D/EOG091G0L5D.raxml.done, per_gene/EOG091G0L84/EOG091G0L84.raxml.done, per_gene/EOG091G0O7O/EOG091G0O7O.raxml.done, per_gene/EOG091G0SQV/EOG091G0SQV.raxml.done, per_gene/EOG091G0UKA/EOG091G0UKA.raxml.done, per_gene/EOG091G0WPV/EOG091G0WPV.raxml.done, per_gene/EOG091G0YHX/EOG091G0YHX.raxml.done, per_gene/EOG091G126R/EOG091G126R.raxml.done, post-filtering-concat/FcC_supermatrix.fas, phylogenomic-ML/RAxML_bipartitions.final
    jobid: 0

[Mon Jul  6 08:16:04 2020]
Finished job 0.
3292 of 3292 steps (100%) done
Complete log: /usr/people/EDVZ/hahnc/AMEB_2020_practical/BUSCO/.snakemake/log/2020-07-05T212628.328428.snakemake.log
